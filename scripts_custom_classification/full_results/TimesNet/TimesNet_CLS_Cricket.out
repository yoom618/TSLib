Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 172.44822645187378
Epoch: 1, Steps: 7 | Train Loss: 2.330 Vali Loss: 1.468 Vali Acc: 0.694 Test Loss: 1.468 Test Acc: 0.694
Validation loss decreased (inf --> -0.694430).  Saving model ...
Epoch: 2 cost time: 168.07102823257446
Epoch: 2, Steps: 7 | Train Loss: 0.661 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
Validation loss decreased (-0.694430 --> -0.833329).  Saving model ...
Epoch: 3 cost time: 178.14782094955444
Epoch: 3, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.833329 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 175.85298466682434
Epoch: 4, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 178.9162995815277
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 168.79561495780945
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 175.31457829475403
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.917 Test Loss: 0.467 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 163.39961123466492
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.903 Test Loss: 0.495 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 173.4508936405182
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.903 Test Loss: 0.507 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 171.03847479820251
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.903 Test Loss: 0.506 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 169.89621686935425
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.903 Test Loss: 0.494 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 160.16574478149414
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.903 Test Loss: 0.486 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 171.04955124855042
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.917 Test Loss: 0.479 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 158.75587916374207
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.917 Test Loss: 0.474 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 169.827223777771
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.917 Test Loss: 0.469 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 159.93935251235962
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.917 Test Loss: 0.465 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 17 cost time: 161.1438229084015
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.917 Test Loss: 0.462 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 18 cost time: 155.35419917106628
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.917 Test Loss: 0.459 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 19 cost time: 159.57681012153625
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.917 Test Loss: 0.456 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 20 cost time: 162.41125893592834
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.917 Test Loss: 0.453 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 21 cost time: 167.0006275177002
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.917 Test Loss: 0.451 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 22 cost time: 159.3192059993744
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.917 Test Loss: 0.448 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 23 cost time: 155.17190647125244
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.917 Test Loss: 0.445 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 24 cost time: 153.43192100524902
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.931 Test Loss: 0.443 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 25 cost time: 150.26524662971497
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.931 Test Loss: 0.441 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 26 cost time: 159.11852550506592
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.931 Test Loss: 0.438 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 27 cost time: 147.2656078338623
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.931 Test Loss: 0.436 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 28 cost time: 151.40677070617676
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.931 Test Loss: 0.434 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 29 cost time: 144.30258893966675
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.931 Test Loss: 0.431 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 30 cost time: 164.85614919662476
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.931 Test Loss: 0.429 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 76824076
model size : 295.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 55.18099617958069
Epoch: 1, Steps: 7 | Train Loss: 2.415 Vali Loss: 1.544 Vali Acc: 0.764 Test Loss: 1.544 Test Acc: 0.764
Validation loss decreased (inf --> -0.763873).  Saving model ...
Epoch: 2 cost time: 57.79707098007202
Epoch: 2, Steps: 7 | Train Loss: 0.644 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.763873 --> -0.916664).  Saving model ...
Epoch: 3 cost time: 59.214799880981445
Epoch: 3, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 57.5077600479126
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.418 Vali Acc: 0.889 Test Loss: 0.418 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 58.3516058921814
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 54.02635860443115
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 53.84055280685425
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 57.129467487335205
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 54.28070521354675
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 55.44613862037659
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 52.43637800216675
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 54.28130650520325
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.694 Vali Acc: 0.847 Test Loss: 0.694 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 56.94094204902649
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.917 Test Loss: 0.465 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 55.158541202545166
Epoch: 14, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 56.241910457611084
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.018 Vali Acc: 0.903 Test Loss: 1.018 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 55.97128415107727
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 56.01348900794983
Epoch: 17, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.923 Vali Acc: 0.819 Test Loss: 0.923 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 58.75328850746155
Epoch: 18, Steps: 7 | Train Loss: 0.029 Vali Loss: 1.972 Vali Acc: 0.792 Test Loss: 1.972 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23867916
model size : 93.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 118.37553644180298
Epoch: 1, Steps: 7 | Train Loss: 2.330 Vali Loss: 1.468 Vali Acc: 0.694 Test Loss: 1.468 Test Acc: 0.694
Validation loss decreased (inf --> -0.694430).  Saving model ...
Epoch: 2 cost time: 122.27060770988464
Epoch: 2, Steps: 7 | Train Loss: 0.661 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
Validation loss decreased (-0.694430 --> -0.833329).  Saving model ...
Epoch: 3 cost time: 117.71178817749023
Epoch: 3, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.833329 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 116.24752998352051
Epoch: 4, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 119.39937448501587
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 115.18642091751099
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 126.14832401275635
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.917 Test Loss: 0.467 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 114.89852213859558
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.903 Test Loss: 0.495 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 118.51835227012634
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.903 Test Loss: 0.507 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 116.00783228874207
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.903 Test Loss: 0.506 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 120.92532181739807
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.903 Test Loss: 0.494 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 127.57169771194458
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.903 Test Loss: 0.486 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 115.52478432655334
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.917 Test Loss: 0.479 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 121.14675664901733
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.917 Test Loss: 0.474 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 110.05880331993103
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.917 Test Loss: 0.469 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 111.65941882133484
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.917 Test Loss: 0.465 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 17 cost time: 116.26540946960449
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.917 Test Loss: 0.462 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 18 cost time: 125.93718528747559
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.917 Test Loss: 0.459 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 19 cost time: 110.33390736579895
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.917 Test Loss: 0.456 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 20 cost time: 109.34894132614136
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.917 Test Loss: 0.453 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 21 cost time: 112.93688654899597
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.917 Test Loss: 0.451 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 22 cost time: 112.32506942749023
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.917 Test Loss: 0.448 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 23 cost time: 111.27799439430237
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.917 Test Loss: 0.445 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 24 cost time: 99.49468302726746
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.931 Test Loss: 0.443 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 25 cost time: 102.2259578704834
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.931 Test Loss: 0.441 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 26 cost time: 109.65086483955383
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.931 Test Loss: 0.438 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 27 cost time: 107.23598074913025
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.931 Test Loss: 0.436 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 28 cost time: 97.56447696685791
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.931 Test Loss: 0.434 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 29 cost time: 94.36998057365417
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.931 Test Loss: 0.431 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 30 cost time: 90.98410391807556
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.931 Test Loss: 0.429 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 76824076
model size : 295.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 38.61854934692383
Epoch: 1, Steps: 7 | Train Loss: 2.415 Vali Loss: 1.544 Vali Acc: 0.764 Test Loss: 1.544 Test Acc: 0.764
Validation loss decreased (inf --> -0.763873).  Saving model ...
Epoch: 2 cost time: 38.89738202095032
Epoch: 2, Steps: 7 | Train Loss: 0.644 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.763873 --> -0.916664).  Saving model ...
Epoch: 3 cost time: 38.13401222229004
Epoch: 3, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 32.80185890197754
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.418 Vali Acc: 0.889 Test Loss: 0.418 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 33.09681153297424
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 32.38592505455017
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 38.113744497299194
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 40.488720178604126
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 39.74716138839722
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 35.83250379562378
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 41.74062466621399
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 37.894017934799194
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.694 Vali Acc: 0.847 Test Loss: 0.694 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 40.8913140296936
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.917 Test Loss: 0.466 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 42.359177589416504
Epoch: 14, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 35.28588891029358
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.018 Vali Acc: 0.903 Test Loss: 1.018 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 37.91018080711365
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 36.43626046180725
Epoch: 17, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.917 Vali Acc: 0.833 Test Loss: 0.917 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 36.56303071975708
Epoch: 18, Steps: 7 | Train Loss: 0.031 Vali Loss: 2.013 Vali Acc: 0.806 Test Loss: 2.013 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23867916
model size : 93.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 63.045318365097046
Epoch: 1, Steps: 7 | Train Loss: 2.330 Vali Loss: 1.468 Vali Acc: 0.694 Test Loss: 1.468 Test Acc: 0.694
Validation loss decreased (inf --> -0.694430).  Saving model ...
Epoch: 2 cost time: 66.33943748474121
Epoch: 2, Steps: 7 | Train Loss: 0.661 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
Validation loss decreased (-0.694430 --> -0.833329).  Saving model ...
Epoch: 3 cost time: 70.20108675956726
Epoch: 3, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.833329 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 69.72257947921753
Epoch: 4, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 70.75881361961365
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 70.0342366695404
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 66.2659420967102
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.917 Test Loss: 0.467 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 68.58823323249817
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.903 Test Loss: 0.495 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 63.8622145652771
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.903 Test Loss: 0.507 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 59.647931814193726
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.903 Test Loss: 0.506 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 64.78407979011536
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.903 Test Loss: 0.494 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 66.17215371131897
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.903 Test Loss: 0.486 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 67.44128680229187
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.917 Test Loss: 0.479 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 67.944171667099
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.917 Test Loss: 0.474 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 67.36255812644958
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.917 Test Loss: 0.469 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 62.12079095840454
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.917 Test Loss: 0.465 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 17 cost time: 61.69338822364807
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.917 Test Loss: 0.462 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 18 cost time: 63.3961877822876
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.917 Test Loss: 0.459 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 19 cost time: 61.81726837158203
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.917 Test Loss: 0.456 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 20 cost time: 63.438682556152344
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.917 Test Loss: 0.453 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 21 cost time: 65.91495704650879
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.917 Test Loss: 0.451 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 22 cost time: 65.52858829498291
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.917 Test Loss: 0.448 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 23 cost time: 62.978813886642456
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.917 Test Loss: 0.445 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 24 cost time: 63.8647096157074
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.931 Test Loss: 0.443 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 25 cost time: 63.761821031570435
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.931 Test Loss: 0.441 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 26 cost time: 64.31323170661926
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.931 Test Loss: 0.438 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 27 cost time: 65.85779213905334
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.931 Test Loss: 0.436 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 28 cost time: 66.97141551971436
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.931 Test Loss: 0.434 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 29 cost time: 64.19979405403137
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.931 Test Loss: 0.431 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 30 cost time: 63.83929967880249
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.931 Test Loss: 0.429 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 76824076
model size : 295.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 25.623836040496826
Epoch: 1, Steps: 7 | Train Loss: 2.415 Vali Loss: 1.544 Vali Acc: 0.764 Test Loss: 1.544 Test Acc: 0.764
Validation loss decreased (inf --> -0.763873).  Saving model ...
Epoch: 2 cost time: 25.28625464439392
Epoch: 2, Steps: 7 | Train Loss: 0.644 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.763873 --> -0.916664).  Saving model ...
Epoch: 3 cost time: 23.470513105392456
Epoch: 3, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 24.16843318939209
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.418 Vali Acc: 0.889 Test Loss: 0.418 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.547029495239258
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.576470136642456
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 25.143794775009155
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 24.14903235435486
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 24.322523593902588
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 26.685832262039185
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 25.36534881591797
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 25.46008062362671
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.695 Vali Acc: 0.847 Test Loss: 0.695 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 25.892187118530273
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.917 Test Loss: 0.466 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 24.065858125686646
Epoch: 14, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 25.41626286506653
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.018 Vali Acc: 0.903 Test Loss: 1.018 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 25.665085554122925
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.328 Vali Acc: 0.917 Test Loss: 0.328 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 24.61154294013977
Epoch: 17, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.913 Vali Acc: 0.833 Test Loss: 0.913 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 26.36519455909729
Epoch: 18, Steps: 7 | Train Loss: 0.034 Vali Loss: 1.998 Vali Acc: 0.806 Test Loss: 1.998 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23867916
model size : 93.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 80.48539710044861
Epoch: 1, Steps: 7 | Train Loss: 2.421 Vali Loss: 1.528 Vali Acc: 0.750 Test Loss: 1.528 Test Acc: 0.750
Validation loss decreased (inf --> -0.749985).  Saving model ...
Epoch: 2 cost time: 77.75020599365234
Epoch: 2, Steps: 7 | Train Loss: 0.643 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
Validation loss decreased (-0.749985 --> -0.861107).  Saving model ...
Epoch: 3 cost time: 78.32730293273926
Epoch: 3, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 80.13510990142822
Epoch: 4, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 78.13805294036865
Epoch: 5, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 86.7725920677185
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.931 Test Loss: 0.360 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 7 cost time: 80.93532156944275
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.917 Test Loss: 0.381 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 75.67968797683716
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 77.90451574325562
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.917 Test Loss: 0.347 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 84.08858060836792
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 83.65705823898315
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 82.51411175727844
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 76.91394901275635
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 79.10004091262817
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 83.21656727790833
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.917 Test Loss: 0.328 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 84.71702456474304
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 39334412
model size : 152.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 32.853652477264404
Epoch: 1, Steps: 7 | Train Loss: 2.285 Vali Loss: 1.451 Vali Acc: 0.806 Test Loss: 1.451 Test Acc: 0.806
Validation loss decreased (inf --> -0.805541).  Saving model ...
Epoch: 2 cost time: 32.14439535140991
Epoch: 2, Steps: 7 | Train Loss: 0.617 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
Validation loss decreased (-0.805541 --> -0.888885).  Saving model ...
Epoch: 3 cost time: 31.078792810440063
Epoch: 3, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 29.397871494293213
Epoch: 4, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 31.673953533172607
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 29.086615562438965
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.931 Test Loss: 0.340 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 28.40886640548706
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 30.126617431640625
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.917 Test Loss: 0.384 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 28.86448383331299
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.917 Test Loss: 0.387 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 27.60365891456604
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.917 Test Loss: 0.385 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 30.646694660186768
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.917 Test Loss: 0.381 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 30.694205284118652
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.917 Test Loss: 0.377 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 29.10237455368042
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.372 Vali Acc: 0.917 Test Loss: 0.372 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 30.293781518936157
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 12855820
model size : 51.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 62.120604038238525
Epoch: 1, Steps: 7 | Train Loss: 2.421 Vali Loss: 1.528 Vali Acc: 0.750 Test Loss: 1.528 Test Acc: 0.750
Validation loss decreased (inf --> -0.749985).  Saving model ...
Epoch: 2 cost time: 62.20491433143616
Epoch: 2, Steps: 7 | Train Loss: 0.643 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
Validation loss decreased (-0.749985 --> -0.861107).  Saving model ...
Epoch: 3 cost time: 59.70861577987671
Epoch: 3, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 58.62912464141846
Epoch: 4, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 66.8880844116211
Epoch: 5, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 65.5105972290039
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.931 Test Loss: 0.360 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 7 cost time: 65.6294333934784
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.917 Test Loss: 0.381 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 64.85006785392761
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 63.01584243774414
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.917 Test Loss: 0.347 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 63.4955849647522
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 61.20716190338135
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 61.12840747833252
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 65.27755832672119
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 63.48924922943115
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 64.25595879554749
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.917 Test Loss: 0.328 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 65.61978936195374
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 39334412
model size : 152.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 26.21464991569519
Epoch: 1, Steps: 7 | Train Loss: 2.285 Vali Loss: 1.450 Vali Acc: 0.806 Test Loss: 1.450 Test Acc: 0.806
Validation loss decreased (inf --> -0.805541).  Saving model ...
Epoch: 2 cost time: 25.694376945495605
Epoch: 2, Steps: 7 | Train Loss: 0.617 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
Validation loss decreased (-0.805541 --> -0.888885).  Saving model ...
Epoch: 3 cost time: 25.63506293296814
Epoch: 3, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 22.41745114326477
Epoch: 4, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 22.738213300704956
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.040029048919678
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.931 Test Loss: 0.340 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.076032400131226
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 23.16140389442444
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.917 Test Loss: 0.384 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 23.304603099822998
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.917 Test Loss: 0.387 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 25.07581615447998
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.917 Test Loss: 0.385 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 24.922876596450806
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.917 Test Loss: 0.381 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 23.080493927001953
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.917 Test Loss: 0.377 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 22.798656702041626
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.372 Vali Acc: 0.917 Test Loss: 0.372 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 24.249946355819702
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 12855820
model size : 51.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 37.645010471343994
Epoch: 1, Steps: 7 | Train Loss: 2.421 Vali Loss: 1.528 Vali Acc: 0.750 Test Loss: 1.528 Test Acc: 0.750
Validation loss decreased (inf --> -0.749985).  Saving model ...
Epoch: 2 cost time: 36.027029037475586
Epoch: 2, Steps: 7 | Train Loss: 0.643 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
Validation loss decreased (-0.749985 --> -0.861107).  Saving model ...
Epoch: 3 cost time: 35.36492419242859
Epoch: 3, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 38.847740650177
Epoch: 4, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 36.68852496147156
Epoch: 5, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 36.0242965221405
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.931 Test Loss: 0.360 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 7 cost time: 35.95213961601257
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.917 Test Loss: 0.381 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 37.40237474441528
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 37.473440408706665
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.917 Test Loss: 0.347 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 37.57772445678711
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 37.01732802391052
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 38.12609815597534
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 38.532756328582764
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 39.39286684989929
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 38.27445673942566
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.917 Test Loss: 0.328 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 37.61053252220154
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 39334412
model size : 152.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 16.184256076812744
Epoch: 1, Steps: 7 | Train Loss: 2.285 Vali Loss: 1.450 Vali Acc: 0.806 Test Loss: 1.450 Test Acc: 0.806
Validation loss decreased (inf --> -0.805541).  Saving model ...
Epoch: 2 cost time: 15.064289331436157
Epoch: 2, Steps: 7 | Train Loss: 0.617 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
Validation loss decreased (-0.805541 --> -0.888885).  Saving model ...
Epoch: 3 cost time: 14.770508050918579
Epoch: 3, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 15.389829874038696
Epoch: 4, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 14.871828079223633
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.964554071426392
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.931 Test Loss: 0.340 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.976003646850586
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.27728533744812
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.917 Test Loss: 0.384 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 15.194554328918457
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.917 Test Loss: 0.387 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 15.800424337387085
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.917 Test Loss: 0.385 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 15.867340326309204
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.917 Test Loss: 0.381 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 15.759076595306396
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.917 Test Loss: 0.377 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 16.13845920562744
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.372 Vali Acc: 0.917 Test Loss: 0.372 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 14.823737144470215
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 12855820
model size : 51.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 100.8063268661499
Epoch: 1, Steps: 7 | Train Loss: 2.487 Vali Loss: 1.873 Vali Acc: 0.667 Test Loss: 1.873 Test Acc: 0.667
Validation loss decreased (inf --> -0.666648).  Saving model ...
Epoch: 2 cost time: 104.52908372879028
Epoch: 2, Steps: 7 | Train Loss: 1.168 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
Validation loss decreased (-0.666648 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 95.77462029457092
Epoch: 3, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 98.17379093170166
Epoch: 4, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 95.13061928749084
Epoch: 5, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 97.12902498245239
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 99.31015253067017
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 96.66886401176453
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 95.87413501739502
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 102.99377226829529
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 100.594562292099
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 100.74339985847473
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 97.35490703582764
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 96.34991669654846
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 100.51273775100708
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 97.5492115020752
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 103.1085855960846
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 95.2692060470581
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 97.34163880348206
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 94.15918135643005
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 96.46729278564453
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 97.10544490814209
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 96.30853056907654
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 97.53369808197021
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 115.07784676551819
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 111.6157112121582
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 112.00131154060364
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 110.9285056591034
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 113.48617935180664
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 105.76403307914734
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 38415116
model size : 147.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 42.73442220687866
Epoch: 1, Steps: 7 | Train Loss: 2.415 Vali Loss: 1.824 Vali Acc: 0.625 Test Loss: 1.824 Test Acc: 0.625
Validation loss decreased (inf --> -0.624982).  Saving model ...
Epoch: 2 cost time: 40.703908920288086
Epoch: 2, Steps: 7 | Train Loss: 1.169 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
Validation loss decreased (-0.624982 --> -0.861105).  Saving model ...
Epoch: 3 cost time: 41.29973030090332
Epoch: 3, Steps: 7 | Train Loss: 0.188 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 41.37900114059448
Epoch: 4, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 41.1453378200531
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 39.439242362976074
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 40.70744442939758
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 41.38817548751831
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 40.26582646369934
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 37.87895607948303
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 37.663023471832275
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 37.80757665634155
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 40.32026195526123
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 40.48521614074707
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 39.693947553634644
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 37.95332646369934
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 36.7796094417572
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 39.454793214797974
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 41.031431436538696
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 39.31845259666443
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 39.57982635498047
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 11936012
model size : 46.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 85.55711197853088
Epoch: 1, Steps: 7 | Train Loss: 2.487 Vali Loss: 1.871 Vali Acc: 0.667 Test Loss: 1.871 Test Acc: 0.667
Validation loss decreased (inf --> -0.666648).  Saving model ...
Epoch: 2 cost time: 81.92638754844666
Epoch: 2, Steps: 7 | Train Loss: 1.168 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
Validation loss decreased (-0.666648 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 82.97824215888977
Epoch: 3, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 80.59992003440857
Epoch: 4, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 79.74362421035767
Epoch: 5, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 82.49483466148376
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 78.74356198310852
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 84.72472167015076
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 83.20779228210449
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 81.13980793952942
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 79.57744598388672
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 78.55369544029236
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 73.61299657821655
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 74.10313081741333
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 75.41109299659729
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 74.77250504493713
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 76.82458090782166
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 79.56275391578674
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 79.47490286827087
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 78.83687424659729
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 80.6023416519165
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 79.55461311340332
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 71.9559633731842
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 71.65754842758179
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 71.89843463897705
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 69.58835220336914
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 75.02867460250854
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 77.86058187484741
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 76.91215705871582
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 77.50408887863159
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 38415116
model size : 147.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 32.16079783439636
Epoch: 1, Steps: 7 | Train Loss: 2.415 Vali Loss: 1.824 Vali Acc: 0.625 Test Loss: 1.824 Test Acc: 0.625
Validation loss decreased (inf --> -0.624982).  Saving model ...
Epoch: 2 cost time: 28.582571506500244
Epoch: 2, Steps: 7 | Train Loss: 1.169 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
Validation loss decreased (-0.624982 --> -0.861105).  Saving model ...
Epoch: 3 cost time: 27.841460704803467
Epoch: 3, Steps: 7 | Train Loss: 0.188 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 31.235623359680176
Epoch: 4, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.881120920181274
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 29.096291542053223
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 29.77092719078064
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 28.02958869934082
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 29.555737018585205
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 26.90923762321472
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 29.424561977386475
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 31.539430618286133
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 30.426122188568115
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 31.41746473312378
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 32.46833276748657
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 30.67017436027527
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 31.39779257774353
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 32.09511923789978
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 30.484838724136353
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 30.532284259796143
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 28.67937684059143
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 11936012
model size : 46.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 47.495018005371094
Epoch: 1, Steps: 7 | Train Loss: 2.487 Vali Loss: 1.871 Vali Acc: 0.667 Test Loss: 1.871 Test Acc: 0.667
Validation loss decreased (inf --> -0.666648).  Saving model ...
Epoch: 2 cost time: 43.81858158111572
Epoch: 2, Steps: 7 | Train Loss: 1.168 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
Validation loss decreased (-0.666648 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 43.99774193763733
Epoch: 3, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 44.82943367958069
Epoch: 4, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 46.77761769294739
Epoch: 5, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 45.60146760940552
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 44.847848653793335
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 42.53727650642395
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 42.386284589767456
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 44.67639207839966
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 46.55431365966797
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 45.37690544128418
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 40.51899290084839
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 41.061291456222534
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 40.60409092903137
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 40.556636095047
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 43.530548334121704
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 40.95680832862854
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 44.443612813949585
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 42.92540168762207
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 41.05913805961609
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 41.507283449172974
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 42.451239347457886
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 43.97521901130676
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 44.459673166275024
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 44.399070024490356
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 42.30727672576904
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 46.67698407173157
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 46.36377263069153
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 46.21631646156311
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 38415116
model size : 147.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 20.83978843688965
Epoch: 1, Steps: 7 | Train Loss: 2.415 Vali Loss: 1.824 Vali Acc: 0.625 Test Loss: 1.824 Test Acc: 0.625
Validation loss decreased (inf --> -0.624982).  Saving model ...
Epoch: 2 cost time: 19.139973878860474
Epoch: 2, Steps: 7 | Train Loss: 1.169 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
Validation loss decreased (-0.624982 --> -0.861105).  Saving model ...
Epoch: 3 cost time: 19.729721546173096
Epoch: 3, Steps: 7 | Train Loss: 0.188 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 19.5210964679718
Epoch: 4, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.208590507507324
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 19.684473037719727
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 17.857396841049194
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.647196531295776
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.829237937927246
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 18.272701025009155
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 18.020050764083862
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 18.24565553665161
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 18.112149000167847
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 18.554789781570435
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 18.61467695236206
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 17.93797469139099
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 18.00127410888672
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 16.35732889175415
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 18.336795568466187
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 18.244781970977783
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 18.367810487747192
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 11936012
model size : 46.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 62.38579845428467
Epoch: 1, Steps: 7 | Train Loss: 2.467 Vali Loss: 1.959 Vali Acc: 0.542 Test Loss: 1.959 Test Acc: 0.542
Validation loss decreased (inf --> -0.541647).  Saving model ...
Epoch: 2 cost time: 61.906609296798706
Epoch: 2, Steps: 7 | Train Loss: 1.191 Vali Loss: 0.644 Vali Acc: 0.903 Test Loss: 0.644 Test Acc: 0.903
Validation loss decreased (-0.541647 --> -0.902771).  Saving model ...
Epoch: 3 cost time: 59.76908898353577
Epoch: 3, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 57.49911642074585
Epoch: 4, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 59.44872999191284
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 63.234623670578
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.917 Test Loss: 0.382 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 62.25978946685791
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 55.45451593399048
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 55.82000994682312
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 56.09827899932861
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 62.34902548789978
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 61.8449969291687
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 62.41120529174805
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 60.498268842697144
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 57.72015833854675
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 59.802263259887695
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 62.60077714920044
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 63.56104040145874
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 60.603949546813965
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 58.427969217300415
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 58.645190715789795
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 58.324708700180054
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 58.91253900527954
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 57.81440496444702
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 59.1008620262146
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 57.96623754501343
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 56.88642978668213
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 59.77972173690796
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 60.79159379005432
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 59.995383501052856
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 19668748
model size : 76.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 25.34977889060974
Epoch: 1, Steps: 7 | Train Loss: 2.500 Vali Loss: 1.872 Vali Acc: 0.653 Test Loss: 1.872 Test Acc: 0.653
Validation loss decreased (inf --> -0.652759).  Saving model ...
Epoch: 2 cost time: 22.784205198287964
Epoch: 2, Steps: 7 | Train Loss: 1.264 Vali Loss: 0.683 Vali Acc: 0.764 Test Loss: 0.683 Test Acc: 0.764
Validation loss decreased (-0.652759 --> -0.763882).  Saving model ...
Epoch: 3 cost time: 22.871442317962646
Epoch: 3, Steps: 7 | Train Loss: 0.223 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
Validation loss decreased (-0.763882 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 23.524133443832397
Epoch: 4, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916665).  Saving model ...
Epoch: 5 cost time: 23.271265268325806
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 22.795310974121094
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944443).  Saving model ...
Epoch: 7 cost time: 22.78885269165039
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 8 cost time: 22.54936146736145
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.938619136810303
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 23.168954372406006
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 22.984523057937622
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 23.493912935256958
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 21.498417139053345
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 23.043282747268677
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 22.7614426612854
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 22.006885290145874
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 22.093619108200073
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.931 Test Loss: 0.167 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 6428940
model size : 25.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 42.7946412563324
Epoch: 1, Steps: 7 | Train Loss: 2.467 Vali Loss: 1.959 Vali Acc: 0.542 Test Loss: 1.959 Test Acc: 0.542
Validation loss decreased (inf --> -0.541647).  Saving model ...
Epoch: 2 cost time: 40.35790252685547
Epoch: 2, Steps: 7 | Train Loss: 1.191 Vali Loss: 0.644 Vali Acc: 0.903 Test Loss: 0.644 Test Acc: 0.903
Validation loss decreased (-0.541647 --> -0.902771).  Saving model ...
Epoch: 3 cost time: 43.41322445869446
Epoch: 3, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 44.77299618721008
Epoch: 4, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 42.80202913284302
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 44.65862965583801
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.917 Test Loss: 0.382 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 42.43919515609741
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 42.783337354660034
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 42.90329599380493
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 44.00433897972107
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 44.73742365837097
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 44.60954761505127
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 45.85890030860901
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 40.89040493965149
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 40.163283824920654
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 39.974512577056885
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 40.629185914993286
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 42.70087122917175
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 43.378016233444214
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 43.24612021446228
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 43.74295115470886
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 42.81482934951782
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 43.45833873748779
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 43.83469891548157
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 43.94520926475525
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 42.6037015914917
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 44.22038650512695
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 43.910672426223755
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 43.45550513267517
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 44.140679121017456
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 19668748
model size : 76.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 16.70916748046875
Epoch: 1, Steps: 7 | Train Loss: 2.500 Vali Loss: 1.873 Vali Acc: 0.653 Test Loss: 1.873 Test Acc: 0.653
Validation loss decreased (inf --> -0.652759).  Saving model ...
Epoch: 2 cost time: 15.628114461898804
Epoch: 2, Steps: 7 | Train Loss: 1.264 Vali Loss: 0.683 Vali Acc: 0.764 Test Loss: 0.683 Test Acc: 0.764
Validation loss decreased (-0.652759 --> -0.763882).  Saving model ...
Epoch: 3 cost time: 15.539875030517578
Epoch: 3, Steps: 7 | Train Loss: 0.223 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
Validation loss decreased (-0.763882 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 16.440292358398438
Epoch: 4, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916665).  Saving model ...
Epoch: 5 cost time: 16.426810264587402
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 16.634386777877808
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944443).  Saving model ...
Epoch: 7 cost time: 16.745734691619873
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 8 cost time: 15.795575618743896
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.228201866149902
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.172863006591797
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 17.962275981903076
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 17.999234437942505
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.71347951889038
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 16.910208225250244
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 16.50475311279297
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 16.523778200149536
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 16.081237077713013
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.931 Test Loss: 0.167 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 6428940
model size : 25.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 27.535967350006104
Epoch: 1, Steps: 7 | Train Loss: 2.467 Vali Loss: 1.959 Vali Acc: 0.542 Test Loss: 1.959 Test Acc: 0.542
Validation loss decreased (inf --> -0.541647).  Saving model ...
Epoch: 2 cost time: 26.400417804718018
Epoch: 2, Steps: 7 | Train Loss: 1.191 Vali Loss: 0.644 Vali Acc: 0.903 Test Loss: 0.644 Test Acc: 0.903
Validation loss decreased (-0.541647 --> -0.902771).  Saving model ...
Epoch: 3 cost time: 25.259373903274536
Epoch: 3, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.360177516937256
Epoch: 4, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 26.526195526123047
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 25.729371309280396
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.917 Test Loss: 0.382 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 24.965801239013672
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 23.933687210083008
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 24.124406337738037
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 25.93226933479309
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 25.631823778152466
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.1164710521698
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 24.656567096710205
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 24.720704317092896
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 22.3138530254364
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 24.299447059631348
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 23.247339487075806
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 23.057785511016846
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 24.401421308517456
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 24.99940586090088
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 25.037737131118774
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 23.882957458496094
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 23.16638469696045
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 23.927006721496582
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 24.72186040878296
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 24.96199941635132
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 24.299888134002686
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 23.7840735912323
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 24.930514097213745
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 25.02622675895691
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 19668748
model size : 76.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 11.738658428192139
Epoch: 1, Steps: 7 | Train Loss: 2.500 Vali Loss: 1.873 Vali Acc: 0.653 Test Loss: 1.873 Test Acc: 0.653
Validation loss decreased (inf --> -0.652759).  Saving model ...
Epoch: 2 cost time: 9.842900037765503
Epoch: 2, Steps: 7 | Train Loss: 1.264 Vali Loss: 0.683 Vali Acc: 0.764 Test Loss: 0.683 Test Acc: 0.764
Validation loss decreased (-0.652759 --> -0.763882).  Saving model ...
Epoch: 3 cost time: 9.725098609924316
Epoch: 3, Steps: 7 | Train Loss: 0.223 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
Validation loss decreased (-0.763882 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 9.806280374526978
Epoch: 4, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916665).  Saving model ...
Epoch: 5 cost time: 10.014826774597168
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 10.387836217880249
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944443).  Saving model ...
Epoch: 7 cost time: 10.230968952178955
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 8 cost time: 10.38367247581482
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.46117115020752
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.561304807662964
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.84500241279602
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.523205757141113
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.648825645446777
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.480191469192505
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.966734886169434
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.992226362228394
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.337164640426636
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.931 Test Loss: 0.167 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 6428940
model size : 25.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 36.842374086380005
Epoch: 1, Steps: 7 | Train Loss: 2.509 Vali Loss: 1.998 Vali Acc: 0.472 Test Loss: 1.998 Test Acc: 0.472
Validation loss decreased (inf --> -0.472202).  Saving model ...
Epoch: 2 cost time: 33.09240126609802
Epoch: 2, Steps: 7 | Train Loss: 1.372 Vali Loss: 0.727 Vali Acc: 0.889 Test Loss: 0.727 Test Acc: 0.889
Validation loss decreased (-0.472202 --> -0.888882).  Saving model ...
Epoch: 3 cost time: 32.93408441543579
Epoch: 3, Steps: 7 | Train Loss: 0.290 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 34.32608199119568
Epoch: 4, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.888882 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 38.99752926826477
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 37.54040837287903
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 38.54359030723572
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 38.27311325073242
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 35.98014783859253
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 35.773595333099365
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 38.06376361846924
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 37.69334030151367
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 36.755077838897705
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 37.0507607460022
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 37.457144260406494
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 36.695979595184326
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 35.987266540527344
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 33.309393644332886
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 34.727837324142456
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 33.112877368927
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 10295564
model size : 40.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 15.438148498535156
Epoch: 1, Steps: 7 | Train Loss: 2.365 Vali Loss: 1.820 Vali Acc: 0.639 Test Loss: 1.820 Test Acc: 0.639
Validation loss decreased (inf --> -0.638871).  Saving model ...
Epoch: 2 cost time: 13.74283242225647
Epoch: 2, Steps: 7 | Train Loss: 1.121 Vali Loss: 0.576 Vali Acc: 0.903 Test Loss: 0.576 Test Acc: 0.903
Validation loss decreased (-0.638871 --> -0.902772).  Saving model ...
Epoch: 3 cost time: 13.869470357894897
Epoch: 3, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 13.860676527023315
Epoch: 4, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 5 cost time: 13.198025465011597
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 6 cost time: 13.264198303222656
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.459009647369385
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.335114240646362
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.865794658660889
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 10 cost time: 13.849701404571533
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 13.692065715789795
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 12.77470874786377
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 13.617481231689453
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 13.327449560165405
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 15 cost time: 13.09229326248169
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 16 cost time: 13.49825143814087
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.151731967926025
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.085339546203613
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 13.84483814239502
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 13.955607652664185
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 13.418317079544067
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 13.529418230056763
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 12.72985553741455
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 14.214731454849243
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 14.966104507446289
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 14.93437123298645
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 14.698970556259155
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 14.503576755523682
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3675404
model size : 15.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 27.490066051483154
Epoch: 1, Steps: 7 | Train Loss: 2.509 Vali Loss: 1.998 Vali Acc: 0.472 Test Loss: 1.998 Test Acc: 0.472
Validation loss decreased (inf --> -0.472202).  Saving model ...
Epoch: 2 cost time: 25.7638156414032
Epoch: 2, Steps: 7 | Train Loss: 1.372 Vali Loss: 0.727 Vali Acc: 0.889 Test Loss: 0.727 Test Acc: 0.889
Validation loss decreased (-0.472202 --> -0.888882).  Saving model ...
Epoch: 3 cost time: 22.64799404144287
Epoch: 3, Steps: 7 | Train Loss: 0.290 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 27.225786685943604
Epoch: 4, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.888882 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 25.495793342590332
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 26.59077739715576
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 26.875176429748535
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.470987796783447
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 24.314480304718018
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 24.56892204284668
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 25.445199489593506
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.382739067077637
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 26.06907629966736
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 24.17388081550598
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 25.33338761329651
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 25.706361293792725
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 25.513107776641846
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 26.821813344955444
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 26.80537700653076
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 24.063995838165283
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 10295564
model size : 40.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 12.41452169418335
Epoch: 1, Steps: 7 | Train Loss: 2.365 Vali Loss: 1.819 Vali Acc: 0.639 Test Loss: 1.819 Test Acc: 0.639
Validation loss decreased (inf --> -0.638871).  Saving model ...
Epoch: 2 cost time: 10.609927654266357
Epoch: 2, Steps: 7 | Train Loss: 1.121 Vali Loss: 0.576 Vali Acc: 0.903 Test Loss: 0.576 Test Acc: 0.903
Validation loss decreased (-0.638871 --> -0.902772).  Saving model ...
Epoch: 3 cost time: 10.445404529571533
Epoch: 3, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 10.347686052322388
Epoch: 4, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 5 cost time: 10.328282594680786
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 6 cost time: 10.383986234664917
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.418315410614014
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.42550015449524
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.857020378112793
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 10 cost time: 10.46951413154602
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 10.45741891860962
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 10.438519477844238
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 10.429860830307007
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 9.84522557258606
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 15 cost time: 11.345489025115967
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 16 cost time: 11.526981115341187
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.29858684539795
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.793988943099976
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 10.674526453018188
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.766058206558228
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 10.929429531097412
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 11.041001081466675
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 11.069010257720947
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 11.028985261917114
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 11.129410028457642
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 11.145349264144897
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 11.146121740341187
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 11.087137460708618
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3675404
model size : 15.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 17.34205675125122
Epoch: 1, Steps: 7 | Train Loss: 2.509 Vali Loss: 1.998 Vali Acc: 0.472 Test Loss: 1.998 Test Acc: 0.472
Validation loss decreased (inf --> -0.472202).  Saving model ...
Epoch: 2 cost time: 13.138638496398926
Epoch: 2, Steps: 7 | Train Loss: 1.372 Vali Loss: 0.727 Vali Acc: 0.889 Test Loss: 0.727 Test Acc: 0.889
Validation loss decreased (-0.472202 --> -0.888882).  Saving model ...
Epoch: 3 cost time: 14.57668948173523
Epoch: 3, Steps: 7 | Train Loss: 0.290 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.398469686508179
Epoch: 4, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.888882 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 14.143122911453247
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.91906189918518
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 14.58510971069336
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.543751955032349
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 14.339390754699707
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 15.458613157272339
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 15.371157169342041
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.248928546905518
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.178163290023804
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 14.880964756011963
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 14.86869740486145
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 14.410497188568115
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 14.028013467788696
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 15.011474847793579
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 14.93872356414795
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 15.157883167266846
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 10295564
model size : 40.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.526655435562134
Epoch: 1, Steps: 7 | Train Loss: 2.365 Vali Loss: 1.819 Vali Acc: 0.639 Test Loss: 1.819 Test Acc: 0.639
Validation loss decreased (inf --> -0.638871).  Saving model ...
Epoch: 2 cost time: 6.812478542327881
Epoch: 2, Steps: 7 | Train Loss: 1.121 Vali Loss: 0.576 Vali Acc: 0.903 Test Loss: 0.576 Test Acc: 0.903
Validation loss decreased (-0.638871 --> -0.902772).  Saving model ...
Epoch: 3 cost time: 6.846991539001465
Epoch: 3, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 7.0464091300964355
Epoch: 4, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 5 cost time: 7.209379196166992
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 6 cost time: 7.153700590133667
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.911795377731323
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.883026599884033
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.9069530963897705
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 10 cost time: 6.857428789138794
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 6.966953992843628
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 6.825238943099976
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 6.2323267459869385
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 5.555385589599609
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 15 cost time: 6.061383485794067
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 16 cost time: 5.907769680023193
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.9471118450164795
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.032748222351074
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 6.177077531814575
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.035569190979004
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.110980272293091
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.969721794128418
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.9516754150390625
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.101012468338013
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.1864848136901855
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.035084009170532
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.309065580368042
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.075890064239502
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3675404
model size : 15.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 33.61467790603638
Epoch: 1, Steps: 7 | Train Loss: 2.476 Vali Loss: 2.102 Vali Acc: 0.583 Test Loss: 2.102 Test Acc: 0.583
Validation loss decreased (inf --> -0.583312).  Saving model ...
Epoch: 2 cost time: 31.186641216278076
Epoch: 2, Steps: 7 | Train Loss: 1.682 Vali Loss: 1.145 Vali Acc: 0.806 Test Loss: 1.145 Test Acc: 0.806
Validation loss decreased (-0.583312 --> -0.805544).  Saving model ...
Epoch: 3 cost time: 30.976873636245728
Epoch: 3, Steps: 7 | Train Loss: 0.622 Vali Loss: 0.552 Vali Acc: 0.917 Test Loss: 0.552 Test Acc: 0.917
Validation loss decreased (-0.805544 --> -0.916661).  Saving model ...
Epoch: 4 cost time: 32.98227643966675
Epoch: 4, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 33.016838788986206
Epoch: 5, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 33.30589556694031
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 33.13089394569397
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 33.280107259750366
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 32.7391095161438
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 32.89435005187988
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 31.19184637069702
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 33.4618878364563
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 33.14264416694641
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 32.194401264190674
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 30.457215547561646
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 34.276363372802734
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 37.25852131843567
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 35.81114196777344
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 36.27062749862671
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 34.74309682846069
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 33.74359703063965
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 35.11732244491577
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 35.353880882263184
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 35.01946473121643
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 32.857807874679565
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 34.44019889831543
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 34.6239550113678
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 34.43965411186218
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 34.67622661590576
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 32.75679850578308
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 9835916
model size : 38.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 15.615269660949707
Epoch: 1, Steps: 7 | Train Loss: 2.475 Vali Loss: 2.113 Vali Acc: 0.458 Test Loss: 2.113 Test Acc: 0.458
Validation loss decreased (inf --> -0.458312).  Saving model ...
Epoch: 2 cost time: 13.613258600234985
Epoch: 2, Steps: 7 | Train Loss: 1.653 Vali Loss: 1.108 Vali Acc: 0.861 Test Loss: 1.108 Test Acc: 0.861
Validation loss decreased (-0.458312 --> -0.861100).  Saving model ...
Epoch: 3 cost time: 13.67261791229248
Epoch: 3, Steps: 7 | Train Loss: 0.606 Vali Loss: 0.490 Vali Acc: 0.889 Test Loss: 0.490 Test Acc: 0.889
Validation loss decreased (-0.861100 --> -0.888884).  Saving model ...
Epoch: 4 cost time: 13.58518123626709
Epoch: 4, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 13.651769638061523
Epoch: 5, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 13.385842561721802
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 12.7145357131958
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 8 cost time: 14.520764350891113
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.930554 --> -0.958332).  Saving model ...
Epoch: 9 cost time: 15.02295970916748
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.154974460601807
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 15.003961086273193
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 15.180740118026733
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 16.623860120773315
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.931 Test Loss: 0.171 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 14.649104595184326
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 14.271455526351929
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 13.308030128479004
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 13.369809865951538
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 13.513206481933594
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3215500
model size : 12.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 27.10634684562683
Epoch: 1, Steps: 7 | Train Loss: 2.476 Vali Loss: 2.103 Vali Acc: 0.569 Test Loss: 2.103 Test Acc: 0.569
Validation loss decreased (inf --> -0.569423).  Saving model ...
Epoch: 2 cost time: 25.107368230819702
Epoch: 2, Steps: 7 | Train Loss: 1.682 Vali Loss: 1.145 Vali Acc: 0.806 Test Loss: 1.145 Test Acc: 0.806
Validation loss decreased (-0.569423 --> -0.805544).  Saving model ...
Epoch: 3 cost time: 26.23774003982544
Epoch: 3, Steps: 7 | Train Loss: 0.622 Vali Loss: 0.553 Vali Acc: 0.917 Test Loss: 0.553 Test Acc: 0.917
Validation loss decreased (-0.805544 --> -0.916661).  Saving model ...
Epoch: 4 cost time: 27.578436136245728
Epoch: 4, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.287961721420288
Epoch: 5, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.80512046813965
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 26.37423539161682
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 26.780089616775513
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 27.006290912628174
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 26.326282024383545
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 26.62710690498352
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 26.892519235610962
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 26.491790294647217
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 27.148467540740967
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 26.137782335281372
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 25.927926778793335
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 26.25110387802124
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 26.49148392677307
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 26.241459608078003
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 26.07567024230957
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 25.709269046783447
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 24.57160520553589
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 27.185829162597656
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 27.16235041618347
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 27.044073820114136
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 25.887341499328613
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 25.449546098709106
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 25.364128589630127
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 26.55437994003296
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 26.931300401687622
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 9835916
model size : 38.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 14.055499076843262
Epoch: 1, Steps: 7 | Train Loss: 2.475 Vali Loss: 2.113 Vali Acc: 0.458 Test Loss: 2.113 Test Acc: 0.458
Validation loss decreased (inf --> -0.458312).  Saving model ...
Epoch: 2 cost time: 12.116310834884644
Epoch: 2, Steps: 7 | Train Loss: 1.653 Vali Loss: 1.108 Vali Acc: 0.861 Test Loss: 1.108 Test Acc: 0.861
Validation loss decreased (-0.458312 --> -0.861100).  Saving model ...
Epoch: 3 cost time: 10.57371973991394
Epoch: 3, Steps: 7 | Train Loss: 0.606 Vali Loss: 0.490 Vali Acc: 0.889 Test Loss: 0.490 Test Acc: 0.889
Validation loss decreased (-0.861100 --> -0.888884).  Saving model ...
Epoch: 4 cost time: 11.109058856964111
Epoch: 4, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 10.71479606628418
Epoch: 5, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 10.742439031600952
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 10.895464420318604
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 8 cost time: 11.227460861206055
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.930554 --> -0.958332).  Saving model ...
Epoch: 9 cost time: 11.680970430374146
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.620581865310669
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.580662250518799
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.903785943984985
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.955175399780273
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.931 Test Loss: 0.171 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.006849527359009
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.87649917602539
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.652908325195312
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.569273710250854
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 11.584008932113647
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3215500
model size : 12.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 17.77113652229309
Epoch: 1, Steps: 7 | Train Loss: 2.475 Vali Loss: 2.105 Vali Acc: 0.569 Test Loss: 2.105 Test Acc: 0.569
Validation loss decreased (inf --> -0.569423).  Saving model ...
Epoch: 2 cost time: 15.528848648071289
Epoch: 2, Steps: 7 | Train Loss: 1.681 Vali Loss: 1.147 Vali Acc: 0.806 Test Loss: 1.147 Test Acc: 0.806
Validation loss decreased (-0.569423 --> -0.805544).  Saving model ...
Epoch: 3 cost time: 15.736773252487183
Epoch: 3, Steps: 7 | Train Loss: 0.623 Vali Loss: 0.553 Vali Acc: 0.903 Test Loss: 0.553 Test Acc: 0.903
Validation loss decreased (-0.805544 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 15.593629598617554
Epoch: 4, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.801846981048584
Epoch: 5, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902775).  Saving model ...
Epoch: 6 cost time: 16.418748378753662
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 16.242528200149536
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.123441457748413
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 16.303004503250122
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 16.377967357635498
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 16.01716685295105
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 15.508182764053345
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 14.75068736076355
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 14.594520568847656
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 14.600237846374512
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 14.322421312332153
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 14.426724910736084
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 15.001847982406616
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 15.514757871627808
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 15.44899320602417
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 15.477885007858276
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 14.908546209335327
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 16.46030592918396
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 16.30923891067505
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 15.645967960357666
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 15.7068030834198
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 15.878504276275635
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 15.904237747192383
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 15.469987154006958
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 15.477106809616089
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 9835916
model size : 38.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.834779739379883
Epoch: 1, Steps: 7 | Train Loss: 2.477 Vali Loss: 2.113 Vali Acc: 0.458 Test Loss: 2.113 Test Acc: 0.458
Validation loss decreased (inf --> -0.458312).  Saving model ...
Epoch: 2 cost time: 7.433350086212158
Epoch: 2, Steps: 7 | Train Loss: 1.655 Vali Loss: 1.108 Vali Acc: 0.861 Test Loss: 1.108 Test Acc: 0.861
Validation loss decreased (-0.458312 --> -0.861100).  Saving model ...
Epoch: 3 cost time: 7.516939640045166
Epoch: 3, Steps: 7 | Train Loss: 0.611 Vali Loss: 0.489 Vali Acc: 0.889 Test Loss: 0.489 Test Acc: 0.889
Validation loss decreased (-0.861100 --> -0.888884).  Saving model ...
Epoch: 4 cost time: 7.429187774658203
Epoch: 4, Steps: 7 | Train Loss: 0.160 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 7.614964485168457
Epoch: 5, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 7.518937587738037
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 7.5123209953308105
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944443).  Saving model ...
Epoch: 8 cost time: 7.2799153327941895
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 9 cost time: 7.410658359527588
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.2783753871917725
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.388371229171753
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.019867658615112
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.827022314071655
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.895043134689331
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.93886661529541
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.751095771789551
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.645083665847778
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.890237808227539
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3215500
model size : 12.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 20.053581953048706
Epoch: 1, Steps: 7 | Train Loss: 2.450 Vali Loss: 2.163 Vali Acc: 0.444 Test Loss: 2.163 Test Acc: 0.444
Validation loss decreased (inf --> -0.444423).  Saving model ...
Epoch: 2 cost time: 18.61640739440918
Epoch: 2, Steps: 7 | Train Loss: 1.673 Vali Loss: 1.150 Vali Acc: 0.764 Test Loss: 1.150 Test Acc: 0.764
Validation loss decreased (-0.444423 --> -0.763877).  Saving model ...
Epoch: 3 cost time: 18.58265972137451
Epoch: 3, Steps: 7 | Train Loss: 0.635 Vali Loss: 0.567 Vali Acc: 0.889 Test Loss: 0.567 Test Acc: 0.889
Validation loss decreased (-0.763877 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 19.13876986503601
Epoch: 4, Steps: 7 | Train Loss: 0.201 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
Validation loss decreased (-0.888883 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 17.890737056732178
Epoch: 5, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 17.531670331954956
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.785093784332275
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 18.904436826705933
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 19.465033054351807
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 10 cost time: 18.431904792785645
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 18.5378520488739
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 19.109644412994385
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 19.89791440963745
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 19.251991271972656
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 19.101959228515625
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 18.745440006256104
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 19.113808631896973
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 18.737648248672485
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 19.27669596672058
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 18.95055866241455
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 18.391729593276978
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 18.602919578552246
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 18.688096523284912
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 18.15324831008911
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 17.99608325958252
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 18.469741344451904
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 17.720772981643677
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 19.29887294769287
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 19.178600788116455
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 19.27438259124756
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 5148556
model size : 20.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.629356145858765
Epoch: 1, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.212 Vali Acc: 0.375 Test Loss: 2.212 Test Acc: 0.375
Validation loss decreased (inf --> -0.374978).  Saving model ...
Epoch: 2 cost time: 8.13664197921753
Epoch: 2, Steps: 7 | Train Loss: 1.659 Vali Loss: 1.174 Vali Acc: 0.778 Test Loss: 1.174 Test Acc: 0.778
Validation loss decreased (-0.374978 --> -0.777766).  Saving model ...
Epoch: 3 cost time: 8.005989789962769
Epoch: 3, Steps: 7 | Train Loss: 0.656 Vali Loss: 0.639 Vali Acc: 0.903 Test Loss: 0.639 Test Acc: 0.903
Validation loss decreased (-0.777766 --> -0.902771).  Saving model ...
Epoch: 4 cost time: 8.066513538360596
Epoch: 4, Steps: 7 | Train Loss: 0.198 Vali Loss: 0.387 Vali Acc: 0.903 Test Loss: 0.387 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 8.036289691925049
Epoch: 5, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.319 Vali Acc: 0.931 Test Loss: 0.319 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 7.94976806640625
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.08328652381897
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.992219924926758
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.005462646484375
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 7.484757661819458
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 7.231180906295776
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.581275701522827
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.814371347427368
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.033637046813965
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.142055034637451
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.586909294128418
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 8.020053148269653
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 8.049835205078125
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 8.028103590011597
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 7.942738056182861
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 7.173539400100708
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 7.122527122497559
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.2593207359313965
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.290095567703247
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 7.939937353134155
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.8145482540130615
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 7.0393617153167725
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 8.298983573913574
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 8.074477195739746
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 8.048579454421997
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1838220
model size : 7.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 16.40913724899292
Epoch: 1, Steps: 7 | Train Loss: 2.450 Vali Loss: 2.163 Vali Acc: 0.444 Test Loss: 2.163 Test Acc: 0.444
Validation loss decreased (inf --> -0.444423).  Saving model ...
Epoch: 2 cost time: 14.546802043914795
Epoch: 2, Steps: 7 | Train Loss: 1.673 Vali Loss: 1.150 Vali Acc: 0.764 Test Loss: 1.150 Test Acc: 0.764
Validation loss decreased (-0.444423 --> -0.763877).  Saving model ...
Epoch: 3 cost time: 14.587106704711914
Epoch: 3, Steps: 7 | Train Loss: 0.635 Vali Loss: 0.567 Vali Acc: 0.889 Test Loss: 0.567 Test Acc: 0.889
Validation loss decreased (-0.763877 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 13.870760202407837
Epoch: 4, Steps: 7 | Train Loss: 0.201 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
Validation loss decreased (-0.888883 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 13.39899468421936
Epoch: 5, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 14.450177669525146
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.15876817703247
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 13.594471454620361
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 13.42012333869934
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 10 cost time: 13.737623929977417
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 14.89682912826538
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 13.823827743530273
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 13.497781991958618
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 12.765189170837402
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 13.374101877212524
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.31140947341919
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 14.147510766983032
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 13.654100179672241
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 12.36577844619751
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.136310338973999
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 13.420312643051147
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 13.888408422470093
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 13.463496208190918
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 12.81427788734436
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 14.10015344619751
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 14.621991395950317
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 14.689250469207764
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 14.81980562210083
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 13.764034509658813
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 13.82250165939331
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 5148556
model size : 20.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.042685508728027
Epoch: 1, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.212 Vali Acc: 0.375 Test Loss: 2.212 Test Acc: 0.375
Validation loss decreased (inf --> -0.374978).  Saving model ...
Epoch: 2 cost time: 6.3474202156066895
Epoch: 2, Steps: 7 | Train Loss: 1.659 Vali Loss: 1.174 Vali Acc: 0.778 Test Loss: 1.174 Test Acc: 0.778
Validation loss decreased (-0.374978 --> -0.777766).  Saving model ...
Epoch: 3 cost time: 6.303300857543945
Epoch: 3, Steps: 7 | Train Loss: 0.656 Vali Loss: 0.639 Vali Acc: 0.903 Test Loss: 0.639 Test Acc: 0.903
Validation loss decreased (-0.777766 --> -0.902771).  Saving model ...
Epoch: 4 cost time: 6.449387788772583
Epoch: 4, Steps: 7 | Train Loss: 0.198 Vali Loss: 0.387 Vali Acc: 0.903 Test Loss: 0.387 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 6.066730737686157
Epoch: 5, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.319 Vali Acc: 0.931 Test Loss: 0.319 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 6.012084722518921
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.813902378082275
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.286269187927246
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.651756525039673
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 6.0853729248046875
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 6.344135046005249
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.463717937469482
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.283550977706909
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.518872261047363
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.199587106704712
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.215865135192871
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 6.0827343463897705
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 6.2998206615448
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 6.3858864307403564
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 6.704668283462524
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 6.658147811889648
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 6.7492382526397705
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.7569990158081055
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.729665517807007
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 6.239437103271484
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.947251796722412
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.965128660202026
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.877132177352905
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.3824782371521
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.627593040466309
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1838220
model size : 7.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.277365684509277
Epoch: 1, Steps: 7 | Train Loss: 2.450 Vali Loss: 2.163 Vali Acc: 0.444 Test Loss: 2.163 Test Acc: 0.444
Validation loss decreased (inf --> -0.444423).  Saving model ...
Epoch: 2 cost time: 9.4957914352417
Epoch: 2, Steps: 7 | Train Loss: 1.673 Vali Loss: 1.150 Vali Acc: 0.764 Test Loss: 1.150 Test Acc: 0.764
Validation loss decreased (-0.444423 --> -0.763877).  Saving model ...
Epoch: 3 cost time: 9.06161880493164
Epoch: 3, Steps: 7 | Train Loss: 0.636 Vali Loss: 0.567 Vali Acc: 0.889 Test Loss: 0.567 Test Acc: 0.889
Validation loss decreased (-0.763877 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 9.043755054473877
Epoch: 4, Steps: 7 | Train Loss: 0.201 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
Validation loss decreased (-0.888883 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 9.012371063232422
Epoch: 5, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 9.175267934799194
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.810198068618774
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.402323484420776
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 10.44706416130066
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 10 cost time: 10.437738418579102
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 9.855008840560913
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 9.503140687942505
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 9.378331899642944
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 9.339502096176147
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 9.998590469360352
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.329501390457153
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.514663219451904
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.794483661651611
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.060265302658081
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.867837190628052
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 9.020971298217773
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 9.047391653060913
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 9.655981063842773
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 9.52289605140686
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 9.506760358810425
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.441992044448853
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.042986869812012
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 8.73496699333191
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 9.201199293136597
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 9.09174919128418
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 5148556
model size : 20.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.891450881958008
Epoch: 1, Steps: 7 | Train Loss: 2.523 Vali Loss: 2.212 Vali Acc: 0.375 Test Loss: 2.212 Test Acc: 0.375
Validation loss decreased (inf --> -0.374978).  Saving model ...
Epoch: 2 cost time: 5.358100652694702
Epoch: 2, Steps: 7 | Train Loss: 1.659 Vali Loss: 1.174 Vali Acc: 0.778 Test Loss: 1.174 Test Acc: 0.778
Validation loss decreased (-0.374978 --> -0.777766).  Saving model ...
Epoch: 3 cost time: 5.028402090072632
Epoch: 3, Steps: 7 | Train Loss: 0.656 Vali Loss: 0.639 Vali Acc: 0.903 Test Loss: 0.639 Test Acc: 0.903
Validation loss decreased (-0.777766 --> -0.902771).  Saving model ...
Epoch: 4 cost time: 5.112308740615845
Epoch: 4, Steps: 7 | Train Loss: 0.198 Vali Loss: 0.387 Vali Acc: 0.903 Test Loss: 0.387 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 5.231320381164551
Epoch: 5, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.319 Vali Acc: 0.931 Test Loss: 0.319 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 5.2357423305511475
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.1297900676727295
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.313837051391602
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.329531908035278
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 5.0333476066589355
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 5.199339866638184
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.572714805603027
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.434812545776367
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.184088945388794
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.344465494155884
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.100768804550171
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 5.043078899383545
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 5.2475011348724365
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 5.396602153778076
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 4.795018672943115
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 4.741073846817017
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 5.080555438995361
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.810824632644653
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.667647838592529
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 4.730448484420776
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.993536472320557
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.936810731887817
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.7708446979522705
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.080416202545166
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.004996299743652
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1838220
model size : 7.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 15.833953619003296
Epoch: 1, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.059 Vali Acc: 0.569 Test Loss: 2.059 Test Acc: 0.569
Validation loss decreased (inf --> -0.569424).  Saving model ...
Epoch: 2 cost time: 14.562657117843628
Epoch: 2, Steps: 7 | Train Loss: 1.592 Vali Loss: 1.081 Vali Acc: 0.833 Test Loss: 1.081 Test Acc: 0.833
Validation loss decreased (-0.569424 --> -0.833323).  Saving model ...
Epoch: 3 cost time: 14.756449937820435
Epoch: 3, Steps: 7 | Train Loss: 0.600 Vali Loss: 0.470 Vali Acc: 0.917 Test Loss: 0.470 Test Acc: 0.917
Validation loss decreased (-0.833323 --> -0.916662).  Saving model ...
Epoch: 4 cost time: 14.861388683319092
Epoch: 4, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.610016822814941
Epoch: 5, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.916662 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 16.871251344680786
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958332).  Saving model ...
Epoch: 7 cost time: 14.411317825317383
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 8 cost time: 13.888468742370605
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 9 cost time: 13.727976560592651
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 10 cost time: 13.049630165100098
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 13.270456790924072
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 13.276694297790527
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 12.726907968521118
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 12.743642807006836
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.490212678909302
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 14.359740257263184
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 15.036780595779419
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.367433786392212
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 14.755792140960693
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 14.616261720657349
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 14.55609941482544
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 22 cost time: 14.761024475097656
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 15.163386106491089
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 14.390089750289917
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 13.568434715270996
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 12.90664792060852
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 15.350951433181763
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 14.901366949081421
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 14.431745290756226
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 14.472254991531372
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 2804876
model size : 11.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.36885380744934
Epoch: 1, Steps: 7 | Train Loss: 2.459 Vali Loss: 2.131 Vali Acc: 0.458 Test Loss: 2.131 Test Acc: 0.458
Validation loss decreased (inf --> -0.458312).  Saving model ...
Epoch: 2 cost time: 6.81506609916687
Epoch: 2, Steps: 7 | Train Loss: 1.624 Vali Loss: 1.121 Vali Acc: 0.806 Test Loss: 1.121 Test Acc: 0.806
Validation loss decreased (-0.458312 --> -0.805544).  Saving model ...
Epoch: 3 cost time: 6.985544204711914
Epoch: 3, Steps: 7 | Train Loss: 0.605 Vali Loss: 0.548 Vali Acc: 0.903 Test Loss: 0.548 Test Acc: 0.903
Validation loss decreased (-0.805544 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 6.981190204620361
Epoch: 4, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 7.177467107772827
Epoch: 5, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 6.41623592376709
Epoch: 6, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.6694231033325195
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.889 Test Loss: 0.213 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.597729921340942
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.054230451583862
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 10 cost time: 6.436827659606934
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 11 cost time: 6.3342907428741455
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 12 cost time: 6.38122296333313
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.13344144821167
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.303869247436523
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.517498016357422
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.867155313491821
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.9090588092803955
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.619489908218384
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.616924524307251
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.446324348449707
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.576939105987549
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1149580
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 11.288962602615356
Epoch: 1, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.060 Vali Acc: 0.556 Test Loss: 2.060 Test Acc: 0.556
Validation loss decreased (inf --> -0.555535).  Saving model ...
Epoch: 2 cost time: 9.44321322441101
Epoch: 2, Steps: 7 | Train Loss: 1.592 Vali Loss: 1.080 Vali Acc: 0.833 Test Loss: 1.080 Test Acc: 0.833
Validation loss decreased (-0.555535 --> -0.833323).  Saving model ...
Epoch: 3 cost time: 9.505406379699707
Epoch: 3, Steps: 7 | Train Loss: 0.600 Vali Loss: 0.469 Vali Acc: 0.917 Test Loss: 0.469 Test Acc: 0.917
Validation loss decreased (-0.833323 --> -0.916662).  Saving model ...
Epoch: 4 cost time: 9.379497766494751
Epoch: 4, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.724523544311523
Epoch: 5, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.916662 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 9.886585235595703
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958332).  Saving model ...
Epoch: 7 cost time: 10.33590817451477
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 8 cost time: 9.810350179672241
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 9 cost time: 9.810935974121094
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 10 cost time: 9.792903184890747
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 10.75285816192627
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 10.92015027999878
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 11.034252882003784
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 10.899473428726196
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.518733501434326
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.257158756256104
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.096147060394287
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.790791273117065
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.200439929962158
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 10.174214363098145
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 9.621853113174438
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 22 cost time: 9.10968542098999
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 8.835118055343628
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 8.78891897201538
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 8.86173129081726
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 8.77036714553833
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 10.164575338363647
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 10.5924072265625
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 10.496847867965698
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 10.53512978553772
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 2804876
model size : 11.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.3837196826934814
Epoch: 1, Steps: 7 | Train Loss: 2.459 Vali Loss: 2.129 Vali Acc: 0.458 Test Loss: 2.129 Test Acc: 0.458
Validation loss decreased (inf --> -0.458312).  Saving model ...
Epoch: 2 cost time: 5.143747329711914
Epoch: 2, Steps: 7 | Train Loss: 1.624 Vali Loss: 1.119 Vali Acc: 0.806 Test Loss: 1.119 Test Acc: 0.806
Validation loss decreased (-0.458312 --> -0.805544).  Saving model ...
Epoch: 3 cost time: 5.077525854110718
Epoch: 3, Steps: 7 | Train Loss: 0.605 Vali Loss: 0.548 Vali Acc: 0.903 Test Loss: 0.548 Test Acc: 0.903
Validation loss decreased (-0.805544 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 5.090833902359009
Epoch: 4, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 5.246427059173584
Epoch: 5, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 5.391812086105347
Epoch: 6, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.4339752197265625
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.889 Test Loss: 0.213 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.161030292510986
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.2559380531311035
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 10 cost time: 5.314767837524414
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 11 cost time: 5.270534515380859
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 12 cost time: 5.136375427246094
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.948150157928467
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.900890827178955
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.661750078201294
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.741654872894287
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.707502126693726
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.8127992153167725
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.991825819015503
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.111161470413208
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.143961429595947
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1149580
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.52070927619934
Epoch: 1, Steps: 7 | Train Loss: 2.429 Vali Loss: 2.060 Vali Acc: 0.556 Test Loss: 2.060 Test Acc: 0.556
Validation loss decreased (inf --> -0.555535).  Saving model ...
Epoch: 2 cost time: 6.910823345184326
Epoch: 2, Steps: 7 | Train Loss: 1.591 Vali Loss: 1.080 Vali Acc: 0.833 Test Loss: 1.080 Test Acc: 0.833
Validation loss decreased (-0.555535 --> -0.833323).  Saving model ...
Epoch: 3 cost time: 6.879452466964722
Epoch: 3, Steps: 7 | Train Loss: 0.601 Vali Loss: 0.470 Vali Acc: 0.917 Test Loss: 0.470 Test Acc: 0.917
Validation loss decreased (-0.833323 --> -0.916662).  Saving model ...
Epoch: 4 cost time: 6.884795904159546
Epoch: 4, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.9666290283203125
Epoch: 5, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.916662 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 7.383103847503662
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958332).  Saving model ...
Epoch: 7 cost time: 7.387612342834473
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 8 cost time: 7.35317063331604
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 9 cost time: 6.914809703826904
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 10 cost time: 6.998408794403076
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 7.138043403625488
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 6.955850601196289
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 6.998279571533203
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 6.921166658401489
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.0685038566589355
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.2742767333984375
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.285574674606323
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.607063293457031
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.755414247512817
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 6.893116474151611
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 6.956679105758667
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 22 cost time: 6.864140272140503
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 6.189528703689575
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 6.295377016067505
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 6.362953186035156
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 6.256981611251831
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 6.4161248207092285
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 6.2332422733306885
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 6.684067726135254
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.662527799606323
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 2804876
model size : 11.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.87822699546814
Epoch: 1, Steps: 7 | Train Loss: 2.459 Vali Loss: 2.129 Vali Acc: 0.458 Test Loss: 2.129 Test Acc: 0.458
Validation loss decreased (inf --> -0.458312).  Saving model ...
Epoch: 2 cost time: 3.3231873512268066
Epoch: 2, Steps: 7 | Train Loss: 1.624 Vali Loss: 1.119 Vali Acc: 0.806 Test Loss: 1.119 Test Acc: 0.806
Validation loss decreased (-0.458312 --> -0.805544).  Saving model ...
Epoch: 3 cost time: 3.4892184734344482
Epoch: 3, Steps: 7 | Train Loss: 0.605 Vali Loss: 0.548 Vali Acc: 0.903 Test Loss: 0.548 Test Acc: 0.903
Validation loss decreased (-0.805544 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 3.5915606021881104
Epoch: 4, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 3.418790817260742
Epoch: 5, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 3.3088388442993164
Epoch: 6, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2756943702697754
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.889 Test Loss: 0.213 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.322948932647705
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.446225166320801
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 10 cost time: 3.268003463745117
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 11 cost time: 3.2623190879821777
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 12 cost time: 3.3286666870117188
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2268760204315186
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4583423137664795
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3074660301208496
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.096057891845703
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.0608394145965576
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.3079347610473633
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.5971314907073975
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.448549509048462
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.7675139904022217
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1149580
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 21.89668345451355
Epoch: 1, Steps: 7 | Train Loss: 2.547 Vali Loss: 2.319 Vali Acc: 0.222 Test Loss: 2.319 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 20.3238263130188
Epoch: 2, Steps: 7 | Train Loss: 2.115 Vali Loss: 1.698 Vali Acc: 0.750 Test Loss: 1.698 Test Acc: 0.750
Validation loss decreased (-0.222199 --> -0.749983).  Saving model ...
Epoch: 3 cost time: 18.67180371284485
Epoch: 3, Steps: 7 | Train Loss: 1.359 Vali Loss: 1.092 Vali Acc: 0.861 Test Loss: 1.092 Test Acc: 0.861
Validation loss decreased (-0.749983 --> -0.861100).  Saving model ...
Epoch: 4 cost time: 18.019161701202393
Epoch: 4, Steps: 7 | Train Loss: 0.716 Vali Loss: 0.709 Vali Acc: 0.903 Test Loss: 0.709 Test Acc: 0.903
Validation loss decreased (-0.861100 --> -0.902771).  Saving model ...
Epoch: 5 cost time: 18.155296325683594
Epoch: 5, Steps: 7 | Train Loss: 0.340 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.371299982070923
Epoch: 6, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 17.598268508911133
Epoch: 7, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.095706462860107
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 16.445777893066406
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 16.891509771347046
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 18.809810876846313
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 18.493966579437256
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 18.843644857406616
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 18.534926414489746
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 17.84892177581787
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 16.137178897857666
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 16.600640773773193
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 16.929099559783936
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 16.262149810791016
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 17.327751398086548
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 17.037806510925293
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 16.5123131275177
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 17.961820602416992
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 18.34483313560486
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 14.906411170959473
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 17.981370210647583
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 17.1132869720459
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 17.563081979751587
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 16.81178379058838
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 18.61516308784485
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 2575052
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.261369228363037
Epoch: 1, Steps: 7 | Train Loss: 2.411 Vali Loss: 2.327 Vali Acc: 0.264 Test Loss: 2.327 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 8.63577675819397
Epoch: 2, Steps: 7 | Train Loss: 2.011 Vali Loss: 1.692 Vali Acc: 0.611 Test Loss: 1.692 Test Acc: 0.611
Validation loss decreased (-0.263866 --> -0.611094).  Saving model ...
Epoch: 3 cost time: 8.235190391540527
Epoch: 3, Steps: 7 | Train Loss: 1.269 Vali Loss: 1.090 Vali Acc: 0.750 Test Loss: 1.090 Test Acc: 0.750
Validation loss decreased (-0.611094 --> -0.749989).  Saving model ...
Epoch: 4 cost time: 8.060940265655518
Epoch: 4, Steps: 7 | Train Loss: 0.667 Vali Loss: 0.709 Vali Acc: 0.833 Test Loss: 0.709 Test Acc: 0.833
Validation loss decreased (-0.749989 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 8.12757921218872
Epoch: 5, Steps: 7 | Train Loss: 0.304 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 8.225065469741821
Epoch: 6, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.393 Vali Acc: 0.903 Test Loss: 0.393 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 8.171932220458984
Epoch: 7, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 8.101417779922485
Epoch: 8, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.302 Vali Acc: 0.944 Test Loss: 0.302 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 8.00094223022461
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 7.865088701248169
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 7.963595628738403
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 7.857092380523682
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 7.331832647323608
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 8.550444602966309
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.019209861755371
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.869798421859741
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.332035541534424
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.306029319763184
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.444941997528076
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.493984937667847
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 8.49065375328064
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 8.774556159973145
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 8.742847442626953
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.789666175842285
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 8.90137267112732
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 8.81214189529419
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 8.965422630310059
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 8.260368347167969
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 8.182799816131592
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 8.326164722442627
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 919628
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 15.288251399993896
Epoch: 1, Steps: 7 | Train Loss: 2.547 Vali Loss: 2.319 Vali Acc: 0.222 Test Loss: 2.319 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 13.833999395370483
Epoch: 2, Steps: 7 | Train Loss: 2.115 Vali Loss: 1.698 Vali Acc: 0.750 Test Loss: 1.698 Test Acc: 0.750
Validation loss decreased (-0.222199 --> -0.749983).  Saving model ...
Epoch: 3 cost time: 13.914074897766113
Epoch: 3, Steps: 7 | Train Loss: 1.359 Vali Loss: 1.092 Vali Acc: 0.861 Test Loss: 1.092 Test Acc: 0.861
Validation loss decreased (-0.749983 --> -0.861100).  Saving model ...
Epoch: 4 cost time: 13.22864031791687
Epoch: 4, Steps: 7 | Train Loss: 0.716 Vali Loss: 0.709 Vali Acc: 0.903 Test Loss: 0.709 Test Acc: 0.903
Validation loss decreased (-0.861100 --> -0.902771).  Saving model ...
Epoch: 5 cost time: 13.885737657546997
Epoch: 5, Steps: 7 | Train Loss: 0.340 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.346781969070435
Epoch: 6, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.230215787887573
Epoch: 7, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.677475690841675
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.296241044998169
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.349699974060059
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.077115058898926
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.903196573257446
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 12.079686880111694
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 10.707499980926514
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 10.838651657104492
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 11.268849849700928
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.020112037658691
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 12.460754871368408
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 12.409073114395142
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 13.410520553588867
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 13.625619649887085
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 12.563632011413574
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 12.4262056350708
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 13.149963855743408
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 12.666125059127808
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 11.734548330307007
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 11.690704107284546
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 12.567147016525269
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 12.926103115081787
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 11.876315832138062
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 2575052
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.5536274909973145
Epoch: 1, Steps: 7 | Train Loss: 2.411 Vali Loss: 2.327 Vali Acc: 0.264 Test Loss: 2.327 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 5.977051734924316
Epoch: 2, Steps: 7 | Train Loss: 2.011 Vali Loss: 1.692 Vali Acc: 0.611 Test Loss: 1.692 Test Acc: 0.611
Validation loss decreased (-0.263866 --> -0.611094).  Saving model ...
Epoch: 3 cost time: 5.894251108169556
Epoch: 3, Steps: 7 | Train Loss: 1.269 Vali Loss: 1.090 Vali Acc: 0.750 Test Loss: 1.090 Test Acc: 0.750
Validation loss decreased (-0.611094 --> -0.749989).  Saving model ...
Epoch: 4 cost time: 5.612168788909912
Epoch: 4, Steps: 7 | Train Loss: 0.667 Vali Loss: 0.709 Vali Acc: 0.833 Test Loss: 0.709 Test Acc: 0.833
Validation loss decreased (-0.749989 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 5.715385675430298
Epoch: 5, Steps: 7 | Train Loss: 0.304 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 5.545658111572266
Epoch: 6, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.393 Vali Acc: 0.903 Test Loss: 0.393 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 5.722076177597046
Epoch: 7, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 6.016686677932739
Epoch: 8, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.302 Vali Acc: 0.944 Test Loss: 0.302 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 6.033575057983398
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 6.079633951187134
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 5.565521955490112
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 5.251598358154297
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 5.232219934463501
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 5.1837074756622314
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.357811212539673
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.805422306060791
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.658289670944214
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.96415376663208
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.463279724121094
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.729684114456177
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 5.768434524536133
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 5.558753728866577
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 6.029847145080566
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.272541046142578
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 6.194412469863892
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 6.206000804901123
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.767304420471191
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.85854434967041
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.92819881439209
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.829799175262451
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 919628
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.419717788696289
Epoch: 1, Steps: 7 | Train Loss: 2.546 Vali Loss: 2.318 Vali Acc: 0.222 Test Loss: 2.318 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 7.640003442764282
Epoch: 2, Steps: 7 | Train Loss: 2.115 Vali Loss: 1.697 Vali Acc: 0.750 Test Loss: 1.697 Test Acc: 0.750
Validation loss decreased (-0.222199 --> -0.749983).  Saving model ...
Epoch: 3 cost time: 6.827941417694092
Epoch: 3, Steps: 7 | Train Loss: 1.360 Vali Loss: 1.091 Vali Acc: 0.861 Test Loss: 1.091 Test Acc: 0.861
Validation loss decreased (-0.749983 --> -0.861100).  Saving model ...
Epoch: 4 cost time: 6.659206390380859
Epoch: 4, Steps: 7 | Train Loss: 0.719 Vali Loss: 0.708 Vali Acc: 0.903 Test Loss: 0.708 Test Acc: 0.903
Validation loss decreased (-0.861100 --> -0.902771).  Saving model ...
Epoch: 5 cost time: 7.096778869628906
Epoch: 5, Steps: 7 | Train Loss: 0.343 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.636770009994507
Epoch: 6, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.659404039382935
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.532203197479248
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.729112148284912
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.537692546844482
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.013009071350098
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.00413966178894
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 7.46293306350708
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 7.4793219566345215
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 6.980288743972778
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 6.942108392715454
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.831962823867798
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.985886573791504
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.457134962081909
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.257516622543335
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.179912805557251
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 6.746443033218384
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.6083598136901855
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.027217864990234
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.673288583755493
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.059606313705444
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.681900262832642
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.6320106983184814
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 7.631937742233276
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 7.551398277282715
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 2575052
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.931486129760742
Epoch: 1, Steps: 7 | Train Loss: 2.411 Vali Loss: 2.327 Vali Acc: 0.264 Test Loss: 2.327 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 5.05981969833374
Epoch: 2, Steps: 7 | Train Loss: 2.011 Vali Loss: 1.691 Vali Acc: 0.611 Test Loss: 1.691 Test Acc: 0.611
Validation loss decreased (-0.263866 --> -0.611094).  Saving model ...
Epoch: 3 cost time: 5.095809698104858
Epoch: 3, Steps: 7 | Train Loss: 1.269 Vali Loss: 1.090 Vali Acc: 0.750 Test Loss: 1.090 Test Acc: 0.750
Validation loss decreased (-0.611094 --> -0.749989).  Saving model ...
Epoch: 4 cost time: 5.113109588623047
Epoch: 4, Steps: 7 | Train Loss: 0.667 Vali Loss: 0.709 Vali Acc: 0.833 Test Loss: 0.709 Test Acc: 0.833
Validation loss decreased (-0.749989 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 5.0612475872039795
Epoch: 5, Steps: 7 | Train Loss: 0.304 Vali Loss: 0.518 Vali Acc: 0.861 Test Loss: 0.518 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 4.960171461105347
Epoch: 6, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 5.194920301437378
Epoch: 7, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 5.178823232650757
Epoch: 8, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.302 Vali Acc: 0.944 Test Loss: 0.302 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 5.203876733779907
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 5.129662275314331
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 4.863159418106079
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 4.919776916503906
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 4.7221903800964355
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 4.973168134689331
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.038820505142212
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.055165767669678
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.8532750606536865
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.861333131790161
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.897875547409058
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.126773118972778
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 5.018475294113159
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 4.78246545791626
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 4.5767834186553955
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.40041184425354
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 4.557536363601685
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 4.5675153732299805
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.724738359451294
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.752545118331909
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.753969430923462
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.665910482406616
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 919628
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 17.769667863845825
Epoch: 1, Steps: 7 | Train Loss: 2.498 Vali Loss: 2.331 Vali Acc: 0.236 Test Loss: 2.331 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 16.875258922576904
Epoch: 2, Steps: 7 | Train Loss: 2.042 Vali Loss: 1.695 Vali Acc: 0.750 Test Loss: 1.695 Test Acc: 0.750
Validation loss decreased (-0.236088 --> -0.749983).  Saving model ...
Epoch: 3 cost time: 16.934751272201538
Epoch: 3, Steps: 7 | Train Loss: 1.313 Vali Loss: 1.082 Vali Acc: 0.792 Test Loss: 1.082 Test Acc: 0.792
Validation loss decreased (-0.749983 --> -0.791656).  Saving model ...
Epoch: 4 cost time: 16.329392910003662
Epoch: 4, Steps: 7 | Train Loss: 0.649 Vali Loss: 0.645 Vali Acc: 0.889 Test Loss: 0.645 Test Acc: 0.889
Validation loss decreased (-0.791656 --> -0.888882).  Saving model ...
Epoch: 5 cost time: 16.119317770004272
Epoch: 5, Steps: 7 | Train Loss: 0.277 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.60727047920227
Epoch: 6, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.919865608215332
Epoch: 7, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 16.44404935836792
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 17.38363552093506
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 17.42435622215271
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 17.07206654548645
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 16.46941876411438
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 16.897443056106567
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 16.83482050895691
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 17.04242253303528
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 16.543763399124146
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 16.8041832447052
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 15.957445621490479
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 16.68483853340149
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 16.52289342880249
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 17.199870109558105
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 17.009886980056763
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 16.81100630760193
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 16.835373401641846
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 15.793777465820312
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 16.128769874572754
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 15.066306591033936
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 14.983900547027588
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 15.393397331237793
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1402828
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.880115985870361
Epoch: 1, Steps: 7 | Train Loss: 2.456 Vali Loss: 2.314 Vali Acc: 0.222 Test Loss: 2.314 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 8.175037145614624
Epoch: 2, Steps: 7 | Train Loss: 2.056 Vali Loss: 1.696 Vali Acc: 0.667 Test Loss: 1.696 Test Acc: 0.667
Validation loss decreased (-0.222199 --> -0.666650).  Saving model ...
Epoch: 3 cost time: 7.087822675704956
Epoch: 3, Steps: 7 | Train Loss: 1.343 Vali Loss: 1.124 Vali Acc: 0.806 Test Loss: 1.124 Test Acc: 0.806
Validation loss decreased (-0.666650 --> -0.805544).  Saving model ...
Epoch: 4 cost time: 8.452434539794922
Epoch: 4, Steps: 7 | Train Loss: 0.746 Vali Loss: 0.764 Vali Acc: 0.833 Test Loss: 0.764 Test Acc: 0.833
Validation loss decreased (-0.805544 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 7.728597402572632
Epoch: 5, Steps: 7 | Train Loss: 0.376 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 8.175384044647217
Epoch: 6, Steps: 7 | Train Loss: 0.183 Vali Loss: 0.418 Vali Acc: 0.861 Test Loss: 0.418 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 7.794233798980713
Epoch: 7, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 8.229803085327148
Epoch: 8, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.970985174179077
Epoch: 9, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 8.175631284713745
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 7.617058277130127
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 8.007506370544434
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 7.267330646514893
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.436493396759033
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.627453565597534
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.459115266799927
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.3138346672058105
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.849390506744385
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.72087025642395
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.085003614425659
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.071556329727173
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.15169620513916
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 575052
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 11.331138849258423
Epoch: 1, Steps: 7 | Train Loss: 2.498 Vali Loss: 2.332 Vali Acc: 0.236 Test Loss: 2.332 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 9.277278184890747
Epoch: 2, Steps: 7 | Train Loss: 2.042 Vali Loss: 1.695 Vali Acc: 0.750 Test Loss: 1.695 Test Acc: 0.750
Validation loss decreased (-0.236088 --> -0.749983).  Saving model ...
Epoch: 3 cost time: 8.3913893699646
Epoch: 3, Steps: 7 | Train Loss: 1.313 Vali Loss: 1.082 Vali Acc: 0.792 Test Loss: 1.082 Test Acc: 0.792
Validation loss decreased (-0.749983 --> -0.791656).  Saving model ...
Epoch: 4 cost time: 9.771186828613281
Epoch: 4, Steps: 7 | Train Loss: 0.649 Vali Loss: 0.645 Vali Acc: 0.889 Test Loss: 0.645 Test Acc: 0.889
Validation loss decreased (-0.791656 --> -0.888882).  Saving model ...
Epoch: 5 cost time: 9.454617261886597
Epoch: 5, Steps: 7 | Train Loss: 0.277 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.324389696121216
Epoch: 6, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.77933669090271
Epoch: 7, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 9.404191970825195
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 9.386791944503784
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.86223030090332
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.981230974197388
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.76570749282837
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 8.992452383041382
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 9.342413187026978
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 9.12288784980774
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.797470092773438
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 9.775654077529907
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 9.39628791809082
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 10.177371740341187
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 10.33653974533081
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.790049076080322
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.858886480331421
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 9.804072141647339
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 9.311721801757812
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 9.272712707519531
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 8.376045942306519
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 8.983075380325317
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 9.94040298461914
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 9.651015520095825
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1402828
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.097359895706177
Epoch: 1, Steps: 7 | Train Loss: 2.456 Vali Loss: 2.314 Vali Acc: 0.222 Test Loss: 2.314 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 4.456749677658081
Epoch: 2, Steps: 7 | Train Loss: 2.056 Vali Loss: 1.696 Vali Acc: 0.667 Test Loss: 1.696 Test Acc: 0.667
Validation loss decreased (-0.222199 --> -0.666650).  Saving model ...
Epoch: 3 cost time: 4.250158786773682
Epoch: 3, Steps: 7 | Train Loss: 1.343 Vali Loss: 1.124 Vali Acc: 0.806 Test Loss: 1.124 Test Acc: 0.806
Validation loss decreased (-0.666650 --> -0.805544).  Saving model ...
Epoch: 4 cost time: 4.607816934585571
Epoch: 4, Steps: 7 | Train Loss: 0.746 Vali Loss: 0.764 Vali Acc: 0.833 Test Loss: 0.764 Test Acc: 0.833
Validation loss decreased (-0.805544 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 4.722153902053833
Epoch: 5, Steps: 7 | Train Loss: 0.376 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 4.2037036418914795
Epoch: 6, Steps: 7 | Train Loss: 0.183 Vali Loss: 0.418 Vali Acc: 0.861 Test Loss: 0.418 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 4.687134027481079
Epoch: 7, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 4.602900981903076
Epoch: 8, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.690056800842285
Epoch: 9, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 4.64942479133606
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 4.322888135910034
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 4.384501934051514
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 4.3319408893585205
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.6015613079071045
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.741484642028809
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.664523601531982
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.592801570892334
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.841645240783691
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.949183464050293
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.9818408489227295
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.885695219039917
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.697800636291504
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 575052
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.8984057903289795
Epoch: 1, Steps: 7 | Train Loss: 2.498 Vali Loss: 2.332 Vali Acc: 0.236 Test Loss: 2.332 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 6.278340101242065
Epoch: 2, Steps: 7 | Train Loss: 2.042 Vali Loss: 1.695 Vali Acc: 0.750 Test Loss: 1.695 Test Acc: 0.750
Validation loss decreased (-0.236088 --> -0.749983).  Saving model ...
Epoch: 3 cost time: 6.135412216186523
Epoch: 3, Steps: 7 | Train Loss: 1.313 Vali Loss: 1.082 Vali Acc: 0.792 Test Loss: 1.082 Test Acc: 0.792
Validation loss decreased (-0.749983 --> -0.791656).  Saving model ...
Epoch: 4 cost time: 6.2330098152160645
Epoch: 4, Steps: 7 | Train Loss: 0.649 Vali Loss: 0.645 Vali Acc: 0.889 Test Loss: 0.645 Test Acc: 0.889
Validation loss decreased (-0.791656 --> -0.888882).  Saving model ...
Epoch: 5 cost time: 6.401904344558716
Epoch: 5, Steps: 7 | Train Loss: 0.277 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.127201557159424
Epoch: 6, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.8231236934661865
Epoch: 7, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 5.949733018875122
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 6.121551036834717
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.281979084014893
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.944893836975098
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.035184621810913
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 6.1693220138549805
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 6.394378185272217
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 6.253756761550903
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.32875394821167
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 6.488275766372681
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 6.305715560913086
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 6.244221448898315
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.32438063621521
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.464547395706177
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.430352687835693
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.298916816711426
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.060757398605347
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.775864124298096
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.629760503768921
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.6796300411224365
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.7907044887542725
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1402828
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.791330814361572
Epoch: 1, Steps: 7 | Train Loss: 2.457 Vali Loss: 2.313 Vali Acc: 0.222 Test Loss: 2.313 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 3.142103433609009
Epoch: 2, Steps: 7 | Train Loss: 2.056 Vali Loss: 1.696 Vali Acc: 0.667 Test Loss: 1.696 Test Acc: 0.667
Validation loss decreased (-0.222199 --> -0.666650).  Saving model ...
Epoch: 3 cost time: 3.079773187637329
Epoch: 3, Steps: 7 | Train Loss: 1.345 Vali Loss: 1.124 Vali Acc: 0.806 Test Loss: 1.124 Test Acc: 0.806
Validation loss decreased (-0.666650 --> -0.805544).  Saving model ...
Epoch: 4 cost time: 3.378890037536621
Epoch: 4, Steps: 7 | Train Loss: 0.747 Vali Loss: 0.766 Vali Acc: 0.833 Test Loss: 0.766 Test Acc: 0.833
Validation loss decreased (-0.805544 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 3.369514226913452
Epoch: 5, Steps: 7 | Train Loss: 0.377 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 3.438241958618164
Epoch: 6, Steps: 7 | Train Loss: 0.183 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 3.382747173309326
Epoch: 7, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 3.3038170337677
Epoch: 8, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.406000852584839
Epoch: 9, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 3.6268556118011475
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 3.5373640060424805
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 3.510056972503662
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 3.3818421363830566
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.419682741165161
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4563558101654053
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.154223680496216
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.444329023361206
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.7923953533172607
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.783247709274292
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.4366962909698486
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.1522421836853027
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.078040599822998
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 575052
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 13.012574195861816
Epoch: 1, Steps: 7 | Train Loss: 2.370 Vali Loss: 2.273 Vali Acc: 0.347 Test Loss: 2.273 Test Acc: 0.347
Validation loss decreased (inf --> -0.347199).  Saving model ...
Epoch: 2 cost time: 10.780841827392578
Epoch: 2, Steps: 7 | Train Loss: 1.931 Vali Loss: 1.676 Vali Acc: 0.681 Test Loss: 1.676 Test Acc: 0.681
Validation loss decreased (-0.347199 --> -0.680539).  Saving model ...
Epoch: 3 cost time: 11.053679943084717
Epoch: 3, Steps: 7 | Train Loss: 1.207 Vali Loss: 1.089 Vali Acc: 0.806 Test Loss: 1.089 Test Acc: 0.806
Validation loss decreased (-0.680539 --> -0.805545).  Saving model ...
Epoch: 4 cost time: 11.025426149368286
Epoch: 4, Steps: 7 | Train Loss: 0.653 Vali Loss: 0.732 Vali Acc: 0.847 Test Loss: 0.732 Test Acc: 0.847
Validation loss decreased (-0.805545 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 10.87257719039917
Epoch: 5, Steps: 7 | Train Loss: 0.287 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 10.93150281906128
Epoch: 6, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.375 Vali Acc: 0.917 Test Loss: 0.375 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 11.184514045715332
Epoch: 7, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.150354385375977
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.171231031417847
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 11.34062147140503
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 11.628403663635254
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 11.52961254119873
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 11.205330848693848
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 11.835960149765015
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.616161823272705
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 11.34351372718811
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 11.059838056564331
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 10.710599184036255
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.648473978042603
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 10.60966682434082
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.281927347183228
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 10.089980840682983
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 9.866966247558594
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.245674133300781
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 10.859660148620605
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 11.310660362243652
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 11.659584760665894
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 11.713258266448975
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 11.002779483795166
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 11.49077844619751
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 816716
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.893453359603882
Epoch: 1, Steps: 7 | Train Loss: 2.439 Vali Loss: 2.289 Vali Acc: 0.208 Test Loss: 2.289 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 5.356470346450806
Epoch: 2, Steps: 7 | Train Loss: 2.035 Vali Loss: 1.649 Vali Acc: 0.722 Test Loss: 1.649 Test Acc: 0.722
Validation loss decreased (-0.208310 --> -0.722206).  Saving model ...
Epoch: 3 cost time: 5.263774156570435
Epoch: 3, Steps: 7 | Train Loss: 1.220 Vali Loss: 1.098 Vali Acc: 0.792 Test Loss: 1.098 Test Acc: 0.792
Validation loss decreased (-0.722206 --> -0.791656).  Saving model ...
Epoch: 4 cost time: 5.445926904678345
Epoch: 4, Steps: 7 | Train Loss: 0.670 Vali Loss: 0.755 Vali Acc: 0.764 Test Loss: 0.755 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.607313394546509
Epoch: 5, Steps: 7 | Train Loss: 0.335 Vali Loss: 0.567 Vali Acc: 0.875 Test Loss: 0.567 Test Acc: 0.875
Validation loss decreased (-0.791656 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 5.346181392669678
Epoch: 6, Steps: 7 | Train Loss: 0.175 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.308117151260376
Epoch: 7, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.513327121734619
Epoch: 8, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.7624125480651855
Epoch: 9, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 5.642738342285156
Epoch: 10, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 5.935569524765015
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.753239631652832
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.77775764465332
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.110249996185303
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.718766927719116
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.896517276763916
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.925936698913574
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.477840900421143
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 5.290181636810303
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 5.714296817779541
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 5.269650220870972
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.081523895263672
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.314630746841431
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 4.980358600616455
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 4.9580230712890625
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 5.174934148788452
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 4.979839086532593
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 5.284471273422241
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.203488111495972
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.236636400222778
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 402764
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.040283679962158
Epoch: 1, Steps: 7 | Train Loss: 2.370 Vali Loss: 2.273 Vali Acc: 0.347 Test Loss: 2.273 Test Acc: 0.347
Validation loss decreased (inf --> -0.347199).  Saving model ...
Epoch: 2 cost time: 7.751357793807983
Epoch: 2, Steps: 7 | Train Loss: 1.931 Vali Loss: 1.676 Vali Acc: 0.681 Test Loss: 1.676 Test Acc: 0.681
Validation loss decreased (-0.347199 --> -0.680539).  Saving model ...
Epoch: 3 cost time: 7.860713720321655
Epoch: 3, Steps: 7 | Train Loss: 1.207 Vali Loss: 1.089 Vali Acc: 0.806 Test Loss: 1.089 Test Acc: 0.806
Validation loss decreased (-0.680539 --> -0.805545).  Saving model ...
Epoch: 4 cost time: 8.217441320419312
Epoch: 4, Steps: 7 | Train Loss: 0.653 Vali Loss: 0.732 Vali Acc: 0.847 Test Loss: 0.732 Test Acc: 0.847
Validation loss decreased (-0.805545 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 7.998164892196655
Epoch: 5, Steps: 7 | Train Loss: 0.287 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 8.10719609260559
Epoch: 6, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.375 Vali Acc: 0.917 Test Loss: 0.375 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 7.737419128417969
Epoch: 7, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.099671602249146
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.746747255325317
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 8.068622350692749
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 7.8522961139678955
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 7.629834175109863
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 6.761150360107422
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 7.45462703704834
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.389224290847778
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 7.305476188659668
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 7.300735950469971
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 7.387484312057495
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.360049486160278
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.448114633560181
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.777339935302734
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.559249401092529
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 7.5355823040008545
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.507049560546875
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.413351774215698
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 7.1981422901153564
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.285018444061279
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 7.26002311706543
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 7.376055479049683
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 7.229260444641113
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 816716
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.305465459823608
Epoch: 1, Steps: 7 | Train Loss: 2.439 Vali Loss: 2.289 Vali Acc: 0.208 Test Loss: 2.289 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 3.601876735687256
Epoch: 2, Steps: 7 | Train Loss: 2.035 Vali Loss: 1.649 Vali Acc: 0.722 Test Loss: 1.649 Test Acc: 0.722
Validation loss decreased (-0.208310 --> -0.722206).  Saving model ...
Epoch: 3 cost time: 3.7417492866516113
Epoch: 3, Steps: 7 | Train Loss: 1.220 Vali Loss: 1.098 Vali Acc: 0.792 Test Loss: 1.098 Test Acc: 0.792
Validation loss decreased (-0.722206 --> -0.791656).  Saving model ...
Epoch: 4 cost time: 3.7811076641082764
Epoch: 4, Steps: 7 | Train Loss: 0.670 Vali Loss: 0.755 Vali Acc: 0.764 Test Loss: 0.755 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9669997692108154
Epoch: 5, Steps: 7 | Train Loss: 0.335 Vali Loss: 0.567 Vali Acc: 0.875 Test Loss: 0.567 Test Acc: 0.875
Validation loss decreased (-0.791656 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 3.7174625396728516
Epoch: 6, Steps: 7 | Train Loss: 0.175 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.887169122695923
Epoch: 7, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.535897731781006
Epoch: 8, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6789028644561768
Epoch: 9, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 3.3092453479766846
Epoch: 10, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 3.6230545043945312
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5921356678009033
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.687849283218384
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.891326904296875
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.9329442977905273
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.361599445343018
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.122298955917358
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.202585697174072
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 4.239009380340576
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 4.062544822692871
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 4.338006496429443
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.047681093215942
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.609250068664551
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 3.526921510696411
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 4.446141004562378
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 4.44613242149353
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 4.264484405517578
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 4.287909269332886
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.418638706207275
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.129090785980225
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 402764
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.391151189804077
Epoch: 1, Steps: 7 | Train Loss: 2.370 Vali Loss: 2.273 Vali Acc: 0.347 Test Loss: 2.273 Test Acc: 0.347
Validation loss decreased (inf --> -0.347199).  Saving model ...
Epoch: 2 cost time: 4.924570322036743
Epoch: 2, Steps: 7 | Train Loss: 1.931 Vali Loss: 1.675 Vali Acc: 0.681 Test Loss: 1.675 Test Acc: 0.681
Validation loss decreased (-0.347199 --> -0.680539).  Saving model ...
Epoch: 3 cost time: 4.752426385879517
Epoch: 3, Steps: 7 | Train Loss: 1.207 Vali Loss: 1.089 Vali Acc: 0.806 Test Loss: 1.089 Test Acc: 0.806
Validation loss decreased (-0.680539 --> -0.805545).  Saving model ...
Epoch: 4 cost time: 4.556820392608643
Epoch: 4, Steps: 7 | Train Loss: 0.653 Vali Loss: 0.732 Vali Acc: 0.847 Test Loss: 0.732 Test Acc: 0.847
Validation loss decreased (-0.805545 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 4.9001991748809814
Epoch: 5, Steps: 7 | Train Loss: 0.287 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 4.828462839126587
Epoch: 6, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.375 Vali Acc: 0.917 Test Loss: 0.375 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 4.688767194747925
Epoch: 7, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.7674643993377686
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.067903995513916
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 4.408375978469849
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 4.7980451583862305
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 5.6284332275390625
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 5.458552122116089
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 5.2521071434021
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.053184509277344
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 5.517845392227173
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 5.253336429595947
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 5.287782669067383
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.4369893074035645
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.487354040145874
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.355516672134399
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.2639782428741455
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 5.353763818740845
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.473784923553467
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.187387466430664
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 5.19152569770813
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.282658338546753
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 4.855377912521362
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 4.789182424545288
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 4.957131624221802
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 816716
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.238842725753784
Epoch: 1, Steps: 7 | Train Loss: 2.440 Vali Loss: 2.288 Vali Acc: 0.208 Test Loss: 2.288 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 2.792684316635132
Epoch: 2, Steps: 7 | Train Loss: 2.034 Vali Loss: 1.647 Vali Acc: 0.708 Test Loss: 1.647 Test Acc: 0.708
Validation loss decreased (-0.208310 --> -0.708317).  Saving model ...
Epoch: 3 cost time: 2.9737281799316406
Epoch: 3, Steps: 7 | Train Loss: 1.219 Vali Loss: 1.096 Vali Acc: 0.792 Test Loss: 1.096 Test Acc: 0.792
Validation loss decreased (-0.708317 --> -0.791656).  Saving model ...
Epoch: 4 cost time: 2.79268741607666
Epoch: 4, Steps: 7 | Train Loss: 0.672 Vali Loss: 0.752 Vali Acc: 0.764 Test Loss: 0.752 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7525529861450195
Epoch: 5, Steps: 7 | Train Loss: 0.336 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
Validation loss decreased (-0.791656 --> -0.861105).  Saving model ...
Epoch: 6 cost time: 2.8523333072662354
Epoch: 6, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 2.9405698776245117
Epoch: 7, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8836236000061035
Epoch: 8, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.187802314758301
Epoch: 9, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 3.070000171661377
Epoch: 10, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 3.1401734352111816
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.070885419845581
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.145486354827881
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1701552867889404
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.053588628768921
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.038060426712036
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.061927556991577
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1804616451263428
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 3.201498031616211
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 3.1334927082061768
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0837883949279785
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.002737283706665
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.0533981323242188
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.235595703125
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.2663767337799072
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.387430429458618
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 3.7874183654785156
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.864362955093384
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.7065141201019287
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.7635984420776367
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 402764
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 19.74496817588806
Epoch: 1, Steps: 7 | Train Loss: 2.644 Vali Loss: 2.507 Vali Acc: 0.125 Test Loss: 2.507 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 16.870920181274414
Epoch: 2, Steps: 7 | Train Loss: 2.382 Vali Loss: 2.137 Vali Acc: 0.611 Test Loss: 2.137 Test Acc: 0.611
Validation loss decreased (-0.124975 --> -0.611090).  Saving model ...
Epoch: 3 cost time: 17.151581048965454
Epoch: 3, Steps: 7 | Train Loss: 1.930 Vali Loss: 1.666 Vali Acc: 0.764 Test Loss: 1.666 Test Acc: 0.764
Validation loss decreased (-0.611090 --> -0.763872).  Saving model ...
Epoch: 4 cost time: 17.606717824935913
Epoch: 4, Steps: 7 | Train Loss: 1.392 Vali Loss: 1.229 Vali Acc: 0.861 Test Loss: 1.229 Test Acc: 0.861
Validation loss decreased (-0.763872 --> -0.861099).  Saving model ...
Epoch: 5 cost time: 15.936249256134033
Epoch: 5, Steps: 7 | Train Loss: 0.943 Vali Loss: 0.880 Vali Acc: 0.833 Test Loss: 0.880 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.56153702735901
Epoch: 6, Steps: 7 | Train Loss: 0.576 Vali Loss: 0.635 Vali Acc: 0.861 Test Loss: 0.635 Test Acc: 0.861
Validation loss decreased (-0.861099 --> -0.861105).  Saving model ...
Epoch: 7 cost time: 17.44664478302002
Epoch: 7, Steps: 7 | Train Loss: 0.324 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 17.5512113571167
Epoch: 8, Steps: 7 | Train Loss: 0.179 Vali Loss: 0.370 Vali Acc: 0.903 Test Loss: 0.370 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 17.909416437149048
Epoch: 9, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 17.894959211349487
Epoch: 10, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 17.46063780784607
Epoch: 11, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 17.915478944778442
Epoch: 12, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 17.323200464248657
Epoch: 13, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 16.473702907562256
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 17.68558096885681
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 17.737288236618042
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 17.73741340637207
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 18.797691583633423
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 19.11918807029724
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 18.104021072387695
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 18.322397470474243
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 15.08306336402893
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 18.319367170333862
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 17.568759441375732
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 16.390280723571777
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 16.180155038833618
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 15.959305763244629
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 16.87196946144104
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 17.38671112060547
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 18.004830598831177
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1288300
model size : 5.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.677342414855957
Epoch: 1, Steps: 7 | Train Loss: 2.562 Vali Loss: 2.493 Vali Acc: 0.181 Test Loss: 2.493 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 8.6128249168396
Epoch: 2, Steps: 7 | Train Loss: 2.264 Vali Loss: 2.145 Vali Acc: 0.472 Test Loss: 2.145 Test Acc: 0.472
Validation loss decreased (-0.180531 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 8.724415302276611
Epoch: 3, Steps: 7 | Train Loss: 1.888 Vali Loss: 1.732 Vali Acc: 0.694 Test Loss: 1.732 Test Acc: 0.694
Validation loss decreased (-0.472201 --> -0.694427).  Saving model ...
Epoch: 4 cost time: 8.321393013000488
Epoch: 4, Steps: 7 | Train Loss: 1.420 Vali Loss: 1.376 Vali Acc: 0.778 Test Loss: 1.376 Test Acc: 0.778
Validation loss decreased (-0.694427 --> -0.777764).  Saving model ...
Epoch: 5 cost time: 8.278315305709839
Epoch: 5, Steps: 7 | Train Loss: 1.006 Vali Loss: 1.079 Vali Acc: 0.847 Test Loss: 1.079 Test Acc: 0.847
Validation loss decreased (-0.777764 --> -0.847211).  Saving model ...
Epoch: 6 cost time: 8.108904123306274
Epoch: 6, Steps: 7 | Train Loss: 0.653 Vali Loss: 0.840 Vali Acc: 0.847 Test Loss: 0.840 Test Acc: 0.847
Validation loss decreased (-0.847211 --> -0.847214).  Saving model ...
Epoch: 7 cost time: 8.364301681518555
Epoch: 7, Steps: 7 | Train Loss: 0.428 Vali Loss: 0.698 Vali Acc: 0.847 Test Loss: 0.698 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847215).  Saving model ...
Epoch: 8 cost time: 8.20306944847107
Epoch: 8, Steps: 7 | Train Loss: 0.251 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861105).  Saving model ...
Epoch: 9 cost time: 8.318263053894043
Epoch: 9, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.565 Vali Acc: 0.875 Test Loss: 0.565 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874994).  Saving model ...
Epoch: 10 cost time: 8.232476234436035
Epoch: 10, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 11 cost time: 7.52588152885437
Epoch: 11, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.460 Vali Acc: 0.903 Test Loss: 0.460 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902773).  Saving model ...
Epoch: 12 cost time: 7.860366582870483
Epoch: 12, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.676904678344727
Epoch: 13, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.423 Vali Acc: 0.903 Test Loss: 0.423 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 7.764636754989624
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.405 Vali Acc: 0.903 Test Loss: 0.405 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 8.153656482696533
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 7.844240427017212
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.385 Vali Acc: 0.903 Test Loss: 0.385 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 8.776997089385986
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 18 cost time: 8.279187440872192
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 19 cost time: 8.901942491531372
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.370 Vali Acc: 0.903 Test Loss: 0.370 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 20 cost time: 8.355690956115723
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 21 cost time: 7.411230087280273
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 8.71580719947815
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 8.3014075756073
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.788964986801147
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.352 Vali Acc: 0.903 Test Loss: 0.352 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 8.125534296035767
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 8.90003752708435
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 8.667585611343384
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 9.087713241577148
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 8.653254508972168
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 30 cost time: 8.336262702941895
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 460332
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 15.20799732208252
Epoch: 1, Steps: 7 | Train Loss: 2.644 Vali Loss: 2.507 Vali Acc: 0.125 Test Loss: 2.507 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 12.765986680984497
Epoch: 2, Steps: 7 | Train Loss: 2.382 Vali Loss: 2.137 Vali Acc: 0.611 Test Loss: 2.137 Test Acc: 0.611
Validation loss decreased (-0.124975 --> -0.611090).  Saving model ...
Epoch: 3 cost time: 12.082123041152954
Epoch: 3, Steps: 7 | Train Loss: 1.930 Vali Loss: 1.666 Vali Acc: 0.764 Test Loss: 1.666 Test Acc: 0.764
Validation loss decreased (-0.611090 --> -0.763872).  Saving model ...
Epoch: 4 cost time: 12.152166604995728
Epoch: 4, Steps: 7 | Train Loss: 1.392 Vali Loss: 1.229 Vali Acc: 0.861 Test Loss: 1.229 Test Acc: 0.861
Validation loss decreased (-0.763872 --> -0.861099).  Saving model ...
Epoch: 5 cost time: 13.154098749160767
Epoch: 5, Steps: 7 | Train Loss: 0.943 Vali Loss: 0.880 Vali Acc: 0.833 Test Loss: 0.880 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.764176368713379
Epoch: 6, Steps: 7 | Train Loss: 0.576 Vali Loss: 0.635 Vali Acc: 0.861 Test Loss: 0.635 Test Acc: 0.861
Validation loss decreased (-0.861099 --> -0.861105).  Saving model ...
Epoch: 7 cost time: 12.61764669418335
Epoch: 7, Steps: 7 | Train Loss: 0.324 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 13.6070876121521
Epoch: 8, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.371 Vali Acc: 0.903 Test Loss: 0.371 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 13.5266695022583
Epoch: 9, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 12.657873392105103
Epoch: 10, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 13.449975490570068
Epoch: 11, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 14.401293754577637
Epoch: 12, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 13.577322006225586
Epoch: 13, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.316032648086548
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.879117250442505
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 13.348495244979858
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.593339681625366
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 12.124918222427368
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 14.066220998764038
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 13.777864217758179
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 13.50253963470459
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 13.883036613464355
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 14.416613101959229
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 13.69526195526123
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 12.787429332733154
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 13.083972215652466
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 12.556969404220581
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 12.523979902267456
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1288300
model size : 5.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.111090898513794
Epoch: 1, Steps: 7 | Train Loss: 2.562 Vali Loss: 2.493 Vali Acc: 0.181 Test Loss: 2.493 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 5.590530633926392
Epoch: 2, Steps: 7 | Train Loss: 2.264 Vali Loss: 2.145 Vali Acc: 0.472 Test Loss: 2.145 Test Acc: 0.472
Validation loss decreased (-0.180531 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 5.9028120040893555
Epoch: 3, Steps: 7 | Train Loss: 1.888 Vali Loss: 1.732 Vali Acc: 0.694 Test Loss: 1.732 Test Acc: 0.694
Validation loss decreased (-0.472201 --> -0.694427).  Saving model ...
Epoch: 4 cost time: 5.944483518600464
Epoch: 4, Steps: 7 | Train Loss: 1.420 Vali Loss: 1.376 Vali Acc: 0.778 Test Loss: 1.376 Test Acc: 0.778
Validation loss decreased (-0.694427 --> -0.777764).  Saving model ...
Epoch: 5 cost time: 6.40896463394165
Epoch: 5, Steps: 7 | Train Loss: 1.006 Vali Loss: 1.079 Vali Acc: 0.847 Test Loss: 1.079 Test Acc: 0.847
Validation loss decreased (-0.777764 --> -0.847211).  Saving model ...
Epoch: 6 cost time: 6.51364803314209
Epoch: 6, Steps: 7 | Train Loss: 0.653 Vali Loss: 0.840 Vali Acc: 0.847 Test Loss: 0.840 Test Acc: 0.847
Validation loss decreased (-0.847211 --> -0.847214).  Saving model ...
Epoch: 7 cost time: 6.392102479934692
Epoch: 7, Steps: 7 | Train Loss: 0.428 Vali Loss: 0.698 Vali Acc: 0.847 Test Loss: 0.698 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847215).  Saving model ...
Epoch: 8 cost time: 6.765911102294922
Epoch: 8, Steps: 7 | Train Loss: 0.251 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861105).  Saving model ...
Epoch: 9 cost time: 6.39879846572876
Epoch: 9, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.565 Vali Acc: 0.875 Test Loss: 0.565 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874994).  Saving model ...
Epoch: 10 cost time: 6.3347413539886475
Epoch: 10, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 11 cost time: 4.928373336791992
Epoch: 11, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.460 Vali Acc: 0.903 Test Loss: 0.460 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902773).  Saving model ...
Epoch: 12 cost time: 5.359577178955078
Epoch: 12, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.053434610366821
Epoch: 13, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.423 Vali Acc: 0.903 Test Loss: 0.423 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 6.5646586418151855
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.405 Vali Acc: 0.903 Test Loss: 0.405 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 7.131509065628052
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 6.846993684768677
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.385 Vali Acc: 0.903 Test Loss: 0.385 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 7.329930782318115
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 18 cost time: 7.1330671310424805
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 19 cost time: 7.066754102706909
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.370 Vali Acc: 0.903 Test Loss: 0.370 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 20 cost time: 6.882312536239624
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 21 cost time: 6.826220750808716
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 7.332583665847778
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 6.372617483139038
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.873437881469727
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.352 Vali Acc: 0.903 Test Loss: 0.352 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 6.092763423919678
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 6.882435321807861
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 6.560749292373657
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 6.612609624862671
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.0379860401153564
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 30 cost time: 6.4919960498809814
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 460332
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.431304454803467
Epoch: 1, Steps: 7 | Train Loss: 2.640 Vali Loss: 2.509 Vali Acc: 0.125 Test Loss: 2.509 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 8.88931131362915
Epoch: 2, Steps: 7 | Train Loss: 2.380 Vali Loss: 2.143 Vali Acc: 0.597 Test Loss: 2.143 Test Acc: 0.597
Validation loss decreased (-0.124975 --> -0.597201).  Saving model ...
Epoch: 3 cost time: 8.725154161453247
Epoch: 3, Steps: 7 | Train Loss: 1.930 Vali Loss: 1.677 Vali Acc: 0.764 Test Loss: 1.677 Test Acc: 0.764
Validation loss decreased (-0.597201 --> -0.763872).  Saving model ...
Epoch: 4 cost time: 8.604163646697998
Epoch: 4, Steps: 7 | Train Loss: 1.398 Vali Loss: 1.244 Vali Acc: 0.861 Test Loss: 1.244 Test Acc: 0.861
Validation loss decreased (-0.763872 --> -0.861099).  Saving model ...
Epoch: 5 cost time: 8.881340265274048
Epoch: 5, Steps: 7 | Train Loss: 0.953 Vali Loss: 0.898 Vali Acc: 0.847 Test Loss: 0.898 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.607722282409668
Epoch: 6, Steps: 7 | Train Loss: 0.584 Vali Loss: 0.657 Vali Acc: 0.861 Test Loss: 0.657 Test Acc: 0.861
Validation loss decreased (-0.861099 --> -0.861105).  Saving model ...
Epoch: 7 cost time: 8.033624649047852
Epoch: 7, Steps: 7 | Train Loss: 0.334 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 8.504533529281616
Epoch: 8, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 7.789771556854248
Epoch: 9, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 7.705474615097046
Epoch: 10, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 7.292436838150024
Epoch: 11, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.671228408813477
Epoch: 12, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 8.121667623519897
Epoch: 13, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.03112268447876
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.582608699798584
Epoch: 15, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.836489200592041
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 8.301289081573486
Epoch: 17, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 8.070570468902588
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 8.233072519302368
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.14449691772461
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.071138143539429
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 8.8686203956604
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 8.742204427719116
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 8.677566766738892
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.758509874343872
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.974304676055908
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 9.187201738357544
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 9.318705081939697
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 9.829124927520752
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 8.885104179382324
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1288300
model size : 5.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.5882673263549805
Epoch: 1, Steps: 7 | Train Loss: 2.564 Vali Loss: 2.497 Vali Acc: 0.194 Test Loss: 2.497 Test Acc: 0.194
Validation loss decreased (inf --> -0.194419).  Saving model ...
Epoch: 2 cost time: 5.005963325500488
Epoch: 2, Steps: 7 | Train Loss: 2.269 Vali Loss: 2.157 Vali Acc: 0.431 Test Loss: 2.157 Test Acc: 0.431
Validation loss decreased (-0.194419 --> -0.430534).  Saving model ...
Epoch: 3 cost time: 4.499811887741089
Epoch: 3, Steps: 7 | Train Loss: 1.905 Vali Loss: 1.754 Vali Acc: 0.667 Test Loss: 1.754 Test Acc: 0.667
Validation loss decreased (-0.430534 --> -0.666649).  Saving model ...
Epoch: 4 cost time: 4.069998264312744
Epoch: 4, Steps: 7 | Train Loss: 1.441 Vali Loss: 1.411 Vali Acc: 0.778 Test Loss: 1.411 Test Acc: 0.778
Validation loss decreased (-0.666649 --> -0.777764).  Saving model ...
Epoch: 5 cost time: 4.4366700649261475
Epoch: 5, Steps: 7 | Train Loss: 1.034 Vali Loss: 1.121 Vali Acc: 0.861 Test Loss: 1.121 Test Acc: 0.861
Validation loss decreased (-0.777764 --> -0.861100).  Saving model ...
Epoch: 6 cost time: 4.954838991165161
Epoch: 6, Steps: 7 | Train Loss: 0.681 Vali Loss: 0.879 Vali Acc: 0.847 Test Loss: 0.879 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.553725957870483
Epoch: 7, Steps: 7 | Train Loss: 0.458 Vali Loss: 0.733 Vali Acc: 0.861 Test Loss: 0.733 Test Acc: 0.861
Validation loss decreased (-0.861100 --> -0.861104).  Saving model ...
Epoch: 8 cost time: 4.854724407196045
Epoch: 8, Steps: 7 | Train Loss: 0.271 Vali Loss: 0.616 Vali Acc: 0.875 Test Loss: 0.616 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 4.626086473464966
Epoch: 9, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.591 Vali Acc: 0.875 Test Loss: 0.591 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 10 cost time: 4.70633339881897
Epoch: 10, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.513 Vali Acc: 0.889 Test Loss: 0.513 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 11 cost time: 4.959274768829346
Epoch: 11, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.467 Vali Acc: 0.917 Test Loss: 0.467 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916662).  Saving model ...
Epoch: 12 cost time: 4.802426338195801
Epoch: 12, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.465 Vali Acc: 0.917 Test Loss: 0.465 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 13 cost time: 4.838815212249756
Epoch: 13, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.427 Vali Acc: 0.931 Test Loss: 0.427 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 14 cost time: 4.96048378944397
Epoch: 14, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.411 Vali Acc: 0.903 Test Loss: 0.411 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.575431823730469
Epoch: 15, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.397 Vali Acc: 0.917 Test Loss: 0.397 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.539513826370239
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.384 Vali Acc: 0.931 Test Loss: 0.384 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 5.080360651016235
Epoch: 17, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.372 Vali Acc: 0.931 Test Loss: 0.372 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 4.6878275871276855
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.370 Vali Acc: 0.931 Test Loss: 0.370 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 19 cost time: 4.827006816864014
Epoch: 19, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.365 Vali Acc: 0.931 Test Loss: 0.365 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 20 cost time: 4.800739049911499
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.356 Vali Acc: 0.931 Test Loss: 0.356 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 21 cost time: 4.659078598022461
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.347 Vali Acc: 0.931 Test Loss: 0.347 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 22 cost time: 4.74346137046814
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.343 Vali Acc: 0.931 Test Loss: 0.343 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 23 cost time: 4.648449182510376
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.342 Vali Acc: 0.931 Test Loss: 0.342 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 24 cost time: 4.524876832962036
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.338 Vali Acc: 0.931 Test Loss: 0.338 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 25 cost time: 4.987628698348999
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.334 Vali Acc: 0.931 Test Loss: 0.334 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 26 cost time: 4.892038583755493
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.332 Vali Acc: 0.931 Test Loss: 0.332 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 27 cost time: 4.658116340637207
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.327 Vali Acc: 0.931 Test Loss: 0.327 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 28 cost time: 4.889827489852905
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.326 Vali Acc: 0.944 Test Loss: 0.326 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 29 cost time: 4.750824213027954
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.931 Test Loss: 0.323 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.542426824569702
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.319 Vali Acc: 0.931 Test Loss: 0.319 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 460332
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 14.076632738113403
Epoch: 1, Steps: 7 | Train Loss: 2.473 Vali Loss: 2.427 Vali Acc: 0.222 Test Loss: 2.427 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 11.306254625320435
Epoch: 2, Steps: 7 | Train Loss: 2.284 Vali Loss: 2.085 Vali Acc: 0.500 Test Loss: 2.085 Test Acc: 0.500
Validation loss decreased (-0.222198 --> -0.499979).  Saving model ...
Epoch: 3 cost time: 11.264289140701294
Epoch: 3, Steps: 7 | Train Loss: 1.833 Vali Loss: 1.665 Vali Acc: 0.792 Test Loss: 1.665 Test Acc: 0.792
Validation loss decreased (-0.499979 --> -0.791650).  Saving model ...
Epoch: 4 cost time: 11.274000883102417
Epoch: 4, Steps: 7 | Train Loss: 1.362 Vali Loss: 1.261 Vali Acc: 0.819 Test Loss: 1.261 Test Acc: 0.819
Validation loss decreased (-0.791650 --> -0.819432).  Saving model ...
Epoch: 5 cost time: 10.791025161743164
Epoch: 5, Steps: 7 | Train Loss: 0.912 Vali Loss: 0.910 Vali Acc: 0.875 Test Loss: 0.910 Test Acc: 0.875
Validation loss decreased (-0.819432 --> -0.874991).  Saving model ...
Epoch: 6 cost time: 11.177329301834106
Epoch: 6, Steps: 7 | Train Loss: 0.566 Vali Loss: 0.659 Vali Acc: 0.889 Test Loss: 0.659 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888882).  Saving model ...
Epoch: 7 cost time: 9.958672523498535
Epoch: 7, Steps: 7 | Train Loss: 0.323 Vali Loss: 0.480 Vali Acc: 0.917 Test Loss: 0.480 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 10.667449712753296
Epoch: 8, Steps: 7 | Train Loss: 0.170 Vali Loss: 0.402 Vali Acc: 0.917 Test Loss: 0.402 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 10.90909457206726
Epoch: 9, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 11.371944427490234
Epoch: 10, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 11.594034671783447
Epoch: 11, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.782974243164062
Epoch: 12, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.097481966018677
Epoch: 13, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 11.670534133911133
Epoch: 14, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 11.814351081848145
Epoch: 15, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 12.240362167358398
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 12.484621524810791
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 11.942696571350098
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 11.784706354141235
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 11.222493171691895
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.72592306137085
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 11.147583723068237
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 10.51885437965393
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 11.382386922836304
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 10.442183494567871
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 11.653890371322632
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 12.059561014175415
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 11.005866289138794
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 10.873604774475098
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 10.825957775115967
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 701804
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.060211420059204
Epoch: 1, Steps: 7 | Train Loss: 2.433 Vali Loss: 2.449 Vali Acc: 0.181 Test Loss: 2.449 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 6.301009654998779
Epoch: 2, Steps: 7 | Train Loss: 2.229 Vali Loss: 2.116 Vali Acc: 0.556 Test Loss: 2.116 Test Acc: 0.556
Validation loss decreased (-0.180531 --> -0.555534).  Saving model ...
Epoch: 3 cost time: 5.736388921737671
Epoch: 3, Steps: 7 | Train Loss: 1.854 Vali Loss: 1.743 Vali Acc: 0.694 Test Loss: 1.743 Test Acc: 0.694
Validation loss decreased (-0.555534 --> -0.694427).  Saving model ...
Epoch: 4 cost time: 6.190742254257202
Epoch: 4, Steps: 7 | Train Loss: 1.433 Vali Loss: 1.387 Vali Acc: 0.819 Test Loss: 1.387 Test Acc: 0.819
Validation loss decreased (-0.694427 --> -0.819431).  Saving model ...
Epoch: 5 cost time: 5.92215371131897
Epoch: 5, Steps: 7 | Train Loss: 1.017 Vali Loss: 1.087 Vali Acc: 0.847 Test Loss: 1.087 Test Acc: 0.847
Validation loss decreased (-0.819431 --> -0.847211).  Saving model ...
Epoch: 6 cost time: 6.285025119781494
Epoch: 6, Steps: 7 | Train Loss: 0.683 Vali Loss: 0.883 Vali Acc: 0.847 Test Loss: 0.883 Test Acc: 0.847
Validation loss decreased (-0.847211 --> -0.847213).  Saving model ...
Epoch: 7 cost time: 6.069559574127197
Epoch: 7, Steps: 7 | Train Loss: 0.442 Vali Loss: 0.694 Vali Acc: 0.861 Test Loss: 0.694 Test Acc: 0.861
Validation loss decreased (-0.847213 --> -0.861104).  Saving model ...
Epoch: 8 cost time: 6.077603816986084
Epoch: 8, Steps: 7 | Train Loss: 0.283 Vali Loss: 0.579 Vali Acc: 0.875 Test Loss: 0.579 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 6.208887338638306
Epoch: 9, Steps: 7 | Train Loss: 0.167 Vali Loss: 0.508 Vali Acc: 0.903 Test Loss: 0.508 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902773).  Saving model ...
Epoch: 10 cost time: 5.644173860549927
Epoch: 10, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.683523654937744
Epoch: 11, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.377471446990967
Epoch: 12, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.555177450180054
Epoch: 13, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.428 Vali Acc: 0.903 Test Loss: 0.428 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 5.560439586639404
Epoch: 14, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.419 Vali Acc: 0.903 Test Loss: 0.419 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 5.780761957168579
Epoch: 15, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.420 Vali Acc: 0.889 Test Loss: 0.420 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.0102927684783936
Epoch: 16, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.066807270050049
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.410 Vali Acc: 0.889 Test Loss: 0.410 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.3827128410339355
Epoch: 18, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.400 Vali Acc: 0.889 Test Loss: 0.400 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.9397313594818115
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 20 cost time: 5.960844039916992
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.7878406047821045
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.980814456939697
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.981716156005859
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.566464424133301
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.606135845184326
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.375668048858643
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.359119415283203
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.210803031921387
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.980983257293701
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 287788
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 11.171819686889648
Epoch: 1, Steps: 7 | Train Loss: 2.473 Vali Loss: 2.427 Vali Acc: 0.222 Test Loss: 2.427 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 9.247907876968384
Epoch: 2, Steps: 7 | Train Loss: 2.284 Vali Loss: 2.085 Vali Acc: 0.500 Test Loss: 2.085 Test Acc: 0.500
Validation loss decreased (-0.222198 --> -0.499979).  Saving model ...
Epoch: 3 cost time: 8.622741937637329
Epoch: 3, Steps: 7 | Train Loss: 1.833 Vali Loss: 1.665 Vali Acc: 0.792 Test Loss: 1.665 Test Acc: 0.792
Validation loss decreased (-0.499979 --> -0.791650).  Saving model ...
Epoch: 4 cost time: 8.75746202468872
Epoch: 4, Steps: 7 | Train Loss: 1.362 Vali Loss: 1.261 Vali Acc: 0.819 Test Loss: 1.261 Test Acc: 0.819
Validation loss decreased (-0.791650 --> -0.819432).  Saving model ...
Epoch: 5 cost time: 8.883371114730835
Epoch: 5, Steps: 7 | Train Loss: 0.912 Vali Loss: 0.910 Vali Acc: 0.875 Test Loss: 0.910 Test Acc: 0.875
Validation loss decreased (-0.819432 --> -0.874991).  Saving model ...
Epoch: 6 cost time: 8.179760694503784
Epoch: 6, Steps: 7 | Train Loss: 0.566 Vali Loss: 0.659 Vali Acc: 0.889 Test Loss: 0.659 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888882).  Saving model ...
Epoch: 7 cost time: 8.463197946548462
Epoch: 7, Steps: 7 | Train Loss: 0.323 Vali Loss: 0.480 Vali Acc: 0.917 Test Loss: 0.480 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 8.537304162979126
Epoch: 8, Steps: 7 | Train Loss: 0.170 Vali Loss: 0.402 Vali Acc: 0.917 Test Loss: 0.402 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 7.535724639892578
Epoch: 9, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 7.76972770690918
Epoch: 10, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 7.938087701797485
Epoch: 11, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.421087265014648
Epoch: 12, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.561556816101074
Epoch: 13, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 8.678961277008057
Epoch: 14, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 8.530945777893066
Epoch: 15, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 8.565976619720459
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 8.357792854309082
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.642587423324585
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.023991346359253
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.1136579513549805
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.6701436042785645
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 8.753934383392334
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.742262601852417
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 9.15726375579834
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 8.5509033203125
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 8.726853132247925
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 8.51530909538269
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 7.96773624420166
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 8.250824213027954
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 7.3592565059661865
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 701804
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.971288204193115
Epoch: 1, Steps: 7 | Train Loss: 2.433 Vali Loss: 2.448 Vali Acc: 0.181 Test Loss: 2.448 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 4.179427623748779
Epoch: 2, Steps: 7 | Train Loss: 2.229 Vali Loss: 2.116 Vali Acc: 0.556 Test Loss: 2.116 Test Acc: 0.556
Validation loss decreased (-0.180531 --> -0.555534).  Saving model ...
Epoch: 3 cost time: 4.372151136398315
Epoch: 3, Steps: 7 | Train Loss: 1.854 Vali Loss: 1.743 Vali Acc: 0.694 Test Loss: 1.743 Test Acc: 0.694
Validation loss decreased (-0.555534 --> -0.694427).  Saving model ...
Epoch: 4 cost time: 4.126774549484253
Epoch: 4, Steps: 7 | Train Loss: 1.434 Vali Loss: 1.386 Vali Acc: 0.819 Test Loss: 1.386 Test Acc: 0.819
Validation loss decreased (-0.694427 --> -0.819431).  Saving model ...
Epoch: 5 cost time: 4.352258682250977
Epoch: 5, Steps: 7 | Train Loss: 1.016 Vali Loss: 1.086 Vali Acc: 0.847 Test Loss: 1.086 Test Acc: 0.847
Validation loss decreased (-0.819431 --> -0.847211).  Saving model ...
Epoch: 6 cost time: 4.35346531867981
Epoch: 6, Steps: 7 | Train Loss: 0.683 Vali Loss: 0.881 Vali Acc: 0.847 Test Loss: 0.881 Test Acc: 0.847
Validation loss decreased (-0.847211 --> -0.847213).  Saving model ...
Epoch: 7 cost time: 4.562105655670166
Epoch: 7, Steps: 7 | Train Loss: 0.442 Vali Loss: 0.692 Vali Acc: 0.847 Test Loss: 0.692 Test Acc: 0.847
Validation loss decreased (-0.847213 --> -0.847215).  Saving model ...
Epoch: 8 cost time: 4.35941743850708
Epoch: 8, Steps: 7 | Train Loss: 0.285 Vali Loss: 0.576 Vali Acc: 0.875 Test Loss: 0.576 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 4.467975616455078
Epoch: 9, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.504 Vali Acc: 0.903 Test Loss: 0.504 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902773).  Saving model ...
Epoch: 10 cost time: 4.666651725769043
Epoch: 10, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.637062311172485
Epoch: 11, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.247509479522705
Epoch: 12, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.440 Vali Acc: 0.903 Test Loss: 0.440 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 13 cost time: 3.9118456840515137
Epoch: 13, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.418 Vali Acc: 0.903 Test Loss: 0.418 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 4.187518835067749
Epoch: 14, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.407 Vali Acc: 0.903 Test Loss: 0.407 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 5.256619930267334
Epoch: 15, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.406 Vali Acc: 0.903 Test Loss: 0.406 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 4.985905170440674
Epoch: 16, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.403 Vali Acc: 0.903 Test Loss: 0.403 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 5.073325872421265
Epoch: 17, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 18 cost time: 5.273993253707886
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 19 cost time: 5.134676218032837
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.393 Vali Acc: 0.903 Test Loss: 0.393 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.945380210876465
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.390 Vali Acc: 0.889 Test Loss: 0.390 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.115725040435791
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.390 Vali Acc: 0.889 Test Loss: 0.390 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.170873165130615
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.392 Vali Acc: 0.889 Test Loss: 0.392 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.956661939620972
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.167120456695557
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.382 Vali Acc: 0.889 Test Loss: 0.382 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.1364665031433105
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.380 Vali Acc: 0.903 Test Loss: 0.380 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 4.915069818496704
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.558768033981323
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.806450605392456
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.6568450927734375
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.381 Vali Acc: 0.889 Test Loss: 0.381 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.56382942199707
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.381 Vali Acc: 0.889 Test Loss: 0.381 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 287788
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.886969089508057
Epoch: 1, Steps: 7 | Train Loss: 2.472 Vali Loss: 2.431 Vali Acc: 0.222 Test Loss: 2.431 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 5.95892333984375
Epoch: 2, Steps: 7 | Train Loss: 2.285 Vali Loss: 2.093 Vali Acc: 0.486 Test Loss: 2.093 Test Acc: 0.486
Validation loss decreased (-0.222198 --> -0.486090).  Saving model ...
Epoch: 3 cost time: 5.642019987106323
Epoch: 3, Steps: 7 | Train Loss: 1.841 Vali Loss: 1.678 Vali Acc: 0.764 Test Loss: 1.678 Test Acc: 0.764
Validation loss decreased (-0.486090 --> -0.763872).  Saving model ...
Epoch: 4 cost time: 6.000980377197266
Epoch: 4, Steps: 7 | Train Loss: 1.374 Vali Loss: 1.279 Vali Acc: 0.778 Test Loss: 1.279 Test Acc: 0.778
Validation loss decreased (-0.763872 --> -0.777765).  Saving model ...
Epoch: 5 cost time: 5.734902620315552
Epoch: 5, Steps: 7 | Train Loss: 0.931 Vali Loss: 0.939 Vali Acc: 0.875 Test Loss: 0.939 Test Acc: 0.875
Validation loss decreased (-0.777765 --> -0.874991).  Saving model ...
Epoch: 6 cost time: 5.491608142852783
Epoch: 6, Steps: 7 | Train Loss: 0.590 Vali Loss: 0.699 Vali Acc: 0.903 Test Loss: 0.699 Test Acc: 0.903
Validation loss decreased (-0.874991 --> -0.902771).  Saving model ...
Epoch: 7 cost time: 5.836032867431641
Epoch: 7, Steps: 7 | Train Loss: 0.358 Vali Loss: 0.528 Vali Acc: 0.903 Test Loss: 0.528 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902772).  Saving model ...
Epoch: 8 cost time: 6.0331573486328125
Epoch: 8, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.446 Vali Acc: 0.917 Test Loss: 0.446 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 5.754312753677368
Epoch: 9, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.374 Vali Acc: 0.917 Test Loss: 0.374 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 5.9176952838897705
Epoch: 10, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 5.791464567184448
Epoch: 11, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 5.8491315841674805
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 5.829373836517334
Epoch: 13, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 5.511115550994873
Epoch: 14, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 6.165735721588135
Epoch: 15, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.949019908905029
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 6.176691055297852
Epoch: 17, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.726019620895386
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.296322822570801
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 5.9262566566467285
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 5.957968473434448
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 6.120034217834473
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.752491474151611
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.79046106338501
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.802489519119263
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.308983564376831
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.131595611572266
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.865973234176636
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 6.30324912071228
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 5.965607643127441
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 701804
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.428141832351685
Epoch: 1, Steps: 7 | Train Loss: 2.434 Vali Loss: 2.436 Vali Acc: 0.222 Test Loss: 2.436 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 3.5822644233703613
Epoch: 2, Steps: 7 | Train Loss: 2.229 Vali Loss: 2.103 Vali Acc: 0.556 Test Loss: 2.103 Test Acc: 0.556
Validation loss decreased (-0.222198 --> -0.555535).  Saving model ...
Epoch: 3 cost time: 3.4238035678863525
Epoch: 3, Steps: 7 | Train Loss: 1.857 Vali Loss: 1.729 Vali Acc: 0.708 Test Loss: 1.729 Test Acc: 0.708
Validation loss decreased (-0.555535 --> -0.708316).  Saving model ...
Epoch: 4 cost time: 3.6559956073760986
Epoch: 4, Steps: 7 | Train Loss: 1.438 Vali Loss: 1.373 Vali Acc: 0.833 Test Loss: 1.373 Test Acc: 0.833
Validation loss decreased (-0.708316 --> -0.833320).  Saving model ...
Epoch: 5 cost time: 3.729527473449707
Epoch: 5, Steps: 7 | Train Loss: 1.021 Vali Loss: 1.074 Vali Acc: 0.861 Test Loss: 1.074 Test Acc: 0.861
Validation loss decreased (-0.833320 --> -0.861100).  Saving model ...
Epoch: 6 cost time: 3.7740767002105713
Epoch: 6, Steps: 7 | Train Loss: 0.690 Vali Loss: 0.871 Vali Acc: 0.861 Test Loss: 0.871 Test Acc: 0.861
Validation loss decreased (-0.861100 --> -0.861102).  Saving model ...
Epoch: 7 cost time: 3.629464626312256
Epoch: 7, Steps: 7 | Train Loss: 0.449 Vali Loss: 0.684 Vali Acc: 0.861 Test Loss: 0.684 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861104).  Saving model ...
Epoch: 8 cost time: 3.585679054260254
Epoch: 8, Steps: 7 | Train Loss: 0.293 Vali Loss: 0.568 Vali Acc: 0.875 Test Loss: 0.568 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 3.561532735824585
Epoch: 9, Steps: 7 | Train Loss: 0.176 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 3.4541127681732178
Epoch: 10, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.456 Vali Acc: 0.861 Test Loss: 0.456 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.416403293609619
Epoch: 11, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.484853744506836
Epoch: 12, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.422 Vali Acc: 0.903 Test Loss: 0.422 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 3.433844566345215
Epoch: 13, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1667401790618896
Epoch: 14, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.388 Vali Acc: 0.903 Test Loss: 0.388 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 3.2176694869995117
Epoch: 15, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 3.4800007343292236
Epoch: 16, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5489964485168457
Epoch: 17, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 18 cost time: 3.232804536819458
Epoch: 18, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 19 cost time: 3.1836740970611572
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 20 cost time: 3.415853261947632
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 21 cost time: 3.457771062850952
Epoch: 21, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 3.3831288814544678
Epoch: 22, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.396461009979248
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 3.4431076049804688
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.472167491912842
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.306912660598755
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.278315305709839
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 3.2578630447387695
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 29 cost time: 3.2057034969329834
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.2817060947418213
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 287788
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.227159023284912
Epoch: 1, Steps: 7 | Train Loss: 2.539 Vali Loss: 2.405 Vali Acc: 0.125 Test Loss: 2.405 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 8.415007829666138
Epoch: 2, Steps: 7 | Train Loss: 2.291 Vali Loss: 2.033 Vali Acc: 0.472 Test Loss: 2.033 Test Acc: 0.472
Validation loss decreased (-0.124976 --> -0.472202).  Saving model ...
Epoch: 3 cost time: 8.105000734329224
Epoch: 3, Steps: 7 | Train Loss: 1.838 Vali Loss: 1.594 Vali Acc: 0.847 Test Loss: 1.594 Test Acc: 0.847
Validation loss decreased (-0.472202 --> -0.847206).  Saving model ...
Epoch: 4 cost time: 7.950226545333862
Epoch: 4, Steps: 7 | Train Loss: 1.365 Vali Loss: 1.193 Vali Acc: 0.861 Test Loss: 1.193 Test Acc: 0.861
Validation loss decreased (-0.847206 --> -0.861099).  Saving model ...
Epoch: 5 cost time: 6.669670820236206
Epoch: 5, Steps: 7 | Train Loss: 0.922 Vali Loss: 0.860 Vali Acc: 0.903 Test Loss: 0.860 Test Acc: 0.903
Validation loss decreased (-0.861099 --> -0.902769).  Saving model ...
Epoch: 6 cost time: 8.047985792160034
Epoch: 6, Steps: 7 | Train Loss: 0.567 Vali Loss: 0.628 Vali Acc: 0.944 Test Loss: 0.628 Test Acc: 0.944
Validation loss decreased (-0.902769 --> -0.944438).  Saving model ...
Epoch: 7 cost time: 8.216381311416626
Epoch: 7, Steps: 7 | Train Loss: 0.330 Vali Loss: 0.448 Vali Acc: 0.944 Test Loss: 0.448 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944440).  Saving model ...
Epoch: 8 cost time: 7.64719557762146
Epoch: 8, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.342 Vali Acc: 0.944 Test Loss: 0.342 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 7.959106683731079
Epoch: 9, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.311 Vali Acc: 0.944 Test Loss: 0.311 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 10 cost time: 9.533746242523193
Epoch: 10, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 9.865190505981445
Epoch: 11, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 9.460191488265991
Epoch: 12, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 9.04454255104065
Epoch: 13, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 8.99680781364441
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 9.171621561050415
Epoch: 15, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 9.397553443908691
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 9.018802165985107
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 7.419310569763184
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 8.830294370651245
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 8.960473775863647
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 8.974092960357666
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 22 cost time: 9.533485174179077
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 8.285279512405396
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 8.39791989326477
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 9.312010526657104
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 9.694621086120605
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 8.84246039390564
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 9.230085372924805
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 9.044300079345703
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 8.739978551864624
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 408556
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.784423351287842
Epoch: 1, Steps: 7 | Train Loss: 2.562 Vali Loss: 2.505 Vali Acc: 0.167 Test Loss: 2.505 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 4.511805295944214
Epoch: 2, Steps: 7 | Train Loss: 2.311 Vali Loss: 2.179 Vali Acc: 0.347 Test Loss: 2.179 Test Acc: 0.347
Validation loss decreased (-0.166642 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 4.615886926651001
Epoch: 3, Steps: 7 | Train Loss: 1.934 Vali Loss: 1.796 Vali Acc: 0.611 Test Loss: 1.796 Test Acc: 0.611
Validation loss decreased (-0.347200 --> -0.611093).  Saving model ...
Epoch: 4 cost time: 4.401738405227661
Epoch: 4, Steps: 7 | Train Loss: 1.452 Vali Loss: 1.398 Vali Acc: 0.722 Test Loss: 1.398 Test Acc: 0.722
Validation loss decreased (-0.611093 --> -0.722208).  Saving model ...
Epoch: 5 cost time: 4.361908912658691
Epoch: 5, Steps: 7 | Train Loss: 1.065 Vali Loss: 1.108 Vali Acc: 0.764 Test Loss: 1.108 Test Acc: 0.764
Validation loss decreased (-0.722208 --> -0.763878).  Saving model ...
Epoch: 6 cost time: 4.553445816040039
Epoch: 6, Steps: 7 | Train Loss: 0.725 Vali Loss: 0.886 Vali Acc: 0.792 Test Loss: 0.886 Test Acc: 0.792
Validation loss decreased (-0.763878 --> -0.791658).  Saving model ...
Epoch: 7 cost time: 4.374602794647217
Epoch: 7, Steps: 7 | Train Loss: 0.482 Vali Loss: 0.760 Vali Acc: 0.778 Test Loss: 0.760 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.549112796783447
Epoch: 8, Steps: 7 | Train Loss: 0.296 Vali Loss: 0.652 Vali Acc: 0.792 Test Loss: 0.652 Test Acc: 0.792
Validation loss decreased (-0.791658 --> -0.791660).  Saving model ...
Epoch: 9 cost time: 4.290436029434204
Epoch: 9, Steps: 7 | Train Loss: 0.165 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
Validation loss decreased (-0.791660 --> -0.847217).  Saving model ...
Epoch: 10 cost time: 4.211507081985474
Epoch: 10, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847217).  Saving model ...
Epoch: 11 cost time: 4.779848098754883
Epoch: 11, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847217).  Saving model ...
Epoch: 12 cost time: 4.371427059173584
Epoch: 12, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.491 Vali Acc: 0.819 Test Loss: 0.491 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.58802342414856
Epoch: 13, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 14 cost time: 4.46606707572937
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.450 Vali Acc: 0.861 Test Loss: 0.450 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 4.526326417922974
Epoch: 15, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.440 Vali Acc: 0.861 Test Loss: 0.440 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 16 cost time: 4.287008762359619
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.431 Vali Acc: 0.861 Test Loss: 0.431 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 17 cost time: 4.470790147781372
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 18 cost time: 4.615788698196411
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.420 Vali Acc: 0.861 Test Loss: 0.420 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 4.165441989898682
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 20 cost time: 4.611232757568359
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.416 Vali Acc: 0.861 Test Loss: 0.416 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 21 cost time: 4.555044174194336
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 4.499288082122803
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 23 cost time: 4.916376113891602
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.404 Vali Acc: 0.861 Test Loss: 0.404 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.496084690093994
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.402 Vali Acc: 0.861 Test Loss: 0.402 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.268301486968994
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.1766393184661865
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 27 cost time: 3.888047218322754
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 28 cost time: 4.476782560348511
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 29 cost time: 4.761871576309204
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 30 cost time: 4.21884822845459
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 201516
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.497374773025513
Epoch: 1, Steps: 7 | Train Loss: 2.539 Vali Loss: 2.404 Vali Acc: 0.125 Test Loss: 2.404 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 6.465180158615112
Epoch: 2, Steps: 7 | Train Loss: 2.291 Vali Loss: 2.033 Vali Acc: 0.472 Test Loss: 2.033 Test Acc: 0.472
Validation loss decreased (-0.124976 --> -0.472202).  Saving model ...
Epoch: 3 cost time: 6.280787944793701
Epoch: 3, Steps: 7 | Train Loss: 1.838 Vali Loss: 1.593 Vali Acc: 0.847 Test Loss: 1.593 Test Acc: 0.847
Validation loss decreased (-0.472202 --> -0.847206).  Saving model ...
Epoch: 4 cost time: 6.670293092727661
Epoch: 4, Steps: 7 | Train Loss: 1.365 Vali Loss: 1.192 Vali Acc: 0.861 Test Loss: 1.192 Test Acc: 0.861
Validation loss decreased (-0.847206 --> -0.861099).  Saving model ...
Epoch: 5 cost time: 6.185427904129028
Epoch: 5, Steps: 7 | Train Loss: 0.922 Vali Loss: 0.859 Vali Acc: 0.903 Test Loss: 0.859 Test Acc: 0.903
Validation loss decreased (-0.861099 --> -0.902769).  Saving model ...
Epoch: 6 cost time: 6.535725116729736
Epoch: 6, Steps: 7 | Train Loss: 0.567 Vali Loss: 0.628 Vali Acc: 0.944 Test Loss: 0.628 Test Acc: 0.944
Validation loss decreased (-0.902769 --> -0.944438).  Saving model ...
Epoch: 7 cost time: 6.276873350143433
Epoch: 7, Steps: 7 | Train Loss: 0.330 Vali Loss: 0.448 Vali Acc: 0.944 Test Loss: 0.448 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944440).  Saving model ...
Epoch: 8 cost time: 6.701830863952637
Epoch: 8, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.343 Vali Acc: 0.944 Test Loss: 0.343 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 6.263655185699463
Epoch: 9, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.311 Vali Acc: 0.944 Test Loss: 0.311 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 10 cost time: 6.940975666046143
Epoch: 10, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 6.711340427398682
Epoch: 11, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 7.115664720535278
Epoch: 12, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 6.05469536781311
Epoch: 13, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 7.605993032455444
Epoch: 14, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 7.254146099090576
Epoch: 15, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 7.035203456878662
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 7.120161533355713
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 7.2997846603393555
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 6.593026399612427
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 6.806397438049316
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 6.220653057098389
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 22 cost time: 6.912202835083008
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 6.188935279846191
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 6.1501147747039795
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 6.005377292633057
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 6.716200828552246
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 6.767456531524658
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 7.347393274307251
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 6.8231446743011475
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 5.662919759750366
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 408556
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.392971038818359
Epoch: 1, Steps: 7 | Train Loss: 2.562 Vali Loss: 2.505 Vali Acc: 0.167 Test Loss: 2.505 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 3.518043279647827
Epoch: 2, Steps: 7 | Train Loss: 2.311 Vali Loss: 2.178 Vali Acc: 0.347 Test Loss: 2.178 Test Acc: 0.347
Validation loss decreased (-0.166642 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 3.574300765991211
Epoch: 3, Steps: 7 | Train Loss: 1.934 Vali Loss: 1.795 Vali Acc: 0.611 Test Loss: 1.795 Test Acc: 0.611
Validation loss decreased (-0.347200 --> -0.611093).  Saving model ...
Epoch: 4 cost time: 3.724470376968384
Epoch: 4, Steps: 7 | Train Loss: 1.452 Vali Loss: 1.396 Vali Acc: 0.722 Test Loss: 1.396 Test Acc: 0.722
Validation loss decreased (-0.611093 --> -0.722208).  Saving model ...
Epoch: 5 cost time: 3.684391498565674
Epoch: 5, Steps: 7 | Train Loss: 1.065 Vali Loss: 1.107 Vali Acc: 0.764 Test Loss: 1.107 Test Acc: 0.764
Validation loss decreased (-0.722208 --> -0.763878).  Saving model ...
Epoch: 6 cost time: 3.8399720191955566
Epoch: 6, Steps: 7 | Train Loss: 0.725 Vali Loss: 0.885 Vali Acc: 0.792 Test Loss: 0.885 Test Acc: 0.792
Validation loss decreased (-0.763878 --> -0.791658).  Saving model ...
Epoch: 7 cost time: 3.078644037246704
Epoch: 7, Steps: 7 | Train Loss: 0.482 Vali Loss: 0.759 Vali Acc: 0.778 Test Loss: 0.759 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0270063877105713
Epoch: 8, Steps: 7 | Train Loss: 0.296 Vali Loss: 0.652 Vali Acc: 0.792 Test Loss: 0.652 Test Acc: 0.792
Validation loss decreased (-0.791658 --> -0.791660).  Saving model ...
Epoch: 9 cost time: 2.963467597961426
Epoch: 9, Steps: 7 | Train Loss: 0.165 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
Validation loss decreased (-0.791660 --> -0.847217).  Saving model ...
Epoch: 10 cost time: 3.2204208374023438
Epoch: 10, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847217).  Saving model ...
Epoch: 11 cost time: 3.6503283977508545
Epoch: 11, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847217).  Saving model ...
Epoch: 12 cost time: 3.2428689002990723
Epoch: 12, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.490 Vali Acc: 0.819 Test Loss: 0.490 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1259171962738037
Epoch: 13, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 14 cost time: 3.1820430755615234
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.450 Vali Acc: 0.861 Test Loss: 0.450 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 3.4550740718841553
Epoch: 15, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.440 Vali Acc: 0.861 Test Loss: 0.440 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 16 cost time: 3.6160128116607666
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.431 Vali Acc: 0.861 Test Loss: 0.431 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 17 cost time: 3.1596603393554688
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 18 cost time: 3.67488694190979
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.420 Vali Acc: 0.861 Test Loss: 0.420 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 3.1013221740722656
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 20 cost time: 3.4599368572235107
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.416 Vali Acc: 0.861 Test Loss: 0.416 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 21 cost time: 3.3339436054229736
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 3.1383540630340576
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 23 cost time: 3.2065188884735107
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.405 Vali Acc: 0.861 Test Loss: 0.405 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9796125888824463
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.403 Vali Acc: 0.861 Test Loss: 0.403 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.244248628616333
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.401 Vali Acc: 0.861 Test Loss: 0.401 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.8365492820739746
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 27 cost time: 3.44398832321167
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 28 cost time: 3.3420569896698
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 29 cost time: 3.5162007808685303
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 30 cost time: 3.758207082748413
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 201516
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.9028332233428955
Epoch: 1, Steps: 7 | Train Loss: 2.535 Vali Loss: 2.402 Vali Acc: 0.139 Test Loss: 2.402 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 4.1761863231658936
Epoch: 2, Steps: 7 | Train Loss: 2.289 Vali Loss: 2.033 Vali Acc: 0.458 Test Loss: 2.033 Test Acc: 0.458
Validation loss decreased (-0.138865 --> -0.458313).  Saving model ...
Epoch: 3 cost time: 4.135488510131836
Epoch: 3, Steps: 7 | Train Loss: 1.841 Vali Loss: 1.597 Vali Acc: 0.833 Test Loss: 1.597 Test Acc: 0.833
Validation loss decreased (-0.458313 --> -0.833317).  Saving model ...
Epoch: 4 cost time: 3.853806257247925
Epoch: 4, Steps: 7 | Train Loss: 1.371 Vali Loss: 1.202 Vali Acc: 0.861 Test Loss: 1.202 Test Acc: 0.861
Validation loss decreased (-0.833317 --> -0.861099).  Saving model ...
Epoch: 5 cost time: 3.7268588542938232
Epoch: 5, Steps: 7 | Train Loss: 0.931 Vali Loss: 0.874 Vali Acc: 0.903 Test Loss: 0.874 Test Acc: 0.903
Validation loss decreased (-0.861099 --> -0.902769).  Saving model ...
Epoch: 6 cost time: 3.561429262161255
Epoch: 6, Steps: 7 | Train Loss: 0.581 Vali Loss: 0.646 Vali Acc: 0.944 Test Loss: 0.646 Test Acc: 0.944
Validation loss decreased (-0.902769 --> -0.944438).  Saving model ...
Epoch: 7 cost time: 4.200616121292114
Epoch: 7, Steps: 7 | Train Loss: 0.343 Vali Loss: 0.467 Vali Acc: 0.944 Test Loss: 0.467 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944440).  Saving model ...
Epoch: 8 cost time: 4.452951908111572
Epoch: 8, Steps: 7 | Train Loss: 0.207 Vali Loss: 0.360 Vali Acc: 0.944 Test Loss: 0.360 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 4.42880916595459
Epoch: 9, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.330 Vali Acc: 0.944 Test Loss: 0.330 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 10 cost time: 4.170948266983032
Epoch: 10, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.303 Vali Acc: 0.944 Test Loss: 0.303 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 4.6476781368255615
Epoch: 11, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 4.17795467376709
Epoch: 12, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 4.189230442047119
Epoch: 13, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 3.975679397583008
Epoch: 14, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 4.4283130168914795
Epoch: 15, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 4.198958158493042
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 4.30563759803772
Epoch: 17, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 4.289577007293701
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 4.177820920944214
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 4.034356117248535
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 4.445160865783691
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 4.29080867767334
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 3.885209560394287
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 4.02978777885437
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 4.263486623764038
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 4.08457350730896
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 4.081495523452759
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 4.232648134231567
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 4.220144033432007
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 3.9450316429138184
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 408556
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.214606523513794
Epoch: 1, Steps: 7 | Train Loss: 2.562 Vali Loss: 2.508 Vali Acc: 0.167 Test Loss: 2.508 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 2.4583725929260254
Epoch: 2, Steps: 7 | Train Loss: 2.315 Vali Loss: 2.182 Vali Acc: 0.347 Test Loss: 2.182 Test Acc: 0.347
Validation loss decreased (-0.166642 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 2.5137453079223633
Epoch: 3, Steps: 7 | Train Loss: 1.940 Vali Loss: 1.800 Vali Acc: 0.625 Test Loss: 1.800 Test Acc: 0.625
Validation loss decreased (-0.347200 --> -0.624982).  Saving model ...
Epoch: 4 cost time: 2.7017319202423096
Epoch: 4, Steps: 7 | Train Loss: 1.461 Vali Loss: 1.405 Vali Acc: 0.708 Test Loss: 1.405 Test Acc: 0.708
Validation loss decreased (-0.624982 --> -0.708319).  Saving model ...
Epoch: 5 cost time: 2.3981215953826904
Epoch: 5, Steps: 7 | Train Loss: 1.081 Vali Loss: 1.117 Vali Acc: 0.764 Test Loss: 1.117 Test Acc: 0.764
Validation loss decreased (-0.708319 --> -0.763878).  Saving model ...
Epoch: 6 cost time: 2.5199902057647705
Epoch: 6, Steps: 7 | Train Loss: 0.737 Vali Loss: 0.896 Vali Acc: 0.792 Test Loss: 0.896 Test Acc: 0.792
Validation loss decreased (-0.763878 --> -0.791658).  Saving model ...
Epoch: 7 cost time: 2.671633720397949
Epoch: 7, Steps: 7 | Train Loss: 0.487 Vali Loss: 0.767 Vali Acc: 0.792 Test Loss: 0.767 Test Acc: 0.792
Validation loss decreased (-0.791658 --> -0.791659).  Saving model ...
Epoch: 8 cost time: 2.452112913131714
Epoch: 8, Steps: 7 | Train Loss: 0.303 Vali Loss: 0.661 Vali Acc: 0.819 Test Loss: 0.661 Test Acc: 0.819
Validation loss decreased (-0.791659 --> -0.819438).  Saving model ...
Epoch: 9 cost time: 2.663898468017578
Epoch: 9, Steps: 7 | Train Loss: 0.171 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
Validation loss decreased (-0.819438 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 2.5992703437805176
Epoch: 10, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 2.451392889022827
Epoch: 11, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.499 Vali Acc: 0.819 Test Loss: 0.499 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6091201305389404
Epoch: 12, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.499 Vali Acc: 0.833 Test Loss: 0.499 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 13 cost time: 2.845186948776245
Epoch: 13, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.477 Vali Acc: 0.847 Test Loss: 0.477 Test Acc: 0.847
Validation loss decreased (-0.833328 --> -0.847217).  Saving model ...
Epoch: 14 cost time: 2.6876912117004395
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.454 Vali Acc: 0.847 Test Loss: 0.454 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 15 cost time: 2.5725557804107666
Epoch: 15, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.442 Vali Acc: 0.847 Test Loss: 0.442 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 16 cost time: 2.4525046348571777
Epoch: 16, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.434 Vali Acc: 0.847 Test Loss: 0.434 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 17 cost time: 2.1841015815734863
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.428 Vali Acc: 0.847 Test Loss: 0.428 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 18 cost time: 2.406996250152588
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.424 Vali Acc: 0.847 Test Loss: 0.424 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 19 cost time: 2.5993824005126953
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.421 Vali Acc: 0.861 Test Loss: 0.421 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 20 cost time: 2.427562713623047
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.419 Vali Acc: 0.847 Test Loss: 0.419 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6797773838043213
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.416 Vali Acc: 0.861 Test Loss: 0.416 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 22 cost time: 2.3967294692993164
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.415 Vali Acc: 0.847 Test Loss: 0.415 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.56081223487854
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.409 Vali Acc: 0.847 Test Loss: 0.409 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.64350962638855
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.406 Vali Acc: 0.861 Test Loss: 0.406 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 25 cost time: 2.5351595878601074
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.403 Vali Acc: 0.847 Test Loss: 0.403 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5687057971954346
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.406 Vali Acc: 0.861 Test Loss: 0.406 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 27 cost time: 2.536372661590576
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 28 cost time: 1.9998791217803955
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.399 Vali Acc: 0.861 Test Loss: 0.399 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2603061199188232
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.252657413482666
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.396 Vali Acc: 0.861 Test Loss: 0.396 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 201516
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 119.76673865318298
Epoch: 1, Steps: 7 | Train Loss: 2.438 Vali Loss: 1.516 Vali Acc: 0.722 Test Loss: 1.516 Test Acc: 0.722
Validation loss decreased (inf --> -0.722207).  Saving model ...
Epoch: 2 cost time: 117.78816056251526
Epoch: 2, Steps: 7 | Train Loss: 0.648 Vali Loss: 0.755 Vali Acc: 0.778 Test Loss: 0.755 Test Acc: 0.778
Validation loss decreased (-0.722207 --> -0.777770).  Saving model ...
Epoch: 3 cost time: 117.70039296150208
Epoch: 3, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.777770 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 115.61037278175354
Epoch: 4, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.888886 --> -0.944442).  Saving model ...
Epoch: 5 cost time: 106.16426205635071
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 121.1600570678711
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 105.367192029953
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.861 Test Loss: 0.661 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 113.04250574111938
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.875 Test Loss: 0.640 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 120.01271653175354
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.903 Test Loss: 0.557 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 110.76690721511841
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.903 Test Loss: 0.495 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 103.34450435638428
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.917 Test Loss: 0.451 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 109.6015613079071
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.917 Test Loss: 0.424 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 120.79881167411804
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.931 Test Loss: 0.407 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 110.42046451568604
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.931 Test Loss: 0.394 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 58078476
model size : 224.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 44.963343381881714
Epoch: 1, Steps: 7 | Train Loss: 2.325 Vali Loss: 1.455 Vali Acc: 0.750 Test Loss: 1.455 Test Acc: 0.750
Validation loss decreased (inf --> -0.749985).  Saving model ...
Epoch: 2 cost time: 43.13465404510498
Epoch: 2, Steps: 7 | Train Loss: 0.596 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
Validation loss decreased (-0.749985 --> -0.902775).  Saving model ...
Epoch: 3 cost time: 37.47801852226257
Epoch: 3, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 41.395684480667114
Epoch: 4, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 41.510586977005005
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.458 Vali Acc: 0.889 Test Loss: 0.458 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 34.05379605293274
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 38.36880683898926
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.875 Test Loss: 0.255 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 41.15641975402832
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 9 cost time: 36.05814599990845
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 38.41034293174744
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 42.09248733520508
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.917 Test Loss: 0.174 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 39.61943507194519
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.917 Test Loss: 0.154 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 36.258087396621704
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.931 Test Loss: 0.147 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 14 cost time: 35.84259510040283
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.944 Test Loss: 0.145 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 35.120049476623535
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.944 Test Loss: 0.143 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 39.67483448982239
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.944 Test Loss: 0.142 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 42.7475528717041
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.944 Test Loss: 0.141 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 39.79039764404297
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.944 Test Loss: 0.140 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 41.02445840835571
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.944 Test Loss: 0.139 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 41.381885290145874
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.944 Test Loss: 0.139 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 34.74925136566162
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.944 Test Loss: 0.138 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 36.68910336494446
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.944 Test Loss: 0.138 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 42.8608193397522
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.944 Test Loss: 0.138 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 37.7673602104187
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.944 Test Loss: 0.137 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 34.56844449043274
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.944 Test Loss: 0.137 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 37.43160653114319
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.944 Test Loss: 0.137 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 34.87971305847168
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.944 Test Loss: 0.136 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 33.97843933105469
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.944 Test Loss: 0.136 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 35.99274039268494
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 35.09303402900696
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 18361356
model size : 72.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 79.46382308006287
Epoch: 1, Steps: 7 | Train Loss: 2.438 Vali Loss: 1.515 Vali Acc: 0.722 Test Loss: 1.515 Test Acc: 0.722
Validation loss decreased (inf --> -0.722207).  Saving model ...
Epoch: 2 cost time: 78.40441131591797
Epoch: 2, Steps: 7 | Train Loss: 0.648 Vali Loss: 0.755 Vali Acc: 0.778 Test Loss: 0.755 Test Acc: 0.778
Validation loss decreased (-0.722207 --> -0.777770).  Saving model ...
Epoch: 3 cost time: 72.51836562156677
Epoch: 3, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.777770 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 74.64219880104065
Epoch: 4, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.888886 --> -0.944442).  Saving model ...
Epoch: 5 cost time: 72.93008613586426
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 66.19122624397278
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 61.21805739402771
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.861 Test Loss: 0.661 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 79.08690333366394
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.875 Test Loss: 0.640 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 77.99228429794312
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.903 Test Loss: 0.557 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 79.47245192527771
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.903 Test Loss: 0.495 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 79.70067524909973
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.917 Test Loss: 0.451 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 79.23525810241699
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.917 Test Loss: 0.424 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 82.71599102020264
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.931 Test Loss: 0.407 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 79.2947564125061
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.931 Test Loss: 0.394 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 58078476
model size : 224.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 30.86643147468567
Epoch: 1, Steps: 7 | Train Loss: 2.325 Vali Loss: 1.455 Vali Acc: 0.750 Test Loss: 1.455 Test Acc: 0.750
Validation loss decreased (inf --> -0.749985).  Saving model ...
Epoch: 2 cost time: 27.93665075302124
Epoch: 2, Steps: 7 | Train Loss: 0.596 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
Validation loss decreased (-0.749985 --> -0.902775).  Saving model ...
Epoch: 3 cost time: 27.646268129348755
Epoch: 3, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 27.709075689315796
Epoch: 4, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 31.459595918655396
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.458 Vali Acc: 0.889 Test Loss: 0.458 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 30.836406707763672
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 33.44140815734863
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.875 Test Loss: 0.255 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 31.97847270965576
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 9 cost time: 32.58583736419678
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 29.818342208862305
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 30.679186582565308
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.917 Test Loss: 0.174 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 29.45676279067993
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.917 Test Loss: 0.154 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 28.363712787628174
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.931 Test Loss: 0.147 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 14 cost time: 27.852386713027954
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.944 Test Loss: 0.145 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 26.551652908325195
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.944 Test Loss: 0.143 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 29.026426315307617
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.944 Test Loss: 0.142 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 27.102142810821533
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.944 Test Loss: 0.141 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 28.776438236236572
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.944 Test Loss: 0.140 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 27.430638313293457
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.944 Test Loss: 0.139 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 29.048838138580322
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.944 Test Loss: 0.139 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 25.516087532043457
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.944 Test Loss: 0.138 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 23.61547088623047
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.944 Test Loss: 0.138 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 25.967555284500122
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.944 Test Loss: 0.138 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 26.089905261993408
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.944 Test Loss: 0.137 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 24.55391240119934
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.944 Test Loss: 0.137 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 23.31886100769043
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.944 Test Loss: 0.137 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 26.488380670547485
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.944 Test Loss: 0.136 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 26.977624654769897
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.944 Test Loss: 0.136 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 24.47174572944641
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 24.24779462814331
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 18361356
model size : 72.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 44.8970205783844
Epoch: 1, Steps: 7 | Train Loss: 2.438 Vali Loss: 1.515 Vali Acc: 0.722 Test Loss: 1.515 Test Acc: 0.722
Validation loss decreased (inf --> -0.722207).  Saving model ...
Epoch: 2 cost time: 41.956143379211426
Epoch: 2, Steps: 7 | Train Loss: 0.648 Vali Loss: 0.755 Vali Acc: 0.778 Test Loss: 0.755 Test Acc: 0.778
Validation loss decreased (-0.722207 --> -0.777770).  Saving model ...
Epoch: 3 cost time: 40.14985203742981
Epoch: 3, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.777770 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 40.78891038894653
Epoch: 4, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.888886 --> -0.944442).  Saving model ...
Epoch: 5 cost time: 36.1071093082428
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 37.05474019050598
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 37.05060935020447
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.861 Test Loss: 0.661 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 36.876511096954346
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.875 Test Loss: 0.640 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 43.62378287315369
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.903 Test Loss: 0.557 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 48.20146059989929
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.903 Test Loss: 0.495 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 45.015573501586914
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.917 Test Loss: 0.451 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 48.465288400650024
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.917 Test Loss: 0.424 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 44.70513463020325
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.931 Test Loss: 0.407 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 44.12527275085449
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.931 Test Loss: 0.394 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 58078476
model size : 224.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 18.106273889541626
Epoch: 1, Steps: 7 | Train Loss: 2.325 Vali Loss: 1.455 Vali Acc: 0.750 Test Loss: 1.455 Test Acc: 0.750
Validation loss decreased (inf --> -0.749985).  Saving model ...
Epoch: 2 cost time: 16.82418966293335
Epoch: 2, Steps: 7 | Train Loss: 0.596 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
Validation loss decreased (-0.749985 --> -0.902775).  Saving model ...
Epoch: 3 cost time: 16.86469602584839
Epoch: 3, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.60695219039917
Epoch: 4, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.888755798339844
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.458 Vali Acc: 0.889 Test Loss: 0.458 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.23244309425354
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 17.228591442108154
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.875 Test Loss: 0.255 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 18.19860339164734
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 9 cost time: 18.29470682144165
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 17.451462745666504
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 17.270655393600464
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.917 Test Loss: 0.174 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 17.501181840896606
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.917 Test Loss: 0.154 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 18.64031171798706
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.931 Test Loss: 0.147 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 14 cost time: 18.29199528694153
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.944 Test Loss: 0.145 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 18.01923704147339
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.944 Test Loss: 0.143 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 15.962440013885498
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.944 Test Loss: 0.142 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 15.110893964767456
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.944 Test Loss: 0.141 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 16.1974618434906
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.944 Test Loss: 0.140 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 16.211461067199707
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.944 Test Loss: 0.139 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 16.12995934486389
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.944 Test Loss: 0.139 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 15.425005197525024
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.944 Test Loss: 0.138 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 15.456207990646362
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.944 Test Loss: 0.138 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 16.65199065208435
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.944 Test Loss: 0.138 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 16.853511095046997
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.944 Test Loss: 0.137 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 17.15146803855896
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.944 Test Loss: 0.137 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 17.27275848388672
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.944 Test Loss: 0.137 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 16.9612717628479
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.944 Test Loss: 0.136 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 16.868984699249268
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.944 Test Loss: 0.136 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 17.73848795890808
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 17.467569589614868
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 18361356
model size : 72.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 53.40618085861206
Epoch: 1, Steps: 7 | Train Loss: 2.464 Vali Loss: 1.504 Vali Acc: 0.750 Test Loss: 1.504 Test Acc: 0.750
Validation loss decreased (inf --> -0.749985).  Saving model ...
Epoch: 2 cost time: 52.70483422279358
Epoch: 2, Steps: 7 | Train Loss: 0.676 Vali Loss: 0.397 Vali Acc: 0.847 Test Loss: 0.397 Test Acc: 0.847
Validation loss decreased (-0.749985 --> -0.847218).  Saving model ...
Epoch: 3 cost time: 49.40666198730469
Epoch: 3, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 55.505905866622925
Epoch: 4, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 53.88805556297302
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 56.438636779785156
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 55.10946750640869
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.889 Test Loss: 0.519 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 53.026352405548096
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.889 Test Loss: 0.534 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 52.7631402015686
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.903 Test Loss: 0.541 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 51.985591888427734
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.903 Test Loss: 0.539 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 56.20774245262146
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.903 Test Loss: 0.532 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 54.36403775215149
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.903 Test Loss: 0.525 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 56.36637043952942
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.903 Test Loss: 0.517 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 50.98464035987854
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.903 Test Loss: 0.509 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 29961228
model size : 116.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 22.531217575073242
Epoch: 1, Steps: 7 | Train Loss: 2.339 Vali Loss: 1.519 Vali Acc: 0.667 Test Loss: 1.519 Test Acc: 0.667
Validation loss decreased (inf --> -0.666651).  Saving model ...
Epoch: 2 cost time: 20.28728747367859
Epoch: 2, Steps: 7 | Train Loss: 0.662 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
Validation loss decreased (-0.666651 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 19.647119522094727
Epoch: 3, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.159 Vali Acc: 0.931 Test Loss: 0.159 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930554).  Saving model ...
Epoch: 4 cost time: 21.021270275115967
Epoch: 4, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.269334077835083
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.959181308746338
Epoch: 6, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.596 Vali Acc: 0.847 Test Loss: 0.596 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.86670422554016
Epoch: 7, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.452 Vali Acc: 0.889 Test Loss: 0.452 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 20.58093237876892
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.350138664245605
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 19.757773399353027
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.903 Test Loss: 0.484 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 20.23470187187195
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.889 Test Loss: 0.599 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 20.52811622619629
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.861 Test Loss: 0.669 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 21.977959632873535
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.875 Test Loss: 0.577 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 10102284
model size : 41.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 48.27976989746094
Epoch: 1, Steps: 7 | Train Loss: 2.464 Vali Loss: 1.504 Vali Acc: 0.750 Test Loss: 1.504 Test Acc: 0.750
Validation loss decreased (inf --> -0.749985).  Saving model ...
Epoch: 2 cost time: 47.83363127708435
Epoch: 2, Steps: 7 | Train Loss: 0.676 Vali Loss: 0.397 Vali Acc: 0.847 Test Loss: 0.397 Test Acc: 0.847
Validation loss decreased (-0.749985 --> -0.847218).  Saving model ...
Epoch: 3 cost time: 46.996663331985474
Epoch: 3, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 42.95042300224304
Epoch: 4, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 42.953742027282715
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 40.580421924591064
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 44.086463928222656
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.889 Test Loss: 0.519 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 41.89267349243164
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.889 Test Loss: 0.534 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 41.77894067764282
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.903 Test Loss: 0.541 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 42.25264883041382
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.903 Test Loss: 0.539 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 43.22567915916443
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.903 Test Loss: 0.532 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 37.94161581993103
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.903 Test Loss: 0.525 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 37.12733697891235
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.903 Test Loss: 0.517 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 40.546326637268066
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.903 Test Loss: 0.509 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 29961228
model size : 116.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 17.428118228912354
Epoch: 1, Steps: 7 | Train Loss: 2.339 Vali Loss: 1.519 Vali Acc: 0.667 Test Loss: 1.519 Test Acc: 0.667
Validation loss decreased (inf --> -0.666651).  Saving model ...
Epoch: 2 cost time: 15.244775533676147
Epoch: 2, Steps: 7 | Train Loss: 0.662 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
Validation loss decreased (-0.666651 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 16.774384260177612
Epoch: 3, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.159 Vali Acc: 0.931 Test Loss: 0.159 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930554).  Saving model ...
Epoch: 4 cost time: 16.5859112739563
Epoch: 4, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.858956813812256
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.322516679763794
Epoch: 6, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.596 Vali Acc: 0.847 Test Loss: 0.596 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.920385122299194
Epoch: 7, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.452 Vali Acc: 0.889 Test Loss: 0.452 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.267853498458862
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.443096160888672
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 16.573071479797363
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.903 Test Loss: 0.484 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 15.451409578323364
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.889 Test Loss: 0.599 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 15.140303134918213
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.861 Test Loss: 0.669 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 15.69932508468628
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.875 Test Loss: 0.577 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 10102284
model size : 41.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 24.52560305595398
Epoch: 1, Steps: 7 | Train Loss: 2.464 Vali Loss: 1.504 Vali Acc: 0.750 Test Loss: 1.504 Test Acc: 0.750
Validation loss decreased (inf --> -0.749985).  Saving model ...
Epoch: 2 cost time: 23.45906901359558
Epoch: 2, Steps: 7 | Train Loss: 0.676 Vali Loss: 0.397 Vali Acc: 0.847 Test Loss: 0.397 Test Acc: 0.847
Validation loss decreased (-0.749985 --> -0.847218).  Saving model ...
Epoch: 3 cost time: 24.38736081123352
Epoch: 3, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 25.06043314933777
Epoch: 4, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 24.277427196502686
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 26.52795100212097
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 25.05918598175049
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.889 Test Loss: 0.519 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 26.750949144363403
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.889 Test Loss: 0.534 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 23.05272674560547
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.903 Test Loss: 0.541 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 25.07711148262024
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.903 Test Loss: 0.539 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 23.012194871902466
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.903 Test Loss: 0.532 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 25.06503438949585
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.903 Test Loss: 0.525 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 23.009818077087402
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.903 Test Loss: 0.517 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 24.01408624649048
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.903 Test Loss: 0.509 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 29961228
model size : 116.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.507680654525757
Epoch: 1, Steps: 7 | Train Loss: 2.339 Vali Loss: 1.519 Vali Acc: 0.667 Test Loss: 1.519 Test Acc: 0.667
Validation loss decreased (inf --> -0.666651).  Saving model ...
Epoch: 2 cost time: 10.699352025985718
Epoch: 2, Steps: 7 | Train Loss: 0.662 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
Validation loss decreased (-0.666651 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 10.50429892539978
Epoch: 3, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.159 Vali Acc: 0.931 Test Loss: 0.159 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930554).  Saving model ...
Epoch: 4 cost time: 9.630930185317993
Epoch: 4, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.460994720458984
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.710196256637573
Epoch: 6, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.596 Vali Acc: 0.847 Test Loss: 0.596 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.599650621414185
Epoch: 7, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.452 Vali Acc: 0.889 Test Loss: 0.452 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.359288930892944
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.377981424331665
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.952309370040894
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.903 Test Loss: 0.484 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.04399824142456
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.889 Test Loss: 0.599 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.769182920455933
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.861 Test Loss: 0.669 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.651099443435669
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.875 Test Loss: 0.577 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 10102284
model size : 41.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 53.87709403038025
Epoch: 1, Steps: 7 | Train Loss: 2.542 Vali Loss: 1.989 Vali Acc: 0.569 Test Loss: 1.989 Test Acc: 0.569
Validation loss decreased (inf --> -0.569425).  Saving model ...
Epoch: 2 cost time: 60.78349494934082
Epoch: 2, Steps: 7 | Train Loss: 1.205 Vali Loss: 0.615 Vali Acc: 0.917 Test Loss: 0.615 Test Acc: 0.917
Validation loss decreased (-0.569425 --> -0.916661).  Saving model ...
Epoch: 3 cost time: 57.12510800361633
Epoch: 3, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 55.05022954940796
Epoch: 4, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 59.33188819885254
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 54.05613708496094
Epoch: 6, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 51.303890228271484
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 55.43727087974548
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 64.46876835823059
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 60.307992935180664
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.958 Test Loss: 0.277 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 59.83186411857605
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 57.3396430015564
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.958 Test Loss: 0.268 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 72.00676155090332
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.958 Test Loss: 0.263 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 77.42547416687012
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 77.25773286819458
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 70.11266827583313
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 74.67350172996521
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 72.95686793327332
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 66.71509981155396
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 71.19307971000671
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 65.65221619606018
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 63.90013408660889
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 78.23021078109741
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 77.61302495002747
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 29041548
model size : 112.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 27.86815094947815
Epoch: 1, Steps: 7 | Train Loss: 2.396 Vali Loss: 1.919 Vali Acc: 0.611 Test Loss: 1.919 Test Acc: 0.611
Validation loss decreased (inf --> -0.611092).  Saving model ...
Epoch: 2 cost time: 24.873065948486328
Epoch: 2, Steps: 7 | Train Loss: 1.135 Vali Loss: 0.671 Vali Acc: 0.847 Test Loss: 0.671 Test Acc: 0.847
Validation loss decreased (-0.611092 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 25.185200452804565
Epoch: 3, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 24.550236701965332
Epoch: 4, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.396 Vali Acc: 0.847 Test Loss: 0.396 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.97850513458252
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.83508324623108
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 24.780274391174316
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.916664 --> -0.958331).  Saving model ...
Epoch: 8 cost time: 27.478678941726685
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 25.59421181678772
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 10 cost time: 27.21935224533081
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 28.995582818984985
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 24.339458465576172
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 23.913283109664917
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.863195419311523
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 24.060285806655884
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 22.400021076202393
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 26.453192949295044
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 27.864282846450806
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 27.16743564605713
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 27.23059916496277
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 27.58564019203186
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 25.04576539993286
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 9182220
model size : 36.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 51.62914204597473
Epoch: 1, Steps: 7 | Train Loss: 2.542 Vali Loss: 1.989 Vali Acc: 0.569 Test Loss: 1.989 Test Acc: 0.569
Validation loss decreased (inf --> -0.569425).  Saving model ...
Epoch: 2 cost time: 50.073134899139404
Epoch: 2, Steps: 7 | Train Loss: 1.205 Vali Loss: 0.615 Vali Acc: 0.917 Test Loss: 0.615 Test Acc: 0.917
Validation loss decreased (-0.569425 --> -0.916661).  Saving model ...
Epoch: 3 cost time: 48.23374271392822
Epoch: 3, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 49.96892428398132
Epoch: 4, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 47.668816804885864
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 48.13456320762634
Epoch: 6, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 47.465818643569946
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 44.12045955657959
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 50.3664071559906
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 48.342249631881714
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.958 Test Loss: 0.277 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 44.02164030075073
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 43.30797076225281
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.958 Test Loss: 0.268 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 50.11803913116455
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.958 Test Loss: 0.263 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 54.541624546051025
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 54.31038761138916
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 54.98847460746765
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 45.018012285232544
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 45.50113034248352
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 44.715514183044434
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 49.711288928985596
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 51.08078336715698
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 53.02138161659241
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 52.70794749259949
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 44.88616108894348
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 29041548
model size : 112.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 18.435197353363037
Epoch: 1, Steps: 7 | Train Loss: 2.396 Vali Loss: 1.919 Vali Acc: 0.611 Test Loss: 1.919 Test Acc: 0.611
Validation loss decreased (inf --> -0.611092).  Saving model ...
Epoch: 2 cost time: 18.533336639404297
Epoch: 2, Steps: 7 | Train Loss: 1.135 Vali Loss: 0.671 Vali Acc: 0.847 Test Loss: 0.671 Test Acc: 0.847
Validation loss decreased (-0.611092 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 17.36175298690796
Epoch: 3, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 17.02056574821472
Epoch: 4, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.396 Vali Acc: 0.847 Test Loss: 0.396 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.89555311203003
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.69371247291565
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 19.158833980560303
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.916664 --> -0.958331).  Saving model ...
Epoch: 8 cost time: 19.854976892471313
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 19.480606079101562
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 10 cost time: 16.740617513656616
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 17.410332441329956
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 15.770440816879272
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 16.91122031211853
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 15.708688497543335
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 17.264617681503296
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 15.88465142250061
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 17.67255425453186
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 18.88410258293152
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 20.662501096725464
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 19.6639084815979
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 20.66044330596924
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 18.441505432128906
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 9182220
model size : 36.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 27.815879106521606
Epoch: 1, Steps: 7 | Train Loss: 2.543 Vali Loss: 1.989 Vali Acc: 0.569 Test Loss: 1.989 Test Acc: 0.569
Validation loss decreased (inf --> -0.569425).  Saving model ...
Epoch: 2 cost time: 27.330949544906616
Epoch: 2, Steps: 7 | Train Loss: 1.206 Vali Loss: 0.615 Vali Acc: 0.917 Test Loss: 0.615 Test Acc: 0.917
Validation loss decreased (-0.569425 --> -0.916661).  Saving model ...
Epoch: 3 cost time: 27.13752269744873
Epoch: 3, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 23.25783634185791
Epoch: 4, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.755082845687866
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.178784370422363
Epoch: 6, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 27.570632219314575
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 26.862961530685425
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 29.665746212005615
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 27.139870405197144
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.958 Test Loss: 0.277 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 25.813204526901245
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 23.912036180496216
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.958 Test Loss: 0.268 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 23.67836570739746
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.958 Test Loss: 0.263 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 23.70779061317444
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 24.178114891052246
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 27.413397550582886
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 25.806899785995483
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 28.495551586151123
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 24.126079559326172
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 25.890597820281982
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 24.71928381919861
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 23.748410940170288
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 25.37128448486328
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 25.70635223388672
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 29041548
model size : 112.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.489755153656006
Epoch: 1, Steps: 7 | Train Loss: 2.395 Vali Loss: 1.918 Vali Acc: 0.611 Test Loss: 1.918 Test Acc: 0.611
Validation loss decreased (inf --> -0.611092).  Saving model ...
Epoch: 2 cost time: 9.332510709762573
Epoch: 2, Steps: 7 | Train Loss: 1.135 Vali Loss: 0.671 Vali Acc: 0.847 Test Loss: 0.671 Test Acc: 0.847
Validation loss decreased (-0.611092 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 9.607962846755981
Epoch: 3, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 9.473917961120605
Epoch: 4, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.398 Vali Acc: 0.847 Test Loss: 0.398 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.33289909362793
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.528029441833496
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 9.509671449661255
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 8 cost time: 10.213895797729492
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 9.177786588668823
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 9.591567039489746
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 10.245473623275757
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 9.726734399795532
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 10.822176218032837
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.847006797790527
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.908377647399902
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.095125675201416
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.869666814804077
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.62082552909851
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.145138025283813
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.959023714065552
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.589229345321655
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.729928970336914
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 9182220
model size : 36.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 29.944334745407104
Epoch: 1, Steps: 7 | Train Loss: 2.403 Vali Loss: 1.832 Vali Acc: 0.653 Test Loss: 1.832 Test Acc: 0.653
Validation loss decreased (inf --> -0.652759).  Saving model ...
Epoch: 2 cost time: 29.37982726097107
Epoch: 2, Steps: 7 | Train Loss: 1.177 Vali Loss: 0.632 Vali Acc: 0.861 Test Loss: 0.632 Test Acc: 0.861
Validation loss decreased (-0.652759 --> -0.861105).  Saving model ...
Epoch: 3 cost time: 27.759620428085327
Epoch: 3, Steps: 7 | Train Loss: 0.192 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 28.176101207733154
Epoch: 4, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 32.217857122421265
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 32.6755747795105
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 31.688517808914185
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 28.629249334335327
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 29.26653003692627
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 29.210027933120728
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 28.220388889312744
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 36.7758092880249
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 36.623597860336304
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 35.52146291732788
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 36.509809494018555
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 33.04133725166321
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 30.840998888015747
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 33.78767275810242
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 14981772
model size : 58.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 14.994122982025146
Epoch: 1, Steps: 7 | Train Loss: 2.487 Vali Loss: 1.835 Vali Acc: 0.722 Test Loss: 1.835 Test Acc: 0.722
Validation loss decreased (inf --> -0.722204).  Saving model ...
Epoch: 2 cost time: 13.464225053787231
Epoch: 2, Steps: 7 | Train Loss: 1.221 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
Validation loss decreased (-0.722204 --> -0.833327).  Saving model ...
Epoch: 3 cost time: 13.14660120010376
Epoch: 3, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
Validation loss decreased (-0.833327 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 13.47173523902893
Epoch: 4, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.392 Vali Acc: 0.861 Test Loss: 0.392 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.271531343460083
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 6 cost time: 14.300431489944458
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 14.146408081054688
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.234815835952759
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.206256628036499
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.068253517150879
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.992766618728638
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 12.291918754577637
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 12.834655284881592
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 14 cost time: 12.947551965713501
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 15 cost time: 12.733598709106445
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.46735668182373
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.46830153465271
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 13.08901572227478
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 12.376595258712769
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 14.390214920043945
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 14.662715911865234
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 14.755559921264648
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 14.615233659744263
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 13.409914255142212
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 5051916
model size : 20.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 27.945348739624023
Epoch: 1, Steps: 7 | Train Loss: 2.403 Vali Loss: 1.832 Vali Acc: 0.653 Test Loss: 1.832 Test Acc: 0.653
Validation loss decreased (inf --> -0.652759).  Saving model ...
Epoch: 2 cost time: 27.507336378097534
Epoch: 2, Steps: 7 | Train Loss: 1.177 Vali Loss: 0.632 Vali Acc: 0.861 Test Loss: 0.632 Test Acc: 0.861
Validation loss decreased (-0.652759 --> -0.861105).  Saving model ...
Epoch: 3 cost time: 26.854663848876953
Epoch: 3, Steps: 7 | Train Loss: 0.192 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 23.45547318458557
Epoch: 4, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.902252912521362
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 26.171129941940308
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 26.64117670059204
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 24.821036338806152
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 26.261372804641724
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 26.989596128463745
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 26.702373027801514
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 24.531317234039307
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 24.9001145362854
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 26.94499969482422
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 25.462022304534912
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 24.058547496795654
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 24.983241319656372
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 25.217895984649658
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 14981772
model size : 58.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 11.829506874084473
Epoch: 1, Steps: 7 | Train Loss: 2.487 Vali Loss: 1.835 Vali Acc: 0.722 Test Loss: 1.835 Test Acc: 0.722
Validation loss decreased (inf --> -0.722204).  Saving model ...
Epoch: 2 cost time: 10.11283540725708
Epoch: 2, Steps: 7 | Train Loss: 1.221 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
Validation loss decreased (-0.722204 --> -0.833327).  Saving model ...
Epoch: 3 cost time: 10.092777967453003
Epoch: 3, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
Validation loss decreased (-0.833327 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 9.916042566299438
Epoch: 4, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.392 Vali Acc: 0.861 Test Loss: 0.392 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.441978454589844
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 6 cost time: 10.886809825897217
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 11.051150798797607
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.882330179214478
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.938315868377686
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.222733497619629
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.263760566711426
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 10.265090227127075
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 10.511947631835938
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 14 cost time: 10.895939826965332
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 15 cost time: 10.682764768600464
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.690061092376709
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.632455825805664
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.57578730583191
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.861612558364868
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.306434154510498
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.902939081192017
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.695915222167969
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 10.328263282775879
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 10.39608359336853
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 5051916
model size : 20.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 17.23304796218872
Epoch: 1, Steps: 7 | Train Loss: 2.402 Vali Loss: 1.831 Vali Acc: 0.653 Test Loss: 1.831 Test Acc: 0.653
Validation loss decreased (inf --> -0.652759).  Saving model ...
Epoch: 2 cost time: 14.230083465576172
Epoch: 2, Steps: 7 | Train Loss: 1.177 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
Validation loss decreased (-0.652759 --> -0.861105).  Saving model ...
Epoch: 3 cost time: 14.128567695617676
Epoch: 3, Steps: 7 | Train Loss: 0.192 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 14.162080764770508
Epoch: 4, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.259898900985718
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 15.626782417297363
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 15.749680757522583
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 15.727481603622437
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 14.853959798812866
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.18988847732544
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.209044456481934
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 15.011019468307495
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 15.01132607460022
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 14.801220893859863
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 13.270981073379517
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 13.146695375442505
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 13.399228811264038
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 13.827671527862549
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 14981772
model size : 58.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.236402034759521
Epoch: 1, Steps: 7 | Train Loss: 2.487 Vali Loss: 1.835 Vali Acc: 0.722 Test Loss: 1.835 Test Acc: 0.722
Validation loss decreased (inf --> -0.722204).  Saving model ...
Epoch: 2 cost time: 6.42151951789856
Epoch: 2, Steps: 7 | Train Loss: 1.221 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
Validation loss decreased (-0.722204 --> -0.833327).  Saving model ...
Epoch: 3 cost time: 6.496362924575806
Epoch: 3, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
Validation loss decreased (-0.833327 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 5.981399059295654
Epoch: 4, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.392 Vali Acc: 0.861 Test Loss: 0.392 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.4789369106292725
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 6 cost time: 4.424673795700073
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 5.410999774932861
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.919954776763916
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.3579747676849365
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.682964086532593
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.796572685241699
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 6.746227741241455
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 6.789727449417114
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 14 cost time: 6.865387439727783
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 15 cost time: 6.861076831817627
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.8456199169158936
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.711831569671631
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.741964817047119
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.684268474578857
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.730789422988892
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.853227853775024
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.192591667175293
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.340011119842529
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.182618141174316
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 5051916
model size : 20.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 23.083128690719604
Epoch: 1, Steps: 7 | Train Loss: 2.563 Vali Loss: 1.950 Vali Acc: 0.583 Test Loss: 1.950 Test Acc: 0.583
Validation loss decreased (inf --> -0.583314).  Saving model ...
Epoch: 2 cost time: 19.61205005645752
Epoch: 2, Steps: 7 | Train Loss: 1.263 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
Validation loss decreased (-0.583314 --> -0.861105).  Saving model ...
Epoch: 3 cost time: 18.106574296951294
Epoch: 3, Steps: 7 | Train Loss: 0.249 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 19.497655391693115
Epoch: 4, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 19.150214195251465
Epoch: 5, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.13746690750122
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.41726803779602
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 21.89045000076294
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.673460006713867
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.6304714679718
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 17.73452663421631
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 18.745217084884644
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 21.628738164901733
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 22.116814613342285
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 22.17585563659668
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 17.831257343292236
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 18.842673301696777
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 20.967487573623657
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 22.358575582504272
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 21.718011379241943
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 20.89846420288086
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 19.863916873931885
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 20.435607194900513
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 20.443536281585693
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 18.740726947784424
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 19.926693439483643
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 21.821187734603882
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 21.916404724121094
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 19.864198684692383
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 18.740367650985718
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 7951884
model size : 31.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.097182512283325
Epoch: 1, Steps: 7 | Train Loss: 2.520 Vali Loss: 1.953 Vali Acc: 0.542 Test Loss: 1.953 Test Acc: 0.542
Validation loss decreased (inf --> -0.541647).  Saving model ...
Epoch: 2 cost time: 8.761080265045166
Epoch: 2, Steps: 7 | Train Loss: 1.300 Vali Loss: 0.658 Vali Acc: 0.847 Test Loss: 0.658 Test Acc: 0.847
Validation loss decreased (-0.541647 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 8.734396934509277
Epoch: 3, Steps: 7 | Train Loss: 0.241 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 8.693035364151001
Epoch: 4, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 8.719990491867065
Epoch: 5, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.16292119026184
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.2053382396698
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.411109685897827
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.382633447647095
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.466507434844971
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.756025791168213
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.20617938041687
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.064539909362793
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.114228963851929
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 7.955880165100098
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 8.55364465713501
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 8.170369148254395
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 8.167074918746948
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 8.156551837921143
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 20 cost time: 8.320239782333374
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 21 cost time: 8.912903547286987
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 22 cost time: 8.708771467208862
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 8.193338632583618
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.193504333496094
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 8.182206630706787
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 8.015490770339966
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 7.81050443649292
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 7.755359888076782
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 7.192630052566528
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 8.051631927490234
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2986764
model size : 12.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 18.213255643844604
Epoch: 1, Steps: 7 | Train Loss: 2.563 Vali Loss: 1.950 Vali Acc: 0.583 Test Loss: 1.950 Test Acc: 0.583
Validation loss decreased (inf --> -0.583314).  Saving model ...
Epoch: 2 cost time: 16.257445812225342
Epoch: 2, Steps: 7 | Train Loss: 1.263 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
Validation loss decreased (-0.583314 --> -0.861105).  Saving model ...
Epoch: 3 cost time: 15.173330545425415
Epoch: 3, Steps: 7 | Train Loss: 0.249 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 13.829004526138306
Epoch: 4, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 13.668339967727661
Epoch: 5, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.894429206848145
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.913719654083252
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 16.108591079711914
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.05741310119629
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.284870624542236
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.271983861923218
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.936092138290405
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.92461633682251
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 14.452373027801514
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 15.05562686920166
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 14.538912534713745
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 13.876864194869995
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 15.862236261367798
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 15.763187885284424
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 12.905929565429688
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 13.965380191802979
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 14.43252682685852
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 12.679762125015259
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 13.172538995742798
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 15.733792543411255
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 15.423471927642822
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 14.038565635681152
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 14.64081072807312
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 14.867746829986572
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 12.82722020149231
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 7951884
model size : 31.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.61651086807251
Epoch: 1, Steps: 7 | Train Loss: 2.520 Vali Loss: 1.953 Vali Acc: 0.542 Test Loss: 1.953 Test Acc: 0.542
Validation loss decreased (inf --> -0.541647).  Saving model ...
Epoch: 2 cost time: 6.772053480148315
Epoch: 2, Steps: 7 | Train Loss: 1.300 Vali Loss: 0.658 Vali Acc: 0.847 Test Loss: 0.658 Test Acc: 0.847
Validation loss decreased (-0.541647 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 6.807966232299805
Epoch: 3, Steps: 7 | Train Loss: 0.241 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 6.042800664901733
Epoch: 4, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 6.054464817047119
Epoch: 5, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.143078088760376
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.82090425491333
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.891383647918701
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.786656141281128
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.2614710330963135
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.710688829421997
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.525006055831909
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.5625529289245605
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.103682518005371
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 6.467744827270508
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 6.448911428451538
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 6.485173225402832
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 5.66473126411438
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 6.139071702957153
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 20 cost time: 6.221707582473755
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 21 cost time: 6.917046070098877
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 22 cost time: 6.8136327266693115
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 6.846962928771973
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.924983739852905
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 6.150550365447998
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.97528338432312
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.637691020965576
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.2905614376068115
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.437499523162842
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.589576482772827
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2986764
model size : 12.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.709689855575562
Epoch: 1, Steps: 7 | Train Loss: 2.564 Vali Loss: 1.950 Vali Acc: 0.583 Test Loss: 1.950 Test Acc: 0.583
Validation loss decreased (inf --> -0.583314).  Saving model ...
Epoch: 2 cost time: 7.9209184646606445
Epoch: 2, Steps: 7 | Train Loss: 1.264 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
Validation loss decreased (-0.583314 --> -0.861105).  Saving model ...
Epoch: 3 cost time: 9.153697490692139
Epoch: 3, Steps: 7 | Train Loss: 0.249 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 8.705152988433838
Epoch: 4, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 8.415419340133667
Epoch: 5, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.137970685958862
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.385 Vali Acc: 0.903 Test Loss: 0.385 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.7465128898620605
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 9.904093980789185
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.944284439086914
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.655874967575073
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.94318151473999
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.901249170303345
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.83795976638794
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 9.953017711639404
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 9.828197240829468
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 8.233809471130371
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 7.86201548576355
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 8.752132177352905
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 9.235113143920898
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 9.179515361785889
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 8.26341724395752
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 8.064413785934448
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 7.992912530899048
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 10.035522937774658
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 10.06812834739685
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 9.697724103927612
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 9.05947470664978
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 9.08307147026062
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 9.959951639175415
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 10.012675523757935
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 7951884
model size : 31.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.029022693634033
Epoch: 1, Steps: 7 | Train Loss: 2.520 Vali Loss: 1.953 Vali Acc: 0.542 Test Loss: 1.953 Test Acc: 0.542
Validation loss decreased (inf --> -0.541647).  Saving model ...
Epoch: 2 cost time: 3.673733949661255
Epoch: 2, Steps: 7 | Train Loss: 1.300 Vali Loss: 0.658 Vali Acc: 0.847 Test Loss: 0.658 Test Acc: 0.847
Validation loss decreased (-0.541647 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 3.738140344619751
Epoch: 3, Steps: 7 | Train Loss: 0.241 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 4.176384449005127
Epoch: 4, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 4.161625623703003
Epoch: 5, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.116634130477905
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9781646728515625
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.118109226226807
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.006295442581177
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.675292730331421
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.6183900833129883
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.6525309085845947
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.7402515411376953
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.082221269607544
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 4.377453327178955
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 4.419109344482422
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 4.476202964782715
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 4.4450623989105225
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 4.43831992149353
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 20 cost time: 3.9983928203582764
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 21 cost time: 3.912198305130005
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 22 cost time: 3.940105438232422
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 4.0421624183654785
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.393481492996216
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 4.444512128829956
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.36404013633728
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.428611516952515
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.32475209236145
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.363176345825195
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.027893304824829
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2986764
model size : 12.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 19.445818185806274
Epoch: 1, Steps: 7 | Train Loss: 2.477 Vali Loss: 2.170 Vali Acc: 0.403 Test Loss: 2.170 Test Acc: 0.403
Validation loss decreased (inf --> -0.402756).  Saving model ...
Epoch: 2 cost time: 16.682756900787354
Epoch: 2, Steps: 7 | Train Loss: 1.700 Vali Loss: 1.194 Vali Acc: 0.806 Test Loss: 1.194 Test Acc: 0.806
Validation loss decreased (-0.402756 --> -0.805544).  Saving model ...
Epoch: 3 cost time: 21.01171374320984
Epoch: 3, Steps: 7 | Train Loss: 0.671 Vali Loss: 0.549 Vali Acc: 0.903 Test Loss: 0.549 Test Acc: 0.903
Validation loss decreased (-0.805544 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 18.8213152885437
Epoch: 4, Steps: 7 | Train Loss: 0.176 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 19.641413927078247
Epoch: 5, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 21.42288064956665
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.706944465637207
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958332).  Saving model ...
Epoch: 8 cost time: 18.630791664123535
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 20.033358335494995
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.72194814682007
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 19.006355047225952
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 19.57662296295166
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 22.792006492614746
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 20.97835111618042
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 20.023974895477295
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 21.886157274246216
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 19.845199823379517
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 18.655073881149292
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 20.59244155883789
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 20.207419395446777
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 20.163309812545776
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 21.65375304222107
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 22.38840079307556
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 20.736426830291748
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 18.61253046989441
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 20.30875277519226
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 19.566004991531372
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 18.899544954299927
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 21.414724111557007
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 21.542158603668213
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 7492044
model size : 29.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.903674125671387
Epoch: 1, Steps: 7 | Train Loss: 2.500 Vali Loss: 2.212 Vali Acc: 0.222 Test Loss: 2.212 Test Acc: 0.222
Validation loss decreased (inf --> -0.222200).  Saving model ...
Epoch: 2 cost time: 9.10898756980896
Epoch: 2, Steps: 7 | Train Loss: 1.690 Vali Loss: 1.199 Vali Acc: 0.819 Test Loss: 1.199 Test Acc: 0.819
Validation loss decreased (-0.222200 --> -0.819432).  Saving model ...
Epoch: 3 cost time: 8.976988077163696
Epoch: 3, Steps: 7 | Train Loss: 0.640 Vali Loss: 0.533 Vali Acc: 0.903 Test Loss: 0.533 Test Acc: 0.903
Validation loss decreased (-0.819432 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 8.834978342056274
Epoch: 4, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 8.956723928451538
Epoch: 5, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 8.051536798477173
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 8.31849193572998
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 8.125659942626953
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.710788488388062
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.57167911529541
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.6355881690979
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.949692726135254
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 8.883888721466064
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.755308389663696
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.56198763847351
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.353614807128906
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.830565214157104
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.31673264503479
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.281647205352783
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.37466812133789
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.502761840820312
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.29128909111023
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2526732
model size : 10.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 17.488837957382202
Epoch: 1, Steps: 7 | Train Loss: 2.477 Vali Loss: 2.170 Vali Acc: 0.403 Test Loss: 2.170 Test Acc: 0.403
Validation loss decreased (inf --> -0.402756).  Saving model ...
Epoch: 2 cost time: 16.208787202835083
Epoch: 2, Steps: 7 | Train Loss: 1.700 Vali Loss: 1.194 Vali Acc: 0.806 Test Loss: 1.194 Test Acc: 0.806
Validation loss decreased (-0.402756 --> -0.805544).  Saving model ...
Epoch: 3 cost time: 15.274747133255005
Epoch: 3, Steps: 7 | Train Loss: 0.671 Vali Loss: 0.549 Vali Acc: 0.903 Test Loss: 0.549 Test Acc: 0.903
Validation loss decreased (-0.805544 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 15.281811714172363
Epoch: 4, Steps: 7 | Train Loss: 0.176 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 16.631125688552856
Epoch: 5, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 16.661025762557983
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.51381778717041
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958332).  Saving model ...
Epoch: 8 cost time: 13.926253080368042
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.09413170814514
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.881454229354858
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.278472423553467
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 15.378344058990479
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 15.770421743392944
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 15.801851511001587
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.216211557388306
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 14.244951725006104
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 14.52863097190857
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 15.58147120475769
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 15.559483766555786
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 14.168491840362549
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 15.114385604858398
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 16.52507257461548
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 16.518613815307617
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 15.783577680587769
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 14.634011030197144
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 14.298685550689697
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 14.904600858688354
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 14.619346380233765
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 13.54723334312439
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 13.824421644210815
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 7492044
model size : 29.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.32036542892456
Epoch: 1, Steps: 7 | Train Loss: 2.500 Vali Loss: 2.212 Vali Acc: 0.222 Test Loss: 2.212 Test Acc: 0.222
Validation loss decreased (inf --> -0.222200).  Saving model ...
Epoch: 2 cost time: 7.687865972518921
Epoch: 2, Steps: 7 | Train Loss: 1.690 Vali Loss: 1.199 Vali Acc: 0.819 Test Loss: 1.199 Test Acc: 0.819
Validation loss decreased (-0.222200 --> -0.819432).  Saving model ...
Epoch: 3 cost time: 7.066911220550537
Epoch: 3, Steps: 7 | Train Loss: 0.640 Vali Loss: 0.533 Vali Acc: 0.903 Test Loss: 0.533 Test Acc: 0.903
Validation loss decreased (-0.819432 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 7.245420694351196
Epoch: 4, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 7.089264392852783
Epoch: 5, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 7.14145827293396
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 7.48470401763916
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 7.179398059844971
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.221654415130615
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.131670951843262
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.322370767593384
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.601775407791138
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 6.308881521224976
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.395742893218994
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.216428518295288
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.362141370773315
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.64729118347168
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.3621132373809814
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.941736221313477
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.0935304164886475
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.129187822341919
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.672649383544922
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2526732
model size : 10.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.632159233093262
Epoch: 1, Steps: 7 | Train Loss: 2.477 Vali Loss: 2.170 Vali Acc: 0.403 Test Loss: 2.170 Test Acc: 0.403
Validation loss decreased (inf --> -0.402756).  Saving model ...
Epoch: 2 cost time: 9.21373200416565
Epoch: 2, Steps: 7 | Train Loss: 1.701 Vali Loss: 1.194 Vali Acc: 0.819 Test Loss: 1.194 Test Acc: 0.819
Validation loss decreased (-0.402756 --> -0.819433).  Saving model ...
Epoch: 3 cost time: 8.282834768295288
Epoch: 3, Steps: 7 | Train Loss: 0.672 Vali Loss: 0.549 Vali Acc: 0.903 Test Loss: 0.549 Test Acc: 0.903
Validation loss decreased (-0.819433 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 7.796753883361816
Epoch: 4, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 8.858266830444336
Epoch: 5, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 9.068675518035889
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.257626056671143
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958332).  Saving model ...
Epoch: 8 cost time: 7.868640184402466
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.751274585723877
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.857791900634766
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.08577275276184
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 8.334094524383545
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 9.192180871963501
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 9.704393148422241
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.979142904281616
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.581940650939941
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.407320022583008
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.881205797195435
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.123183488845825
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.365943431854248
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.297503232955933
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.499430179595947
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.8927741050720215
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 8.409588813781738
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 9.152251958847046
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 9.701515436172485
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 8.80849289894104
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 8.495085000991821
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 9.224341869354248
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 9.738869905471802
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 7492044
model size : 29.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.3087193965911865
Epoch: 1, Steps: 7 | Train Loss: 2.500 Vali Loss: 2.212 Vali Acc: 0.222 Test Loss: 2.212 Test Acc: 0.222
Validation loss decreased (inf --> -0.222200).  Saving model ...
Epoch: 2 cost time: 4.372762203216553
Epoch: 2, Steps: 7 | Train Loss: 1.689 Vali Loss: 1.199 Vali Acc: 0.819 Test Loss: 1.199 Test Acc: 0.819
Validation loss decreased (-0.222200 --> -0.819432).  Saving model ...
Epoch: 3 cost time: 4.1075990200042725
Epoch: 3, Steps: 7 | Train Loss: 0.640 Vali Loss: 0.533 Vali Acc: 0.903 Test Loss: 0.533 Test Acc: 0.903
Validation loss decreased (-0.819432 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 4.35274863243103
Epoch: 4, Steps: 7 | Train Loss: 0.181 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 3.713270902633667
Epoch: 5, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 3.793936252593994
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 3.668452262878418
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 3.870575428009033
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.174306392669678
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.700918674468994
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.764474391937256
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.28060245513916
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 4.220365047454834
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.239087104797363
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.159367084503174
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.56096339225769
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.704578161239624
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.671370983123779
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.068851709365845
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.784892559051514
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.46530556678772
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.749267101287842
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2526732
model size : 10.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 15.391595602035522
Epoch: 1, Steps: 7 | Train Loss: 2.460 Vali Loss: 2.100 Vali Acc: 0.389 Test Loss: 2.100 Test Acc: 0.389
Validation loss decreased (inf --> -0.388868).  Saving model ...
Epoch: 2 cost time: 12.319704294204712
Epoch: 2, Steps: 7 | Train Loss: 1.655 Vali Loss: 1.134 Vali Acc: 0.861 Test Loss: 1.134 Test Acc: 0.861
Validation loss decreased (-0.388868 --> -0.861100).  Saving model ...
Epoch: 3 cost time: 12.420281171798706
Epoch: 3, Steps: 7 | Train Loss: 0.653 Vali Loss: 0.556 Vali Acc: 0.889 Test Loss: 0.556 Test Acc: 0.889
Validation loss decreased (-0.861100 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 13.968528270721436
Epoch: 4, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.870349645614624
Epoch: 5, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 12.98538613319397
Epoch: 6, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.92277717590332
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.019957304000854
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.141963481903076
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.072176933288574
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 12.1247398853302
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 14.62398886680603
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 10.254080533981323
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 10.278672218322754
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 11.295993089675903
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 12.248467683792114
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.572975873947144
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.49901270866394
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 13.114882707595825
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.514561891555786
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.286283254623413
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.644360542297363
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 12.094861268997192
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 12.221543073654175
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 13.04471468925476
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 3976524
model size : 15.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.261533498764038
Epoch: 1, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.203 Vali Acc: 0.306 Test Loss: 2.203 Test Acc: 0.306
Validation loss decreased (inf --> -0.305534).  Saving model ...
Epoch: 2 cost time: 5.2587714195251465
Epoch: 2, Steps: 7 | Train Loss: 1.708 Vali Loss: 1.147 Vali Acc: 0.764 Test Loss: 1.147 Test Acc: 0.764
Validation loss decreased (-0.305534 --> -0.763877).  Saving model ...
Epoch: 3 cost time: 5.216684579849243
Epoch: 3, Steps: 7 | Train Loss: 0.634 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
Validation loss decreased (-0.763877 --> -0.861106).  Saving model ...
Epoch: 4 cost time: 5.8042521476745605
Epoch: 4, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888886).  Saving model ...
Epoch: 5 cost time: 5.41497802734375
Epoch: 5, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.783483028411865
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 5.085992336273193
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 5.414582252502441
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 6.245335578918457
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 6.0606513023376465
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 6.3772008419036865
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.549302339553833
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.231375694274902
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.642594337463379
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.134194374084473
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.442578315734863
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.098186731338501
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.251134157180786
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.9292943477630615
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.67688512802124
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1493772
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 12.670192241668701
Epoch: 1, Steps: 7 | Train Loss: 2.460 Vali Loss: 2.100 Vali Acc: 0.389 Test Loss: 2.100 Test Acc: 0.389
Validation loss decreased (inf --> -0.388868).  Saving model ...
Epoch: 2 cost time: 11.480804443359375
Epoch: 2, Steps: 7 | Train Loss: 1.655 Vali Loss: 1.134 Vali Acc: 0.861 Test Loss: 1.134 Test Acc: 0.861
Validation loss decreased (-0.388868 --> -0.861100).  Saving model ...
Epoch: 3 cost time: 10.838114738464355
Epoch: 3, Steps: 7 | Train Loss: 0.653 Vali Loss: 0.556 Vali Acc: 0.889 Test Loss: 0.556 Test Acc: 0.889
Validation loss decreased (-0.861100 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 8.153305530548096
Epoch: 4, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.305426836013794
Epoch: 5, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 9.635409593582153
Epoch: 6, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.9096097946167
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.408281326293945
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.105613231658936
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.68039846420288
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 10.117156982421875
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 9.391966342926025
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 7.424179315567017
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 10.152831554412842
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 8.89191460609436
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 8.643075466156006
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.264539241790771
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.206153392791748
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.798890352249146
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.120352268218994
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.315513610839844
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.53601336479187
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.728874206542969
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.138636589050293
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.09477949142456
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 3976524
model size : 15.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.983444452285767
Epoch: 1, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.204 Vali Acc: 0.306 Test Loss: 2.204 Test Acc: 0.306
Validation loss decreased (inf --> -0.305534).  Saving model ...
Epoch: 2 cost time: 4.0606019496917725
Epoch: 2, Steps: 7 | Train Loss: 1.708 Vali Loss: 1.146 Vali Acc: 0.764 Test Loss: 1.146 Test Acc: 0.764
Validation loss decreased (-0.305534 --> -0.763877).  Saving model ...
Epoch: 3 cost time: 4.181736469268799
Epoch: 3, Steps: 7 | Train Loss: 0.634 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
Validation loss decreased (-0.763877 --> -0.861106).  Saving model ...
Epoch: 4 cost time: 4.252188205718994
Epoch: 4, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888886).  Saving model ...
Epoch: 5 cost time: 4.61508846282959
Epoch: 5, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.074313640594482
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 3.8409619331359863
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 3.3937673568725586
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 4.022277593612671
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 4.034295558929443
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 4.415889263153076
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.900272607803345
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.735850095748901
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.264310836791992
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.1712236404418945
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.536861896514893
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.722522497177124
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.428288698196411
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.171794414520264
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.067061185836792
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1493772
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.854693412780762
Epoch: 1, Steps: 7 | Train Loss: 2.460 Vali Loss: 2.100 Vali Acc: 0.389 Test Loss: 2.100 Test Acc: 0.389
Validation loss decreased (inf --> -0.388868).  Saving model ...
Epoch: 2 cost time: 4.8737568855285645
Epoch: 2, Steps: 7 | Train Loss: 1.655 Vali Loss: 1.134 Vali Acc: 0.861 Test Loss: 1.134 Test Acc: 0.861
Validation loss decreased (-0.388868 --> -0.861100).  Saving model ...
Epoch: 3 cost time: 5.86961817741394
Epoch: 3, Steps: 7 | Train Loss: 0.653 Vali Loss: 0.556 Vali Acc: 0.889 Test Loss: 0.556 Test Acc: 0.889
Validation loss decreased (-0.861100 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 6.412293434143066
Epoch: 4, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.3228254318237305
Epoch: 5, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 6.676171541213989
Epoch: 6, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.228055238723755
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.1745405197143555
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.358741044998169
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.55312442779541
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 4.993838787078857
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 5.089509725570679
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 5.358959197998047
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 5.111077547073364
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 5.947601556777954
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 5.844887971878052
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.315160274505615
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.760206937789917
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.553675413131714
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.219855785369873
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.720789909362793
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.999847173690796
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.596598386764526
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.13144063949585
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.202181339263916
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 3976524
model size : 15.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.710614919662476
Epoch: 1, Steps: 7 | Train Loss: 2.516 Vali Loss: 2.204 Vali Acc: 0.306 Test Loss: 2.204 Test Acc: 0.306
Validation loss decreased (inf --> -0.305534).  Saving model ...
Epoch: 2 cost time: 3.0942604541778564
Epoch: 2, Steps: 7 | Train Loss: 1.708 Vali Loss: 1.147 Vali Acc: 0.764 Test Loss: 1.147 Test Acc: 0.764
Validation loss decreased (-0.305534 --> -0.763877).  Saving model ...
Epoch: 3 cost time: 3.1293256282806396
Epoch: 3, Steps: 7 | Train Loss: 0.634 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
Validation loss decreased (-0.763877 --> -0.861106).  Saving model ...
Epoch: 4 cost time: 2.7672088146209717
Epoch: 4, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888886).  Saving model ...
Epoch: 5 cost time: 2.925853967666626
Epoch: 5, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.640103816986084
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 3.2357404232025146
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 3.355905532836914
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 2.807234048843384
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.9972069263458252
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 2.246211290359497
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.502504587173462
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7735183238983154
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5687057971954346
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3973748683929443
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.802805185317993
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.84576153755188
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1308963298797607
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.9611432552337646
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.892747402191162
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1493772
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.8793306350708
Epoch: 1, Steps: 7 | Train Loss: 2.529 Vali Loss: 2.233 Vali Acc: 0.417 Test Loss: 2.233 Test Acc: 0.417
Validation loss decreased (inf --> -0.416644).  Saving model ...
Epoch: 2 cost time: 5.625755548477173
Epoch: 2, Steps: 7 | Train Loss: 1.780 Vali Loss: 1.283 Vali Acc: 0.819 Test Loss: 1.283 Test Acc: 0.819
Validation loss decreased (-0.416644 --> -0.819432).  Saving model ...
Epoch: 3 cost time: 6.468138217926025
Epoch: 3, Steps: 7 | Train Loss: 0.780 Vali Loss: 0.665 Vali Acc: 0.861 Test Loss: 0.665 Test Acc: 0.861
Validation loss decreased (-0.819432 --> -0.861104).  Saving model ...
Epoch: 4 cost time: 7.647457122802734
Epoch: 4, Steps: 7 | Train Loss: 0.265 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874996).  Saving model ...
Epoch: 5 cost time: 7.130244255065918
Epoch: 5, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 6.007872819900513
Epoch: 6, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 7.973145961761475
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.895315647125244
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.243621587753296
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.035930156707764
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 10.319698333740234
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.947479486465454
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.002823829650879
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 8.44047737121582
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 8.703672647476196
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 7.545335531234741
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.579482316970825
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.504007339477539
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.673265695571899
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 7.622353553771973
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 8.505732774734497
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.204844236373901
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 8.169564247131348
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.85305118560791
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 9.269911050796509
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 8.702114582061768
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 8.36363697052002
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 9.458442687988281
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.895016193389893
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 8.457594633102417
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 2218764
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.071966886520386
Epoch: 1, Steps: 7 | Train Loss: 2.480 Vali Loss: 2.302 Vali Acc: 0.333 Test Loss: 2.302 Test Acc: 0.333
Validation loss decreased (inf --> -0.333310).  Saving model ...
Epoch: 2 cost time: 4.4554877281188965
Epoch: 2, Steps: 7 | Train Loss: 1.775 Vali Loss: 1.328 Vali Acc: 0.833 Test Loss: 1.328 Test Acc: 0.833
Validation loss decreased (-0.333310 --> -0.833320).  Saving model ...
Epoch: 3 cost time: 4.21400260925293
Epoch: 3, Steps: 7 | Train Loss: 0.795 Vali Loss: 0.688 Vali Acc: 0.903 Test Loss: 0.688 Test Acc: 0.903
Validation loss decreased (-0.833320 --> -0.902771).  Saving model ...
Epoch: 4 cost time: 5.303618431091309
Epoch: 4, Steps: 7 | Train Loss: 0.264 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 4.846471786499023
Epoch: 5, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.902774 --> -0.944441).  Saving model ...
Epoch: 6 cost time: 4.788165092468262
Epoch: 6, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.323 Vali Acc: 0.931 Test Loss: 0.323 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.878016948699951
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.477514743804932
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 4.1425464153289795
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 3.507957696914673
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 4.159804582595825
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 4.787975311279297
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 4.524414539337158
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 3.953620195388794
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 4.119256258010864
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 3.7521121501922607
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 4.466317653656006
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.396574020385742
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.426011085510254
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.126952648162842
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.955268383026123
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.999577522277832
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.415542840957642
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.554450511932373
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 4.199740648269653
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 4.167046785354614
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.774209499359131
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.8453710079193115
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.266932010650635
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 4.16152811050415
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 977292
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.188308477401733
Epoch: 1, Steps: 7 | Train Loss: 2.529 Vali Loss: 2.233 Vali Acc: 0.417 Test Loss: 2.233 Test Acc: 0.417
Validation loss decreased (inf --> -0.416644).  Saving model ...
Epoch: 2 cost time: 6.695197343826294
Epoch: 2, Steps: 7 | Train Loss: 1.780 Vali Loss: 1.283 Vali Acc: 0.819 Test Loss: 1.283 Test Acc: 0.819
Validation loss decreased (-0.416644 --> -0.819432).  Saving model ...
Epoch: 3 cost time: 5.43833065032959
Epoch: 3, Steps: 7 | Train Loss: 0.780 Vali Loss: 0.665 Vali Acc: 0.861 Test Loss: 0.665 Test Acc: 0.861
Validation loss decreased (-0.819432 --> -0.861104).  Saving model ...
Epoch: 4 cost time: 5.513620853424072
Epoch: 4, Steps: 7 | Train Loss: 0.265 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874996).  Saving model ...
Epoch: 5 cost time: 6.246319532394409
Epoch: 5, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 7.010751485824585
Epoch: 6, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 6.0583600997924805
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.207978963851929
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.370876312255859
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.235626459121704
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 7.218602418899536
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.539987325668335
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.57513427734375
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 7.510105848312378
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 7.211580514907837
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 6.730047702789307
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.657470941543579
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.461795091629028
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.392454147338867
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 7.042600631713867
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 6.649415969848633
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.634854793548584
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.423904657363892
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.089587688446045
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.740094423294067
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 7.187323808670044
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.5653910636901855
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.729211807250977
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.599685430526733
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.773630380630493
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 2218764
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.85558819770813
Epoch: 1, Steps: 7 | Train Loss: 2.480 Vali Loss: 2.299 Vali Acc: 0.333 Test Loss: 2.299 Test Acc: 0.333
Validation loss decreased (inf --> -0.333310).  Saving model ...
Epoch: 2 cost time: 2.8263726234436035
Epoch: 2, Steps: 7 | Train Loss: 1.775 Vali Loss: 1.326 Vali Acc: 0.833 Test Loss: 1.326 Test Acc: 0.833
Validation loss decreased (-0.333310 --> -0.833320).  Saving model ...
Epoch: 3 cost time: 3.186321973800659
Epoch: 3, Steps: 7 | Train Loss: 0.795 Vali Loss: 0.688 Vali Acc: 0.903 Test Loss: 0.688 Test Acc: 0.903
Validation loss decreased (-0.833320 --> -0.902771).  Saving model ...
Epoch: 4 cost time: 3.579693078994751
Epoch: 4, Steps: 7 | Train Loss: 0.264 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 3.349672317504883
Epoch: 5, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.902774 --> -0.944441).  Saving model ...
Epoch: 6 cost time: 3.371856451034546
Epoch: 6, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.323 Vali Acc: 0.931 Test Loss: 0.323 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5710997581481934
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.751934766769409
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 3.5727956295013428
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 3.5937228202819824
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 3.508427619934082
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 3.159013032913208
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 2.824164867401123
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 3.1688966751098633
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 3.798750400543213
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 3.8125946521759033
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 3.6953043937683105
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5560684204101562
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.9385287761688232
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.9655215740203857
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.9650847911834717
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.9637844562530518
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.8975536823272705
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.541555643081665
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 3.798614740371704
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 3.931856870651245
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.733375310897827
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.776014804840088
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.832963466644287
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 3.8614017963409424
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 977292
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.798733472824097
Epoch: 1, Steps: 7 | Train Loss: 2.530 Vali Loss: 2.233 Vali Acc: 0.417 Test Loss: 2.233 Test Acc: 0.417
Validation loss decreased (inf --> -0.416644).  Saving model ...
Epoch: 2 cost time: 4.272487640380859
Epoch: 2, Steps: 7 | Train Loss: 1.782 Vali Loss: 1.283 Vali Acc: 0.819 Test Loss: 1.283 Test Acc: 0.819
Validation loss decreased (-0.416644 --> -0.819432).  Saving model ...
Epoch: 3 cost time: 4.583438158035278
Epoch: 3, Steps: 7 | Train Loss: 0.782 Vali Loss: 0.665 Vali Acc: 0.861 Test Loss: 0.665 Test Acc: 0.861
Validation loss decreased (-0.819432 --> -0.861104).  Saving model ...
Epoch: 4 cost time: 4.462862968444824
Epoch: 4, Steps: 7 | Train Loss: 0.266 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874996).  Saving model ...
Epoch: 5 cost time: 4.499472379684448
Epoch: 5, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 4.517412900924683
Epoch: 6, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 4.402670860290527
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.792847156524658
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.879345655441284
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.862497568130493
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 3.554718494415283
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.988490104675293
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9617135524749756
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 4.334870100021362
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 4.244206428527832
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 4.299618721008301
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.616576910018921
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.056992053985596
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.512481451034546
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 4.261598110198975
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 4.042238473892212
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.108417510986328
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.115579128265381
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.187678098678589
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.174062967300415
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.328595399856567
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.048619270324707
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.909027099609375
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.824170112609863
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.77924919128418
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 2218764
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.7261717319488525
Epoch: 1, Steps: 7 | Train Loss: 2.480 Vali Loss: 2.299 Vali Acc: 0.333 Test Loss: 2.299 Test Acc: 0.333
Validation loss decreased (inf --> -0.333310).  Saving model ...
Epoch: 2 cost time: 2.4763214588165283
Epoch: 2, Steps: 7 | Train Loss: 1.775 Vali Loss: 1.326 Vali Acc: 0.833 Test Loss: 1.326 Test Acc: 0.833
Validation loss decreased (-0.333310 --> -0.833320).  Saving model ...
Epoch: 3 cost time: 2.5348880290985107
Epoch: 3, Steps: 7 | Train Loss: 0.795 Vali Loss: 0.688 Vali Acc: 0.903 Test Loss: 0.688 Test Acc: 0.903
Validation loss decreased (-0.833320 --> -0.902771).  Saving model ...
Epoch: 4 cost time: 2.551947593688965
Epoch: 4, Steps: 7 | Train Loss: 0.264 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 2.492598533630371
Epoch: 5, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.902774 --> -0.944441).  Saving model ...
Epoch: 6 cost time: 2.4126291275024414
Epoch: 6, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.323 Vali Acc: 0.931 Test Loss: 0.323 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2226271629333496
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3088512420654297
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 2.373971462249756
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 2.5821428298950195
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 2.4674949645996094
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 2.7251758575439453
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 2.65086030960083
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 2.7256102561950684
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 2.7347099781036377
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 2.519688129425049
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 2.5684022903442383
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.640839099884033
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.856593132019043
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.663522958755493
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5620906352996826
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.3747611045837402
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.435044527053833
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.5779850482940674
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 2.5722110271453857
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 2.2944767475128174
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.382269859313965
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.299978494644165
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.382026195526123
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 2.482050895690918
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 977292
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 13.351005792617798
Epoch: 1, Steps: 7 | Train Loss: 2.498 Vali Loss: 2.363 Vali Acc: 0.236 Test Loss: 2.363 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 12.883771896362305
Epoch: 2, Steps: 7 | Train Loss: 2.080 Vali Loss: 1.735 Vali Acc: 0.708 Test Loss: 1.735 Test Acc: 0.708
Validation loss decreased (-0.236087 --> -0.708316).  Saving model ...
Epoch: 3 cost time: 11.64026165008545
Epoch: 3, Steps: 7 | Train Loss: 1.309 Vali Loss: 1.095 Vali Acc: 0.819 Test Loss: 1.095 Test Acc: 0.819
Validation loss decreased (-0.708316 --> -0.819433).  Saving model ...
Epoch: 4 cost time: 12.072383642196655
Epoch: 4, Steps: 7 | Train Loss: 0.712 Vali Loss: 0.684 Vali Acc: 0.847 Test Loss: 0.684 Test Acc: 0.847
Validation loss decreased (-0.819433 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 12.590014696121216
Epoch: 5, Steps: 7 | Train Loss: 0.330 Vali Loss: 0.480 Vali Acc: 0.889 Test Loss: 0.480 Test Acc: 0.889
Validation loss decreased (-0.847215 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 13.15645694732666
Epoch: 6, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 13.105390548706055
Epoch: 7, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.165578842163086
Epoch: 8, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.044185876846313
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 12.010449647903442
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.367927312850952
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.39030909538269
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.7308509349823
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.28697395324707
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 12.22291088104248
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 13.424304723739624
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 13.523063898086548
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 13.218844175338745
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 11.721743106842041
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.578908681869507
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 11.19235897064209
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 11.240407705307007
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 11.913936853408813
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 11.958244323730469
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 10.989370584487915
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 11.371815204620361
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 12.227160453796387
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 12.454010725021362
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 13.518687725067139
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 12.924924850463867
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1988844
model size : 7.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.79049277305603
Epoch: 1, Steps: 7 | Train Loss: 2.424 Vali Loss: 2.310 Vali Acc: 0.250 Test Loss: 2.310 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 5.830142259597778
Epoch: 2, Steps: 7 | Train Loss: 2.004 Vali Loss: 1.707 Vali Acc: 0.681 Test Loss: 1.707 Test Acc: 0.681
Validation loss decreased (-0.249977 --> -0.680538).  Saving model ...
Epoch: 3 cost time: 6.037353754043579
Epoch: 3, Steps: 7 | Train Loss: 1.286 Vali Loss: 1.125 Vali Acc: 0.778 Test Loss: 1.125 Test Acc: 0.778
Validation loss decreased (-0.680538 --> -0.777767).  Saving model ...
Epoch: 4 cost time: 6.201672554016113
Epoch: 4, Steps: 7 | Train Loss: 0.663 Vali Loss: 0.730 Vali Acc: 0.833 Test Loss: 0.730 Test Acc: 0.833
Validation loss decreased (-0.777767 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 6.131760358810425
Epoch: 5, Steps: 7 | Train Loss: 0.332 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
Validation loss decreased (-0.833326 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 6.088960647583008
Epoch: 6, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.454 Vali Acc: 0.861 Test Loss: 0.454 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.2352001667022705
Epoch: 7, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.1406755447387695
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.9758546352386475
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 4.778878211975098
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 4.777158260345459
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 4.736286640167236
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 4.871897220611572
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 5.271957635879517
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 5.283986568450928
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 5.328649520874023
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.3702781200408936
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.273728132247925
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 4.979006290435791
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 4.45650577545166
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 4.695583820343018
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 5.047484397888184
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 5.064421653747559
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 4.947814464569092
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 5.618428468704224
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.380256175994873
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.506828546524048
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.621052503585815
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 5.7331554889678955
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 5.716911792755127
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 747276
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.931768894195557
Epoch: 1, Steps: 7 | Train Loss: 2.498 Vali Loss: 2.363 Vali Acc: 0.236 Test Loss: 2.363 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 8.415083169937134
Epoch: 2, Steps: 7 | Train Loss: 2.080 Vali Loss: 1.735 Vali Acc: 0.708 Test Loss: 1.735 Test Acc: 0.708
Validation loss decreased (-0.236087 --> -0.708316).  Saving model ...
Epoch: 3 cost time: 9.085886716842651
Epoch: 3, Steps: 7 | Train Loss: 1.309 Vali Loss: 1.095 Vali Acc: 0.819 Test Loss: 1.095 Test Acc: 0.819
Validation loss decreased (-0.708316 --> -0.819433).  Saving model ...
Epoch: 4 cost time: 8.401911497116089
Epoch: 4, Steps: 7 | Train Loss: 0.712 Vali Loss: 0.684 Vali Acc: 0.847 Test Loss: 0.684 Test Acc: 0.847
Validation loss decreased (-0.819433 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 8.693744659423828
Epoch: 5, Steps: 7 | Train Loss: 0.330 Vali Loss: 0.480 Vali Acc: 0.889 Test Loss: 0.480 Test Acc: 0.889
Validation loss decreased (-0.847215 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 8.70857858657837
Epoch: 6, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 8.080344438552856
Epoch: 7, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.088960647583008
Epoch: 8, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.9552226066589355
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 8.097322702407837
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.133910417556763
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.160780429840088
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.675212383270264
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.92201042175293
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.713921308517456
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 7.68442964553833
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 7.477213382720947
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 8.287171602249146
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 8.304831743240356
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.264894247055054
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 7.661405086517334
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 7.0941972732543945
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 7.553794860839844
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.574073076248169
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.910619735717773
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 8.373883724212646
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 8.466888666152954
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 8.363502264022827
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 7.998263597488403
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 7.440072536468506
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1988844
model size : 7.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.959101676940918
Epoch: 1, Steps: 7 | Train Loss: 2.424 Vali Loss: 2.310 Vali Acc: 0.250 Test Loss: 2.310 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 4.5901405811309814
Epoch: 2, Steps: 7 | Train Loss: 2.004 Vali Loss: 1.707 Vali Acc: 0.681 Test Loss: 1.707 Test Acc: 0.681
Validation loss decreased (-0.249977 --> -0.680538).  Saving model ...
Epoch: 3 cost time: 4.763563871383667
Epoch: 3, Steps: 7 | Train Loss: 1.286 Vali Loss: 1.125 Vali Acc: 0.778 Test Loss: 1.125 Test Acc: 0.778
Validation loss decreased (-0.680538 --> -0.777767).  Saving model ...
Epoch: 4 cost time: 4.756413221359253
Epoch: 4, Steps: 7 | Train Loss: 0.663 Vali Loss: 0.730 Vali Acc: 0.833 Test Loss: 0.730 Test Acc: 0.833
Validation loss decreased (-0.777767 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 4.596875429153442
Epoch: 5, Steps: 7 | Train Loss: 0.332 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
Validation loss decreased (-0.833326 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 4.736763954162598
Epoch: 6, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.454 Vali Acc: 0.861 Test Loss: 0.454 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.642892360687256
Epoch: 7, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.569449424743652
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.290235996246338
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 4.172333240509033
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 4.165018081665039
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 3.9244754314422607
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 4.047983407974243
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 4.131212949752808
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 4.180912733078003
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 4.503848314285278
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.4888598918914795
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.514289140701294
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 4.645745277404785
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 4.269429683685303
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 4.449814796447754
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 4.057430267333984
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 3.4284801483154297
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 3.5846216678619385
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 3.7741799354553223
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.86806321144104
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.774350881576538
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.8339102268218994
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 4.301096439361572
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 4.496405601501465
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 747276
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.185507774353027
Epoch: 1, Steps: 7 | Train Loss: 2.494 Vali Loss: 2.360 Vali Acc: 0.236 Test Loss: 2.360 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 5.219688177108765
Epoch: 2, Steps: 7 | Train Loss: 2.081 Vali Loss: 1.736 Vali Acc: 0.708 Test Loss: 1.736 Test Acc: 0.708
Validation loss decreased (-0.236088 --> -0.708316).  Saving model ...
Epoch: 3 cost time: 5.094282865524292
Epoch: 3, Steps: 7 | Train Loss: 1.315 Vali Loss: 1.101 Vali Acc: 0.806 Test Loss: 1.101 Test Acc: 0.806
Validation loss decreased (-0.708316 --> -0.805545).  Saving model ...
Epoch: 4 cost time: 5.117248296737671
Epoch: 4, Steps: 7 | Train Loss: 0.720 Vali Loss: 0.691 Vali Acc: 0.847 Test Loss: 0.691 Test Acc: 0.847
Validation loss decreased (-0.805545 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 4.874139070510864
Epoch: 5, Steps: 7 | Train Loss: 0.336 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
Validation loss decreased (-0.847215 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 4.8364949226379395
Epoch: 6, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 4.698467254638672
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.571805953979492
Epoch: 8, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.493967056274414
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 5.5011773109436035
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.408041477203369
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.500751972198486
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.4599220752716064
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.106830596923828
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 5.270909786224365
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 5.250117540359497
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 5.296680212020874
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 5.344122409820557
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.419975519180298
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.498426914215088
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 5.485844135284424
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 4.917061805725098
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 4.873554468154907
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.19512939453125
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.671487331390381
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 4.604931354522705
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 4.66513466835022
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.419381856918335
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.622361660003662
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.627335548400879
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1988844
model size : 7.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.382055759429932
Epoch: 1, Steps: 7 | Train Loss: 2.423 Vali Loss: 2.310 Vali Acc: 0.250 Test Loss: 2.310 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 2.9690282344818115
Epoch: 2, Steps: 7 | Train Loss: 2.003 Vali Loss: 1.706 Vali Acc: 0.681 Test Loss: 1.706 Test Acc: 0.681
Validation loss decreased (-0.249977 --> -0.680538).  Saving model ...
Epoch: 3 cost time: 2.8086740970611572
Epoch: 3, Steps: 7 | Train Loss: 1.285 Vali Loss: 1.124 Vali Acc: 0.778 Test Loss: 1.124 Test Acc: 0.778
Validation loss decreased (-0.680538 --> -0.777767).  Saving model ...
Epoch: 4 cost time: 2.9277291297912598
Epoch: 4, Steps: 7 | Train Loss: 0.662 Vali Loss: 0.730 Vali Acc: 0.833 Test Loss: 0.730 Test Acc: 0.833
Validation loss decreased (-0.777767 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 2.7442941665649414
Epoch: 5, Steps: 7 | Train Loss: 0.333 Vali Loss: 0.539 Vali Acc: 0.889 Test Loss: 0.539 Test Acc: 0.889
Validation loss decreased (-0.833326 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 2.5431361198425293
Epoch: 6, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.454 Vali Acc: 0.861 Test Loss: 0.454 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9384560585021973
Epoch: 7, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7106354236602783
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.353 Vali Acc: 0.861 Test Loss: 0.353 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.6240522861480713
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 2.7684826850891113
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 2.7012786865234375
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 2.903480291366577
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 3.0322470664978027
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 3.09077525138855
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 3.0932199954986572
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 3.115809679031372
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0163254737854004
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.1223790645599365
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 3.0016677379608154
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 3.018817901611328
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 3.1072897911071777
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 2.8528943061828613
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 2.7125110626220703
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7842400074005127
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.802886962890625
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.8162827491760254
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.8847944736480713
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.984145164489746
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 2.9457528591156006
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.315608024597168
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 747276
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.097207069396973
Epoch: 1, Steps: 7 | Train Loss: 2.571 Vali Loss: 2.338 Vali Acc: 0.264 Test Loss: 2.338 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 7.957483291625977
Epoch: 2, Steps: 7 | Train Loss: 2.091 Vali Loss: 1.756 Vali Acc: 0.625 Test Loss: 1.756 Test Acc: 0.625
Validation loss decreased (-0.263866 --> -0.624982).  Saving model ...
Epoch: 3 cost time: 7.211634874343872
Epoch: 3, Steps: 7 | Train Loss: 1.405 Vali Loss: 1.171 Vali Acc: 0.722 Test Loss: 1.171 Test Acc: 0.722
Validation loss decreased (-0.624982 --> -0.722211).  Saving model ...
Epoch: 4 cost time: 6.912642002105713
Epoch: 4, Steps: 7 | Train Loss: 0.771 Vali Loss: 0.807 Vali Acc: 0.819 Test Loss: 0.807 Test Acc: 0.819
Validation loss decreased (-0.722211 --> -0.819436).  Saving model ...
Epoch: 5 cost time: 7.27543044090271
Epoch: 5, Steps: 7 | Train Loss: 0.385 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
Validation loss decreased (-0.819436 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 7.369822978973389
Epoch: 6, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 8.163482427597046
Epoch: 7, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 8.026972532272339
Epoch: 8, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 8.08755350112915
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.414768934249878
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 6.834863901138306
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 7.7773520946502686
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.832127332687378
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 7.885554552078247
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 8.53403902053833
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 9.073430299758911
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 8.89380669593811
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 9.092045783996582
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 8.375439167022705
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 7.760286092758179
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 7.1437647342681885
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 7.739806652069092
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 7.879715919494629
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 7.904642343521118
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 6.2738306522369385
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 7.359776735305786
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 7.859227657318115
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 8.321824073791504
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 7.363455533981323
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 6.074675798416138
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1109676
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.677623510360718
Epoch: 1, Steps: 7 | Train Loss: 2.502 Vali Loss: 2.340 Vali Acc: 0.153 Test Loss: 2.340 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 3.5213940143585205
Epoch: 2, Steps: 7 | Train Loss: 2.039 Vali Loss: 1.744 Vali Acc: 0.681 Test Loss: 1.744 Test Acc: 0.681
Validation loss decreased (-0.152754 --> -0.680538).  Saving model ...
Epoch: 3 cost time: 3.760105848312378
Epoch: 3, Steps: 7 | Train Loss: 1.334 Vali Loss: 1.141 Vali Acc: 0.861 Test Loss: 1.141 Test Acc: 0.861
Validation loss decreased (-0.680538 --> -0.861100).  Saving model ...
Epoch: 4 cost time: 3.6766204833984375
Epoch: 4, Steps: 7 | Train Loss: 0.717 Vali Loss: 0.746 Vali Acc: 0.903 Test Loss: 0.746 Test Acc: 0.903
Validation loss decreased (-0.861100 --> -0.902770).  Saving model ...
Epoch: 5 cost time: 3.8092541694641113
Epoch: 5, Steps: 7 | Train Loss: 0.359 Vali Loss: 0.490 Vali Acc: 0.917 Test Loss: 0.490 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 3.5477845668792725
Epoch: 6, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.16524338722229
Epoch: 7, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 4.132804870605469
Epoch: 8, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 4.179459810256958
Epoch: 9, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.0800065994262695
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 3.761838674545288
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 3.6494767665863037
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 3.479203224182129
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 3.5224814414978027
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 3.779137372970581
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.177995920181274
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 4.486133575439453
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 4.180122137069702
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 4.2818403244018555
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 3.896934747695923
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.765078544616699
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.7319889068603516
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.7186062335968018
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.770266056060791
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.251616954803467
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.17037034034729
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.219317674636841
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 4.130006790161133
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 3.833477020263672
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 3.6207032203674316
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 488844
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.297977924346924
Epoch: 1, Steps: 7 | Train Loss: 2.571 Vali Loss: 2.340 Vali Acc: 0.264 Test Loss: 2.340 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 5.366630554199219
Epoch: 2, Steps: 7 | Train Loss: 2.091 Vali Loss: 1.758 Vali Acc: 0.625 Test Loss: 1.758 Test Acc: 0.625
Validation loss decreased (-0.263865 --> -0.624982).  Saving model ...
Epoch: 3 cost time: 5.420179605484009
Epoch: 3, Steps: 7 | Train Loss: 1.405 Vali Loss: 1.172 Vali Acc: 0.722 Test Loss: 1.172 Test Acc: 0.722
Validation loss decreased (-0.624982 --> -0.722211).  Saving model ...
Epoch: 4 cost time: 4.793182134628296
Epoch: 4, Steps: 7 | Train Loss: 0.771 Vali Loss: 0.807 Vali Acc: 0.819 Test Loss: 0.807 Test Acc: 0.819
Validation loss decreased (-0.722211 --> -0.819436).  Saving model ...
Epoch: 5 cost time: 4.722454309463501
Epoch: 5, Steps: 7 | Train Loss: 0.385 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
Validation loss decreased (-0.819436 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 4.739212274551392
Epoch: 6, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 4.197418451309204
Epoch: 7, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 4.819596767425537
Epoch: 8, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 5.140156507492065
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.256246089935303
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 4.518363952636719
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 4.485352039337158
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.559507369995117
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 4.974568843841553
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 4.97399115562439
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 5.13879656791687
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 4.999892234802246
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 4.70895528793335
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 4.5843586921691895
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 4.489583969116211
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 4.9367852210998535
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 4.995795726776123
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 5.007132291793823
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 4.6643171310424805
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 4.923698663711548
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 4.81479811668396
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 4.988330602645874
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 5.438907146453857
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 5.428735733032227
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 5.42010760307312
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1109676
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.328831434249878
Epoch: 1, Steps: 7 | Train Loss: 2.502 Vali Loss: 2.340 Vali Acc: 0.153 Test Loss: 2.340 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 2.641446590423584
Epoch: 2, Steps: 7 | Train Loss: 2.039 Vali Loss: 1.744 Vali Acc: 0.681 Test Loss: 1.744 Test Acc: 0.681
Validation loss decreased (-0.152754 --> -0.680538).  Saving model ...
Epoch: 3 cost time: 2.8456356525421143
Epoch: 3, Steps: 7 | Train Loss: 1.334 Vali Loss: 1.141 Vali Acc: 0.861 Test Loss: 1.141 Test Acc: 0.861
Validation loss decreased (-0.680538 --> -0.861100).  Saving model ...
Epoch: 4 cost time: 2.8893845081329346
Epoch: 4, Steps: 7 | Train Loss: 0.717 Vali Loss: 0.746 Vali Acc: 0.903 Test Loss: 0.746 Test Acc: 0.903
Validation loss decreased (-0.861100 --> -0.902770).  Saving model ...
Epoch: 5 cost time: 3.011167049407959
Epoch: 5, Steps: 7 | Train Loss: 0.359 Vali Loss: 0.490 Vali Acc: 0.917 Test Loss: 0.490 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 2.932938575744629
Epoch: 6, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.983548402786255
Epoch: 7, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 2.6055822372436523
Epoch: 8, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 2.715834856033325
Epoch: 9, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7367610931396484
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 2.774444103240967
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 2.716153860092163
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 2.7093241214752197
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 3.027196168899536
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 3.049795627593994
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8397908210754395
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 2.865334987640381
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 2.9396276473999023
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 2.54252290725708
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.6116461753845215
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4849822521209717
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.580376386642456
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.579314947128296
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.837311029434204
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8715033531188965
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.822761297225952
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.909287929534912
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 2.7329673767089844
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 2.558858871459961
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 2.551997423171997
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 488844
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.066454887390137
Epoch: 1, Steps: 7 | Train Loss: 2.572 Vali Loss: 2.340 Vali Acc: 0.264 Test Loss: 2.340 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 3.537144660949707
Epoch: 2, Steps: 7 | Train Loss: 2.091 Vali Loss: 1.758 Vali Acc: 0.625 Test Loss: 1.758 Test Acc: 0.625
Validation loss decreased (-0.263865 --> -0.624982).  Saving model ...
Epoch: 3 cost time: 3.488215684890747
Epoch: 3, Steps: 7 | Train Loss: 1.406 Vali Loss: 1.171 Vali Acc: 0.722 Test Loss: 1.171 Test Acc: 0.722
Validation loss decreased (-0.624982 --> -0.722211).  Saving model ...
Epoch: 4 cost time: 3.0746755599975586
Epoch: 4, Steps: 7 | Train Loss: 0.772 Vali Loss: 0.807 Vali Acc: 0.819 Test Loss: 0.807 Test Acc: 0.819
Validation loss decreased (-0.722211 --> -0.819436).  Saving model ...
Epoch: 5 cost time: 3.0837514400482178
Epoch: 5, Steps: 7 | Train Loss: 0.386 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
Validation loss decreased (-0.819436 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 3.074047565460205
Epoch: 6, Steps: 7 | Train Loss: 0.162 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 3.3642261028289795
Epoch: 7, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 3.101902723312378
Epoch: 8, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 3.5496864318847656
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.62158465385437
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 3.680346965789795
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 3.616490364074707
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.276024341583252
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.941115617752075
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 2.24411940574646
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 2.1020667552948
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 2.812701940536499
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 3.4999303817749023
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 3.637190580368042
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 3.1697170734405518
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 3.2660388946533203
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 3.07513427734375
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 2.951171636581421
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 2.8427345752716064
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 3.181025981903076
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 3.483751058578491
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 3.6206798553466797
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 3.5761005878448486
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 3.15313458442688
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 2.879931926727295
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 1109676
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.35569429397583
Epoch: 1, Steps: 7 | Train Loss: 2.501 Vali Loss: 2.340 Vali Acc: 0.153 Test Loss: 2.340 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 1.6982741355895996
Epoch: 2, Steps: 7 | Train Loss: 2.038 Vali Loss: 1.744 Vali Acc: 0.681 Test Loss: 1.744 Test Acc: 0.681
Validation loss decreased (-0.152754 --> -0.680538).  Saving model ...
Epoch: 3 cost time: 1.6002326011657715
Epoch: 3, Steps: 7 | Train Loss: 1.334 Vali Loss: 1.141 Vali Acc: 0.861 Test Loss: 1.141 Test Acc: 0.861
Validation loss decreased (-0.680538 --> -0.861100).  Saving model ...
Epoch: 4 cost time: 1.5162770748138428
Epoch: 4, Steps: 7 | Train Loss: 0.717 Vali Loss: 0.746 Vali Acc: 0.903 Test Loss: 0.746 Test Acc: 0.903
Validation loss decreased (-0.861100 --> -0.902770).  Saving model ...
Epoch: 5 cost time: 1.544764757156372
Epoch: 5, Steps: 7 | Train Loss: 0.360 Vali Loss: 0.490 Vali Acc: 0.917 Test Loss: 0.490 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 1.423241138458252
Epoch: 6, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4934790134429932
Epoch: 7, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.4699764251708984
Epoch: 8, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 1.5975341796875
Epoch: 9, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7163283824920654
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.7777392864227295
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.7527289390563965
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.864339828491211
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.95680832862854
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.8834760189056396
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6630744934082031
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6672420501708984
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.7112674713134766
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.6858062744140625
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.690199375152588
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6292860507965088
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6180813312530518
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8581702709197998
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.744657039642334
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7745237350463867
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7936973571777344
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7591066360473633
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.7945685386657715
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.6413931846618652
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.5534348487854004
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 488844
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.468271255493164
Epoch: 1, Steps: 7 | Train Loss: 2.525 Vali Loss: 2.375 Vali Acc: 0.153 Test Loss: 2.375 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 5.213065147399902
Epoch: 2, Steps: 7 | Train Loss: 2.146 Vali Loss: 1.777 Vali Acc: 0.694 Test Loss: 1.777 Test Acc: 0.694
Validation loss decreased (-0.152754 --> -0.694427).  Saving model ...
Epoch: 3 cost time: 4.50400710105896
Epoch: 3, Steps: 7 | Train Loss: 1.446 Vali Loss: 1.183 Vali Acc: 0.861 Test Loss: 1.183 Test Acc: 0.861
Validation loss decreased (-0.694427 --> -0.861099).  Saving model ...
Epoch: 4 cost time: 4.851263523101807
Epoch: 4, Steps: 7 | Train Loss: 0.765 Vali Loss: 0.775 Vali Acc: 0.917 Test Loss: 0.775 Test Acc: 0.917
Validation loss decreased (-0.861099 --> -0.916659).  Saving model ...
Epoch: 5 cost time: 5.147657155990601
Epoch: 5, Steps: 7 | Train Loss: 0.392 Vali Loss: 0.513 Vali Acc: 0.944 Test Loss: 0.513 Test Acc: 0.944
Validation loss decreased (-0.916659 --> -0.944439).  Saving model ...
Epoch: 6 cost time: 5.648433446884155
Epoch: 6, Steps: 7 | Train Loss: 0.171 Vali Loss: 0.389 Vali Acc: 0.944 Test Loss: 0.389 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944441).  Saving model ...
Epoch: 7 cost time: 5.359306812286377
Epoch: 7, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.346 Vali Acc: 0.944 Test Loss: 0.346 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 8 cost time: 5.256021022796631
Epoch: 8, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 5.239582777023315
Epoch: 9, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 4.96561074256897
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 5.707265615463257
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 6.224553823471069
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 6.097092866897583
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 5.407939195632935
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 15 cost time: 5.1865129470825195
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.972 Test Loss: 0.190 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 16 cost time: 4.949272394180298
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.693749189376831
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.535837173461914
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.339375972747803
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.637610197067261
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.793315172195435
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.012149095535278
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.640791893005371
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.57590126991272
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.2145655155181885
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 670092
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.885444641113281
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.374 Vali Acc: 0.250 Test Loss: 2.374 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 3.07621169090271
Epoch: 2, Steps: 7 | Train Loss: 2.123 Vali Loss: 1.757 Vali Acc: 0.653 Test Loss: 1.757 Test Acc: 0.653
Validation loss decreased (-0.249976 --> -0.652760).  Saving model ...
Epoch: 3 cost time: 3.156912088394165
Epoch: 3, Steps: 7 | Train Loss: 1.371 Vali Loss: 1.173 Vali Acc: 0.806 Test Loss: 1.173 Test Acc: 0.806
Validation loss decreased (-0.652760 --> -0.805544).  Saving model ...
Epoch: 4 cost time: 3.014967441558838
Epoch: 4, Steps: 7 | Train Loss: 0.767 Vali Loss: 0.798 Vali Acc: 0.889 Test Loss: 0.798 Test Acc: 0.889
Validation loss decreased (-0.805544 --> -0.888881).  Saving model ...
Epoch: 5 cost time: 2.8085880279541016
Epoch: 5, Steps: 7 | Train Loss: 0.378 Vali Loss: 0.564 Vali Acc: 0.889 Test Loss: 0.564 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 2.6788556575775146
Epoch: 6, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.398 Vali Acc: 0.917 Test Loss: 0.398 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 2.692551374435425
Epoch: 7, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 2.1755948066711426
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8914618492126465
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.865426778793335
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 2.80912709236145
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 2.8025312423706055
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 2.4370503425598145
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.388817071914673
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 2.234729051589966
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 2.3737354278564453
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.283574104309082
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.544018268585205
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 2.2902491092681885
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 2.1115880012512207
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.7635538578033447
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 2.435102939605713
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.16239070892334
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 3.2519514560699463
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 3.428201913833618
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 3.249907970428467
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 3.3793396949768066
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 3.273855447769165
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9352293014526367
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.0123250484466553
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 359628
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.0385191440582275
Epoch: 1, Steps: 7 | Train Loss: 2.526 Vali Loss: 2.378 Vali Acc: 0.153 Test Loss: 2.378 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 4.115499973297119
Epoch: 2, Steps: 7 | Train Loss: 2.146 Vali Loss: 1.778 Vali Acc: 0.694 Test Loss: 1.778 Test Acc: 0.694
Validation loss decreased (-0.152754 --> -0.694427).  Saving model ...
Epoch: 3 cost time: 4.147830009460449
Epoch: 3, Steps: 7 | Train Loss: 1.447 Vali Loss: 1.184 Vali Acc: 0.861 Test Loss: 1.184 Test Acc: 0.861
Validation loss decreased (-0.694427 --> -0.861099).  Saving model ...
Epoch: 4 cost time: 4.168362379074097
Epoch: 4, Steps: 7 | Train Loss: 0.765 Vali Loss: 0.776 Vali Acc: 0.917 Test Loss: 0.776 Test Acc: 0.917
Validation loss decreased (-0.861099 --> -0.916659).  Saving model ...
Epoch: 5 cost time: 3.6163406372070312
Epoch: 5, Steps: 7 | Train Loss: 0.392 Vali Loss: 0.513 Vali Acc: 0.944 Test Loss: 0.513 Test Acc: 0.944
Validation loss decreased (-0.916659 --> -0.944439).  Saving model ...
Epoch: 6 cost time: 3.5617711544036865
Epoch: 6, Steps: 7 | Train Loss: 0.171 Vali Loss: 0.389 Vali Acc: 0.944 Test Loss: 0.389 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944441).  Saving model ...
Epoch: 7 cost time: 2.8336362838745117
Epoch: 7, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.346 Vali Acc: 0.944 Test Loss: 0.346 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 8 cost time: 3.362330436706543
Epoch: 8, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.322 Vali Acc: 0.944 Test Loss: 0.322 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 3.504965305328369
Epoch: 9, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 4.1605095863342285
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 3.978745222091675
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 4.08295464515686
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 4.480202913284302
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 4.251426458358765
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 15 cost time: 4.028375625610352
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.972 Test Loss: 0.190 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 16 cost time: 4.029072999954224
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.152289390563965
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.530466794967651
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.53989839553833
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.4780967235565186
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.432636737823486
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.259080648422241
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.4943575859069824
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.4549920558929443
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.7923572063446045
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 670092
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.083960294723511
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.374 Vali Acc: 0.250 Test Loss: 2.374 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 2.406632661819458
Epoch: 2, Steps: 7 | Train Loss: 2.123 Vali Loss: 1.757 Vali Acc: 0.653 Test Loss: 1.757 Test Acc: 0.653
Validation loss decreased (-0.249976 --> -0.652760).  Saving model ...
Epoch: 3 cost time: 2.4312384128570557
Epoch: 3, Steps: 7 | Train Loss: 1.371 Vali Loss: 1.173 Vali Acc: 0.819 Test Loss: 1.173 Test Acc: 0.819
Validation loss decreased (-0.652760 --> -0.819433).  Saving model ...
Epoch: 4 cost time: 2.1050467491149902
Epoch: 4, Steps: 7 | Train Loss: 0.767 Vali Loss: 0.798 Vali Acc: 0.889 Test Loss: 0.798 Test Acc: 0.889
Validation loss decreased (-0.819433 --> -0.888881).  Saving model ...
Epoch: 5 cost time: 2.134889841079712
Epoch: 5, Steps: 7 | Train Loss: 0.378 Vali Loss: 0.564 Vali Acc: 0.889 Test Loss: 0.564 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 1.8815412521362305
Epoch: 6, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.398 Vali Acc: 0.917 Test Loss: 0.398 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 2.099061965942383
Epoch: 7, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 2.0990869998931885
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1559150218963623
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.564293622970581
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 2.5461559295654297
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 2.6059751510620117
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 2.6892547607421875
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.585355520248413
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 2.5980165004730225
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 2.3488073348999023
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2976574897766113
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.345954179763794
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 2.401224374771118
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 2.2144243717193604
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 2.3185081481933594
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 2.463406562805176
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5270614624023438
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 2.593301773071289
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 2.2800467014312744
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 2.297934055328369
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 2.3281219005584717
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 2.093444347381592
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.192094087600708
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.051055431365967
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 359628
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.41178297996521
Epoch: 1, Steps: 7 | Train Loss: 2.522 Vali Loss: 2.372 Vali Acc: 0.153 Test Loss: 2.372 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 2.8091208934783936
Epoch: 2, Steps: 7 | Train Loss: 2.142 Vali Loss: 1.775 Vali Acc: 0.694 Test Loss: 1.775 Test Acc: 0.694
Validation loss decreased (-0.152754 --> -0.694427).  Saving model ...
Epoch: 3 cost time: 2.8094241619110107
Epoch: 3, Steps: 7 | Train Loss: 1.445 Vali Loss: 1.183 Vali Acc: 0.847 Test Loss: 1.183 Test Acc: 0.847
Validation loss decreased (-0.694427 --> -0.847210).  Saving model ...
Epoch: 4 cost time: 2.4997217655181885
Epoch: 4, Steps: 7 | Train Loss: 0.766 Vali Loss: 0.778 Vali Acc: 0.917 Test Loss: 0.778 Test Acc: 0.917
Validation loss decreased (-0.847210 --> -0.916659).  Saving model ...
Epoch: 5 cost time: 2.532782554626465
Epoch: 5, Steps: 7 | Train Loss: 0.394 Vali Loss: 0.515 Vali Acc: 0.944 Test Loss: 0.515 Test Acc: 0.944
Validation loss decreased (-0.916659 --> -0.944439).  Saving model ...
Epoch: 6 cost time: 2.689552068710327
Epoch: 6, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.392 Vali Acc: 0.944 Test Loss: 0.392 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944441).  Saving model ...
Epoch: 7 cost time: 2.8108015060424805
Epoch: 7, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.350 Vali Acc: 0.944 Test Loss: 0.350 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 8 cost time: 2.71403169631958
Epoch: 8, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.323 Vali Acc: 0.944 Test Loss: 0.323 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 2.8290622234344482
Epoch: 9, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.260 Vali Acc: 0.958 Test Loss: 0.260 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 2.9072704315185547
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 2.8292429447174072
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 3.0111184120178223
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 2.945488929748535
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 2.9397642612457275
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 15 cost time: 2.731513261795044
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 16 cost time: 2.7572405338287354
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7283565998077393
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.740495443344116
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6849212646484375
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.0038905143737793
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.940108060836792
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.8877131938934326
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.8890371322631836
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.9644265174865723
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.529520034790039
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 670092
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.350292921066284
Epoch: 1, Steps: 7 | Train Loss: 2.564 Vali Loss: 2.375 Vali Acc: 0.250 Test Loss: 2.375 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 1.568544626235962
Epoch: 2, Steps: 7 | Train Loss: 2.117 Vali Loss: 1.757 Vali Acc: 0.639 Test Loss: 1.757 Test Acc: 0.639
Validation loss decreased (-0.249976 --> -0.638871).  Saving model ...
Epoch: 3 cost time: 1.6523518562316895
Epoch: 3, Steps: 7 | Train Loss: 1.372 Vali Loss: 1.173 Vali Acc: 0.806 Test Loss: 1.173 Test Acc: 0.806
Validation loss decreased (-0.638871 --> -0.805544).  Saving model ...
Epoch: 4 cost time: 1.7528321743011475
Epoch: 4, Steps: 7 | Train Loss: 0.768 Vali Loss: 0.796 Vali Acc: 0.903 Test Loss: 0.796 Test Acc: 0.903
Validation loss decreased (-0.805544 --> -0.902770).  Saving model ...
Epoch: 5 cost time: 1.7334282398223877
Epoch: 5, Steps: 7 | Train Loss: 0.378 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8698527812957764
Epoch: 6, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.395 Vali Acc: 0.917 Test Loss: 0.395 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.687934398651123
Epoch: 7, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.7298884391784668
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6374077796936035
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.6044135093688965
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.5707459449768066
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.664820671081543
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.6023452281951904
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6413183212280273
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.8202104568481445
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.7779152393341064
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.756929636001587
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7949068546295166
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.756892442703247
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.8707146644592285
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.8242158889770508
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.847989559173584
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.319749355316162
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.4966435432434082
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.605126142501831
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.2242131233215332
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.4961297512054443
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 1.475761890411377
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4908370971679688
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6729459762573242
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 359628
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.199129581451416
Epoch: 1, Steps: 7 | Train Loss: 2.543 Vali Loss: 2.419 Vali Acc: 0.125 Test Loss: 2.419 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 6.646580457687378
Epoch: 2, Steps: 7 | Train Loss: 2.248 Vali Loss: 2.039 Vali Acc: 0.556 Test Loss: 2.039 Test Acc: 0.556
Validation loss decreased (-0.124976 --> -0.555535).  Saving model ...
Epoch: 3 cost time: 6.447036981582642
Epoch: 3, Steps: 7 | Train Loss: 1.799 Vali Loss: 1.629 Vali Acc: 0.750 Test Loss: 1.629 Test Acc: 0.750
Validation loss decreased (-0.555535 --> -0.749984).  Saving model ...
Epoch: 4 cost time: 7.919453382492065
Epoch: 4, Steps: 7 | Train Loss: 1.349 Vali Loss: 1.248 Vali Acc: 0.736 Test Loss: 1.248 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.982193946838379
Epoch: 5, Steps: 7 | Train Loss: 0.901 Vali Loss: 0.949 Vali Acc: 0.778 Test Loss: 0.949 Test Acc: 0.778
Validation loss decreased (-0.749984 --> -0.777768).  Saving model ...
Epoch: 6 cost time: 8.088405847549438
Epoch: 6, Steps: 7 | Train Loss: 0.605 Vali Loss: 0.754 Vali Acc: 0.806 Test Loss: 0.754 Test Acc: 0.806
Validation loss decreased (-0.777768 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 7.15688157081604
Epoch: 7, Steps: 7 | Train Loss: 0.360 Vali Loss: 0.618 Vali Acc: 0.792 Test Loss: 0.618 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.123457193374634
Epoch: 8, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
Validation loss decreased (-0.805548 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 7.215574264526367
Epoch: 9, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.555646896362305
Epoch: 10, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.479 Vali Acc: 0.806 Test Loss: 0.479 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.644591331481934
Epoch: 11, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.460 Vali Acc: 0.847 Test Loss: 0.460 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.638107538223267
Epoch: 12, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.438 Vali Acc: 0.861 Test Loss: 0.438 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 6.760026693344116
Epoch: 13, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.433 Vali Acc: 0.847 Test Loss: 0.433 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.520050048828125
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.431 Vali Acc: 0.861 Test Loss: 0.431 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 6.877409219741821
Epoch: 15, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.435 Vali Acc: 0.861 Test Loss: 0.435 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.380008220672607
Epoch: 16, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.440 Vali Acc: 0.847 Test Loss: 0.440 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.157440423965454
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.435 Vali Acc: 0.861 Test Loss: 0.435 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.454469680786133
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.426 Vali Acc: 0.861 Test Loss: 0.426 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 7.418963193893433
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.427 Vali Acc: 0.861 Test Loss: 0.427 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.294968366622925
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.428 Vali Acc: 0.847 Test Loss: 0.428 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.559020280838013
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.427 Vali Acc: 0.847 Test Loss: 0.427 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 8.256665706634521
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.430 Vali Acc: 0.861 Test Loss: 0.430 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 8.297191619873047
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.428 Vali Acc: 0.861 Test Loss: 0.428 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 8.449267625808716
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.422 Vali Acc: 0.861 Test Loss: 0.422 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 25 cost time: 7.528133392333984
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 26 cost time: 6.829051971435547
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.425 Vali Acc: 0.861 Test Loss: 0.425 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.737212181091309
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.429 Vali Acc: 0.861 Test Loss: 0.429 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 8.032124042510986
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.783203363418579
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.450207710266113
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.433 Vali Acc: 0.861 Test Loss: 0.433 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 995004
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.323529958724976
Epoch: 1, Steps: 7 | Train Loss: 2.579 Vali Loss: 2.488 Vali Acc: 0.125 Test Loss: 2.488 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 4.1700756549835205
Epoch: 2, Steps: 7 | Train Loss: 2.338 Vali Loss: 2.134 Vali Acc: 0.417 Test Loss: 2.134 Test Acc: 0.417
Validation loss decreased (-0.124975 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 4.0989062786102295
Epoch: 3, Steps: 7 | Train Loss: 1.913 Vali Loss: 1.749 Vali Acc: 0.597 Test Loss: 1.749 Test Acc: 0.597
Validation loss decreased (-0.416645 --> -0.597205).  Saving model ...
Epoch: 4 cost time: 4.19068455696106
Epoch: 4, Steps: 7 | Train Loss: 1.475 Vali Loss: 1.344 Vali Acc: 0.736 Test Loss: 1.344 Test Acc: 0.736
Validation loss decreased (-0.597205 --> -0.736098).  Saving model ...
Epoch: 5 cost time: 4.073812961578369
Epoch: 5, Steps: 7 | Train Loss: 1.008 Vali Loss: 1.029 Vali Acc: 0.833 Test Loss: 1.029 Test Acc: 0.833
Validation loss decreased (-0.736098 --> -0.833323).  Saving model ...
Epoch: 6 cost time: 3.9711830615997314
Epoch: 6, Steps: 7 | Train Loss: 0.662 Vali Loss: 0.782 Vali Acc: 0.875 Test Loss: 0.782 Test Acc: 0.875
Validation loss decreased (-0.833323 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 3.790607213973999
Epoch: 7, Steps: 7 | Train Loss: 0.420 Vali Loss: 0.617 Vali Acc: 0.889 Test Loss: 0.617 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 3.8360681533813477
Epoch: 8, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.516 Vali Acc: 0.903 Test Loss: 0.516 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 3.774376392364502
Epoch: 9, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.423 Vali Acc: 0.917 Test Loss: 0.423 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 10 cost time: 3.7161247730255127
Epoch: 10, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.390 Vali Acc: 0.917 Test Loss: 0.390 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 3.588156223297119
Epoch: 11, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 4.021587371826172
Epoch: 12, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.63431978225708
Epoch: 13, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7243077754974365
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.789797067642212
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.3960225582122803
Epoch: 16, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.400033712387085
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.412653684616089
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.1625494956970215
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.2208285331726074
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.2913599014282227
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 374028
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.415728330612183
Epoch: 1, Steps: 7 | Train Loss: 2.543 Vali Loss: 2.420 Vali Acc: 0.125 Test Loss: 2.420 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 6.063017845153809
Epoch: 2, Steps: 7 | Train Loss: 2.247 Vali Loss: 2.040 Vali Acc: 0.542 Test Loss: 2.040 Test Acc: 0.542
Validation loss decreased (-0.124976 --> -0.541646).  Saving model ...
Epoch: 3 cost time: 5.923016786575317
Epoch: 3, Steps: 7 | Train Loss: 1.800 Vali Loss: 1.629 Vali Acc: 0.750 Test Loss: 1.629 Test Acc: 0.750
Validation loss decreased (-0.541646 --> -0.749984).  Saving model ...
Epoch: 4 cost time: 6.153480291366577
Epoch: 4, Steps: 7 | Train Loss: 1.351 Vali Loss: 1.249 Vali Acc: 0.736 Test Loss: 1.249 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.665400505065918
Epoch: 5, Steps: 7 | Train Loss: 0.903 Vali Loss: 0.950 Vali Acc: 0.778 Test Loss: 0.950 Test Acc: 0.778
Validation loss decreased (-0.749984 --> -0.777768).  Saving model ...
Epoch: 6 cost time: 6.592089891433716
Epoch: 6, Steps: 7 | Train Loss: 0.607 Vali Loss: 0.756 Vali Acc: 0.806 Test Loss: 0.756 Test Acc: 0.806
Validation loss decreased (-0.777768 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 6.512077569961548
Epoch: 7, Steps: 7 | Train Loss: 0.362 Vali Loss: 0.619 Vali Acc: 0.792 Test Loss: 0.619 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.303973197937012
Epoch: 8, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
Validation loss decreased (-0.805548 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 5.842652320861816
Epoch: 9, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.490 Vali Acc: 0.861 Test Loss: 0.490 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 10 cost time: 5.014124631881714
Epoch: 10, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.469 Vali Acc: 0.819 Test Loss: 0.469 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.333254098892212
Epoch: 11, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 12 cost time: 5.849334239959717
Epoch: 12, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.430 Vali Acc: 0.889 Test Loss: 0.430 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 6.036881923675537
Epoch: 13, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.017603158950806
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.420 Vali Acc: 0.889 Test Loss: 0.420 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 5.940637588500977
Epoch: 15, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.527406215667725
Epoch: 16, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.429 Vali Acc: 0.875 Test Loss: 0.429 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.33853816986084
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.455414772033691
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 6.4735963344573975
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.59964919090271
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.577230453491211
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.285701274871826
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.420 Vali Acc: 0.889 Test Loss: 0.420 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.047095775604248
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.842346668243408
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 25 cost time: 5.984787464141846
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.90614914894104
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.117474555969238
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.404324054718018
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.045705556869507
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.422 Vali Acc: 0.889 Test Loss: 0.422 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.845768451690674
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.420 Vali Acc: 0.889 Test Loss: 0.420 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 995004
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.22852897644043
Epoch: 1, Steps: 7 | Train Loss: 2.579 Vali Loss: 2.488 Vali Acc: 0.125 Test Loss: 2.488 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 2.7949986457824707
Epoch: 2, Steps: 7 | Train Loss: 2.338 Vali Loss: 2.134 Vali Acc: 0.417 Test Loss: 2.134 Test Acc: 0.417
Validation loss decreased (-0.124975 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 2.868129253387451
Epoch: 3, Steps: 7 | Train Loss: 1.913 Vali Loss: 1.749 Vali Acc: 0.597 Test Loss: 1.749 Test Acc: 0.597
Validation loss decreased (-0.416645 --> -0.597205).  Saving model ...
Epoch: 4 cost time: 2.661647081375122
Epoch: 4, Steps: 7 | Train Loss: 1.475 Vali Loss: 1.344 Vali Acc: 0.736 Test Loss: 1.344 Test Acc: 0.736
Validation loss decreased (-0.597205 --> -0.736098).  Saving model ...
Epoch: 5 cost time: 2.4018588066101074
Epoch: 5, Steps: 7 | Train Loss: 1.008 Vali Loss: 1.029 Vali Acc: 0.833 Test Loss: 1.029 Test Acc: 0.833
Validation loss decreased (-0.736098 --> -0.833323).  Saving model ...
Epoch: 6 cost time: 2.6194851398468018
Epoch: 6, Steps: 7 | Train Loss: 0.662 Vali Loss: 0.782 Vali Acc: 0.875 Test Loss: 0.782 Test Acc: 0.875
Validation loss decreased (-0.833323 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 2.7465786933898926
Epoch: 7, Steps: 7 | Train Loss: 0.420 Vali Loss: 0.617 Vali Acc: 0.889 Test Loss: 0.617 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 3.142765998840332
Epoch: 8, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.516 Vali Acc: 0.903 Test Loss: 0.516 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 3.0932860374450684
Epoch: 9, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.423 Vali Acc: 0.917 Test Loss: 0.423 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 10 cost time: 3.0469741821289062
Epoch: 10, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.390 Vali Acc: 0.917 Test Loss: 0.390 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 2.7002370357513428
Epoch: 11, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 2.635302782058716
Epoch: 12, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6580896377563477
Epoch: 13, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.860379934310913
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.004232168197632
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.134108304977417
Epoch: 16, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.090073347091675
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9579899311065674
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5397143363952637
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5418732166290283
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.6265885829925537
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 374028
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.725097179412842
Epoch: 1, Steps: 7 | Train Loss: 2.540 Vali Loss: 2.421 Vali Acc: 0.125 Test Loss: 2.421 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 3.0417706966400146
Epoch: 2, Steps: 7 | Train Loss: 2.248 Vali Loss: 2.045 Vali Acc: 0.542 Test Loss: 2.045 Test Acc: 0.542
Validation loss decreased (-0.124976 --> -0.541646).  Saving model ...
Epoch: 3 cost time: 3.0899665355682373
Epoch: 3, Steps: 7 | Train Loss: 1.815 Vali Loss: 1.642 Vali Acc: 0.722 Test Loss: 1.642 Test Acc: 0.722
Validation loss decreased (-0.541646 --> -0.722206).  Saving model ...
Epoch: 4 cost time: 3.5149824619293213
Epoch: 4, Steps: 7 | Train Loss: 1.376 Vali Loss: 1.270 Vali Acc: 0.750 Test Loss: 1.270 Test Acc: 0.750
Validation loss decreased (-0.722206 --> -0.749987).  Saving model ...
Epoch: 5 cost time: 3.483372926712036
Epoch: 5, Steps: 7 | Train Loss: 0.939 Vali Loss: 0.974 Vali Acc: 0.778 Test Loss: 0.974 Test Acc: 0.778
Validation loss decreased (-0.749987 --> -0.777768).  Saving model ...
Epoch: 6 cost time: 3.434400796890259
Epoch: 6, Steps: 7 | Train Loss: 0.642 Vali Loss: 0.777 Vali Acc: 0.806 Test Loss: 0.777 Test Acc: 0.806
Validation loss decreased (-0.777768 --> -0.805548).  Saving model ...
Epoch: 7 cost time: 3.0854978561401367
Epoch: 7, Steps: 7 | Train Loss: 0.391 Vali Loss: 0.626 Vali Acc: 0.806 Test Loss: 0.626 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 8 cost time: 3.2009668350219727
Epoch: 8, Steps: 7 | Train Loss: 0.235 Vali Loss: 0.542 Vali Acc: 0.861 Test Loss: 0.542 Test Acc: 0.861
Validation loss decreased (-0.805549 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 3.3764004707336426
Epoch: 9, Steps: 7 | Train Loss: 0.143 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 10 cost time: 3.867400884628296
Epoch: 10, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.461 Vali Acc: 0.806 Test Loss: 0.461 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7449381351470947
Epoch: 11, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.449 Vali Acc: 0.861 Test Loss: 0.449 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 12 cost time: 3.757563591003418
Epoch: 12, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.428 Vali Acc: 0.861 Test Loss: 0.428 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 3.349140167236328
Epoch: 13, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.420 Vali Acc: 0.833 Test Loss: 0.420 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.456420421600342
Epoch: 14, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 3.3893213272094727
Epoch: 15, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.419 Vali Acc: 0.847 Test Loss: 0.419 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2868971824645996
Epoch: 16, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.425 Vali Acc: 0.847 Test Loss: 0.425 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7189910411834717
Epoch: 17, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.422 Vali Acc: 0.861 Test Loss: 0.422 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6719260215759277
Epoch: 18, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.414 Vali Acc: 0.847 Test Loss: 0.414 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.044954776763916
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.414 Vali Acc: 0.847 Test Loss: 0.414 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.9652984142303467
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.9623520374298096
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.412 Vali Acc: 0.847 Test Loss: 0.412 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.0999703407287598
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.416 Vali Acc: 0.861 Test Loss: 0.416 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.318681001663208
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.414 Vali Acc: 0.847 Test Loss: 0.414 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.337644100189209
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.411 Vali Acc: 0.847 Test Loss: 0.411 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 995004
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6128625869750977
Epoch: 1, Steps: 7 | Train Loss: 2.577 Vali Loss: 2.483 Vali Acc: 0.139 Test Loss: 2.483 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.8950493335723877
Epoch: 2, Steps: 7 | Train Loss: 2.336 Vali Loss: 2.129 Vali Acc: 0.417 Test Loss: 2.129 Test Acc: 0.417
Validation loss decreased (-0.138864 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 1.9862086772918701
Epoch: 3, Steps: 7 | Train Loss: 1.911 Vali Loss: 1.744 Vali Acc: 0.597 Test Loss: 1.744 Test Acc: 0.597
Validation loss decreased (-0.416645 --> -0.597205).  Saving model ...
Epoch: 4 cost time: 1.9282362461090088
Epoch: 4, Steps: 7 | Train Loss: 1.474 Vali Loss: 1.341 Vali Acc: 0.750 Test Loss: 1.341 Test Acc: 0.750
Validation loss decreased (-0.597205 --> -0.749987).  Saving model ...
Epoch: 5 cost time: 2.00791335105896
Epoch: 5, Steps: 7 | Train Loss: 1.007 Vali Loss: 1.029 Vali Acc: 0.833 Test Loss: 1.029 Test Acc: 0.833
Validation loss decreased (-0.749987 --> -0.833323).  Saving model ...
Epoch: 6 cost time: 1.9123384952545166
Epoch: 6, Steps: 7 | Train Loss: 0.662 Vali Loss: 0.782 Vali Acc: 0.875 Test Loss: 0.782 Test Acc: 0.875
Validation loss decreased (-0.833323 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 1.8892223834991455
Epoch: 7, Steps: 7 | Train Loss: 0.421 Vali Loss: 0.617 Vali Acc: 0.889 Test Loss: 0.617 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 1.8866255283355713
Epoch: 8, Steps: 7 | Train Loss: 0.257 Vali Loss: 0.514 Vali Acc: 0.903 Test Loss: 0.514 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 2.0386850833892822
Epoch: 9, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.420 Vali Acc: 0.917 Test Loss: 0.420 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 10 cost time: 2.1728785037994385
Epoch: 10, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.388 Vali Acc: 0.917 Test Loss: 0.388 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 2.184579610824585
Epoch: 11, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.366 Vali Acc: 0.917 Test Loss: 0.366 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 2.1827516555786133
Epoch: 12, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.162196159362793
Epoch: 13, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8214900493621826
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0410988330841064
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9062457084655762
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.9290833473205566
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8682308197021484
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0231871604919434
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1076409816741943
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0006861686706543
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7490713596343994
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7027053833007812
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.664353609085083
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.576890468597412
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.671229600906372
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 374028
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.747650861740112
Epoch: 1, Steps: 7 | Train Loss: 2.550 Vali Loss: 2.419 Vali Acc: 0.125 Test Loss: 2.419 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 3.907748222351074
Epoch: 2, Steps: 7 | Train Loss: 2.335 Vali Loss: 2.092 Vali Acc: 0.528 Test Loss: 2.092 Test Acc: 0.528
Validation loss decreased (-0.124976 --> -0.527757).  Saving model ...
Epoch: 3 cost time: 4.081877708435059
Epoch: 3, Steps: 7 | Train Loss: 1.925 Vali Loss: 1.697 Vali Acc: 0.625 Test Loss: 1.697 Test Acc: 0.625
Validation loss decreased (-0.527757 --> -0.624983).  Saving model ...
Epoch: 4 cost time: 4.4695234298706055
Epoch: 4, Steps: 7 | Train Loss: 1.437 Vali Loss: 1.323 Vali Acc: 0.792 Test Loss: 1.323 Test Acc: 0.792
Validation loss decreased (-0.624983 --> -0.791653).  Saving model ...
Epoch: 5 cost time: 4.4605371952056885
Epoch: 5, Steps: 7 | Train Loss: 1.009 Vali Loss: 1.060 Vali Acc: 0.861 Test Loss: 1.060 Test Acc: 0.861
Validation loss decreased (-0.791653 --> -0.861101).  Saving model ...
Epoch: 6 cost time: 4.371342897415161
Epoch: 6, Steps: 7 | Train Loss: 0.672 Vali Loss: 0.817 Vali Acc: 0.889 Test Loss: 0.817 Test Acc: 0.889
Validation loss decreased (-0.861101 --> -0.888881).  Saving model ...
Epoch: 7 cost time: 4.421731472015381
Epoch: 7, Steps: 7 | Train Loss: 0.425 Vali Loss: 0.658 Vali Acc: 0.903 Test Loss: 0.658 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902771).  Saving model ...
Epoch: 8 cost time: 4.311817646026611
Epoch: 8, Steps: 7 | Train Loss: 0.272 Vali Loss: 0.534 Vali Acc: 0.917 Test Loss: 0.534 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916661).  Saving model ...
Epoch: 9 cost time: 5.09618878364563
Epoch: 9, Steps: 7 | Train Loss: 0.166 Vali Loss: 0.444 Vali Acc: 0.944 Test Loss: 0.444 Test Acc: 0.944
Validation loss decreased (-0.916661 --> -0.944440).  Saving model ...
Epoch: 10 cost time: 5.051676511764526
Epoch: 10, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.410 Vali Acc: 0.917 Test Loss: 0.410 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.416311740875244
Epoch: 11, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.380 Vali Acc: 0.917 Test Loss: 0.380 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.329102039337158
Epoch: 12, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.361 Vali Acc: 0.931 Test Loss: 0.361 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.534909248352051
Epoch: 13, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.322 Vali Acc: 0.931 Test Loss: 0.322 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.30676794052124
Epoch: 14, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.937485456466675
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.4550745487213135
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.4724173545837402
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.689045667648315
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.739991188049316
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 555132
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.443981885910034
Epoch: 1, Steps: 7 | Train Loss: 2.525 Vali Loss: 2.288 Vali Acc: 0.236 Test Loss: 2.288 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 2.550774335861206
Epoch: 2, Steps: 7 | Train Loss: 2.283 Vali Loss: 1.914 Vali Acc: 0.556 Test Loss: 1.914 Test Acc: 0.556
Validation loss decreased (-0.236088 --> -0.555536).  Saving model ...
Epoch: 3 cost time: 2.4605798721313477
Epoch: 3, Steps: 7 | Train Loss: 1.757 Vali Loss: 1.512 Vali Acc: 0.778 Test Loss: 1.512 Test Acc: 0.778
Validation loss decreased (-0.555536 --> -0.777763).  Saving model ...
Epoch: 4 cost time: 2.170278787612915
Epoch: 4, Steps: 7 | Train Loss: 1.289 Vali Loss: 1.136 Vali Acc: 0.833 Test Loss: 1.136 Test Acc: 0.833
Validation loss decreased (-0.777763 --> -0.833322).  Saving model ...
Epoch: 5 cost time: 2.3002352714538574
Epoch: 5, Steps: 7 | Train Loss: 0.878 Vali Loss: 0.856 Vali Acc: 0.889 Test Loss: 0.856 Test Acc: 0.889
Validation loss decreased (-0.833322 --> -0.888880).  Saving model ...
Epoch: 6 cost time: 2.464815855026245
Epoch: 6, Steps: 7 | Train Loss: 0.559 Vali Loss: 0.649 Vali Acc: 0.875 Test Loss: 0.649 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3295059204101562
Epoch: 7, Steps: 7 | Train Loss: 0.359 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3705201148986816
Epoch: 8, Steps: 7 | Train Loss: 0.235 Vali Loss: 0.448 Vali Acc: 0.861 Test Loss: 0.448 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7174861431121826
Epoch: 9, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7083773612976074
Epoch: 10, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
Validation loss decreased (-0.888880 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 2.729419231414795
Epoch: 11, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 2.42181134223938
Epoch: 12, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.339648723602295
Epoch: 13, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2286245822906494
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3781192302703857
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2324726581573486
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.7278926372528076
Epoch: 17, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.726205348968506
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.7080743312835693
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.302520513534546
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.321620464324951
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 244620
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.087390661239624
Epoch: 1, Steps: 7 | Train Loss: 2.550 Vali Loss: 2.422 Vali Acc: 0.111 Test Loss: 2.422 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 3.4107930660247803
Epoch: 2, Steps: 7 | Train Loss: 2.335 Vali Loss: 2.093 Vali Acc: 0.528 Test Loss: 2.093 Test Acc: 0.528
Validation loss decreased (-0.111087 --> -0.527757).  Saving model ...
Epoch: 3 cost time: 3.687549352645874
Epoch: 3, Steps: 7 | Train Loss: 1.926 Vali Loss: 1.697 Vali Acc: 0.625 Test Loss: 1.697 Test Acc: 0.625
Validation loss decreased (-0.527757 --> -0.624983).  Saving model ...
Epoch: 4 cost time: 3.6424508094787598
Epoch: 4, Steps: 7 | Train Loss: 1.440 Vali Loss: 1.322 Vali Acc: 0.792 Test Loss: 1.322 Test Acc: 0.792
Validation loss decreased (-0.624983 --> -0.791653).  Saving model ...
Epoch: 5 cost time: 3.9641001224517822
Epoch: 5, Steps: 7 | Train Loss: 1.013 Vali Loss: 1.059 Vali Acc: 0.875 Test Loss: 1.059 Test Acc: 0.875
Validation loss decreased (-0.791653 --> -0.874989).  Saving model ...
Epoch: 6 cost time: 4.003033876419067
Epoch: 6, Steps: 7 | Train Loss: 0.676 Vali Loss: 0.816 Vali Acc: 0.903 Test Loss: 0.816 Test Acc: 0.903
Validation loss decreased (-0.874989 --> -0.902770).  Saving model ...
Epoch: 7 cost time: 3.9830892086029053
Epoch: 7, Steps: 7 | Train Loss: 0.427 Vali Loss: 0.656 Vali Acc: 0.903 Test Loss: 0.656 Test Acc: 0.903
Validation loss decreased (-0.902770 --> -0.902771).  Saving model ...
Epoch: 8 cost time: 3.865959882736206
Epoch: 8, Steps: 7 | Train Loss: 0.275 Vali Loss: 0.531 Vali Acc: 0.917 Test Loss: 0.531 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916661).  Saving model ...
Epoch: 9 cost time: 4.0218915939331055
Epoch: 9, Steps: 7 | Train Loss: 0.166 Vali Loss: 0.440 Vali Acc: 0.944 Test Loss: 0.440 Test Acc: 0.944
Validation loss decreased (-0.916661 --> -0.944440).  Saving model ...
Epoch: 10 cost time: 3.7161917686462402
Epoch: 10, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.404 Vali Acc: 0.917 Test Loss: 0.404 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9388041496276855
Epoch: 11, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.378 Vali Acc: 0.917 Test Loss: 0.378 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.300550222396851
Epoch: 12, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.358 Vali Acc: 0.931 Test Loss: 0.358 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.331841230392456
Epoch: 13, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8726329803466797
Epoch: 14, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.777517318725586
Epoch: 15, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.800581693649292
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.919158935546875
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.287856817245483
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.80908465385437
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 555132
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.874777317047119
Epoch: 1, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.287 Vali Acc: 0.236 Test Loss: 2.287 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 2.1213200092315674
Epoch: 2, Steps: 7 | Train Loss: 2.282 Vali Loss: 1.912 Vali Acc: 0.542 Test Loss: 1.912 Test Acc: 0.542
Validation loss decreased (-0.236088 --> -0.541648).  Saving model ...
Epoch: 3 cost time: 2.0098373889923096
Epoch: 3, Steps: 7 | Train Loss: 1.756 Vali Loss: 1.511 Vali Acc: 0.778 Test Loss: 1.511 Test Acc: 0.778
Validation loss decreased (-0.541648 --> -0.777763).  Saving model ...
Epoch: 4 cost time: 1.9757940769195557
Epoch: 4, Steps: 7 | Train Loss: 1.288 Vali Loss: 1.134 Vali Acc: 0.833 Test Loss: 1.134 Test Acc: 0.833
Validation loss decreased (-0.777763 --> -0.833322).  Saving model ...
Epoch: 5 cost time: 1.9779291152954102
Epoch: 5, Steps: 7 | Train Loss: 0.876 Vali Loss: 0.854 Vali Acc: 0.889 Test Loss: 0.854 Test Acc: 0.889
Validation loss decreased (-0.833322 --> -0.888880).  Saving model ...
Epoch: 6 cost time: 1.85225248336792
Epoch: 6, Steps: 7 | Train Loss: 0.556 Vali Loss: 0.648 Vali Acc: 0.875 Test Loss: 0.648 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9448611736297607
Epoch: 7, Steps: 7 | Train Loss: 0.358 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0042824745178223
Epoch: 8, Steps: 7 | Train Loss: 0.233 Vali Loss: 0.448 Vali Acc: 0.861 Test Loss: 0.448 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.177881956100464
Epoch: 9, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.144801139831543
Epoch: 10, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 1.9184958934783936
Epoch: 11, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 2.1048145294189453
Epoch: 12, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0709285736083984
Epoch: 13, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.255326271057129
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.137139081954956
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3561956882476807
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3770673274993896
Epoch: 17, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3743271827697754
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0997531414031982
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6321613788604736
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.690108060836792
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 244620
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.794898509979248
Epoch: 1, Steps: 7 | Train Loss: 2.551 Vali Loss: 2.421 Vali Acc: 0.111 Test Loss: 2.421 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 2.8738300800323486
Epoch: 2, Steps: 7 | Train Loss: 2.339 Vali Loss: 2.100 Vali Acc: 0.514 Test Loss: 2.100 Test Acc: 0.514
Validation loss decreased (-0.111087 --> -0.513868).  Saving model ...
Epoch: 3 cost time: 2.6063246726989746
Epoch: 3, Steps: 7 | Train Loss: 1.934 Vali Loss: 1.712 Vali Acc: 0.611 Test Loss: 1.712 Test Acc: 0.611
Validation loss decreased (-0.513868 --> -0.611094).  Saving model ...
Epoch: 4 cost time: 2.525127649307251
Epoch: 4, Steps: 7 | Train Loss: 1.456 Vali Loss: 1.343 Vali Acc: 0.792 Test Loss: 1.343 Test Acc: 0.792
Validation loss decreased (-0.611094 --> -0.791653).  Saving model ...
Epoch: 5 cost time: 2.89726185798645
Epoch: 5, Steps: 7 | Train Loss: 1.032 Vali Loss: 1.083 Vali Acc: 0.861 Test Loss: 1.083 Test Acc: 0.861
Validation loss decreased (-0.791653 --> -0.861100).  Saving model ...
Epoch: 6 cost time: 2.8475704193115234
Epoch: 6, Steps: 7 | Train Loss: 0.696 Vali Loss: 0.840 Vali Acc: 0.889 Test Loss: 0.840 Test Acc: 0.889
Validation loss decreased (-0.861100 --> -0.888880).  Saving model ...
Epoch: 7 cost time: 3.0670559406280518
Epoch: 7, Steps: 7 | Train Loss: 0.446 Vali Loss: 0.682 Vali Acc: 0.903 Test Loss: 0.682 Test Acc: 0.903
Validation loss decreased (-0.888880 --> -0.902771).  Saving model ...
Epoch: 8 cost time: 3.00842547416687
Epoch: 8, Steps: 7 | Train Loss: 0.287 Vali Loss: 0.554 Vali Acc: 0.917 Test Loss: 0.554 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916661).  Saving model ...
Epoch: 9 cost time: 3.127861499786377
Epoch: 9, Steps: 7 | Train Loss: 0.175 Vali Loss: 0.464 Vali Acc: 0.931 Test Loss: 0.464 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930551).  Saving model ...
Epoch: 10 cost time: 2.8301970958709717
Epoch: 10, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.735401153564453
Epoch: 11, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.398 Vali Acc: 0.903 Test Loss: 0.398 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7501220703125
Epoch: 12, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.374 Vali Acc: 0.917 Test Loss: 0.374 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.586224317550659
Epoch: 13, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 2.6818559169769287
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.314 Vali Acc: 0.931 Test Loss: 0.314 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 15 cost time: 2.95212721824646
Epoch: 15, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 16 cost time: 3.033646821975708
Epoch: 16, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.303 Vali Acc: 0.931 Test Loss: 0.303 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 2.923426389694214
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 3.1297757625579834
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 2.7746474742889404
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.835707426071167
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.501319646835327
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 2.4423608779907227
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 2.8257622718811035
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 2.755509853363037
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 2.8282575607299805
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 2.8858683109283447
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.776895761489868
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.688690185546875
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 2.505202054977417
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 2.6718106269836426
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 555132
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3180344104766846
Epoch: 1, Steps: 7 | Train Loss: 2.525 Vali Loss: 2.289 Vali Acc: 0.236 Test Loss: 2.289 Test Acc: 0.236
Validation loss decreased (inf --> -0.236088).  Saving model ...
Epoch: 2 cost time: 1.3596503734588623
Epoch: 2, Steps: 7 | Train Loss: 2.284 Vali Loss: 1.916 Vali Acc: 0.528 Test Loss: 1.916 Test Acc: 0.528
Validation loss decreased (-0.236088 --> -0.527759).  Saving model ...
Epoch: 3 cost time: 1.4319372177124023
Epoch: 3, Steps: 7 | Train Loss: 1.761 Vali Loss: 1.516 Vali Acc: 0.778 Test Loss: 1.516 Test Acc: 0.778
Validation loss decreased (-0.527759 --> -0.777763).  Saving model ...
Epoch: 4 cost time: 1.5210387706756592
Epoch: 4, Steps: 7 | Train Loss: 1.299 Vali Loss: 1.140 Vali Acc: 0.833 Test Loss: 1.140 Test Acc: 0.833
Validation loss decreased (-0.777763 --> -0.833322).  Saving model ...
Epoch: 5 cost time: 1.4035327434539795
Epoch: 5, Steps: 7 | Train Loss: 0.885 Vali Loss: 0.862 Vali Acc: 0.889 Test Loss: 0.862 Test Acc: 0.889
Validation loss decreased (-0.833322 --> -0.888880).  Saving model ...
Epoch: 6 cost time: 1.3562695980072021
Epoch: 6, Steps: 7 | Train Loss: 0.567 Vali Loss: 0.655 Vali Acc: 0.889 Test Loss: 0.655 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888882).  Saving model ...
Epoch: 7 cost time: 1.6652131080627441
Epoch: 7, Steps: 7 | Train Loss: 0.365 Vali Loss: 0.530 Vali Acc: 0.889 Test Loss: 0.530 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 1.657440423965454
Epoch: 8, Steps: 7 | Train Loss: 0.241 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 1.7027313709259033
Epoch: 9, Steps: 7 | Train Loss: 0.143 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 1.7107985019683838
Epoch: 10, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 1.4729406833648682
Epoch: 11, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.5874619483947754
Epoch: 12, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.57358980178833
Epoch: 13, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4619996547698975
Epoch: 14, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.568300724029541
Epoch: 15, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6213178634643555
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.455587387084961
Epoch: 17, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8315942287445068
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.866750717163086
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7289786338806152
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7635290622711182
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 244620
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.00641942024231
Epoch: 1, Steps: 7 | Train Loss: 2.447 Vali Loss: 2.369 Vali Acc: 0.181 Test Loss: 2.369 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 4.378177642822266
Epoch: 2, Steps: 7 | Train Loss: 2.212 Vali Loss: 2.055 Vali Acc: 0.569 Test Loss: 2.055 Test Acc: 0.569
Validation loss decreased (-0.180532 --> -0.569424).  Saving model ...
Epoch: 3 cost time: 3.672135829925537
Epoch: 3, Steps: 7 | Train Loss: 1.854 Vali Loss: 1.691 Vali Acc: 0.681 Test Loss: 1.691 Test Acc: 0.681
Validation loss decreased (-0.569424 --> -0.680539).  Saving model ...
Epoch: 4 cost time: 3.6376078128814697
Epoch: 4, Steps: 7 | Train Loss: 1.410 Vali Loss: 1.358 Vali Acc: 0.764 Test Loss: 1.358 Test Acc: 0.764
Validation loss decreased (-0.680539 --> -0.763875).  Saving model ...
Epoch: 5 cost time: 3.5913100242614746
Epoch: 5, Steps: 7 | Train Loss: 1.019 Vali Loss: 1.073 Vali Acc: 0.861 Test Loss: 1.073 Test Acc: 0.861
Validation loss decreased (-0.763875 --> -0.861100).  Saving model ...
Epoch: 6 cost time: 4.189142465591431
Epoch: 6, Steps: 7 | Train Loss: 0.694 Vali Loss: 0.845 Vali Acc: 0.847 Test Loss: 0.845 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7482125759124756
Epoch: 7, Steps: 7 | Train Loss: 0.471 Vali Loss: 0.684 Vali Acc: 0.861 Test Loss: 0.684 Test Acc: 0.861
Validation loss decreased (-0.861100 --> -0.861104).  Saving model ...
Epoch: 8 cost time: 3.46919584274292
Epoch: 8, Steps: 7 | Train Loss: 0.286 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 3.3730156421661377
Epoch: 9, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 10 cost time: 3.932554006576538
Epoch: 10, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 3.893998861312866
Epoch: 11, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 3.377716064453125
Epoch: 12, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 13 cost time: 3.6582703590393066
Epoch: 13, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 14 cost time: 3.927031993865967
Epoch: 14, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.381 Vali Acc: 0.875 Test Loss: 0.381 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 3.9283251762390137
Epoch: 15, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.667271852493286
Epoch: 16, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 3.446786642074585
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.364 Vali Acc: 0.861 Test Loss: 0.364 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0406506061553955
Epoch: 18, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.353 Vali Acc: 0.861 Test Loss: 0.353 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.294083595275879
Epoch: 19, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 20 cost time: 4.320837497711182
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.944058656692505
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.349 Vali Acc: 0.861 Test Loss: 0.349 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.98144793510437
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.351 Vali Acc: 0.861 Test Loss: 0.351 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.269574403762817
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.352 Vali Acc: 0.861 Test Loss: 0.352 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.301037788391113
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.354 Vali Acc: 0.861 Test Loss: 0.354 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.850919008255005
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.355 Vali Acc: 0.861 Test Loss: 0.355 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.7937960624694824
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.7319066524505615
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.358 Vali Acc: 0.861 Test Loss: 0.358 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.4129109382629395
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.357 Vali Acc: 0.861 Test Loss: 0.357 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.402790307998657
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.357 Vali Acc: 0.861 Test Loss: 0.357 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 335196
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.0270094871521
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.455 Vali Acc: 0.153 Test Loss: 2.455 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 1.8880009651184082
Epoch: 2, Steps: 7 | Train Loss: 2.301 Vali Loss: 2.135 Vali Acc: 0.319 Test Loss: 2.135 Test Acc: 0.319
Validation loss decreased (-0.152753 --> -0.319423).  Saving model ...
Epoch: 3 cost time: 1.9309768676757812
Epoch: 3, Steps: 7 | Train Loss: 1.954 Vali Loss: 1.751 Vali Acc: 0.736 Test Loss: 1.751 Test Acc: 0.736
Validation loss decreased (-0.319423 --> -0.736094).  Saving model ...
Epoch: 4 cost time: 2.0157322883605957
Epoch: 4, Steps: 7 | Train Loss: 1.494 Vali Loss: 1.393 Vali Acc: 0.792 Test Loss: 1.393 Test Acc: 0.792
Validation loss decreased (-0.736094 --> -0.791653).  Saving model ...
Epoch: 5 cost time: 1.8437743186950684
Epoch: 5, Steps: 7 | Train Loss: 1.124 Vali Loss: 1.092 Vali Acc: 0.833 Test Loss: 1.092 Test Acc: 0.833
Validation loss decreased (-0.791653 --> -0.833322).  Saving model ...
Epoch: 6 cost time: 1.8703088760375977
Epoch: 6, Steps: 7 | Train Loss: 0.778 Vali Loss: 0.854 Vali Acc: 0.875 Test Loss: 0.854 Test Acc: 0.875
Validation loss decreased (-0.833322 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 2.1345932483673096
Epoch: 7, Steps: 7 | Train Loss: 0.504 Vali Loss: 0.673 Vali Acc: 0.889 Test Loss: 0.673 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888882).  Saving model ...
Epoch: 8 cost time: 2.113267660140991
Epoch: 8, Steps: 7 | Train Loss: 0.348 Vali Loss: 0.532 Vali Acc: 0.889 Test Loss: 0.532 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 1.9031023979187012
Epoch: 9, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 1.9993762969970703
Epoch: 10, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.420 Vali Acc: 0.917 Test Loss: 0.420 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916662).  Saving model ...
Epoch: 11 cost time: 1.957824468612671
Epoch: 11, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.375 Vali Acc: 0.917 Test Loss: 0.375 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 2.0589613914489746
Epoch: 12, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.13413667678833
Epoch: 13, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 2.26521897315979
Epoch: 14, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.306 Vali Acc: 0.944 Test Loss: 0.306 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 2.1000537872314453
Epoch: 15, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 1.9680190086364746
Epoch: 16, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.9466679096221924
Epoch: 17, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.9164268970489502
Epoch: 18, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 2.1483724117279053
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 2.191664934158325
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.7644460201263428
Epoch: 21, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 2.1110174655914307
Epoch: 22, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 2.1209449768066406
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.9988086223602295
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 2.133979082107544
Epoch: 25, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 2.231903314590454
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 2.3676061630249023
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 2.0718631744384766
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 2.0219650268554688
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 2.0196664333343506
Epoch: 30, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 179916
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.717848300933838
Epoch: 1, Steps: 7 | Train Loss: 2.450 Vali Loss: 2.367 Vali Acc: 0.181 Test Loss: 2.367 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 2.912942409515381
Epoch: 2, Steps: 7 | Train Loss: 2.213 Vali Loss: 2.053 Vali Acc: 0.569 Test Loss: 2.053 Test Acc: 0.569
Validation loss decreased (-0.180532 --> -0.569424).  Saving model ...
Epoch: 3 cost time: 2.8838717937469482
Epoch: 3, Steps: 7 | Train Loss: 1.854 Vali Loss: 1.689 Vali Acc: 0.681 Test Loss: 1.689 Test Acc: 0.681
Validation loss decreased (-0.569424 --> -0.680539).  Saving model ...
Epoch: 4 cost time: 3.1319260597229004
Epoch: 4, Steps: 7 | Train Loss: 1.412 Vali Loss: 1.357 Vali Acc: 0.764 Test Loss: 1.357 Test Acc: 0.764
Validation loss decreased (-0.680539 --> -0.763875).  Saving model ...
Epoch: 5 cost time: 3.3126158714294434
Epoch: 5, Steps: 7 | Train Loss: 1.018 Vali Loss: 1.073 Vali Acc: 0.861 Test Loss: 1.073 Test Acc: 0.861
Validation loss decreased (-0.763875 --> -0.861100).  Saving model ...
Epoch: 6 cost time: 2.8757894039154053
Epoch: 6, Steps: 7 | Train Loss: 0.699 Vali Loss: 0.849 Vali Acc: 0.847 Test Loss: 0.849 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7974507808685303
Epoch: 7, Steps: 7 | Train Loss: 0.475 Vali Loss: 0.690 Vali Acc: 0.861 Test Loss: 0.690 Test Acc: 0.861
Validation loss decreased (-0.861100 --> -0.861104).  Saving model ...
Epoch: 8 cost time: 2.5322329998016357
Epoch: 8, Steps: 7 | Train Loss: 0.291 Vali Loss: 0.599 Vali Acc: 0.875 Test Loss: 0.599 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 2.5753681659698486
Epoch: 9, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.507 Vali Acc: 0.875 Test Loss: 0.507 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 10 cost time: 3.067814826965332
Epoch: 10, Steps: 7 | Train Loss: 0.096 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 11 cost time: 2.9306068420410156
Epoch: 11, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 2.6352689266204834
Epoch: 12, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 13 cost time: 2.6603899002075195
Epoch: 13, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 14 cost time: 2.737635850906372
Epoch: 14, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 2.978822946548462
Epoch: 15, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 3.067277431488037
Epoch: 16, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 2.7196455001831055
Epoch: 17, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.387 Vali Acc: 0.847 Test Loss: 0.387 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5846807956695557
Epoch: 18, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.377 Vali Acc: 0.847 Test Loss: 0.377 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7467546463012695
Epoch: 19, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 3.1914477348327637
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 21 cost time: 3.213881254196167
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 2.7497599124908447
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.777371883392334
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.128345012664795
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.368 Vali Acc: 0.861 Test Loss: 0.368 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.352722644805908
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.369 Vali Acc: 0.861 Test Loss: 0.369 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.380155086517334
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.1892917156219482
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.9118473529815674
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.939978837966919
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.068619728088379
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 335196
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4093008041381836
Epoch: 1, Steps: 7 | Train Loss: 2.569 Vali Loss: 2.455 Vali Acc: 0.153 Test Loss: 2.455 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 1.7317523956298828
Epoch: 2, Steps: 7 | Train Loss: 2.301 Vali Loss: 2.134 Vali Acc: 0.319 Test Loss: 2.134 Test Acc: 0.319
Validation loss decreased (-0.152753 --> -0.319423).  Saving model ...
Epoch: 3 cost time: 1.6807358264923096
Epoch: 3, Steps: 7 | Train Loss: 1.954 Vali Loss: 1.751 Vali Acc: 0.736 Test Loss: 1.751 Test Acc: 0.736
Validation loss decreased (-0.319423 --> -0.736094).  Saving model ...
Epoch: 4 cost time: 1.8644180297851562
Epoch: 4, Steps: 7 | Train Loss: 1.494 Vali Loss: 1.392 Vali Acc: 0.792 Test Loss: 1.392 Test Acc: 0.792
Validation loss decreased (-0.736094 --> -0.791653).  Saving model ...
Epoch: 5 cost time: 2.0338597297668457
Epoch: 5, Steps: 7 | Train Loss: 1.125 Vali Loss: 1.092 Vali Acc: 0.833 Test Loss: 1.092 Test Acc: 0.833
Validation loss decreased (-0.791653 --> -0.833322).  Saving model ...
Epoch: 6 cost time: 1.813601016998291
Epoch: 6, Steps: 7 | Train Loss: 0.779 Vali Loss: 0.854 Vali Acc: 0.875 Test Loss: 0.854 Test Acc: 0.875
Validation loss decreased (-0.833322 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 1.7732808589935303
Epoch: 7, Steps: 7 | Train Loss: 0.504 Vali Loss: 0.672 Vali Acc: 0.889 Test Loss: 0.672 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888882).  Saving model ...
Epoch: 8 cost time: 1.8355693817138672
Epoch: 8, Steps: 7 | Train Loss: 0.348 Vali Loss: 0.531 Vali Acc: 0.889 Test Loss: 0.531 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 1.8295891284942627
Epoch: 9, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 1.7708957195281982
Epoch: 10, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.420 Vali Acc: 0.917 Test Loss: 0.420 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916662).  Saving model ...
Epoch: 11 cost time: 2.0260226726531982
Epoch: 11, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.374 Vali Acc: 0.917 Test Loss: 0.374 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.849242925643921
Epoch: 12, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7274556159973145
Epoch: 13, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 1.6039338111877441
Epoch: 14, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.306 Vali Acc: 0.944 Test Loss: 0.306 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 1.5912635326385498
Epoch: 15, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 1.6309232711791992
Epoch: 16, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.6412873268127441
Epoch: 17, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.768190622329712
Epoch: 18, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.7763395309448242
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.6195447444915771
Epoch: 20, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.774677038192749
Epoch: 21, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.5936291217803955
Epoch: 22, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.7396492958068848
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.7177116870880127
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.6400833129882812
Epoch: 25, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.5530548095703125
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.586622953414917
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 1.5201873779296875
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.5901901721954346
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 2.0954835414886475
Epoch: 30, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 179916
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.938368320465088
Epoch: 1, Steps: 7 | Train Loss: 2.453 Vali Loss: 2.367 Vali Acc: 0.167 Test Loss: 2.367 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 2.5478885173797607
Epoch: 2, Steps: 7 | Train Loss: 2.214 Vali Loss: 2.056 Vali Acc: 0.569 Test Loss: 2.056 Test Acc: 0.569
Validation loss decreased (-0.166643 --> -0.569424).  Saving model ...
Epoch: 3 cost time: 2.2550816535949707
Epoch: 3, Steps: 7 | Train Loss: 1.857 Vali Loss: 1.697 Vali Acc: 0.667 Test Loss: 1.697 Test Acc: 0.667
Validation loss decreased (-0.569424 --> -0.666650).  Saving model ...
Epoch: 4 cost time: 2.170440912246704
Epoch: 4, Steps: 7 | Train Loss: 1.424 Vali Loss: 1.368 Vali Acc: 0.764 Test Loss: 1.368 Test Acc: 0.764
Validation loss decreased (-0.666650 --> -0.763875).  Saving model ...
Epoch: 5 cost time: 2.3111772537231445
Epoch: 5, Steps: 7 | Train Loss: 1.030 Vali Loss: 1.086 Vali Acc: 0.861 Test Loss: 1.086 Test Acc: 0.861
Validation loss decreased (-0.763875 --> -0.861100).  Saving model ...
Epoch: 6 cost time: 2.2718608379364014
Epoch: 6, Steps: 7 | Train Loss: 0.708 Vali Loss: 0.864 Vali Acc: 0.847 Test Loss: 0.864 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.126556873321533
Epoch: 7, Steps: 7 | Train Loss: 0.487 Vali Loss: 0.710 Vali Acc: 0.861 Test Loss: 0.710 Test Acc: 0.861
Validation loss decreased (-0.861100 --> -0.861104).  Saving model ...
Epoch: 8 cost time: 2.1840882301330566
Epoch: 8, Steps: 7 | Train Loss: 0.301 Vali Loss: 0.623 Vali Acc: 0.875 Test Loss: 0.623 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 2.262850761413574
Epoch: 9, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 2.1086604595184326
Epoch: 10, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.471 Vali Acc: 0.889 Test Loss: 0.471 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 11 cost time: 2.489776372909546
Epoch: 11, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 2.5030388832092285
Epoch: 12, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.426 Vali Acc: 0.889 Test Loss: 0.426 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 2.383288621902466
Epoch: 13, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 2.4908742904663086
Epoch: 14, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 2.318533420562744
Epoch: 15, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.393 Vali Acc: 0.889 Test Loss: 0.393 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 2.33213210105896
Epoch: 16, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 2.2261133193969727
Epoch: 17, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.381 Vali Acc: 0.889 Test Loss: 0.381 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 2.205044746398926
Epoch: 18, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 2.260658025741577
Epoch: 19, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 2.21508526802063
Epoch: 20, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 21 cost time: 2.2498490810394287
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 22 cost time: 2.2050271034240723
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.013566017150879
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.006298065185547
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2189440727233887
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.2563228607177734
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.2859208583831787
Epoch: 27, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.290541887283325
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 29 cost time: 2.2382402420043945
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 30 cost time: 2.2151713371276855
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 335196
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3300933837890625
Epoch: 1, Steps: 7 | Train Loss: 2.566 Vali Loss: 2.453 Vali Acc: 0.153 Test Loss: 2.453 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 1.2487943172454834
Epoch: 2, Steps: 7 | Train Loss: 2.299 Vali Loss: 2.137 Vali Acc: 0.319 Test Loss: 2.137 Test Acc: 0.319
Validation loss decreased (-0.152753 --> -0.319423).  Saving model ...
Epoch: 3 cost time: 1.3551716804504395
Epoch: 3, Steps: 7 | Train Loss: 1.959 Vali Loss: 1.758 Vali Acc: 0.736 Test Loss: 1.758 Test Acc: 0.736
Validation loss decreased (-0.319423 --> -0.736094).  Saving model ...
Epoch: 4 cost time: 1.3100709915161133
Epoch: 4, Steps: 7 | Train Loss: 1.505 Vali Loss: 1.399 Vali Acc: 0.792 Test Loss: 1.399 Test Acc: 0.792
Validation loss decreased (-0.736094 --> -0.791653).  Saving model ...
Epoch: 5 cost time: 1.365903377532959
Epoch: 5, Steps: 7 | Train Loss: 1.136 Vali Loss: 1.099 Vali Acc: 0.833 Test Loss: 1.099 Test Acc: 0.833
Validation loss decreased (-0.791653 --> -0.833322).  Saving model ...
Epoch: 6 cost time: 1.345674753189087
Epoch: 6, Steps: 7 | Train Loss: 0.790 Vali Loss: 0.860 Vali Acc: 0.875 Test Loss: 0.860 Test Acc: 0.875
Validation loss decreased (-0.833322 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 1.43998384475708
Epoch: 7, Steps: 7 | Train Loss: 0.514 Vali Loss: 0.679 Vali Acc: 0.889 Test Loss: 0.679 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888882).  Saving model ...
Epoch: 8 cost time: 1.4003105163574219
Epoch: 8, Steps: 7 | Train Loss: 0.358 Vali Loss: 0.538 Vali Acc: 0.889 Test Loss: 0.538 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 1.3602924346923828
Epoch: 9, Steps: 7 | Train Loss: 0.213 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 1.3709402084350586
Epoch: 10, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.423 Vali Acc: 0.917 Test Loss: 0.423 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916662).  Saving model ...
Epoch: 11 cost time: 1.3898558616638184
Epoch: 11, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.375 Vali Acc: 0.917 Test Loss: 0.375 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.2415218353271484
Epoch: 12, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 1.38230562210083
Epoch: 13, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 1.371950626373291
Epoch: 14, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 1.4365196228027344
Epoch: 15, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 1.528125286102295
Epoch: 16, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.4614756107330322
Epoch: 17, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.4849097728729248
Epoch: 18, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.5007421970367432
Epoch: 19, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.4762036800384521
Epoch: 20, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.4200592041015625
Epoch: 21, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.4040131568908691
Epoch: 22, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.4909515380859375
Epoch: 23, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5896656513214111
Epoch: 24, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.6133718490600586
Epoch: 25, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.408431053161621
Epoch: 26, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.4832518100738525
Epoch: 27, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4770309925079346
Epoch: 28, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.601243019104004
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.517685890197754
Epoch: 30, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 179916
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 58.300753355026245
Epoch: 1, Steps: 7 | Train Loss: 2.434 Vali Loss: 1.498 Vali Acc: 0.764 Test Loss: 1.498 Test Acc: 0.764
Validation loss decreased (inf --> -0.763874).  Saving model ...
Epoch: 2 cost time: 51.28286862373352
Epoch: 2, Steps: 7 | Train Loss: 0.622 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
Validation loss decreased (-0.763874 --> -0.833329).  Saving model ...
Epoch: 3 cost time: 58.89397692680359
Epoch: 3, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.833329 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 54.55935788154602
Epoch: 4, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 52.23159408569336
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 54.9123854637146
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.931 Test Loss: 0.336 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 53.60176730155945
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.917 Test Loss: 0.385 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 48.57230019569397
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.903 Test Loss: 0.430 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 52.00964093208313
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.903 Test Loss: 0.455 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 55.79133129119873
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.903 Test Loss: 0.467 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 50.03355121612549
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.903 Test Loss: 0.469 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 51.55989408493042
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.903 Test Loss: 0.468 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 54.82794117927551
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.903 Test Loss: 0.463 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 39332876
model size : 152.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 20.431507349014282
Epoch: 1, Steps: 7 | Train Loss: 2.256 Vali Loss: 1.451 Vali Acc: 0.708 Test Loss: 1.451 Test Acc: 0.708
Validation loss decreased (inf --> -0.708319).  Saving model ...
Epoch: 2 cost time: 17.24908423423767
Epoch: 2, Steps: 7 | Train Loss: 0.611 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
Validation loss decreased (-0.708319 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 19.256860733032227
Epoch: 3, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 18.782161474227905
Epoch: 4, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.460 Vali Acc: 0.903 Test Loss: 0.460 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902773).  Saving model ...
Epoch: 5 cost time: 20.573434829711914
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.434 Vali Acc: 0.903 Test Loss: 0.434 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 6 cost time: 18.485434770584106
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.903 Test Loss: 0.545 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.424285173416138
Epoch: 7, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.479 Vali Acc: 0.889 Test Loss: 0.479 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.756172895431519
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 16.75126028060913
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.419 Vali Acc: 0.903 Test Loss: 0.419 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 17.187580347061157
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.875 Test Loss: 0.556 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.674343824386597
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.434 Vali Acc: 0.903 Test Loss: 0.434 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 18.858996391296387
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.903 Test Loss: 0.408 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 18.407386541366577
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.875 Test Loss: 0.489 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 17.50561285018921
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 19.63137149810791
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.889 Test Loss: 0.528 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 16.337374687194824
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.903 Test Loss: 0.483 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 17.47689437866211
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.903 Test Loss: 0.460 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 17.621723651885986
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.454 Vali Acc: 0.903 Test Loss: 0.454 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 15.57935118675232
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.903 Test Loss: 0.452 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 18.746438026428223
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.903 Test Loss: 0.451 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 17.59686589241028
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.903 Test Loss: 0.451 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 17.629748344421387
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.889 Test Loss: 0.450 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 12854796
model size : 51.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 37.20440363883972
Epoch: 1, Steps: 7 | Train Loss: 2.434 Vali Loss: 1.498 Vali Acc: 0.764 Test Loss: 1.498 Test Acc: 0.764
Validation loss decreased (inf --> -0.763874).  Saving model ...
Epoch: 2 cost time: 36.93903613090515
Epoch: 2, Steps: 7 | Train Loss: 0.622 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
Validation loss decreased (-0.763874 --> -0.833329).  Saving model ...
Epoch: 3 cost time: 38.43853831291199
Epoch: 3, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.833329 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 37.38958191871643
Epoch: 4, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 34.68364143371582
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 36.4910523891449
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.931 Test Loss: 0.336 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 34.911197900772095
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.917 Test Loss: 0.385 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 33.795897245407104
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.903 Test Loss: 0.430 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 32.56795382499695
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.903 Test Loss: 0.455 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 33.65424847602844
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.903 Test Loss: 0.467 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 35.06792664527893
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.903 Test Loss: 0.469 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 29.666534662246704
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.903 Test Loss: 0.468 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 34.299455404281616
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.903 Test Loss: 0.463 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 39332876
model size : 152.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 13.114857196807861
Epoch: 1, Steps: 7 | Train Loss: 2.256 Vali Loss: 1.451 Vali Acc: 0.708 Test Loss: 1.451 Test Acc: 0.708
Validation loss decreased (inf --> -0.708319).  Saving model ...
Epoch: 2 cost time: 13.7033109664917
Epoch: 2, Steps: 7 | Train Loss: 0.611 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
Validation loss decreased (-0.708319 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 13.118198871612549
Epoch: 3, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 14.280232906341553
Epoch: 4, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.460 Vali Acc: 0.903 Test Loss: 0.460 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902773).  Saving model ...
Epoch: 5 cost time: 11.269136667251587
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.434 Vali Acc: 0.903 Test Loss: 0.434 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 6 cost time: 12.610687971115112
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.903 Test Loss: 0.545 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.342385292053223
Epoch: 7, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.479 Vali Acc: 0.889 Test Loss: 0.479 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.757303237915039
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.903709888458252
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.418 Vali Acc: 0.903 Test Loss: 0.418 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 12.721754312515259
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.590843439102173
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.434 Vali Acc: 0.903 Test Loss: 0.434 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.509864330291748
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.903 Test Loss: 0.408 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 12.538930416107178
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.875 Test Loss: 0.489 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.686371326446533
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.067004442214966
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.889 Test Loss: 0.528 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.490567445755005
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.889 Test Loss: 0.480 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.291441440582275
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.903 Test Loss: 0.457 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.803315877914429
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.903 Test Loss: 0.451 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 14.248493909835815
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.903 Test Loss: 0.449 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 13.164499521255493
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.903 Test Loss: 0.448 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 14.86992359161377
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.903 Test Loss: 0.447 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.786732912063599
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.889 Test Loss: 0.447 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 12854796
model size : 51.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 21.675832986831665
Epoch: 1, Steps: 7 | Train Loss: 2.434 Vali Loss: 1.498 Vali Acc: 0.764 Test Loss: 1.498 Test Acc: 0.764
Validation loss decreased (inf --> -0.763874).  Saving model ...
Epoch: 2 cost time: 23.294326305389404
Epoch: 2, Steps: 7 | Train Loss: 0.622 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
Validation loss decreased (-0.763874 --> -0.833329).  Saving model ...
Epoch: 3 cost time: 19.994569778442383
Epoch: 3, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.833329 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 18.075510501861572
Epoch: 4, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.767476797103882
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.722753524780273
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.931 Test Loss: 0.336 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 18.98213481903076
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.917 Test Loss: 0.385 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 21.900259971618652
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.903 Test Loss: 0.430 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.79714584350586
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.903 Test Loss: 0.455 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 21.341922760009766
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.903 Test Loss: 0.467 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 21.442479610443115
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.903 Test Loss: 0.469 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 19.042009830474854
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.903 Test Loss: 0.468 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 21.594739198684692
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.903 Test Loss: 0.463 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 39332876
model size : 152.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.344718217849731
Epoch: 1, Steps: 7 | Train Loss: 2.256 Vali Loss: 1.451 Vali Acc: 0.708 Test Loss: 1.451 Test Acc: 0.708
Validation loss decreased (inf --> -0.708319).  Saving model ...
Epoch: 2 cost time: 7.7518486976623535
Epoch: 2, Steps: 7 | Train Loss: 0.611 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
Validation loss decreased (-0.708319 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 8.41814661026001
Epoch: 3, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 7.676717519760132
Epoch: 4, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.460 Vali Acc: 0.903 Test Loss: 0.460 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902773).  Saving model ...
Epoch: 5 cost time: 8.083036661148071
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.434 Vali Acc: 0.903 Test Loss: 0.434 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 6 cost time: 8.827562093734741
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.903 Test Loss: 0.545 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.250381469726562
Epoch: 7, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.479 Vali Acc: 0.889 Test Loss: 0.479 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.315498352050781
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.349592208862305
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.418 Vali Acc: 0.903 Test Loss: 0.418 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 8.460508823394775
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.659181118011475
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.434 Vali Acc: 0.903 Test Loss: 0.434 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.431200265884399
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.903 Test Loss: 0.408 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 7.945819854736328
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.875 Test Loss: 0.489 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.319677114486694
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.423174142837524
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.889 Test Loss: 0.528 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.885172605514526
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.889 Test Loss: 0.480 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.761074542999268
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.903 Test Loss: 0.457 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.631663799285889
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.903 Test Loss: 0.451 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.521741151809692
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.903 Test Loss: 0.448 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.518868923187256
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.903 Test Loss: 0.448 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.425010681152344
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.903 Test Loss: 0.447 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.541642665863037
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.889 Test Loss: 0.447 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 12854796
model size : 51.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 24.81157922744751
Epoch: 1, Steps: 7 | Train Loss: 2.318 Vali Loss: 1.450 Vali Acc: 0.667 Test Loss: 1.450 Test Acc: 0.667
Validation loss decreased (inf --> -0.666652).  Saving model ...
Epoch: 2 cost time: 20.864506244659424
Epoch: 2, Steps: 7 | Train Loss: 0.596 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.666652 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 20.855432271957397
Epoch: 3, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 19.673253059387207
Epoch: 4, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.51416563987732
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.917 Test Loss: 0.457 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 25.475125074386597
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.889 Test Loss: 0.544 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.075944662094116
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.889 Test Loss: 0.579 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.583085298538208
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.875 Test Loss: 0.632 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 26.085623502731323
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.889 Test Loss: 0.652 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 23.092104196548462
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.903 Test Loss: 0.556 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 21.996960639953613
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.917 Test Loss: 0.500 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 25.011554479599
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.917 Test Loss: 0.489 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 25.021597146987915
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.917 Test Loss: 0.480 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 21.95693325996399
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.917 Test Loss: 0.472 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 21.982755184173584
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.917 Test Loss: 0.464 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 20588044
model size : 81.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.906439781188965
Epoch: 1, Steps: 7 | Train Loss: 2.412 Vali Loss: 1.554 Vali Acc: 0.611 Test Loss: 1.554 Test Acc: 0.611
Validation loss decreased (inf --> -0.611096).  Saving model ...
Epoch: 2 cost time: 9.560037612915039
Epoch: 2, Steps: 7 | Train Loss: 0.733 Vali Loss: 0.421 Vali Acc: 0.819 Test Loss: 0.421 Test Acc: 0.819
Validation loss decreased (-0.611096 --> -0.819440).  Saving model ...
Epoch: 3 cost time: 8.686767101287842
Epoch: 3, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.409 Vali Acc: 0.833 Test Loss: 0.409 Test Acc: 0.833
Validation loss decreased (-0.819440 --> -0.833329).  Saving model ...
Epoch: 4 cost time: 8.216155767440796
Epoch: 4, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
Validation loss decreased (-0.833329 --> -0.874997).  Saving model ...
Epoch: 5 cost time: 9.325313091278076
Epoch: 5, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.370622634887695
Epoch: 6, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.414 Vali Acc: 0.861 Test Loss: 0.414 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.690778970718384
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.847 Test Loss: 0.754 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.70266318321228
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.140376567840576
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.903 Test Loss: 0.484 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902773).  Saving model ...
Epoch: 10 cost time: 9.525380373001099
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.903 Test Loss: 0.484 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.836107015609741
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.903 Test Loss: 0.486 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.001536130905151
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.903 Test Loss: 0.485 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.501059293746948
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.903 Test Loss: 0.480 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 9.363557815551758
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.903 Test Loss: 0.473 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 15 cost time: 9.585421800613403
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.903 Test Loss: 0.467 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 16 cost time: 10.57416844367981
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.917 Test Loss: 0.461 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 17 cost time: 9.466655015945435
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.917 Test Loss: 0.455 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 18 cost time: 10.55046010017395
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.917 Test Loss: 0.450 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 19 cost time: 8.288166522979736
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.931 Test Loss: 0.446 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 20 cost time: 9.474645614624023
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.931 Test Loss: 0.441 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 21 cost time: 8.641180992126465
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.931 Test Loss: 0.437 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 22 cost time: 9.201077461242676
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.931 Test Loss: 0.433 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 23 cost time: 10.018813848495483
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.931 Test Loss: 0.429 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 24 cost time: 9.901140451431274
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.931 Test Loss: 0.425 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 25 cost time: 10.178497552871704
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.931 Test Loss: 0.422 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 26 cost time: 9.676025152206421
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.931 Test Loss: 0.419 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 27 cost time: 9.595556259155273
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.931 Test Loss: 0.417 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 28 cost time: 8.589731931686401
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.931 Test Loss: 0.413 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 29 cost time: 9.690361022949219
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.931 Test Loss: 0.411 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 30 cost time: 8.674453496932983
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.931 Test Loss: 0.408 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 7348748
model size : 30.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 21.733078479766846
Epoch: 1, Steps: 7 | Train Loss: 2.318 Vali Loss: 1.449 Vali Acc: 0.667 Test Loss: 1.449 Test Acc: 0.667
Validation loss decreased (inf --> -0.666652).  Saving model ...
Epoch: 2 cost time: 16.44494318962097
Epoch: 2, Steps: 7 | Train Loss: 0.596 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.666652 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 16.359164714813232
Epoch: 3, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 18.79192304611206
Epoch: 4, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.178536891937256
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.917 Test Loss: 0.457 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 19.053576946258545
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.889 Test Loss: 0.544 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.32658362388611
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.889 Test Loss: 0.579 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 17.440293788909912
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.875 Test Loss: 0.632 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 17.920975923538208
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.889 Test Loss: 0.652 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 18.11115336418152
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.903 Test Loss: 0.556 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 16.4414005279541
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.917 Test Loss: 0.500 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 16.876817226409912
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.917 Test Loss: 0.489 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 18.65019702911377
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.917 Test Loss: 0.480 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 18.755921363830566
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.917 Test Loss: 0.472 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 16.478991508483887
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.917 Test Loss: 0.464 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 20588044
model size : 81.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.88405179977417
Epoch: 1, Steps: 7 | Train Loss: 2.412 Vali Loss: 1.554 Vali Acc: 0.611 Test Loss: 1.554 Test Acc: 0.611
Validation loss decreased (inf --> -0.611096).  Saving model ...
Epoch: 2 cost time: 7.302129745483398
Epoch: 2, Steps: 7 | Train Loss: 0.733 Vali Loss: 0.421 Vali Acc: 0.819 Test Loss: 0.421 Test Acc: 0.819
Validation loss decreased (-0.611096 --> -0.819440).  Saving model ...
Epoch: 3 cost time: 7.255401849746704
Epoch: 3, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.409 Vali Acc: 0.833 Test Loss: 0.409 Test Acc: 0.833
Validation loss decreased (-0.819440 --> -0.833329).  Saving model ...
Epoch: 4 cost time: 7.032292604446411
Epoch: 4, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
Validation loss decreased (-0.833329 --> -0.874997).  Saving model ...
Epoch: 5 cost time: 6.5206005573272705
Epoch: 5, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.045316457748413
Epoch: 6, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.414 Vali Acc: 0.861 Test Loss: 0.414 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.555541515350342
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.847 Test Loss: 0.754 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.403151988983154
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.922163486480713
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.903 Test Loss: 0.484 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902773).  Saving model ...
Epoch: 10 cost time: 7.250253915786743
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.903 Test Loss: 0.484 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.524846076965332
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.903 Test Loss: 0.486 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.329265594482422
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.903 Test Loss: 0.485 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.178778886795044
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.903 Test Loss: 0.480 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 7.000855445861816
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.903 Test Loss: 0.473 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 15 cost time: 6.382437467575073
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.903 Test Loss: 0.467 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 16 cost time: 6.3965349197387695
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.917 Test Loss: 0.461 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 17 cost time: 6.664430856704712
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.917 Test Loss: 0.455 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 18 cost time: 6.483635425567627
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.917 Test Loss: 0.450 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 19 cost time: 7.710258960723877
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.931 Test Loss: 0.446 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 20 cost time: 7.198229074478149
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.931 Test Loss: 0.441 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 21 cost time: 7.42704701423645
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.931 Test Loss: 0.437 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 22 cost time: 7.219215393066406
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.931 Test Loss: 0.433 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 23 cost time: 6.675980806350708
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.931 Test Loss: 0.429 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 24 cost time: 6.351088047027588
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.931 Test Loss: 0.425 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 25 cost time: 6.534575700759888
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.931 Test Loss: 0.422 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 26 cost time: 6.2147133350372314
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.931 Test Loss: 0.419 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 27 cost time: 6.485227584838867
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.931 Test Loss: 0.417 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 28 cost time: 6.64646577835083
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.931 Test Loss: 0.413 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 29 cost time: 6.787555456161499
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.931 Test Loss: 0.411 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 30 cost time: 4.739370346069336
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.931 Test Loss: 0.408 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 7348748
model size : 30.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 10.257456541061401
Epoch: 1, Steps: 7 | Train Loss: 2.318 Vali Loss: 1.449 Vali Acc: 0.667 Test Loss: 1.449 Test Acc: 0.667
Validation loss decreased (inf --> -0.666652).  Saving model ...
Epoch: 2 cost time: 11.675131797790527
Epoch: 2, Steps: 7 | Train Loss: 0.596 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.666652 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 12.018221139907837
Epoch: 3, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 11.704941987991333
Epoch: 4, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.200982093811035
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.917 Test Loss: 0.457 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 12.113913536071777
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.889 Test Loss: 0.544 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.973040103912354
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.889 Test Loss: 0.579 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.64285683631897
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.875 Test Loss: 0.632 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.980522155761719
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.889 Test Loss: 0.652 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.358633995056152
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.903 Test Loss: 0.556 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.962073802947998
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.917 Test Loss: 0.500 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.434242010116577
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.917 Test Loss: 0.489 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.577070951461792
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.917 Test Loss: 0.480 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 13.162627458572388
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.917 Test Loss: 0.472 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.125128984451294
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.917 Test Loss: 0.464 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 20588044
model size : 81.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.386892557144165
Epoch: 1, Steps: 7 | Train Loss: 2.412 Vali Loss: 1.554 Vali Acc: 0.611 Test Loss: 1.554 Test Acc: 0.611
Validation loss decreased (inf --> -0.611096).  Saving model ...
Epoch: 2 cost time: 5.209205389022827
Epoch: 2, Steps: 7 | Train Loss: 0.733 Vali Loss: 0.421 Vali Acc: 0.819 Test Loss: 0.421 Test Acc: 0.819
Validation loss decreased (-0.611096 --> -0.819440).  Saving model ...
Epoch: 3 cost time: 5.599913835525513
Epoch: 3, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.409 Vali Acc: 0.833 Test Loss: 0.409 Test Acc: 0.833
Validation loss decreased (-0.819440 --> -0.833329).  Saving model ...
Epoch: 4 cost time: 5.628723382949829
Epoch: 4, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
Validation loss decreased (-0.833329 --> -0.874997).  Saving model ...
Epoch: 5 cost time: 5.187735557556152
Epoch: 5, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.142036437988281
Epoch: 6, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.414 Vali Acc: 0.861 Test Loss: 0.414 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.597723007202148
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.847 Test Loss: 0.754 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.545474052429199
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.0602171421051025
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.903 Test Loss: 0.484 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902773).  Saving model ...
Epoch: 10 cost time: 5.06722354888916
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.903 Test Loss: 0.484 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.131957530975342
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.903 Test Loss: 0.486 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.102229595184326
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.903 Test Loss: 0.485 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.120406627655029
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.903 Test Loss: 0.480 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 5.135611534118652
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.903 Test Loss: 0.473 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 15 cost time: 5.150245666503906
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.903 Test Loss: 0.467 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 16 cost time: 5.191482305526733
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.917 Test Loss: 0.461 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 17 cost time: 5.148879051208496
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.917 Test Loss: 0.455 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 18 cost time: 5.1079628467559814
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.917 Test Loss: 0.450 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 19 cost time: 5.004971265792847
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.931 Test Loss: 0.446 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 20 cost time: 5.209885835647583
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.931 Test Loss: 0.441 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 21 cost time: 4.607513427734375
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.931 Test Loss: 0.437 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 22 cost time: 5.019007205963135
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.931 Test Loss: 0.433 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 23 cost time: 5.113938808441162
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.931 Test Loss: 0.429 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 24 cost time: 5.486400365829468
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.931 Test Loss: 0.425 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 25 cost time: 5.755082845687866
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.931 Test Loss: 0.422 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 26 cost time: 5.330836057662964
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.931 Test Loss: 0.419 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 27 cost time: 5.150615692138672
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.931 Test Loss: 0.417 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 28 cost time: 4.590764284133911
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.931 Test Loss: 0.413 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 29 cost time: 4.609470844268799
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.931 Test Loss: 0.411 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 30 cost time: 4.592292070388794
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.931 Test Loss: 0.408 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 7348748
model size : 30.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 34.7302930355072
Epoch: 1, Steps: 7 | Train Loss: 2.510 Vali Loss: 1.958 Vali Acc: 0.625 Test Loss: 1.958 Test Acc: 0.625
Validation loss decreased (inf --> -0.624980).  Saving model ...
Epoch: 2 cost time: 28.23825430870056
Epoch: 2, Steps: 7 | Train Loss: 1.221 Vali Loss: 0.645 Vali Acc: 0.875 Test Loss: 0.645 Test Acc: 0.875
Validation loss decreased (-0.624980 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 29.51049041748047
Epoch: 3, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.306 Vali Acc: 0.944 Test Loss: 0.306 Test Acc: 0.944
Validation loss decreased (-0.874994 --> -0.944441).  Saving model ...
Epoch: 4 cost time: 30.06371521949768
Epoch: 4, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.873607635498047
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 29.39911150932312
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 31.605132818222046
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 27.137285947799683
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 32.885089635849
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 26.14919686317444
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 30.941960334777832
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 28.89536190032959
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 28.932631015777588
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 30.965087413787842
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 28.941109657287598
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 28.91873073577881
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 30.217997550964355
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 27.754706144332886
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 29.564141511917114
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 30.770711660385132
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 26.9257230758667
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 32.738155364990234
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 26.55081558227539
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 31.224199771881104
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 28.754558563232422
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 28.980523586273193
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 29.75786256790161
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 30.623444318771362
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 27.065844297409058
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 32.2987060546875
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 19667980
model size : 76.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 14.41059923171997
Epoch: 1, Steps: 7 | Train Loss: 2.530 Vali Loss: 1.925 Vali Acc: 0.639 Test Loss: 1.925 Test Acc: 0.639
Validation loss decreased (inf --> -0.638870).  Saving model ...
Epoch: 2 cost time: 11.958616971969604
Epoch: 2, Steps: 7 | Train Loss: 1.187 Vali Loss: 0.620 Vali Acc: 0.847 Test Loss: 0.620 Test Acc: 0.847
Validation loss decreased (-0.638870 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 9.79857349395752
Epoch: 3, Steps: 7 | Train Loss: 0.185 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874997).  Saving model ...
Epoch: 4 cost time: 9.8894944190979
Epoch: 4, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 10.881983041763306
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.481212139129639
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 10.592289686203003
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 8.692045211791992
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 9.70951223373413
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 11.18326735496521
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 10.141906261444092
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 10.66664743423462
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 8.886851072311401
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 10.333802223205566
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 11.243486642837524
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 9.484696626663208
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 10.644770860671997
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 8.939634084701538
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 11.29025650024414
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 11.046976804733276
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 9.001829147338867
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 10.514149188995361
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 8.774451732635498
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 10.160551309585571
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 8.180319786071777
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 11.860592603683472
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 13.674977779388428
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 11.972121715545654
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 13.221596240997314
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 12.981192350387573
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 6428428
model size : 25.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 29.773624420166016
Epoch: 1, Steps: 7 | Train Loss: 2.510 Vali Loss: 1.955 Vali Acc: 0.639 Test Loss: 1.955 Test Acc: 0.639
Validation loss decreased (inf --> -0.638869).  Saving model ...
Epoch: 2 cost time: 27.882784605026245
Epoch: 2, Steps: 7 | Train Loss: 1.221 Vali Loss: 0.645 Vali Acc: 0.875 Test Loss: 0.645 Test Acc: 0.875
Validation loss decreased (-0.638869 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 24.163065433502197
Epoch: 3, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.306 Vali Acc: 0.944 Test Loss: 0.306 Test Acc: 0.944
Validation loss decreased (-0.874994 --> -0.944441).  Saving model ...
Epoch: 4 cost time: 22.814465761184692
Epoch: 4, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.658772706985474
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 27.805758237838745
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 26.522392511367798
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 24.76214051246643
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 26.06019687652588
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 28.07210350036621
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 25.898526906967163
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 23.698257207870483
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 23.31694269180298
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 25.770629405975342
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 28.252387523651123
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 27.453547954559326
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 25.81024146080017
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 25.846140146255493
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 21.52572774887085
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 25.466120719909668
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 27.515615701675415
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 24.05726146697998
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 27.936933279037476
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 27.800903797149658
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 25.945637464523315
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 29.824066400527954
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 26.354501008987427
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 25.545817613601685
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 27.076228380203247
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 23.944689750671387
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 19667980
model size : 76.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 12.150312185287476
Epoch: 1, Steps: 7 | Train Loss: 2.530 Vali Loss: 1.922 Vali Acc: 0.653 Test Loss: 1.922 Test Acc: 0.653
Validation loss decreased (inf --> -0.652759).  Saving model ...
Epoch: 2 cost time: 10.136706829071045
Epoch: 2, Steps: 7 | Train Loss: 1.187 Vali Loss: 0.619 Vali Acc: 0.847 Test Loss: 0.619 Test Acc: 0.847
Validation loss decreased (-0.652759 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 11.341014623641968
Epoch: 3, Steps: 7 | Train Loss: 0.185 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874997).  Saving model ...
Epoch: 4 cost time: 11.153862714767456
Epoch: 4, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 10.066136121749878
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.089435338973999
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 11.456161975860596
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 11.304025888442993
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 10.194181442260742
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 10.323409080505371
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 11.074615240097046
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 10.387476682662964
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 9.50649642944336
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 9.836210489273071
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 10.652215480804443
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 10.0403311252594
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 9.485383987426758
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 9.678652286529541
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 10.480111360549927
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 10.662315607070923
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 9.981330156326294
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 10.678234338760376
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 11.310963153839111
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 10.403413534164429
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 10.02247142791748
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 10.921236038208008
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 11.378530740737915
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 10.673163652420044
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 10.220158338546753
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 11.098722219467163
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 6428428
model size : 25.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 15.796741485595703
Epoch: 1, Steps: 7 | Train Loss: 2.510 Vali Loss: 1.955 Vali Acc: 0.639 Test Loss: 1.955 Test Acc: 0.639
Validation loss decreased (inf --> -0.638869).  Saving model ...
Epoch: 2 cost time: 14.591959238052368
Epoch: 2, Steps: 7 | Train Loss: 1.221 Vali Loss: 0.645 Vali Acc: 0.875 Test Loss: 0.645 Test Acc: 0.875
Validation loss decreased (-0.638869 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 15.736721277236938
Epoch: 3, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.306 Vali Acc: 0.944 Test Loss: 0.306 Test Acc: 0.944
Validation loss decreased (-0.874994 --> -0.944441).  Saving model ...
Epoch: 4 cost time: 13.997042417526245
Epoch: 4, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.710345029830933
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.62991452217102
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 14.903246641159058
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.52779483795166
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.8686203956604
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.989512205123901
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 16.678994178771973
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 14.796812534332275
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 16.318786144256592
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 16.4119656085968
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 15.236905097961426
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 15.67724895477295
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 14.012248039245605
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 14.056377172470093
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 15.71617579460144
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 13.682311534881592
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 14.08850622177124
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 14.204570293426514
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 14.366465330123901
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 15.91125226020813
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 13.915034055709839
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 15.666996717453003
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 14.153499126434326
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 15.680557250976562
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 14.271853685379028
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 14.044413089752197
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 19667980
model size : 76.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.454422473907471
Epoch: 1, Steps: 7 | Train Loss: 2.531 Vali Loss: 1.922 Vali Acc: 0.653 Test Loss: 1.922 Test Acc: 0.653
Validation loss decreased (inf --> -0.652759).  Saving model ...
Epoch: 2 cost time: 5.613965272903442
Epoch: 2, Steps: 7 | Train Loss: 1.188 Vali Loss: 0.619 Vali Acc: 0.847 Test Loss: 0.619 Test Acc: 0.847
Validation loss decreased (-0.652759 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 5.734160661697388
Epoch: 3, Steps: 7 | Train Loss: 0.185 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874997).  Saving model ...
Epoch: 4 cost time: 6.291046142578125
Epoch: 4, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 5.753993034362793
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.442523241043091
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 5.660454988479614
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 6.221815824508667
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 5.945930004119873
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 5.9139299392700195
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 6.157795667648315
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 6.57811164855957
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 5.955589532852173
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 5.94381308555603
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 6.254461765289307
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 6.631797552108765
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 5.883012533187866
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 5.957576274871826
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 6.327714204788208
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 6.812548637390137
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 5.981481313705444
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 5.793989658355713
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 6.640756130218506
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 6.7309653759002686
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 6.0132176876068115
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 6.071657419204712
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 6.147660732269287
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 6.391958713531494
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 5.670390605926514
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.579230308532715
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 6428428
model size : 25.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 18.2182879447937
Epoch: 1, Steps: 7 | Train Loss: 2.390 Vali Loss: 1.883 Vali Acc: 0.681 Test Loss: 1.883 Test Acc: 0.681
Validation loss decreased (inf --> -0.680537).  Saving model ...
Epoch: 2 cost time: 18.190856456756592
Epoch: 2, Steps: 7 | Train Loss: 1.167 Vali Loss: 0.665 Vali Acc: 0.875 Test Loss: 0.665 Test Acc: 0.875
Validation loss decreased (-0.680537 --> -0.874993).  Saving model ...
Epoch: 3 cost time: 18.19338822364807
Epoch: 3, Steps: 7 | Train Loss: 0.270 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.874993 --> -0.944442).  Saving model ...
Epoch: 4 cost time: 17.336634397506714
Epoch: 4, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.583276510238647
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 18.61620044708252
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.35577082633972
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 19.186810970306396
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 18.507469415664673
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 17.899811029434204
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 15.132726192474365
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 12 cost time: 17.998512744903564
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 17.167070388793945
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 14 cost time: 16.692479372024536
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.513952493667603
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 16.830729961395264
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 18.504390001296997
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 19.009127378463745
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 17.33056139945984
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 18.795597791671753
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 18.222239017486572
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 17.795134782791138
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 18.858444929122925
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 10294796
model size : 40.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.058536291122437
Epoch: 1, Steps: 7 | Train Loss: 2.423 Vali Loss: 1.907 Vali Acc: 0.569 Test Loss: 1.907 Test Acc: 0.569
Validation loss decreased (inf --> -0.569425).  Saving model ...
Epoch: 2 cost time: 6.8358612060546875
Epoch: 2, Steps: 7 | Train Loss: 1.230 Vali Loss: 0.656 Vali Acc: 0.875 Test Loss: 0.656 Test Acc: 0.875
Validation loss decreased (-0.569425 --> -0.874993).  Saving model ...
Epoch: 3 cost time: 6.576138973236084
Epoch: 3, Steps: 7 | Train Loss: 0.217 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.874993 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 7.562316417694092
Epoch: 4, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.771281480789185
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.702179908752441
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 7.517039060592651
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 6.931504487991333
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.703561067581177
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.682549476623535
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 7.8925416469573975
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 7.208985090255737
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 7.152148485183716
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 7.842187881469727
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 7.141423940658569
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 7.25687050819397
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 7.82051682472229
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 7.8363120555877686
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 7.039881944656372
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 7.060347080230713
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 7.859179258346558
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 7.095694065093994
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 7.1235668659210205
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 7.94686222076416
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 7.055667877197266
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 6.68107533454895
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 6.722566366195679
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 5.952568769454956
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 6.13563346862793
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 7.06011176109314
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3674892
model size : 15.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 14.856384754180908
Epoch: 1, Steps: 7 | Train Loss: 2.390 Vali Loss: 1.883 Vali Acc: 0.681 Test Loss: 1.883 Test Acc: 0.681
Validation loss decreased (inf --> -0.680537).  Saving model ...
Epoch: 2 cost time: 13.56661581993103
Epoch: 2, Steps: 7 | Train Loss: 1.167 Vali Loss: 0.665 Vali Acc: 0.875 Test Loss: 0.665 Test Acc: 0.875
Validation loss decreased (-0.680537 --> -0.874993).  Saving model ...
Epoch: 3 cost time: 13.263317823410034
Epoch: 3, Steps: 7 | Train Loss: 0.270 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.874993 --> -0.944442).  Saving model ...
Epoch: 4 cost time: 14.062360525131226
Epoch: 4, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.773461818695068
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.987513065338135
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 14.322931289672852
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.302736520767212
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 13.372955560684204
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 14.556349277496338
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 12.709219694137573
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 12 cost time: 12.488248348236084
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 13.579979181289673
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 14 cost time: 12.265459537506104
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.766624927520752
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 13.17672610282898
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 12.419822454452515
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.48388934135437
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 13.93786883354187
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 13.172932624816895
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 14.606496095657349
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 13.135898113250732
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 13.631669759750366
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 10294796
model size : 40.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 7.116117238998413
Epoch: 1, Steps: 7 | Train Loss: 2.423 Vali Loss: 1.907 Vali Acc: 0.569 Test Loss: 1.907 Test Acc: 0.569
Validation loss decreased (inf --> -0.569425).  Saving model ...
Epoch: 2 cost time: 5.5514607429504395
Epoch: 2, Steps: 7 | Train Loss: 1.230 Vali Loss: 0.656 Vali Acc: 0.875 Test Loss: 0.656 Test Acc: 0.875
Validation loss decreased (-0.569425 --> -0.874993).  Saving model ...
Epoch: 3 cost time: 5.980286598205566
Epoch: 3, Steps: 7 | Train Loss: 0.217 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.874993 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 5.495662689208984
Epoch: 4, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.108391046524048
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.758126258850098
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 5.297927618026733
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 5.2445478439331055
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.868281364440918
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.518630266189575
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 4.708277940750122
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 5.1873390674591064
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 5.821116209030151
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 5.199187755584717
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 5.210588216781616
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 5.912402153015137
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 5.171912908554077
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 5.126745939254761
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 6.077138423919678
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 6.020625829696655
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 5.647849082946777
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 5.852105617523193
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 6.108061075210571
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 5.784381866455078
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 5.66662859916687
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 6.104915142059326
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 5.604220628738403
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 5.559370756149292
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 5.833012580871582
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 6.011194944381714
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3674892
model size : 15.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 9.848029136657715
Epoch: 1, Steps: 7 | Train Loss: 2.390 Vali Loss: 1.883 Vali Acc: 0.681 Test Loss: 1.883 Test Acc: 0.681
Validation loss decreased (inf --> -0.680537).  Saving model ...
Epoch: 2 cost time: 7.617126226425171
Epoch: 2, Steps: 7 | Train Loss: 1.167 Vali Loss: 0.665 Vali Acc: 0.875 Test Loss: 0.665 Test Acc: 0.875
Validation loss decreased (-0.680537 --> -0.874993).  Saving model ...
Epoch: 3 cost time: 8.459254503250122
Epoch: 3, Steps: 7 | Train Loss: 0.270 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.874993 --> -0.944442).  Saving model ...
Epoch: 4 cost time: 7.055434942245483
Epoch: 4, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.097585201263428
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.652898073196411
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.366809129714966
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.896648168563843
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 8.435112953186035
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 8.055969715118408
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 8.098671197891235
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 12 cost time: 8.89237356185913
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 8.720953464508057
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 14 cost time: 8.210468053817749
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.635685682296753
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.50665831565857
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.433037519454956
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.61916446685791
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.611101388931274
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.068658113479614
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.29448652267456
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.72962212562561
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.530229806900024
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 10294796
model size : 40.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.789478778839111
Epoch: 1, Steps: 7 | Train Loss: 2.423 Vali Loss: 1.907 Vali Acc: 0.569 Test Loss: 1.907 Test Acc: 0.569
Validation loss decreased (inf --> -0.569425).  Saving model ...
Epoch: 2 cost time: 4.24540114402771
Epoch: 2, Steps: 7 | Train Loss: 1.230 Vali Loss: 0.656 Vali Acc: 0.875 Test Loss: 0.656 Test Acc: 0.875
Validation loss decreased (-0.569425 --> -0.874993).  Saving model ...
Epoch: 3 cost time: 3.8514888286590576
Epoch: 3, Steps: 7 | Train Loss: 0.218 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.874993 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 3.815262794494629
Epoch: 4, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7489593029022217
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7650516033172607
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 3.3048744201660156
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 3.9293057918548584
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.898843765258789
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.867171287536621
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 3.755171775817871
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 3.5611166954040527
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 3.4288523197174072
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 3.556882381439209
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 3.7233452796936035
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 3.9809489250183105
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 3.692883253097534
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 3.969143867492676
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 3.802184820175171
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 3.5746195316314697
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 3.555943012237549
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 3.650686025619507
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 3.6547136306762695
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 4.117961883544922
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 4.067811727523804
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 3.9463136196136475
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 3.8518006801605225
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 3.7597289085388184
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 3.6886258125305176
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 3.7276482582092285
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3674892
model size : 15.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 14.494144916534424
Epoch: 1, Steps: 7 | Train Loss: 2.426 Vali Loss: 1.825 Vali Acc: 0.681 Test Loss: 1.825 Test Acc: 0.681
Validation loss decreased (inf --> -0.680537).  Saving model ...
Epoch: 2 cost time: 7.873293876647949
Epoch: 2, Steps: 7 | Train Loss: 1.111 Vali Loss: 0.620 Vali Acc: 0.875 Test Loss: 0.620 Test Acc: 0.875
Validation loss decreased (-0.680537 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 12.111717939376831
Epoch: 3, Steps: 7 | Train Loss: 0.209 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 12.944785594940186
Epoch: 4, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 11.747628211975098
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.310173749923706
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.082282304763794
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.846319913864136
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.860885381698608
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.644417762756348
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.307908296585083
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.309344053268433
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 11.616692066192627
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 11.74044942855835
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 12.138364791870117
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 13.101085424423218
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 12.117358207702637
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 11.946793556213379
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 13.400129556655884
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 12.074775695800781
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 10.276145219802856
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 11.59647798538208
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 10.956506490707397
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 10.14365530014038
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 13.045213460922241
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 12.577873229980469
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 11.672435283660889
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 12.69750452041626
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 12.873156547546387
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 11.785223245620728
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 5608204
model size : 22.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.567274808883667
Epoch: 1, Steps: 7 | Train Loss: 2.472 Vali Loss: 1.877 Vali Acc: 0.764 Test Loss: 1.877 Test Acc: 0.764
Validation loss decreased (inf --> -0.763870).  Saving model ...
Epoch: 2 cost time: 4.461527347564697
Epoch: 2, Steps: 7 | Train Loss: 1.204 Vali Loss: 0.630 Vali Acc: 0.847 Test Loss: 0.630 Test Acc: 0.847
Validation loss decreased (-0.763870 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 4.3669753074646
Epoch: 3, Steps: 7 | Train Loss: 0.217 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.847216 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 4.478569746017456
Epoch: 4, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 4.5427587032318115
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.977488040924072
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.015485525131226
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 4.392408609390259
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 5.0785346031188965
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 5.185398817062378
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 5.08501124382019
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 5.643996477127075
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 5.592815637588501
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.6550986766815186
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.09221339225769
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.131755828857422
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.1278111934661865
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.1546971797943115
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.67939829826355
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 5.652760028839111
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 5.584662199020386
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.422033071517944
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.466028928756714
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.656994819641113
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.548524856567383
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.594566822052002
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.835543155670166
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.296440601348877
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.337172746658325
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.398058652877808
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2298124
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 11.41196060180664
Epoch: 1, Steps: 7 | Train Loss: 2.426 Vali Loss: 1.825 Vali Acc: 0.681 Test Loss: 1.825 Test Acc: 0.681
Validation loss decreased (inf --> -0.680537).  Saving model ...
Epoch: 2 cost time: 8.974188327789307
Epoch: 2, Steps: 7 | Train Loss: 1.111 Vali Loss: 0.620 Vali Acc: 0.875 Test Loss: 0.620 Test Acc: 0.875
Validation loss decreased (-0.680537 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 9.19607400894165
Epoch: 3, Steps: 7 | Train Loss: 0.209 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 10.021161794662476
Epoch: 4, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 9.182621479034424
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.025187015533447
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.8657386302948
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.059542179107666
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.097854137420654
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.049667596817017
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.975244522094727
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.041835069656372
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 8.120022058486938
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 9.213456392288208
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 10.196175575256348
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 9.73119330406189
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 8.907157182693481
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 9.223800897598267
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 10.00268816947937
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 9.179599523544312
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 8.172754526138306
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 7.7682318687438965
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 6.32241415977478
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 7.1179492473602295
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 7.9768617153167725
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 7.18705940246582
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 9.37226939201355
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 8.7967689037323
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 8.716432094573975
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 9.641093254089355
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 5608204
model size : 22.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.682523965835571
Epoch: 1, Steps: 7 | Train Loss: 2.472 Vali Loss: 1.875 Vali Acc: 0.778 Test Loss: 1.875 Test Acc: 0.778
Validation loss decreased (inf --> -0.777759).  Saving model ...
Epoch: 2 cost time: 4.169406175613403
Epoch: 2, Steps: 7 | Train Loss: 1.204 Vali Loss: 0.629 Vali Acc: 0.847 Test Loss: 0.629 Test Acc: 0.847
Validation loss decreased (-0.777759 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 3.7412831783294678
Epoch: 3, Steps: 7 | Train Loss: 0.217 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.847216 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 3.148764133453369
Epoch: 4, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 3.234729766845703
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.326164960861206
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.57904314994812
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 3.693983316421509
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 3.001920700073242
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 3.22818922996521
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 3.375617504119873
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 3.6782007217407227
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 3.7414634227752686
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.167300224304199
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.724933624267578
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.727138042449951
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.887716293334961
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.184791803359985
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.084173917770386
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 3.578087329864502
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 3.534832239151001
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.660006523132324
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.976365804672241
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.060871362686157
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.9638218879699707
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.7395570278167725
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.7380921840667725
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.799997091293335
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.157354831695557
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.7068614959716797
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2298124
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.292276859283447
Epoch: 1, Steps: 7 | Train Loss: 2.426 Vali Loss: 1.825 Vali Acc: 0.681 Test Loss: 1.825 Test Acc: 0.681
Validation loss decreased (inf --> -0.680537).  Saving model ...
Epoch: 2 cost time: 4.220673084259033
Epoch: 2, Steps: 7 | Train Loss: 1.111 Vali Loss: 0.620 Vali Acc: 0.875 Test Loss: 0.620 Test Acc: 0.875
Validation loss decreased (-0.680537 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 4.038036823272705
Epoch: 3, Steps: 7 | Train Loss: 0.209 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 4.3106467723846436
Epoch: 4, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 5.3791444301605225
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.926545143127441
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.845780849456787
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.872424125671387
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.50901198387146
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.534106254577637
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.024012565612793
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.863740921020508
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 4.978825330734253
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 5.458763360977173
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 5.355946779251099
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 4.890858888626099
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 4.090912342071533
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 4.838308811187744
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 4.910031318664551
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 4.366298675537109
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 4.179689407348633
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 4.593482255935669
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 4.919835090637207
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 4.358072996139526
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 4.745207071304321
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 5.134129524230957
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 5.639923095703125
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 5.091677904129028
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 4.90335750579834
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 4.907271385192871
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 5608204
model size : 22.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8978071212768555
Epoch: 1, Steps: 7 | Train Loss: 2.472 Vali Loss: 1.875 Vali Acc: 0.778 Test Loss: 1.875 Test Acc: 0.778
Validation loss decreased (inf --> -0.777759).  Saving model ...
Epoch: 2 cost time: 2.3623416423797607
Epoch: 2, Steps: 7 | Train Loss: 1.204 Vali Loss: 0.629 Vali Acc: 0.847 Test Loss: 0.629 Test Acc: 0.847
Validation loss decreased (-0.777759 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 2.334383487701416
Epoch: 3, Steps: 7 | Train Loss: 0.217 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.847216 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 2.2798526287078857
Epoch: 4, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 2.5476791858673096
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.630373954772949
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.230320453643799
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 2.0571677684783936
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 2.0940730571746826
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 2.056715488433838
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 2.070155143737793
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 2.282119035720825
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 2.239316463470459
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.284583330154419
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.051541328430176
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.104654550552368
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0582215785980225
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.087974786758423
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0699925422668457
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 2.1797592639923096
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 2.1197452545166016
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.144610643386841
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1026971340179443
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4196977615356445
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.640960693359375
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.7813010215759277
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.7164974212646484
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.496223211288452
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.4376258850097656
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.5247881412506104
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2298124
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 14.078383445739746
Epoch: 1, Steps: 7 | Train Loss: 2.444 Vali Loss: 2.161 Vali Acc: 0.472 Test Loss: 2.161 Test Acc: 0.472
Validation loss decreased (inf --> -0.472201).  Saving model ...
Epoch: 2 cost time: 11.10933804512024
Epoch: 2, Steps: 7 | Train Loss: 1.648 Vali Loss: 1.132 Vali Acc: 0.833 Test Loss: 1.132 Test Acc: 0.833
Validation loss decreased (-0.472201 --> -0.833322).  Saving model ...
Epoch: 3 cost time: 10.594330310821533
Epoch: 3, Steps: 7 | Train Loss: 0.657 Vali Loss: 0.531 Vali Acc: 0.931 Test Loss: 0.531 Test Acc: 0.931
Validation loss decreased (-0.833322 --> -0.930550).  Saving model ...
Epoch: 4 cost time: 9.682464122772217
Epoch: 4, Steps: 7 | Train Loss: 0.198 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.598283529281616
Epoch: 5, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.702422380447388
Epoch: 6, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.798304319381714
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930554).  Saving model ...
Epoch: 8 cost time: 12.71101999282837
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 9 cost time: 11.119034051895142
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 10 cost time: 10.911913394927979
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 11 cost time: 11.903196334838867
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 10.778066873550415
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 11.435900211334229
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.265214443206787
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.471508502960205
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.601539850234985
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.36933422088623
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.716882467269897
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 11.144149780273438
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.10629677772522
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.21821928024292
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 10.86152458190918
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 5148172
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.655183792114258
Epoch: 1, Steps: 7 | Train Loss: 2.426 Vali Loss: 2.063 Vali Acc: 0.500 Test Loss: 2.063 Test Acc: 0.500
Validation loss decreased (inf --> -0.499979).  Saving model ...
Epoch: 2 cost time: 4.320276260375977
Epoch: 2, Steps: 7 | Train Loss: 1.637 Vali Loss: 1.120 Vali Acc: 0.736 Test Loss: 1.120 Test Acc: 0.736
Validation loss decreased (-0.499979 --> -0.736100).  Saving model ...
Epoch: 3 cost time: 4.699373006820679
Epoch: 3, Steps: 7 | Train Loss: 0.677 Vali Loss: 0.555 Vali Acc: 0.847 Test Loss: 0.555 Test Acc: 0.847
Validation loss decreased (-0.736100 --> -0.847217).  Saving model ...
Epoch: 4 cost time: 4.937791109085083
Epoch: 4, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.847217 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 4.983950614929199
Epoch: 5, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.259045839309692
Epoch: 6, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.287801742553711
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 4.360094308853149
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 9 cost time: 4.938740253448486
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.9826555252075195
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.362905025482178
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.917 Test Loss: 0.178 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 4.903796195983887
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 13 cost time: 5.229976654052734
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.931 Test Loss: 0.163 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 14 cost time: 5.429502248764038
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.917 Test Loss: 0.162 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.340398550033569
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 5.021991014480591
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.910606145858765
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 5.262314558029175
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 5.409675121307373
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.360877752304077
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.994077920913696
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.911281108856201
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.736482858657837
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 4.884207725524902
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.931 Test Loss: 0.159 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 4.468465566635132
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.931 Test Loss: 0.158 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 4.649433851242065
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.931 Test Loss: 0.158 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 4.279176235198975
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.931 Test Loss: 0.157 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 5.00944709777832
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.931 Test Loss: 0.157 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 5.0362982749938965
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.931 Test Loss: 0.156 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 4.460828542709351
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.931 Test Loss: 0.155 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1837964
model size : 7.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 11.640869379043579
Epoch: 1, Steps: 7 | Train Loss: 2.444 Vali Loss: 2.161 Vali Acc: 0.472 Test Loss: 2.161 Test Acc: 0.472
Validation loss decreased (inf --> -0.472201).  Saving model ...
Epoch: 2 cost time: 8.750518083572388
Epoch: 2, Steps: 7 | Train Loss: 1.648 Vali Loss: 1.132 Vali Acc: 0.833 Test Loss: 1.132 Test Acc: 0.833
Validation loss decreased (-0.472201 --> -0.833322).  Saving model ...
Epoch: 3 cost time: 8.917094945907593
Epoch: 3, Steps: 7 | Train Loss: 0.657 Vali Loss: 0.531 Vali Acc: 0.931 Test Loss: 0.531 Test Acc: 0.931
Validation loss decreased (-0.833322 --> -0.930550).  Saving model ...
Epoch: 4 cost time: 9.74019455909729
Epoch: 4, Steps: 7 | Train Loss: 0.198 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.889209985733032
Epoch: 5, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.79940938949585
Epoch: 6, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.72317910194397
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930554).  Saving model ...
Epoch: 8 cost time: 7.791457891464233
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 9 cost time: 7.558988332748413
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 10 cost time: 8.483991861343384
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 11 cost time: 7.6742103099823
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 7.529936790466309
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 9.041028499603271
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.624831914901733
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.457521438598633
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.19330096244812
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.872270345687866
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.647492170333862
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.154504537582397
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.879765272140503
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.900415897369385
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.881163835525513
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 5148172
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.329566478729248
Epoch: 1, Steps: 7 | Train Loss: 2.426 Vali Loss: 2.063 Vali Acc: 0.500 Test Loss: 2.063 Test Acc: 0.500
Validation loss decreased (inf --> -0.499979).  Saving model ...
Epoch: 2 cost time: 3.7482986450195312
Epoch: 2, Steps: 7 | Train Loss: 1.637 Vali Loss: 1.120 Vali Acc: 0.736 Test Loss: 1.120 Test Acc: 0.736
Validation loss decreased (-0.499979 --> -0.736100).  Saving model ...
Epoch: 3 cost time: 3.4594333171844482
Epoch: 3, Steps: 7 | Train Loss: 0.677 Vali Loss: 0.555 Vali Acc: 0.847 Test Loss: 0.555 Test Acc: 0.847
Validation loss decreased (-0.736100 --> -0.847217).  Saving model ...
Epoch: 4 cost time: 3.9111080169677734
Epoch: 4, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.847217 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 4.034687519073486
Epoch: 5, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.2836754322052
Epoch: 6, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9920873641967773
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 3.818039655685425
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 9 cost time: 3.9215409755706787
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.190123081207275
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.247694492340088
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.917 Test Loss: 0.178 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 3.906966209411621
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 13 cost time: 3.863119125366211
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.931 Test Loss: 0.163 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 14 cost time: 3.852983236312866
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.917 Test Loss: 0.162 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.223052024841309
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 4.2183427810668945
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.213778495788574
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 3.3663082122802734
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 3.6906938552856445
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7417004108428955
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.33349347114563
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2610862255096436
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.326148748397827
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 3.763887882232666
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.931 Test Loss: 0.159 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 3.3608860969543457
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.931 Test Loss: 0.158 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 3.239718437194824
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.931 Test Loss: 0.158 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 3.587632179260254
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.931 Test Loss: 0.157 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 4.100627660751343
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.931 Test Loss: 0.157 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 4.127458095550537
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.931 Test Loss: 0.156 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 3.7953407764434814
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.931 Test Loss: 0.155 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1837964
model size : 7.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.6066014766693115
Epoch: 1, Steps: 7 | Train Loss: 2.444 Vali Loss: 2.162 Vali Acc: 0.472 Test Loss: 2.162 Test Acc: 0.472
Validation loss decreased (inf --> -0.472201).  Saving model ...
Epoch: 2 cost time: 4.932636976242065
Epoch: 2, Steps: 7 | Train Loss: 1.648 Vali Loss: 1.133 Vali Acc: 0.847 Test Loss: 1.133 Test Acc: 0.847
Validation loss decreased (-0.472201 --> -0.847211).  Saving model ...
Epoch: 3 cost time: 5.237526893615723
Epoch: 3, Steps: 7 | Train Loss: 0.657 Vali Loss: 0.531 Vali Acc: 0.931 Test Loss: 0.531 Test Acc: 0.931
Validation loss decreased (-0.847211 --> -0.930550).  Saving model ...
Epoch: 4 cost time: 5.510548830032349
Epoch: 4, Steps: 7 | Train Loss: 0.198 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.039831876754761
Epoch: 5, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.042834997177124
Epoch: 6, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.737390756607056
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930554).  Saving model ...
Epoch: 8 cost time: 4.706379652023315
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 9 cost time: 4.16151237487793
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 10 cost time: 4.611482858657837
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 11 cost time: 4.892102956771851
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 4.4322669506073
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 4.101222991943359
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.315414905548096
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.191622734069824
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.0704286098480225
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.420047760009766
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.697538375854492
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.147735595703125
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.1855902671813965
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.571007490158081
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.55529522895813
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 5148172
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6563830375671387
Epoch: 1, Steps: 7 | Train Loss: 2.425 Vali Loss: 2.063 Vali Acc: 0.500 Test Loss: 2.063 Test Acc: 0.500
Validation loss decreased (inf --> -0.499979).  Saving model ...
Epoch: 2 cost time: 1.9761548042297363
Epoch: 2, Steps: 7 | Train Loss: 1.637 Vali Loss: 1.120 Vali Acc: 0.736 Test Loss: 1.120 Test Acc: 0.736
Validation loss decreased (-0.499979 --> -0.736100).  Saving model ...
Epoch: 3 cost time: 2.026306629180908
Epoch: 3, Steps: 7 | Train Loss: 0.676 Vali Loss: 0.555 Vali Acc: 0.847 Test Loss: 0.555 Test Acc: 0.847
Validation loss decreased (-0.736100 --> -0.847217).  Saving model ...
Epoch: 4 cost time: 2.058830499649048
Epoch: 4, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.847217 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 2.5290937423706055
Epoch: 5, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5831754207611084
Epoch: 6, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.234131336212158
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 2.323333740234375
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 9 cost time: 2.2398533821105957
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.903 Test Loss: 0.211 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3676352500915527
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.544584274291992
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 2.4942288398742676
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 13 cost time: 2.2694802284240723
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.931 Test Loss: 0.164 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 14 cost time: 2.2340147495269775
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.917 Test Loss: 0.162 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4318361282348633
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 2.497734308242798
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.503582239151001
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 2.327183485031128
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 2.3047447204589844
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2632155418395996
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8808817863464355
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8930437564849854
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6919972896575928
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 1.6248738765716553
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.931 Test Loss: 0.159 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 2.041990041732788
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.931 Test Loss: 0.158 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 2.7847001552581787
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.931 Test Loss: 0.158 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 2.8511695861816406
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.931 Test Loss: 0.157 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 2.621880292892456
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.931 Test Loss: 0.157 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 2.603062152862549
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.931 Test Loss: 0.156 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 2.6482245922088623
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.931 Test Loss: 0.156 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1837964
model size : 7.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.286639928817749
Epoch: 1, Steps: 7 | Train Loss: 2.447 Vali Loss: 2.078 Vali Acc: 0.500 Test Loss: 2.078 Test Acc: 0.500
Validation loss decreased (inf --> -0.499979).  Saving model ...
Epoch: 2 cost time: 6.512588977813721
Epoch: 2, Steps: 7 | Train Loss: 1.634 Vali Loss: 1.103 Vali Acc: 0.778 Test Loss: 1.103 Test Acc: 0.778
Validation loss decreased (-0.499979 --> -0.777767).  Saving model ...
Epoch: 3 cost time: 6.960031270980835
Epoch: 3, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.777767 --> -0.874995).  Saving model ...
Epoch: 4 cost time: 6.368757724761963
Epoch: 4, Steps: 7 | Train Loss: 0.192 Vali Loss: 0.347 Vali Acc: 0.847 Test Loss: 0.347 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.506331920623779
Epoch: 5, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 6.999613046646118
Epoch: 6, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.099762201309204
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 6.06877589225769
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.875 Test Loss: 0.266 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.413223028182983
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 6.004836082458496
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 6.240039348602295
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 6.4931371212005615
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 5.948390245437622
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 6.227845191955566
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 6.2280519008636475
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.312773942947388
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.013737440109253
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.106503248214722
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.535089492797852
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.022286891937256
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.89525294303894
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.553520917892456
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.1742939949035645
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.71686315536499
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 2804492
model size : 11.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.057852506637573
Epoch: 1, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.112 Vali Acc: 0.347 Test Loss: 2.112 Test Acc: 0.347
Validation loss decreased (inf --> -0.347201).  Saving model ...
Epoch: 2 cost time: 2.9423654079437256
Epoch: 2, Steps: 7 | Train Loss: 1.696 Vali Loss: 1.169 Vali Acc: 0.778 Test Loss: 1.169 Test Acc: 0.778
Validation loss decreased (-0.347201 --> -0.777766).  Saving model ...
Epoch: 3 cost time: 2.8277318477630615
Epoch: 3, Steps: 7 | Train Loss: 0.679 Vali Loss: 0.605 Vali Acc: 0.889 Test Loss: 0.605 Test Acc: 0.889
Validation loss decreased (-0.777766 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 2.865527391433716
Epoch: 4, Steps: 7 | Train Loss: 0.222 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1306416988372803
Epoch: 5, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 3.245387077331543
Epoch: 6, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 2.960094928741455
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 2.9264721870422363
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 2.9424240589141846
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 3.173994541168213
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 3.292490243911743
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 2.858844518661499
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 2.820634365081787
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.887701988220215
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 2.9323477745056152
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 2.5856716632843018
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 2.8078577518463135
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9417266845703125
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3911731243133545
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 3.188513994216919
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 3.0957300662994385
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 3.1140658855438232
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3492982387542725
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3995187282562256
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.1545186042785645
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.155681848526001
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 3.22702693939209
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 3.3738601207733154
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 3.155217170715332
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.1292173862457275
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1149324
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.8063342571258545
Epoch: 1, Steps: 7 | Train Loss: 2.447 Vali Loss: 2.078 Vali Acc: 0.500 Test Loss: 2.078 Test Acc: 0.500
Validation loss decreased (inf --> -0.499979).  Saving model ...
Epoch: 2 cost time: 5.323320150375366
Epoch: 2, Steps: 7 | Train Loss: 1.634 Vali Loss: 1.103 Vali Acc: 0.778 Test Loss: 1.103 Test Acc: 0.778
Validation loss decreased (-0.499979 --> -0.777767).  Saving model ...
Epoch: 3 cost time: 4.740058183670044
Epoch: 3, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.777767 --> -0.874995).  Saving model ...
Epoch: 4 cost time: 4.744214773178101
Epoch: 4, Steps: 7 | Train Loss: 0.192 Vali Loss: 0.347 Vali Acc: 0.847 Test Loss: 0.347 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.162955045700073
Epoch: 5, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 4.768728256225586
Epoch: 6, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.695829629898071
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 5.174585580825806
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.875 Test Loss: 0.266 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.787425518035889
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 4.6883320808410645
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 5.26909613609314
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 4.642001628875732
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 5.206220865249634
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 5.5949671268463135
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 5.100917816162109
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.169280052185059
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.706660032272339
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.172738790512085
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.198374271392822
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.6413633823394775
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.0759663581848145
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.190448999404907
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.681392431259155
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.148094415664673
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 2804492
model size : 11.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8945975303649902
Epoch: 1, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.112 Vali Acc: 0.347 Test Loss: 2.112 Test Acc: 0.347
Validation loss decreased (inf --> -0.347201).  Saving model ...
Epoch: 2 cost time: 2.18619966506958
Epoch: 2, Steps: 7 | Train Loss: 1.696 Vali Loss: 1.169 Vali Acc: 0.778 Test Loss: 1.169 Test Acc: 0.778
Validation loss decreased (-0.347201 --> -0.777766).  Saving model ...
Epoch: 3 cost time: 2.397393226623535
Epoch: 3, Steps: 7 | Train Loss: 0.679 Vali Loss: 0.605 Vali Acc: 0.889 Test Loss: 0.605 Test Acc: 0.889
Validation loss decreased (-0.777766 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 2.4440412521362305
Epoch: 4, Steps: 7 | Train Loss: 0.222 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2629575729370117
Epoch: 5, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 2.2114789485931396
Epoch: 6, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 2.31534743309021
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 2.1504790782928467
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 2.4868581295013428
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 2.2242321968078613
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 2.233369827270508
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 2.2459537982940674
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 2.334280252456665
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.3897407054901123
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 2.2204031944274902
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 2.3006389141082764
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 2.043358325958252
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6066317558288574
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.695858955383301
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 2.5826447010040283
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 2.562838315963745
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 2.5584003925323486
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.778447389602661
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7450690269470215
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.5951194763183594
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.5512518882751465
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 2.5965635776519775
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 2.766594171524048
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 2.760101079940796
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.653482437133789
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1149324
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.872597694396973
Epoch: 1, Steps: 7 | Train Loss: 2.447 Vali Loss: 2.078 Vali Acc: 0.500 Test Loss: 2.078 Test Acc: 0.500
Validation loss decreased (inf --> -0.499979).  Saving model ...
Epoch: 2 cost time: 3.3056864738464355
Epoch: 2, Steps: 7 | Train Loss: 1.634 Vali Loss: 1.103 Vali Acc: 0.778 Test Loss: 1.103 Test Acc: 0.778
Validation loss decreased (-0.499979 --> -0.777767).  Saving model ...
Epoch: 3 cost time: 3.453662633895874
Epoch: 3, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.777767 --> -0.874995).  Saving model ...
Epoch: 4 cost time: 3.6614460945129395
Epoch: 4, Steps: 7 | Train Loss: 0.192 Vali Loss: 0.347 Vali Acc: 0.847 Test Loss: 0.347 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.000974416732788
Epoch: 5, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 2.9853107929229736
Epoch: 6, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9792864322662354
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 3.249995708465576
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.875 Test Loss: 0.266 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.24483060836792
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 3.0528628826141357
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 3.0749800205230713
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 3.2653555870056152
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 3.153634548187256
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 3.11932373046875
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 3.058983087539673
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.289682149887085
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1660401821136475
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.063760757446289
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.1414272785186768
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.6666293144226074
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6732404232025146
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.317318916320801
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.2355093955993652
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.2204887866973877
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 2804492
model size : 11.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4564735889434814
Epoch: 1, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.112 Vali Acc: 0.347 Test Loss: 2.112 Test Acc: 0.347
Validation loss decreased (inf --> -0.347201).  Saving model ...
Epoch: 2 cost time: 2.114377498626709
Epoch: 2, Steps: 7 | Train Loss: 1.696 Vali Loss: 1.169 Vali Acc: 0.778 Test Loss: 1.169 Test Acc: 0.778
Validation loss decreased (-0.347201 --> -0.777766).  Saving model ...
Epoch: 3 cost time: 2.1257641315460205
Epoch: 3, Steps: 7 | Train Loss: 0.679 Vali Loss: 0.605 Vali Acc: 0.889 Test Loss: 0.605 Test Acc: 0.889
Validation loss decreased (-0.777766 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 2.1067616939544678
Epoch: 4, Steps: 7 | Train Loss: 0.223 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1722524166107178
Epoch: 5, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 2.1065917015075684
Epoch: 6, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.9189391136169434
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.8768494129180908
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.9596588611602783
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.936279296875
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.960599660873413
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.938448429107666
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.9623699188232422
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 2.209568977355957
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.8400511741638184
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.89389967918396
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.95536208152771
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.958735466003418
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.80891752243042
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.8350989818572998
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.7666304111480713
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.7527496814727783
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.825676679611206
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8212544918060303
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9353857040405273
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7381138801574707
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9057073593139648
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 2.022528648376465
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.9027273654937744
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8468403816223145
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1149324
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.843579292297363
Epoch: 1, Steps: 7 | Train Loss: 2.427 Vali Loss: 2.113 Vali Acc: 0.431 Test Loss: 2.113 Test Acc: 0.431
Validation loss decreased (inf --> -0.430534).  Saving model ...
Epoch: 2 cost time: 5.377371072769165
Epoch: 2, Steps: 7 | Train Loss: 1.720 Vali Loss: 1.168 Vali Acc: 0.833 Test Loss: 1.168 Test Acc: 0.833
Validation loss decreased (-0.430534 --> -0.833322).  Saving model ...
Epoch: 3 cost time: 5.35784912109375
Epoch: 3, Steps: 7 | Train Loss: 0.727 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.833322 --> -0.874994).  Saving model ...
Epoch: 4 cost time: 4.861874341964722
Epoch: 4, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
Validation loss decreased (-0.874994 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 5.114938497543335
Epoch: 5, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.758885383605957
Epoch: 6, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 5.004893779754639
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 5.288031101226807
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 5.348273515701294
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 4.808151483535767
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 4.927542686462402
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 4.776467800140381
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 5.082225799560547
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 5.927080392837524
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.415140151977539
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.207476615905762
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.922756195068359
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.5059425830841064
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.591814756393433
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.221870422363281
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 4.988081932067871
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 4.732823133468628
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 4.517358779907227
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.255066394805908
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.502997875213623
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.044251918792725
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.034442186355591
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.050829648971558
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.551601886749268
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.67970871925354
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1632652
model size : 6.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.387200355529785
Epoch: 1, Steps: 7 | Train Loss: 2.501 Vali Loss: 2.247 Vali Acc: 0.264 Test Loss: 2.247 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 2.592399835586548
Epoch: 2, Steps: 7 | Train Loss: 1.739 Vali Loss: 1.233 Vali Acc: 0.778 Test Loss: 1.233 Test Acc: 0.778
Validation loss decreased (-0.263866 --> -0.777765).  Saving model ...
Epoch: 3 cost time: 2.687777042388916
Epoch: 3, Steps: 7 | Train Loss: 0.709 Vali Loss: 0.624 Vali Acc: 0.875 Test Loss: 0.624 Test Acc: 0.875
Validation loss decreased (-0.777765 --> -0.874994).  Saving model ...
Epoch: 4 cost time: 2.6995465755462646
Epoch: 4, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.444 Vali Acc: 0.847 Test Loss: 0.444 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4874863624572754
Epoch: 5, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 2.429191827774048
Epoch: 6, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 7 cost time: 2.439728260040283
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 2.674071788787842
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 2.6541357040405273
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 2.675583839416504
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6954433917999268
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6012532711029053
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.435649871826172
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.391993522644043
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.409956693649292
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.499647855758667
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.542289972305298
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.8491628170013428
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.848454236984253
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 805004
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.186843395233154
Epoch: 1, Steps: 7 | Train Loss: 2.427 Vali Loss: 2.113 Vali Acc: 0.431 Test Loss: 2.113 Test Acc: 0.431
Validation loss decreased (inf --> -0.430534).  Saving model ...
Epoch: 2 cost time: 3.643841505050659
Epoch: 2, Steps: 7 | Train Loss: 1.720 Vali Loss: 1.168 Vali Acc: 0.833 Test Loss: 1.168 Test Acc: 0.833
Validation loss decreased (-0.430534 --> -0.833322).  Saving model ...
Epoch: 3 cost time: 3.4820804595947266
Epoch: 3, Steps: 7 | Train Loss: 0.727 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.833322 --> -0.874994).  Saving model ...
Epoch: 4 cost time: 3.8555233478546143
Epoch: 4, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
Validation loss decreased (-0.874994 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 3.963794469833374
Epoch: 5, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.854034423828125
Epoch: 6, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 3.468278646469116
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 3.483297824859619
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 3.422907829284668
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 3.4845495223999023
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 3.4303245544433594
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 3.839660406112671
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 3.926821231842041
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 3.922799587249756
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8114383220672607
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.802903652191162
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.8416013717651367
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.845553159713745
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.239813804626465
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.361647605895996
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 4.334846258163452
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 4.033320903778076
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 3.9557199478149414
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.68967866897583
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.8691327571868896
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.91064190864563
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.191906690597534
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.162312269210815
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.185879230499268
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.7833662033081055
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1632652
model size : 6.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.613086223602295
Epoch: 1, Steps: 7 | Train Loss: 2.501 Vali Loss: 2.243 Vali Acc: 0.264 Test Loss: 2.243 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 2.0833349227905273
Epoch: 2, Steps: 7 | Train Loss: 1.739 Vali Loss: 1.231 Vali Acc: 0.778 Test Loss: 1.231 Test Acc: 0.778
Validation loss decreased (-0.263866 --> -0.777765).  Saving model ...
Epoch: 3 cost time: 2.065687656402588
Epoch: 3, Steps: 7 | Train Loss: 0.709 Vali Loss: 0.624 Vali Acc: 0.875 Test Loss: 0.624 Test Acc: 0.875
Validation loss decreased (-0.777765 --> -0.874994).  Saving model ...
Epoch: 4 cost time: 2.1550240516662598
Epoch: 4, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.443 Vali Acc: 0.847 Test Loss: 0.443 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1676244735717773
Epoch: 5, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.92527174949646
Epoch: 6, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 7 cost time: 1.902735710144043
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.883617877960205
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.8748047351837158
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.9472179412841797
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8950178623199463
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8802175521850586
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.093407392501831
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.066861152648926
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.113271951675415
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0864858627319336
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0461275577545166
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.856626272201538
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8777294158935547
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 805004
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.281083106994629
Epoch: 1, Steps: 7 | Train Loss: 2.427 Vali Loss: 2.113 Vali Acc: 0.431 Test Loss: 2.113 Test Acc: 0.431
Validation loss decreased (inf --> -0.430534).  Saving model ...
Epoch: 2 cost time: 2.690761089324951
Epoch: 2, Steps: 7 | Train Loss: 1.720 Vali Loss: 1.168 Vali Acc: 0.833 Test Loss: 1.168 Test Acc: 0.833
Validation loss decreased (-0.430534 --> -0.833322).  Saving model ...
Epoch: 3 cost time: 2.7611541748046875
Epoch: 3, Steps: 7 | Train Loss: 0.727 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.833322 --> -0.874994).  Saving model ...
Epoch: 4 cost time: 2.7858104705810547
Epoch: 4, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
Validation loss decreased (-0.874994 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 2.5940256118774414
Epoch: 5, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.559019088745117
Epoch: 6, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 2.572655439376831
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 2.5155608654022217
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 2.5503296852111816
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 2.4604482650756836
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 2.8431928157806396
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 2.826371192932129
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 2.7840332984924316
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 2.768967628479004
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4310719966888428
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.545536994934082
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.560086488723755
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5449841022491455
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4428985118865967
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.5241482257843018
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 2.7907233238220215
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 2.805748224258423
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 2.8560900688171387
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.8837482929229736
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.6108100414276123
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.3609254360198975
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.3847877979278564
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.3245584964752197
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.3979358673095703
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.3473317623138428
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1632652
model size : 6.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.517869234085083
Epoch: 1, Steps: 7 | Train Loss: 2.501 Vali Loss: 2.243 Vali Acc: 0.264 Test Loss: 2.243 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 1.2868833541870117
Epoch: 2, Steps: 7 | Train Loss: 1.738 Vali Loss: 1.231 Vali Acc: 0.778 Test Loss: 1.231 Test Acc: 0.778
Validation loss decreased (-0.263866 --> -0.777765).  Saving model ...
Epoch: 3 cost time: 1.2573258876800537
Epoch: 3, Steps: 7 | Train Loss: 0.709 Vali Loss: 0.624 Vali Acc: 0.875 Test Loss: 0.624 Test Acc: 0.875
Validation loss decreased (-0.777765 --> -0.874994).  Saving model ...
Epoch: 4 cost time: 1.391709566116333
Epoch: 4, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.444 Vali Acc: 0.847 Test Loss: 0.444 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5935049057006836
Epoch: 5, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.4195456504821777
Epoch: 6, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 7 cost time: 1.4526796340942383
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.2558341026306152
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.3261373043060303
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.2882146835327148
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2874236106872559
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.357301950454712
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9855639934539795
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6018807888031006
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5381710529327393
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5231173038482666
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6038281917572021
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.399897813796997
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4787111282348633
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 805004
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 8.390281677246094
Epoch: 1, Steps: 7 | Train Loss: 2.556 Vali Loss: 2.276 Vali Acc: 0.194 Test Loss: 2.276 Test Acc: 0.194
Validation loss decreased (inf --> -0.194422).  Saving model ...
Epoch: 2 cost time: 6.03316330909729
Epoch: 2, Steps: 7 | Train Loss: 2.100 Vali Loss: 1.668 Vali Acc: 0.736 Test Loss: 1.668 Test Acc: 0.736
Validation loss decreased (-0.194422 --> -0.736094).  Saving model ...
Epoch: 3 cost time: 5.8631463050842285
Epoch: 3, Steps: 7 | Train Loss: 1.318 Vali Loss: 1.024 Vali Acc: 0.889 Test Loss: 1.024 Test Acc: 0.889
Validation loss decreased (-0.736094 --> -0.888879).  Saving model ...
Epoch: 4 cost time: 5.842258930206299
Epoch: 4, Steps: 7 | Train Loss: 0.678 Vali Loss: 0.640 Vali Acc: 0.875 Test Loss: 0.640 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.570603609085083
Epoch: 5, Steps: 7 | Train Loss: 0.301 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.764848470687866
Epoch: 6, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.888879 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 5.630139350891113
Epoch: 7, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 5.9448912143707275
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.308 Vali Acc: 0.875 Test Loss: 0.308 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.973428726196289
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.45814323425293
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.424283504486084
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 5.812187671661377
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 6.329312801361084
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.2811079025268555
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.600336790084839
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.11254620552063
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.087805986404419
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 5.493682384490967
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 5.327112913131714
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 6.664997816085815
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 6.3709118366241455
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 5.9525299072265625
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 5.873044967651367
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 6.671552419662476
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 6.226234197616577
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 5.92074179649353
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.2006306648254395
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.628700017929077
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 5.75395655632019
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 5.88971734046936
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1402636
model size : 5.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.331341981887817
Epoch: 1, Steps: 7 | Train Loss: 2.537 Vali Loss: 2.273 Vali Acc: 0.208 Test Loss: 2.273 Test Acc: 0.208
Validation loss decreased (inf --> -0.208311).  Saving model ...
Epoch: 2 cost time: 2.7491252422332764
Epoch: 2, Steps: 7 | Train Loss: 2.155 Vali Loss: 1.739 Vali Acc: 0.694 Test Loss: 1.739 Test Acc: 0.694
Validation loss decreased (-0.208311 --> -0.694427).  Saving model ...
Epoch: 3 cost time: 2.784964084625244
Epoch: 3, Steps: 7 | Train Loss: 1.397 Vali Loss: 1.110 Vali Acc: 0.917 Test Loss: 1.110 Test Acc: 0.917
Validation loss decreased (-0.694427 --> -0.916656).  Saving model ...
Epoch: 4 cost time: 2.7945005893707275
Epoch: 4, Steps: 7 | Train Loss: 0.734 Vali Loss: 0.677 Vali Acc: 0.889 Test Loss: 0.677 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.045579195022583
Epoch: 5, Steps: 7 | Train Loss: 0.344 Vali Loss: 0.435 Vali Acc: 0.917 Test Loss: 0.435 Test Acc: 0.917
Validation loss decreased (-0.916656 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 3.0844178199768066
Epoch: 6, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 2.7742035388946533
Epoch: 7, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4733083248138428
Epoch: 8, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 2.7539005279541016
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 2.869785785675049
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 2.963590145111084
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9344658851623535
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9877185821533203
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.778423309326172
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7846951484680176
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6658260822296143
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.2039177417755127
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.220693349838257
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.1895029544830322
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.9632022380828857
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 574924
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.431065082550049
Epoch: 1, Steps: 7 | Train Loss: 2.556 Vali Loss: 2.278 Vali Acc: 0.194 Test Loss: 2.278 Test Acc: 0.194
Validation loss decreased (inf --> -0.194422).  Saving model ...
Epoch: 2 cost time: 4.645994663238525
Epoch: 2, Steps: 7 | Train Loss: 2.100 Vali Loss: 1.669 Vali Acc: 0.736 Test Loss: 1.669 Test Acc: 0.736
Validation loss decreased (-0.194422 --> -0.736094).  Saving model ...
Epoch: 3 cost time: 4.453393936157227
Epoch: 3, Steps: 7 | Train Loss: 1.318 Vali Loss: 1.024 Vali Acc: 0.889 Test Loss: 1.024 Test Acc: 0.889
Validation loss decreased (-0.736094 --> -0.888879).  Saving model ...
Epoch: 4 cost time: 4.393252611160278
Epoch: 4, Steps: 7 | Train Loss: 0.678 Vali Loss: 0.640 Vali Acc: 0.875 Test Loss: 0.640 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.690507173538208
Epoch: 5, Steps: 7 | Train Loss: 0.301 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.812214612960815
Epoch: 6, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.888879 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 4.606300115585327
Epoch: 7, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 4.457048654556274
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.308 Vali Acc: 0.875 Test Loss: 0.308 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.3331804275512695
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.466081857681274
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.517753839492798
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 4.161891460418701
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 3.9891245365142822
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.14990758895874
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.488671779632568
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.006119012832642
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.9374547004699707
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 3.9919135570526123
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 4.1540610790252686
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 4.366873264312744
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 4.103376865386963
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 4.0010340213775635
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 4.390309572219849
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 4.810719013214111
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 4.692972421646118
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 4.296093463897705
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.262471675872803
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.210882902145386
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 4.61844277381897
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 4.616912126541138
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1402636
model size : 5.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.128576755523682
Epoch: 1, Steps: 7 | Train Loss: 2.537 Vali Loss: 2.279 Vali Acc: 0.194 Test Loss: 2.279 Test Acc: 0.194
Validation loss decreased (inf --> -0.194422).  Saving model ...
Epoch: 2 cost time: 2.365823984146118
Epoch: 2, Steps: 7 | Train Loss: 2.155 Vali Loss: 1.744 Vali Acc: 0.694 Test Loss: 1.744 Test Acc: 0.694
Validation loss decreased (-0.194422 --> -0.694427).  Saving model ...
Epoch: 3 cost time: 2.4072484970092773
Epoch: 3, Steps: 7 | Train Loss: 1.397 Vali Loss: 1.111 Vali Acc: 0.917 Test Loss: 1.111 Test Acc: 0.917
Validation loss decreased (-0.694427 --> -0.916656).  Saving model ...
Epoch: 4 cost time: 2.2244577407836914
Epoch: 4, Steps: 7 | Train Loss: 0.734 Vali Loss: 0.678 Vali Acc: 0.889 Test Loss: 0.678 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2412326335906982
Epoch: 5, Steps: 7 | Train Loss: 0.344 Vali Loss: 0.435 Vali Acc: 0.917 Test Loss: 0.435 Test Acc: 0.917
Validation loss decreased (-0.916656 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 2.169206142425537
Epoch: 6, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 2.1571998596191406
Epoch: 7, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.051957130432129
Epoch: 8, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 2.264430046081543
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 2.2098753452301025
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 2.141014337539673
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0249929428100586
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9887382984161377
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.922743558883667
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.060203790664673
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2864787578582764
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.244629144668579
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2295706272125244
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.079653024673462
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.047515630722046
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 574924
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.3360395431518555
Epoch: 1, Steps: 7 | Train Loss: 2.561 Vali Loss: 2.280 Vali Acc: 0.194 Test Loss: 2.280 Test Acc: 0.194
Validation loss decreased (inf --> -0.194422).  Saving model ...
Epoch: 2 cost time: 2.493852376937866
Epoch: 2, Steps: 7 | Train Loss: 2.107 Vali Loss: 1.673 Vali Acc: 0.736 Test Loss: 1.673 Test Acc: 0.736
Validation loss decreased (-0.194422 --> -0.736094).  Saving model ...
Epoch: 3 cost time: 2.8307948112487793
Epoch: 3, Steps: 7 | Train Loss: 1.330 Vali Loss: 1.029 Vali Acc: 0.889 Test Loss: 1.029 Test Acc: 0.889
Validation loss decreased (-0.736094 --> -0.888879).  Saving model ...
Epoch: 4 cost time: 2.824270248413086
Epoch: 4, Steps: 7 | Train Loss: 0.688 Vali Loss: 0.645 Vali Acc: 0.875 Test Loss: 0.645 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7324559688568115
Epoch: 5, Steps: 7 | Train Loss: 0.309 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.064408302307129
Epoch: 6, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
Validation loss decreased (-0.888879 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 3.0704574584960938
Epoch: 7, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 2.831580877304077
Epoch: 8, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8291656970977783
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7559659481048584
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 2.7932891845703125
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 3.0841407775878906
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 3.1652228832244873
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 3.152700901031494
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.767014980316162
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 2.845134973526001
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 2.888308048248291
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 2.8004226684570312
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.142568588256836
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 3.10286808013916
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 3.0927236080169678
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 2.8015859127044678
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 2.7440555095672607
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 2.531115770339966
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 2.584949016571045
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 2.897455930709839
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 2.9214625358581543
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.580918073654175
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 2.6307194232940674
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 2.6076624393463135
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1402636
model size : 5.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.9195761680603027
Epoch: 1, Steps: 7 | Train Loss: 2.537 Vali Loss: 2.279 Vali Acc: 0.194 Test Loss: 2.279 Test Acc: 0.194
Validation loss decreased (inf --> -0.194422).  Saving model ...
Epoch: 2 cost time: 1.5405797958374023
Epoch: 2, Steps: 7 | Train Loss: 2.155 Vali Loss: 1.744 Vali Acc: 0.694 Test Loss: 1.744 Test Acc: 0.694
Validation loss decreased (-0.194422 --> -0.694427).  Saving model ...
Epoch: 3 cost time: 1.4942193031311035
Epoch: 3, Steps: 7 | Train Loss: 1.398 Vali Loss: 1.112 Vali Acc: 0.917 Test Loss: 1.112 Test Acc: 0.917
Validation loss decreased (-0.694427 --> -0.916656).  Saving model ...
Epoch: 4 cost time: 1.5172247886657715
Epoch: 4, Steps: 7 | Train Loss: 0.735 Vali Loss: 0.679 Vali Acc: 0.889 Test Loss: 0.679 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5173568725585938
Epoch: 5, Steps: 7 | Train Loss: 0.344 Vali Loss: 0.436 Vali Acc: 0.917 Test Loss: 0.436 Test Acc: 0.917
Validation loss decreased (-0.916656 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 1.4855942726135254
Epoch: 6, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.4367351531982422
Epoch: 7, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.308657169342041
Epoch: 8, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.3830773830413818
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.5012876987457275
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.444046974182129
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.511413812637329
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.789259910583496
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.788830041885376
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7686419486999512
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7326340675354004
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6355206966400146
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.67655611038208
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7197818756103516
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.603797435760498
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 574924
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 6.867717027664185
Epoch: 1, Steps: 7 | Train Loss: 2.482 Vali Loss: 2.326 Vali Acc: 0.264 Test Loss: 2.326 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 4.275479793548584
Epoch: 2, Steps: 7 | Train Loss: 2.034 Vali Loss: 1.669 Vali Acc: 0.694 Test Loss: 1.669 Test Acc: 0.694
Validation loss decreased (-0.263866 --> -0.694428).  Saving model ...
Epoch: 3 cost time: 4.532348155975342
Epoch: 3, Steps: 7 | Train Loss: 1.298 Vali Loss: 1.078 Vali Acc: 0.819 Test Loss: 1.078 Test Acc: 0.819
Validation loss decreased (-0.694428 --> -0.819434).  Saving model ...
Epoch: 4 cost time: 4.633928060531616
Epoch: 4, Steps: 7 | Train Loss: 0.654 Vali Loss: 0.696 Vali Acc: 0.861 Test Loss: 0.696 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 5.064248561859131
Epoch: 5, Steps: 7 | Train Loss: 0.285 Vali Loss: 0.469 Vali Acc: 0.889 Test Loss: 0.469 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 5.395171642303467
Epoch: 6, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.432225942611694
Epoch: 7, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.446123838424683
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 4.42022180557251
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 4.632022857666016
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 4.4309937953948975
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 4.282733201980591
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 4.3900392055511475
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.220930814743042
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.155518531799316
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.53055214881897
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 4.686523914337158
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 4.26456618309021
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 4.2307915687561035
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.329951047897339
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.118156909942627
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.234530448913574
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.630779027938843
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.059363603591919
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.6885364055633545
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.028026342391968
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.250349283218384
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.523982048034668
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 816524
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.373019456863403
Epoch: 1, Steps: 7 | Train Loss: 2.516 Vali Loss: 2.323 Vali Acc: 0.222 Test Loss: 2.323 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 2.672457456588745
Epoch: 2, Steps: 7 | Train Loss: 2.056 Vali Loss: 1.701 Vali Acc: 0.736 Test Loss: 1.701 Test Acc: 0.736
Validation loss decreased (-0.222199 --> -0.736094).  Saving model ...
Epoch: 3 cost time: 2.5183498859405518
Epoch: 3, Steps: 7 | Train Loss: 1.309 Vali Loss: 1.088 Vali Acc: 0.819 Test Loss: 1.088 Test Acc: 0.819
Validation loss decreased (-0.736094 --> -0.819434).  Saving model ...
Epoch: 4 cost time: 2.306022882461548
Epoch: 4, Steps: 7 | Train Loss: 0.747 Vali Loss: 0.724 Vali Acc: 0.861 Test Loss: 0.724 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 2.273709297180176
Epoch: 5, Steps: 7 | Train Loss: 0.381 Vali Loss: 0.546 Vali Acc: 0.917 Test Loss: 0.546 Test Acc: 0.917
Validation loss decreased (-0.861104 --> -0.916661).  Saving model ...
Epoch: 6 cost time: 2.325098752975464
Epoch: 6, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3544552326202393
Epoch: 7, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.350 Vali Acc: 0.931 Test Loss: 0.350 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 2.3854076862335205
Epoch: 8, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.356 Vali Acc: 0.931 Test Loss: 0.356 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4121103286743164
Epoch: 9, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 2.501645803451538
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 2.5235681533813477
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 2.270170211791992
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 2.1918578147888184
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 2.0573031902313232
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.242125988006592
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2539420127868652
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.338911771774292
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.417086124420166
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.5085222721099854
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 2.2703709602355957
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 2.2000515460968018
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 2.2263846397399902
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 2.2531847953796387
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3762881755828857
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.4414589405059814
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 2.356799602508545
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.4149508476257324
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1206517219543457
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.375814437866211
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 2.50579571723938
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 402636
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.954632520675659
Epoch: 1, Steps: 7 | Train Loss: 2.482 Vali Loss: 2.325 Vali Acc: 0.264 Test Loss: 2.325 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 2.9553427696228027
Epoch: 2, Steps: 7 | Train Loss: 2.034 Vali Loss: 1.669 Vali Acc: 0.694 Test Loss: 1.669 Test Acc: 0.694
Validation loss decreased (-0.263866 --> -0.694428).  Saving model ...
Epoch: 3 cost time: 2.939513921737671
Epoch: 3, Steps: 7 | Train Loss: 1.298 Vali Loss: 1.078 Vali Acc: 0.819 Test Loss: 1.078 Test Acc: 0.819
Validation loss decreased (-0.694428 --> -0.819434).  Saving model ...
Epoch: 4 cost time: 2.9290518760681152
Epoch: 4, Steps: 7 | Train Loss: 0.654 Vali Loss: 0.696 Vali Acc: 0.861 Test Loss: 0.696 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 2.946185350418091
Epoch: 5, Steps: 7 | Train Loss: 0.285 Vali Loss: 0.469 Vali Acc: 0.889 Test Loss: 0.469 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 3.232407808303833
Epoch: 6, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3242640495300293
Epoch: 7, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2416646480560303
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 2.9584193229675293
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 2.9788191318511963
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 3.0272817611694336
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 3.1119024753570557
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 3.386868715286255
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.395754814147949
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3713879585266113
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9300665855407715
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 2.7710962295532227
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 2.803703546524048
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 2.918550491333008
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0161428451538086
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.021249771118164
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.05324649810791
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.756394863128662
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.7203612327575684
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.467979907989502
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.770543336868286
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.17889666557312
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.31962513923645
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 816524
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2223963737487793
Epoch: 1, Steps: 7 | Train Loss: 2.516 Vali Loss: 2.321 Vali Acc: 0.222 Test Loss: 2.321 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 1.1350665092468262
Epoch: 2, Steps: 7 | Train Loss: 2.056 Vali Loss: 1.699 Vali Acc: 0.736 Test Loss: 1.699 Test Acc: 0.736
Validation loss decreased (-0.222199 --> -0.736094).  Saving model ...
Epoch: 3 cost time: 1.9350669384002686
Epoch: 3, Steps: 7 | Train Loss: 1.309 Vali Loss: 1.086 Vali Acc: 0.819 Test Loss: 1.086 Test Acc: 0.819
Validation loss decreased (-0.736094 --> -0.819434).  Saving model ...
Epoch: 4 cost time: 1.877619981765747
Epoch: 4, Steps: 7 | Train Loss: 0.747 Vali Loss: 0.723 Vali Acc: 0.861 Test Loss: 0.723 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 1.854788064956665
Epoch: 5, Steps: 7 | Train Loss: 0.381 Vali Loss: 0.546 Vali Acc: 0.917 Test Loss: 0.546 Test Acc: 0.917
Validation loss decreased (-0.861104 --> -0.916661).  Saving model ...
Epoch: 6 cost time: 1.898247241973877
Epoch: 6, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5848636627197266
Epoch: 7, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.350 Vali Acc: 0.931 Test Loss: 0.350 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 1.8160090446472168
Epoch: 8, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.356 Vali Acc: 0.931 Test Loss: 0.356 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7097644805908203
Epoch: 9, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.6833069324493408
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.6641693115234375
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.725959300994873
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.8837966918945312
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.8305652141571045
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9040236473083496
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8367834091186523
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.789881944656372
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.743830919265747
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.747999668121338
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.603395700454712
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.790842056274414
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.8215742111206055
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.8933992385864258
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8940808773040771
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8705456256866455
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.9238839149475098
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8325552940368652
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7796351909637451
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7610337734222412
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.6244053840637207
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 402636
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7341713905334473
Epoch: 1, Steps: 7 | Train Loss: 2.483 Vali Loss: 2.325 Vali Acc: 0.250 Test Loss: 2.325 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 1.883833408355713
Epoch: 2, Steps: 7 | Train Loss: 2.036 Vali Loss: 1.670 Vali Acc: 0.694 Test Loss: 1.670 Test Acc: 0.694
Validation loss decreased (-0.249977 --> -0.694428).  Saving model ...
Epoch: 3 cost time: 1.8331389427185059
Epoch: 3, Steps: 7 | Train Loss: 1.302 Vali Loss: 1.079 Vali Acc: 0.819 Test Loss: 1.079 Test Acc: 0.819
Validation loss decreased (-0.694428 --> -0.819434).  Saving model ...
Epoch: 4 cost time: 1.874455451965332
Epoch: 4, Steps: 7 | Train Loss: 0.659 Vali Loss: 0.696 Vali Acc: 0.861 Test Loss: 0.696 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 1.9177525043487549
Epoch: 5, Steps: 7 | Train Loss: 0.289 Vali Loss: 0.468 Vali Acc: 0.889 Test Loss: 0.468 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 2.0162816047668457
Epoch: 6, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9059011936187744
Epoch: 7, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.951676845550537
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 1.7491440773010254
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.722442626953125
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.7161738872528076
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.7139499187469482
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 1.926051139831543
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.978593349456787
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9533233642578125
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8040740489959717
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 1.7522461414337158
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 1.8491547107696533
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 1.6404950618743896
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1271984577178955
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.12931227684021
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1175107955932617
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.952944278717041
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9191970825195312
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.0367178916931152
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9998087882995605
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.126629114151001
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.07810640335083
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 816524
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5947771072387695
Epoch: 1, Steps: 7 | Train Loss: 2.516 Vali Loss: 2.321 Vali Acc: 0.222 Test Loss: 2.321 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 1.2570128440856934
Epoch: 2, Steps: 7 | Train Loss: 2.056 Vali Loss: 1.699 Vali Acc: 0.736 Test Loss: 1.699 Test Acc: 0.736
Validation loss decreased (-0.222199 --> -0.736094).  Saving model ...
Epoch: 3 cost time: 1.2682559490203857
Epoch: 3, Steps: 7 | Train Loss: 1.309 Vali Loss: 1.086 Vali Acc: 0.819 Test Loss: 1.086 Test Acc: 0.819
Validation loss decreased (-0.736094 --> -0.819434).  Saving model ...
Epoch: 4 cost time: 1.2806124687194824
Epoch: 4, Steps: 7 | Train Loss: 0.747 Vali Loss: 0.723 Vali Acc: 0.861 Test Loss: 0.723 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 1.254220724105835
Epoch: 5, Steps: 7 | Train Loss: 0.381 Vali Loss: 0.546 Vali Acc: 0.917 Test Loss: 0.546 Test Acc: 0.917
Validation loss decreased (-0.861104 --> -0.916661).  Saving model ...
Epoch: 6 cost time: 1.1683697700500488
Epoch: 6, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2260596752166748
Epoch: 7, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.350 Vali Acc: 0.931 Test Loss: 0.350 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 1.1567542552947998
Epoch: 8, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.356 Vali Acc: 0.931 Test Loss: 0.356 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.217665195465088
Epoch: 9, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.1163184642791748
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.1472115516662598
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.204336404800415
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.219137191772461
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.254885196685791
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2558307647705078
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1062211990356445
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1519923210144043
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1428847312927246
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0616116523742676
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.0328257083892822
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.0522339344024658
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.1614229679107666
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.1682054996490479
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.122178077697754
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1532721519470215
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.0590095520019531
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0179922580718994
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0249905586242676
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.158982753753662
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.057276725769043
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 402636
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.610832691192627
Epoch: 1, Steps: 7 | Train Loss: 2.490 Vali Loss: 2.284 Vali Acc: 0.347 Test Loss: 2.284 Test Acc: 0.347
Validation loss decreased (inf --> -0.347199).  Saving model ...
Epoch: 2 cost time: 2.838033676147461
Epoch: 2, Steps: 7 | Train Loss: 2.024 Vali Loss: 1.706 Vali Acc: 0.694 Test Loss: 1.706 Test Acc: 0.694
Validation loss decreased (-0.347199 --> -0.694427).  Saving model ...
Epoch: 3 cost time: 2.8768742084503174
Epoch: 3, Steps: 7 | Train Loss: 1.327 Vali Loss: 1.128 Vali Acc: 0.847 Test Loss: 1.128 Test Acc: 0.847
Validation loss decreased (-0.694427 --> -0.847211).  Saving model ...
Epoch: 4 cost time: 3.1270580291748047
Epoch: 4, Steps: 7 | Train Loss: 0.700 Vali Loss: 0.725 Vali Acc: 0.903 Test Loss: 0.725 Test Acc: 0.903
Validation loss decreased (-0.847211 --> -0.902771).  Saving model ...
Epoch: 5 cost time: 2.906451940536499
Epoch: 5, Steps: 7 | Train Loss: 0.338 Vali Loss: 0.462 Vali Acc: 0.931 Test Loss: 0.462 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930551).  Saving model ...
Epoch: 6 cost time: 2.833848237991333
Epoch: 6, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.342 Vali Acc: 0.944 Test Loss: 0.342 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944441).  Saving model ...
Epoch: 7 cost time: 2.6559510231018066
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8791794776916504
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.281642436981201
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 3.002302885055542
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 2.9066712856292725
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.972 Test Loss: 0.207 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 12 cost time: 3.022040367126465
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 2.95029616355896
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 14 cost time: 2.7828187942504883
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0227603912353516
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9102542400360107
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.902364730834961
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5815272331237793
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972221).  Saving model ...
Epoch: 19 cost time: 3.174509286880493
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 20 cost time: 2.920868396759033
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 21 cost time: 2.810946226119995
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 22 cost time: 3.029008150100708
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 23 cost time: 3.378127098083496
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 24 cost time: 3.2585155963897705
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 25 cost time: 3.0186827182769775
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 26 cost time: 2.998547315597534
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 27 cost time: 3.118931293487549
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 28 cost time: 3.1642541885375977
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 29 cost time: 2.9190921783447266
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 30 cost time: 2.5068371295928955
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 523468
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.938528537750244
Epoch: 1, Steps: 7 | Train Loss: 2.443 Vali Loss: 2.389 Vali Acc: 0.153 Test Loss: 2.389 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 1.4013657569885254
Epoch: 2, Steps: 7 | Train Loss: 1.996 Vali Loss: 1.810 Vali Acc: 0.569 Test Loss: 1.810 Test Acc: 0.569
Validation loss decreased (-0.152754 --> -0.569426).  Saving model ...
Epoch: 3 cost time: 1.4816110134124756
Epoch: 3, Steps: 7 | Train Loss: 1.296 Vali Loss: 1.190 Vali Acc: 0.833 Test Loss: 1.190 Test Acc: 0.833
Validation loss decreased (-0.569426 --> -0.833321).  Saving model ...
Epoch: 4 cost time: 1.5393245220184326
Epoch: 4, Steps: 7 | Train Loss: 0.688 Vali Loss: 0.758 Vali Acc: 0.861 Test Loss: 0.758 Test Acc: 0.861
Validation loss decreased (-0.833321 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 1.9475691318511963
Epoch: 5, Steps: 7 | Train Loss: 0.340 Vali Loss: 0.531 Vali Acc: 0.875 Test Loss: 0.531 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 1.7991917133331299
Epoch: 6, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7571568489074707
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 1.6624245643615723
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 1.742196798324585
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 1.6419677734375
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.6843233108520508
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7510666847229004
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.8961622714996338
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7159368991851807
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7365450859069824
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6860864162445068
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6650407314300537
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.6908254623413086
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.8434669971466064
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.37837553024292
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.614945411682129
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4527170658111572
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.468825340270996
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.515733003616333
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.521113634109497
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.511329174041748
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.6293070316314697
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.486074686050415
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.37711501121521
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4183828830718994
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 316492
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8115053176879883
Epoch: 1, Steps: 7 | Train Loss: 2.490 Vali Loss: 2.285 Vali Acc: 0.347 Test Loss: 2.285 Test Acc: 0.347
Validation loss decreased (inf --> -0.347199).  Saving model ...
Epoch: 2 cost time: 2.296367883682251
Epoch: 2, Steps: 7 | Train Loss: 2.024 Vali Loss: 1.707 Vali Acc: 0.694 Test Loss: 1.707 Test Acc: 0.694
Validation loss decreased (-0.347199 --> -0.694427).  Saving model ...
Epoch: 3 cost time: 2.289092540740967
Epoch: 3, Steps: 7 | Train Loss: 1.327 Vali Loss: 1.128 Vali Acc: 0.847 Test Loss: 1.128 Test Acc: 0.847
Validation loss decreased (-0.694427 --> -0.847211).  Saving model ...
Epoch: 4 cost time: 2.459643840789795
Epoch: 4, Steps: 7 | Train Loss: 0.700 Vali Loss: 0.725 Vali Acc: 0.903 Test Loss: 0.725 Test Acc: 0.903
Validation loss decreased (-0.847211 --> -0.902771).  Saving model ...
Epoch: 5 cost time: 2.506709337234497
Epoch: 5, Steps: 7 | Train Loss: 0.338 Vali Loss: 0.462 Vali Acc: 0.931 Test Loss: 0.462 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930551).  Saving model ...
Epoch: 6 cost time: 2.5288822650909424
Epoch: 6, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.342 Vali Acc: 0.944 Test Loss: 0.342 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944441).  Saving model ...
Epoch: 7 cost time: 2.4331071376800537
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2034997940063477
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.359520196914673
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 2.4429798126220703
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 2.632167100906372
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.972 Test Loss: 0.207 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 12 cost time: 2.212482213973999
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 2.07439923286438
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 14 cost time: 1.9723927974700928
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0798394680023193
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.17635178565979
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.207872152328491
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0658650398254395
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972221).  Saving model ...
Epoch: 19 cost time: 2.0327999591827393
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 20 cost time: 2.075643301010132
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 21 cost time: 1.9126529693603516
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 22 cost time: 2.287693738937378
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 23 cost time: 2.574805498123169
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 24 cost time: 2.3450193405151367
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 25 cost time: 2.3229877948760986
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 26 cost time: 2.311964988708496
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 27 cost time: 2.325190305709839
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 28 cost time: 2.5213780403137207
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 29 cost time: 2.594972610473633
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 30 cost time: 2.3718271255493164
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 523468
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.9393839836120605
Epoch: 1, Steps: 7 | Train Loss: 2.443 Vali Loss: 2.388 Vali Acc: 0.153 Test Loss: 2.388 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 1.3227710723876953
Epoch: 2, Steps: 7 | Train Loss: 1.996 Vali Loss: 1.810 Vali Acc: 0.569 Test Loss: 1.810 Test Acc: 0.569
Validation loss decreased (-0.152754 --> -0.569426).  Saving model ...
Epoch: 3 cost time: 1.2467472553253174
Epoch: 3, Steps: 7 | Train Loss: 1.296 Vali Loss: 1.190 Vali Acc: 0.833 Test Loss: 1.190 Test Acc: 0.833
Validation loss decreased (-0.569426 --> -0.833321).  Saving model ...
Epoch: 4 cost time: 1.2263824939727783
Epoch: 4, Steps: 7 | Train Loss: 0.688 Vali Loss: 0.757 Vali Acc: 0.861 Test Loss: 0.757 Test Acc: 0.861
Validation loss decreased (-0.833321 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 1.2845537662506104
Epoch: 5, Steps: 7 | Train Loss: 0.340 Vali Loss: 0.531 Vali Acc: 0.875 Test Loss: 0.531 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 1.2794549465179443
Epoch: 6, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3413004875183105
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 1.3683066368103027
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 1.307558536529541
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 1.1523990631103516
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.2298576831817627
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2216572761535645
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.2292520999908447
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1618177890777588
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.372455358505249
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.399942398071289
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4428858757019043
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.3503966331481934
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.3200688362121582
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.3888802528381348
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4284701347351074
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3964073657989502
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5111167430877686
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4627556800842285
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4472768306732178
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3358547687530518
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.3179621696472168
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.3077573776245117
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.4175019264221191
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.359011173248291
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 316492
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8310844898223877
Epoch: 1, Steps: 7 | Train Loss: 2.490 Vali Loss: 2.285 Vali Acc: 0.347 Test Loss: 2.285 Test Acc: 0.347
Validation loss decreased (inf --> -0.347199).  Saving model ...
Epoch: 2 cost time: 1.3590176105499268
Epoch: 2, Steps: 7 | Train Loss: 2.023 Vali Loss: 1.707 Vali Acc: 0.694 Test Loss: 1.707 Test Acc: 0.694
Validation loss decreased (-0.347199 --> -0.694427).  Saving model ...
Epoch: 3 cost time: 1.4963054656982422
Epoch: 3, Steps: 7 | Train Loss: 1.327 Vali Loss: 1.128 Vali Acc: 0.847 Test Loss: 1.128 Test Acc: 0.847
Validation loss decreased (-0.694427 --> -0.847211).  Saving model ...
Epoch: 4 cost time: 1.4871056079864502
Epoch: 4, Steps: 7 | Train Loss: 0.700 Vali Loss: 0.725 Vali Acc: 0.903 Test Loss: 0.725 Test Acc: 0.903
Validation loss decreased (-0.847211 --> -0.902771).  Saving model ...
Epoch: 5 cost time: 1.4785120487213135
Epoch: 5, Steps: 7 | Train Loss: 0.338 Vali Loss: 0.462 Vali Acc: 0.931 Test Loss: 0.462 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930551).  Saving model ...
Epoch: 6 cost time: 1.3911793231964111
Epoch: 6, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.342 Vali Acc: 0.944 Test Loss: 0.342 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944441).  Saving model ...
Epoch: 7 cost time: 1.384077548980713
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3762552738189697
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3899047374725342
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.301619291305542
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 1.250969648361206
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.972 Test Loss: 0.207 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 12 cost time: 1.4465584754943848
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 1.4776496887207031
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 14 cost time: 1.4583523273468018
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4532995223999023
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6032533645629883
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7983503341674805
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7095861434936523
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972221).  Saving model ...
Epoch: 19 cost time: 1.7735085487365723
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 20 cost time: 1.5788543224334717
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 21 cost time: 1.6262845993041992
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 22 cost time: 1.5374212265014648
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 23 cost time: 1.5870800018310547
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 24 cost time: 1.5994105339050293
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 25 cost time: 1.740640640258789
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 26 cost time: 1.694197654724121
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 27 cost time: 1.667177438735962
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 28 cost time: 1.2077126502990723
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 29 cost time: 1.4505271911621094
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 30 cost time: 1.4108777046203613
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 523468
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3061583042144775
Epoch: 1, Steps: 7 | Train Loss: 2.445 Vali Loss: 2.387 Vali Acc: 0.153 Test Loss: 2.387 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.956378698348999
Epoch: 2, Steps: 7 | Train Loss: 1.994 Vali Loss: 1.807 Vali Acc: 0.597 Test Loss: 1.807 Test Acc: 0.597
Validation loss decreased (-0.152754 --> -0.597204).  Saving model ...
Epoch: 3 cost time: 1.0324602127075195
Epoch: 3, Steps: 7 | Train Loss: 1.294 Vali Loss: 1.186 Vali Acc: 0.833 Test Loss: 1.186 Test Acc: 0.833
Validation loss decreased (-0.597204 --> -0.833321).  Saving model ...
Epoch: 4 cost time: 0.9867463111877441
Epoch: 4, Steps: 7 | Train Loss: 0.686 Vali Loss: 0.754 Vali Acc: 0.861 Test Loss: 0.754 Test Acc: 0.861
Validation loss decreased (-0.833321 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 0.9799399375915527
Epoch: 5, Steps: 7 | Train Loss: 0.339 Vali Loss: 0.528 Vali Acc: 0.875 Test Loss: 0.528 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 0.913006067276001
Epoch: 6, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.418 Vali Acc: 0.861 Test Loss: 0.418 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.029674768447876
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.9956092834472656
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 1.0449209213256836
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 1.0246357917785645
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.1075921058654785
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.0911200046539307
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 1.1216673851013184
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1230263710021973
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0634357929229736
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 1.0172643661499023
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.0244317054748535
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.012660264968872
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.0350966453552246
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.0219507217407227
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.1298315525054932
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1263706684112549
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1618800163269043
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0970649719238281
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0886054039001465
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.9966080188751221
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.025118350982666
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.9757895469665527
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.0564472675323486
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0232939720153809
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 316492
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.456330299377441
Epoch: 1, Steps: 7 | Train Loss: 2.529 Vali Loss: 2.446 Vali Acc: 0.125 Test Loss: 2.446 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 3.5838675498962402
Epoch: 2, Steps: 7 | Train Loss: 2.262 Vali Loss: 2.080 Vali Acc: 0.319 Test Loss: 2.080 Test Acc: 0.319
Validation loss decreased (-0.124976 --> -0.319424).  Saving model ...
Epoch: 3 cost time: 3.492847204208374
Epoch: 3, Steps: 7 | Train Loss: 1.804 Vali Loss: 1.672 Vali Acc: 0.653 Test Loss: 1.672 Test Acc: 0.653
Validation loss decreased (-0.319424 --> -0.652761).  Saving model ...
Epoch: 4 cost time: 4.371177673339844
Epoch: 4, Steps: 7 | Train Loss: 1.342 Vali Loss: 1.285 Vali Acc: 0.708 Test Loss: 1.285 Test Acc: 0.708
Validation loss decreased (-0.652761 --> -0.708320).  Saving model ...
Epoch: 5 cost time: 4.345548391342163
Epoch: 5, Steps: 7 | Train Loss: 0.861 Vali Loss: 0.986 Vali Acc: 0.806 Test Loss: 0.986 Test Acc: 0.806
Validation loss decreased (-0.708320 --> -0.805546).  Saving model ...
Epoch: 6 cost time: 3.9527909755706787
Epoch: 6, Steps: 7 | Train Loss: 0.532 Vali Loss: 0.765 Vali Acc: 0.833 Test Loss: 0.765 Test Acc: 0.833
Validation loss decreased (-0.805546 --> -0.833326).  Saving model ...
Epoch: 7 cost time: 4.010882377624512
Epoch: 7, Steps: 7 | Train Loss: 0.321 Vali Loss: 0.620 Vali Acc: 0.847 Test Loss: 0.620 Test Acc: 0.847
Validation loss decreased (-0.833326 --> -0.847216).  Saving model ...
Epoch: 8 cost time: 4.1201887130737305
Epoch: 8, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.523 Vali Acc: 0.861 Test Loss: 0.523 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 4.431308031082153
Epoch: 9, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874995).  Saving model ...
Epoch: 10 cost time: 4.103309392929077
Epoch: 10, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.405 Vali Acc: 0.889 Test Loss: 0.405 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 4.071793794631958
Epoch: 11, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 4.152748346328735
Epoch: 12, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.1301047801971436
Epoch: 13, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 3.77654767036438
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 3.676889419555664
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 3.666375160217285
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 3.8373231887817383
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 3.6687209606170654
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5823562145233154
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 3.6698639392852783
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6810827255249023
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.9809091091156006
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.0086541175842285
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 24 cost time: 4.10364842414856
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.423475980758667
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 4.095379590988159
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 27 cost time: 3.9957849979400635
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 28 cost time: 4.285817623138428
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 29 cost time: 4.460161924362183
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 30 cost time: 4.204561471939087
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 701708
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.449669599533081
Epoch: 1, Steps: 7 | Train Loss: 2.434 Vali Loss: 2.369 Vali Acc: 0.153 Test Loss: 2.369 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 1.8278424739837646
Epoch: 2, Steps: 7 | Train Loss: 2.168 Vali Loss: 1.986 Vali Acc: 0.625 Test Loss: 1.986 Test Acc: 0.625
Validation loss decreased (-0.152754 --> -0.624980).  Saving model ...
Epoch: 3 cost time: 1.8721797466278076
Epoch: 3, Steps: 7 | Train Loss: 1.676 Vali Loss: 1.557 Vali Acc: 0.819 Test Loss: 1.557 Test Acc: 0.819
Validation loss decreased (-0.624980 --> -0.819429).  Saving model ...
Epoch: 4 cost time: 2.009326219558716
Epoch: 4, Steps: 7 | Train Loss: 1.231 Vali Loss: 1.179 Vali Acc: 0.889 Test Loss: 1.179 Test Acc: 0.889
Validation loss decreased (-0.819429 --> -0.888877).  Saving model ...
Epoch: 5 cost time: 2.048784017562866
Epoch: 5, Steps: 7 | Train Loss: 0.780 Vali Loss: 0.898 Vali Acc: 0.903 Test Loss: 0.898 Test Acc: 0.903
Validation loss decreased (-0.888877 --> -0.902769).  Saving model ...
Epoch: 6 cost time: 1.8054733276367188
Epoch: 6, Steps: 7 | Train Loss: 0.506 Vali Loss: 0.679 Vali Acc: 0.903 Test Loss: 0.679 Test Acc: 0.903
Validation loss decreased (-0.902769 --> -0.902771).  Saving model ...
Epoch: 7 cost time: 1.8467464447021484
Epoch: 7, Steps: 7 | Train Loss: 0.293 Vali Loss: 0.498 Vali Acc: 0.944 Test Loss: 0.498 Test Acc: 0.944
Validation loss decreased (-0.902771 --> -0.944439).  Saving model ...
Epoch: 8 cost time: 1.8385064601898193
Epoch: 8, Steps: 7 | Train Loss: 0.174 Vali Loss: 0.396 Vali Acc: 0.944 Test Loss: 0.396 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 9 cost time: 2.1123547554016113
Epoch: 9, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.359 Vali Acc: 0.944 Test Loss: 0.359 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 10 cost time: 2.3083856105804443
Epoch: 10, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.331 Vali Acc: 0.944 Test Loss: 0.331 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 2.415658950805664
Epoch: 11, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.303 Vali Acc: 0.944 Test Loss: 0.303 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 2.1920619010925293
Epoch: 12, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 2.09440016746521
Epoch: 13, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 2.1793346405029297
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 2.2560524940490723
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 2.3428568840026855
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 2.2930469512939453
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 2.299323797225952
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.193875551223755
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.128129720687866
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.166887044906616
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.4663329124450684
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.094252824783325
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1431963443756104
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 2.0190258026123047
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.9695184230804443
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 2.1246566772460938
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 2.05757999420166
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.988706350326538
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.8425841331481934
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 287724
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.9303741455078125
Epoch: 1, Steps: 7 | Train Loss: 2.530 Vali Loss: 2.444 Vali Acc: 0.125 Test Loss: 2.444 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 3.179309368133545
Epoch: 2, Steps: 7 | Train Loss: 2.262 Vali Loss: 2.079 Vali Acc: 0.319 Test Loss: 2.079 Test Acc: 0.319
Validation loss decreased (-0.124976 --> -0.319424).  Saving model ...
Epoch: 3 cost time: 3.310530424118042
Epoch: 3, Steps: 7 | Train Loss: 1.804 Vali Loss: 1.671 Vali Acc: 0.653 Test Loss: 1.671 Test Acc: 0.653
Validation loss decreased (-0.319424 --> -0.652761).  Saving model ...
Epoch: 4 cost time: 3.4748106002807617
Epoch: 4, Steps: 7 | Train Loss: 1.340 Vali Loss: 1.284 Vali Acc: 0.708 Test Loss: 1.284 Test Acc: 0.708
Validation loss decreased (-0.652761 --> -0.708320).  Saving model ...
Epoch: 5 cost time: 3.182882785797119
Epoch: 5, Steps: 7 | Train Loss: 0.861 Vali Loss: 0.985 Vali Acc: 0.806 Test Loss: 0.985 Test Acc: 0.806
Validation loss decreased (-0.708320 --> -0.805546).  Saving model ...
Epoch: 6 cost time: 3.2798917293548584
Epoch: 6, Steps: 7 | Train Loss: 0.531 Vali Loss: 0.761 Vali Acc: 0.833 Test Loss: 0.761 Test Acc: 0.833
Validation loss decreased (-0.805546 --> -0.833326).  Saving model ...
Epoch: 7 cost time: 3.279165506362915
Epoch: 7, Steps: 7 | Train Loss: 0.321 Vali Loss: 0.616 Vali Acc: 0.847 Test Loss: 0.616 Test Acc: 0.847
Validation loss decreased (-0.833326 --> -0.847216).  Saving model ...
Epoch: 8 cost time: 3.4151318073272705
Epoch: 8, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 2.8152902126312256
Epoch: 9, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874995).  Saving model ...
Epoch: 10 cost time: 2.804276943206787
Epoch: 10, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 2.9470927715301514
Epoch: 11, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 3.117765188217163
Epoch: 12, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6425745487213135
Epoch: 13, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 2.799363851547241
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 3.0072519779205322
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 2.8116157054901123
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 2.6973679065704346
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 3.277273654937744
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4149534702301025
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 3.296180248260498
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1946208477020264
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3672614097595215
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.430304527282715
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 24 cost time: 3.281500816345215
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.2204599380493164
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 3.3409230709075928
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 27 cost time: 3.0499165058135986
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9879868030548096
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 29 cost time: 2.9247548580169678
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 30 cost time: 3.1242618560791016
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 701708
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.9683327674865723
Epoch: 1, Steps: 7 | Train Loss: 2.434 Vali Loss: 2.367 Vali Acc: 0.153 Test Loss: 2.367 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 1.6498146057128906
Epoch: 2, Steps: 7 | Train Loss: 2.168 Vali Loss: 1.985 Vali Acc: 0.625 Test Loss: 1.985 Test Acc: 0.625
Validation loss decreased (-0.152754 --> -0.624980).  Saving model ...
Epoch: 3 cost time: 1.6795432567596436
Epoch: 3, Steps: 7 | Train Loss: 1.676 Vali Loss: 1.557 Vali Acc: 0.819 Test Loss: 1.557 Test Acc: 0.819
Validation loss decreased (-0.624980 --> -0.819429).  Saving model ...
Epoch: 4 cost time: 1.756321907043457
Epoch: 4, Steps: 7 | Train Loss: 1.231 Vali Loss: 1.179 Vali Acc: 0.889 Test Loss: 1.179 Test Acc: 0.889
Validation loss decreased (-0.819429 --> -0.888877).  Saving model ...
Epoch: 5 cost time: 1.677818775177002
Epoch: 5, Steps: 7 | Train Loss: 0.780 Vali Loss: 0.897 Vali Acc: 0.903 Test Loss: 0.897 Test Acc: 0.903
Validation loss decreased (-0.888877 --> -0.902769).  Saving model ...
Epoch: 6 cost time: 1.8399920463562012
Epoch: 6, Steps: 7 | Train Loss: 0.506 Vali Loss: 0.678 Vali Acc: 0.903 Test Loss: 0.678 Test Acc: 0.903
Validation loss decreased (-0.902769 --> -0.902771).  Saving model ...
Epoch: 7 cost time: 1.765986442565918
Epoch: 7, Steps: 7 | Train Loss: 0.293 Vali Loss: 0.498 Vali Acc: 0.944 Test Loss: 0.498 Test Acc: 0.944
Validation loss decreased (-0.902771 --> -0.944439).  Saving model ...
Epoch: 8 cost time: 1.7629754543304443
Epoch: 8, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.398 Vali Acc: 0.944 Test Loss: 0.398 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 9 cost time: 1.757131814956665
Epoch: 9, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.361 Vali Acc: 0.944 Test Loss: 0.361 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 10 cost time: 1.6372768878936768
Epoch: 10, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.331 Vali Acc: 0.944 Test Loss: 0.331 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 1.7486457824707031
Epoch: 11, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 1.743847370147705
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.7283947467803955
Epoch: 13, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.6916110515594482
Epoch: 14, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.6523034572601318
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.7056009769439697
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.6725916862487793
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.5104143619537354
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.529543399810791
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5301597118377686
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.445793628692627
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.5595335960388184
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5193736553192139
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3697514533996582
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 1.5601692199707031
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 1.4441633224487305
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 1.5186057090759277
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6399314403533936
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5086884498596191
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7966620922088623
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 287724
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.588787317276001
Epoch: 1, Steps: 7 | Train Loss: 2.528 Vali Loss: 2.446 Vali Acc: 0.125 Test Loss: 2.446 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 2.1570122241973877
Epoch: 2, Steps: 7 | Train Loss: 2.264 Vali Loss: 2.082 Vali Acc: 0.333 Test Loss: 2.082 Test Acc: 0.333
Validation loss decreased (-0.124976 --> -0.333313).  Saving model ...
Epoch: 3 cost time: 2.0561413764953613
Epoch: 3, Steps: 7 | Train Loss: 1.810 Vali Loss: 1.678 Vali Acc: 0.611 Test Loss: 1.678 Test Acc: 0.611
Validation loss decreased (-0.333313 --> -0.611094).  Saving model ...
Epoch: 4 cost time: 2.0432240962982178
Epoch: 4, Steps: 7 | Train Loss: 1.350 Vali Loss: 1.296 Vali Acc: 0.694 Test Loss: 1.296 Test Acc: 0.694
Validation loss decreased (-0.611094 --> -0.694431).  Saving model ...
Epoch: 5 cost time: 2.0822274684906006
Epoch: 5, Steps: 7 | Train Loss: 0.879 Vali Loss: 1.000 Vali Acc: 0.806 Test Loss: 1.000 Test Acc: 0.806
Validation loss decreased (-0.694431 --> -0.805546).  Saving model ...
Epoch: 6 cost time: 2.062706708908081
Epoch: 6, Steps: 7 | Train Loss: 0.550 Vali Loss: 0.781 Vali Acc: 0.861 Test Loss: 0.781 Test Acc: 0.861
Validation loss decreased (-0.805546 --> -0.861103).  Saving model ...
Epoch: 7 cost time: 2.1590676307678223
Epoch: 7, Steps: 7 | Train Loss: 0.341 Vali Loss: 0.636 Vali Acc: 0.861 Test Loss: 0.636 Test Acc: 0.861
Validation loss decreased (-0.861103 --> -0.861105).  Saving model ...
Epoch: 8 cost time: 2.241961717605591
Epoch: 8, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.542 Vali Acc: 0.861 Test Loss: 0.542 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 1.6507761478424072
Epoch: 9, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.483 Vali Acc: 0.861 Test Loss: 0.483 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 10 cost time: 1.8488612174987793
Epoch: 10, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 1.868445873260498
Epoch: 11, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 1.8824079036712646
Epoch: 12, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.399 Vali Acc: 0.861 Test Loss: 0.399 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9298427104949951
Epoch: 13, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9133994579315186
Epoch: 14, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7161600589752197
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.824965476989746
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8710191249847412
Epoch: 17, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 1.8240222930908203
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7728800773620605
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8467068672180176
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.034374952316284
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.028620958328247
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2087481021881104
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.089984655380249
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.0157766342163086
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 26 cost time: 1.9680819511413574
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 27 cost time: 2.0312795639038086
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 28 cost time: 2.184549570083618
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 29 cost time: 2.161395788192749
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 30 cost time: 1.9809505939483643
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 701708
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4790308475494385
Epoch: 1, Steps: 7 | Train Loss: 2.428 Vali Loss: 2.358 Vali Acc: 0.167 Test Loss: 2.358 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 1.0845398902893066
Epoch: 2, Steps: 7 | Train Loss: 2.160 Vali Loss: 1.974 Vali Acc: 0.667 Test Loss: 1.974 Test Acc: 0.667
Validation loss decreased (-0.166643 --> -0.666647).  Saving model ...
Epoch: 3 cost time: 1.1177263259887695
Epoch: 3, Steps: 7 | Train Loss: 1.672 Vali Loss: 1.549 Vali Acc: 0.847 Test Loss: 1.549 Test Acc: 0.847
Validation loss decreased (-0.666647 --> -0.847207).  Saving model ...
Epoch: 4 cost time: 1.1479642391204834
Epoch: 4, Steps: 7 | Train Loss: 1.231 Vali Loss: 1.178 Vali Acc: 0.875 Test Loss: 1.178 Test Acc: 0.875
Validation loss decreased (-0.847207 --> -0.874988).  Saving model ...
Epoch: 5 cost time: 1.1607043743133545
Epoch: 5, Steps: 7 | Train Loss: 0.786 Vali Loss: 0.903 Vali Acc: 0.917 Test Loss: 0.903 Test Acc: 0.917
Validation loss decreased (-0.874988 --> -0.916658).  Saving model ...
Epoch: 6 cost time: 1.1842002868652344
Epoch: 6, Steps: 7 | Train Loss: 0.513 Vali Loss: 0.688 Vali Acc: 0.917 Test Loss: 0.688 Test Acc: 0.917
Validation loss decreased (-0.916658 --> -0.916660).  Saving model ...
Epoch: 7 cost time: 1.1394150257110596
Epoch: 7, Steps: 7 | Train Loss: 0.300 Vali Loss: 0.508 Vali Acc: 0.944 Test Loss: 0.508 Test Acc: 0.944
Validation loss decreased (-0.916660 --> -0.944439).  Saving model ...
Epoch: 8 cost time: 1.193211555480957
Epoch: 8, Steps: 7 | Train Loss: 0.179 Vali Loss: 0.411 Vali Acc: 0.944 Test Loss: 0.411 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 9 cost time: 1.1971826553344727
Epoch: 9, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.372 Vali Acc: 0.944 Test Loss: 0.372 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 10 cost time: 1.1087534427642822
Epoch: 10, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.342 Vali Acc: 0.944 Test Loss: 0.342 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 0.9132449626922607
Epoch: 11, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.314 Vali Acc: 0.944 Test Loss: 0.314 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 1.302445888519287
Epoch: 12, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3356373310089111
Epoch: 13, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2908070087432861
Epoch: 14, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.342637300491333
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2413885593414307
Epoch: 16, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2450315952301025
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3235695362091064
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2875421047210693
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.246872901916504
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3053040504455566
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 287724
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8273282051086426
Epoch: 1, Steps: 7 | Train Loss: 2.418 Vali Loss: 2.372 Vali Acc: 0.236 Test Loss: 2.372 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 2.520474672317505
Epoch: 2, Steps: 7 | Train Loss: 2.220 Vali Loss: 2.039 Vali Acc: 0.611 Test Loss: 2.039 Test Acc: 0.611
Validation loss decreased (-0.236087 --> -0.611091).  Saving model ...
Epoch: 3 cost time: 2.5297350883483887
Epoch: 3, Steps: 7 | Train Loss: 1.786 Vali Loss: 1.655 Vali Acc: 0.792 Test Loss: 1.655 Test Acc: 0.792
Validation loss decreased (-0.611091 --> -0.791650).  Saving model ...
Epoch: 4 cost time: 2.6052379608154297
Epoch: 4, Steps: 7 | Train Loss: 1.360 Vali Loss: 1.280 Vali Acc: 0.847 Test Loss: 1.280 Test Acc: 0.847
Validation loss decreased (-0.791650 --> -0.847209).  Saving model ...
Epoch: 5 cost time: 2.4987123012542725
Epoch: 5, Steps: 7 | Train Loss: 0.965 Vali Loss: 0.967 Vali Acc: 0.861 Test Loss: 0.967 Test Acc: 0.861
Validation loss decreased (-0.847209 --> -0.861101).  Saving model ...
Epoch: 6 cost time: 2.1551198959350586
Epoch: 6, Steps: 7 | Train Loss: 0.609 Vali Loss: 0.734 Vali Acc: 0.861 Test Loss: 0.734 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861104).  Saving model ...
Epoch: 7 cost time: 2.3558244705200195
Epoch: 7, Steps: 7 | Train Loss: 0.399 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 8 cost time: 2.5269644260406494
Epoch: 8, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 2.525862216949463
Epoch: 9, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.385 Vali Acc: 0.889 Test Loss: 0.385 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 2.3181378841400146
Epoch: 10, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 2.72692608833313
Epoch: 11, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.762178659439087
Epoch: 12, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.8460893630981445
Epoch: 13, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.867473840713501
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 2.8305249214172363
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7917604446411133
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7866756916046143
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 2.941042423248291
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.796640157699585
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.752519130706787
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.8404338359832764
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 2.726423501968384
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.386093854904175
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 2.278916358947754
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 2.234294891357422
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 2.341045618057251
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 3.2716476917266846
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 3.1174099445343018
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 3.1398394107818604
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 3.0885467529296875
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 408460
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.381150484085083
Epoch: 1, Steps: 7 | Train Loss: 2.497 Vali Loss: 2.484 Vali Acc: 0.097 Test Loss: 2.484 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 1.7142610549926758
Epoch: 2, Steps: 7 | Train Loss: 2.257 Vali Loss: 2.120 Vali Acc: 0.514 Test Loss: 2.120 Test Acc: 0.514
Validation loss decreased (-0.097197 --> -0.513868).  Saving model ...
Epoch: 3 cost time: 1.7309482097625732
Epoch: 3, Steps: 7 | Train Loss: 1.833 Vali Loss: 1.681 Vali Acc: 0.667 Test Loss: 1.681 Test Acc: 0.667
Validation loss decreased (-0.513868 --> -0.666650).  Saving model ...
Epoch: 4 cost time: 1.9115080833435059
Epoch: 4, Steps: 7 | Train Loss: 1.338 Vali Loss: 1.290 Vali Acc: 0.833 Test Loss: 1.290 Test Acc: 0.833
Validation loss decreased (-0.666650 --> -0.833320).  Saving model ...
Epoch: 5 cost time: 1.9016404151916504
Epoch: 5, Steps: 7 | Train Loss: 0.920 Vali Loss: 0.960 Vali Acc: 0.903 Test Loss: 0.960 Test Acc: 0.903
Validation loss decreased (-0.833320 --> -0.902768).  Saving model ...
Epoch: 6 cost time: 1.9675774574279785
Epoch: 6, Steps: 7 | Train Loss: 0.609 Vali Loss: 0.738 Vali Acc: 0.931 Test Loss: 0.738 Test Acc: 0.931
Validation loss decreased (-0.902768 --> -0.930548).  Saving model ...
Epoch: 7 cost time: 1.9548194408416748
Epoch: 7, Steps: 7 | Train Loss: 0.367 Vali Loss: 0.559 Vali Acc: 0.931 Test Loss: 0.559 Test Acc: 0.931
Validation loss decreased (-0.930548 --> -0.930550).  Saving model ...
Epoch: 8 cost time: 1.8583662509918213
Epoch: 8, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.450 Vali Acc: 0.944 Test Loss: 0.450 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944440).  Saving model ...
Epoch: 9 cost time: 1.9720885753631592
Epoch: 9, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.398 Vali Acc: 0.931 Test Loss: 0.398 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9484844207763672
Epoch: 10, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.356 Vali Acc: 0.944 Test Loss: 0.356 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 1.8834145069122314
Epoch: 11, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.324 Vali Acc: 0.944 Test Loss: 0.324 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 1.7554676532745361
Epoch: 12, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 1.8180711269378662
Epoch: 13, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.838357925415039
Epoch: 14, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.8190958499908447
Epoch: 15, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.274 Vali Acc: 0.958 Test Loss: 0.274 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7501189708709717
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8290681838989258
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6065382957458496
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8037314414978027
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9355506896972656
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9635319709777832
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.8082847595214844
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.8666291236877441
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 1.7235667705535889
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 1.6325318813323975
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 1.5056309700012207
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5584263801574707
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6039681434631348
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5026884078979492
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5044140815734863
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 201452
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.174487590789795
Epoch: 1, Steps: 7 | Train Loss: 2.418 Vali Loss: 2.372 Vali Acc: 0.236 Test Loss: 2.372 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 2.499349594116211
Epoch: 2, Steps: 7 | Train Loss: 2.220 Vali Loss: 2.039 Vali Acc: 0.611 Test Loss: 2.039 Test Acc: 0.611
Validation loss decreased (-0.236087 --> -0.611091).  Saving model ...
Epoch: 3 cost time: 2.548935651779175
Epoch: 3, Steps: 7 | Train Loss: 1.786 Vali Loss: 1.655 Vali Acc: 0.792 Test Loss: 1.655 Test Acc: 0.792
Validation loss decreased (-0.611091 --> -0.791650).  Saving model ...
Epoch: 4 cost time: 1.743455410003662
Epoch: 4, Steps: 7 | Train Loss: 1.360 Vali Loss: 1.280 Vali Acc: 0.847 Test Loss: 1.280 Test Acc: 0.847
Validation loss decreased (-0.791650 --> -0.847209).  Saving model ...
Epoch: 5 cost time: 1.737591028213501
Epoch: 5, Steps: 7 | Train Loss: 0.965 Vali Loss: 0.967 Vali Acc: 0.861 Test Loss: 0.967 Test Acc: 0.861
Validation loss decreased (-0.847209 --> -0.861101).  Saving model ...
Epoch: 6 cost time: 1.5193917751312256
Epoch: 6, Steps: 7 | Train Loss: 0.609 Vali Loss: 0.734 Vali Acc: 0.861 Test Loss: 0.734 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861104).  Saving model ...
Epoch: 7 cost time: 1.7608540058135986
Epoch: 7, Steps: 7 | Train Loss: 0.399 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 8 cost time: 1.7925772666931152
Epoch: 8, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 2.8184897899627686
Epoch: 9, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.385 Vali Acc: 0.889 Test Loss: 0.385 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 2.8385961055755615
Epoch: 10, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 2.8347458839416504
Epoch: 11, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9327890872955322
Epoch: 12, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 2.8946094512939453
Epoch: 13, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.9085886478424072
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 2.6621787548065186
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6664135456085205
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5921809673309326
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 2.663620710372925
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.5935416221618652
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.8323802947998047
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.9152355194091797
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 2.883262872695923
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.574596405029297
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 2.5823771953582764
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 2.6546688079833984
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 2.479607105255127
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 2.319756031036377
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 2.474479913711548
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 2.4699459075927734
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 2.4706544876098633
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 408460
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.211261510848999
Epoch: 1, Steps: 7 | Train Loss: 2.497 Vali Loss: 2.484 Vali Acc: 0.097 Test Loss: 2.484 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 1.7143535614013672
Epoch: 2, Steps: 7 | Train Loss: 2.257 Vali Loss: 2.120 Vali Acc: 0.514 Test Loss: 2.120 Test Acc: 0.514
Validation loss decreased (-0.097197 --> -0.513868).  Saving model ...
Epoch: 3 cost time: 1.6629114151000977
Epoch: 3, Steps: 7 | Train Loss: 1.833 Vali Loss: 1.681 Vali Acc: 0.667 Test Loss: 1.681 Test Acc: 0.667
Validation loss decreased (-0.513868 --> -0.666650).  Saving model ...
Epoch: 4 cost time: 1.7072396278381348
Epoch: 4, Steps: 7 | Train Loss: 1.338 Vali Loss: 1.290 Vali Acc: 0.833 Test Loss: 1.290 Test Acc: 0.833
Validation loss decreased (-0.666650 --> -0.833320).  Saving model ...
Epoch: 5 cost time: 1.639120101928711
Epoch: 5, Steps: 7 | Train Loss: 0.920 Vali Loss: 0.960 Vali Acc: 0.903 Test Loss: 0.960 Test Acc: 0.903
Validation loss decreased (-0.833320 --> -0.902768).  Saving model ...
Epoch: 6 cost time: 1.7294368743896484
Epoch: 6, Steps: 7 | Train Loss: 0.609 Vali Loss: 0.738 Vali Acc: 0.931 Test Loss: 0.738 Test Acc: 0.931
Validation loss decreased (-0.902768 --> -0.930548).  Saving model ...
Epoch: 7 cost time: 1.5768635272979736
Epoch: 7, Steps: 7 | Train Loss: 0.367 Vali Loss: 0.559 Vali Acc: 0.931 Test Loss: 0.559 Test Acc: 0.931
Validation loss decreased (-0.930548 --> -0.930550).  Saving model ...
Epoch: 8 cost time: 1.814190149307251
Epoch: 8, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.450 Vali Acc: 0.944 Test Loss: 0.450 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944440).  Saving model ...
Epoch: 9 cost time: 1.5648109912872314
Epoch: 9, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.398 Vali Acc: 0.931 Test Loss: 0.398 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6040008068084717
Epoch: 10, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.356 Vali Acc: 0.944 Test Loss: 0.356 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 1.5739474296569824
Epoch: 11, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.325 Vali Acc: 0.944 Test Loss: 0.325 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 1.548896074295044
Epoch: 12, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 1.6884450912475586
Epoch: 13, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.7298905849456787
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.272 Vali Acc: 0.958 Test Loss: 0.272 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.7111904621124268
Epoch: 15, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.274 Vali Acc: 0.958 Test Loss: 0.274 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.693772792816162
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6912400722503662
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.750333547592163
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6618266105651855
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6697092056274414
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6298902034759521
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.580733299255371
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.4806342124938965
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 1.4589040279388428
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 1.422879934310913
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 1.4011061191558838
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3996212482452393
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3682010173797607
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5903675556182861
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5320348739624023
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 201452
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.28678297996521
Epoch: 1, Steps: 7 | Train Loss: 2.415 Vali Loss: 2.373 Vali Acc: 0.236 Test Loss: 2.373 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 1.5664663314819336
Epoch: 2, Steps: 7 | Train Loss: 2.218 Vali Loss: 2.043 Vali Acc: 0.597 Test Loss: 2.043 Test Acc: 0.597
Validation loss decreased (-0.236087 --> -0.597202).  Saving model ...
Epoch: 3 cost time: 1.6704819202423096
Epoch: 3, Steps: 7 | Train Loss: 1.788 Vali Loss: 1.660 Vali Acc: 0.778 Test Loss: 1.660 Test Acc: 0.778
Validation loss decreased (-0.597202 --> -0.777761).  Saving model ...
Epoch: 4 cost time: 1.6394917964935303
Epoch: 4, Steps: 7 | Train Loss: 1.363 Vali Loss: 1.288 Vali Acc: 0.847 Test Loss: 1.288 Test Acc: 0.847
Validation loss decreased (-0.777761 --> -0.847209).  Saving model ...
Epoch: 5 cost time: 1.7975115776062012
Epoch: 5, Steps: 7 | Train Loss: 0.972 Vali Loss: 0.975 Vali Acc: 0.861 Test Loss: 0.975 Test Acc: 0.861
Validation loss decreased (-0.847209 --> -0.861101).  Saving model ...
Epoch: 6 cost time: 1.7759747505187988
Epoch: 6, Steps: 7 | Train Loss: 0.619 Vali Loss: 0.743 Vali Acc: 0.861 Test Loss: 0.743 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861104).  Saving model ...
Epoch: 7 cost time: 1.8687844276428223
Epoch: 7, Steps: 7 | Train Loss: 0.408 Vali Loss: 0.585 Vali Acc: 0.875 Test Loss: 0.585 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 1.813159465789795
Epoch: 8, Steps: 7 | Train Loss: 0.238 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 2.0177862644195557
Epoch: 9, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 1.9787940979003906
Epoch: 10, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 1.9285008907318115
Epoch: 11, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.9668660163879395
Epoch: 12, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9380764961242676
Epoch: 13, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.078799247741699
Epoch: 14, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9757182598114014
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 2.1007161140441895
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.7842566967010498
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.8433434963226318
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.7934491634368896
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.7005913257598877
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.795433759689331
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.7867984771728516
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.619307279586792
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.8101658821105957
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.8728563785552979
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.8163185119628906
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.8382513523101807
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.7966160774230957
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8976857662200928
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8142638206481934
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 408460
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.497610330581665
Epoch: 1, Steps: 7 | Train Loss: 2.497 Vali Loss: 2.489 Vali Acc: 0.097 Test Loss: 2.489 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 1.073012351989746
Epoch: 2, Steps: 7 | Train Loss: 2.259 Vali Loss: 2.127 Vali Acc: 0.514 Test Loss: 2.127 Test Acc: 0.514
Validation loss decreased (-0.097197 --> -0.513868).  Saving model ...
Epoch: 3 cost time: 1.0932772159576416
Epoch: 3, Steps: 7 | Train Loss: 1.840 Vali Loss: 1.690 Vali Acc: 0.681 Test Loss: 1.690 Test Acc: 0.681
Validation loss decreased (-0.513868 --> -0.680539).  Saving model ...
Epoch: 4 cost time: 1.2106280326843262
Epoch: 4, Steps: 7 | Train Loss: 1.344 Vali Loss: 1.299 Vali Acc: 0.819 Test Loss: 1.299 Test Acc: 0.819
Validation loss decreased (-0.680539 --> -0.819431).  Saving model ...
Epoch: 5 cost time: 1.1601059436798096
Epoch: 5, Steps: 7 | Train Loss: 0.928 Vali Loss: 0.968 Vali Acc: 0.903 Test Loss: 0.968 Test Acc: 0.903
Validation loss decreased (-0.819431 --> -0.902768).  Saving model ...
Epoch: 6 cost time: 1.2678892612457275
Epoch: 6, Steps: 7 | Train Loss: 0.614 Vali Loss: 0.745 Vali Acc: 0.931 Test Loss: 0.745 Test Acc: 0.931
Validation loss decreased (-0.902768 --> -0.930548).  Saving model ...
Epoch: 7 cost time: 1.2838079929351807
Epoch: 7, Steps: 7 | Train Loss: 0.372 Vali Loss: 0.565 Vali Acc: 0.931 Test Loss: 0.565 Test Acc: 0.931
Validation loss decreased (-0.930548 --> -0.930550).  Saving model ...
Epoch: 8 cost time: 1.2827038764953613
Epoch: 8, Steps: 7 | Train Loss: 0.228 Vali Loss: 0.456 Vali Acc: 0.944 Test Loss: 0.456 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944440).  Saving model ...
Epoch: 9 cost time: 1.270707130432129
Epoch: 9, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.403 Vali Acc: 0.931 Test Loss: 0.403 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3388991355895996
Epoch: 10, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.359 Vali Acc: 0.944 Test Loss: 0.359 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 1.2543632984161377
Epoch: 11, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.327 Vali Acc: 0.944 Test Loss: 0.327 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 1.2890238761901855
Epoch: 12, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3051395416259766
Epoch: 13, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.1423120498657227
Epoch: 14, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.1347107887268066
Epoch: 15, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1947741508483887
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0379347801208496
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1539461612701416
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1263127326965332
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0861332416534424
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0777497291564941
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.0838537216186523
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1086266040802002
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 1.1811249256134033
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.169877529144287
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1934762001037598
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2335479259490967
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2335922718048096
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1894288063049316
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1755294799804688
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 201452
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.052799701690674
Epoch: 1, Steps: 7 | Train Loss: 2.564 Vali Loss: 2.516 Vali Acc: 0.083 Test Loss: 2.516 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 2.397632122039795
Epoch: 2, Steps: 7 | Train Loss: 2.338 Vali Loss: 2.188 Vali Acc: 0.361 Test Loss: 2.188 Test Acc: 0.361
Validation loss decreased (-0.083308 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 2.330401659011841
Epoch: 3, Steps: 7 | Train Loss: 1.984 Vali Loss: 1.818 Vali Acc: 0.556 Test Loss: 1.818 Test Acc: 0.556
Validation loss decreased (-0.361089 --> -0.555537).  Saving model ...
Epoch: 4 cost time: 2.2663419246673584
Epoch: 4, Steps: 7 | Train Loss: 1.552 Vali Loss: 1.513 Vali Acc: 0.681 Test Loss: 1.513 Test Acc: 0.681
Validation loss decreased (-0.555537 --> -0.680540).  Saving model ...
Epoch: 5 cost time: 2.6414246559143066
Epoch: 5, Steps: 7 | Train Loss: 1.194 Vali Loss: 1.238 Vali Acc: 0.792 Test Loss: 1.238 Test Acc: 0.792
Validation loss decreased (-0.680540 --> -0.791654).  Saving model ...
Epoch: 6 cost time: 2.6642160415649414
Epoch: 6, Steps: 7 | Train Loss: 0.884 Vali Loss: 1.023 Vali Acc: 0.806 Test Loss: 1.023 Test Acc: 0.806
Validation loss decreased (-0.791654 --> -0.805545).  Saving model ...
Epoch: 7 cost time: 2.704864501953125
Epoch: 7, Steps: 7 | Train Loss: 0.610 Vali Loss: 0.819 Vali Acc: 0.806 Test Loss: 0.819 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805547).  Saving model ...
Epoch: 8 cost time: 2.657137393951416
Epoch: 8, Steps: 7 | Train Loss: 0.411 Vali Loss: 0.693 Vali Acc: 0.792 Test Loss: 0.693 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.620922088623047
Epoch: 9, Steps: 7 | Train Loss: 0.269 Vali Loss: 0.595 Vali Acc: 0.861 Test Loss: 0.595 Test Acc: 0.861
Validation loss decreased (-0.805547 --> -0.861105).  Saving model ...
Epoch: 10 cost time: 2.882835626602173
Epoch: 10, Steps: 7 | Train Loss: 0.171 Vali Loss: 0.568 Vali Acc: 0.806 Test Loss: 0.568 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5943470001220703
Epoch: 11, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.543229103088379
Epoch: 12, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.463 Vali Acc: 0.847 Test Loss: 0.463 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7106173038482666
Epoch: 13, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.453 Vali Acc: 0.833 Test Loss: 0.453 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5452935695648193
Epoch: 14, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.446 Vali Acc: 0.833 Test Loss: 0.446 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.56060791015625
Epoch: 15, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.413 Vali Acc: 0.847 Test Loss: 0.413 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.608259916305542
Epoch: 16, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.412 Vali Acc: 0.847 Test Loss: 0.412 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.0316836833953857
Epoch: 17, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.420 Vali Acc: 0.847 Test Loss: 0.420 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.987926959991455
Epoch: 18, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.421 Vali Acc: 0.847 Test Loss: 0.421 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.8871140480041504
Epoch: 19, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.406 Vali Acc: 0.847 Test Loss: 0.406 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8611111111111112
model parameter : 261836
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.981489419937134
Epoch: 1, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.413 Vali Acc: 0.097 Test Loss: 2.413 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 1.397632122039795
Epoch: 2, Steps: 7 | Train Loss: 2.245 Vali Loss: 2.067 Vali Acc: 0.458 Test Loss: 2.067 Test Acc: 0.458
Validation loss decreased (-0.097198 --> -0.458313).  Saving model ...
Epoch: 3 cost time: 1.3836309909820557
Epoch: 3, Steps: 7 | Train Loss: 1.843 Vali Loss: 1.675 Vali Acc: 0.750 Test Loss: 1.675 Test Acc: 0.750
Validation loss decreased (-0.458313 --> -0.749983).  Saving model ...
Epoch: 4 cost time: 1.3786983489990234
Epoch: 4, Steps: 7 | Train Loss: 1.378 Vali Loss: 1.289 Vali Acc: 0.833 Test Loss: 1.289 Test Acc: 0.833
Validation loss decreased (-0.749983 --> -0.833320).  Saving model ...
Epoch: 5 cost time: 1.3369405269622803
Epoch: 5, Steps: 7 | Train Loss: 0.979 Vali Loss: 1.008 Vali Acc: 0.819 Test Loss: 1.008 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3384504318237305
Epoch: 6, Steps: 7 | Train Loss: 0.632 Vali Loss: 0.743 Vali Acc: 0.875 Test Loss: 0.743 Test Acc: 0.875
Validation loss decreased (-0.833320 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 1.4200623035430908
Epoch: 7, Steps: 7 | Train Loss: 0.398 Vali Loss: 0.572 Vali Acc: 0.903 Test Loss: 0.572 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902772).  Saving model ...
Epoch: 8 cost time: 1.4252138137817383
Epoch: 8, Steps: 7 | Train Loss: 0.233 Vali Loss: 0.467 Vali Acc: 0.903 Test Loss: 0.467 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 1.562417984008789
Epoch: 9, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4231700897216797
Epoch: 10, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 1.489755392074585
Epoch: 11, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.4490025043487549
Epoch: 12, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4261839389801025
Epoch: 13, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.577327013015747
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5563836097717285
Epoch: 15, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4357571601867676
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.3466885089874268
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.2835750579833984
Epoch: 18, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.2732694149017334
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.5590286254882812
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.484006643295288
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.5247242450714111
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.4801640510559082
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.5253689289093018
Epoch: 24, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.733158826828003
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.773033857345581
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7183794975280762
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.774134874343872
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 1.7896342277526855
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 1.756641149520874
Epoch: 30, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 158316
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5976829528808594
Epoch: 1, Steps: 7 | Train Loss: 2.564 Vali Loss: 2.515 Vali Acc: 0.083 Test Loss: 2.515 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 1.9980337619781494
Epoch: 2, Steps: 7 | Train Loss: 2.338 Vali Loss: 2.186 Vali Acc: 0.361 Test Loss: 2.186 Test Acc: 0.361
Validation loss decreased (-0.083308 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 2.1905453205108643
Epoch: 3, Steps: 7 | Train Loss: 1.983 Vali Loss: 1.817 Vali Acc: 0.556 Test Loss: 1.817 Test Acc: 0.556
Validation loss decreased (-0.361089 --> -0.555537).  Saving model ...
Epoch: 4 cost time: 1.95100736618042
Epoch: 4, Steps: 7 | Train Loss: 1.552 Vali Loss: 1.511 Vali Acc: 0.681 Test Loss: 1.511 Test Acc: 0.681
Validation loss decreased (-0.555537 --> -0.680540).  Saving model ...
Epoch: 5 cost time: 1.8332502841949463
Epoch: 5, Steps: 7 | Train Loss: 1.194 Vali Loss: 1.236 Vali Acc: 0.792 Test Loss: 1.236 Test Acc: 0.792
Validation loss decreased (-0.680540 --> -0.791654).  Saving model ...
Epoch: 6 cost time: 2.1571648120880127
Epoch: 6, Steps: 7 | Train Loss: 0.883 Vali Loss: 1.020 Vali Acc: 0.806 Test Loss: 1.020 Test Acc: 0.806
Validation loss decreased (-0.791654 --> -0.805545).  Saving model ...
Epoch: 7 cost time: 2.2138285636901855
Epoch: 7, Steps: 7 | Train Loss: 0.610 Vali Loss: 0.816 Vali Acc: 0.806 Test Loss: 0.816 Test Acc: 0.806
Validation loss decreased (-0.805545 --> -0.805547).  Saving model ...
Epoch: 8 cost time: 2.1126229763031006
Epoch: 8, Steps: 7 | Train Loss: 0.411 Vali Loss: 0.690 Vali Acc: 0.792 Test Loss: 0.690 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.284106969833374
Epoch: 9, Steps: 7 | Train Loss: 0.270 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
Validation loss decreased (-0.805547 --> -0.861105).  Saving model ...
Epoch: 10 cost time: 2.174522638320923
Epoch: 10, Steps: 7 | Train Loss: 0.170 Vali Loss: 0.566 Vali Acc: 0.806 Test Loss: 0.566 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0073306560516357
Epoch: 11, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.517 Vali Acc: 0.833 Test Loss: 0.517 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.889435052871704
Epoch: 12, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9564409255981445
Epoch: 13, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9733338356018066
Epoch: 14, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.773622989654541
Epoch: 15, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.411 Vali Acc: 0.847 Test Loss: 0.411 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9774417877197266
Epoch: 16, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.410 Vali Acc: 0.847 Test Loss: 0.410 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9931073188781738
Epoch: 17, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.418 Vali Acc: 0.847 Test Loss: 0.418 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.250561237335205
Epoch: 18, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.419 Vali Acc: 0.847 Test Loss: 0.419 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.4036688804626465
Epoch: 19, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.403 Vali Acc: 0.847 Test Loss: 0.403 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8611111111111112
model parameter : 261836
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.962409496307373
Epoch: 1, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.413 Vali Acc: 0.097 Test Loss: 2.413 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 1.3578102588653564
Epoch: 2, Steps: 7 | Train Loss: 2.245 Vali Loss: 2.067 Vali Acc: 0.458 Test Loss: 2.067 Test Acc: 0.458
Validation loss decreased (-0.097198 --> -0.458313).  Saving model ...
Epoch: 3 cost time: 1.2451965808868408
Epoch: 3, Steps: 7 | Train Loss: 1.843 Vali Loss: 1.675 Vali Acc: 0.750 Test Loss: 1.675 Test Acc: 0.750
Validation loss decreased (-0.458313 --> -0.749983).  Saving model ...
Epoch: 4 cost time: 1.2333159446716309
Epoch: 4, Steps: 7 | Train Loss: 1.378 Vali Loss: 1.289 Vali Acc: 0.833 Test Loss: 1.289 Test Acc: 0.833
Validation loss decreased (-0.749983 --> -0.833320).  Saving model ...
Epoch: 5 cost time: 1.3268499374389648
Epoch: 5, Steps: 7 | Train Loss: 0.979 Vali Loss: 1.008 Vali Acc: 0.819 Test Loss: 1.008 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2280597686767578
Epoch: 6, Steps: 7 | Train Loss: 0.632 Vali Loss: 0.743 Vali Acc: 0.875 Test Loss: 0.743 Test Acc: 0.875
Validation loss decreased (-0.833320 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 1.1318910121917725
Epoch: 7, Steps: 7 | Train Loss: 0.398 Vali Loss: 0.572 Vali Acc: 0.903 Test Loss: 0.572 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902772).  Saving model ...
Epoch: 8 cost time: 1.2428085803985596
Epoch: 8, Steps: 7 | Train Loss: 0.233 Vali Loss: 0.467 Vali Acc: 0.903 Test Loss: 0.467 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 1.2371776103973389
Epoch: 9, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.286590814590454
Epoch: 10, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 1.2799997329711914
Epoch: 11, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.4029734134674072
Epoch: 12, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3675460815429688
Epoch: 13, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.39768648147583
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.190046787261963
Epoch: 15, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2665512561798096
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.4098994731903076
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.2917659282684326
Epoch: 18, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.2616069316864014
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.3064937591552734
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.2098782062530518
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.164872169494629
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.156489372253418
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.1535725593566895
Epoch: 24, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.8984208106994629
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1736960411071777
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1533734798431396
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1031153202056885
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 1.1097400188446045
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 1.279794454574585
Epoch: 30, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 158316
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1628448963165283
Epoch: 1, Steps: 7 | Train Loss: 2.563 Vali Loss: 2.516 Vali Acc: 0.083 Test Loss: 2.516 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 1.7696678638458252
Epoch: 2, Steps: 7 | Train Loss: 2.340 Vali Loss: 2.188 Vali Acc: 0.375 Test Loss: 2.188 Test Acc: 0.375
Validation loss decreased (-0.083308 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 1.553086757659912
Epoch: 3, Steps: 7 | Train Loss: 1.987 Vali Loss: 1.820 Vali Acc: 0.542 Test Loss: 1.820 Test Acc: 0.542
Validation loss decreased (-0.374978 --> -0.541648).  Saving model ...
Epoch: 4 cost time: 1.6331567764282227
Epoch: 4, Steps: 7 | Train Loss: 1.556 Vali Loss: 1.517 Vali Acc: 0.681 Test Loss: 1.517 Test Acc: 0.681
Validation loss decreased (-0.541648 --> -0.680540).  Saving model ...
Epoch: 5 cost time: 1.5581839084625244
Epoch: 5, Steps: 7 | Train Loss: 1.200 Vali Loss: 1.245 Vali Acc: 0.806 Test Loss: 1.245 Test Acc: 0.806
Validation loss decreased (-0.680540 --> -0.805543).  Saving model ...
Epoch: 6 cost time: 1.6519193649291992
Epoch: 6, Steps: 7 | Train Loss: 0.891 Vali Loss: 1.032 Vali Acc: 0.806 Test Loss: 1.032 Test Acc: 0.806
Validation loss decreased (-0.805543 --> -0.805545).  Saving model ...
Epoch: 7 cost time: 1.5411152839660645
Epoch: 7, Steps: 7 | Train Loss: 0.619 Vali Loss: 0.829 Vali Acc: 0.792 Test Loss: 0.829 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6744561195373535
Epoch: 8, Steps: 7 | Train Loss: 0.420 Vali Loss: 0.704 Vali Acc: 0.792 Test Loss: 0.704 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5403618812561035
Epoch: 9, Steps: 7 | Train Loss: 0.275 Vali Loss: 0.604 Vali Acc: 0.861 Test Loss: 0.604 Test Acc: 0.861
Validation loss decreased (-0.805545 --> -0.861105).  Saving model ...
Epoch: 10 cost time: 1.5701518058776855
Epoch: 10, Steps: 7 | Train Loss: 0.176 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7074029445648193
Epoch: 11, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8019979000091553
Epoch: 12, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.467 Vali Acc: 0.847 Test Loss: 0.467 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7848877906799316
Epoch: 13, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.781444787979126
Epoch: 14, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.453 Vali Acc: 0.833 Test Loss: 0.453 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7269175052642822
Epoch: 15, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.421 Vali Acc: 0.847 Test Loss: 0.421 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6674013137817383
Epoch: 16, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.421 Vali Acc: 0.847 Test Loss: 0.421 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7127621173858643
Epoch: 17, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.429 Vali Acc: 0.847 Test Loss: 0.429 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6566646099090576
Epoch: 18, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.430 Vali Acc: 0.847 Test Loss: 0.430 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.664280652999878
Epoch: 19, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.415 Vali Acc: 0.847 Test Loss: 0.415 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8611111111111112
model parameter : 261836
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.346247673034668
Epoch: 1, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.408 Vali Acc: 0.125 Test Loss: 2.408 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 0.9554884433746338
Epoch: 2, Steps: 7 | Train Loss: 2.249 Vali Loss: 2.063 Vali Acc: 0.472 Test Loss: 2.063 Test Acc: 0.472
Validation loss decreased (-0.124976 --> -0.472202).  Saving model ...
Epoch: 3 cost time: 0.9213402271270752
Epoch: 3, Steps: 7 | Train Loss: 1.848 Vali Loss: 1.673 Vali Acc: 0.722 Test Loss: 1.673 Test Acc: 0.722
Validation loss decreased (-0.472202 --> -0.722205).  Saving model ...
Epoch: 4 cost time: 1.1343567371368408
Epoch: 4, Steps: 7 | Train Loss: 1.383 Vali Loss: 1.288 Vali Acc: 0.833 Test Loss: 1.288 Test Acc: 0.833
Validation loss decreased (-0.722205 --> -0.833320).  Saving model ...
Epoch: 5 cost time: 1.0232141017913818
Epoch: 5, Steps: 7 | Train Loss: 0.982 Vali Loss: 1.008 Vali Acc: 0.806 Test Loss: 1.008 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0492022037506104
Epoch: 6, Steps: 7 | Train Loss: 0.635 Vali Loss: 0.745 Vali Acc: 0.875 Test Loss: 0.745 Test Acc: 0.875
Validation loss decreased (-0.833320 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 1.0754821300506592
Epoch: 7, Steps: 7 | Train Loss: 0.400 Vali Loss: 0.574 Vali Acc: 0.903 Test Loss: 0.574 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902772).  Saving model ...
Epoch: 8 cost time: 1.1225371360778809
Epoch: 8, Steps: 7 | Train Loss: 0.235 Vali Loss: 0.470 Vali Acc: 0.903 Test Loss: 0.470 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 1.1004228591918945
Epoch: 9, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.05808424949646
Epoch: 10, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 1.102337121963501
Epoch: 11, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.994898796081543
Epoch: 12, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0264148712158203
Epoch: 13, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9503662586212158
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9770903587341309
Epoch: 15, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8907787799835205
Epoch: 16, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.0721147060394287
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.0755805969238281
Epoch: 18, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.0858705043792725
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.1032984256744385
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0404658317565918
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1712729930877686
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1408281326293945
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1089909076690674
Epoch: 24, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.092930793762207
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0662727355957031
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.113255262374878
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.091702938079834
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0820848941802979
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 1.099761962890625
Epoch: 30, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_TimesNet_UEA_ftM_sl1197_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 158316
model size : 0.77MB
