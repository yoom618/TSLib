Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 58.042972803115845
Epoch: 1, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.511 Vali Acc: 0.382 Test Loss: 1.511 Test Acc: 0.382
Validation loss decreased (inf --> -0.381488).  Saving model ...
Epoch: 2 cost time: 56.50800156593323
Epoch: 2, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.133 Vali Acc: 0.607 Test Loss: 1.133 Test Acc: 0.607
Validation loss decreased (-0.381488 --> -0.606925).  Saving model ...
Epoch: 3 cost time: 53.76559901237488
Epoch: 3, Steps: 17 | Train Loss: 0.873 Vali Loss: 1.015 Vali Acc: 0.607 Test Loss: 1.015 Test Acc: 0.607
Validation loss decreased (-0.606925 --> -0.606926).  Saving model ...
Epoch: 4 cost time: 55.56983971595764
Epoch: 4, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.881 Vali Acc: 0.676 Test Loss: 0.881 Test Acc: 0.676
Validation loss decreased (-0.606926 --> -0.676292).  Saving model ...
Epoch: 5 cost time: 57.00076413154602
Epoch: 5, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.563 Vali Acc: 0.832 Test Loss: 0.563 Test Acc: 0.832
Validation loss decreased (-0.676292 --> -0.832364).  Saving model ...
Epoch: 6 cost time: 55.86050462722778
Epoch: 6, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 56.85492658615112
Epoch: 7, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.648 Vali Acc: 0.751 Test Loss: 0.648 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 56.78403615951538
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.618 Vali Acc: 0.775 Test Loss: 0.618 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 56.591734170913696
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.461 Vali Acc: 0.809 Test Loss: 0.461 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 55.254146337509155
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 53.54741644859314
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.792 Test Loss: 0.528 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 55.92842245101929
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.786 Test Loss: 0.520 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 56.275941133499146
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.786 Test Loss: 0.515 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 56.31345868110657
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.786 Test Loss: 0.526 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 54.37049698829651
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.786 Test Loss: 0.530 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 75481991
model size : 290.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.854057550430298
Epoch: 1, Steps: 17 | Train Loss: 1.783 Vali Loss: 1.521 Vali Acc: 0.329 Test Loss: 1.521 Test Acc: 0.329
Validation loss decreased (inf --> -0.329465).  Saving model ...
Epoch: 2 cost time: 21.466100454330444
Epoch: 2, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.243 Vali Acc: 0.416 Test Loss: 1.243 Test Acc: 0.416
Validation loss decreased (-0.329465 --> -0.416173).  Saving model ...
Epoch: 3 cost time: 20.78107213973999
Epoch: 3, Steps: 17 | Train Loss: 0.861 Vali Loss: 0.986 Vali Acc: 0.566 Test Loss: 0.986 Test Acc: 0.566
Validation loss decreased (-0.416173 --> -0.566464).  Saving model ...
Epoch: 4 cost time: 21.190045595169067
Epoch: 4, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.812 Vali Acc: 0.665 Test Loss: 0.812 Test Acc: 0.665
Validation loss decreased (-0.566464 --> -0.664732).  Saving model ...
Epoch: 5 cost time: 21.963122844696045
Epoch: 5, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.750 Vali Acc: 0.723 Test Loss: 0.750 Test Acc: 0.723
Validation loss decreased (-0.664732 --> -0.722536).  Saving model ...
Epoch: 6 cost time: 20.367162704467773
Epoch: 6, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.532 Vali Acc: 0.780 Test Loss: 0.532 Test Acc: 0.780
Validation loss decreased (-0.722536 --> -0.780342).  Saving model ...
Epoch: 7 cost time: 19.784356117248535
Epoch: 7, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.604 Vali Acc: 0.757 Test Loss: 0.604 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 19.7710063457489
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.515 Vali Acc: 0.786 Test Loss: 0.515 Test Acc: 0.786
Validation loss decreased (-0.780342 --> -0.786122).  Saving model ...
Epoch: 9 cost time: 19.906131744384766
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.525 Vali Acc: 0.792 Test Loss: 0.525 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 10 cost time: 20.280311107635498
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.536 Vali Acc: 0.786 Test Loss: 0.536 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.497713804244995
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.537 Vali Acc: 0.798 Test Loss: 0.537 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797682).  Saving model ...
Epoch: 12 cost time: 19.727118015289307
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.775 Test Loss: 0.550 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 19.865023612976074
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.798 Test Loss: 0.541 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 20.254764318466187
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.792 Test Loss: 0.558 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 20.196157932281494
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.786 Test Loss: 0.567 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 20.21246361732483
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.786 Test Loss: 0.568 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 19.612571001052856
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.786 Test Loss: 0.562 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 20.562965869903564
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.786 Test Loss: 0.567 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 20.731975317001343
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.786 Test Loss: 0.583 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.580822229385376
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.780 Test Loss: 0.583 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 20.578680753707886
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.780 Test Loss: 0.595 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 22525831
model size : 88.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 42.12553787231445
Epoch: 1, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.511 Vali Acc: 0.382 Test Loss: 1.511 Test Acc: 0.382
Validation loss decreased (inf --> -0.381488).  Saving model ...
Epoch: 2 cost time: 43.22535181045532
Epoch: 2, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.133 Vali Acc: 0.607 Test Loss: 1.133 Test Acc: 0.607
Validation loss decreased (-0.381488 --> -0.606925).  Saving model ...
Epoch: 3 cost time: 43.688348054885864
Epoch: 3, Steps: 17 | Train Loss: 0.873 Vali Loss: 1.015 Vali Acc: 0.607 Test Loss: 1.015 Test Acc: 0.607
Validation loss decreased (-0.606925 --> -0.606926).  Saving model ...
Epoch: 4 cost time: 42.27084922790527
Epoch: 4, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.881 Vali Acc: 0.676 Test Loss: 0.881 Test Acc: 0.676
Validation loss decreased (-0.606926 --> -0.676292).  Saving model ...
Epoch: 5 cost time: 43.19659924507141
Epoch: 5, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.563 Vali Acc: 0.832 Test Loss: 0.563 Test Acc: 0.832
Validation loss decreased (-0.676292 --> -0.832364).  Saving model ...
Epoch: 6 cost time: 43.39591336250305
Epoch: 6, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 43.00253081321716
Epoch: 7, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.648 Vali Acc: 0.751 Test Loss: 0.648 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 43.75228238105774
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.618 Vali Acc: 0.775 Test Loss: 0.618 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 41.360028982162476
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.461 Vali Acc: 0.809 Test Loss: 0.461 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 40.416826486587524
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 39.9188768863678
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.792 Test Loss: 0.528 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 39.10050582885742
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.786 Test Loss: 0.520 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 42.209879636764526
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.786 Test Loss: 0.515 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 42.76495409011841
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.786 Test Loss: 0.526 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 42.64091682434082
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.786 Test Loss: 0.530 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 75481991
model size : 290.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.29947590827942
Epoch: 1, Steps: 17 | Train Loss: 1.783 Vali Loss: 1.521 Vali Acc: 0.329 Test Loss: 1.521 Test Acc: 0.329
Validation loss decreased (inf --> -0.329465).  Saving model ...
Epoch: 2 cost time: 16.767050743103027
Epoch: 2, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.243 Vali Acc: 0.416 Test Loss: 1.243 Test Acc: 0.416
Validation loss decreased (-0.329465 --> -0.416173).  Saving model ...
Epoch: 3 cost time: 16.629098176956177
Epoch: 3, Steps: 17 | Train Loss: 0.861 Vali Loss: 0.986 Vali Acc: 0.566 Test Loss: 0.986 Test Acc: 0.566
Validation loss decreased (-0.416173 --> -0.566464).  Saving model ...
Epoch: 4 cost time: 16.15993332862854
Epoch: 4, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.812 Vali Acc: 0.665 Test Loss: 0.812 Test Acc: 0.665
Validation loss decreased (-0.566464 --> -0.664732).  Saving model ...
Epoch: 5 cost time: 16.660857677459717
Epoch: 5, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.750 Vali Acc: 0.723 Test Loss: 0.750 Test Acc: 0.723
Validation loss decreased (-0.664732 --> -0.722536).  Saving model ...
Epoch: 6 cost time: 13.245706558227539
Epoch: 6, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.532 Vali Acc: 0.780 Test Loss: 0.532 Test Acc: 0.780
Validation loss decreased (-0.722536 --> -0.780342).  Saving model ...
Epoch: 7 cost time: 16.089537143707275
Epoch: 7, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.604 Vali Acc: 0.757 Test Loss: 0.604 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.946377754211426
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.515 Vali Acc: 0.786 Test Loss: 0.515 Test Acc: 0.786
Validation loss decreased (-0.780342 --> -0.786122).  Saving model ...
Epoch: 9 cost time: 15.944389820098877
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.525 Vali Acc: 0.792 Test Loss: 0.525 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 10 cost time: 16.131396532058716
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.536 Vali Acc: 0.786 Test Loss: 0.536 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.108619928359985
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.537 Vali Acc: 0.798 Test Loss: 0.537 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797682).  Saving model ...
Epoch: 12 cost time: 15.652668476104736
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.775 Test Loss: 0.550 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.313069343566895
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.798 Test Loss: 0.541 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.741223096847534
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.792 Test Loss: 0.558 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.749837636947632
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.786 Test Loss: 0.567 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 15.664483070373535
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.786 Test Loss: 0.568 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 15.445533037185669
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.786 Test Loss: 0.562 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 15.20897126197815
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.786 Test Loss: 0.567 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 15.346891164779663
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.786 Test Loss: 0.583 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 15.35631537437439
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.780 Test Loss: 0.583 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.328723192214966
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.780 Test Loss: 0.595 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 22525831
model size : 88.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 26.50158667564392
Epoch: 1, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.511 Vali Acc: 0.382 Test Loss: 1.511 Test Acc: 0.382
Validation loss decreased (inf --> -0.381488).  Saving model ...
Epoch: 2 cost time: 24.258781909942627
Epoch: 2, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.133 Vali Acc: 0.607 Test Loss: 1.133 Test Acc: 0.607
Validation loss decreased (-0.381488 --> -0.606925).  Saving model ...
Epoch: 3 cost time: 25.033386945724487
Epoch: 3, Steps: 17 | Train Loss: 0.873 Vali Loss: 1.015 Vali Acc: 0.607 Test Loss: 1.015 Test Acc: 0.607
Validation loss decreased (-0.606925 --> -0.606926).  Saving model ...
Epoch: 4 cost time: 25.06536841392517
Epoch: 4, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.881 Vali Acc: 0.676 Test Loss: 0.881 Test Acc: 0.676
Validation loss decreased (-0.606926 --> -0.676292).  Saving model ...
Epoch: 5 cost time: 25.103693962097168
Epoch: 5, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.563 Vali Acc: 0.832 Test Loss: 0.563 Test Acc: 0.832
Validation loss decreased (-0.676292 --> -0.832364).  Saving model ...
Epoch: 6 cost time: 25.06897473335266
Epoch: 6, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.053740739822388
Epoch: 7, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.648 Vali Acc: 0.751 Test Loss: 0.648 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 26.041356801986694
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.618 Vali Acc: 0.775 Test Loss: 0.618 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 25.568480491638184
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.461 Vali Acc: 0.809 Test Loss: 0.461 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 25.755549430847168
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 26.397210121154785
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.792 Test Loss: 0.528 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 25.65750241279602
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.786 Test Loss: 0.520 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 25.418033361434937
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.786 Test Loss: 0.515 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 24.45928955078125
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.786 Test Loss: 0.526 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 25.07271122932434
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.786 Test Loss: 0.530 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 75481991
model size : 290.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.320745468139648
Epoch: 1, Steps: 17 | Train Loss: 1.783 Vali Loss: 1.521 Vali Acc: 0.329 Test Loss: 1.521 Test Acc: 0.329
Validation loss decreased (inf --> -0.329465).  Saving model ...
Epoch: 2 cost time: 10.253865242004395
Epoch: 2, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.243 Vali Acc: 0.416 Test Loss: 1.243 Test Acc: 0.416
Validation loss decreased (-0.329465 --> -0.416173).  Saving model ...
Epoch: 3 cost time: 10.171679735183716
Epoch: 3, Steps: 17 | Train Loss: 0.861 Vali Loss: 0.986 Vali Acc: 0.566 Test Loss: 0.986 Test Acc: 0.566
Validation loss decreased (-0.416173 --> -0.566464).  Saving model ...
Epoch: 4 cost time: 10.311474800109863
Epoch: 4, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.812 Vali Acc: 0.665 Test Loss: 0.812 Test Acc: 0.665
Validation loss decreased (-0.566464 --> -0.664732).  Saving model ...
Epoch: 5 cost time: 10.356261491775513
Epoch: 5, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.750 Vali Acc: 0.723 Test Loss: 0.750 Test Acc: 0.723
Validation loss decreased (-0.664732 --> -0.722536).  Saving model ...
Epoch: 6 cost time: 10.004342555999756
Epoch: 6, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.532 Vali Acc: 0.780 Test Loss: 0.532 Test Acc: 0.780
Validation loss decreased (-0.722536 --> -0.780342).  Saving model ...
Epoch: 7 cost time: 9.89131236076355
Epoch: 7, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.604 Vali Acc: 0.757 Test Loss: 0.604 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.50705099105835
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.515 Vali Acc: 0.786 Test Loss: 0.515 Test Acc: 0.786
Validation loss decreased (-0.780342 --> -0.786122).  Saving model ...
Epoch: 9 cost time: 9.828829050064087
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.525 Vali Acc: 0.792 Test Loss: 0.525 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 10 cost time: 9.675125122070312
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.536 Vali Acc: 0.786 Test Loss: 0.536 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.677500486373901
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.537 Vali Acc: 0.798 Test Loss: 0.537 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797682).  Saving model ...
Epoch: 12 cost time: 9.236785888671875
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.775 Test Loss: 0.550 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.470062732696533
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.798 Test Loss: 0.541 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.586824417114258
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.792 Test Loss: 0.558 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.545521974563599
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.786 Test Loss: 0.567 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.649969100952148
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.786 Test Loss: 0.568 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 9.886159658432007
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.786 Test Loss: 0.562 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.65821361541748
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.786 Test Loss: 0.567 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.25513482093811
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.786 Test Loss: 0.583 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.236371278762817
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.780 Test Loss: 0.583 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.000653505325317
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.780 Test Loss: 0.595 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 22525831
model size : 88.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 32.67218065261841
Epoch: 1, Steps: 17 | Train Loss: 1.915 Vali Loss: 1.621 Vali Acc: 0.335 Test Loss: 1.621 Test Acc: 0.335
Validation loss decreased (inf --> -0.335244).  Saving model ...
Epoch: 2 cost time: 32.27857041358948
Epoch: 2, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.194 Vali Acc: 0.509 Test Loss: 1.194 Test Acc: 0.509
Validation loss decreased (-0.335244 --> -0.508659).  Saving model ...
Epoch: 3 cost time: 32.35262489318848
Epoch: 3, Steps: 17 | Train Loss: 0.905 Vali Loss: 0.947 Vali Acc: 0.624 Test Loss: 0.947 Test Acc: 0.624
Validation loss decreased (-0.508659 --> -0.624268).  Saving model ...
Epoch: 4 cost time: 32.04510736465454
Epoch: 4, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.711 Vali Acc: 0.751 Test Loss: 0.711 Test Acc: 0.751
Validation loss decreased (-0.624268 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 32.144327878952026
Epoch: 5, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
Validation loss decreased (-0.751438 --> -0.774560).  Saving model ...
Epoch: 6 cost time: 32.20812153816223
Epoch: 6, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
Validation loss decreased (-0.774560 --> -0.803463).  Saving model ...
Epoch: 7 cost time: 32.567890882492065
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.491 Vali Acc: 0.798 Test Loss: 0.491 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 32.35598969459534
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.413 Vali Acc: 0.844 Test Loss: 0.413 Test Acc: 0.844
Validation loss decreased (-0.803463 --> -0.843927).  Saving model ...
Epoch: 9 cost time: 32.4877405166626
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
Validation loss decreased (-0.843927 --> -0.855487).  Saving model ...
Epoch: 10 cost time: 32.76445508003235
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 11 cost time: 32.04905128479004
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 31.695974349975586
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 30.60996413230896
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.873 Test Loss: 0.466 Test Acc: 0.873
Validation loss decreased (-0.855487 --> -0.872828).  Saving model ...
Epoch: 14 cost time: 30.464767932891846
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.861 Test Loss: 0.462 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 30.544826984405518
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.861 Test Loss: 0.472 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 31.282536506652832
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.861 Test Loss: 0.460 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 31.498433351516724
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 28.57452416419983
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 29.56327986717224
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.861 Test Loss: 0.473 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 29.63688850402832
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 29.205321550369263
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.867 Test Loss: 0.476 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 29.39210557937622
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.867 Test Loss: 0.490 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 30.071527242660522
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.867 Test Loss: 0.484 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 37992327
model size : 147.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.13143277168274
Epoch: 1, Steps: 17 | Train Loss: 1.814 Vali Loss: 1.565 Vali Acc: 0.289 Test Loss: 1.565 Test Acc: 0.289
Validation loss decreased (inf --> -0.289002).  Saving model ...
Epoch: 2 cost time: 12.298518657684326
Epoch: 2, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.129 Vali Acc: 0.566 Test Loss: 1.129 Test Acc: 0.566
Validation loss decreased (-0.289002 --> -0.566463).  Saving model ...
Epoch: 3 cost time: 12.243258714675903
Epoch: 3, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.845 Vali Acc: 0.734 Test Loss: 0.845 Test Acc: 0.734
Validation loss decreased (-0.566463 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 10.313302993774414
Epoch: 4, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.759 Vali Acc: 0.711 Test Loss: 0.759 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.736493825912476
Epoch: 5, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.667 Vali Acc: 0.746 Test Loss: 0.667 Test Acc: 0.746
Validation loss decreased (-0.734096 --> -0.745658).  Saving model ...
Epoch: 6 cost time: 12.619771003723145
Epoch: 6, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.643 Vali Acc: 0.763 Test Loss: 0.643 Test Acc: 0.763
Validation loss decreased (-0.745658 --> -0.762999).  Saving model ...
Epoch: 7 cost time: 12.729761362075806
Epoch: 7, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.770 Vali Acc: 0.751 Test Loss: 0.770 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.909559488296509
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.623 Vali Acc: 0.775 Test Loss: 0.623 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774560).  Saving model ...
Epoch: 9 cost time: 12.954732179641724
Epoch: 9, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.572 Vali Acc: 0.780 Test Loss: 0.572 Test Acc: 0.780
Validation loss decreased (-0.774560 --> -0.780341).  Saving model ...
Epoch: 10 cost time: 12.56783413887024
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.587 Vali Acc: 0.786 Test Loss: 0.587 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 11 cost time: 12.573810815811157
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.651 Vali Acc: 0.827 Test Loss: 0.651 Test Acc: 0.827
Validation loss decreased (-0.786121 --> -0.826583).  Saving model ...
Epoch: 12 cost time: 12.340728521347046
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.73601508140564
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.803 Test Loss: 0.650 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.328859090805054
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.792 Test Loss: 0.651 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.678619861602783
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.815 Test Loss: 0.650 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.728822231292725
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.803 Test Loss: 0.651 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.409422874450684
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.798 Test Loss: 0.649 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 11.998088836669922
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.803 Test Loss: 0.646 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.965351343154907
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.155702590942383
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.61954641342163
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.803 Test Loss: 0.648 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 11513735
model size : 46.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 24.912166118621826
Epoch: 1, Steps: 17 | Train Loss: 1.915 Vali Loss: 1.621 Vali Acc: 0.335 Test Loss: 1.621 Test Acc: 0.335
Validation loss decreased (inf --> -0.335244).  Saving model ...
Epoch: 2 cost time: 22.69034719467163
Epoch: 2, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.194 Vali Acc: 0.509 Test Loss: 1.194 Test Acc: 0.509
Validation loss decreased (-0.335244 --> -0.508659).  Saving model ...
Epoch: 3 cost time: 23.509638786315918
Epoch: 3, Steps: 17 | Train Loss: 0.905 Vali Loss: 0.947 Vali Acc: 0.624 Test Loss: 0.947 Test Acc: 0.624
Validation loss decreased (-0.508659 --> -0.624268).  Saving model ...
Epoch: 4 cost time: 23.849876165390015
Epoch: 4, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.711 Vali Acc: 0.751 Test Loss: 0.711 Test Acc: 0.751
Validation loss decreased (-0.624268 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 23.848435640335083
Epoch: 5, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
Validation loss decreased (-0.751438 --> -0.774560).  Saving model ...
Epoch: 6 cost time: 24.367462873458862
Epoch: 6, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
Validation loss decreased (-0.774560 --> -0.803463).  Saving model ...
Epoch: 7 cost time: 24.443668365478516
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.491 Vali Acc: 0.798 Test Loss: 0.491 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.526432275772095
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.413 Vali Acc: 0.844 Test Loss: 0.413 Test Acc: 0.844
Validation loss decreased (-0.803463 --> -0.843927).  Saving model ...
Epoch: 9 cost time: 22.667915105819702
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
Validation loss decreased (-0.843927 --> -0.855487).  Saving model ...
Epoch: 10 cost time: 22.41367483139038
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 11 cost time: 22.029608964920044
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.160988569259644
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 22.115337133407593
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.873 Test Loss: 0.466 Test Acc: 0.873
Validation loss decreased (-0.855487 --> -0.872828).  Saving model ...
Epoch: 14 cost time: 22.24424147605896
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.861 Test Loss: 0.462 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 22.06159210205078
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.861 Test Loss: 0.472 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 22.56130290031433
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.861 Test Loss: 0.460 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 22.529643297195435
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 21.991143703460693
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 23.30035638809204
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.861 Test Loss: 0.473 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 22.994462490081787
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 22.38336682319641
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.867 Test Loss: 0.476 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 22.01437520980835
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.867 Test Loss: 0.490 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 21.43701696395874
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.867 Test Loss: 0.484 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 37992327
model size : 147.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.027002096176147
Epoch: 1, Steps: 17 | Train Loss: 1.814 Vali Loss: 1.565 Vali Acc: 0.289 Test Loss: 1.565 Test Acc: 0.289
Validation loss decreased (inf --> -0.289002).  Saving model ...
Epoch: 2 cost time: 9.212316989898682
Epoch: 2, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.129 Vali Acc: 0.566 Test Loss: 1.129 Test Acc: 0.566
Validation loss decreased (-0.289002 --> -0.566463).  Saving model ...
Epoch: 3 cost time: 9.278152465820312
Epoch: 3, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.845 Vali Acc: 0.734 Test Loss: 0.845 Test Acc: 0.734
Validation loss decreased (-0.566463 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 9.106215000152588
Epoch: 4, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.759 Vali Acc: 0.711 Test Loss: 0.759 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.849576950073242
Epoch: 5, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.667 Vali Acc: 0.746 Test Loss: 0.667 Test Acc: 0.746
Validation loss decreased (-0.734096 --> -0.745658).  Saving model ...
Epoch: 6 cost time: 10.017578125
Epoch: 6, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.643 Vali Acc: 0.763 Test Loss: 0.643 Test Acc: 0.763
Validation loss decreased (-0.745658 --> -0.762999).  Saving model ...
Epoch: 7 cost time: 9.838996887207031
Epoch: 7, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.770 Vali Acc: 0.751 Test Loss: 0.770 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.252130270004272
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.623 Vali Acc: 0.775 Test Loss: 0.623 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774560).  Saving model ...
Epoch: 9 cost time: 9.995324611663818
Epoch: 9, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.572 Vali Acc: 0.780 Test Loss: 0.572 Test Acc: 0.780
Validation loss decreased (-0.774560 --> -0.780341).  Saving model ...
Epoch: 10 cost time: 9.627537250518799
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.587 Vali Acc: 0.786 Test Loss: 0.587 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 11 cost time: 9.02223801612854
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.651 Vali Acc: 0.827 Test Loss: 0.651 Test Acc: 0.827
Validation loss decreased (-0.786121 --> -0.826583).  Saving model ...
Epoch: 12 cost time: 9.58653211593628
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.589827537536621
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.803 Test Loss: 0.650 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.44129753112793
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.792 Test Loss: 0.651 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.540224552154541
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.815 Test Loss: 0.649 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.497993230819702
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.803 Test Loss: 0.651 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 9.25532341003418
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.798 Test Loss: 0.649 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 9.308751583099365
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.803 Test Loss: 0.646 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.481277465820312
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.349326133728027
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 9.189919233322144
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.803 Test Loss: 0.648 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 11513735
model size : 46.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.958256483078003
Epoch: 1, Steps: 17 | Train Loss: 1.915 Vali Loss: 1.621 Vali Acc: 0.335 Test Loss: 1.621 Test Acc: 0.335
Validation loss decreased (inf --> -0.335244).  Saving model ...
Epoch: 2 cost time: 12.380429983139038
Epoch: 2, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.194 Vali Acc: 0.509 Test Loss: 1.194 Test Acc: 0.509
Validation loss decreased (-0.335244 --> -0.508659).  Saving model ...
Epoch: 3 cost time: 15.838408946990967
Epoch: 3, Steps: 17 | Train Loss: 0.905 Vali Loss: 0.947 Vali Acc: 0.624 Test Loss: 0.947 Test Acc: 0.624
Validation loss decreased (-0.508659 --> -0.624268).  Saving model ...
Epoch: 4 cost time: 15.70773458480835
Epoch: 4, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.711 Vali Acc: 0.751 Test Loss: 0.711 Test Acc: 0.751
Validation loss decreased (-0.624268 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 15.056643724441528
Epoch: 5, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
Validation loss decreased (-0.751438 --> -0.774560).  Saving model ...
Epoch: 6 cost time: 15.254957675933838
Epoch: 6, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
Validation loss decreased (-0.774560 --> -0.803463).  Saving model ...
Epoch: 7 cost time: 15.825614929199219
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.491 Vali Acc: 0.798 Test Loss: 0.491 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.276729106903076
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.413 Vali Acc: 0.844 Test Loss: 0.413 Test Acc: 0.844
Validation loss decreased (-0.803463 --> -0.843927).  Saving model ...
Epoch: 9 cost time: 15.05281400680542
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
Validation loss decreased (-0.843927 --> -0.855487).  Saving model ...
Epoch: 10 cost time: 15.043369054794312
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 11 cost time: 15.530830383300781
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.428301811218262
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.996568441390991
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.873 Test Loss: 0.466 Test Acc: 0.873
Validation loss decreased (-0.855487 --> -0.872828).  Saving model ...
Epoch: 14 cost time: 14.587595462799072
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.861 Test Loss: 0.462 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 14.80722427368164
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.861 Test Loss: 0.472 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 14.955110788345337
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.861 Test Loss: 0.460 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 14.770892143249512
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.868008136749268
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 15.20796012878418
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.861 Test Loss: 0.473 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 14.897953271865845
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 14.381455898284912
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.867 Test Loss: 0.476 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 15.886516809463501
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.867 Test Loss: 0.490 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 16.12031102180481
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 37992327
model size : 147.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.938288927078247
Epoch: 1, Steps: 17 | Train Loss: 1.814 Vali Loss: 1.565 Vali Acc: 0.289 Test Loss: 1.565 Test Acc: 0.289
Validation loss decreased (inf --> -0.289002).  Saving model ...
Epoch: 2 cost time: 7.44096302986145
Epoch: 2, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.129 Vali Acc: 0.566 Test Loss: 1.129 Test Acc: 0.566
Validation loss decreased (-0.289002 --> -0.566463).  Saving model ...
Epoch: 3 cost time: 7.230937719345093
Epoch: 3, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.845 Vali Acc: 0.734 Test Loss: 0.845 Test Acc: 0.734
Validation loss decreased (-0.566463 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 7.178901433944702
Epoch: 4, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.759 Vali Acc: 0.711 Test Loss: 0.759 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.439767837524414
Epoch: 5, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.667 Vali Acc: 0.746 Test Loss: 0.667 Test Acc: 0.746
Validation loss decreased (-0.734096 --> -0.745658).  Saving model ...
Epoch: 6 cost time: 7.195759057998657
Epoch: 6, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.643 Vali Acc: 0.763 Test Loss: 0.643 Test Acc: 0.763
Validation loss decreased (-0.745658 --> -0.762999).  Saving model ...
Epoch: 7 cost time: 7.449833869934082
Epoch: 7, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.770 Vali Acc: 0.751 Test Loss: 0.770 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.159822225570679
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.623 Vali Acc: 0.775 Test Loss: 0.623 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774560).  Saving model ...
Epoch: 9 cost time: 7.366649150848389
Epoch: 9, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.572 Vali Acc: 0.780 Test Loss: 0.572 Test Acc: 0.780
Validation loss decreased (-0.774560 --> -0.780341).  Saving model ...
Epoch: 10 cost time: 7.319109678268433
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.587 Vali Acc: 0.786 Test Loss: 0.587 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 11 cost time: 6.789996862411499
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.651 Vali Acc: 0.827 Test Loss: 0.651 Test Acc: 0.827
Validation loss decreased (-0.786121 --> -0.826583).  Saving model ...
Epoch: 12 cost time: 7.3824241161346436
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.147709608078003
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.803 Test Loss: 0.650 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.532095432281494
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.792 Test Loss: 0.651 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.380917310714722
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.815 Test Loss: 0.649 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.940423965454102
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.803 Test Loss: 0.651 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.512498140335083
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.798 Test Loss: 0.649 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.267643928527832
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.5933003425598145
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.369863510131836
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.337713241577148
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.803 Test Loss: 0.648 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 11513735
model size : 46.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 40.12454414367676
Epoch: 1, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.660 Vali Acc: 0.358 Test Loss: 1.660 Test Acc: 0.358
Validation loss decreased (inf --> -0.358365).  Saving model ...
Epoch: 2 cost time: 37.27279567718506
Epoch: 2, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.267 Vali Acc: 0.520 Test Loss: 1.267 Test Acc: 0.520
Validation loss decreased (-0.358365 --> -0.520219).  Saving model ...
Epoch: 3 cost time: 35.68515920639038
Epoch: 3, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.094 Vali Acc: 0.578 Test Loss: 1.094 Test Acc: 0.578
Validation loss decreased (-0.520219 --> -0.578024).  Saving model ...
Epoch: 4 cost time: 34.3956356048584
Epoch: 4, Steps: 17 | Train Loss: 0.780 Vali Loss: 0.857 Vali Acc: 0.636 Test Loss: 0.857 Test Acc: 0.636
Validation loss decreased (-0.578024 --> -0.635830).  Saving model ...
Epoch: 5 cost time: 34.34612059593201
Epoch: 5, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.770 Vali Acc: 0.723 Test Loss: 0.770 Test Acc: 0.723
Validation loss decreased (-0.635830 --> -0.722536).  Saving model ...
Epoch: 6 cost time: 34.2646918296814
Epoch: 6, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.802 Vali Acc: 0.740 Test Loss: 0.802 Test Acc: 0.740
Validation loss decreased (-0.722536 --> -0.739876).  Saving model ...
Epoch: 7 cost time: 33.102296113967896
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
Validation loss decreased (-0.739876 --> -0.838145).  Saving model ...
Epoch: 8 cost time: 33.34679555892944
Epoch: 8, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.556 Vali Acc: 0.775 Test Loss: 0.556 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 32.473493576049805
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.509 Vali Acc: 0.827 Test Loss: 0.509 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 33.33661699295044
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
Validation loss decreased (-0.838145 --> -0.855487).  Saving model ...
Epoch: 11 cost time: 33.517680644989014
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.503 Vali Acc: 0.798 Test Loss: 0.503 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 36.42168474197388
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.798 Test Loss: 0.522 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 36.71749758720398
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 36.60078978538513
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.658 Vali Acc: 0.757 Test Loss: 0.658 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 36.51007008552551
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.702 Vali Acc: 0.740 Test Loss: 0.702 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 36.4410138130188
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 36.25143837928772
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861268).  Saving model ...
Epoch: 18 cost time: 36.05671310424805
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 36.5203959941864
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 37.61704778671265
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 37.85567760467529
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 37.33626198768616
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.844 Test Loss: 0.455 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 36.513097047805786
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 34.85850143432617
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 34.74683499336243
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 30.566345691680908
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 33.185091972351074
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 37744071
model size : 145.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 16.340821743011475
Epoch: 1, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.707 Vali Acc: 0.295 Test Loss: 1.707 Test Acc: 0.295
Validation loss decreased (inf --> -0.294781).  Saving model ...
Epoch: 2 cost time: 14.608133316040039
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.344 Vali Acc: 0.416 Test Loss: 1.344 Test Acc: 0.416
Validation loss decreased (-0.294781 --> -0.416172).  Saving model ...
Epoch: 3 cost time: 14.394341945648193
Epoch: 3, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.118 Vali Acc: 0.538 Test Loss: 1.118 Test Acc: 0.538
Validation loss decreased (-0.416172 --> -0.537561).  Saving model ...
Epoch: 4 cost time: 14.385781526565552
Epoch: 4, Steps: 17 | Train Loss: 0.814 Vali Loss: 0.838 Vali Acc: 0.751 Test Loss: 0.838 Test Acc: 0.751
Validation loss decreased (-0.537561 --> -0.751437).  Saving model ...
Epoch: 5 cost time: 14.447598695755005
Epoch: 5, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.738 Vali Acc: 0.751 Test Loss: 0.738 Test Acc: 0.751
Validation loss decreased (-0.751437 --> -0.751438).  Saving model ...
Epoch: 6 cost time: 14.18814992904663
Epoch: 6, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.556 Vali Acc: 0.827 Test Loss: 0.556 Test Acc: 0.827
Validation loss decreased (-0.751438 --> -0.826584).  Saving model ...
Epoch: 7 cost time: 14.186272859573364
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.630 Vali Acc: 0.769 Test Loss: 0.630 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.348517894744873
Epoch: 8, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.491076707839966
Epoch: 9, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.454707622528076
Epoch: 10, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.623 Vali Acc: 0.780 Test Loss: 0.623 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.440755367279053
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.438 Vali Acc: 0.844 Test Loss: 0.438 Test Acc: 0.844
Validation loss decreased (-0.826584 --> -0.843926).  Saving model ...
Epoch: 12 cost time: 14.90062689781189
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.483 Vali Acc: 0.786 Test Loss: 0.483 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.89345645904541
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.470 Vali Acc: 0.827 Test Loss: 0.470 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.023698091506958
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.490 Vali Acc: 0.798 Test Loss: 0.490 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 14.813936471939087
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 15.117945671081543
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 14.9867262840271
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.798 Test Loss: 0.498 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 15.119492053985596
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.821 Test Loss: 0.487 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 15.223983526229858
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 14.689993619918823
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.821 Test Loss: 0.483 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 14.85128140449524
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.827 Test Loss: 0.490 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 11264967
model size : 44.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 28.128808975219727
Epoch: 1, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.660 Vali Acc: 0.358 Test Loss: 1.660 Test Acc: 0.358
Validation loss decreased (inf --> -0.358365).  Saving model ...
Epoch: 2 cost time: 25.759888410568237
Epoch: 2, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.267 Vali Acc: 0.520 Test Loss: 1.267 Test Acc: 0.520
Validation loss decreased (-0.358365 --> -0.520219).  Saving model ...
Epoch: 3 cost time: 25.064945220947266
Epoch: 3, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.094 Vali Acc: 0.578 Test Loss: 1.094 Test Acc: 0.578
Validation loss decreased (-0.520219 --> -0.578024).  Saving model ...
Epoch: 4 cost time: 25.2868492603302
Epoch: 4, Steps: 17 | Train Loss: 0.780 Vali Loss: 0.857 Vali Acc: 0.636 Test Loss: 0.857 Test Acc: 0.636
Validation loss decreased (-0.578024 --> -0.635830).  Saving model ...
Epoch: 5 cost time: 23.095690965652466
Epoch: 5, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.770 Vali Acc: 0.723 Test Loss: 0.770 Test Acc: 0.723
Validation loss decreased (-0.635830 --> -0.722536).  Saving model ...
Epoch: 6 cost time: 23.678525924682617
Epoch: 6, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.802 Vali Acc: 0.740 Test Loss: 0.802 Test Acc: 0.740
Validation loss decreased (-0.722536 --> -0.739876).  Saving model ...
Epoch: 7 cost time: 24.738614797592163
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
Validation loss decreased (-0.739876 --> -0.838145).  Saving model ...
Epoch: 8 cost time: 25.442773580551147
Epoch: 8, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.556 Vali Acc: 0.775 Test Loss: 0.556 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.906280040740967
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.509 Vali Acc: 0.827 Test Loss: 0.509 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 25.17765760421753
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
Validation loss decreased (-0.838145 --> -0.855487).  Saving model ...
Epoch: 11 cost time: 23.224481105804443
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.503 Vali Acc: 0.798 Test Loss: 0.503 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 27.5740065574646
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.798 Test Loss: 0.522 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 27.416127681732178
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 27.960159063339233
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.658 Vali Acc: 0.757 Test Loss: 0.658 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 28.012622356414795
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.702 Vali Acc: 0.740 Test Loss: 0.702 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 28.16655445098877
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 28.29419469833374
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861268).  Saving model ...
Epoch: 18 cost time: 27.97024917602539
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 27.852673053741455
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 27.854331254959106
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 27.781962871551514
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 27.555098295211792
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.844 Test Loss: 0.455 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 28.516075372695923
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 26.96279263496399
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 26.816158056259155
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 26.69085383415222
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 22.869412422180176
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 37744071
model size : 145.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.005226850509644
Epoch: 1, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.707 Vali Acc: 0.295 Test Loss: 1.707 Test Acc: 0.295
Validation loss decreased (inf --> -0.294781).  Saving model ...
Epoch: 2 cost time: 11.170820713043213
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.344 Vali Acc: 0.416 Test Loss: 1.344 Test Acc: 0.416
Validation loss decreased (-0.294781 --> -0.416172).  Saving model ...
Epoch: 3 cost time: 11.188509941101074
Epoch: 3, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.118 Vali Acc: 0.538 Test Loss: 1.118 Test Acc: 0.538
Validation loss decreased (-0.416172 --> -0.537561).  Saving model ...
Epoch: 4 cost time: 11.437055110931396
Epoch: 4, Steps: 17 | Train Loss: 0.814 Vali Loss: 0.838 Vali Acc: 0.751 Test Loss: 0.838 Test Acc: 0.751
Validation loss decreased (-0.537561 --> -0.751437).  Saving model ...
Epoch: 5 cost time: 11.465986251831055
Epoch: 5, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.738 Vali Acc: 0.751 Test Loss: 0.738 Test Acc: 0.751
Validation loss decreased (-0.751437 --> -0.751438).  Saving model ...
Epoch: 6 cost time: 11.152876138687134
Epoch: 6, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.556 Vali Acc: 0.827 Test Loss: 0.556 Test Acc: 0.827
Validation loss decreased (-0.751438 --> -0.826584).  Saving model ...
Epoch: 7 cost time: 11.516940593719482
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.630 Vali Acc: 0.769 Test Loss: 0.630 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.466861248016357
Epoch: 8, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.47697377204895
Epoch: 9, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.509405612945557
Epoch: 10, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.623 Vali Acc: 0.780 Test Loss: 0.623 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.51872968673706
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.438 Vali Acc: 0.844 Test Loss: 0.438 Test Acc: 0.844
Validation loss decreased (-0.826584 --> -0.843926).  Saving model ...
Epoch: 12 cost time: 11.534834623336792
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.483 Vali Acc: 0.786 Test Loss: 0.483 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.929258108139038
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.470 Vali Acc: 0.827 Test Loss: 0.470 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.941349029541016
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.490 Vali Acc: 0.798 Test Loss: 0.490 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.81726336479187
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.00178050994873
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.983347654342651
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.798 Test Loss: 0.498 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 11.702728748321533
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.821 Test Loss: 0.487 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.62028694152832
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.804622650146484
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.821 Test Loss: 0.482 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.974600791931152
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.827 Test Loss: 0.490 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 11264967
model size : 44.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.721431493759155
Epoch: 1, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.660 Vali Acc: 0.358 Test Loss: 1.660 Test Acc: 0.358
Validation loss decreased (inf --> -0.358365).  Saving model ...
Epoch: 2 cost time: 16.690118312835693
Epoch: 2, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.267 Vali Acc: 0.520 Test Loss: 1.267 Test Acc: 0.520
Validation loss decreased (-0.358365 --> -0.520219).  Saving model ...
Epoch: 3 cost time: 17.04907774925232
Epoch: 3, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.094 Vali Acc: 0.578 Test Loss: 1.094 Test Acc: 0.578
Validation loss decreased (-0.520219 --> -0.578024).  Saving model ...
Epoch: 4 cost time: 17.064533233642578
Epoch: 4, Steps: 17 | Train Loss: 0.780 Vali Loss: 0.857 Vali Acc: 0.636 Test Loss: 0.857 Test Acc: 0.636
Validation loss decreased (-0.578024 --> -0.635830).  Saving model ...
Epoch: 5 cost time: 17.175793886184692
Epoch: 5, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.770 Vali Acc: 0.723 Test Loss: 0.770 Test Acc: 0.723
Validation loss decreased (-0.635830 --> -0.722536).  Saving model ...
Epoch: 6 cost time: 17.16239881515503
Epoch: 6, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.802 Vali Acc: 0.740 Test Loss: 0.802 Test Acc: 0.740
Validation loss decreased (-0.722536 --> -0.739876).  Saving model ...
Epoch: 7 cost time: 17.07866382598877
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
Validation loss decreased (-0.739876 --> -0.838145).  Saving model ...
Epoch: 8 cost time: 16.20326256752014
Epoch: 8, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.556 Vali Acc: 0.775 Test Loss: 0.556 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.33500027656555
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.509 Vali Acc: 0.827 Test Loss: 0.509 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.594898462295532
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
Validation loss decreased (-0.838145 --> -0.855487).  Saving model ...
Epoch: 11 cost time: 14.351919174194336
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.504 Vali Acc: 0.798 Test Loss: 0.504 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.012558221817017
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.521 Vali Acc: 0.798 Test Loss: 0.521 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.152601480484009
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 15.214572668075562
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.666 Vali Acc: 0.757 Test Loss: 0.666 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 15.995702743530273
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.706 Vali Acc: 0.740 Test Loss: 0.706 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 15.857041358947754
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 15.957742691040039
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.412 Vali Acc: 0.861 Test Loss: 0.412 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861268).  Saving model ...
Epoch: 18 cost time: 16.12168288230896
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.832 Test Loss: 0.439 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 15.552128791809082
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.832 Test Loss: 0.468 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 16.377306938171387
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.832 Test Loss: 0.458 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 14.86214828491211
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.457 Vali Acc: 0.844 Test Loss: 0.457 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 16.83245348930359
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.844 Test Loss: 0.460 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 16.63697600364685
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 16.92997145652771
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.844 Test Loss: 0.474 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 16.524373769760132
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 16.71725296974182
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 16.650437593460083
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 37744071
model size : 145.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.086084127426147
Epoch: 1, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.707 Vali Acc: 0.295 Test Loss: 1.707 Test Acc: 0.295
Validation loss decreased (inf --> -0.294781).  Saving model ...
Epoch: 2 cost time: 7.493788003921509
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.344 Vali Acc: 0.416 Test Loss: 1.344 Test Acc: 0.416
Validation loss decreased (-0.294781 --> -0.416172).  Saving model ...
Epoch: 3 cost time: 7.525341272354126
Epoch: 3, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.118 Vali Acc: 0.538 Test Loss: 1.118 Test Acc: 0.538
Validation loss decreased (-0.416172 --> -0.537561).  Saving model ...
Epoch: 4 cost time: 7.438638687133789
Epoch: 4, Steps: 17 | Train Loss: 0.814 Vali Loss: 0.838 Vali Acc: 0.751 Test Loss: 0.838 Test Acc: 0.751
Validation loss decreased (-0.537561 --> -0.751437).  Saving model ...
Epoch: 5 cost time: 7.5632548332214355
Epoch: 5, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.738 Vali Acc: 0.751 Test Loss: 0.738 Test Acc: 0.751
Validation loss decreased (-0.751437 --> -0.751438).  Saving model ...
Epoch: 6 cost time: 7.336134672164917
Epoch: 6, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.556 Vali Acc: 0.827 Test Loss: 0.556 Test Acc: 0.827
Validation loss decreased (-0.751438 --> -0.826584).  Saving model ...
Epoch: 7 cost time: 7.515507221221924
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.630 Vali Acc: 0.769 Test Loss: 0.630 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.271472692489624
Epoch: 8, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.46007227897644
Epoch: 9, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.073301792144775
Epoch: 10, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.623 Vali Acc: 0.780 Test Loss: 0.623 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.096625566482544
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.439 Vali Acc: 0.844 Test Loss: 0.439 Test Acc: 0.844
Validation loss decreased (-0.826584 --> -0.843926).  Saving model ...
Epoch: 12 cost time: 7.04789924621582
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.484 Vali Acc: 0.786 Test Loss: 0.484 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.071389436721802
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.827 Test Loss: 0.471 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.029087781906128
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.798 Test Loss: 0.493 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.081845760345459
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.149181127548218
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.827 Test Loss: 0.493 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.020218372344971
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.798 Test Loss: 0.498 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.074744701385498
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.059581756591797
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.815 Test Loss: 0.497 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.7684080600738525
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.815 Test Loss: 0.506 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.666280031204224
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.815 Test Loss: 0.508 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 11264967
model size : 44.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.651014804840088
Epoch: 1, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.688 Vali Acc: 0.312 Test Loss: 1.688 Test Acc: 0.312
Validation loss decreased (inf --> -0.312122).  Saving model ...
Epoch: 2 cost time: 18.657915115356445
Epoch: 2, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.264 Vali Acc: 0.607 Test Loss: 1.264 Test Acc: 0.607
Validation loss decreased (-0.312122 --> -0.606924).  Saving model ...
Epoch: 3 cost time: 18.92813277244568
Epoch: 3, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.235 Vali Acc: 0.445 Test Loss: 1.235 Test Acc: 0.445
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.25087022781372
Epoch: 4, Steps: 17 | Train Loss: 0.830 Vali Loss: 0.906 Vali Acc: 0.665 Test Loss: 0.906 Test Acc: 0.665
Validation loss decreased (-0.606924 --> -0.664731).  Saving model ...
Epoch: 5 cost time: 18.851789712905884
Epoch: 5, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.754 Vali Acc: 0.705 Test Loss: 0.754 Test Acc: 0.705
Validation loss decreased (-0.664731 --> -0.705195).  Saving model ...
Epoch: 6 cost time: 19.120630741119385
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.554 Vali Acc: 0.821 Test Loss: 0.554 Test Acc: 0.821
Validation loss decreased (-0.705195 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 19.22464084625244
Epoch: 7, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.517 Vali Acc: 0.832 Test Loss: 0.517 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832365).  Saving model ...
Epoch: 8 cost time: 16.557528972625732
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.591 Vali Acc: 0.769 Test Loss: 0.591 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 20.060023069381714
Epoch: 9, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.535 Vali Acc: 0.815 Test Loss: 0.535 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.147855758666992
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 20.107956886291504
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.460 Vali Acc: 0.809 Test Loss: 0.460 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 19.87841534614563
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.509 Vali Acc: 0.832 Test Loss: 0.509 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 13 cost time: 19.871267557144165
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.618 Vali Acc: 0.821 Test Loss: 0.618 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 19.665271520614624
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.587 Vali Acc: 0.798 Test Loss: 0.587 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 19.47122097015381
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.665 Vali Acc: 0.792 Test Loss: 0.665 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 16.208844661712646
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.467 Vali Acc: 0.827 Test Loss: 0.467 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 15.924507141113281
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.460 Vali Acc: 0.861 Test Loss: 0.460 Test Acc: 0.861
Validation loss decreased (-0.832365 --> -0.861267).  Saving model ...
Epoch: 18 cost time: 15.765135288238525
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.603 Vali Acc: 0.792 Test Loss: 0.603 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 17.299358367919922
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.855 Test Loss: 0.467 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 18.052849054336548
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 18.317234754562378
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.855 Test Loss: 0.540 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 18.475234508514404
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 18.417362213134766
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 18.524109363555908
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 18.429929494857788
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 17.876479148864746
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 17.57154893875122
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.855 Test Loss: 0.544 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 18997703
model size : 73.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.842732429504395
Epoch: 1, Steps: 17 | Train Loss: 1.894 Vali Loss: 1.661 Vali Acc: 0.335 Test Loss: 1.661 Test Acc: 0.335
Validation loss decreased (inf --> -0.335244).  Saving model ...
Epoch: 2 cost time: 8.634392261505127
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.330 Vali Acc: 0.555 Test Loss: 1.330 Test Acc: 0.555
Validation loss decreased (-0.335244 --> -0.554900).  Saving model ...
Epoch: 3 cost time: 8.642284393310547
Epoch: 3, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.124 Vali Acc: 0.543 Test Loss: 1.124 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.66495132446289
Epoch: 4, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.934 Vali Acc: 0.671 Test Loss: 0.934 Test Acc: 0.671
Validation loss decreased (-0.554900 --> -0.670511).  Saving model ...
Epoch: 5 cost time: 8.626553297042847
Epoch: 5, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.822 Vali Acc: 0.642 Test Loss: 0.822 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.546358585357666
Epoch: 6, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.657 Vali Acc: 0.757 Test Loss: 0.657 Test Acc: 0.757
Validation loss decreased (-0.670511 --> -0.757219).  Saving model ...
Epoch: 7 cost time: 8.678942918777466
Epoch: 7, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
Validation loss decreased (-0.757219 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 8.67270278930664
Epoch: 8, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.563 Vali Acc: 0.815 Test Loss: 0.563 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 9 cost time: 8.414730072021484
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820805).  Saving model ...
Epoch: 10 cost time: 8.85597562789917
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.647 Vali Acc: 0.798 Test Loss: 0.647 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.897657632827759
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.564 Vali Acc: 0.780 Test Loss: 0.564 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.759961366653442
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.517 Vali Acc: 0.792 Test Loss: 0.517 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.935040712356567
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.491 Vali Acc: 0.821 Test Loss: 0.491 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.896711111068726
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.798 Test Loss: 0.534 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.775489568710327
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.798 Test Loss: 0.524 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.966979265213013
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.106122732162476
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.821 Test Loss: 0.516 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.867105007171631
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.6606481075286865
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.815 Test Loss: 0.517 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 5757895
model size : 23.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 16.182319402694702
Epoch: 1, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.688 Vali Acc: 0.312 Test Loss: 1.688 Test Acc: 0.312
Validation loss decreased (inf --> -0.312122).  Saving model ...
Epoch: 2 cost time: 13.761582374572754
Epoch: 2, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.264 Vali Acc: 0.607 Test Loss: 1.264 Test Acc: 0.607
Validation loss decreased (-0.312122 --> -0.606924).  Saving model ...
Epoch: 3 cost time: 13.701876401901245
Epoch: 3, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.235 Vali Acc: 0.445 Test Loss: 1.235 Test Acc: 0.445
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.807399272918701
Epoch: 4, Steps: 17 | Train Loss: 0.830 Vali Loss: 0.906 Vali Acc: 0.665 Test Loss: 0.906 Test Acc: 0.665
Validation loss decreased (-0.606924 --> -0.664731).  Saving model ...
Epoch: 5 cost time: 13.664632797241211
Epoch: 5, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.754 Vali Acc: 0.705 Test Loss: 0.754 Test Acc: 0.705
Validation loss decreased (-0.664731 --> -0.705195).  Saving model ...
Epoch: 6 cost time: 13.737786054611206
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.554 Vali Acc: 0.821 Test Loss: 0.554 Test Acc: 0.821
Validation loss decreased (-0.705195 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 13.82576298713684
Epoch: 7, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.517 Vali Acc: 0.832 Test Loss: 0.517 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832365).  Saving model ...
Epoch: 8 cost time: 13.816001176834106
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.591 Vali Acc: 0.769 Test Loss: 0.591 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.711050510406494
Epoch: 9, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.535 Vali Acc: 0.815 Test Loss: 0.535 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.186554670333862
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.036678791046143
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.460 Vali Acc: 0.809 Test Loss: 0.460 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.7021803855896
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.510 Vali Acc: 0.832 Test Loss: 0.510 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 13 cost time: 14.284201860427856
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.612 Vali Acc: 0.821 Test Loss: 0.612 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.345014333724976
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.593 Vali Acc: 0.798 Test Loss: 0.593 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.193382263183594
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.617 Vali Acc: 0.798 Test Loss: 0.617 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 14.368901252746582
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.475 Vali Acc: 0.827 Test Loss: 0.475 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 14.249775886535645
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.460 Vali Acc: 0.844 Test Loss: 0.460 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843926).  Saving model ...
Epoch: 18 cost time: 14.070968866348267
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.675 Vali Acc: 0.775 Test Loss: 0.675 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 13.828098773956299
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.587 Vali Acc: 0.827 Test Loss: 0.587 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 12.715705394744873
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.595 Vali Acc: 0.838 Test Loss: 0.595 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 13.167272806167603
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 11.56746506690979
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.832 Test Loss: 0.531 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 11.68834638595581
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 11.349871397018433
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.827 Test Loss: 0.538 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 11.707510471343994
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.821 Test Loss: 0.547 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 13.394051313400269
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.827 Test Loss: 0.547 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 13.353880643844604
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.827 Test Loss: 0.549 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 18997703
model size : 73.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.91708517074585
Epoch: 1, Steps: 17 | Train Loss: 1.894 Vali Loss: 1.661 Vali Acc: 0.335 Test Loss: 1.661 Test Acc: 0.335
Validation loss decreased (inf --> -0.335244).  Saving model ...
Epoch: 2 cost time: 7.187259912490845
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.330 Vali Acc: 0.555 Test Loss: 1.330 Test Acc: 0.555
Validation loss decreased (-0.335244 --> -0.554900).  Saving model ...
Epoch: 3 cost time: 7.124980926513672
Epoch: 3, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.124 Vali Acc: 0.543 Test Loss: 1.124 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.87828803062439
Epoch: 4, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.934 Vali Acc: 0.671 Test Loss: 0.934 Test Acc: 0.671
Validation loss decreased (-0.554900 --> -0.670511).  Saving model ...
Epoch: 5 cost time: 6.9783899784088135
Epoch: 5, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.822 Vali Acc: 0.642 Test Loss: 0.822 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.156330347061157
Epoch: 6, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.657 Vali Acc: 0.757 Test Loss: 0.657 Test Acc: 0.757
Validation loss decreased (-0.670511 --> -0.757219).  Saving model ...
Epoch: 7 cost time: 7.094923496246338
Epoch: 7, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
Validation loss decreased (-0.757219 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 7.1557512283325195
Epoch: 8, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.563 Vali Acc: 0.815 Test Loss: 0.563 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 9 cost time: 7.140371084213257
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820805).  Saving model ...
Epoch: 10 cost time: 7.252018451690674
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.647 Vali Acc: 0.798 Test Loss: 0.647 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.455612659454346
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.564 Vali Acc: 0.780 Test Loss: 0.564 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.592473983764648
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.517 Vali Acc: 0.792 Test Loss: 0.517 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.6336281299591064
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.491 Vali Acc: 0.821 Test Loss: 0.491 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.821428060531616
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.798 Test Loss: 0.534 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.694222688674927
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.798 Test Loss: 0.524 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.77132773399353
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.799802780151367
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.821 Test Loss: 0.516 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.46268630027771
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.22039008140564
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.815 Test Loss: 0.517 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 5757895
model size : 23.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.502755641937256
Epoch: 1, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.688 Vali Acc: 0.312 Test Loss: 1.688 Test Acc: 0.312
Validation loss decreased (inf --> -0.312122).  Saving model ...
Epoch: 2 cost time: 9.983465433120728
Epoch: 2, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.264 Vali Acc: 0.607 Test Loss: 1.264 Test Acc: 0.607
Validation loss decreased (-0.312122 --> -0.606924).  Saving model ...
Epoch: 3 cost time: 10.037652730941772
Epoch: 3, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.235 Vali Acc: 0.445 Test Loss: 1.235 Test Acc: 0.445
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.959187269210815
Epoch: 4, Steps: 17 | Train Loss: 0.830 Vali Loss: 0.906 Vali Acc: 0.665 Test Loss: 0.906 Test Acc: 0.665
Validation loss decreased (-0.606924 --> -0.664731).  Saving model ...
Epoch: 5 cost time: 9.885080814361572
Epoch: 5, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.754 Vali Acc: 0.705 Test Loss: 0.754 Test Acc: 0.705
Validation loss decreased (-0.664731 --> -0.705195).  Saving model ...
Epoch: 6 cost time: 10.246796131134033
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.554 Vali Acc: 0.821 Test Loss: 0.554 Test Acc: 0.821
Validation loss decreased (-0.705195 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 10.26729154586792
Epoch: 7, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.517 Vali Acc: 0.832 Test Loss: 0.517 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832365).  Saving model ...
Epoch: 8 cost time: 9.945631742477417
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.591 Vali Acc: 0.769 Test Loss: 0.591 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.378303527832031
Epoch: 9, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.536 Vali Acc: 0.815 Test Loss: 0.536 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.353793621063232
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.518568515777588
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.466 Vali Acc: 0.809 Test Loss: 0.466 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.335675954818726
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.536 Vali Acc: 0.821 Test Loss: 0.536 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.448105096817017
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.520 Vali Acc: 0.821 Test Loss: 0.520 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.418274879455566
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.821 Test Loss: 0.538 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.824376344680786
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.533 Vali Acc: 0.827 Test Loss: 0.533 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.294216871261597
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.255080223083496
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 18997703
model size : 73.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.858644485473633
Epoch: 1, Steps: 17 | Train Loss: 1.894 Vali Loss: 1.661 Vali Acc: 0.335 Test Loss: 1.661 Test Acc: 0.335
Validation loss decreased (inf --> -0.335244).  Saving model ...
Epoch: 2 cost time: 5.174638986587524
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.330 Vali Acc: 0.555 Test Loss: 1.330 Test Acc: 0.555
Validation loss decreased (-0.335244 --> -0.554900).  Saving model ...
Epoch: 3 cost time: 4.90639853477478
Epoch: 3, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.124 Vali Acc: 0.543 Test Loss: 1.124 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.179206848144531
Epoch: 4, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.934 Vali Acc: 0.671 Test Loss: 0.934 Test Acc: 0.671
Validation loss decreased (-0.554900 --> -0.670511).  Saving model ...
Epoch: 5 cost time: 5.052870512008667
Epoch: 5, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.822 Vali Acc: 0.642 Test Loss: 0.822 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.077992677688599
Epoch: 6, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.657 Vali Acc: 0.757 Test Loss: 0.657 Test Acc: 0.757
Validation loss decreased (-0.670511 --> -0.757219).  Saving model ...
Epoch: 7 cost time: 5.246055841445923
Epoch: 7, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
Validation loss decreased (-0.757219 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 4.533913612365723
Epoch: 8, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.563 Vali Acc: 0.815 Test Loss: 0.563 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 9 cost time: 4.701866149902344
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820805).  Saving model ...
Epoch: 10 cost time: 5.3617002964019775
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.647 Vali Acc: 0.798 Test Loss: 0.647 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.120541572570801
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.564 Vali Acc: 0.780 Test Loss: 0.564 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.294156551361084
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.517 Vali Acc: 0.792 Test Loss: 0.517 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.735626220703125
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.489 Vali Acc: 0.821 Test Loss: 0.489 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.73529052734375
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.798 Test Loss: 0.530 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.529302358627319
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.515 Vali Acc: 0.798 Test Loss: 0.515 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.578716039657593
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.528 Vali Acc: 0.798 Test Loss: 0.528 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.562190055847168
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.798 Test Loss: 0.522 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.6932337284088135
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.786 Test Loss: 0.532 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.687307357788086
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.815 Test Loss: 0.520 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 5757895
model size : 23.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.96518850326538
Epoch: 1, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.771 Vali Acc: 0.231 Test Loss: 1.771 Test Acc: 0.231
Validation loss decreased (inf --> -0.231196).  Saving model ...
Epoch: 2 cost time: 13.2825927734375
Epoch: 2, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.343 Vali Acc: 0.486 Test Loss: 1.343 Test Acc: 0.486
Validation loss decreased (-0.231196 --> -0.485536).  Saving model ...
Epoch: 3 cost time: 13.340226650238037
Epoch: 3, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.099 Vali Acc: 0.572 Test Loss: 1.099 Test Acc: 0.572
Validation loss decreased (-0.485536 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 13.34104061126709
Epoch: 4, Steps: 17 | Train Loss: 0.874 Vali Loss: 0.950 Vali Acc: 0.688 Test Loss: 0.950 Test Acc: 0.688
Validation loss decreased (-0.572243 --> -0.687852).  Saving model ...
Epoch: 5 cost time: 13.192469835281372
Epoch: 5, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.790 Vali Acc: 0.688 Test Loss: 0.790 Test Acc: 0.688
Validation loss decreased (-0.687852 --> -0.687853).  Saving model ...
Epoch: 6 cost time: 13.230405807495117
Epoch: 6, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
Validation loss decreased (-0.687853 --> -0.745658).  Saving model ...
Epoch: 7 cost time: 13.108314275741577
Epoch: 7, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.695 Vali Acc: 0.734 Test Loss: 0.695 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.976263284683228
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.699 Vali Acc: 0.717 Test Loss: 0.699 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.162447452545166
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.572 Vali Acc: 0.780 Test Loss: 0.572 Test Acc: 0.780
Validation loss decreased (-0.745658 --> -0.780341).  Saving model ...
Epoch: 10 cost time: 10.928940534591675
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.773 Vali Acc: 0.734 Test Loss: 0.773 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.57255482673645
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.596 Vali Acc: 0.763 Test Loss: 0.596 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.628284215927124
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.624 Vali Acc: 0.786 Test Loss: 0.624 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 13 cost time: 10.811548471450806
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.775 Test Loss: 0.604 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.490975379943848
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.775 Test Loss: 0.628 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.163668870925903
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.615 Vali Acc: 0.769 Test Loss: 0.615 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.291699171066284
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.637 Vali Acc: 0.763 Test Loss: 0.637 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.448474645614624
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.763 Test Loss: 0.657 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.167678117752075
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.763 Test Loss: 0.666 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.100494861602783
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.763 Test Loss: 0.654 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.337425470352173
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.780 Test Loss: 0.616 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.720922946929932
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.626 Vali Acc: 0.763 Test Loss: 0.626 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.823251008987427
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.769 Test Loss: 0.656 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 9624519
model size : 37.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.190932750701904
Epoch: 1, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.747 Vali Acc: 0.266 Test Loss: 1.747 Test Acc: 0.266
Validation loss decreased (inf --> -0.265878).  Saving model ...
Epoch: 2 cost time: 5.6136157512664795
Epoch: 2, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.377 Vali Acc: 0.422 Test Loss: 1.377 Test Acc: 0.422
Validation loss decreased (-0.265878 --> -0.421952).  Saving model ...
Epoch: 3 cost time: 5.788155555725098
Epoch: 3, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.127 Vali Acc: 0.572 Test Loss: 1.127 Test Acc: 0.572
Validation loss decreased (-0.421952 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 5.5502636432647705
Epoch: 4, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
Validation loss decreased (-0.572243 --> -0.595365).  Saving model ...
Epoch: 5 cost time: 5.567355155944824
Epoch: 5, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.818 Vali Acc: 0.665 Test Loss: 0.818 Test Acc: 0.665
Validation loss decreased (-0.595365 --> -0.664732).  Saving model ...
Epoch: 6 cost time: 5.616814136505127
Epoch: 6, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.729 Vali Acc: 0.705 Test Loss: 0.729 Test Acc: 0.705
Validation loss decreased (-0.664732 --> -0.705195).  Saving model ...
Epoch: 7 cost time: 6.023918390274048
Epoch: 7, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.625 Vali Acc: 0.769 Test Loss: 0.625 Test Acc: 0.769
Validation loss decreased (-0.705195 --> -0.768780).  Saving model ...
Epoch: 8 cost time: 6.2578654289245605
Epoch: 8, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
Validation loss decreased (-0.768780 --> -0.803462).  Saving model ...
Epoch: 9 cost time: 6.417292356491089
Epoch: 9, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803463).  Saving model ...
Epoch: 10 cost time: 6.247741937637329
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.474 Vali Acc: 0.803 Test Loss: 0.474 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 11 cost time: 6.284377098083496
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.469 Vali Acc: 0.827 Test Loss: 0.469 Test Acc: 0.827
Validation loss decreased (-0.803463 --> -0.826585).  Saving model ...
Epoch: 12 cost time: 6.353578329086304
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.477 Vali Acc: 0.827 Test Loss: 0.477 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.1985368728637695
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.484 Vali Acc: 0.827 Test Loss: 0.484 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.686636686325073
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.485 Vali Acc: 0.815 Test Loss: 0.485 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.005141496658325
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.470 Vali Acc: 0.827 Test Loss: 0.470 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.614090919494629
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.827 Test Loss: 0.495 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.058748483657837
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.478 Vali Acc: 0.827 Test Loss: 0.478 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.258469820022583
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.815 Test Loss: 0.494 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.100270509719849
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838145).  Saving model ...
Epoch: 20 cost time: 6.03637957572937
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.479 Vali Acc: 0.821 Test Loss: 0.479 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.109173774719238
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.477 Vali Acc: 0.821 Test Loss: 0.477 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.097489833831787
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.554 Vali Acc: 0.815 Test Loss: 0.554 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.6534507274627686
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.428388357162476
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.815 Test Loss: 0.550 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.399650812149048
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.815 Test Loss: 0.551 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.435272455215454
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.815 Test Loss: 0.556 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.523890256881714
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.512270450592041
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.815 Test Loss: 0.554 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.1617302894592285
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.815 Test Loss: 0.566 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 3004359
model size : 12.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.725380420684814
Epoch: 1, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.771 Vali Acc: 0.231 Test Loss: 1.771 Test Acc: 0.231
Validation loss decreased (inf --> -0.231196).  Saving model ...
Epoch: 2 cost time: 9.72890043258667
Epoch: 2, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.343 Vali Acc: 0.486 Test Loss: 1.343 Test Acc: 0.486
Validation loss decreased (-0.231196 --> -0.485536).  Saving model ...
Epoch: 3 cost time: 9.864305973052979
Epoch: 3, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.099 Vali Acc: 0.572 Test Loss: 1.099 Test Acc: 0.572
Validation loss decreased (-0.485536 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 9.553425550460815
Epoch: 4, Steps: 17 | Train Loss: 0.874 Vali Loss: 0.950 Vali Acc: 0.688 Test Loss: 0.950 Test Acc: 0.688
Validation loss decreased (-0.572243 --> -0.687852).  Saving model ...
Epoch: 5 cost time: 9.904803276062012
Epoch: 5, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.790 Vali Acc: 0.688 Test Loss: 0.790 Test Acc: 0.688
Validation loss decreased (-0.687852 --> -0.687853).  Saving model ...
Epoch: 6 cost time: 9.682250261306763
Epoch: 6, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
Validation loss decreased (-0.687853 --> -0.745658).  Saving model ...
Epoch: 7 cost time: 9.910671710968018
Epoch: 7, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.695 Vali Acc: 0.734 Test Loss: 0.695 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.628446817398071
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.699 Vali Acc: 0.717 Test Loss: 0.699 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.850021600723267
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.572 Vali Acc: 0.780 Test Loss: 0.572 Test Acc: 0.780
Validation loss decreased (-0.745658 --> -0.780341).  Saving model ...
Epoch: 10 cost time: 9.676946640014648
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.773 Vali Acc: 0.734 Test Loss: 0.773 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.958686351776123
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.596 Vali Acc: 0.763 Test Loss: 0.596 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.681150197982788
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.624 Vali Acc: 0.786 Test Loss: 0.624 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 13 cost time: 8.985803604125977
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.775 Test Loss: 0.604 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.586344957351685
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.775 Test Loss: 0.628 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.582688331604004
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.615 Vali Acc: 0.769 Test Loss: 0.615 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.938464403152466
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.637 Vali Acc: 0.763 Test Loss: 0.637 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.042768478393555
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.763 Test Loss: 0.657 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.997313261032104
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.763 Test Loss: 0.666 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.056154251098633
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.763 Test Loss: 0.654 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.932029962539673
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.780 Test Loss: 0.617 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.503204345703125
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.625 Vali Acc: 0.763 Test Loss: 0.625 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.465198040008545
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.769 Test Loss: 0.656 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 9624519
model size : 37.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.542943477630615
Epoch: 1, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.747 Vali Acc: 0.266 Test Loss: 1.747 Test Acc: 0.266
Validation loss decreased (inf --> -0.265878).  Saving model ...
Epoch: 2 cost time: 5.128846168518066
Epoch: 2, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.377 Vali Acc: 0.422 Test Loss: 1.377 Test Acc: 0.422
Validation loss decreased (-0.265878 --> -0.421952).  Saving model ...
Epoch: 3 cost time: 4.938969135284424
Epoch: 3, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.127 Vali Acc: 0.572 Test Loss: 1.127 Test Acc: 0.572
Validation loss decreased (-0.421952 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 5.048020124435425
Epoch: 4, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
Validation loss decreased (-0.572243 --> -0.595365).  Saving model ...
Epoch: 5 cost time: 5.076920032501221
Epoch: 5, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.818 Vali Acc: 0.665 Test Loss: 0.818 Test Acc: 0.665
Validation loss decreased (-0.595365 --> -0.664732).  Saving model ...
Epoch: 6 cost time: 5.0609965324401855
Epoch: 6, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.729 Vali Acc: 0.705 Test Loss: 0.729 Test Acc: 0.705
Validation loss decreased (-0.664732 --> -0.705195).  Saving model ...
Epoch: 7 cost time: 5.118385076522827
Epoch: 7, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.625 Vali Acc: 0.769 Test Loss: 0.625 Test Acc: 0.769
Validation loss decreased (-0.705195 --> -0.768780).  Saving model ...
Epoch: 8 cost time: 4.382997035980225
Epoch: 8, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
Validation loss decreased (-0.768780 --> -0.803462).  Saving model ...
Epoch: 9 cost time: 4.492055892944336
Epoch: 9, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803463).  Saving model ...
Epoch: 10 cost time: 4.417155504226685
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.474 Vali Acc: 0.803 Test Loss: 0.474 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 11 cost time: 4.366058826446533
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.469 Vali Acc: 0.827 Test Loss: 0.469 Test Acc: 0.827
Validation loss decreased (-0.803463 --> -0.826585).  Saving model ...
Epoch: 12 cost time: 4.535423278808594
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.477 Vali Acc: 0.827 Test Loss: 0.477 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.339761257171631
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.484 Vali Acc: 0.827 Test Loss: 0.484 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.543995141983032
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.485 Vali Acc: 0.815 Test Loss: 0.485 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.623956918716431
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.470 Vali Acc: 0.827 Test Loss: 0.470 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.829509258270264
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.827 Test Loss: 0.495 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.46985650062561
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.827 Test Loss: 0.479 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.103253602981567
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.821 Test Loss: 0.491 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.23200249671936
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.487 Vali Acc: 0.827 Test Loss: 0.487 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.27370548248291
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.821 Test Loss: 0.499 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.104243278503418
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.496 Vali Acc: 0.832 Test Loss: 0.496 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 22 cost time: 5.1253509521484375
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.832 Test Loss: 0.485 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 23 cost time: 4.955626726150513
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 24 cost time: 5.027817487716675
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.832 Test Loss: 0.503 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.001486539840698
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.827 Test Loss: 0.521 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.01872992515564
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.827 Test Loss: 0.513 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.005835771560669
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.827 Test Loss: 0.515 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.183298826217651
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.827 Test Loss: 0.512 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.196393013000488
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.827 Test Loss: 0.522 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.341578483581543
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.827 Test Loss: 0.519 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 3004359
model size : 12.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.161324262619019
Epoch: 1, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.771 Vali Acc: 0.231 Test Loss: 1.771 Test Acc: 0.231
Validation loss decreased (inf --> -0.231196).  Saving model ...
Epoch: 2 cost time: 5.90153169631958
Epoch: 2, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.343 Vali Acc: 0.486 Test Loss: 1.343 Test Acc: 0.486
Validation loss decreased (-0.231196 --> -0.485536).  Saving model ...
Epoch: 3 cost time: 5.81132698059082
Epoch: 3, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.099 Vali Acc: 0.572 Test Loss: 1.099 Test Acc: 0.572
Validation loss decreased (-0.485536 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 5.991826295852661
Epoch: 4, Steps: 17 | Train Loss: 0.874 Vali Loss: 0.950 Vali Acc: 0.688 Test Loss: 0.950 Test Acc: 0.688
Validation loss decreased (-0.572243 --> -0.687852).  Saving model ...
Epoch: 5 cost time: 6.307063817977905
Epoch: 5, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.790 Vali Acc: 0.688 Test Loss: 0.790 Test Acc: 0.688
Validation loss decreased (-0.687852 --> -0.687853).  Saving model ...
Epoch: 6 cost time: 5.9567413330078125
Epoch: 6, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
Validation loss decreased (-0.687853 --> -0.745658).  Saving model ...
Epoch: 7 cost time: 6.2246339321136475
Epoch: 7, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.695 Vali Acc: 0.734 Test Loss: 0.695 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.901328802108765
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.699 Vali Acc: 0.717 Test Loss: 0.699 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.632826089859009
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.572 Vali Acc: 0.780 Test Loss: 0.572 Test Acc: 0.780
Validation loss decreased (-0.745658 --> -0.780341).  Saving model ...
Epoch: 10 cost time: 6.784855842590332
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.773 Vali Acc: 0.734 Test Loss: 0.773 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.1568663120269775
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.596 Vali Acc: 0.763 Test Loss: 0.596 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.1201395988464355
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.624 Vali Acc: 0.786 Test Loss: 0.624 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 13 cost time: 6.3248937129974365
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.775 Test Loss: 0.604 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.301213979721069
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.775 Test Loss: 0.627 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.419159889221191
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.769 Test Loss: 0.611 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.267838001251221
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.763 Test Loss: 0.636 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.304373264312744
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.757 Test Loss: 0.653 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.24456524848938
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.769 Test Loss: 0.660 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.311075687408447
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.763 Test Loss: 0.646 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.277208089828491
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.394046306610107
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.763 Test Loss: 0.668 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.208537578582764
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.757 Test Loss: 0.684 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 9624519
model size : 37.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.8940980434417725
Epoch: 1, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.747 Vali Acc: 0.266 Test Loss: 1.747 Test Acc: 0.266
Validation loss decreased (inf --> -0.265878).  Saving model ...
Epoch: 2 cost time: 3.2848169803619385
Epoch: 2, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.377 Vali Acc: 0.422 Test Loss: 1.377 Test Acc: 0.422
Validation loss decreased (-0.265878 --> -0.421952).  Saving model ...
Epoch: 3 cost time: 3.2739193439483643
Epoch: 3, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.127 Vali Acc: 0.572 Test Loss: 1.127 Test Acc: 0.572
Validation loss decreased (-0.421952 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 3.231123685836792
Epoch: 4, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
Validation loss decreased (-0.572243 --> -0.595365).  Saving model ...
Epoch: 5 cost time: 3.0256569385528564
Epoch: 5, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.818 Vali Acc: 0.665 Test Loss: 0.818 Test Acc: 0.665
Validation loss decreased (-0.595365 --> -0.664732).  Saving model ...
Epoch: 6 cost time: 3.9651548862457275
Epoch: 6, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.729 Vali Acc: 0.705 Test Loss: 0.729 Test Acc: 0.705
Validation loss decreased (-0.664732 --> -0.705195).  Saving model ...
Epoch: 7 cost time: 3.729076385498047
Epoch: 7, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.625 Vali Acc: 0.769 Test Loss: 0.625 Test Acc: 0.769
Validation loss decreased (-0.705195 --> -0.768780).  Saving model ...
Epoch: 8 cost time: 3.818709135055542
Epoch: 8, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
Validation loss decreased (-0.768780 --> -0.803462).  Saving model ...
Epoch: 9 cost time: 3.8895974159240723
Epoch: 9, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803463).  Saving model ...
Epoch: 10 cost time: 3.8354952335357666
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.474 Vali Acc: 0.803 Test Loss: 0.474 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 11 cost time: 3.6717355251312256
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.469 Vali Acc: 0.827 Test Loss: 0.469 Test Acc: 0.827
Validation loss decreased (-0.803463 --> -0.826585).  Saving model ...
Epoch: 12 cost time: 3.815450429916382
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.477 Vali Acc: 0.827 Test Loss: 0.477 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.891329288482666
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.484 Vali Acc: 0.827 Test Loss: 0.484 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.73237681388855
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.486 Vali Acc: 0.815 Test Loss: 0.486 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.791424036026001
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.827 Test Loss: 0.471 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.8356118202209473
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.497 Vali Acc: 0.827 Test Loss: 0.497 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.9060630798339844
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.827 Test Loss: 0.485 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.689091444015503
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.821 Test Loss: 0.497 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.831779718399048
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.486 Vali Acc: 0.832 Test Loss: 0.486 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 20 cost time: 3.893618583679199
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.827 Test Loss: 0.504 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8072752952575684
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.821 Test Loss: 0.502 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.780418634414673
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.832 Test Loss: 0.489 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.1450583934783936
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.832 Test Loss: 0.500 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.860898733139038
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.821 Test Loss: 0.500 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.7508580684661865
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.821 Test Loss: 0.517 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.637258291244507
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 27 cost time: 3.7480180263519287
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.827 Test Loss: 0.515 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4234020709991455
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.827 Test Loss: 0.513 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2793354988098145
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.827 Test Loss: 0.523 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.9810686111450195
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.827 Test Loss: 0.523 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 3004359
model size : 12.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.18183708190918
Epoch: 1, Steps: 17 | Train Loss: 1.927 Vali Loss: 1.825 Vali Acc: 0.266 Test Loss: 1.825 Test Acc: 0.266
Validation loss decreased (inf --> -0.265878).  Saving model ...
Epoch: 2 cost time: 11.781755208969116
Epoch: 2, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.528 Vali Acc: 0.439 Test Loss: 1.528 Test Acc: 0.439
Validation loss decreased (-0.265878 --> -0.439291).  Saving model ...
Epoch: 3 cost time: 11.790573120117188
Epoch: 3, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.297 Vali Acc: 0.520 Test Loss: 1.297 Test Acc: 0.520
Validation loss decreased (-0.439291 --> -0.520218).  Saving model ...
Epoch: 4 cost time: 11.725096940994263
Epoch: 4, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.100 Vali Acc: 0.630 Test Loss: 1.100 Test Acc: 0.630
Validation loss decreased (-0.520218 --> -0.630047).  Saving model ...
Epoch: 5 cost time: 11.858335733413696
Epoch: 5, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.989 Vali Acc: 0.613 Test Loss: 0.989 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.911665201187134
Epoch: 6, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.826 Vali Acc: 0.682 Test Loss: 0.826 Test Acc: 0.682
Validation loss decreased (-0.630047 --> -0.682073).  Saving model ...
Epoch: 7 cost time: 11.927622318267822
Epoch: 7, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.707 Vali Acc: 0.723 Test Loss: 0.707 Test Acc: 0.723
Validation loss decreased (-0.682073 --> -0.722536).  Saving model ...
Epoch: 8 cost time: 11.555530786514282
Epoch: 8, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.580 Vali Acc: 0.786 Test Loss: 0.580 Test Acc: 0.786
Validation loss decreased (-0.722536 --> -0.786121).  Saving model ...
Epoch: 9 cost time: 12.79421877861023
Epoch: 9, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.532 Vali Acc: 0.792 Test Loss: 0.532 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791902).  Saving model ...
Epoch: 10 cost time: 12.85416054725647
Epoch: 10, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.552 Vali Acc: 0.792 Test Loss: 0.552 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.917841672897339
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.708 Vali Acc: 0.809 Test Loss: 0.708 Test Acc: 0.809
Validation loss decreased (-0.791902 --> -0.809241).  Saving model ...
Epoch: 12 cost time: 11.645392656326294
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.514 Vali Acc: 0.827 Test Loss: 0.514 Test Acc: 0.827
Validation loss decreased (-0.809241 --> -0.826584).  Saving model ...
Epoch: 13 cost time: 11.583647727966309
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.697 Vali Acc: 0.798 Test Loss: 0.697 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.533292770385742
Epoch: 14, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.760 Vali Acc: 0.763 Test Loss: 0.760 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.519351959228516
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.476 Vali Acc: 0.815 Test Loss: 0.476 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.591598987579346
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.557462930679321
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.495 Vali Acc: 0.832 Test Loss: 0.495 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832365).  Saving model ...
Epoch: 18 cost time: 12.658674240112305
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.821 Test Loss: 0.544 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 12.665405750274658
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.821 Test Loss: 0.530 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 12.714364528656006
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.550 Vali Acc: 0.815 Test Loss: 0.550 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 12.597023963928223
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.821 Test Loss: 0.558 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 11.43724513053894
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.821 Test Loss: 0.576 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 12.317121028900146
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.827 Test Loss: 0.585 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 12.228163719177246
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.821 Test Loss: 0.589 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 12.092838287353516
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.832 Test Loss: 0.552 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 10.85631513595581
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.832 Test Loss: 0.510 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 10.803633689880371
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.832 Test Loss: 0.592 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 9500391
model size : 36.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.8877551555633545
Epoch: 1, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.832 Vali Acc: 0.243 Test Loss: 1.832 Test Acc: 0.243
Validation loss decreased (inf --> -0.242756).  Saving model ...
Epoch: 2 cost time: 5.621082305908203
Epoch: 2, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.509 Vali Acc: 0.405 Test Loss: 1.509 Test Acc: 0.405
Validation loss decreased (-0.242756 --> -0.404609).  Saving model ...
Epoch: 3 cost time: 5.69543981552124
Epoch: 3, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.257 Vali Acc: 0.590 Test Loss: 1.257 Test Acc: 0.590
Validation loss decreased (-0.404609 --> -0.589583).  Saving model ...
Epoch: 4 cost time: 5.092296600341797
Epoch: 4, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.144 Vali Acc: 0.514 Test Loss: 1.144 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.303808689117432
Epoch: 5, Steps: 17 | Train Loss: 0.852 Vali Loss: 0.957 Vali Acc: 0.647 Test Loss: 0.957 Test Acc: 0.647
Validation loss decreased (-0.589583 --> -0.647389).  Saving model ...
Epoch: 6 cost time: 6.190866947174072
Epoch: 6, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.801 Vali Acc: 0.728 Test Loss: 0.801 Test Acc: 0.728
Validation loss decreased (-0.647389 --> -0.728316).  Saving model ...
Epoch: 7 cost time: 5.898545503616333
Epoch: 7, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.644 Vali Acc: 0.798 Test Loss: 0.644 Test Acc: 0.798
Validation loss decreased (-0.728316 --> -0.797681).  Saving model ...
Epoch: 8 cost time: 6.57449197769165
Epoch: 8, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.637 Vali Acc: 0.763 Test Loss: 0.637 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.545558452606201
Epoch: 9, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.477 Vali Acc: 0.815 Test Loss: 0.477 Test Acc: 0.815
Validation loss decreased (-0.797681 --> -0.815024).  Saving model ...
Epoch: 10 cost time: 6.429112195968628
Epoch: 10, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.538106441497803
Epoch: 11, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.423 Vali Acc: 0.832 Test Loss: 0.423 Test Acc: 0.832
Validation loss decreased (-0.815024 --> -0.832366).  Saving model ...
Epoch: 12 cost time: 6.464638710021973
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.435 Vali Acc: 0.809 Test Loss: 0.435 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.50705885887146
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.457 Vali Acc: 0.803 Test Loss: 0.457 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.496169805526733
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.440 Vali Acc: 0.821 Test Loss: 0.440 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.433019399642944
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.427 Vali Acc: 0.821 Test Loss: 0.427 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.490595817565918
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.417 Vali Acc: 0.832 Test Loss: 0.417 Test Acc: 0.832
Validation loss decreased (-0.832366 --> -0.832366).  Saving model ...
Epoch: 17 cost time: 6.463226079940796
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.479 Vali Acc: 0.832 Test Loss: 0.479 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.38071084022522
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.477 Vali Acc: 0.832 Test Loss: 0.477 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.46439790725708
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.422 Vali Acc: 0.838 Test Loss: 0.422 Test Acc: 0.838
Validation loss decreased (-0.832366 --> -0.838146).  Saving model ...
Epoch: 20 cost time: 6.539933919906616
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.450 Vali Acc: 0.827 Test Loss: 0.450 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.491317272186279
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.821 Test Loss: 0.475 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.617105960845947
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
Validation loss decreased (-0.838146 --> -0.855487).  Saving model ...
Epoch: 23 cost time: 6.652104616165161
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.838 Test Loss: 0.458 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.562524080276489
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.474 Vali Acc: 0.855 Test Loss: 0.474 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.465498447418213
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.9239983558654785
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.243147373199463
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.827 Test Loss: 0.508 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.1581878662109375
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.838 Test Loss: 0.504 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.181416034698486
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.276061058044434
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.832 Test Loss: 0.516 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2879975
model size : 11.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.845707416534424
Epoch: 1, Steps: 17 | Train Loss: 1.927 Vali Loss: 1.825 Vali Acc: 0.266 Test Loss: 1.825 Test Acc: 0.266
Validation loss decreased (inf --> -0.265878).  Saving model ...
Epoch: 2 cost time: 9.278340101242065
Epoch: 2, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.528 Vali Acc: 0.439 Test Loss: 1.528 Test Acc: 0.439
Validation loss decreased (-0.265878 --> -0.439291).  Saving model ...
Epoch: 3 cost time: 8.914515018463135
Epoch: 3, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.297 Vali Acc: 0.520 Test Loss: 1.297 Test Acc: 0.520
Validation loss decreased (-0.439291 --> -0.520218).  Saving model ...
Epoch: 4 cost time: 9.233899116516113
Epoch: 4, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.100 Vali Acc: 0.630 Test Loss: 1.100 Test Acc: 0.630
Validation loss decreased (-0.520218 --> -0.630047).  Saving model ...
Epoch: 5 cost time: 9.052188634872437
Epoch: 5, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.989 Vali Acc: 0.613 Test Loss: 0.989 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.525439739227295
Epoch: 6, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.826 Vali Acc: 0.682 Test Loss: 0.826 Test Acc: 0.682
Validation loss decreased (-0.630047 --> -0.682073).  Saving model ...
Epoch: 7 cost time: 8.577118396759033
Epoch: 7, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.707 Vali Acc: 0.723 Test Loss: 0.707 Test Acc: 0.723
Validation loss decreased (-0.682073 --> -0.722536).  Saving model ...
Epoch: 8 cost time: 8.42670726776123
Epoch: 8, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.580 Vali Acc: 0.786 Test Loss: 0.580 Test Acc: 0.786
Validation loss decreased (-0.722536 --> -0.786121).  Saving model ...
Epoch: 9 cost time: 8.203986883163452
Epoch: 9, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.532 Vali Acc: 0.792 Test Loss: 0.532 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791902).  Saving model ...
Epoch: 10 cost time: 8.821250677108765
Epoch: 10, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.552 Vali Acc: 0.792 Test Loss: 0.552 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.84135389328003
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.706 Vali Acc: 0.809 Test Loss: 0.706 Test Acc: 0.809
Validation loss decreased (-0.791902 --> -0.809241).  Saving model ...
Epoch: 12 cost time: 8.69552755355835
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.514 Vali Acc: 0.827 Test Loss: 0.514 Test Acc: 0.827
Validation loss decreased (-0.809241 --> -0.826584).  Saving model ...
Epoch: 13 cost time: 8.783709049224854
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.684 Vali Acc: 0.798 Test Loss: 0.684 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.456221103668213
Epoch: 14, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.745 Vali Acc: 0.751 Test Loss: 0.745 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.529597282409668
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.62953519821167
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.524 Vali Acc: 0.815 Test Loss: 0.524 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.676954746246338
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.473 Vali Acc: 0.815 Test Loss: 0.473 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.574528455734253
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.821 Test Loss: 0.544 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.664144039154053
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.827 Test Loss: 0.529 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.911266326904297
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.827 Test Loss: 0.538 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.269121170043945
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.547 Vali Acc: 0.815 Test Loss: 0.547 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.230214357376099
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.827 Test Loss: 0.563 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 9500391
model size : 36.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.612295866012573
Epoch: 1, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.832 Vali Acc: 0.243 Test Loss: 1.832 Test Acc: 0.243
Validation loss decreased (inf --> -0.242756).  Saving model ...
Epoch: 2 cost time: 4.914440155029297
Epoch: 2, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.509 Vali Acc: 0.405 Test Loss: 1.509 Test Acc: 0.405
Validation loss decreased (-0.242756 --> -0.404609).  Saving model ...
Epoch: 3 cost time: 4.926717758178711
Epoch: 3, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.257 Vali Acc: 0.590 Test Loss: 1.257 Test Acc: 0.590
Validation loss decreased (-0.404609 --> -0.589583).  Saving model ...
Epoch: 4 cost time: 5.0358781814575195
Epoch: 4, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.144 Vali Acc: 0.514 Test Loss: 1.144 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.932268857955933
Epoch: 5, Steps: 17 | Train Loss: 0.852 Vali Loss: 0.957 Vali Acc: 0.647 Test Loss: 0.957 Test Acc: 0.647
Validation loss decreased (-0.589583 --> -0.647389).  Saving model ...
Epoch: 6 cost time: 4.9540135860443115
Epoch: 6, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.801 Vali Acc: 0.728 Test Loss: 0.801 Test Acc: 0.728
Validation loss decreased (-0.647389 --> -0.728316).  Saving model ...
Epoch: 7 cost time: 4.901632070541382
Epoch: 7, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.644 Vali Acc: 0.798 Test Loss: 0.644 Test Acc: 0.798
Validation loss decreased (-0.728316 --> -0.797681).  Saving model ...
Epoch: 8 cost time: 4.912505388259888
Epoch: 8, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.637 Vali Acc: 0.763 Test Loss: 0.637 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.957930326461792
Epoch: 9, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.477 Vali Acc: 0.815 Test Loss: 0.477 Test Acc: 0.815
Validation loss decreased (-0.797681 --> -0.815024).  Saving model ...
Epoch: 10 cost time: 4.904972076416016
Epoch: 10, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.806710720062256
Epoch: 11, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.423 Vali Acc: 0.832 Test Loss: 0.423 Test Acc: 0.832
Validation loss decreased (-0.815024 --> -0.832366).  Saving model ...
Epoch: 12 cost time: 5.480639696121216
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.435 Vali Acc: 0.809 Test Loss: 0.435 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.4231181144714355
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.457 Vali Acc: 0.803 Test Loss: 0.457 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.329516410827637
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.440 Vali Acc: 0.821 Test Loss: 0.440 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.295933961868286
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.427 Vali Acc: 0.821 Test Loss: 0.427 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.584796667098999
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.416 Vali Acc: 0.832 Test Loss: 0.416 Test Acc: 0.832
Validation loss decreased (-0.832366 --> -0.832366).  Saving model ...
Epoch: 17 cost time: 5.463078022003174
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.485 Vali Acc: 0.815 Test Loss: 0.485 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.41131854057312
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.475 Vali Acc: 0.832 Test Loss: 0.475 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.299968719482422
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.422 Vali Acc: 0.838 Test Loss: 0.422 Test Acc: 0.838
Validation loss decreased (-0.832366 --> -0.838146).  Saving model ...
Epoch: 20 cost time: 5.494277238845825
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.449 Vali Acc: 0.827 Test Loss: 0.449 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.519602060317993
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.474 Vali Acc: 0.821 Test Loss: 0.474 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.16468071937561
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.855 Test Loss: 0.463 Test Acc: 0.855
Validation loss decreased (-0.838146 --> -0.855487).  Saving model ...
Epoch: 23 cost time: 4.973453044891357
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.838 Test Loss: 0.457 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.955030679702759
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.1460206508636475
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.156492471694946
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.199987888336182
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.832 Test Loss: 0.505 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.7557971477508545
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.992969036102295
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.183679103851318
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2879975
model size : 11.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.35287094116211
Epoch: 1, Steps: 17 | Train Loss: 1.927 Vali Loss: 1.825 Vali Acc: 0.266 Test Loss: 1.825 Test Acc: 0.266
Validation loss decreased (inf --> -0.265878).  Saving model ...
Epoch: 2 cost time: 6.699127435684204
Epoch: 2, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.528 Vali Acc: 0.439 Test Loss: 1.528 Test Acc: 0.439
Validation loss decreased (-0.265878 --> -0.439291).  Saving model ...
Epoch: 3 cost time: 7.0698230266571045
Epoch: 3, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.297 Vali Acc: 0.520 Test Loss: 1.297 Test Acc: 0.520
Validation loss decreased (-0.439291 --> -0.520218).  Saving model ...
Epoch: 4 cost time: 6.14702582359314
Epoch: 4, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.100 Vali Acc: 0.630 Test Loss: 1.100 Test Acc: 0.630
Validation loss decreased (-0.520218 --> -0.630047).  Saving model ...
Epoch: 5 cost time: 6.449907302856445
Epoch: 5, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.989 Vali Acc: 0.613 Test Loss: 0.989 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.488936185836792
Epoch: 6, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.826 Vali Acc: 0.682 Test Loss: 0.826 Test Acc: 0.682
Validation loss decreased (-0.630047 --> -0.682073).  Saving model ...
Epoch: 7 cost time: 6.3288254737854
Epoch: 7, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.707 Vali Acc: 0.723 Test Loss: 0.707 Test Acc: 0.723
Validation loss decreased (-0.682073 --> -0.722536).  Saving model ...
Epoch: 8 cost time: 6.34982705116272
Epoch: 8, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.580 Vali Acc: 0.786 Test Loss: 0.580 Test Acc: 0.786
Validation loss decreased (-0.722536 --> -0.786121).  Saving model ...
Epoch: 9 cost time: 6.465198993682861
Epoch: 9, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.536 Vali Acc: 0.792 Test Loss: 0.536 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791902).  Saving model ...
Epoch: 10 cost time: 6.380799293518066
Epoch: 10, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.570 Vali Acc: 0.763 Test Loss: 0.570 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.455088138580322
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.562 Vali Acc: 0.798 Test Loss: 0.562 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797682).  Saving model ...
Epoch: 12 cost time: 6.431809663772583
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.625 Vali Acc: 0.728 Test Loss: 0.625 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.3570451736450195
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.481 Vali Acc: 0.827 Test Loss: 0.481 Test Acc: 0.827
Validation loss decreased (-0.797682 --> -0.826585).  Saving model ...
Epoch: 14 cost time: 6.291682481765747
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.586 Vali Acc: 0.792 Test Loss: 0.586 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.396994113922119
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.485 Vali Acc: 0.827 Test Loss: 0.485 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.446017026901245
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.545 Vali Acc: 0.821 Test Loss: 0.545 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.285063028335571
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.518 Vali Acc: 0.815 Test Loss: 0.518 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.432656764984131
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.827 Test Loss: 0.538 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.401279449462891
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.523 Vali Acc: 0.832 Test Loss: 0.523 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 20 cost time: 6.546094179153442
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.548 Vali Acc: 0.821 Test Loss: 0.548 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.569539308547974
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.511 Vali Acc: 0.821 Test Loss: 0.511 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.0593767166137695
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.815 Test Loss: 0.559 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.700069189071655
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.593 Vali Acc: 0.827 Test Loss: 0.593 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.861383438110352
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.543 Vali Acc: 0.798 Test Loss: 0.543 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.723026990890503
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.784265756607056
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.821 Test Loss: 0.579 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.823665380477905
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.821 Test Loss: 0.586 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.713754892349243
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.821 Test Loss: 0.594 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.851032257080078
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.815 Test Loss: 0.590 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 9500391
model size : 36.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.5989930629730225
Epoch: 1, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.832 Vali Acc: 0.243 Test Loss: 1.832 Test Acc: 0.243
Validation loss decreased (inf --> -0.242756).  Saving model ...
Epoch: 2 cost time: 4.015525579452515
Epoch: 2, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.509 Vali Acc: 0.405 Test Loss: 1.509 Test Acc: 0.405
Validation loss decreased (-0.242756 --> -0.404609).  Saving model ...
Epoch: 3 cost time: 3.8563027381896973
Epoch: 3, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.257 Vali Acc: 0.590 Test Loss: 1.257 Test Acc: 0.590
Validation loss decreased (-0.404609 --> -0.589583).  Saving model ...
Epoch: 4 cost time: 3.7943897247314453
Epoch: 4, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.144 Vali Acc: 0.514 Test Loss: 1.144 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6599297523498535
Epoch: 5, Steps: 17 | Train Loss: 0.852 Vali Loss: 0.957 Vali Acc: 0.647 Test Loss: 0.957 Test Acc: 0.647
Validation loss decreased (-0.589583 --> -0.647389).  Saving model ...
Epoch: 6 cost time: 3.459608316421509
Epoch: 6, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.801 Vali Acc: 0.728 Test Loss: 0.801 Test Acc: 0.728
Validation loss decreased (-0.647389 --> -0.728316).  Saving model ...
Epoch: 7 cost time: 3.6270103454589844
Epoch: 7, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.644 Vali Acc: 0.798 Test Loss: 0.644 Test Acc: 0.798
Validation loss decreased (-0.728316 --> -0.797681).  Saving model ...
Epoch: 8 cost time: 3.6333131790161133
Epoch: 8, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.637 Vali Acc: 0.763 Test Loss: 0.637 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.764875888824463
Epoch: 9, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.477 Vali Acc: 0.815 Test Loss: 0.477 Test Acc: 0.815
Validation loss decreased (-0.797681 --> -0.815024).  Saving model ...
Epoch: 10 cost time: 3.4660661220550537
Epoch: 10, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3736588954925537
Epoch: 11, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.432 Vali Acc: 0.844 Test Loss: 0.432 Test Acc: 0.844
Validation loss decreased (-0.815024 --> -0.843926).  Saving model ...
Epoch: 12 cost time: 3.4936363697052
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.432 Vali Acc: 0.809 Test Loss: 0.432 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.477693796157837
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.457 Vali Acc: 0.815 Test Loss: 0.457 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3893494606018066
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.443 Vali Acc: 0.815 Test Loss: 0.443 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.1276230812072754
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.420 Vali Acc: 0.821 Test Loss: 0.420 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.191786766052246
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.418 Vali Acc: 0.844 Test Loss: 0.418 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 17 cost time: 3.2610113620758057
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.464 Vali Acc: 0.821 Test Loss: 0.464 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4124503135681152
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.301243305206299
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849707).  Saving model ...
Epoch: 20 cost time: 3.5666403770446777
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.446 Vali Acc: 0.838 Test Loss: 0.446 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.606050968170166
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.469 Vali Acc: 0.827 Test Loss: 0.469 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.6260149478912354
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5408833026885986
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.855 Test Loss: 0.457 Test Acc: 0.855
Validation loss decreased (-0.849707 --> -0.855487).  Saving model ...
Epoch: 24 cost time: 3.5519309043884277
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.659203052520752
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.477 Vali Acc: 0.855 Test Loss: 0.477 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.605055093765259
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.5797040462493896
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.827 Test Loss: 0.495 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.646637439727783
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.7170591354370117
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.7695257663726807
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.832 Test Loss: 0.499 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2879975
model size : 11.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.749951839447021
Epoch: 1, Steps: 17 | Train Loss: 2.008 Vali Loss: 1.816 Vali Acc: 0.306 Test Loss: 1.816 Test Acc: 0.306
Validation loss decreased (inf --> -0.306340).  Saving model ...
Epoch: 2 cost time: 8.034412384033203
Epoch: 2, Steps: 17 | Train Loss: 1.674 Vali Loss: 1.516 Vali Acc: 0.387 Test Loss: 1.516 Test Acc: 0.387
Validation loss decreased (-0.306340 --> -0.387268).  Saving model ...
Epoch: 3 cost time: 8.08525037765503
Epoch: 3, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.311 Vali Acc: 0.474 Test Loss: 1.311 Test Acc: 0.474
Validation loss decreased (-0.387268 --> -0.473975).  Saving model ...
Epoch: 4 cost time: 8.033292055130005
Epoch: 4, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.107 Vali Acc: 0.578 Test Loss: 1.107 Test Acc: 0.578
Validation loss decreased (-0.473975 --> -0.578024).  Saving model ...
Epoch: 5 cost time: 7.625300168991089
Epoch: 5, Steps: 17 | Train Loss: 0.899 Vali Loss: 0.935 Vali Acc: 0.711 Test Loss: 0.935 Test Acc: 0.711
Validation loss decreased (-0.578024 --> -0.710973).  Saving model ...
Epoch: 6 cost time: 8.351215124130249
Epoch: 6, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.834 Vali Acc: 0.653 Test Loss: 0.834 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.331024885177612
Epoch: 7, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.727 Vali Acc: 0.694 Test Loss: 0.727 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.340675354003906
Epoch: 8, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.704 Vali Acc: 0.746 Test Loss: 0.704 Test Acc: 0.746
Validation loss decreased (-0.710973 --> -0.745658).  Saving model ...
Epoch: 9 cost time: 8.243718147277832
Epoch: 9, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.577 Vali Acc: 0.769 Test Loss: 0.577 Test Acc: 0.769
Validation loss decreased (-0.745658 --> -0.768780).  Saving model ...
Epoch: 10 cost time: 8.205721139907837
Epoch: 10, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.573 Vali Acc: 0.792 Test Loss: 0.573 Test Acc: 0.792
Validation loss decreased (-0.768780 --> -0.791902).  Saving model ...
Epoch: 11 cost time: 8.349607944488525
Epoch: 11, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.545 Vali Acc: 0.769 Test Loss: 0.545 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.23011827468872
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 13 cost time: 8.310884714126587
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.511 Vali Acc: 0.751 Test Loss: 0.511 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.237618923187256
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809244).  Saving model ...
Epoch: 15 cost time: 8.181844711303711
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.480 Vali Acc: 0.798 Test Loss: 0.480 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.268128871917725
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.478 Vali Acc: 0.786 Test Loss: 0.478 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.28437876701355
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.465 Vali Acc: 0.803 Test Loss: 0.465 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.786054611206055
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.470 Vali Acc: 0.821 Test Loss: 0.470 Test Acc: 0.821
Validation loss decreased (-0.809244 --> -0.820805).  Saving model ...
Epoch: 19 cost time: 8.09306263923645
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.496 Vali Acc: 0.780 Test Loss: 0.496 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.828920125961304
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.476 Vali Acc: 0.827 Test Loss: 0.476 Test Acc: 0.827
Validation loss decreased (-0.820805 --> -0.826585).  Saving model ...
Epoch: 21 cost time: 7.5275139808654785
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.492 Vali Acc: 0.815 Test Loss: 0.492 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.525317430496216
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.821 Test Loss: 0.500 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.421174049377441
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.803 Test Loss: 0.457 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.552088499069214
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.513 Vali Acc: 0.832 Test Loss: 0.513 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 25 cost time: 7.518150568008423
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.4876344203948975
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.832 Test Loss: 0.500 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 27 cost time: 7.509746789932251
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.827 Test Loss: 0.546 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 7.563404083251953
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.821 Test Loss: 0.520 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.833618640899658
Epoch: 29, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.553 Vali Acc: 0.827 Test Loss: 0.553 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 7.914582967758179
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.518 Vali Acc: 0.786 Test Loss: 0.518 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 4813031
model size : 19.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.569666862487793
Epoch: 1, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.803 Vali Acc: 0.329 Test Loss: 1.803 Test Acc: 0.329
Validation loss decreased (inf --> -0.329462).  Saving model ...
Epoch: 2 cost time: 5.006392002105713
Epoch: 2, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.523 Vali Acc: 0.422 Test Loss: 1.523 Test Acc: 0.422
Validation loss decreased (-0.329462 --> -0.421950).  Saving model ...
Epoch: 3 cost time: 5.098447561264038
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.324 Vali Acc: 0.497 Test Loss: 1.324 Test Acc: 0.497
Validation loss decreased (-0.421950 --> -0.497097).  Saving model ...
Epoch: 4 cost time: 4.790717601776123
Epoch: 4, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.185 Vali Acc: 0.538 Test Loss: 1.185 Test Acc: 0.538
Validation loss decreased (-0.497097 --> -0.537560).  Saving model ...
Epoch: 5 cost time: 4.750756025314331
Epoch: 5, Steps: 17 | Train Loss: 0.862 Vali Loss: 0.999 Vali Acc: 0.676 Test Loss: 0.999 Test Acc: 0.676
Validation loss decreased (-0.537560 --> -0.676291).  Saving model ...
Epoch: 6 cost time: 4.886990308761597
Epoch: 6, Steps: 17 | Train Loss: 0.679 Vali Loss: 0.928 Vali Acc: 0.682 Test Loss: 0.928 Test Acc: 0.682
Validation loss decreased (-0.676291 --> -0.682072).  Saving model ...
Epoch: 7 cost time: 4.990657329559326
Epoch: 7, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.787 Vali Acc: 0.740 Test Loss: 0.787 Test Acc: 0.740
Validation loss decreased (-0.682072 --> -0.739877).  Saving model ...
Epoch: 8 cost time: 4.894738435745239
Epoch: 8, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.843 Vali Acc: 0.682 Test Loss: 0.843 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.802187442779541
Epoch: 9, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.627 Vali Acc: 0.757 Test Loss: 0.627 Test Acc: 0.757
Validation loss decreased (-0.739877 --> -0.757219).  Saving model ...
Epoch: 10 cost time: 4.679519176483154
Epoch: 10, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.580 Vali Acc: 0.780 Test Loss: 0.580 Test Acc: 0.780
Validation loss decreased (-0.757219 --> -0.780341).  Saving model ...
Epoch: 11 cost time: 4.881076097488403
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.574 Vali Acc: 0.780 Test Loss: 0.574 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 12 cost time: 4.965600252151489
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
Validation loss decreased (-0.780341 --> -0.809243).  Saving model ...
Epoch: 13 cost time: 4.918407678604126
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.783632755279541
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.529 Vali Acc: 0.786 Test Loss: 0.529 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.823518991470337
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.792330265045166
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.560 Vali Acc: 0.786 Test Loss: 0.560 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.000932455062866
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.551 Vali Acc: 0.798 Test Loss: 0.551 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.9461424350738525
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.553 Vali Acc: 0.792 Test Loss: 0.553 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.9078381061553955
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.570 Vali Acc: 0.792 Test Loss: 0.570 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.751429796218872
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.567 Vali Acc: 0.798 Test Loss: 0.567 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.899313449859619
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.579 Vali Acc: 0.798 Test Loss: 0.579 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.034819841384888
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.582 Vali Acc: 0.798 Test Loss: 0.582 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1502695
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.338281393051147
Epoch: 1, Steps: 17 | Train Loss: 2.008 Vali Loss: 1.816 Vali Acc: 0.306 Test Loss: 1.816 Test Acc: 0.306
Validation loss decreased (inf --> -0.306340).  Saving model ...
Epoch: 2 cost time: 6.454948902130127
Epoch: 2, Steps: 17 | Train Loss: 1.674 Vali Loss: 1.516 Vali Acc: 0.387 Test Loss: 1.516 Test Acc: 0.387
Validation loss decreased (-0.306340 --> -0.387268).  Saving model ...
Epoch: 3 cost time: 6.367394208908081
Epoch: 3, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.311 Vali Acc: 0.474 Test Loss: 1.311 Test Acc: 0.474
Validation loss decreased (-0.387268 --> -0.473975).  Saving model ...
Epoch: 4 cost time: 6.325473070144653
Epoch: 4, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.107 Vali Acc: 0.578 Test Loss: 1.107 Test Acc: 0.578
Validation loss decreased (-0.473975 --> -0.578024).  Saving model ...
Epoch: 5 cost time: 6.367126226425171
Epoch: 5, Steps: 17 | Train Loss: 0.899 Vali Loss: 0.935 Vali Acc: 0.711 Test Loss: 0.935 Test Acc: 0.711
Validation loss decreased (-0.578024 --> -0.710973).  Saving model ...
Epoch: 6 cost time: 6.418386936187744
Epoch: 6, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.834 Vali Acc: 0.653 Test Loss: 0.834 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.310666561126709
Epoch: 7, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.727 Vali Acc: 0.694 Test Loss: 0.727 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.4850757122039795
Epoch: 8, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.704 Vali Acc: 0.746 Test Loss: 0.704 Test Acc: 0.746
Validation loss decreased (-0.710973 --> -0.745658).  Saving model ...
Epoch: 9 cost time: 6.502414226531982
Epoch: 9, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.577 Vali Acc: 0.769 Test Loss: 0.577 Test Acc: 0.769
Validation loss decreased (-0.745658 --> -0.768780).  Saving model ...
Epoch: 10 cost time: 5.899216890335083
Epoch: 10, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.573 Vali Acc: 0.792 Test Loss: 0.573 Test Acc: 0.792
Validation loss decreased (-0.768780 --> -0.791902).  Saving model ...
Epoch: 11 cost time: 5.863343000411987
Epoch: 11, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.545 Vali Acc: 0.769 Test Loss: 0.545 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.939477205276489
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 13 cost time: 5.790839910507202
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.511 Vali Acc: 0.751 Test Loss: 0.511 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.850789785385132
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809244).  Saving model ...
Epoch: 15 cost time: 5.866708278656006
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.480 Vali Acc: 0.798 Test Loss: 0.480 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.761227607727051
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.478 Vali Acc: 0.786 Test Loss: 0.478 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.799391269683838
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.465 Vali Acc: 0.803 Test Loss: 0.465 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.5113208293914795
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.470 Vali Acc: 0.821 Test Loss: 0.470 Test Acc: 0.821
Validation loss decreased (-0.809244 --> -0.820805).  Saving model ...
Epoch: 19 cost time: 5.908582925796509
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.495 Vali Acc: 0.780 Test Loss: 0.495 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.74868631362915
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.477 Vali Acc: 0.827 Test Loss: 0.477 Test Acc: 0.827
Validation loss decreased (-0.820805 --> -0.826585).  Saving model ...
Epoch: 21 cost time: 6.572146415710449
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.492 Vali Acc: 0.815 Test Loss: 0.492 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.1775500774383545
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.504 Vali Acc: 0.821 Test Loss: 0.504 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.45367956161499
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.480 Vali Acc: 0.792 Test Loss: 0.480 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.509693145751953
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.484 Vali Acc: 0.821 Test Loss: 0.484 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.560457706451416
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.525 Vali Acc: 0.821 Test Loss: 0.525 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.51542592048645
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.821 Test Loss: 0.491 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.3784143924713135
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.522 Vali Acc: 0.798 Test Loss: 0.522 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.5745275020599365
Epoch: 28, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.709 Vali Acc: 0.705 Test Loss: 0.709 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.667411804199219
Epoch: 29, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.611 Vali Acc: 0.798 Test Loss: 0.611 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.507410049438477
Epoch: 30, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.567 Vali Acc: 0.798 Test Loss: 0.567 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 4813031
model size : 19.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.611689805984497
Epoch: 1, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.803 Vali Acc: 0.329 Test Loss: 1.803 Test Acc: 0.329
Validation loss decreased (inf --> -0.329462).  Saving model ...
Epoch: 2 cost time: 3.94234037399292
Epoch: 2, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.523 Vali Acc: 0.422 Test Loss: 1.523 Test Acc: 0.422
Validation loss decreased (-0.329462 --> -0.421950).  Saving model ...
Epoch: 3 cost time: 4.063666343688965
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.324 Vali Acc: 0.497 Test Loss: 1.324 Test Acc: 0.497
Validation loss decreased (-0.421950 --> -0.497097).  Saving model ...
Epoch: 4 cost time: 4.213437080383301
Epoch: 4, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.185 Vali Acc: 0.538 Test Loss: 1.185 Test Acc: 0.538
Validation loss decreased (-0.497097 --> -0.537560).  Saving model ...
Epoch: 5 cost time: 4.086685657501221
Epoch: 5, Steps: 17 | Train Loss: 0.862 Vali Loss: 0.999 Vali Acc: 0.676 Test Loss: 0.999 Test Acc: 0.676
Validation loss decreased (-0.537560 --> -0.676291).  Saving model ...
Epoch: 6 cost time: 3.6576547622680664
Epoch: 6, Steps: 17 | Train Loss: 0.679 Vali Loss: 0.928 Vali Acc: 0.682 Test Loss: 0.928 Test Acc: 0.682
Validation loss decreased (-0.676291 --> -0.682072).  Saving model ...
Epoch: 7 cost time: 3.6649680137634277
Epoch: 7, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.787 Vali Acc: 0.740 Test Loss: 0.787 Test Acc: 0.740
Validation loss decreased (-0.682072 --> -0.739877).  Saving model ...
Epoch: 8 cost time: 3.772820234298706
Epoch: 8, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.843 Vali Acc: 0.682 Test Loss: 0.843 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.0556745529174805
Epoch: 9, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.627 Vali Acc: 0.757 Test Loss: 0.627 Test Acc: 0.757
Validation loss decreased (-0.739877 --> -0.757219).  Saving model ...
Epoch: 10 cost time: 4.06206750869751
Epoch: 10, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.580 Vali Acc: 0.780 Test Loss: 0.580 Test Acc: 0.780
Validation loss decreased (-0.757219 --> -0.780341).  Saving model ...
Epoch: 11 cost time: 4.012733697891235
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.574 Vali Acc: 0.780 Test Loss: 0.574 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 12 cost time: 4.062519311904907
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
Validation loss decreased (-0.780341 --> -0.809243).  Saving model ...
Epoch: 13 cost time: 4.029571533203125
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.125084400177002
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.526 Vali Acc: 0.792 Test Loss: 0.526 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9152307510375977
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.755915880203247
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.559 Vali Acc: 0.780 Test Loss: 0.559 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.048503160476685
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.550 Vali Acc: 0.786 Test Loss: 0.550 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.784895658493042
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.552 Vali Acc: 0.780 Test Loss: 0.552 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.766354560852051
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.570 Vali Acc: 0.780 Test Loss: 0.570 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.8730862140655518
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.563 Vali Acc: 0.798 Test Loss: 0.563 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.867800712585449
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.798 Test Loss: 0.573 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.046799659729004
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.798 Test Loss: 0.580 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1502695
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.173734188079834
Epoch: 1, Steps: 17 | Train Loss: 2.008 Vali Loss: 1.816 Vali Acc: 0.306 Test Loss: 1.816 Test Acc: 0.306
Validation loss decreased (inf --> -0.306340).  Saving model ...
Epoch: 2 cost time: 4.568680286407471
Epoch: 2, Steps: 17 | Train Loss: 1.674 Vali Loss: 1.516 Vali Acc: 0.387 Test Loss: 1.516 Test Acc: 0.387
Validation loss decreased (-0.306340 --> -0.387268).  Saving model ...
Epoch: 3 cost time: 4.245567083358765
Epoch: 3, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.311 Vali Acc: 0.474 Test Loss: 1.311 Test Acc: 0.474
Validation loss decreased (-0.387268 --> -0.473975).  Saving model ...
Epoch: 4 cost time: 4.389739274978638
Epoch: 4, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.107 Vali Acc: 0.578 Test Loss: 1.107 Test Acc: 0.578
Validation loss decreased (-0.473975 --> -0.578024).  Saving model ...
Epoch: 5 cost time: 4.0353217124938965
Epoch: 5, Steps: 17 | Train Loss: 0.899 Vali Loss: 0.935 Vali Acc: 0.711 Test Loss: 0.935 Test Acc: 0.711
Validation loss decreased (-0.578024 --> -0.710973).  Saving model ...
Epoch: 6 cost time: 4.114732265472412
Epoch: 6, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.834 Vali Acc: 0.653 Test Loss: 0.834 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.30682110786438
Epoch: 7, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.727 Vali Acc: 0.694 Test Loss: 0.727 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.1862945556640625
Epoch: 8, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.704 Vali Acc: 0.746 Test Loss: 0.704 Test Acc: 0.746
Validation loss decreased (-0.710973 --> -0.745658).  Saving model ...
Epoch: 9 cost time: 4.383658409118652
Epoch: 9, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.577 Vali Acc: 0.769 Test Loss: 0.577 Test Acc: 0.769
Validation loss decreased (-0.745658 --> -0.768780).  Saving model ...
Epoch: 10 cost time: 4.2645204067230225
Epoch: 10, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.573 Vali Acc: 0.792 Test Loss: 0.573 Test Acc: 0.792
Validation loss decreased (-0.768780 --> -0.791902).  Saving model ...
Epoch: 11 cost time: 4.334496259689331
Epoch: 11, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.545 Vali Acc: 0.769 Test Loss: 0.545 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.404306173324585
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 13 cost time: 4.401941537857056
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.511 Vali Acc: 0.751 Test Loss: 0.511 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.226842164993286
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809244).  Saving model ...
Epoch: 15 cost time: 4.750009775161743
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 16 cost time: 4.62814474105835
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.484 Vali Acc: 0.786 Test Loss: 0.484 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1837592124938965
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.478 Vali Acc: 0.786 Test Loss: 0.478 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.549055814743042
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.479 Vali Acc: 0.821 Test Loss: 0.479 Test Acc: 0.821
Validation loss decreased (-0.809244 --> -0.820804).  Saving model ...
Epoch: 19 cost time: 4.905961036682129
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.487 Vali Acc: 0.821 Test Loss: 0.487 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.86256217956543
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.483 Vali Acc: 0.827 Test Loss: 0.483 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826585).  Saving model ...
Epoch: 21 cost time: 4.889995574951172
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.827 Test Loss: 0.495 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.87406587600708
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.637862205505371
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.815 Test Loss: 0.514 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.654176235198975
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.486 Vali Acc: 0.815 Test Loss: 0.486 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.773382186889648
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.827 Test Loss: 0.509 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.786252021789551
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.494 Vali Acc: 0.827 Test Loss: 0.494 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.773715972900391
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.821 Test Loss: 0.511 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.826630353927612
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.827 Test Loss: 0.524 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.738756895065308
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.821 Test Loss: 0.515 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.646690130233765
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.809 Test Loss: 0.535 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 4813031
model size : 19.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.669898986816406
Epoch: 1, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.803 Vali Acc: 0.329 Test Loss: 1.803 Test Acc: 0.329
Validation loss decreased (inf --> -0.329462).  Saving model ...
Epoch: 2 cost time: 2.9960203170776367
Epoch: 2, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.523 Vali Acc: 0.422 Test Loss: 1.523 Test Acc: 0.422
Validation loss decreased (-0.329462 --> -0.421950).  Saving model ...
Epoch: 3 cost time: 3.001751184463501
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.324 Vali Acc: 0.497 Test Loss: 1.324 Test Acc: 0.497
Validation loss decreased (-0.421950 --> -0.497097).  Saving model ...
Epoch: 4 cost time: 3.118736505508423
Epoch: 4, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.185 Vali Acc: 0.538 Test Loss: 1.185 Test Acc: 0.538
Validation loss decreased (-0.497097 --> -0.537560).  Saving model ...
Epoch: 5 cost time: 3.0428991317749023
Epoch: 5, Steps: 17 | Train Loss: 0.862 Vali Loss: 0.999 Vali Acc: 0.676 Test Loss: 0.999 Test Acc: 0.676
Validation loss decreased (-0.537560 --> -0.676291).  Saving model ...
Epoch: 6 cost time: 2.991966724395752
Epoch: 6, Steps: 17 | Train Loss: 0.679 Vali Loss: 0.928 Vali Acc: 0.682 Test Loss: 0.928 Test Acc: 0.682
Validation loss decreased (-0.676291 --> -0.682072).  Saving model ...
Epoch: 7 cost time: 3.0459094047546387
Epoch: 7, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.787 Vali Acc: 0.740 Test Loss: 0.787 Test Acc: 0.740
Validation loss decreased (-0.682072 --> -0.739877).  Saving model ...
Epoch: 8 cost time: 3.0805957317352295
Epoch: 8, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.843 Vali Acc: 0.682 Test Loss: 0.843 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9366331100463867
Epoch: 9, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.627 Vali Acc: 0.757 Test Loss: 0.627 Test Acc: 0.757
Validation loss decreased (-0.739877 --> -0.757219).  Saving model ...
Epoch: 10 cost time: 2.8733577728271484
Epoch: 10, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.580 Vali Acc: 0.780 Test Loss: 0.580 Test Acc: 0.780
Validation loss decreased (-0.757219 --> -0.780341).  Saving model ...
Epoch: 11 cost time: 3.3505711555480957
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.574 Vali Acc: 0.780 Test Loss: 0.574 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 12 cost time: 3.2355613708496094
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.521 Vali Acc: 0.821 Test Loss: 0.521 Test Acc: 0.821
Validation loss decreased (-0.780341 --> -0.820804).  Saving model ...
Epoch: 13 cost time: 3.2752721309661865
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2063236236572266
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.526 Vali Acc: 0.780 Test Loss: 0.526 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9866886138916016
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.875164747238159
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.561 Vali Acc: 0.786 Test Loss: 0.561 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.902280330657959
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.547 Vali Acc: 0.798 Test Loss: 0.547 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0285274982452393
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.552 Vali Acc: 0.792 Test Loss: 0.552 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.003112554550171
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.570 Vali Acc: 0.780 Test Loss: 0.570 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.0448646545410156
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.562 Vali Acc: 0.798 Test Loss: 0.562 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.022334575653076
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.112624406814575
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.579 Vali Acc: 0.798 Test Loss: 0.579 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1502695
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.425261974334717
Epoch: 1, Steps: 17 | Train Loss: 1.922 Vali Loss: 1.766 Vali Acc: 0.347 Test Loss: 1.766 Test Acc: 0.347
Validation loss decreased (inf --> -0.346803).  Saving model ...
Epoch: 2 cost time: 5.297485113143921
Epoch: 2, Steps: 17 | Train Loss: 1.638 Vali Loss: 1.468 Vali Acc: 0.474 Test Loss: 1.468 Test Acc: 0.474
Validation loss decreased (-0.346803 --> -0.473974).  Saving model ...
Epoch: 3 cost time: 5.765243053436279
Epoch: 3, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.266 Vali Acc: 0.520 Test Loss: 1.266 Test Acc: 0.520
Validation loss decreased (-0.473974 --> -0.520219).  Saving model ...
Epoch: 4 cost time: 5.514986276626587
Epoch: 4, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.114 Vali Acc: 0.595 Test Loss: 1.114 Test Acc: 0.595
Validation loss decreased (-0.520219 --> -0.595365).  Saving model ...
Epoch: 5 cost time: 5.5667338371276855
Epoch: 5, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.029 Vali Acc: 0.618 Test Loss: 1.029 Test Acc: 0.618
Validation loss decreased (-0.595365 --> -0.618487).  Saving model ...
Epoch: 6 cost time: 5.600824356079102
Epoch: 6, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.814 Vali Acc: 0.763 Test Loss: 0.814 Test Acc: 0.763
Validation loss decreased (-0.618487 --> -0.762998).  Saving model ...
Epoch: 7 cost time: 5.447397947311401
Epoch: 7, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.707 Vali Acc: 0.809 Test Loss: 0.707 Test Acc: 0.809
Validation loss decreased (-0.762998 --> -0.809241).  Saving model ...
Epoch: 8 cost time: 5.200787305831909
Epoch: 8, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.638 Vali Acc: 0.815 Test Loss: 0.638 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815023).  Saving model ...
Epoch: 9 cost time: 5.890747547149658
Epoch: 9, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.429220199584961
Epoch: 10, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
Validation loss decreased (-0.815023 --> -0.867047).  Saving model ...
Epoch: 11 cost time: 5.455279350280762
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.838224172592163
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.498 Vali Acc: 0.827 Test Loss: 0.498 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.03256893157959
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.446 Vali Acc: 0.827 Test Loss: 0.446 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.065850019454956
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.463 Vali Acc: 0.832 Test Loss: 0.463 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.878007411956787
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.877718448638916
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.450 Vali Acc: 0.832 Test Loss: 0.450 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.9311041831970215
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.476 Vali Acc: 0.827 Test Loss: 0.476 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.910998344421387
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.789099216461182
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.479 Vali Acc: 0.815 Test Loss: 0.479 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.001487970352173
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.487 Vali Acc: 0.827 Test Loss: 0.487 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 2469351
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.586162090301514
Epoch: 1, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.786 Vali Acc: 0.272 Test Loss: 1.786 Test Acc: 0.272
Validation loss decreased (inf --> -0.271658).  Saving model ...
Epoch: 2 cost time: 3.750070810317993
Epoch: 2, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.507 Vali Acc: 0.393 Test Loss: 1.507 Test Acc: 0.393
Validation loss decreased (-0.271658 --> -0.393049).  Saving model ...
Epoch: 3 cost time: 3.856520891189575
Epoch: 3, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.264 Vali Acc: 0.590 Test Loss: 1.264 Test Acc: 0.590
Validation loss decreased (-0.393049 --> -0.589583).  Saving model ...
Epoch: 4 cost time: 3.817946195602417
Epoch: 4, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.128 Vali Acc: 0.601 Test Loss: 1.128 Test Acc: 0.601
Validation loss decreased (-0.589583 --> -0.601145).  Saving model ...
Epoch: 5 cost time: 3.6770973205566406
Epoch: 5, Steps: 17 | Train Loss: 0.895 Vali Loss: 0.981 Vali Acc: 0.613 Test Loss: 0.981 Test Acc: 0.613
Validation loss decreased (-0.601145 --> -0.612707).  Saving model ...
Epoch: 6 cost time: 3.6590723991394043
Epoch: 6, Steps: 17 | Train Loss: 0.689 Vali Loss: 0.932 Vali Acc: 0.659 Test Loss: 0.932 Test Acc: 0.659
Validation loss decreased (-0.612707 --> -0.658950).  Saving model ...
Epoch: 7 cost time: 3.8825531005859375
Epoch: 7, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.793 Vali Acc: 0.746 Test Loss: 0.793 Test Acc: 0.746
Validation loss decreased (-0.658950 --> -0.745657).  Saving model ...
Epoch: 8 cost time: 3.652571439743042
Epoch: 8, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.671 Vali Acc: 0.792 Test Loss: 0.671 Test Acc: 0.792
Validation loss decreased (-0.745657 --> -0.791901).  Saving model ...
Epoch: 9 cost time: 3.5763885974884033
Epoch: 9, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.593 Vali Acc: 0.792 Test Loss: 0.593 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791902).  Saving model ...
Epoch: 10 cost time: 3.887887716293335
Epoch: 10, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
Validation loss decreased (-0.791902 --> -0.809243).  Saving model ...
Epoch: 11 cost time: 4.123547792434692
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.549 Vali Acc: 0.786 Test Loss: 0.549 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.841033697128296
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.592 Vali Acc: 0.751 Test Loss: 0.592 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8656086921691895
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
Validation loss decreased (-0.809243 --> -0.849707).  Saving model ...
Epoch: 14 cost time: 3.9278321266174316
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8132221698760986
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7135767936706543
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.441 Vali Acc: 0.838 Test Loss: 0.441 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.769871473312378
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
Validation loss decreased (-0.849707 --> -0.855487).  Saving model ...
Epoch: 18 cost time: 3.64343523979187
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.832 Test Loss: 0.461 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.780690908432007
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.838 Test Loss: 0.462 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8280906677246094
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.463 Vali Acc: 0.832 Test Loss: 0.463 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.8045403957366943
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.470 Vali Acc: 0.832 Test Loss: 0.470 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.677616596221924
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.486 Vali Acc: 0.838 Test Loss: 0.486 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.649935245513916
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.467 Vali Acc: 0.838 Test Loss: 0.467 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.8314504623413086
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.832 Test Loss: 0.522 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.4480068683624268
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.3014111518859863
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.607819080352783
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 814055
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.880788087844849
Epoch: 1, Steps: 17 | Train Loss: 1.922 Vali Loss: 1.766 Vali Acc: 0.347 Test Loss: 1.766 Test Acc: 0.347
Validation loss decreased (inf --> -0.346803).  Saving model ...
Epoch: 2 cost time: 4.33371639251709
Epoch: 2, Steps: 17 | Train Loss: 1.638 Vali Loss: 1.468 Vali Acc: 0.474 Test Loss: 1.468 Test Acc: 0.474
Validation loss decreased (-0.346803 --> -0.473974).  Saving model ...
Epoch: 3 cost time: 3.882089614868164
Epoch: 3, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.266 Vali Acc: 0.520 Test Loss: 1.266 Test Acc: 0.520
Validation loss decreased (-0.473974 --> -0.520219).  Saving model ...
Epoch: 4 cost time: 4.0833899974823
Epoch: 4, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.114 Vali Acc: 0.595 Test Loss: 1.114 Test Acc: 0.595
Validation loss decreased (-0.520219 --> -0.595365).  Saving model ...
Epoch: 5 cost time: 4.0671226978302
Epoch: 5, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.029 Vali Acc: 0.618 Test Loss: 1.029 Test Acc: 0.618
Validation loss decreased (-0.595365 --> -0.618487).  Saving model ...
Epoch: 6 cost time: 3.856208324432373
Epoch: 6, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.814 Vali Acc: 0.763 Test Loss: 0.814 Test Acc: 0.763
Validation loss decreased (-0.618487 --> -0.762998).  Saving model ...
Epoch: 7 cost time: 4.358863353729248
Epoch: 7, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.707 Vali Acc: 0.809 Test Loss: 0.707 Test Acc: 0.809
Validation loss decreased (-0.762998 --> -0.809241).  Saving model ...
Epoch: 8 cost time: 4.32152795791626
Epoch: 8, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.638 Vali Acc: 0.815 Test Loss: 0.638 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815023).  Saving model ...
Epoch: 9 cost time: 4.493525743484497
Epoch: 9, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.544183731079102
Epoch: 10, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
Validation loss decreased (-0.815023 --> -0.867047).  Saving model ...
Epoch: 11 cost time: 4.610692739486694
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.5681984424591064
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.498 Vali Acc: 0.827 Test Loss: 0.498 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.6171276569366455
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.446 Vali Acc: 0.827 Test Loss: 0.446 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.631411790847778
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.463 Vali Acc: 0.832 Test Loss: 0.463 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.518696308135986
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.722839593887329
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.450 Vali Acc: 0.832 Test Loss: 0.450 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.558475494384766
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.476 Vali Acc: 0.827 Test Loss: 0.476 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.7911131381988525
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.591927528381348
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.479 Vali Acc: 0.821 Test Loss: 0.479 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.508025884628296
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.487 Vali Acc: 0.827 Test Loss: 0.487 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 2469351
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.937186002731323
Epoch: 1, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.786 Vali Acc: 0.272 Test Loss: 1.786 Test Acc: 0.272
Validation loss decreased (inf --> -0.271658).  Saving model ...
Epoch: 2 cost time: 3.187676429748535
Epoch: 2, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.507 Vali Acc: 0.393 Test Loss: 1.507 Test Acc: 0.393
Validation loss decreased (-0.271658 --> -0.393049).  Saving model ...
Epoch: 3 cost time: 3.0797111988067627
Epoch: 3, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.264 Vali Acc: 0.590 Test Loss: 1.264 Test Acc: 0.590
Validation loss decreased (-0.393049 --> -0.589583).  Saving model ...
Epoch: 4 cost time: 3.488851308822632
Epoch: 4, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.128 Vali Acc: 0.601 Test Loss: 1.128 Test Acc: 0.601
Validation loss decreased (-0.589583 --> -0.601145).  Saving model ...
Epoch: 5 cost time: 3.329983949661255
Epoch: 5, Steps: 17 | Train Loss: 0.895 Vali Loss: 0.981 Vali Acc: 0.613 Test Loss: 0.981 Test Acc: 0.613
Validation loss decreased (-0.601145 --> -0.612707).  Saving model ...
Epoch: 6 cost time: 3.364217758178711
Epoch: 6, Steps: 17 | Train Loss: 0.689 Vali Loss: 0.932 Vali Acc: 0.659 Test Loss: 0.932 Test Acc: 0.659
Validation loss decreased (-0.612707 --> -0.658950).  Saving model ...
Epoch: 7 cost time: 3.42514967918396
Epoch: 7, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.793 Vali Acc: 0.746 Test Loss: 0.793 Test Acc: 0.746
Validation loss decreased (-0.658950 --> -0.745657).  Saving model ...
Epoch: 8 cost time: 3.3011350631713867
Epoch: 8, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.671 Vali Acc: 0.792 Test Loss: 0.671 Test Acc: 0.792
Validation loss decreased (-0.745657 --> -0.791901).  Saving model ...
Epoch: 9 cost time: 3.289418935775757
Epoch: 9, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.592 Vali Acc: 0.792 Test Loss: 0.592 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791902).  Saving model ...
Epoch: 10 cost time: 3.3379523754119873
Epoch: 10, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
Validation loss decreased (-0.791902 --> -0.809243).  Saving model ...
Epoch: 11 cost time: 3.389249563217163
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.549 Vali Acc: 0.786 Test Loss: 0.549 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2189531326293945
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.594 Vali Acc: 0.746 Test Loss: 0.594 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.436582088470459
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
Validation loss decreased (-0.809243 --> -0.849707).  Saving model ...
Epoch: 14 cost time: 3.353440284729004
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3257739543914795
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.0397071838378906
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.439 Vali Acc: 0.838 Test Loss: 0.439 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.208496332168579
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.148860454559326
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.458 Vali Acc: 0.838 Test Loss: 0.458 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2405192852020264
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.012868881225586
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.832 Test Loss: 0.462 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.292818546295166
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.832 Test Loss: 0.472 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.1387624740600586
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.486 Vali Acc: 0.832 Test Loss: 0.486 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.151419162750244
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.477 Vali Acc: 0.827 Test Loss: 0.477 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 814055
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.635392904281616
Epoch: 1, Steps: 17 | Train Loss: 1.922 Vali Loss: 1.766 Vali Acc: 0.347 Test Loss: 1.766 Test Acc: 0.347
Validation loss decreased (inf --> -0.346803).  Saving model ...
Epoch: 2 cost time: 3.0726964473724365
Epoch: 2, Steps: 17 | Train Loss: 1.638 Vali Loss: 1.468 Vali Acc: 0.474 Test Loss: 1.468 Test Acc: 0.474
Validation loss decreased (-0.346803 --> -0.473974).  Saving model ...
Epoch: 3 cost time: 3.028414011001587
Epoch: 3, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.266 Vali Acc: 0.520 Test Loss: 1.266 Test Acc: 0.520
Validation loss decreased (-0.473974 --> -0.520219).  Saving model ...
Epoch: 4 cost time: 3.264782190322876
Epoch: 4, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.114 Vali Acc: 0.595 Test Loss: 1.114 Test Acc: 0.595
Validation loss decreased (-0.520219 --> -0.595365).  Saving model ...
Epoch: 5 cost time: 2.8368277549743652
Epoch: 5, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.029 Vali Acc: 0.618 Test Loss: 1.029 Test Acc: 0.618
Validation loss decreased (-0.595365 --> -0.618487).  Saving model ...
Epoch: 6 cost time: 3.0550546646118164
Epoch: 6, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.814 Vali Acc: 0.763 Test Loss: 0.814 Test Acc: 0.763
Validation loss decreased (-0.618487 --> -0.762998).  Saving model ...
Epoch: 7 cost time: 3.0556881427764893
Epoch: 7, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.707 Vali Acc: 0.809 Test Loss: 0.707 Test Acc: 0.809
Validation loss decreased (-0.762998 --> -0.809241).  Saving model ...
Epoch: 8 cost time: 2.98673939704895
Epoch: 8, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.638 Vali Acc: 0.815 Test Loss: 0.638 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815023).  Saving model ...
Epoch: 9 cost time: 3.051058769226074
Epoch: 9, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9307572841644287
Epoch: 10, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.504 Vali Acc: 0.867 Test Loss: 0.504 Test Acc: 0.867
Validation loss decreased (-0.815023 --> -0.867047).  Saving model ...
Epoch: 11 cost time: 3.05670428276062
Epoch: 11, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3504559993743896
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.473 Vali Acc: 0.827 Test Loss: 0.473 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.646597385406494
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.427 Vali Acc: 0.827 Test Loss: 0.427 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.4920060634613037
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.455 Vali Acc: 0.832 Test Loss: 0.455 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.4269046783447266
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.395993709564209
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.451 Vali Acc: 0.809 Test Loss: 0.451 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.349074125289917
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.469 Vali Acc: 0.809 Test Loss: 0.469 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.527273654937744
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.477 Vali Acc: 0.798 Test Loss: 0.477 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.368177890777588
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.470 Vali Acc: 0.803 Test Loss: 0.470 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.4321234226226807
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.486 Vali Acc: 0.821 Test Loss: 0.486 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 2469351
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.224516868591309
Epoch: 1, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.786 Vali Acc: 0.272 Test Loss: 1.786 Test Acc: 0.272
Validation loss decreased (inf --> -0.271658).  Saving model ...
Epoch: 2 cost time: 2.5407845973968506
Epoch: 2, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.507 Vali Acc: 0.393 Test Loss: 1.507 Test Acc: 0.393
Validation loss decreased (-0.271658 --> -0.393049).  Saving model ...
Epoch: 3 cost time: 2.7965214252471924
Epoch: 3, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.264 Vali Acc: 0.590 Test Loss: 1.264 Test Acc: 0.590
Validation loss decreased (-0.393049 --> -0.589583).  Saving model ...
Epoch: 4 cost time: 2.761812686920166
Epoch: 4, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.128 Vali Acc: 0.601 Test Loss: 1.128 Test Acc: 0.601
Validation loss decreased (-0.589583 --> -0.601145).  Saving model ...
Epoch: 5 cost time: 2.557588815689087
Epoch: 5, Steps: 17 | Train Loss: 0.895 Vali Loss: 0.981 Vali Acc: 0.613 Test Loss: 0.981 Test Acc: 0.613
Validation loss decreased (-0.601145 --> -0.612707).  Saving model ...
Epoch: 6 cost time: 2.5753490924835205
Epoch: 6, Steps: 17 | Train Loss: 0.689 Vali Loss: 0.932 Vali Acc: 0.659 Test Loss: 0.932 Test Acc: 0.659
Validation loss decreased (-0.612707 --> -0.658950).  Saving model ...
Epoch: 7 cost time: 2.6120688915252686
Epoch: 7, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.793 Vali Acc: 0.746 Test Loss: 0.793 Test Acc: 0.746
Validation loss decreased (-0.658950 --> -0.745657).  Saving model ...
Epoch: 8 cost time: 2.695688486099243
Epoch: 8, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.671 Vali Acc: 0.792 Test Loss: 0.671 Test Acc: 0.792
Validation loss decreased (-0.745657 --> -0.791901).  Saving model ...
Epoch: 9 cost time: 2.711035966873169
Epoch: 9, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.583 Vali Acc: 0.792 Test Loss: 0.583 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791902).  Saving model ...
Epoch: 10 cost time: 2.6301679611206055
Epoch: 10, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 11 cost time: 2.571554660797119
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.535 Vali Acc: 0.786 Test Loss: 0.535 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5518345832824707
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.579 Vali Acc: 0.769 Test Loss: 0.579 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6636736392974854
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.438 Vali Acc: 0.861 Test Loss: 0.438 Test Acc: 0.861
Validation loss decreased (-0.803463 --> -0.861267).  Saving model ...
Epoch: 14 cost time: 2.7767460346221924
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.660154342651367
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.462 Vali Acc: 0.838 Test Loss: 0.462 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.547330141067505
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.459 Vali Acc: 0.832 Test Loss: 0.459 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4850399494171143
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.456 Vali Acc: 0.844 Test Loss: 0.456 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.723646640777588
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.6601483821868896
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.466 Vali Acc: 0.838 Test Loss: 0.466 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.576167583465576
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.477 Vali Acc: 0.832 Test Loss: 0.477 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6201703548431396
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.476 Vali Acc: 0.832 Test Loss: 0.476 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.5944101810455322
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.489 Vali Acc: 0.832 Test Loss: 0.489 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.8422141075134277
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.832 Test Loss: 0.481 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 814055
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.957387208938599
Epoch: 1, Steps: 17 | Train Loss: 2.023 Vali Loss: 1.923 Vali Acc: 0.179 Test Loss: 1.923 Test Acc: 0.179
Validation loss decreased (inf --> -0.179172).  Saving model ...
Epoch: 2 cost time: 7.160800218582153
Epoch: 2, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.786 Vali Acc: 0.335 Test Loss: 1.786 Test Acc: 0.335
Validation loss decreased (-0.179172 --> -0.335242).  Saving model ...
Epoch: 3 cost time: 7.254889488220215
Epoch: 3, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.569 Vali Acc: 0.422 Test Loss: 1.569 Test Acc: 0.422
Validation loss decreased (-0.335242 --> -0.421950).  Saving model ...
Epoch: 4 cost time: 7.091181755065918
Epoch: 4, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.384 Vali Acc: 0.509 Test Loss: 1.384 Test Acc: 0.509
Validation loss decreased (-0.421950 --> -0.508657).  Saving model ...
Epoch: 5 cost time: 6.545504808425903
Epoch: 5, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.224 Vali Acc: 0.578 Test Loss: 1.224 Test Acc: 0.578
Validation loss decreased (-0.508657 --> -0.578022).  Saving model ...
Epoch: 6 cost time: 6.796434640884399
Epoch: 6, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.087 Vali Acc: 0.624 Test Loss: 1.087 Test Acc: 0.624
Validation loss decreased (-0.578022 --> -0.624267).  Saving model ...
Epoch: 7 cost time: 7.038335561752319
Epoch: 7, Steps: 17 | Train Loss: 0.830 Vali Loss: 0.971 Vali Acc: 0.676 Test Loss: 0.971 Test Acc: 0.676
Validation loss decreased (-0.624267 --> -0.676291).  Saving model ...
Epoch: 8 cost time: 6.660470485687256
Epoch: 8, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.901 Vali Acc: 0.665 Test Loss: 0.901 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.019538164138794
Epoch: 9, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.806 Vali Acc: 0.746 Test Loss: 0.806 Test Acc: 0.746
Validation loss decreased (-0.676291 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 6.144806385040283
Epoch: 10, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.717 Vali Acc: 0.780 Test Loss: 0.717 Test Acc: 0.780
Validation loss decreased (-0.745657 --> -0.780340).  Saving model ...
Epoch: 11 cost time: 6.361361265182495
Epoch: 11, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.712 Vali Acc: 0.763 Test Loss: 0.712 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.953226089477539
Epoch: 12, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.671 Vali Acc: 0.740 Test Loss: 0.671 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.287760496139526
Epoch: 13, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
Validation loss decreased (-0.780340 --> -0.803462).  Saving model ...
Epoch: 14 cost time: 5.9402642250061035
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809243).  Saving model ...
Epoch: 15 cost time: 6.322275876998901
Epoch: 15, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.670 Vali Acc: 0.763 Test Loss: 0.670 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.195673942565918
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.536 Vali Acc: 0.815 Test Loss: 0.536 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 17 cost time: 6.892370223999023
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.595 Vali Acc: 0.798 Test Loss: 0.595 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.160254001617432
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.037747859954834
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.629 Vali Acc: 0.798 Test Loss: 0.629 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.13377571105957
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.589 Vali Acc: 0.809 Test Loss: 0.589 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.1580588817596436
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.698 Vali Acc: 0.798 Test Loss: 0.698 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.038896560668945
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.621 Vali Acc: 0.815 Test Loss: 0.621 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.442979097366333
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.636 Vali Acc: 0.803 Test Loss: 0.636 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.592528820037842
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.658 Vali Acc: 0.815 Test Loss: 0.658 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.475488662719727
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.702 Vali Acc: 0.798 Test Loss: 0.702 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.2857255935668945
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 2407287
model size : 9.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.006185531616211
Epoch: 1, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.929 Vali Acc: 0.185 Test Loss: 1.929 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 4.475007772445679
Epoch: 2, Steps: 17 | Train Loss: 1.782 Vali Loss: 1.706 Vali Acc: 0.289 Test Loss: 1.706 Test Acc: 0.289
Validation loss decreased (-0.184952 --> -0.289000).  Saving model ...
Epoch: 3 cost time: 4.227206230163574
Epoch: 3, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.487 Vali Acc: 0.405 Test Loss: 1.487 Test Acc: 0.405
Validation loss decreased (-0.289000 --> -0.404609).  Saving model ...
Epoch: 4 cost time: 4.10170316696167
Epoch: 4, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.306 Vali Acc: 0.532 Test Loss: 1.306 Test Acc: 0.532
Validation loss decreased (-0.404609 --> -0.531779).  Saving model ...
Epoch: 5 cost time: 3.9901416301727295
Epoch: 5, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.194 Vali Acc: 0.561 Test Loss: 1.194 Test Acc: 0.561
Validation loss decreased (-0.531779 --> -0.560682).  Saving model ...
Epoch: 6 cost time: 4.026123046875
Epoch: 6, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.132 Vali Acc: 0.572 Test Loss: 1.132 Test Acc: 0.572
Validation loss decreased (-0.560682 --> -0.572243).  Saving model ...
Epoch: 7 cost time: 4.183537006378174
Epoch: 7, Steps: 17 | Train Loss: 0.880 Vali Loss: 1.086 Vali Acc: 0.561 Test Loss: 1.086 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.105908393859863
Epoch: 8, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.906 Vali Acc: 0.717 Test Loss: 0.906 Test Acc: 0.717
Validation loss decreased (-0.572243 --> -0.716754).  Saving model ...
Epoch: 9 cost time: 4.004784822463989
Epoch: 9, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.805 Vali Acc: 0.734 Test Loss: 0.805 Test Acc: 0.734
Validation loss decreased (-0.716754 --> -0.734096).  Saving model ...
Epoch: 10 cost time: 4.030940055847168
Epoch: 10, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.704 Vali Acc: 0.751 Test Loss: 0.704 Test Acc: 0.751
Validation loss decreased (-0.734096 --> -0.751438).  Saving model ...
Epoch: 11 cost time: 4.168285131454468
Epoch: 11, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.640 Vali Acc: 0.798 Test Loss: 0.640 Test Acc: 0.798
Validation loss decreased (-0.751438 --> -0.797681).  Saving model ...
Epoch: 12 cost time: 4.135952472686768
Epoch: 12, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9782750606536865
Epoch: 13, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.600 Vali Acc: 0.798 Test Loss: 0.600 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797682).  Saving model ...
Epoch: 14 cost time: 3.952010154724121
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.657 Vali Acc: 0.763 Test Loss: 0.657 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9738306999206543
Epoch: 15, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809243).  Saving model ...
Epoch: 16 cost time: 3.831648349761963
Epoch: 16, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.682 Vali Acc: 0.780 Test Loss: 0.682 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.66416335105896
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.587 Vali Acc: 0.798 Test Loss: 0.587 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.939908742904663
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.574 Vali Acc: 0.827 Test Loss: 0.574 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826584).  Saving model ...
Epoch: 19 cost time: 3.832058906555176
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.578 Vali Acc: 0.838 Test Loss: 0.578 Test Acc: 0.838
Validation loss decreased (-0.826584 --> -0.838145).  Saving model ...
Epoch: 20 cost time: 3.926722526550293
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.573 Vali Acc: 0.827 Test Loss: 0.573 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8883354663848877
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.587 Vali Acc: 0.827 Test Loss: 0.587 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.777592658996582
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.608 Vali Acc: 0.815 Test Loss: 0.608 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.830744743347168
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.600 Vali Acc: 0.815 Test Loss: 0.600 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.8955495357513428
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.580 Vali Acc: 0.827 Test Loss: 0.580 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.0850517749786377
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.596 Vali Acc: 0.815 Test Loss: 0.596 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.512863874435425
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.614 Vali Acc: 0.821 Test Loss: 0.614 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.7238192558288574
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.609 Vali Acc: 0.832 Test Loss: 0.609 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.4877233505249023
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.611 Vali Acc: 0.815 Test Loss: 0.611 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.59138560295105
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 751863
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.193535089492798
Epoch: 1, Steps: 17 | Train Loss: 2.023 Vali Loss: 1.923 Vali Acc: 0.179 Test Loss: 1.923 Test Acc: 0.179
Validation loss decreased (inf --> -0.179172).  Saving model ...
Epoch: 2 cost time: 4.474431276321411
Epoch: 2, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.786 Vali Acc: 0.335 Test Loss: 1.786 Test Acc: 0.335
Validation loss decreased (-0.179172 --> -0.335242).  Saving model ...
Epoch: 3 cost time: 4.973039627075195
Epoch: 3, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.569 Vali Acc: 0.422 Test Loss: 1.569 Test Acc: 0.422
Validation loss decreased (-0.335242 --> -0.421950).  Saving model ...
Epoch: 4 cost time: 3.5242764949798584
Epoch: 4, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.384 Vali Acc: 0.509 Test Loss: 1.384 Test Acc: 0.509
Validation loss decreased (-0.421950 --> -0.508657).  Saving model ...
Epoch: 5 cost time: 5.4846203327178955
Epoch: 5, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.224 Vali Acc: 0.578 Test Loss: 1.224 Test Acc: 0.578
Validation loss decreased (-0.508657 --> -0.578022).  Saving model ...
Epoch: 6 cost time: 5.109707832336426
Epoch: 6, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.087 Vali Acc: 0.624 Test Loss: 1.087 Test Acc: 0.624
Validation loss decreased (-0.578022 --> -0.624267).  Saving model ...
Epoch: 7 cost time: 5.159255266189575
Epoch: 7, Steps: 17 | Train Loss: 0.830 Vali Loss: 0.971 Vali Acc: 0.676 Test Loss: 0.971 Test Acc: 0.676
Validation loss decreased (-0.624267 --> -0.676291).  Saving model ...
Epoch: 8 cost time: 5.3138368129730225
Epoch: 8, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.901 Vali Acc: 0.665 Test Loss: 0.901 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.322944164276123
Epoch: 9, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.806 Vali Acc: 0.746 Test Loss: 0.806 Test Acc: 0.746
Validation loss decreased (-0.676291 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 5.410484075546265
Epoch: 10, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.717 Vali Acc: 0.780 Test Loss: 0.717 Test Acc: 0.780
Validation loss decreased (-0.745657 --> -0.780340).  Saving model ...
Epoch: 11 cost time: 5.242951393127441
Epoch: 11, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.712 Vali Acc: 0.763 Test Loss: 0.712 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.402852296829224
Epoch: 12, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.671 Vali Acc: 0.740 Test Loss: 0.671 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.461506128311157
Epoch: 13, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
Validation loss decreased (-0.780340 --> -0.803462).  Saving model ...
Epoch: 14 cost time: 5.355921745300293
Epoch: 14, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.543 Vali Acc: 0.821 Test Loss: 0.543 Test Acc: 0.821
Validation loss decreased (-0.803462 --> -0.820804).  Saving model ...
Epoch: 15 cost time: 5.412329435348511
Epoch: 15, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.655 Vali Acc: 0.786 Test Loss: 0.655 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.485594987869263
Epoch: 16, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.551 Vali Acc: 0.832 Test Loss: 0.551 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832364).  Saving model ...
Epoch: 17 cost time: 5.492969036102295
Epoch: 17, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.554 Vali Acc: 0.827 Test Loss: 0.554 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.393907785415649
Epoch: 18, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.574 Vali Acc: 0.803 Test Loss: 0.574 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.516956806182861
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.591 Vali Acc: 0.815 Test Loss: 0.591 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.49829888343811
Epoch: 20, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.563 Vali Acc: 0.809 Test Loss: 0.563 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.486024618148804
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.682 Vali Acc: 0.803 Test Loss: 0.682 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.5325093269348145
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.492287874221802
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.159067630767822
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.809 Test Loss: 0.655 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.29503321647644
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.690 Vali Acc: 0.809 Test Loss: 0.690 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.326457977294922
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.650 Vali Acc: 0.809 Test Loss: 0.650 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 2407287
model size : 9.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.124793767929077
Epoch: 1, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.929 Vali Acc: 0.185 Test Loss: 1.929 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 3.387284517288208
Epoch: 2, Steps: 17 | Train Loss: 1.782 Vali Loss: 1.706 Vali Acc: 0.289 Test Loss: 1.706 Test Acc: 0.289
Validation loss decreased (-0.184952 --> -0.289000).  Saving model ...
Epoch: 3 cost time: 3.2887656688690186
Epoch: 3, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.487 Vali Acc: 0.405 Test Loss: 1.487 Test Acc: 0.405
Validation loss decreased (-0.289000 --> -0.404609).  Saving model ...
Epoch: 4 cost time: 3.3529701232910156
Epoch: 4, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.306 Vali Acc: 0.532 Test Loss: 1.306 Test Acc: 0.532
Validation loss decreased (-0.404609 --> -0.531779).  Saving model ...
Epoch: 5 cost time: 3.2337265014648438
Epoch: 5, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.194 Vali Acc: 0.561 Test Loss: 1.194 Test Acc: 0.561
Validation loss decreased (-0.531779 --> -0.560682).  Saving model ...
Epoch: 6 cost time: 3.4495770931243896
Epoch: 6, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.132 Vali Acc: 0.572 Test Loss: 1.132 Test Acc: 0.572
Validation loss decreased (-0.560682 --> -0.572243).  Saving model ...
Epoch: 7 cost time: 3.3612124919891357
Epoch: 7, Steps: 17 | Train Loss: 0.880 Vali Loss: 1.086 Vali Acc: 0.561 Test Loss: 1.086 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4128262996673584
Epoch: 8, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.906 Vali Acc: 0.717 Test Loss: 0.906 Test Acc: 0.717
Validation loss decreased (-0.572243 --> -0.716754).  Saving model ...
Epoch: 9 cost time: 3.3206636905670166
Epoch: 9, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.805 Vali Acc: 0.734 Test Loss: 0.805 Test Acc: 0.734
Validation loss decreased (-0.716754 --> -0.734096).  Saving model ...
Epoch: 10 cost time: 3.236114501953125
Epoch: 10, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.704 Vali Acc: 0.751 Test Loss: 0.704 Test Acc: 0.751
Validation loss decreased (-0.734096 --> -0.751438).  Saving model ...
Epoch: 11 cost time: 3.3753232955932617
Epoch: 11, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.640 Vali Acc: 0.798 Test Loss: 0.640 Test Acc: 0.798
Validation loss decreased (-0.751438 --> -0.797681).  Saving model ...
Epoch: 12 cost time: 3.0865018367767334
Epoch: 12, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.068298101425171
Epoch: 13, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.600 Vali Acc: 0.798 Test Loss: 0.600 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797682).  Saving model ...
Epoch: 14 cost time: 3.08750057220459
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.657 Vali Acc: 0.763 Test Loss: 0.657 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0059654712677
Epoch: 15, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809243).  Saving model ...
Epoch: 16 cost time: 2.9018893241882324
Epoch: 16, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.682 Vali Acc: 0.786 Test Loss: 0.682 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.87103009223938
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.587 Vali Acc: 0.798 Test Loss: 0.587 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4019980430603027
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.574 Vali Acc: 0.827 Test Loss: 0.574 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826584).  Saving model ...
Epoch: 19 cost time: 3.2055022716522217
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.578 Vali Acc: 0.838 Test Loss: 0.578 Test Acc: 0.838
Validation loss decreased (-0.826584 --> -0.838145).  Saving model ...
Epoch: 20 cost time: 3.1737701892852783
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.573 Vali Acc: 0.827 Test Loss: 0.573 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.055819034576416
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.587 Vali Acc: 0.827 Test Loss: 0.587 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1159560680389404
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.608 Vali Acc: 0.815 Test Loss: 0.608 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.2044034004211426
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.600 Vali Acc: 0.815 Test Loss: 0.600 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.1293716430664062
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.582 Vali Acc: 0.827 Test Loss: 0.582 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.2905633449554443
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.598 Vali Acc: 0.815 Test Loss: 0.598 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.515422821044922
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.614 Vali Acc: 0.821 Test Loss: 0.614 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.640495538711548
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.609 Vali Acc: 0.832 Test Loss: 0.609 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.564836263656616
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.611 Vali Acc: 0.815 Test Loss: 0.611 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.6049070358276367
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 751863
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.894958019256592
Epoch: 1, Steps: 17 | Train Loss: 2.023 Vali Loss: 1.923 Vali Acc: 0.179 Test Loss: 1.923 Test Acc: 0.179
Validation loss decreased (inf --> -0.179172).  Saving model ...
Epoch: 2 cost time: 3.744917869567871
Epoch: 2, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.786 Vali Acc: 0.335 Test Loss: 1.786 Test Acc: 0.335
Validation loss decreased (-0.179172 --> -0.335242).  Saving model ...
Epoch: 3 cost time: 3.8099308013916016
Epoch: 3, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.569 Vali Acc: 0.422 Test Loss: 1.569 Test Acc: 0.422
Validation loss decreased (-0.335242 --> -0.421950).  Saving model ...
Epoch: 4 cost time: 3.829850435256958
Epoch: 4, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.384 Vali Acc: 0.509 Test Loss: 1.384 Test Acc: 0.509
Validation loss decreased (-0.421950 --> -0.508657).  Saving model ...
Epoch: 5 cost time: 3.926325559616089
Epoch: 5, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.224 Vali Acc: 0.578 Test Loss: 1.224 Test Acc: 0.578
Validation loss decreased (-0.508657 --> -0.578022).  Saving model ...
Epoch: 6 cost time: 3.833648920059204
Epoch: 6, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.087 Vali Acc: 0.624 Test Loss: 1.087 Test Acc: 0.624
Validation loss decreased (-0.578022 --> -0.624267).  Saving model ...
Epoch: 7 cost time: 3.6989777088165283
Epoch: 7, Steps: 17 | Train Loss: 0.830 Vali Loss: 0.971 Vali Acc: 0.676 Test Loss: 0.971 Test Acc: 0.676
Validation loss decreased (-0.624267 --> -0.676291).  Saving model ...
Epoch: 8 cost time: 3.8056640625
Epoch: 8, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.901 Vali Acc: 0.665 Test Loss: 0.901 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7386386394500732
Epoch: 9, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.806 Vali Acc: 0.746 Test Loss: 0.806 Test Acc: 0.746
Validation loss decreased (-0.676291 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 3.8373382091522217
Epoch: 10, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.717 Vali Acc: 0.780 Test Loss: 0.717 Test Acc: 0.780
Validation loss decreased (-0.745657 --> -0.780340).  Saving model ...
Epoch: 11 cost time: 4.052668333053589
Epoch: 11, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.711 Vali Acc: 0.757 Test Loss: 0.711 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.928323984146118
Epoch: 12, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.671 Vali Acc: 0.775 Test Loss: 0.671 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9754762649536133
Epoch: 13, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.590 Vali Acc: 0.821 Test Loss: 0.590 Test Acc: 0.821
Validation loss decreased (-0.780340 --> -0.820803).  Saving model ...
Epoch: 14 cost time: 3.968040943145752
Epoch: 14, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.583 Vali Acc: 0.798 Test Loss: 0.583 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.975938558578491
Epoch: 15, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.633 Vali Acc: 0.780 Test Loss: 0.633 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5857431888580322
Epoch: 16, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.518 Vali Acc: 0.827 Test Loss: 0.518 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826584).  Saving model ...
Epoch: 17 cost time: 3.8505094051361084
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.589 Vali Acc: 0.798 Test Loss: 0.589 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.9348509311676025
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.723381996154785
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.779672861099243
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.581 Vali Acc: 0.809 Test Loss: 0.581 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.7131459712982178
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.641 Vali Acc: 0.815 Test Loss: 0.641 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.8123295307159424
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.653 Vali Acc: 0.809 Test Loss: 0.653 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.7828187942504883
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.835954189300537
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.627 Vali Acc: 0.803 Test Loss: 0.627 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.6517558097839355
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.680 Vali Acc: 0.809 Test Loss: 0.680 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.5820515155792236
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.653 Vali Acc: 0.798 Test Loss: 0.653 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2407287
model size : 9.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.117877721786499
Epoch: 1, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.929 Vali Acc: 0.185 Test Loss: 1.929 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 2.5143983364105225
Epoch: 2, Steps: 17 | Train Loss: 1.782 Vali Loss: 1.706 Vali Acc: 0.289 Test Loss: 1.706 Test Acc: 0.289
Validation loss decreased (-0.184952 --> -0.289000).  Saving model ...
Epoch: 3 cost time: 2.5060410499572754
Epoch: 3, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.487 Vali Acc: 0.405 Test Loss: 1.487 Test Acc: 0.405
Validation loss decreased (-0.289000 --> -0.404609).  Saving model ...
Epoch: 4 cost time: 2.454728126525879
Epoch: 4, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.306 Vali Acc: 0.532 Test Loss: 1.306 Test Acc: 0.532
Validation loss decreased (-0.404609 --> -0.531779).  Saving model ...
Epoch: 5 cost time: 2.546485185623169
Epoch: 5, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.194 Vali Acc: 0.561 Test Loss: 1.194 Test Acc: 0.561
Validation loss decreased (-0.531779 --> -0.560682).  Saving model ...
Epoch: 6 cost time: 2.5894722938537598
Epoch: 6, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.132 Vali Acc: 0.572 Test Loss: 1.132 Test Acc: 0.572
Validation loss decreased (-0.560682 --> -0.572243).  Saving model ...
Epoch: 7 cost time: 2.535651922225952
Epoch: 7, Steps: 17 | Train Loss: 0.880 Vali Loss: 1.086 Vali Acc: 0.561 Test Loss: 1.086 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.541609287261963
Epoch: 8, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.906 Vali Acc: 0.717 Test Loss: 0.906 Test Acc: 0.717
Validation loss decreased (-0.572243 --> -0.716754).  Saving model ...
Epoch: 9 cost time: 2.5642871856689453
Epoch: 9, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.805 Vali Acc: 0.734 Test Loss: 0.805 Test Acc: 0.734
Validation loss decreased (-0.716754 --> -0.734096).  Saving model ...
Epoch: 10 cost time: 2.71274995803833
Epoch: 10, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.705 Vali Acc: 0.751 Test Loss: 0.705 Test Acc: 0.751
Validation loss decreased (-0.734096 --> -0.751438).  Saving model ...
Epoch: 11 cost time: 2.4634790420532227
Epoch: 11, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.638 Vali Acc: 0.809 Test Loss: 0.638 Test Acc: 0.809
Validation loss decreased (-0.751438 --> -0.809242).  Saving model ...
Epoch: 12 cost time: 2.545450210571289
Epoch: 12, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.683 Vali Acc: 0.757 Test Loss: 0.683 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3235158920288086
Epoch: 13, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.598 Vali Acc: 0.803 Test Loss: 0.598 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.337332010269165
Epoch: 14, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.650 Vali Acc: 0.769 Test Loss: 0.650 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3418819904327393
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.573 Vali Acc: 0.803 Test Loss: 0.573 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2694883346557617
Epoch: 16, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.686 Vali Acc: 0.786 Test Loss: 0.686 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.272616147994995
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809243).  Saving model ...
Epoch: 18 cost time: 2.081141710281372
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.571 Vali Acc: 0.827 Test Loss: 0.571 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826584).  Saving model ...
Epoch: 19 cost time: 2.5472161769866943
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.588 Vali Acc: 0.815 Test Loss: 0.588 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.449310779571533
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.600 Vali Acc: 0.815 Test Loss: 0.600 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.558434009552002
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.584 Vali Acc: 0.838 Test Loss: 0.584 Test Acc: 0.838
Validation loss decreased (-0.826584 --> -0.838144).  Saving model ...
Epoch: 22 cost time: 2.453420639038086
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.592 Vali Acc: 0.827 Test Loss: 0.592 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.589693546295166
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.594 Vali Acc: 0.827 Test Loss: 0.594 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6955385208129883
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.788273334503174
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.612 Vali Acc: 0.803 Test Loss: 0.612 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.943873643875122
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.609 Vali Acc: 0.815 Test Loss: 0.609 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.876770257949829
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.609 Vali Acc: 0.815 Test Loss: 0.609 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.8202919960021973
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.614 Vali Acc: 0.815 Test Loss: 0.614 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.914766311645508
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.815 Test Loss: 0.610 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.884213924407959
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.809 Test Loss: 0.627 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 751863
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.23953652381897
Epoch: 1, Steps: 17 | Train Loss: 2.025 Vali Loss: 1.883 Vali Acc: 0.260 Test Loss: 1.883 Test Acc: 0.260
Validation loss decreased (inf --> -0.260097).  Saving model ...
Epoch: 2 cost time: 5.5242919921875
Epoch: 2, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.682 Vali Acc: 0.358 Test Loss: 1.682 Test Acc: 0.358
Validation loss decreased (-0.260097 --> -0.358365).  Saving model ...
Epoch: 3 cost time: 5.426760196685791
Epoch: 3, Steps: 17 | Train Loss: 1.584 Vali Loss: 1.506 Vali Acc: 0.347 Test Loss: 1.506 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.670691013336182
Epoch: 4, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.366 Vali Acc: 0.462 Test Loss: 1.366 Test Acc: 0.462
Validation loss decreased (-0.358365 --> -0.462414).  Saving model ...
Epoch: 5 cost time: 5.337731122970581
Epoch: 5, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.233 Vali Acc: 0.538 Test Loss: 1.233 Test Acc: 0.538
Validation loss decreased (-0.462414 --> -0.537560).  Saving model ...
Epoch: 6 cost time: 5.700475215911865
Epoch: 6, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.158 Vali Acc: 0.543 Test Loss: 1.158 Test Acc: 0.543
Validation loss decreased (-0.537560 --> -0.543341).  Saving model ...
Epoch: 7 cost time: 5.551374673843384
Epoch: 7, Steps: 17 | Train Loss: 0.913 Vali Loss: 1.011 Vali Acc: 0.671 Test Loss: 1.011 Test Acc: 0.671
Validation loss decreased (-0.543341 --> -0.670510).  Saving model ...
Epoch: 8 cost time: 5.619774103164673
Epoch: 8, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.925 Vali Acc: 0.647 Test Loss: 0.925 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.440684795379639
Epoch: 9, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.788 Vali Acc: 0.723 Test Loss: 0.788 Test Acc: 0.723
Validation loss decreased (-0.670510 --> -0.722535).  Saving model ...
Epoch: 10 cost time: 5.188655138015747
Epoch: 10, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.736 Vali Acc: 0.723 Test Loss: 0.736 Test Acc: 0.723
Validation loss decreased (-0.722535 --> -0.722536).  Saving model ...
Epoch: 11 cost time: 5.4411046504974365
Epoch: 11, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.771 Vali Acc: 0.699 Test Loss: 0.771 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.565283536911011
Epoch: 12, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.639 Vali Acc: 0.775 Test Loss: 0.639 Test Acc: 0.775
Validation loss decreased (-0.722536 --> -0.774560).  Saving model ...
Epoch: 13 cost time: 5.477468252182007
Epoch: 13, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.670 Vali Acc: 0.728 Test Loss: 0.670 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.492737770080566
Epoch: 14, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.578 Vali Acc: 0.780 Test Loss: 0.578 Test Acc: 0.780
Validation loss decreased (-0.774560 --> -0.780341).  Saving model ...
Epoch: 15 cost time: 5.509582281112671
Epoch: 15, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.620 Vali Acc: 0.786 Test Loss: 0.620 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 16 cost time: 5.5096235275268555
Epoch: 16, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.581 Vali Acc: 0.792 Test Loss: 0.581 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791902).  Saving model ...
Epoch: 17 cost time: 5.385282039642334
Epoch: 17, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.617 Vali Acc: 0.815 Test Loss: 0.617 Test Acc: 0.815
Validation loss decreased (-0.791902 --> -0.815023).  Saving model ...
Epoch: 18 cost time: 5.432532548904419
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.593 Vali Acc: 0.786 Test Loss: 0.593 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.404702425003052
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.706 Vali Acc: 0.769 Test Loss: 0.706 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.418317079544067
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815023).  Saving model ...
Epoch: 21 cost time: 5.289419412612915
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.631 Vali Acc: 0.798 Test Loss: 0.631 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.466077089309692
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.638 Vali Acc: 0.786 Test Loss: 0.638 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.382671356201172
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.638 Vali Acc: 0.809 Test Loss: 0.638 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.18799352645874
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.644 Vali Acc: 0.786 Test Loss: 0.644 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.274887323379517
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.656 Vali Acc: 0.798 Test Loss: 0.656 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.938736915588379
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.685 Vali Acc: 0.786 Test Loss: 0.685 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.436431407928467
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.693 Vali Acc: 0.775 Test Loss: 0.693 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.73276686668396
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.671 Vali Acc: 0.786 Test Loss: 0.671 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.689382791519165
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.721 Vali Acc: 0.792 Test Loss: 0.721 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.812991380691528
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.726 Vali Acc: 0.786 Test Loss: 0.726 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1235063
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.98113489151001
Epoch: 1, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.846 Vali Acc: 0.214 Test Loss: 1.846 Test Acc: 0.214
Validation loss decreased (inf --> -0.213854).  Saving model ...
Epoch: 2 cost time: 3.2006046772003174
Epoch: 2, Steps: 17 | Train Loss: 1.753 Vali Loss: 1.675 Vali Acc: 0.272 Test Loss: 1.675 Test Acc: 0.272
Validation loss decreased (-0.213854 --> -0.271660).  Saving model ...
Epoch: 3 cost time: 3.084472417831421
Epoch: 3, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.495 Vali Acc: 0.410 Test Loss: 1.495 Test Acc: 0.410
Validation loss decreased (-0.271660 --> -0.410390).  Saving model ...
Epoch: 4 cost time: 3.3495640754699707
Epoch: 4, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.336 Vali Acc: 0.486 Test Loss: 1.336 Test Acc: 0.486
Validation loss decreased (-0.410390 --> -0.485536).  Saving model ...
Epoch: 5 cost time: 3.2955310344696045
Epoch: 5, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.178 Vali Acc: 0.642 Test Loss: 1.178 Test Acc: 0.642
Validation loss decreased (-0.485536 --> -0.641607).  Saving model ...
Epoch: 6 cost time: 3.264430046081543
Epoch: 6, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.096 Vali Acc: 0.566 Test Loss: 1.096 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4595084190368652
Epoch: 7, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.977 Vali Acc: 0.647 Test Loss: 0.977 Test Acc: 0.647
Validation loss decreased (-0.641607 --> -0.647389).  Saving model ...
Epoch: 8 cost time: 3.614736795425415
Epoch: 8, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.873 Vali Acc: 0.647 Test Loss: 0.873 Test Acc: 0.647
Validation loss decreased (-0.647389 --> -0.647390).  Saving model ...
Epoch: 9 cost time: 3.4754602909088135
Epoch: 9, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
Validation loss decreased (-0.647390 --> -0.774559).  Saving model ...
Epoch: 10 cost time: 3.6544432640075684
Epoch: 10, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.692 Vali Acc: 0.769 Test Loss: 0.692 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4994215965270996
Epoch: 11, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.662 Vali Acc: 0.763 Test Loss: 0.662 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.602785587310791
Epoch: 12, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.626 Vali Acc: 0.734 Test Loss: 0.626 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5283069610595703
Epoch: 13, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.6437599658966064
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.521 Vali Acc: 0.775 Test Loss: 0.521 Test Acc: 0.775
Validation loss decreased (-0.774559 --> -0.774561).  Saving model ...
Epoch: 15 cost time: 3.5528981685638428
Epoch: 15, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
Validation loss decreased (-0.774561 --> -0.809244).  Saving model ...
Epoch: 16 cost time: 3.403658151626587
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.509 Vali Acc: 0.827 Test Loss: 0.509 Test Acc: 0.827
Validation loss decreased (-0.809244 --> -0.826585).  Saving model ...
Epoch: 17 cost time: 3.4716551303863525
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.501 Vali Acc: 0.780 Test Loss: 0.501 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.583489418029785
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4143965244293213
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.540 Vali Acc: 0.792 Test Loss: 0.540 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.5600016117095947
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.543 Vali Acc: 0.786 Test Loss: 0.543 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.499910831451416
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.542 Vali Acc: 0.792 Test Loss: 0.542 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.581110954284668
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.517 Vali Acc: 0.775 Test Loss: 0.517 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.4337315559387207
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.546 Vali Acc: 0.780 Test Loss: 0.546 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.6119961738586426
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.540 Vali Acc: 0.775 Test Loss: 0.540 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.486581563949585
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.530 Vali Acc: 0.792 Test Loss: 0.530 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.561994791030884
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.562 Vali Acc: 0.769 Test Loss: 0.562 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 407287
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.256473064422607
Epoch: 1, Steps: 17 | Train Loss: 2.025 Vali Loss: 1.883 Vali Acc: 0.260 Test Loss: 1.883 Test Acc: 0.260
Validation loss decreased (inf --> -0.260097).  Saving model ...
Epoch: 2 cost time: 4.408691644668579
Epoch: 2, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.682 Vali Acc: 0.358 Test Loss: 1.682 Test Acc: 0.358
Validation loss decreased (-0.260097 --> -0.358365).  Saving model ...
Epoch: 3 cost time: 4.377405405044556
Epoch: 3, Steps: 17 | Train Loss: 1.584 Vali Loss: 1.506 Vali Acc: 0.347 Test Loss: 1.506 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.396125793457031
Epoch: 4, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.366 Vali Acc: 0.462 Test Loss: 1.366 Test Acc: 0.462
Validation loss decreased (-0.358365 --> -0.462414).  Saving model ...
Epoch: 5 cost time: 4.288592576980591
Epoch: 5, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.233 Vali Acc: 0.538 Test Loss: 1.233 Test Acc: 0.538
Validation loss decreased (-0.462414 --> -0.537560).  Saving model ...
Epoch: 6 cost time: 4.231783866882324
Epoch: 6, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.158 Vali Acc: 0.543 Test Loss: 1.158 Test Acc: 0.543
Validation loss decreased (-0.537560 --> -0.543341).  Saving model ...
Epoch: 7 cost time: 4.202964544296265
Epoch: 7, Steps: 17 | Train Loss: 0.913 Vali Loss: 1.011 Vali Acc: 0.671 Test Loss: 1.011 Test Acc: 0.671
Validation loss decreased (-0.543341 --> -0.670510).  Saving model ...
Epoch: 8 cost time: 4.122724294662476
Epoch: 8, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.925 Vali Acc: 0.647 Test Loss: 0.925 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.340472221374512
Epoch: 9, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.788 Vali Acc: 0.723 Test Loss: 0.788 Test Acc: 0.723
Validation loss decreased (-0.670510 --> -0.722535).  Saving model ...
Epoch: 10 cost time: 4.483801603317261
Epoch: 10, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.736 Vali Acc: 0.723 Test Loss: 0.736 Test Acc: 0.723
Validation loss decreased (-0.722535 --> -0.722536).  Saving model ...
Epoch: 11 cost time: 4.377575635910034
Epoch: 11, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.771 Vali Acc: 0.699 Test Loss: 0.771 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.24966835975647
Epoch: 12, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.639 Vali Acc: 0.775 Test Loss: 0.639 Test Acc: 0.775
Validation loss decreased (-0.722536 --> -0.774560).  Saving model ...
Epoch: 13 cost time: 4.029454708099365
Epoch: 13, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.670 Vali Acc: 0.728 Test Loss: 0.670 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.488062620162964
Epoch: 14, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.578 Vali Acc: 0.780 Test Loss: 0.578 Test Acc: 0.780
Validation loss decreased (-0.774560 --> -0.780341).  Saving model ...
Epoch: 15 cost time: 4.5510265827178955
Epoch: 15, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.620 Vali Acc: 0.786 Test Loss: 0.620 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 16 cost time: 3.974623441696167
Epoch: 16, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.581 Vali Acc: 0.792 Test Loss: 0.581 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791902).  Saving model ...
Epoch: 17 cost time: 4.301345109939575
Epoch: 17, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.618 Vali Acc: 0.815 Test Loss: 0.618 Test Acc: 0.815
Validation loss decreased (-0.791902 --> -0.815023).  Saving model ...
Epoch: 18 cost time: 4.409044504165649
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.593 Vali Acc: 0.786 Test Loss: 0.593 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.168521165847778
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.702 Vali Acc: 0.769 Test Loss: 0.702 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.86769962310791
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.556 Vali Acc: 0.821 Test Loss: 0.556 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820804).  Saving model ...
Epoch: 21 cost time: 4.046001672744751
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.630 Vali Acc: 0.798 Test Loss: 0.630 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.169829845428467
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.637 Vali Acc: 0.786 Test Loss: 0.637 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.09312105178833
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.636 Vali Acc: 0.809 Test Loss: 0.636 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.6208457946777344
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.642 Vali Acc: 0.798 Test Loss: 0.642 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.181233167648315
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.657 Vali Acc: 0.798 Test Loss: 0.657 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.903512716293335
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.682 Vali Acc: 0.786 Test Loss: 0.682 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.939620018005371
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.690 Vali Acc: 0.775 Test Loss: 0.690 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.8611319065093994
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.670 Vali Acc: 0.786 Test Loss: 0.670 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.044366359710693
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.719 Vali Acc: 0.792 Test Loss: 0.719 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.9998419284820557
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.725 Vali Acc: 0.786 Test Loss: 0.725 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1235063
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.424150228500366
Epoch: 1, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.846 Vali Acc: 0.214 Test Loss: 1.846 Test Acc: 0.214
Validation loss decreased (inf --> -0.213854).  Saving model ...
Epoch: 2 cost time: 2.852304220199585
Epoch: 2, Steps: 17 | Train Loss: 1.753 Vali Loss: 1.675 Vali Acc: 0.272 Test Loss: 1.675 Test Acc: 0.272
Validation loss decreased (-0.213854 --> -0.271660).  Saving model ...
Epoch: 3 cost time: 2.7621166706085205
Epoch: 3, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.495 Vali Acc: 0.410 Test Loss: 1.495 Test Acc: 0.410
Validation loss decreased (-0.271660 --> -0.410390).  Saving model ...
Epoch: 4 cost time: 2.7989883422851562
Epoch: 4, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.336 Vali Acc: 0.486 Test Loss: 1.336 Test Acc: 0.486
Validation loss decreased (-0.410390 --> -0.485536).  Saving model ...
Epoch: 5 cost time: 2.886218547821045
Epoch: 5, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.178 Vali Acc: 0.642 Test Loss: 1.178 Test Acc: 0.642
Validation loss decreased (-0.485536 --> -0.641607).  Saving model ...
Epoch: 6 cost time: 2.8780226707458496
Epoch: 6, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.096 Vali Acc: 0.566 Test Loss: 1.096 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.983461618423462
Epoch: 7, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.977 Vali Acc: 0.647 Test Loss: 0.977 Test Acc: 0.647
Validation loss decreased (-0.641607 --> -0.647389).  Saving model ...
Epoch: 8 cost time: 2.961604595184326
Epoch: 8, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.873 Vali Acc: 0.647 Test Loss: 0.873 Test Acc: 0.647
Validation loss decreased (-0.647389 --> -0.647390).  Saving model ...
Epoch: 9 cost time: 2.9847428798675537
Epoch: 9, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
Validation loss decreased (-0.647390 --> -0.774559).  Saving model ...
Epoch: 10 cost time: 2.9205329418182373
Epoch: 10, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.692 Vali Acc: 0.769 Test Loss: 0.692 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8593685626983643
Epoch: 11, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.663 Vali Acc: 0.763 Test Loss: 0.663 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8954625129699707
Epoch: 12, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.626 Vali Acc: 0.734 Test Loss: 0.626 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9511563777923584
Epoch: 13, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8919873237609863
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.521 Vali Acc: 0.775 Test Loss: 0.521 Test Acc: 0.775
Validation loss decreased (-0.774559 --> -0.774561).  Saving model ...
Epoch: 15 cost time: 2.866976737976074
Epoch: 15, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
Validation loss decreased (-0.774561 --> -0.809244).  Saving model ...
Epoch: 16 cost time: 2.8797049522399902
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.509 Vali Acc: 0.827 Test Loss: 0.509 Test Acc: 0.827
Validation loss decreased (-0.809244 --> -0.826585).  Saving model ...
Epoch: 17 cost time: 2.783867835998535
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.501 Vali Acc: 0.780 Test Loss: 0.501 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.004143238067627
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8947970867156982
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.540 Vali Acc: 0.792 Test Loss: 0.540 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.67496919631958
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.542 Vali Acc: 0.786 Test Loss: 0.542 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.923966646194458
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.543 Vali Acc: 0.792 Test Loss: 0.543 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.778308629989624
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.518 Vali Acc: 0.763 Test Loss: 0.518 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.858368158340454
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.545 Vali Acc: 0.775 Test Loss: 0.545 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.8704757690429688
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.541 Vali Acc: 0.775 Test Loss: 0.541 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.8399527072906494
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.531 Vali Acc: 0.792 Test Loss: 0.531 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.004861831665039
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.563 Vali Acc: 0.769 Test Loss: 0.563 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 407287
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.670360088348389
Epoch: 1, Steps: 17 | Train Loss: 2.025 Vali Loss: 1.883 Vali Acc: 0.260 Test Loss: 1.883 Test Acc: 0.260
Validation loss decreased (inf --> -0.260097).  Saving model ...
Epoch: 2 cost time: 2.934171676635742
Epoch: 2, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.682 Vali Acc: 0.358 Test Loss: 1.682 Test Acc: 0.358
Validation loss decreased (-0.260097 --> -0.358365).  Saving model ...
Epoch: 3 cost time: 2.896597385406494
Epoch: 3, Steps: 17 | Train Loss: 1.584 Vali Loss: 1.506 Vali Acc: 0.347 Test Loss: 1.506 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.134587526321411
Epoch: 4, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.366 Vali Acc: 0.462 Test Loss: 1.366 Test Acc: 0.462
Validation loss decreased (-0.358365 --> -0.462414).  Saving model ...
Epoch: 5 cost time: 3.0571281909942627
Epoch: 5, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.233 Vali Acc: 0.538 Test Loss: 1.233 Test Acc: 0.538
Validation loss decreased (-0.462414 --> -0.537560).  Saving model ...
Epoch: 6 cost time: 2.970353126525879
Epoch: 6, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.158 Vali Acc: 0.543 Test Loss: 1.158 Test Acc: 0.543
Validation loss decreased (-0.537560 --> -0.543341).  Saving model ...
Epoch: 7 cost time: 3.0576975345611572
Epoch: 7, Steps: 17 | Train Loss: 0.913 Vali Loss: 1.011 Vali Acc: 0.671 Test Loss: 1.011 Test Acc: 0.671
Validation loss decreased (-0.543341 --> -0.670510).  Saving model ...
Epoch: 8 cost time: 2.994835376739502
Epoch: 8, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.925 Vali Acc: 0.647 Test Loss: 0.925 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.048395872116089
Epoch: 9, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.788 Vali Acc: 0.723 Test Loss: 0.788 Test Acc: 0.723
Validation loss decreased (-0.670510 --> -0.722535).  Saving model ...
Epoch: 10 cost time: 3.163803815841675
Epoch: 10, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.736 Vali Acc: 0.723 Test Loss: 0.736 Test Acc: 0.723
Validation loss decreased (-0.722535 --> -0.722536).  Saving model ...
Epoch: 11 cost time: 3.064648389816284
Epoch: 11, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.771 Vali Acc: 0.699 Test Loss: 0.771 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1917831897735596
Epoch: 12, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.640 Vali Acc: 0.775 Test Loss: 0.640 Test Acc: 0.775
Validation loss decreased (-0.722536 --> -0.774560).  Saving model ...
Epoch: 13 cost time: 2.9554433822631836
Epoch: 13, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.665 Vali Acc: 0.734 Test Loss: 0.665 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.034910202026367
Epoch: 14, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.567 Vali Acc: 0.780 Test Loss: 0.567 Test Acc: 0.780
Validation loss decreased (-0.774560 --> -0.780341).  Saving model ...
Epoch: 15 cost time: 2.801307439804077
Epoch: 15, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.615 Vali Acc: 0.792 Test Loss: 0.615 Test Acc: 0.792
Validation loss decreased (-0.780341 --> -0.791901).  Saving model ...
Epoch: 16 cost time: 2.875826835632324
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.608 Vali Acc: 0.769 Test Loss: 0.608 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8871450424194336
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.549 Vali Acc: 0.827 Test Loss: 0.549 Test Acc: 0.827
Validation loss decreased (-0.791901 --> -0.826584).  Saving model ...
Epoch: 18 cost time: 2.976355791091919
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.567 Vali Acc: 0.786 Test Loss: 0.567 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8140857219696045
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.602 Vali Acc: 0.798 Test Loss: 0.602 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7016727924346924
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.585 Vali Acc: 0.792 Test Loss: 0.585 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.78916597366333
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.619 Vali Acc: 0.792 Test Loss: 0.619 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.9114837646484375
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.627 Vali Acc: 0.798 Test Loss: 0.627 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.9614996910095215
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.638 Vali Acc: 0.798 Test Loss: 0.638 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.909233570098877
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.644 Vali Acc: 0.786 Test Loss: 0.644 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.909520387649536
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.792 Test Loss: 0.636 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.863344430923462
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.662 Vali Acc: 0.798 Test Loss: 0.662 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.9695377349853516
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.672 Vali Acc: 0.798 Test Loss: 0.672 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1235063
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.734577178955078
Epoch: 1, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.846 Vali Acc: 0.214 Test Loss: 1.846 Test Acc: 0.214
Validation loss decreased (inf --> -0.213854).  Saving model ...
Epoch: 2 cost time: 2.282386302947998
Epoch: 2, Steps: 17 | Train Loss: 1.753 Vali Loss: 1.675 Vali Acc: 0.272 Test Loss: 1.675 Test Acc: 0.272
Validation loss decreased (-0.213854 --> -0.271660).  Saving model ...
Epoch: 3 cost time: 2.339400291442871
Epoch: 3, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.495 Vali Acc: 0.410 Test Loss: 1.495 Test Acc: 0.410
Validation loss decreased (-0.271660 --> -0.410390).  Saving model ...
Epoch: 4 cost time: 2.341125965118408
Epoch: 4, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.336 Vali Acc: 0.486 Test Loss: 1.336 Test Acc: 0.486
Validation loss decreased (-0.410390 --> -0.485536).  Saving model ...
Epoch: 5 cost time: 2.3172080516815186
Epoch: 5, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.178 Vali Acc: 0.642 Test Loss: 1.178 Test Acc: 0.642
Validation loss decreased (-0.485536 --> -0.641607).  Saving model ...
Epoch: 6 cost time: 2.292090892791748
Epoch: 6, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.096 Vali Acc: 0.566 Test Loss: 1.096 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3108632564544678
Epoch: 7, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.977 Vali Acc: 0.647 Test Loss: 0.977 Test Acc: 0.647
Validation loss decreased (-0.641607 --> -0.647389).  Saving model ...
Epoch: 8 cost time: 2.3747785091400146
Epoch: 8, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.873 Vali Acc: 0.647 Test Loss: 0.873 Test Acc: 0.647
Validation loss decreased (-0.647389 --> -0.647390).  Saving model ...
Epoch: 9 cost time: 2.3782215118408203
Epoch: 9, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
Validation loss decreased (-0.647390 --> -0.774559).  Saving model ...
Epoch: 10 cost time: 2.30765700340271
Epoch: 10, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.689 Vali Acc: 0.757 Test Loss: 0.689 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3378138542175293
Epoch: 11, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.664 Vali Acc: 0.763 Test Loss: 0.664 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.29494571685791
Epoch: 12, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.642 Vali Acc: 0.740 Test Loss: 0.642 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3513023853302
Epoch: 13, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.594 Vali Acc: 0.757 Test Loss: 0.594 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3793511390686035
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.511 Vali Acc: 0.821 Test Loss: 0.511 Test Acc: 0.821
Validation loss decreased (-0.774559 --> -0.820804).  Saving model ...
Epoch: 15 cost time: 2.3625853061676025
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.500 Vali Acc: 0.815 Test Loss: 0.500 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2859630584716797
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.509 Vali Acc: 0.815 Test Loss: 0.509 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2815229892730713
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.503 Vali Acc: 0.775 Test Loss: 0.503 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.351198434829712
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.487 Vali Acc: 0.832 Test Loss: 0.487 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832365).  Saving model ...
Epoch: 19 cost time: 2.3664355278015137
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.534 Vali Acc: 0.792 Test Loss: 0.534 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3246593475341797
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.548 Vali Acc: 0.780 Test Loss: 0.548 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.327026844024658
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.542 Vali Acc: 0.786 Test Loss: 0.542 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3243794441223145
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.515 Vali Acc: 0.775 Test Loss: 0.515 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.2800028324127197
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.553 Vali Acc: 0.786 Test Loss: 0.553 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.314796209335327
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.538 Vali Acc: 0.786 Test Loss: 0.538 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.3263614177703857
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.526 Vali Acc: 0.786 Test Loss: 0.526 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.300264835357666
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.560 Vali Acc: 0.786 Test Loss: 0.560 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.3063318729400635
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.554 Vali Acc: 0.786 Test Loss: 0.554 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.3174941539764404
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.540 Vali Acc: 0.786 Test Loss: 0.540 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 407287
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.256426811218262
Epoch: 1, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.873 Vali Acc: 0.237 Test Loss: 1.873 Test Acc: 0.237
Validation loss decreased (inf --> -0.236975).  Saving model ...
Epoch: 2 cost time: 4.45042085647583
Epoch: 2, Steps: 17 | Train Loss: 1.774 Vali Loss: 1.706 Vali Acc: 0.283 Test Loss: 1.706 Test Acc: 0.283
Validation loss decreased (-0.236975 --> -0.283220).  Saving model ...
Epoch: 3 cost time: 4.625542402267456
Epoch: 3, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.484 Vali Acc: 0.428 Test Loss: 1.484 Test Acc: 0.428
Validation loss decreased (-0.283220 --> -0.427731).  Saving model ...
Epoch: 4 cost time: 4.6755805015563965
Epoch: 4, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.332 Vali Acc: 0.509 Test Loss: 1.332 Test Acc: 0.509
Validation loss decreased (-0.427731 --> -0.508657).  Saving model ...
Epoch: 5 cost time: 4.671071767807007
Epoch: 5, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.189 Vali Acc: 0.584 Test Loss: 1.189 Test Acc: 0.584
Validation loss decreased (-0.508657 --> -0.583803).  Saving model ...
Epoch: 6 cost time: 4.619449615478516
Epoch: 6, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.082 Vali Acc: 0.642 Test Loss: 1.082 Test Acc: 0.642
Validation loss decreased (-0.583803 --> -0.641608).  Saving model ...
Epoch: 7 cost time: 4.644643068313599
Epoch: 7, Steps: 17 | Train Loss: 0.826 Vali Loss: 0.991 Vali Acc: 0.665 Test Loss: 0.991 Test Acc: 0.665
Validation loss decreased (-0.641608 --> -0.664730).  Saving model ...
Epoch: 8 cost time: 4.652106523513794
Epoch: 8, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.858 Vali Acc: 0.671 Test Loss: 0.858 Test Acc: 0.671
Validation loss decreased (-0.664730 --> -0.670512).  Saving model ...
Epoch: 9 cost time: 4.682215929031372
Epoch: 9, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.757 Vali Acc: 0.746 Test Loss: 0.757 Test Acc: 0.746
Validation loss decreased (-0.670512 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 4.411397695541382
Epoch: 10, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.710 Vali Acc: 0.751 Test Loss: 0.710 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751438).  Saving model ...
Epoch: 11 cost time: 4.863786220550537
Epoch: 11, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.586 Vali Acc: 0.792 Test Loss: 0.586 Test Acc: 0.792
Validation loss decreased (-0.751438 --> -0.791902).  Saving model ...
Epoch: 12 cost time: 4.727938413619995
Epoch: 12, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.554 Vali Acc: 0.786 Test Loss: 0.554 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.726508378982544
Epoch: 13, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.509 Vali Acc: 0.798 Test Loss: 0.509 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797683).  Saving model ...
Epoch: 14 cost time: 4.488386631011963
Epoch: 14, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.544 Vali Acc: 0.763 Test Loss: 0.544 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9739110469818115
Epoch: 15, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.551 Vali Acc: 0.751 Test Loss: 0.551 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.348145008087158
Epoch: 16, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.435 Vali Acc: 0.821 Test Loss: 0.435 Test Acc: 0.821
Validation loss decreased (-0.797683 --> -0.820805).  Saving model ...
Epoch: 17 cost time: 4.209872007369995
Epoch: 17, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.440 Vali Acc: 0.809 Test Loss: 0.440 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.28593635559082
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.508 Vali Acc: 0.798 Test Loss: 0.508 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.1699817180633545
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.506 Vali Acc: 0.798 Test Loss: 0.506 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.6164348125457764
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.482 Vali Acc: 0.815 Test Loss: 0.482 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.425309896469116
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.496 Vali Acc: 0.792 Test Loss: 0.496 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.299830675125122
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.494 Vali Acc: 0.798 Test Loss: 0.494 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.497682571411133
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.533 Vali Acc: 0.792 Test Loss: 0.533 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.404531478881836
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.522 Vali Acc: 0.792 Test Loss: 0.522 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.302923917770386
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.771162271499634
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.555 Vali Acc: 0.798 Test Loss: 0.555 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 648951
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.025068759918213
Epoch: 1, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.884 Vali Acc: 0.283 Test Loss: 1.884 Test Acc: 0.283
Validation loss decreased (inf --> -0.283218).  Saving model ...
Epoch: 2 cost time: 3.255035638809204
Epoch: 2, Steps: 17 | Train Loss: 1.831 Vali Loss: 1.737 Vali Acc: 0.370 Test Loss: 1.737 Test Acc: 0.370
Validation loss decreased (-0.283218 --> -0.369925).  Saving model ...
Epoch: 3 cost time: 3.344048023223877
Epoch: 3, Steps: 17 | Train Loss: 1.620 Vali Loss: 1.550 Vali Acc: 0.428 Test Loss: 1.550 Test Acc: 0.428
Validation loss decreased (-0.369925 --> -0.427730).  Saving model ...
Epoch: 4 cost time: 3.307516574859619
Epoch: 4, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.388 Vali Acc: 0.549 Test Loss: 1.388 Test Acc: 0.549
Validation loss decreased (-0.427730 --> -0.549119).  Saving model ...
Epoch: 5 cost time: 3.318253993988037
Epoch: 5, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.270 Vali Acc: 0.543 Test Loss: 1.270 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2458043098449707
Epoch: 6, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.126 Vali Acc: 0.647 Test Loss: 1.126 Test Acc: 0.647
Validation loss decreased (-0.549119 --> -0.647388).  Saving model ...
Epoch: 7 cost time: 3.417088747024536
Epoch: 7, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.006 Vali Acc: 0.688 Test Loss: 1.006 Test Acc: 0.688
Validation loss decreased (-0.647388 --> -0.687851).  Saving model ...
Epoch: 8 cost time: 3.1882734298706055
Epoch: 8, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.891 Vali Acc: 0.694 Test Loss: 0.891 Test Acc: 0.694
Validation loss decreased (-0.687851 --> -0.693633).  Saving model ...
Epoch: 9 cost time: 3.3879764080047607
Epoch: 9, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.814 Vali Acc: 0.746 Test Loss: 0.814 Test Acc: 0.746
Validation loss decreased (-0.693633 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 3.325561761856079
Epoch: 10, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.698 Vali Acc: 0.798 Test Loss: 0.698 Test Acc: 0.798
Validation loss decreased (-0.745657 --> -0.797681).  Saving model ...
Epoch: 11 cost time: 3.2314631938934326
Epoch: 11, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.622 Vali Acc: 0.838 Test Loss: 0.622 Test Acc: 0.838
Validation loss decreased (-0.797681 --> -0.838144).  Saving model ...
Epoch: 12 cost time: 3.115140438079834
Epoch: 12, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.618 Vali Acc: 0.769 Test Loss: 0.618 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.286285161972046
Epoch: 13, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.544 Vali Acc: 0.815 Test Loss: 0.544 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.258933067321777
Epoch: 14, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.508 Vali Acc: 0.832 Test Loss: 0.508 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.144926309585571
Epoch: 15, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
Validation loss decreased (-0.838144 --> -0.849706).  Saving model ...
Epoch: 16 cost time: 4.026561737060547
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.537 Vali Acc: 0.798 Test Loss: 0.537 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.2956767082214355
Epoch: 17, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.199860095977783
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.539 Vali Acc: 0.827 Test Loss: 0.539 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.9910407066345215
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.512 Vali Acc: 0.832 Test Loss: 0.512 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.4351775646209717
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.262497425079346
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.590 Vali Acc: 0.780 Test Loss: 0.590 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.197034120559692
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.578 Vali Acc: 0.775 Test Loss: 0.578 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.081773281097412
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.4893875122070312
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.564 Vali Acc: 0.821 Test Loss: 0.564 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.200065612792969
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.578 Vali Acc: 0.832 Test Loss: 0.578 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 234999
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.447772026062012
Epoch: 1, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.873 Vali Acc: 0.237 Test Loss: 1.873 Test Acc: 0.237
Validation loss decreased (inf --> -0.236975).  Saving model ...
Epoch: 2 cost time: 4.73200535774231
Epoch: 2, Steps: 17 | Train Loss: 1.774 Vali Loss: 1.706 Vali Acc: 0.283 Test Loss: 1.706 Test Acc: 0.283
Validation loss decreased (-0.236975 --> -0.283220).  Saving model ...
Epoch: 3 cost time: 4.56395697593689
Epoch: 3, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.484 Vali Acc: 0.428 Test Loss: 1.484 Test Acc: 0.428
Validation loss decreased (-0.283220 --> -0.427731).  Saving model ...
Epoch: 4 cost time: 3.9184534549713135
Epoch: 4, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.332 Vali Acc: 0.509 Test Loss: 1.332 Test Acc: 0.509
Validation loss decreased (-0.427731 --> -0.508657).  Saving model ...
Epoch: 5 cost time: 4.739109039306641
Epoch: 5, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.189 Vali Acc: 0.584 Test Loss: 1.189 Test Acc: 0.584
Validation loss decreased (-0.508657 --> -0.583803).  Saving model ...
Epoch: 6 cost time: 4.5892109870910645
Epoch: 6, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.082 Vali Acc: 0.642 Test Loss: 1.082 Test Acc: 0.642
Validation loss decreased (-0.583803 --> -0.641608).  Saving model ...
Epoch: 7 cost time: 4.57785964012146
Epoch: 7, Steps: 17 | Train Loss: 0.826 Vali Loss: 0.991 Vali Acc: 0.665 Test Loss: 0.991 Test Acc: 0.665
Validation loss decreased (-0.641608 --> -0.664730).  Saving model ...
Epoch: 8 cost time: 4.829082727432251
Epoch: 8, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.858 Vali Acc: 0.671 Test Loss: 0.858 Test Acc: 0.671
Validation loss decreased (-0.664730 --> -0.670512).  Saving model ...
Epoch: 9 cost time: 4.8252575397491455
Epoch: 9, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.757 Vali Acc: 0.746 Test Loss: 0.757 Test Acc: 0.746
Validation loss decreased (-0.670512 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 4.276308059692383
Epoch: 10, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.710 Vali Acc: 0.751 Test Loss: 0.710 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751438).  Saving model ...
Epoch: 11 cost time: 4.497201681137085
Epoch: 11, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.586 Vali Acc: 0.780 Test Loss: 0.586 Test Acc: 0.780
Validation loss decreased (-0.751438 --> -0.780341).  Saving model ...
Epoch: 12 cost time: 4.84750771522522
Epoch: 12, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.553 Vali Acc: 0.775 Test Loss: 0.553 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.8397440910339355
Epoch: 13, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.528 Vali Acc: 0.798 Test Loss: 0.528 Test Acc: 0.798
Validation loss decreased (-0.780341 --> -0.797683).  Saving model ...
Epoch: 14 cost time: 4.527217626571655
Epoch: 14, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
Validation loss decreased (-0.797683 --> -0.809243).  Saving model ...
Epoch: 15 cost time: 3.105982780456543
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.534 Vali Acc: 0.757 Test Loss: 0.534 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.501863718032837
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.451 Vali Acc: 0.827 Test Loss: 0.451 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826585).  Saving model ...
Epoch: 17 cost time: 4.373617649078369
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.438 Vali Acc: 0.827 Test Loss: 0.438 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 18 cost time: 4.190423011779785
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.453557014465332
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.455 Vali Acc: 0.809 Test Loss: 0.455 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.457104206085205
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.472 Vali Acc: 0.821 Test Loss: 0.472 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.238110542297363
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.479 Vali Acc: 0.821 Test Loss: 0.479 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.9194400310516357
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.514 Vali Acc: 0.798 Test Loss: 0.514 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.504207611083984
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.2153096199035645
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.499 Vali Acc: 0.821 Test Loss: 0.499 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.481260776519775
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.500 Vali Acc: 0.821 Test Loss: 0.500 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.478573322296143
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.573 Vali Acc: 0.803 Test Loss: 0.573 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.530756711959839
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 648951
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.171390533447266
Epoch: 1, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.884 Vali Acc: 0.283 Test Loss: 1.884 Test Acc: 0.283
Validation loss decreased (inf --> -0.283218).  Saving model ...
Epoch: 2 cost time: 3.244649648666382
Epoch: 2, Steps: 17 | Train Loss: 1.831 Vali Loss: 1.737 Vali Acc: 0.370 Test Loss: 1.737 Test Acc: 0.370
Validation loss decreased (-0.283218 --> -0.369925).  Saving model ...
Epoch: 3 cost time: 3.2933125495910645
Epoch: 3, Steps: 17 | Train Loss: 1.620 Vali Loss: 1.550 Vali Acc: 0.428 Test Loss: 1.550 Test Acc: 0.428
Validation loss decreased (-0.369925 --> -0.427730).  Saving model ...
Epoch: 4 cost time: 3.425732374191284
Epoch: 4, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.388 Vali Acc: 0.549 Test Loss: 1.388 Test Acc: 0.549
Validation loss decreased (-0.427730 --> -0.549119).  Saving model ...
Epoch: 5 cost time: 3.3853230476379395
Epoch: 5, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.270 Vali Acc: 0.543 Test Loss: 1.270 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2264976501464844
Epoch: 6, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.126 Vali Acc: 0.647 Test Loss: 1.126 Test Acc: 0.647
Validation loss decreased (-0.549119 --> -0.647388).  Saving model ...
Epoch: 7 cost time: 3.35219669342041
Epoch: 7, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.006 Vali Acc: 0.688 Test Loss: 1.006 Test Acc: 0.688
Validation loss decreased (-0.647388 --> -0.687851).  Saving model ...
Epoch: 8 cost time: 2.843960762023926
Epoch: 8, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.891 Vali Acc: 0.694 Test Loss: 0.891 Test Acc: 0.694
Validation loss decreased (-0.687851 --> -0.693633).  Saving model ...
Epoch: 9 cost time: 3.4226205348968506
Epoch: 9, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.814 Vali Acc: 0.746 Test Loss: 0.814 Test Acc: 0.746
Validation loss decreased (-0.693633 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 3.463829517364502
Epoch: 10, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.698 Vali Acc: 0.798 Test Loss: 0.698 Test Acc: 0.798
Validation loss decreased (-0.745657 --> -0.797681).  Saving model ...
Epoch: 11 cost time: 3.244215965270996
Epoch: 11, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.622 Vali Acc: 0.838 Test Loss: 0.622 Test Acc: 0.838
Validation loss decreased (-0.797681 --> -0.838144).  Saving model ...
Epoch: 12 cost time: 3.2456917762756348
Epoch: 12, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.618 Vali Acc: 0.775 Test Loss: 0.618 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4882216453552246
Epoch: 13, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.544 Vali Acc: 0.815 Test Loss: 0.544 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.439110040664673
Epoch: 14, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.537 Vali Acc: 0.815 Test Loss: 0.537 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.407066822052002
Epoch: 15, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.520 Vali Acc: 0.821 Test Loss: 0.520 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.230522394180298
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.478 Vali Acc: 0.832 Test Loss: 0.478 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.9717578887939453
Epoch: 17, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.473 Vali Acc: 0.867 Test Loss: 0.473 Test Acc: 0.867
Validation loss decreased (-0.838144 --> -0.867047).  Saving model ...
Epoch: 18 cost time: 3.4277474880218506
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4475340843200684
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.318490743637085
Epoch: 20, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.3372910022735596
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.524 Vali Acc: 0.815 Test Loss: 0.524 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.489616632461548
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.638 Vali Acc: 0.751 Test Loss: 0.638 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.409334659576416
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.365151882171631
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.4802780151367188
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.548 Vali Acc: 0.838 Test Loss: 0.548 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.516818046569824
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.658 Vali Acc: 0.809 Test Loss: 0.658 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.4899253845214844
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.647 Vali Acc: 0.821 Test Loss: 0.647 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 234999
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.886631488800049
Epoch: 1, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.873 Vali Acc: 0.237 Test Loss: 1.873 Test Acc: 0.237
Validation loss decreased (inf --> -0.236975).  Saving model ...
Epoch: 2 cost time: 3.8800196647644043
Epoch: 2, Steps: 17 | Train Loss: 1.774 Vali Loss: 1.706 Vali Acc: 0.283 Test Loss: 1.706 Test Acc: 0.283
Validation loss decreased (-0.236975 --> -0.283220).  Saving model ...
Epoch: 3 cost time: 3.7554848194122314
Epoch: 3, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.484 Vali Acc: 0.428 Test Loss: 1.484 Test Acc: 0.428
Validation loss decreased (-0.283220 --> -0.427731).  Saving model ...
Epoch: 4 cost time: 3.963308572769165
Epoch: 4, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.332 Vali Acc: 0.509 Test Loss: 1.332 Test Acc: 0.509
Validation loss decreased (-0.427731 --> -0.508657).  Saving model ...
Epoch: 5 cost time: 3.7908334732055664
Epoch: 5, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.189 Vali Acc: 0.584 Test Loss: 1.189 Test Acc: 0.584
Validation loss decreased (-0.508657 --> -0.583803).  Saving model ...
Epoch: 6 cost time: 3.698906660079956
Epoch: 6, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.082 Vali Acc: 0.642 Test Loss: 1.082 Test Acc: 0.642
Validation loss decreased (-0.583803 --> -0.641608).  Saving model ...
Epoch: 7 cost time: 3.748750925064087
Epoch: 7, Steps: 17 | Train Loss: 0.826 Vali Loss: 0.991 Vali Acc: 0.665 Test Loss: 0.991 Test Acc: 0.665
Validation loss decreased (-0.641608 --> -0.664730).  Saving model ...
Epoch: 8 cost time: 3.8826310634613037
Epoch: 8, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.858 Vali Acc: 0.671 Test Loss: 0.858 Test Acc: 0.671
Validation loss decreased (-0.664730 --> -0.670512).  Saving model ...
Epoch: 9 cost time: 3.8086390495300293
Epoch: 9, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.757 Vali Acc: 0.746 Test Loss: 0.757 Test Acc: 0.746
Validation loss decreased (-0.670512 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 3.608318567276001
Epoch: 10, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.709 Vali Acc: 0.751 Test Loss: 0.709 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751438).  Saving model ...
Epoch: 11 cost time: 3.7191717624664307
Epoch: 11, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.590 Vali Acc: 0.792 Test Loss: 0.590 Test Acc: 0.792
Validation loss decreased (-0.751438 --> -0.791902).  Saving model ...
Epoch: 12 cost time: 3.913543462753296
Epoch: 12, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.560 Vali Acc: 0.786 Test Loss: 0.560 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.842252016067505
Epoch: 13, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.509 Vali Acc: 0.798 Test Loss: 0.509 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797683).  Saving model ...
Epoch: 14 cost time: 3.7087924480438232
Epoch: 14, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
Validation loss decreased (-0.797683 --> -0.803463).  Saving model ...
Epoch: 15 cost time: 3.687122344970703
Epoch: 15, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 16 cost time: 3.848849296569824
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.460 Vali Acc: 0.798 Test Loss: 0.460 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.8019347190856934
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.440 Vali Acc: 0.809 Test Loss: 0.440 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809244).  Saving model ...
Epoch: 18 cost time: 3.451256036758423
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.493 Vali Acc: 0.786 Test Loss: 0.493 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.990356683731079
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.463 Vali Acc: 0.809 Test Loss: 0.463 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.9023067951202393
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.470 Vali Acc: 0.821 Test Loss: 0.470 Test Acc: 0.821
Validation loss decreased (-0.809244 --> -0.820805).  Saving model ...
Epoch: 21 cost time: 3.79750394821167
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.554776668548584
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.506 Vali Acc: 0.798 Test Loss: 0.506 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0532398223876953
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.510 Vali Acc: 0.792 Test Loss: 0.510 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.4266185760498047
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.646563768386841
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.3699352741241455
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.792 Test Loss: 0.562 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.1696503162384033
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.504 Vali Acc: 0.792 Test Loss: 0.504 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.555109977722168
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.509 Vali Acc: 0.792 Test Loss: 0.509 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.4742424488067627
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.556 Vali Acc: 0.792 Test Loss: 0.556 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.334031343460083
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.553 Vali Acc: 0.792 Test Loss: 0.553 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 648951
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.535155534744263
Epoch: 1, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.884 Vali Acc: 0.283 Test Loss: 1.884 Test Acc: 0.283
Validation loss decreased (inf --> -0.283218).  Saving model ...
Epoch: 2 cost time: 2.7948758602142334
Epoch: 2, Steps: 17 | Train Loss: 1.831 Vali Loss: 1.737 Vali Acc: 0.370 Test Loss: 1.737 Test Acc: 0.370
Validation loss decreased (-0.283218 --> -0.369925).  Saving model ...
Epoch: 3 cost time: 2.8615541458129883
Epoch: 3, Steps: 17 | Train Loss: 1.620 Vali Loss: 1.550 Vali Acc: 0.428 Test Loss: 1.550 Test Acc: 0.428
Validation loss decreased (-0.369925 --> -0.427730).  Saving model ...
Epoch: 4 cost time: 2.654507637023926
Epoch: 4, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.388 Vali Acc: 0.549 Test Loss: 1.388 Test Acc: 0.549
Validation loss decreased (-0.427730 --> -0.549119).  Saving model ...
Epoch: 5 cost time: 2.7706782817840576
Epoch: 5, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.270 Vali Acc: 0.543 Test Loss: 1.270 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1541240215301514
Epoch: 6, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.126 Vali Acc: 0.647 Test Loss: 1.126 Test Acc: 0.647
Validation loss decreased (-0.549119 --> -0.647388).  Saving model ...
Epoch: 7 cost time: 2.85923171043396
Epoch: 7, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.006 Vali Acc: 0.688 Test Loss: 1.006 Test Acc: 0.688
Validation loss decreased (-0.647388 --> -0.687851).  Saving model ...
Epoch: 8 cost time: 3.06498122215271
Epoch: 8, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.891 Vali Acc: 0.694 Test Loss: 0.891 Test Acc: 0.694
Validation loss decreased (-0.687851 --> -0.693633).  Saving model ...
Epoch: 9 cost time: 2.9235057830810547
Epoch: 9, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.814 Vali Acc: 0.746 Test Loss: 0.814 Test Acc: 0.746
Validation loss decreased (-0.693633 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 2.9725265502929688
Epoch: 10, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.699 Vali Acc: 0.798 Test Loss: 0.699 Test Acc: 0.798
Validation loss decreased (-0.745657 --> -0.797681).  Saving model ...
Epoch: 11 cost time: 2.986032724380493
Epoch: 11, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.622 Vali Acc: 0.838 Test Loss: 0.622 Test Acc: 0.838
Validation loss decreased (-0.797681 --> -0.838144).  Saving model ...
Epoch: 12 cost time: 2.310818910598755
Epoch: 12, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.635 Vali Acc: 0.769 Test Loss: 0.635 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.267514228820801
Epoch: 13, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.557 Vali Acc: 0.815 Test Loss: 0.557 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4082865715026855
Epoch: 14, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.509 Vali Acc: 0.815 Test Loss: 0.509 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.676314353942871
Epoch: 15, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
Validation loss decreased (-0.838144 --> -0.843926).  Saving model ...
Epoch: 16 cost time: 2.7866766452789307
Epoch: 16, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.496 Vali Acc: 0.821 Test Loss: 0.496 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6931142807006836
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.457 Vali Acc: 0.855 Test Loss: 0.457 Test Acc: 0.855
Validation loss decreased (-0.843926 --> -0.855487).  Saving model ...
Epoch: 18 cost time: 2.9247405529022217
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6409428119659424
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9364430904388428
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.459 Vali Acc: 0.827 Test Loss: 0.459 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.6936733722686768
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.9576683044433594
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.7813594341278076
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861267).  Saving model ...
Epoch: 24 cost time: 2.8144819736480713
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.506 Vali Acc: 0.832 Test Loss: 0.506 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.575666666030884
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.7309107780456543
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.7789998054504395
Epoch: 27, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.519 Vali Acc: 0.821 Test Loss: 0.519 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.735635995864868
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.509 Vali Acc: 0.832 Test Loss: 0.509 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.9148831367492676
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.693140983581543
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 234999
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.79590106010437
Epoch: 1, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.953 Vali Acc: 0.208 Test Loss: 1.953 Test Acc: 0.208
Validation loss decreased (inf --> -0.208073).  Saving model ...
Epoch: 2 cost time: 6.928736925125122
Epoch: 2, Steps: 17 | Train Loss: 1.852 Vali Loss: 1.836 Vali Acc: 0.289 Test Loss: 1.836 Test Acc: 0.289
Validation loss decreased (-0.208073 --> -0.288999).  Saving model ...
Epoch: 3 cost time: 6.793317079544067
Epoch: 3, Steps: 17 | Train Loss: 1.735 Vali Loss: 1.716 Vali Acc: 0.341 Test Loss: 1.716 Test Acc: 0.341
Validation loss decreased (-0.288999 --> -0.341023).  Saving model ...
Epoch: 4 cost time: 6.845073461532593
Epoch: 4, Steps: 17 | Train Loss: 1.587 Vali Loss: 1.570 Vali Acc: 0.393 Test Loss: 1.570 Test Acc: 0.393
Validation loss decreased (-0.341023 --> -0.393048).  Saving model ...
Epoch: 5 cost time: 6.931614875793457
Epoch: 5, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.416 Vali Acc: 0.451 Test Loss: 1.416 Test Acc: 0.451
Validation loss decreased (-0.393048 --> -0.450853).  Saving model ...
Epoch: 6 cost time: 6.439418315887451
Epoch: 6, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.283 Vali Acc: 0.543 Test Loss: 1.283 Test Acc: 0.543
Validation loss decreased (-0.450853 --> -0.543340).  Saving model ...
Epoch: 7 cost time: 6.44728422164917
Epoch: 7, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.192 Vali Acc: 0.520 Test Loss: 1.192 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.4642932415008545
Epoch: 8, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.039 Vali Acc: 0.682 Test Loss: 1.039 Test Acc: 0.682
Validation loss decreased (-0.543340 --> -0.682071).  Saving model ...
Epoch: 9 cost time: 6.424476146697998
Epoch: 9, Steps: 17 | Train Loss: 0.791 Vali Loss: 1.004 Vali Acc: 0.665 Test Loss: 1.004 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.454224109649658
Epoch: 10, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.879 Vali Acc: 0.723 Test Loss: 0.879 Test Acc: 0.723
Validation loss decreased (-0.682071 --> -0.722535).  Saving model ...
Epoch: 11 cost time: 6.3736560344696045
Epoch: 11, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.800 Vali Acc: 0.705 Test Loss: 0.800 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.315800189971924
Epoch: 12, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.917 Vali Acc: 0.624 Test Loss: 0.917 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.393551826477051
Epoch: 13, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.823 Vali Acc: 0.694 Test Loss: 0.823 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.403771162033081
Epoch: 14, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.766 Vali Acc: 0.711 Test Loss: 0.766 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.391149282455444
Epoch: 15, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.599 Vali Acc: 0.769 Test Loss: 0.599 Test Acc: 0.769
Validation loss decreased (-0.722535 --> -0.768780).  Saving model ...
Epoch: 16 cost time: 6.321588754653931
Epoch: 16, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.628 Vali Acc: 0.786 Test Loss: 0.628 Test Acc: 0.786
Validation loss decreased (-0.768780 --> -0.786121).  Saving model ...
Epoch: 17 cost time: 6.418434381484985
Epoch: 17, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.735 Vali Acc: 0.792 Test Loss: 0.735 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791900).  Saving model ...
Epoch: 18 cost time: 6.479326248168945
Epoch: 18, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.746 Vali Acc: 0.740 Test Loss: 0.746 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.498429536819458
Epoch: 19, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.606 Vali Acc: 0.792 Test Loss: 0.606 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791901).  Saving model ...
Epoch: 20 cost time: 6.493387460708618
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.921 Vali Acc: 0.694 Test Loss: 0.921 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.770131826400757
Epoch: 21, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803463).  Saving model ...
Epoch: 22 cost time: 4.96882176399231
Epoch: 22, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.617 Vali Acc: 0.815 Test Loss: 0.617 Test Acc: 0.815
Validation loss decreased (-0.803463 --> -0.815023).  Saving model ...
Epoch: 23 cost time: 6.770721197128296
Epoch: 23, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.399606943130493
Epoch: 24, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.779709100723267
Epoch: 25, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.806 Vali Acc: 0.734 Test Loss: 0.806 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.2631402015686035
Epoch: 26, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.695 Vali Acc: 0.809 Test Loss: 0.695 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.731919765472412
Epoch: 27, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.739 Vali Acc: 0.792 Test Loss: 0.739 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.507224798202515
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.719 Vali Acc: 0.780 Test Loss: 0.719 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.146249532699585
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.708 Vali Acc: 0.792 Test Loss: 0.708 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.519028425216675
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.644 Vali Acc: 0.827 Test Loss: 0.644 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826583).  Saving model ...
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1204415
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.085591554641724
Epoch: 1, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.982 Vali Acc: 0.145 Test Loss: 1.982 Test Acc: 0.145
Validation loss decreased (inf --> -0.144489).  Saving model ...
Epoch: 2 cost time: 4.7711098194122314
Epoch: 2, Steps: 17 | Train Loss: 1.888 Vali Loss: 1.852 Vali Acc: 0.266 Test Loss: 1.852 Test Acc: 0.266
Validation loss decreased (-0.144489 --> -0.265877).  Saving model ...
Epoch: 3 cost time: 4.491856575012207
Epoch: 3, Steps: 17 | Train Loss: 1.745 Vali Loss: 1.709 Vali Acc: 0.289 Test Loss: 1.709 Test Acc: 0.289
Validation loss decreased (-0.265877 --> -0.289000).  Saving model ...
Epoch: 4 cost time: 4.540941476821899
Epoch: 4, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.544 Vali Acc: 0.353 Test Loss: 1.544 Test Acc: 0.353
Validation loss decreased (-0.289000 --> -0.352586).  Saving model ...
Epoch: 5 cost time: 4.698591709136963
Epoch: 5, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.402 Vali Acc: 0.439 Test Loss: 1.402 Test Acc: 0.439
Validation loss decreased (-0.352586 --> -0.439292).  Saving model ...
Epoch: 6 cost time: 4.490005016326904
Epoch: 6, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.308 Vali Acc: 0.538 Test Loss: 1.308 Test Acc: 0.538
Validation loss decreased (-0.439292 --> -0.537559).  Saving model ...
Epoch: 7 cost time: 4.8881378173828125
Epoch: 7, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.199 Vali Acc: 0.578 Test Loss: 1.199 Test Acc: 0.578
Validation loss decreased (-0.537559 --> -0.578023).  Saving model ...
Epoch: 8 cost time: 4.6760547161102295
Epoch: 8, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.146 Vali Acc: 0.572 Test Loss: 1.146 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.635931491851807
Epoch: 9, Steps: 17 | Train Loss: 0.872 Vali Loss: 1.012 Vali Acc: 0.694 Test Loss: 1.012 Test Acc: 0.694
Validation loss decreased (-0.578023 --> -0.693631).  Saving model ...
Epoch: 10 cost time: 4.8713977336883545
Epoch: 10, Steps: 17 | Train Loss: 0.751 Vali Loss: 0.966 Vali Acc: 0.642 Test Loss: 0.966 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.647617816925049
Epoch: 11, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.911 Vali Acc: 0.671 Test Loss: 0.911 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.3813066482543945
Epoch: 12, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.821 Vali Acc: 0.688 Test Loss: 0.821 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.794944524765015
Epoch: 13, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.828 Vali Acc: 0.694 Test Loss: 0.828 Test Acc: 0.694
Validation loss decreased (-0.693631 --> -0.693633).  Saving model ...
Epoch: 14 cost time: 4.588690757751465
Epoch: 14, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.749 Vali Acc: 0.746 Test Loss: 0.749 Test Acc: 0.746
Validation loss decreased (-0.693633 --> -0.745657).  Saving model ...
Epoch: 15 cost time: 4.565300941467285
Epoch: 15, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.696 Vali Acc: 0.746 Test Loss: 0.696 Test Acc: 0.746
Validation loss decreased (-0.745657 --> -0.745658).  Saving model ...
Epoch: 16 cost time: 4.779858112335205
Epoch: 16, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.765 Vali Acc: 0.705 Test Loss: 0.765 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.580552339553833
Epoch: 17, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.676 Vali Acc: 0.717 Test Loss: 0.676 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.80922269821167
Epoch: 18, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.664 Vali Acc: 0.740 Test Loss: 0.664 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.63606071472168
Epoch: 19, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.683 Vali Acc: 0.786 Test Loss: 0.683 Test Acc: 0.786
Validation loss decreased (-0.745658 --> -0.786120).  Saving model ...
Epoch: 20 cost time: 4.664107322692871
Epoch: 20, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.600 Vali Acc: 0.798 Test Loss: 0.600 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797682).  Saving model ...
Epoch: 21 cost time: 4.894933223724365
Epoch: 21, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.642 Vali Acc: 0.740 Test Loss: 0.642 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.7214860916137695
Epoch: 22, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.584 Vali Acc: 0.786 Test Loss: 0.584 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.61491060256958
Epoch: 23, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.715 Vali Acc: 0.694 Test Loss: 0.715 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.926741361618042
Epoch: 24, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.673 Vali Acc: 0.757 Test Loss: 0.673 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.647711277008057
Epoch: 25, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.863 Vali Acc: 0.728 Test Loss: 0.863 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.805496692657471
Epoch: 26, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.711 Vali Acc: 0.746 Test Loss: 0.711 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.762304306030273
Epoch: 27, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.811 Vali Acc: 0.728 Test Loss: 0.811 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.576779842376709
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.791 Vali Acc: 0.728 Test Loss: 0.791 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.719725847244263
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.790 Vali Acc: 0.769 Test Loss: 0.790 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.604703426361084
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.709 Vali Acc: 0.769 Test Loss: 0.709 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 376447
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.701718807220459
Epoch: 1, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.953 Vali Acc: 0.208 Test Loss: 1.953 Test Acc: 0.208
Validation loss decreased (inf --> -0.208073).  Saving model ...
Epoch: 2 cost time: 5.943006992340088
Epoch: 2, Steps: 17 | Train Loss: 1.852 Vali Loss: 1.836 Vali Acc: 0.289 Test Loss: 1.836 Test Acc: 0.289
Validation loss decreased (-0.208073 --> -0.288999).  Saving model ...
Epoch: 3 cost time: 5.365304708480835
Epoch: 3, Steps: 17 | Train Loss: 1.735 Vali Loss: 1.716 Vali Acc: 0.341 Test Loss: 1.716 Test Acc: 0.341
Validation loss decreased (-0.288999 --> -0.341023).  Saving model ...
Epoch: 4 cost time: 6.32650899887085
Epoch: 4, Steps: 17 | Train Loss: 1.587 Vali Loss: 1.570 Vali Acc: 0.393 Test Loss: 1.570 Test Acc: 0.393
Validation loss decreased (-0.341023 --> -0.393048).  Saving model ...
Epoch: 5 cost time: 5.788387775421143
Epoch: 5, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.416 Vali Acc: 0.451 Test Loss: 1.416 Test Acc: 0.451
Validation loss decreased (-0.393048 --> -0.450853).  Saving model ...
Epoch: 6 cost time: 5.089431047439575
Epoch: 6, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.283 Vali Acc: 0.543 Test Loss: 1.283 Test Acc: 0.543
Validation loss decreased (-0.450853 --> -0.543340).  Saving model ...
Epoch: 7 cost time: 5.973512887954712
Epoch: 7, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.192 Vali Acc: 0.520 Test Loss: 1.192 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.300777435302734
Epoch: 8, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.039 Vali Acc: 0.682 Test Loss: 1.039 Test Acc: 0.682
Validation loss decreased (-0.543340 --> -0.682071).  Saving model ...
Epoch: 9 cost time: 5.792150497436523
Epoch: 9, Steps: 17 | Train Loss: 0.791 Vali Loss: 1.004 Vali Acc: 0.665 Test Loss: 1.004 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.511279582977295
Epoch: 10, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.879 Vali Acc: 0.723 Test Loss: 0.879 Test Acc: 0.723
Validation loss decreased (-0.682071 --> -0.722535).  Saving model ...
Epoch: 11 cost time: 5.5200090408325195
Epoch: 11, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.798 Vali Acc: 0.705 Test Loss: 0.798 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.692592144012451
Epoch: 12, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.906 Vali Acc: 0.624 Test Loss: 0.906 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.549423456192017
Epoch: 13, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.846 Vali Acc: 0.688 Test Loss: 0.846 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.4188737869262695
Epoch: 14, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.829 Vali Acc: 0.682 Test Loss: 0.829 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.097792863845825
Epoch: 15, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.612 Vali Acc: 0.786 Test Loss: 0.612 Test Acc: 0.786
Validation loss decreased (-0.722535 --> -0.786121).  Saving model ...
Epoch: 16 cost time: 5.588956356048584
Epoch: 16, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.605 Vali Acc: 0.798 Test Loss: 0.605 Test Acc: 0.798
Validation loss decreased (-0.786121 --> -0.797682).  Saving model ...
Epoch: 17 cost time: 5.07452654838562
Epoch: 17, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.725 Vali Acc: 0.775 Test Loss: 0.725 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.639190196990967
Epoch: 18, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.718 Vali Acc: 0.763 Test Loss: 0.718 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.388811349868774
Epoch: 19, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.649 Vali Acc: 0.786 Test Loss: 0.649 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.303316593170166
Epoch: 20, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.73368501663208
Epoch: 21, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.603 Vali Acc: 0.780 Test Loss: 0.603 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.392102956771851
Epoch: 22, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.533 Vali Acc: 0.832 Test Loss: 0.533 Test Acc: 0.832
Validation loss decreased (-0.797682 --> -0.832365).  Saving model ...
Epoch: 23 cost time: 5.683168649673462
Epoch: 23, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.506 Vali Acc: 0.821 Test Loss: 0.506 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.049091577529907
Epoch: 24, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.574 Vali Acc: 0.780 Test Loss: 0.574 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.928394556045532
Epoch: 25, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.826 Vali Acc: 0.751 Test Loss: 0.826 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.475870609283447
Epoch: 26, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.621 Vali Acc: 0.798 Test Loss: 0.621 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.838267087936401
Epoch: 27, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.634 Vali Acc: 0.786 Test Loss: 0.634 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.95336127281189
Epoch: 28, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.626 Vali Acc: 0.827 Test Loss: 0.626 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.533668041229248
Epoch: 29, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.784 Vali Acc: 0.746 Test Loss: 0.784 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.964604139328003
Epoch: 30, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.616 Vali Acc: 0.827 Test Loss: 0.616 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1204415
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.884264707565308
Epoch: 1, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.982 Vali Acc: 0.145 Test Loss: 1.982 Test Acc: 0.145
Validation loss decreased (inf --> -0.144489).  Saving model ...
Epoch: 2 cost time: 3.377628803253174
Epoch: 2, Steps: 17 | Train Loss: 1.888 Vali Loss: 1.852 Vali Acc: 0.266 Test Loss: 1.852 Test Acc: 0.266
Validation loss decreased (-0.144489 --> -0.265877).  Saving model ...
Epoch: 3 cost time: 3.546335220336914
Epoch: 3, Steps: 17 | Train Loss: 1.745 Vali Loss: 1.709 Vali Acc: 0.289 Test Loss: 1.709 Test Acc: 0.289
Validation loss decreased (-0.265877 --> -0.289000).  Saving model ...
Epoch: 4 cost time: 3.589715003967285
Epoch: 4, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.544 Vali Acc: 0.353 Test Loss: 1.544 Test Acc: 0.353
Validation loss decreased (-0.289000 --> -0.352586).  Saving model ...
Epoch: 5 cost time: 3.782402515411377
Epoch: 5, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.402 Vali Acc: 0.439 Test Loss: 1.402 Test Acc: 0.439
Validation loss decreased (-0.352586 --> -0.439292).  Saving model ...
Epoch: 6 cost time: 3.5329320430755615
Epoch: 6, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.308 Vali Acc: 0.538 Test Loss: 1.308 Test Acc: 0.538
Validation loss decreased (-0.439292 --> -0.537559).  Saving model ...
Epoch: 7 cost time: 3.436009407043457
Epoch: 7, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.199 Vali Acc: 0.578 Test Loss: 1.199 Test Acc: 0.578
Validation loss decreased (-0.537559 --> -0.578023).  Saving model ...
Epoch: 8 cost time: 3.4621496200561523
Epoch: 8, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.146 Vali Acc: 0.572 Test Loss: 1.146 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7836711406707764
Epoch: 9, Steps: 17 | Train Loss: 0.872 Vali Loss: 1.012 Vali Acc: 0.694 Test Loss: 1.012 Test Acc: 0.694
Validation loss decreased (-0.578023 --> -0.693631).  Saving model ...
Epoch: 10 cost time: 3.5775094032287598
Epoch: 10, Steps: 17 | Train Loss: 0.751 Vali Loss: 0.965 Vali Acc: 0.642 Test Loss: 0.965 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.453331232070923
Epoch: 11, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.911 Vali Acc: 0.671 Test Loss: 0.911 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.451982021331787
Epoch: 12, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.821 Vali Acc: 0.688 Test Loss: 0.821 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.695249319076538
Epoch: 13, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.827 Vali Acc: 0.694 Test Loss: 0.827 Test Acc: 0.694
Validation loss decreased (-0.693631 --> -0.693633).  Saving model ...
Epoch: 14 cost time: 3.807202100753784
Epoch: 14, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.748 Vali Acc: 0.751 Test Loss: 0.748 Test Acc: 0.751
Validation loss decreased (-0.693633 --> -0.751438).  Saving model ...
Epoch: 15 cost time: 3.3976542949676514
Epoch: 15, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
Validation loss decreased (-0.751438 --> -0.757219).  Saving model ...
Epoch: 16 cost time: 3.43851375579834
Epoch: 16, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.768 Vali Acc: 0.740 Test Loss: 0.768 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.586026668548584
Epoch: 17, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.658 Vali Acc: 0.734 Test Loss: 0.658 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7553369998931885
Epoch: 18, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.623 Vali Acc: 0.792 Test Loss: 0.623 Test Acc: 0.792
Validation loss decreased (-0.757219 --> -0.791901).  Saving model ...
Epoch: 19 cost time: 3.3877265453338623
Epoch: 19, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.701 Vali Acc: 0.728 Test Loss: 0.701 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.487517833709717
Epoch: 20, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809242).  Saving model ...
Epoch: 21 cost time: 3.5492727756500244
Epoch: 21, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.718 Vali Acc: 0.757 Test Loss: 0.718 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.589177131652832
Epoch: 22, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.598 Vali Acc: 0.786 Test Loss: 0.598 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.4132180213928223
Epoch: 23, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.812 Vali Acc: 0.734 Test Loss: 0.812 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.30454683303833
Epoch: 24, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.737 Vali Acc: 0.728 Test Loss: 0.737 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.3552157878875732
Epoch: 25, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.899 Vali Acc: 0.717 Test Loss: 0.899 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.490516185760498
Epoch: 26, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.729 Vali Acc: 0.734 Test Loss: 0.729 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.6422183513641357
Epoch: 27, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.779 Vali Acc: 0.746 Test Loss: 0.779 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.4375665187835693
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.877 Vali Acc: 0.723 Test Loss: 0.877 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.436660051345825
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.716 Vali Acc: 0.769 Test Loss: 0.716 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.3435254096984863
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.687 Vali Acc: 0.763 Test Loss: 0.687 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 376447
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.860987424850464
Epoch: 1, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.953 Vali Acc: 0.208 Test Loss: 1.953 Test Acc: 0.208
Validation loss decreased (inf --> -0.208073).  Saving model ...
Epoch: 2 cost time: 3.8603811264038086
Epoch: 2, Steps: 17 | Train Loss: 1.852 Vali Loss: 1.836 Vali Acc: 0.289 Test Loss: 1.836 Test Acc: 0.289
Validation loss decreased (-0.208073 --> -0.288999).  Saving model ...
Epoch: 3 cost time: 3.7770934104919434
Epoch: 3, Steps: 17 | Train Loss: 1.735 Vali Loss: 1.716 Vali Acc: 0.341 Test Loss: 1.716 Test Acc: 0.341
Validation loss decreased (-0.288999 --> -0.341023).  Saving model ...
Epoch: 4 cost time: 3.871670722961426
Epoch: 4, Steps: 17 | Train Loss: 1.587 Vali Loss: 1.570 Vali Acc: 0.393 Test Loss: 1.570 Test Acc: 0.393
Validation loss decreased (-0.341023 --> -0.393048).  Saving model ...
Epoch: 5 cost time: 3.987312078475952
Epoch: 5, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.416 Vali Acc: 0.451 Test Loss: 1.416 Test Acc: 0.451
Validation loss decreased (-0.393048 --> -0.450853).  Saving model ...
Epoch: 6 cost time: 4.0976808071136475
Epoch: 6, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.283 Vali Acc: 0.543 Test Loss: 1.283 Test Acc: 0.543
Validation loss decreased (-0.450853 --> -0.543340).  Saving model ...
Epoch: 7 cost time: 3.4381608963012695
Epoch: 7, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.192 Vali Acc: 0.520 Test Loss: 1.192 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3077614307403564
Epoch: 8, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.039 Vali Acc: 0.682 Test Loss: 1.039 Test Acc: 0.682
Validation loss decreased (-0.543340 --> -0.682071).  Saving model ...
Epoch: 9 cost time: 4.060969352722168
Epoch: 9, Steps: 17 | Train Loss: 0.791 Vali Loss: 1.004 Vali Acc: 0.665 Test Loss: 1.004 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.069979667663574
Epoch: 10, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.880 Vali Acc: 0.723 Test Loss: 0.880 Test Acc: 0.723
Validation loss decreased (-0.682071 --> -0.722535).  Saving model ...
Epoch: 11 cost time: 4.126882553100586
Epoch: 11, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.798 Vali Acc: 0.705 Test Loss: 0.798 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5242276191711426
Epoch: 12, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.906 Vali Acc: 0.630 Test Loss: 0.906 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.021705150604248
Epoch: 13, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.851 Vali Acc: 0.694 Test Loss: 0.851 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1348636150360107
Epoch: 14, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.820 Vali Acc: 0.671 Test Loss: 0.820 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.872431755065918
Epoch: 15, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.603 Vali Acc: 0.780 Test Loss: 0.603 Test Acc: 0.780
Validation loss decreased (-0.722535 --> -0.780341).  Saving model ...
Epoch: 16 cost time: 3.283447504043579
Epoch: 16, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.610 Vali Acc: 0.775 Test Loss: 0.610 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.839128255844116
Epoch: 17, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.737 Vali Acc: 0.757 Test Loss: 0.737 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8252546787261963
Epoch: 18, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.684 Vali Acc: 0.792 Test Loss: 0.684 Test Acc: 0.792
Validation loss decreased (-0.780341 --> -0.791901).  Saving model ...
Epoch: 19 cost time: 3.9464807510375977
Epoch: 19, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.639 Vali Acc: 0.786 Test Loss: 0.639 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.286573171615601
Epoch: 20, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.662 Vali Acc: 0.786 Test Loss: 0.662 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.900062084197998
Epoch: 21, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.599 Vali Acc: 0.769 Test Loss: 0.599 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.283031225204468
Epoch: 22, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803463).  Saving model ...
Epoch: 23 cost time: 3.494980812072754
Epoch: 23, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.586 Vali Acc: 0.775 Test Loss: 0.586 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.0862135887146
Epoch: 24, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.5105812549591064
Epoch: 25, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.632 Vali Acc: 0.780 Test Loss: 0.632 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.9387543201446533
Epoch: 26, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.678 Vali Acc: 0.775 Test Loss: 0.678 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.319591760635376
Epoch: 27, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.716 Vali Acc: 0.763 Test Loss: 0.716 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.9185636043548584
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.649 Vali Acc: 0.786 Test Loss: 0.649 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.111856937408447
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.652 Vali Acc: 0.821 Test Loss: 0.652 Test Acc: 0.821
Validation loss decreased (-0.803463 --> -0.820803).  Saving model ...
Epoch: 30 cost time: 3.8554892539978027
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.615 Vali Acc: 0.798 Test Loss: 0.615 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1204415
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.206557989120483
Epoch: 1, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.982 Vali Acc: 0.145 Test Loss: 1.982 Test Acc: 0.145
Validation loss decreased (inf --> -0.144489).  Saving model ...
Epoch: 2 cost time: 2.4896016120910645
Epoch: 2, Steps: 17 | Train Loss: 1.888 Vali Loss: 1.852 Vali Acc: 0.266 Test Loss: 1.852 Test Acc: 0.266
Validation loss decreased (-0.144489 --> -0.265877).  Saving model ...
Epoch: 3 cost time: 2.8167974948883057
Epoch: 3, Steps: 17 | Train Loss: 1.745 Vali Loss: 1.709 Vali Acc: 0.289 Test Loss: 1.709 Test Acc: 0.289
Validation loss decreased (-0.265877 --> -0.289000).  Saving model ...
Epoch: 4 cost time: 3.1316521167755127
Epoch: 4, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.544 Vali Acc: 0.353 Test Loss: 1.544 Test Acc: 0.353
Validation loss decreased (-0.289000 --> -0.352586).  Saving model ...
Epoch: 5 cost time: 2.9767143726348877
Epoch: 5, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.402 Vali Acc: 0.439 Test Loss: 1.402 Test Acc: 0.439
Validation loss decreased (-0.352586 --> -0.439292).  Saving model ...
Epoch: 6 cost time: 3.1203293800354004
Epoch: 6, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.307 Vali Acc: 0.538 Test Loss: 1.307 Test Acc: 0.538
Validation loss decreased (-0.439292 --> -0.537559).  Saving model ...
Epoch: 7 cost time: 2.799236536026001
Epoch: 7, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.199 Vali Acc: 0.572 Test Loss: 1.199 Test Acc: 0.572
Validation loss decreased (-0.537559 --> -0.572242).  Saving model ...
Epoch: 8 cost time: 3.118267059326172
Epoch: 8, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.147 Vali Acc: 0.572 Test Loss: 1.147 Test Acc: 0.572
Validation loss decreased (-0.572242 --> -0.572243).  Saving model ...
Epoch: 9 cost time: 2.8508477210998535
Epoch: 9, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.011 Vali Acc: 0.699 Test Loss: 1.011 Test Acc: 0.699
Validation loss decreased (-0.572243 --> -0.699412).  Saving model ...
Epoch: 10 cost time: 3.0898048877716064
Epoch: 10, Steps: 17 | Train Loss: 0.754 Vali Loss: 0.985 Vali Acc: 0.613 Test Loss: 0.985 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.897808790206909
Epoch: 11, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.905 Vali Acc: 0.665 Test Loss: 0.905 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1755423545837402
Epoch: 12, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.818 Vali Acc: 0.694 Test Loss: 0.818 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.993696689605713
Epoch: 13, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.841 Vali Acc: 0.676 Test Loss: 0.841 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.106863260269165
Epoch: 14, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.751 Vali Acc: 0.734 Test Loss: 0.751 Test Acc: 0.734
Validation loss decreased (-0.699412 --> -0.734097).  Saving model ...
Epoch: 15 cost time: 2.800408124923706
Epoch: 15, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.690 Vali Acc: 0.740 Test Loss: 0.690 Test Acc: 0.740
Validation loss decreased (-0.734097 --> -0.739877).  Saving model ...
Epoch: 16 cost time: 3.1175496578216553
Epoch: 16, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.756 Vali Acc: 0.728 Test Loss: 0.756 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7924768924713135
Epoch: 17, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.648 Vali Acc: 0.763 Test Loss: 0.648 Test Acc: 0.763
Validation loss decreased (-0.739877 --> -0.762999).  Saving model ...
Epoch: 18 cost time: 3.092395544052124
Epoch: 18, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.640 Vali Acc: 0.775 Test Loss: 0.640 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774560).  Saving model ...
Epoch: 19 cost time: 2.9274282455444336
Epoch: 19, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.755 Vali Acc: 0.711 Test Loss: 0.755 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1425375938415527
Epoch: 20, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.660 Vali Acc: 0.780 Test Loss: 0.660 Test Acc: 0.780
Validation loss decreased (-0.774560 --> -0.780340).  Saving model ...
Epoch: 21 cost time: 3.0239081382751465
Epoch: 21, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.712 Vali Acc: 0.734 Test Loss: 0.712 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.049560070037842
Epoch: 22, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.608 Vali Acc: 0.792 Test Loss: 0.608 Test Acc: 0.792
Validation loss decreased (-0.780340 --> -0.791901).  Saving model ...
Epoch: 23 cost time: 2.7342612743377686
Epoch: 23, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.804 Vali Acc: 0.711 Test Loss: 0.804 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.608053684234619
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.769 Vali Acc: 0.723 Test Loss: 0.769 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.308217763900757
Epoch: 25, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.726 Vali Acc: 0.723 Test Loss: 0.726 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.799142360687256
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.657 Vali Acc: 0.763 Test Loss: 0.657 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.403141975402832
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.758 Vali Acc: 0.740 Test Loss: 0.758 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.7295167446136475
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.821 Vali Acc: 0.734 Test Loss: 0.821 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.5540642738342285
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.786 Vali Acc: 0.728 Test Loss: 0.786 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.200005054473877
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.753 Vali Acc: 0.734 Test Loss: 0.753 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 376447
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.839864015579224
Epoch: 1, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.916 Vali Acc: 0.185 Test Loss: 1.916 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 5.178804159164429
Epoch: 2, Steps: 17 | Train Loss: 1.809 Vali Loss: 1.800 Vali Acc: 0.272 Test Loss: 1.800 Test Acc: 0.272
Validation loss decreased (-0.184952 --> -0.271658).  Saving model ...
Epoch: 3 cost time: 4.929441452026367
Epoch: 3, Steps: 17 | Train Loss: 1.703 Vali Loss: 1.657 Vali Acc: 0.301 Test Loss: 1.657 Test Acc: 0.301
Validation loss decreased (-0.271658 --> -0.300561).  Saving model ...
Epoch: 4 cost time: 4.9944469928741455
Epoch: 4, Steps: 17 | Train Loss: 1.553 Vali Loss: 1.540 Vali Acc: 0.312 Test Loss: 1.540 Test Acc: 0.312
Validation loss decreased (-0.300561 --> -0.312123).  Saving model ...
Epoch: 5 cost time: 5.017095565795898
Epoch: 5, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.389 Vali Acc: 0.422 Test Loss: 1.389 Test Acc: 0.422
Validation loss decreased (-0.312123 --> -0.421951).  Saving model ...
Epoch: 6 cost time: 5.160807847976685
Epoch: 6, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.300 Vali Acc: 0.462 Test Loss: 1.300 Test Acc: 0.462
Validation loss decreased (-0.421951 --> -0.462415).  Saving model ...
Epoch: 7 cost time: 5.089879989624023
Epoch: 7, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.236 Vali Acc: 0.532 Test Loss: 1.236 Test Acc: 0.532
Validation loss decreased (-0.462415 --> -0.531780).  Saving model ...
Epoch: 8 cost time: 4.93189263343811
Epoch: 8, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.277072906494141
Epoch: 9, Steps: 17 | Train Loss: 0.854 Vali Loss: 1.066 Vali Acc: 0.578 Test Loss: 1.066 Test Acc: 0.578
Validation loss decreased (-0.531780 --> -0.578024).  Saving model ...
Epoch: 10 cost time: 5.165144443511963
Epoch: 10, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.987 Vali Acc: 0.636 Test Loss: 0.987 Test Acc: 0.636
Validation loss decreased (-0.578024 --> -0.635828).  Saving model ...
Epoch: 11 cost time: 5.1522533893585205
Epoch: 11, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.902 Vali Acc: 0.653 Test Loss: 0.902 Test Acc: 0.653
Validation loss decreased (-0.635828 --> -0.653170).  Saving model ...
Epoch: 12 cost time: 4.780114412307739
Epoch: 12, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.859 Vali Acc: 0.728 Test Loss: 0.859 Test Acc: 0.728
Validation loss decreased (-0.653170 --> -0.728315).  Saving model ...
Epoch: 13 cost time: 4.992746829986572
Epoch: 13, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.868 Vali Acc: 0.694 Test Loss: 0.868 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.518453359603882
Epoch: 14, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.835 Vali Acc: 0.734 Test Loss: 0.835 Test Acc: 0.734
Validation loss decreased (-0.728315 --> -0.734096).  Saving model ...
Epoch: 15 cost time: 4.706924676895142
Epoch: 15, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.845 Vali Acc: 0.711 Test Loss: 0.845 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.709333419799805
Epoch: 16, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.657 Vali Acc: 0.798 Test Loss: 0.657 Test Acc: 0.798
Validation loss decreased (-0.734096 --> -0.797681).  Saving model ...
Epoch: 17 cost time: 4.529082775115967
Epoch: 17, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.685 Vali Acc: 0.740 Test Loss: 0.685 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.4413909912109375
Epoch: 18, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.780 Vali Acc: 0.728 Test Loss: 0.780 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.574511766433716
Epoch: 19, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.634 Vali Acc: 0.798 Test Loss: 0.634 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797682).  Saving model ...
Epoch: 20 cost time: 4.611503839492798
Epoch: 20, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.697 Vali Acc: 0.740 Test Loss: 0.697 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.2465667724609375
Epoch: 21, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.737 Vali Acc: 0.723 Test Loss: 0.737 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.6930413246154785
Epoch: 22, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.457663059234619
Epoch: 23, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.645 Vali Acc: 0.763 Test Loss: 0.645 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.8508460521698
Epoch: 24, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.736 Vali Acc: 0.780 Test Loss: 0.736 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.209316253662109
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.721 Vali Acc: 0.775 Test Loss: 0.721 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.928283214569092
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.735 Vali Acc: 0.775 Test Loss: 0.735 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.3731231689453125
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.781 Vali Acc: 0.780 Test Loss: 0.781 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.715907096862793
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.724 Vali Acc: 0.763 Test Loss: 0.724 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.5221264362335205
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 617919
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.60737943649292
Epoch: 1, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.903 Vali Acc: 0.260 Test Loss: 1.903 Test Acc: 0.260
Validation loss decreased (inf --> -0.260097).  Saving model ...
Epoch: 2 cost time: 3.2437384128570557
Epoch: 2, Steps: 17 | Train Loss: 1.836 Vali Loss: 1.774 Vali Acc: 0.283 Test Loss: 1.774 Test Acc: 0.283
Validation loss decreased (-0.260097 --> -0.283219).  Saving model ...
Epoch: 3 cost time: 3.8288321495056152
Epoch: 3, Steps: 17 | Train Loss: 1.671 Vali Loss: 1.620 Vali Acc: 0.329 Test Loss: 1.620 Test Acc: 0.329
Validation loss decreased (-0.283219 --> -0.329464).  Saving model ...
Epoch: 4 cost time: 3.226726531982422
Epoch: 4, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.475 Vali Acc: 0.405 Test Loss: 1.475 Test Acc: 0.405
Validation loss decreased (-0.329464 --> -0.404610).  Saving model ...
Epoch: 5 cost time: 3.6329329013824463
Epoch: 5, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.324 Vali Acc: 0.532 Test Loss: 1.324 Test Acc: 0.532
Validation loss decreased (-0.404610 --> -0.531779).  Saving model ...
Epoch: 6 cost time: 3.2373156547546387
Epoch: 6, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.207 Vali Acc: 0.590 Test Loss: 1.207 Test Acc: 0.590
Validation loss decreased (-0.531779 --> -0.589583).  Saving model ...
Epoch: 7 cost time: 2.9380500316619873
Epoch: 7, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.104 Vali Acc: 0.613 Test Loss: 1.104 Test Acc: 0.613
Validation loss decreased (-0.589583 --> -0.612706).  Saving model ...
Epoch: 8 cost time: 3.507115602493286
Epoch: 8, Steps: 17 | Train Loss: 0.882 Vali Loss: 0.991 Vali Acc: 0.699 Test Loss: 0.991 Test Acc: 0.699
Validation loss decreased (-0.612706 --> -0.699412).  Saving model ...
Epoch: 9 cost time: 3.246262788772583
Epoch: 9, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.950 Vali Acc: 0.584 Test Loss: 0.950 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.365739583969116
Epoch: 10, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.860 Vali Acc: 0.705 Test Loss: 0.860 Test Acc: 0.705
Validation loss decreased (-0.699412 --> -0.705194).  Saving model ...
Epoch: 11 cost time: 3.288257122039795
Epoch: 11, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.859 Vali Acc: 0.642 Test Loss: 0.859 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.170738458633423
Epoch: 12, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.737 Vali Acc: 0.705 Test Loss: 0.737 Test Acc: 0.705
Validation loss decreased (-0.705194 --> -0.705195).  Saving model ...
Epoch: 13 cost time: 3.7405166625976562
Epoch: 13, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.828 Vali Acc: 0.671 Test Loss: 0.828 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6252660751342773
Epoch: 14, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.721 Vali Acc: 0.717 Test Loss: 0.721 Test Acc: 0.717
Validation loss decreased (-0.705195 --> -0.716756).  Saving model ...
Epoch: 15 cost time: 3.733635663986206
Epoch: 15, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.652 Vali Acc: 0.723 Test Loss: 0.652 Test Acc: 0.723
Validation loss decreased (-0.716756 --> -0.722537).  Saving model ...
Epoch: 16 cost time: 3.5267653465270996
Epoch: 16, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.746 Vali Acc: 0.705 Test Loss: 0.746 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.684187412261963
Epoch: 17, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.682 Vali Acc: 0.723 Test Loss: 0.682 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.616438627243042
Epoch: 18, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.816 Vali Acc: 0.723 Test Loss: 0.816 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.5696144104003906
Epoch: 19, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.658 Vali Acc: 0.751 Test Loss: 0.658 Test Acc: 0.751
Validation loss decreased (-0.722537 --> -0.751439).  Saving model ...
Epoch: 20 cost time: 3.7919256687164307
Epoch: 20, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.751 Vali Acc: 0.751 Test Loss: 0.751 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5473790168762207
Epoch: 21, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.737 Vali Acc: 0.751 Test Loss: 0.737 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1603152751922607
Epoch: 22, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.756 Vali Acc: 0.728 Test Loss: 0.756 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.6171462535858154
Epoch: 23, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.744 Vali Acc: 0.751 Test Loss: 0.744 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.7080347537994385
Epoch: 24, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.696 Vali Acc: 0.775 Test Loss: 0.696 Test Acc: 0.775
Validation loss decreased (-0.751439 --> -0.774560).  Saving model ...
Epoch: 25 cost time: 3.6002302169799805
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.686 Vali Acc: 0.786 Test Loss: 0.686 Test Acc: 0.786
Validation loss decreased (-0.774560 --> -0.786120).  Saving model ...
Epoch: 26 cost time: 3.6006693840026855
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.845 Vali Acc: 0.746 Test Loss: 0.845 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.827967882156372
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.860 Vali Acc: 0.746 Test Loss: 0.860 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.5724222660064697
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.796 Vali Acc: 0.775 Test Loss: 0.796 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.554454803466797
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.860 Vali Acc: 0.740 Test Loss: 0.860 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.7513346672058105
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.848 Vali Acc: 0.757 Test Loss: 0.848 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 203903
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.039568185806274
Epoch: 1, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.916 Vali Acc: 0.185 Test Loss: 1.916 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 3.804847478866577
Epoch: 2, Steps: 17 | Train Loss: 1.809 Vali Loss: 1.800 Vali Acc: 0.272 Test Loss: 1.800 Test Acc: 0.272
Validation loss decreased (-0.184952 --> -0.271658).  Saving model ...
Epoch: 3 cost time: 4.026930809020996
Epoch: 3, Steps: 17 | Train Loss: 1.703 Vali Loss: 1.657 Vali Acc: 0.301 Test Loss: 1.657 Test Acc: 0.301
Validation loss decreased (-0.271658 --> -0.300561).  Saving model ...
Epoch: 4 cost time: 3.620939254760742
Epoch: 4, Steps: 17 | Train Loss: 1.553 Vali Loss: 1.540 Vali Acc: 0.312 Test Loss: 1.540 Test Acc: 0.312
Validation loss decreased (-0.300561 --> -0.312123).  Saving model ...
Epoch: 5 cost time: 4.127853870391846
Epoch: 5, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.389 Vali Acc: 0.422 Test Loss: 1.389 Test Acc: 0.422
Validation loss decreased (-0.312123 --> -0.421951).  Saving model ...
Epoch: 6 cost time: 4.380105495452881
Epoch: 6, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.300 Vali Acc: 0.462 Test Loss: 1.300 Test Acc: 0.462
Validation loss decreased (-0.421951 --> -0.462415).  Saving model ...
Epoch: 7 cost time: 4.542169094085693
Epoch: 7, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.236 Vali Acc: 0.532 Test Loss: 1.236 Test Acc: 0.532
Validation loss decreased (-0.462415 --> -0.531780).  Saving model ...
Epoch: 8 cost time: 4.300068616867065
Epoch: 8, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.5653510093688965
Epoch: 9, Steps: 17 | Train Loss: 0.854 Vali Loss: 1.066 Vali Acc: 0.578 Test Loss: 1.066 Test Acc: 0.578
Validation loss decreased (-0.531780 --> -0.578024).  Saving model ...
Epoch: 10 cost time: 4.400836706161499
Epoch: 10, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.987 Vali Acc: 0.630 Test Loss: 0.987 Test Acc: 0.630
Validation loss decreased (-0.578024 --> -0.630048).  Saving model ...
Epoch: 11 cost time: 4.6652138233184814
Epoch: 11, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.902 Vali Acc: 0.659 Test Loss: 0.902 Test Acc: 0.659
Validation loss decreased (-0.630048 --> -0.658951).  Saving model ...
Epoch: 12 cost time: 4.386170864105225
Epoch: 12, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.911 Vali Acc: 0.699 Test Loss: 0.911 Test Acc: 0.699
Validation loss decreased (-0.658951 --> -0.699413).  Saving model ...
Epoch: 13 cost time: 4.176590442657471
Epoch: 13, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.884 Vali Acc: 0.676 Test Loss: 0.884 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.37304949760437
Epoch: 14, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.872 Vali Acc: 0.723 Test Loss: 0.872 Test Acc: 0.723
Validation loss decreased (-0.699413 --> -0.722535).  Saving model ...
Epoch: 15 cost time: 4.607091903686523
Epoch: 15, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.763 Vali Acc: 0.751 Test Loss: 0.763 Test Acc: 0.751
Validation loss decreased (-0.722535 --> -0.751437).  Saving model ...
Epoch: 16 cost time: 4.513134002685547
Epoch: 16, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.680 Vali Acc: 0.746 Test Loss: 0.680 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.371601581573486
Epoch: 17, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.682 Vali Acc: 0.786 Test Loss: 0.682 Test Acc: 0.786
Validation loss decreased (-0.751437 --> -0.786120).  Saving model ...
Epoch: 18 cost time: 4.716949224472046
Epoch: 18, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.789 Vali Acc: 0.705 Test Loss: 0.789 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.4636054039001465
Epoch: 19, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.761 Vali Acc: 0.728 Test Loss: 0.761 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.687971115112305
Epoch: 20, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.747 Vali Acc: 0.757 Test Loss: 0.747 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.356504917144775
Epoch: 21, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.647 Vali Acc: 0.775 Test Loss: 0.647 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.652428388595581
Epoch: 22, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.726 Vali Acc: 0.746 Test Loss: 0.726 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.838526964187622
Epoch: 23, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.638 Vali Acc: 0.786 Test Loss: 0.638 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786121).  Saving model ...
Epoch: 24 cost time: 3.584876537322998
Epoch: 24, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.747 Vali Acc: 0.780 Test Loss: 0.747 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.102717399597168
Epoch: 25, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.760 Vali Acc: 0.757 Test Loss: 0.760 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3916337490081787
Epoch: 26, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.748 Vali Acc: 0.763 Test Loss: 0.748 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.638298511505127
Epoch: 27, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.661 Vali Acc: 0.792 Test Loss: 0.661 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791901).  Saving model ...
Epoch: 28 cost time: 3.5114047527313232
Epoch: 28, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.678 Vali Acc: 0.775 Test Loss: 0.678 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.5726354122161865
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.834 Vali Acc: 0.803 Test Loss: 0.834 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803460).  Saving model ...
Epoch: 30 cost time: 3.908240556716919
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.761 Vali Acc: 0.728 Test Loss: 0.761 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 617919
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.629148721694946
Epoch: 1, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.903 Vali Acc: 0.260 Test Loss: 1.903 Test Acc: 0.260
Validation loss decreased (inf --> -0.260097).  Saving model ...
Epoch: 2 cost time: 3.0617892742156982
Epoch: 2, Steps: 17 | Train Loss: 1.836 Vali Loss: 1.774 Vali Acc: 0.283 Test Loss: 1.774 Test Acc: 0.283
Validation loss decreased (-0.260097 --> -0.283219).  Saving model ...
Epoch: 3 cost time: 3.220200538635254
Epoch: 3, Steps: 17 | Train Loss: 1.671 Vali Loss: 1.620 Vali Acc: 0.329 Test Loss: 1.620 Test Acc: 0.329
Validation loss decreased (-0.283219 --> -0.329464).  Saving model ...
Epoch: 4 cost time: 2.9486160278320312
Epoch: 4, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.475 Vali Acc: 0.405 Test Loss: 1.475 Test Acc: 0.405
Validation loss decreased (-0.329464 --> -0.404610).  Saving model ...
Epoch: 5 cost time: 2.7830491065979004
Epoch: 5, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.324 Vali Acc: 0.532 Test Loss: 1.324 Test Acc: 0.532
Validation loss decreased (-0.404610 --> -0.531779).  Saving model ...
Epoch: 6 cost time: 2.7921628952026367
Epoch: 6, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.207 Vali Acc: 0.590 Test Loss: 1.207 Test Acc: 0.590
Validation loss decreased (-0.531779 --> -0.589583).  Saving model ...
Epoch: 7 cost time: 2.8713386058807373
Epoch: 7, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.104 Vali Acc: 0.613 Test Loss: 1.104 Test Acc: 0.613
Validation loss decreased (-0.589583 --> -0.612706).  Saving model ...
Epoch: 8 cost time: 3.035498857498169
Epoch: 8, Steps: 17 | Train Loss: 0.882 Vali Loss: 0.991 Vali Acc: 0.699 Test Loss: 0.991 Test Acc: 0.699
Validation loss decreased (-0.612706 --> -0.699412).  Saving model ...
Epoch: 9 cost time: 3.1699280738830566
Epoch: 9, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.950 Vali Acc: 0.584 Test Loss: 0.950 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9339089393615723
Epoch: 10, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.860 Vali Acc: 0.711 Test Loss: 0.860 Test Acc: 0.711
Validation loss decreased (-0.699412 --> -0.710974).  Saving model ...
Epoch: 11 cost time: 2.882920265197754
Epoch: 11, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.857 Vali Acc: 0.642 Test Loss: 0.857 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8485658168792725
Epoch: 12, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.737 Vali Acc: 0.711 Test Loss: 0.737 Test Acc: 0.711
Validation loss decreased (-0.710974 --> -0.710975).  Saving model ...
Epoch: 13 cost time: 2.9161760807037354
Epoch: 13, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.822 Vali Acc: 0.682 Test Loss: 0.822 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9077394008636475
Epoch: 14, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.709 Vali Acc: 0.723 Test Loss: 0.709 Test Acc: 0.723
Validation loss decreased (-0.710975 --> -0.722536).  Saving model ...
Epoch: 15 cost time: 3.0429370403289795
Epoch: 15, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.672 Vali Acc: 0.723 Test Loss: 0.672 Test Acc: 0.723
Validation loss decreased (-0.722536 --> -0.722537).  Saving model ...
Epoch: 16 cost time: 2.818500280380249
Epoch: 16, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.691 Vali Acc: 0.728 Test Loss: 0.691 Test Acc: 0.728
Validation loss decreased (-0.722537 --> -0.728317).  Saving model ...
Epoch: 17 cost time: 2.674337863922119
Epoch: 17, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.711 Vali Acc: 0.740 Test Loss: 0.711 Test Acc: 0.740
Validation loss decreased (-0.728317 --> -0.739877).  Saving model ...
Epoch: 18 cost time: 2.1571173667907715
Epoch: 18, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.750 Vali Acc: 0.728 Test Loss: 0.750 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5527377128601074
Epoch: 19, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.702 Vali Acc: 0.740 Test Loss: 0.702 Test Acc: 0.740
Validation loss decreased (-0.739877 --> -0.739877).  Saving model ...
Epoch: 20 cost time: 2.6285903453826904
Epoch: 20, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.844 Vali Acc: 0.705 Test Loss: 0.844 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6441218852996826
Epoch: 21, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.742 Vali Acc: 0.751 Test Loss: 0.742 Test Acc: 0.751
Validation loss decreased (-0.739877 --> -0.751438).  Saving model ...
Epoch: 22 cost time: 2.673497438430786
Epoch: 22, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.824 Vali Acc: 0.740 Test Loss: 0.824 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6443519592285156
Epoch: 23, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.788 Vali Acc: 0.740 Test Loss: 0.788 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2068119049072266
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.707 Vali Acc: 0.740 Test Loss: 0.707 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.149777412414551
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.711 Vali Acc: 0.769 Test Loss: 0.711 Test Acc: 0.769
Validation loss decreased (-0.751438 --> -0.768779).  Saving model ...
Epoch: 26 cost time: 2.893500566482544
Epoch: 26, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.854 Vali Acc: 0.746 Test Loss: 0.854 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.8999996185302734
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.858 Vali Acc: 0.763 Test Loss: 0.858 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.656435489654541
Epoch: 28, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.761 Vali Acc: 0.740 Test Loss: 0.761 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.613124132156372
Epoch: 29, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.849 Vali Acc: 0.734 Test Loss: 0.849 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.0434041023254395
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.919 Vali Acc: 0.769 Test Loss: 0.919 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 203903
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.110301733016968
Epoch: 1, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.916 Vali Acc: 0.191 Test Loss: 1.916 Test Acc: 0.191
Validation loss decreased (inf --> -0.190732).  Saving model ...
Epoch: 2 cost time: 3.323531150817871
Epoch: 2, Steps: 17 | Train Loss: 1.809 Vali Loss: 1.800 Vali Acc: 0.272 Test Loss: 1.800 Test Acc: 0.272
Validation loss decreased (-0.190732 --> -0.271658).  Saving model ...
Epoch: 3 cost time: 3.2541892528533936
Epoch: 3, Steps: 17 | Train Loss: 1.703 Vali Loss: 1.657 Vali Acc: 0.301 Test Loss: 1.657 Test Acc: 0.301
Validation loss decreased (-0.271658 --> -0.300561).  Saving model ...
Epoch: 4 cost time: 3.388305187225342
Epoch: 4, Steps: 17 | Train Loss: 1.553 Vali Loss: 1.540 Vali Acc: 0.312 Test Loss: 1.540 Test Acc: 0.312
Validation loss decreased (-0.300561 --> -0.312123).  Saving model ...
Epoch: 5 cost time: 2.97214674949646
Epoch: 5, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.389 Vali Acc: 0.434 Test Loss: 1.389 Test Acc: 0.434
Validation loss decreased (-0.312123 --> -0.433512).  Saving model ...
Epoch: 6 cost time: 3.399317741394043
Epoch: 6, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.300 Vali Acc: 0.462 Test Loss: 1.300 Test Acc: 0.462
Validation loss decreased (-0.433512 --> -0.462415).  Saving model ...
Epoch: 7 cost time: 3.08273983001709
Epoch: 7, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.236 Vali Acc: 0.549 Test Loss: 1.236 Test Acc: 0.549
Validation loss decreased (-0.462415 --> -0.549121).  Saving model ...
Epoch: 8 cost time: 3.5500876903533936
Epoch: 8, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.131 Vali Acc: 0.532 Test Loss: 1.131 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3212180137634277
Epoch: 9, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.067 Vali Acc: 0.584 Test Loss: 1.067 Test Acc: 0.584
Validation loss decreased (-0.549121 --> -0.583804).  Saving model ...
Epoch: 10 cost time: 3.3009092807769775
Epoch: 10, Steps: 17 | Train Loss: 0.755 Vali Loss: 0.955 Vali Acc: 0.682 Test Loss: 0.955 Test Acc: 0.682
Validation loss decreased (-0.583804 --> -0.682071).  Saving model ...
Epoch: 11 cost time: 2.8462564945220947
Epoch: 11, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.871 Vali Acc: 0.705 Test Loss: 0.871 Test Acc: 0.705
Validation loss decreased (-0.682071 --> -0.705194).  Saving model ...
Epoch: 12 cost time: 2.8950536251068115
Epoch: 12, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.840 Vali Acc: 0.705 Test Loss: 0.840 Test Acc: 0.705
Validation loss decreased (-0.705194 --> -0.705194).  Saving model ...
Epoch: 13 cost time: 2.9931557178497314
Epoch: 13, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.783 Vali Acc: 0.757 Test Loss: 0.783 Test Acc: 0.757
Validation loss decreased (-0.705194 --> -0.757218).  Saving model ...
Epoch: 14 cost time: 2.7029078006744385
Epoch: 14, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.853 Vali Acc: 0.711 Test Loss: 0.853 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.944007396697998
Epoch: 15, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.726 Vali Acc: 0.734 Test Loss: 0.726 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.48789381980896
Epoch: 16, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.637 Vali Acc: 0.792 Test Loss: 0.637 Test Acc: 0.792
Validation loss decreased (-0.757218 --> -0.791901).  Saving model ...
Epoch: 17 cost time: 3.0621471405029297
Epoch: 17, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.661 Vali Acc: 0.775 Test Loss: 0.661 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9544832706451416
Epoch: 18, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.690 Vali Acc: 0.734 Test Loss: 0.690 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.10280179977417
Epoch: 19, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.693 Vali Acc: 0.798 Test Loss: 0.693 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797681).  Saving model ...
Epoch: 20 cost time: 2.9620072841644287
Epoch: 20, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.677 Vali Acc: 0.780 Test Loss: 0.677 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.406099557876587
Epoch: 21, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.596 Vali Acc: 0.827 Test Loss: 0.596 Test Acc: 0.827
Validation loss decreased (-0.797681 --> -0.826584).  Saving model ...
Epoch: 22 cost time: 3.239993095397949
Epoch: 22, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.668 Vali Acc: 0.769 Test Loss: 0.668 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3418831825256348
Epoch: 23, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.680 Vali Acc: 0.780 Test Loss: 0.680 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2011029720306396
Epoch: 24, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.705 Vali Acc: 0.798 Test Loss: 0.705 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.6802003383636475
Epoch: 25, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.660 Vali Acc: 0.780 Test Loss: 0.660 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.390981435775757
Epoch: 26, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.655 Vali Acc: 0.780 Test Loss: 0.655 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.5319559574127197
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.661 Vali Acc: 0.798 Test Loss: 0.661 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.2350013256073
Epoch: 28, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.650 Vali Acc: 0.815 Test Loss: 0.650 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.541686773300171
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.716 Vali Acc: 0.792 Test Loss: 0.716 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.242992401123047
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.647 Vali Acc: 0.798 Test Loss: 0.647 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 617919
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.5360283851623535
Epoch: 1, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.903 Vali Acc: 0.260 Test Loss: 1.903 Test Acc: 0.260
Validation loss decreased (inf --> -0.260097).  Saving model ...
Epoch: 2 cost time: 3.001187801361084
Epoch: 2, Steps: 17 | Train Loss: 1.836 Vali Loss: 1.774 Vali Acc: 0.283 Test Loss: 1.774 Test Acc: 0.283
Validation loss decreased (-0.260097 --> -0.283219).  Saving model ...
Epoch: 3 cost time: 2.696573257446289
Epoch: 3, Steps: 17 | Train Loss: 1.671 Vali Loss: 1.620 Vali Acc: 0.329 Test Loss: 1.620 Test Acc: 0.329
Validation loss decreased (-0.283219 --> -0.329464).  Saving model ...
Epoch: 4 cost time: 2.7509806156158447
Epoch: 4, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.475 Vali Acc: 0.405 Test Loss: 1.475 Test Acc: 0.405
Validation loss decreased (-0.329464 --> -0.404610).  Saving model ...
Epoch: 5 cost time: 2.6051433086395264
Epoch: 5, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.324 Vali Acc: 0.532 Test Loss: 1.324 Test Acc: 0.532
Validation loss decreased (-0.404610 --> -0.531779).  Saving model ...
Epoch: 6 cost time: 2.934499740600586
Epoch: 6, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.207 Vali Acc: 0.590 Test Loss: 1.207 Test Acc: 0.590
Validation loss decreased (-0.531779 --> -0.589583).  Saving model ...
Epoch: 7 cost time: 2.6205782890319824
Epoch: 7, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.101 Vali Acc: 0.613 Test Loss: 1.101 Test Acc: 0.613
Validation loss decreased (-0.589583 --> -0.612706).  Saving model ...
Epoch: 8 cost time: 2.626469850540161
Epoch: 8, Steps: 17 | Train Loss: 0.880 Vali Loss: 0.993 Vali Acc: 0.682 Test Loss: 0.993 Test Acc: 0.682
Validation loss decreased (-0.612706 --> -0.682071).  Saving model ...
Epoch: 9 cost time: 2.2961654663085938
Epoch: 9, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.945 Vali Acc: 0.618 Test Loss: 0.945 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.58559250831604
Epoch: 10, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.847 Vali Acc: 0.711 Test Loss: 0.847 Test Acc: 0.711
Validation loss decreased (-0.682071 --> -0.710974).  Saving model ...
Epoch: 11 cost time: 2.2467105388641357
Epoch: 11, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.851 Vali Acc: 0.624 Test Loss: 0.851 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.595207929611206
Epoch: 12, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.741 Vali Acc: 0.694 Test Loss: 0.741 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3009097576141357
Epoch: 13, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.801 Vali Acc: 0.694 Test Loss: 0.801 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.545933961868286
Epoch: 14, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.698 Vali Acc: 0.734 Test Loss: 0.698 Test Acc: 0.734
Validation loss decreased (-0.710974 --> -0.734097).  Saving model ...
Epoch: 15 cost time: 2.2261734008789062
Epoch: 15, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.673 Vali Acc: 0.734 Test Loss: 0.673 Test Acc: 0.734
Validation loss decreased (-0.734097 --> -0.734097).  Saving model ...
Epoch: 16 cost time: 2.2861452102661133
Epoch: 16, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.682 Vali Acc: 0.734 Test Loss: 0.682 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9964895248413086
Epoch: 17, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.586 Vali Acc: 0.775 Test Loss: 0.586 Test Acc: 0.775
Validation loss decreased (-0.734097 --> -0.774561).  Saving model ...
Epoch: 18 cost time: 2.2141032218933105
Epoch: 18, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.693 Vali Acc: 0.699 Test Loss: 0.693 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7055399417877197
Epoch: 19, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.631 Vali Acc: 0.740 Test Loss: 0.631 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.60402250289917
Epoch: 20, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.647 Vali Acc: 0.757 Test Loss: 0.647 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3429439067840576
Epoch: 21, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.629 Vali Acc: 0.751 Test Loss: 0.629 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.467994451522827
Epoch: 22, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.628 Vali Acc: 0.751 Test Loss: 0.628 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.355823040008545
Epoch: 23, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.721 Vali Acc: 0.757 Test Loss: 0.721 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.50174617767334
Epoch: 24, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.664 Vali Acc: 0.763 Test Loss: 0.664 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.555833578109741
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.668 Vali Acc: 0.751 Test Loss: 0.668 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.691636562347412
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.670 Vali Acc: 0.757 Test Loss: 0.670 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.417454719543457
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.690 Vali Acc: 0.746 Test Loss: 0.690 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 203903
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.193976879119873
Epoch: 1, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.958 Vali Acc: 0.150 Test Loss: 1.958 Test Acc: 0.150
Validation loss decreased (inf --> -0.150269).  Saving model ...
Epoch: 2 cost time: 4.174797058105469
Epoch: 2, Steps: 17 | Train Loss: 1.892 Vali Loss: 1.850 Vali Acc: 0.220 Test Loss: 1.850 Test Acc: 0.220
Validation loss decreased (-0.150269 --> -0.219635).  Saving model ...
Epoch: 3 cost time: 4.076343536376953
Epoch: 3, Steps: 17 | Train Loss: 1.775 Vali Loss: 1.744 Vali Acc: 0.272 Test Loss: 1.744 Test Acc: 0.272
Validation loss decreased (-0.219635 --> -0.271659).  Saving model ...
Epoch: 4 cost time: 4.154344081878662
Epoch: 4, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.615 Vali Acc: 0.364 Test Loss: 1.615 Test Acc: 0.364
Validation loss decreased (-0.271659 --> -0.364146).  Saving model ...
Epoch: 5 cost time: 3.828904867172241
Epoch: 5, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.474 Vali Acc: 0.451 Test Loss: 1.474 Test Acc: 0.451
Validation loss decreased (-0.364146 --> -0.450852).  Saving model ...
Epoch: 6 cost time: 3.933540105819702
Epoch: 6, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.348 Vali Acc: 0.468 Test Loss: 1.348 Test Acc: 0.468
Validation loss decreased (-0.450852 --> -0.468195).  Saving model ...
Epoch: 7 cost time: 3.8643486499786377
Epoch: 7, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.232 Vali Acc: 0.572 Test Loss: 1.232 Test Acc: 0.572
Validation loss decreased (-0.468195 --> -0.572242).  Saving model ...
Epoch: 8 cost time: 3.69474196434021
Epoch: 8, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.144 Vali Acc: 0.561 Test Loss: 1.144 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.634687662124634
Epoch: 9, Steps: 17 | Train Loss: 0.894 Vali Loss: 1.056 Vali Acc: 0.636 Test Loss: 1.056 Test Acc: 0.636
Validation loss decreased (-0.572242 --> -0.635828).  Saving model ...
Epoch: 10 cost time: 3.5160770416259766
Epoch: 10, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.915 Vali Acc: 0.694 Test Loss: 0.915 Test Acc: 0.694
Validation loss decreased (-0.635828 --> -0.693632).  Saving model ...
Epoch: 11 cost time: 4.009462833404541
Epoch: 11, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.837 Vali Acc: 0.671 Test Loss: 0.837 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.878004312515259
Epoch: 12, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.798 Vali Acc: 0.676 Test Loss: 0.798 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.354928493499756
Epoch: 13, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.710 Vali Acc: 0.734 Test Loss: 0.710 Test Acc: 0.734
Validation loss decreased (-0.693632 --> -0.734097).  Saving model ...
Epoch: 14 cost time: 4.341291427612305
Epoch: 14, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.684 Vali Acc: 0.746 Test Loss: 0.684 Test Acc: 0.746
Validation loss decreased (-0.734097 --> -0.745658).  Saving model ...
Epoch: 15 cost time: 4.079972743988037
Epoch: 15, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.692 Vali Acc: 0.751 Test Loss: 0.692 Test Acc: 0.751
Validation loss decreased (-0.745658 --> -0.751438).  Saving model ...
Epoch: 16 cost time: 4.343280076980591
Epoch: 16, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.597 Vali Acc: 0.740 Test Loss: 0.597 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.122608661651611
Epoch: 17, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.702 Vali Acc: 0.757 Test Loss: 0.702 Test Acc: 0.757
Validation loss decreased (-0.751438 --> -0.757218).  Saving model ...
Epoch: 18 cost time: 3.658418893814087
Epoch: 18, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.617 Vali Acc: 0.757 Test Loss: 0.617 Test Acc: 0.757
Validation loss decreased (-0.757218 --> -0.757219).  Saving model ...
Epoch: 19 cost time: 4.100999116897583
Epoch: 19, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.622 Vali Acc: 0.740 Test Loss: 0.622 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.394658327102661
Epoch: 20, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.565 Vali Acc: 0.734 Test Loss: 0.565 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.205796957015991
Epoch: 21, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.484 Vali Acc: 0.792 Test Loss: 0.484 Test Acc: 0.792
Validation loss decreased (-0.757219 --> -0.791903).  Saving model ...
Epoch: 22 cost time: 4.394626140594482
Epoch: 22, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
Validation loss decreased (-0.791903 --> -0.803463).  Saving model ...
Epoch: 23 cost time: 4.368654251098633
Epoch: 23, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.568 Vali Acc: 0.775 Test Loss: 0.568 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.730817794799805
Epoch: 24, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.561 Vali Acc: 0.763 Test Loss: 0.561 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.504815101623535
Epoch: 25, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.304650783538818
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.597 Vali Acc: 0.780 Test Loss: 0.597 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.33104944229126
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.638 Vali Acc: 0.728 Test Loss: 0.638 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.806396961212158
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809243).  Saving model ...
Epoch: 29 cost time: 3.8784127235412598
Epoch: 29, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.626 Vali Acc: 0.740 Test Loss: 0.626 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.1946680545806885
Epoch: 30, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.649 Vali Acc: 0.763 Test Loss: 0.649 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 324671
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.673041582107544
Epoch: 1, Steps: 17 | Train Loss: 1.948 Vali Loss: 1.908 Vali Acc: 0.179 Test Loss: 1.908 Test Acc: 0.179
Validation loss decreased (inf --> -0.179172).  Saving model ...
Epoch: 2 cost time: 3.0207009315490723
Epoch: 2, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.807 Vali Acc: 0.243 Test Loss: 1.807 Test Acc: 0.243
Validation loss decreased (-0.179172 --> -0.242756).  Saving model ...
Epoch: 3 cost time: 3.273771047592163
Epoch: 3, Steps: 17 | Train Loss: 1.715 Vali Loss: 1.683 Vali Acc: 0.301 Test Loss: 1.683 Test Acc: 0.301
Validation loss decreased (-0.242756 --> -0.300561).  Saving model ...
Epoch: 4 cost time: 3.370938539505005
Epoch: 4, Steps: 17 | Train Loss: 1.587 Vali Loss: 1.543 Vali Acc: 0.399 Test Loss: 1.543 Test Acc: 0.399
Validation loss decreased (-0.300561 --> -0.398828).  Saving model ...
Epoch: 5 cost time: 3.153782606124878
Epoch: 5, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.411 Vali Acc: 0.474 Test Loss: 1.411 Test Acc: 0.474
Validation loss decreased (-0.398828 --> -0.473974).  Saving model ...
Epoch: 6 cost time: 3.0673556327819824
Epoch: 6, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.306 Vali Acc: 0.566 Test Loss: 1.306 Test Acc: 0.566
Validation loss decreased (-0.473974 --> -0.566461).  Saving model ...
Epoch: 7 cost time: 3.108635425567627
Epoch: 7, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.226 Vali Acc: 0.561 Test Loss: 1.226 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.350975751876831
Epoch: 8, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.129 Vali Acc: 0.671 Test Loss: 1.129 Test Acc: 0.671
Validation loss decreased (-0.566461 --> -0.670509).  Saving model ...
Epoch: 9 cost time: 3.2180609703063965
Epoch: 9, Steps: 17 | Train Loss: 0.897 Vali Loss: 1.035 Vali Acc: 0.653 Test Loss: 1.035 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0269970893859863
Epoch: 10, Steps: 17 | Train Loss: 0.757 Vali Loss: 0.940 Vali Acc: 0.694 Test Loss: 0.940 Test Acc: 0.694
Validation loss decreased (-0.670509 --> -0.693632).  Saving model ...
Epoch: 11 cost time: 3.1298813819885254
Epoch: 11, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.913 Vali Acc: 0.676 Test Loss: 0.913 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.268850564956665
Epoch: 12, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.854 Vali Acc: 0.705 Test Loss: 0.854 Test Acc: 0.705
Validation loss decreased (-0.693632 --> -0.705194).  Saving model ...
Epoch: 13 cost time: 3.3413007259368896
Epoch: 13, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.782 Vali Acc: 0.723 Test Loss: 0.782 Test Acc: 0.723
Validation loss decreased (-0.705194 --> -0.722536).  Saving model ...
Epoch: 14 cost time: 3.2611804008483887
Epoch: 14, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.861 Vali Acc: 0.682 Test Loss: 0.861 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.064389705657959
Epoch: 15, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.672 Vali Acc: 0.757 Test Loss: 0.672 Test Acc: 0.757
Validation loss decreased (-0.722536 --> -0.757219).  Saving model ...
Epoch: 16 cost time: 3.1104323863983154
Epoch: 16, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.757 Vali Acc: 0.723 Test Loss: 0.757 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.284403085708618
Epoch: 17, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.658 Vali Acc: 0.757 Test Loss: 0.658 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 18 cost time: 3.497861385345459
Epoch: 18, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
Validation loss decreased (-0.757219 --> -0.774559).  Saving model ...
Epoch: 19 cost time: 3.2324025630950928
Epoch: 19, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.625 Vali Acc: 0.780 Test Loss: 0.625 Test Acc: 0.780
Validation loss decreased (-0.774559 --> -0.780341).  Saving model ...
Epoch: 20 cost time: 3.0889508724212646
Epoch: 20, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.614 Vali Acc: 0.827 Test Loss: 0.614 Test Acc: 0.827
Validation loss decreased (-0.780341 --> -0.826583).  Saving model ...
Epoch: 21 cost time: 2.717315912246704
Epoch: 21, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.606 Vali Acc: 0.757 Test Loss: 0.606 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.1220908164978027
Epoch: 22, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.559 Vali Acc: 0.769 Test Loss: 0.559 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.528087615966797
Epoch: 23, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.580 Vali Acc: 0.775 Test Loss: 0.580 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.523585796356201
Epoch: 24, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.541 Vali Acc: 0.832 Test Loss: 0.541 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832365).  Saving model ...
Epoch: 25 cost time: 2.6256911754608154
Epoch: 25, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.527 Vali Acc: 0.798 Test Loss: 0.527 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5329039096832275
Epoch: 26, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.8346986770629883
Epoch: 27, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.563 Vali Acc: 0.786 Test Loss: 0.563 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.5947985649108887
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.560 Vali Acc: 0.821 Test Loss: 0.560 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.8794608116149902
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.596 Vali Acc: 0.792 Test Loss: 0.596 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.0199122428894043
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.599 Vali Acc: 0.832 Test Loss: 0.599 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 117631
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.340092658996582
Epoch: 1, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.958 Vali Acc: 0.145 Test Loss: 1.958 Test Acc: 0.145
Validation loss decreased (inf --> -0.144489).  Saving model ...
Epoch: 2 cost time: 3.5281968116760254
Epoch: 2, Steps: 17 | Train Loss: 1.892 Vali Loss: 1.850 Vali Acc: 0.220 Test Loss: 1.850 Test Acc: 0.220
Validation loss decreased (-0.144489 --> -0.219635).  Saving model ...
Epoch: 3 cost time: 3.8304226398468018
Epoch: 3, Steps: 17 | Train Loss: 1.775 Vali Loss: 1.744 Vali Acc: 0.272 Test Loss: 1.744 Test Acc: 0.272
Validation loss decreased (-0.219635 --> -0.271659).  Saving model ...
Epoch: 4 cost time: 3.5520737171173096
Epoch: 4, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.615 Vali Acc: 0.364 Test Loss: 1.615 Test Acc: 0.364
Validation loss decreased (-0.271659 --> -0.364146).  Saving model ...
Epoch: 5 cost time: 3.6512038707733154
Epoch: 5, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.474 Vali Acc: 0.451 Test Loss: 1.474 Test Acc: 0.451
Validation loss decreased (-0.364146 --> -0.450852).  Saving model ...
Epoch: 6 cost time: 3.5367050170898438
Epoch: 6, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.348 Vali Acc: 0.468 Test Loss: 1.348 Test Acc: 0.468
Validation loss decreased (-0.450852 --> -0.468195).  Saving model ...
Epoch: 7 cost time: 3.562612295150757
Epoch: 7, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.232 Vali Acc: 0.572 Test Loss: 1.232 Test Acc: 0.572
Validation loss decreased (-0.468195 --> -0.572242).  Saving model ...
Epoch: 8 cost time: 3.681574821472168
Epoch: 8, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.144 Vali Acc: 0.561 Test Loss: 1.144 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4801981449127197
Epoch: 9, Steps: 17 | Train Loss: 0.894 Vali Loss: 1.059 Vali Acc: 0.624 Test Loss: 1.059 Test Acc: 0.624
Validation loss decreased (-0.572242 --> -0.624267).  Saving model ...
Epoch: 10 cost time: 3.721177101135254
Epoch: 10, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.920 Vali Acc: 0.694 Test Loss: 0.920 Test Acc: 0.694
Validation loss decreased (-0.624267 --> -0.693632).  Saving model ...
Epoch: 11 cost time: 3.7482736110687256
Epoch: 11, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.840 Vali Acc: 0.682 Test Loss: 0.840 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0663819313049316
Epoch: 12, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.792 Vali Acc: 0.688 Test Loss: 0.792 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4096715450286865
Epoch: 13, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.711 Vali Acc: 0.723 Test Loss: 0.711 Test Acc: 0.723
Validation loss decreased (-0.693632 --> -0.722536).  Saving model ...
Epoch: 14 cost time: 3.151015043258667
Epoch: 14, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.675 Vali Acc: 0.740 Test Loss: 0.675 Test Acc: 0.740
Validation loss decreased (-0.722536 --> -0.739878).  Saving model ...
Epoch: 15 cost time: 3.0912187099456787
Epoch: 15, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.670 Vali Acc: 0.728 Test Loss: 0.670 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9669418334960938
Epoch: 16, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.569 Vali Acc: 0.763 Test Loss: 0.569 Test Acc: 0.763
Validation loss decreased (-0.739878 --> -0.763000).  Saving model ...
Epoch: 17 cost time: 2.911085844039917
Epoch: 17, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.610 Vali Acc: 0.769 Test Loss: 0.610 Test Acc: 0.769
Validation loss decreased (-0.763000 --> -0.768780).  Saving model ...
Epoch: 18 cost time: 4.053079605102539
Epoch: 18, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.608 Vali Acc: 0.728 Test Loss: 0.608 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.110164642333984
Epoch: 19, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.625 Vali Acc: 0.763 Test Loss: 0.625 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.217045307159424
Epoch: 20, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.613 Vali Acc: 0.763 Test Loss: 0.613 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.313430547714233
Epoch: 21, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.560 Vali Acc: 0.740 Test Loss: 0.560 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.2981061935424805
Epoch: 22, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.509 Vali Acc: 0.815 Test Loss: 0.509 Test Acc: 0.815
Validation loss decreased (-0.768780 --> -0.815024).  Saving model ...
Epoch: 23 cost time: 4.370441436767578
Epoch: 23, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.572 Vali Acc: 0.757 Test Loss: 0.572 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.178895950317383
Epoch: 24, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.542 Vali Acc: 0.780 Test Loss: 0.542 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.028645992279053
Epoch: 25, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.577 Vali Acc: 0.769 Test Loss: 0.577 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.27553391456604
Epoch: 26, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.535 Vali Acc: 0.792 Test Loss: 0.535 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.092013597488403
Epoch: 27, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.582 Vali Acc: 0.757 Test Loss: 0.582 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.505037546157837
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.550 Vali Acc: 0.769 Test Loss: 0.550 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.062914609909058
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.619 Vali Acc: 0.769 Test Loss: 0.619 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.308980703353882
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.617 Vali Acc: 0.780 Test Loss: 0.617 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 324671
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.041817665100098
Epoch: 1, Steps: 17 | Train Loss: 1.948 Vali Loss: 1.909 Vali Acc: 0.179 Test Loss: 1.909 Test Acc: 0.179
Validation loss decreased (inf --> -0.179172).  Saving model ...
Epoch: 2 cost time: 3.1127822399139404
Epoch: 2, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.807 Vali Acc: 0.243 Test Loss: 1.807 Test Acc: 0.243
Validation loss decreased (-0.179172 --> -0.242756).  Saving model ...
Epoch: 3 cost time: 3.2535197734832764
Epoch: 3, Steps: 17 | Train Loss: 1.715 Vali Loss: 1.683 Vali Acc: 0.301 Test Loss: 1.683 Test Acc: 0.301
Validation loss decreased (-0.242756 --> -0.300561).  Saving model ...
Epoch: 4 cost time: 2.9446022510528564
Epoch: 4, Steps: 17 | Train Loss: 1.587 Vali Loss: 1.543 Vali Acc: 0.399 Test Loss: 1.543 Test Acc: 0.399
Validation loss decreased (-0.300561 --> -0.398828).  Saving model ...
Epoch: 5 cost time: 2.4207842350006104
Epoch: 5, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.411 Vali Acc: 0.474 Test Loss: 1.411 Test Acc: 0.474
Validation loss decreased (-0.398828 --> -0.473974).  Saving model ...
Epoch: 6 cost time: 3.014376401901245
Epoch: 6, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.306 Vali Acc: 0.566 Test Loss: 1.306 Test Acc: 0.566
Validation loss decreased (-0.473974 --> -0.566461).  Saving model ...
Epoch: 7 cost time: 2.679006576538086
Epoch: 7, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.226 Vali Acc: 0.561 Test Loss: 1.226 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9709110260009766
Epoch: 8, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.130 Vali Acc: 0.671 Test Loss: 1.130 Test Acc: 0.671
Validation loss decreased (-0.566461 --> -0.670509).  Saving model ...
Epoch: 9 cost time: 2.837153434753418
Epoch: 9, Steps: 17 | Train Loss: 0.897 Vali Loss: 1.035 Vali Acc: 0.659 Test Loss: 1.035 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8562796115875244
Epoch: 10, Steps: 17 | Train Loss: 0.756 Vali Loss: 0.938 Vali Acc: 0.694 Test Loss: 0.938 Test Acc: 0.694
Validation loss decreased (-0.670509 --> -0.693632).  Saving model ...
Epoch: 11 cost time: 2.967695951461792
Epoch: 11, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.937 Vali Acc: 0.647 Test Loss: 0.937 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.298565626144409
Epoch: 12, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.860 Vali Acc: 0.694 Test Loss: 0.860 Test Acc: 0.694
Validation loss decreased (-0.693632 --> -0.693633).  Saving model ...
Epoch: 13 cost time: 2.915458917617798
Epoch: 13, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.756 Vali Acc: 0.746 Test Loss: 0.756 Test Acc: 0.746
Validation loss decreased (-0.693633 --> -0.745657).  Saving model ...
Epoch: 14 cost time: 3.264478921890259
Epoch: 14, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.770 Vali Acc: 0.746 Test Loss: 0.770 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1913609504699707
Epoch: 15, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.679 Vali Acc: 0.809 Test Loss: 0.679 Test Acc: 0.809
Validation loss decreased (-0.745657 --> -0.809242).  Saving model ...
Epoch: 16 cost time: 2.586958885192871
Epoch: 16, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.738 Vali Acc: 0.751 Test Loss: 0.738 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.219186782836914
Epoch: 17, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.668 Vali Acc: 0.780 Test Loss: 0.668 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0166893005371094
Epoch: 18, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.686 Vali Acc: 0.786 Test Loss: 0.686 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9040565490722656
Epoch: 19, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.3453996181488037
Epoch: 20, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.588 Vali Acc: 0.809 Test Loss: 0.588 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809243).  Saving model ...
Epoch: 21 cost time: 3.14199161529541
Epoch: 21, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2274014949798584
Epoch: 22, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.559 Vali Acc: 0.780 Test Loss: 0.559 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3302767276763916
Epoch: 23, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.608 Vali Acc: 0.792 Test Loss: 0.608 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.135828733444214
Epoch: 24, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.589 Vali Acc: 0.821 Test Loss: 0.589 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820803).  Saving model ...
Epoch: 25 cost time: 3.358475923538208
Epoch: 25, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.548 Vali Acc: 0.792 Test Loss: 0.548 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.178004503250122
Epoch: 26, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.619 Vali Acc: 0.757 Test Loss: 0.619 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3359832763671875
Epoch: 27, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.578 Vali Acc: 0.775 Test Loss: 0.578 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.3972585201263428
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.1516361236572266
Epoch: 29, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.560 Vali Acc: 0.798 Test Loss: 0.560 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.111733913421631
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 117631
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.879755735397339
Epoch: 1, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.958 Vali Acc: 0.139 Test Loss: 1.958 Test Acc: 0.139
Validation loss decreased (inf --> -0.138709).  Saving model ...
Epoch: 2 cost time: 2.7480483055114746
Epoch: 2, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.851 Vali Acc: 0.220 Test Loss: 1.851 Test Acc: 0.220
Validation loss decreased (-0.138709 --> -0.219635).  Saving model ...
Epoch: 3 cost time: 3.0302867889404297
Epoch: 3, Steps: 17 | Train Loss: 1.776 Vali Loss: 1.745 Vali Acc: 0.272 Test Loss: 1.745 Test Acc: 0.272
Validation loss decreased (-0.219635 --> -0.271659).  Saving model ...
Epoch: 4 cost time: 2.8978729248046875
Epoch: 4, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.617 Vali Acc: 0.353 Test Loss: 1.617 Test Acc: 0.353
Validation loss decreased (-0.271659 --> -0.352585).  Saving model ...
Epoch: 5 cost time: 2.9222123622894287
Epoch: 5, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.476 Vali Acc: 0.457 Test Loss: 1.476 Test Acc: 0.457
Validation loss decreased (-0.352585 --> -0.456633).  Saving model ...
Epoch: 6 cost time: 3.126941204071045
Epoch: 6, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.350 Vali Acc: 0.468 Test Loss: 1.350 Test Acc: 0.468
Validation loss decreased (-0.456633 --> -0.468195).  Saving model ...
Epoch: 7 cost time: 3.001091480255127
Epoch: 7, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.234 Vali Acc: 0.566 Test Loss: 1.234 Test Acc: 0.566
Validation loss decreased (-0.468195 --> -0.566462).  Saving model ...
Epoch: 8 cost time: 3.121951103210449
Epoch: 8, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.145 Vali Acc: 0.549 Test Loss: 1.145 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3777804374694824
Epoch: 9, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.062 Vali Acc: 0.630 Test Loss: 1.062 Test Acc: 0.630
Validation loss decreased (-0.566462 --> -0.630047).  Saving model ...
Epoch: 10 cost time: 3.2663028240203857
Epoch: 10, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.925 Vali Acc: 0.699 Test Loss: 0.925 Test Acc: 0.699
Validation loss decreased (-0.630047 --> -0.699413).  Saving model ...
Epoch: 11 cost time: 2.8285179138183594
Epoch: 11, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.840 Vali Acc: 0.682 Test Loss: 0.840 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.379180908203125
Epoch: 12, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.792 Vali Acc: 0.705 Test Loss: 0.792 Test Acc: 0.705
Validation loss decreased (-0.699413 --> -0.705194).  Saving model ...
Epoch: 13 cost time: 3.3547732830047607
Epoch: 13, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.708 Vali Acc: 0.734 Test Loss: 0.708 Test Acc: 0.734
Validation loss decreased (-0.705194 --> -0.734097).  Saving model ...
Epoch: 14 cost time: 2.858045816421509
Epoch: 14, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.665 Vali Acc: 0.751 Test Loss: 0.665 Test Acc: 0.751
Validation loss decreased (-0.734097 --> -0.751438).  Saving model ...
Epoch: 15 cost time: 3.6426918506622314
Epoch: 15, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.632 Vali Acc: 0.757 Test Loss: 0.632 Test Acc: 0.757
Validation loss decreased (-0.751438 --> -0.757219).  Saving model ...
Epoch: 16 cost time: 3.1235849857330322
Epoch: 16, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.612 Vali Acc: 0.734 Test Loss: 0.612 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.800367593765259
Epoch: 17, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.591 Vali Acc: 0.769 Test Loss: 0.591 Test Acc: 0.769
Validation loss decreased (-0.757219 --> -0.768780).  Saving model ...
Epoch: 18 cost time: 3.4566843509674072
Epoch: 18, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.571 Vali Acc: 0.728 Test Loss: 0.571 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.253840208053589
Epoch: 19, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.656 Vali Acc: 0.728 Test Loss: 0.656 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7835991382598877
Epoch: 20, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.612 Vali Acc: 0.769 Test Loss: 0.612 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.4686853885650635
Epoch: 21, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.561 Vali Acc: 0.769 Test Loss: 0.561 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768781).  Saving model ...
Epoch: 22 cost time: 3.1316723823547363
Epoch: 22, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.532 Vali Acc: 0.780 Test Loss: 0.532 Test Acc: 0.780
Validation loss decreased (-0.768781 --> -0.780341).  Saving model ...
Epoch: 23 cost time: 3.1385128498077393
Epoch: 23, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
Validation loss decreased (-0.780341 --> -0.803463).  Saving model ...
Epoch: 24 cost time: 3.374525308609009
Epoch: 24, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.478 Vali Acc: 0.803 Test Loss: 0.478 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 25 cost time: 3.041581153869629
Epoch: 25, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.530 Vali Acc: 0.798 Test Loss: 0.530 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.317629337310791
Epoch: 26, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.518 Vali Acc: 0.786 Test Loss: 0.518 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.000188112258911
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.533 Vali Acc: 0.798 Test Loss: 0.533 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.0325870513916016
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.575 Vali Acc: 0.775 Test Loss: 0.575 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.966681480407715
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.566 Vali Acc: 0.763 Test Loss: 0.566 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.7442798614501953
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.535 Vali Acc: 0.815 Test Loss: 0.535 Test Acc: 0.815
Validation loss decreased (-0.803463 --> -0.815024).  Saving model ...
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 324671
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7623846530914307
Epoch: 1, Steps: 17 | Train Loss: 1.948 Vali Loss: 1.907 Vali Acc: 0.185 Test Loss: 1.907 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 1.854701042175293
Epoch: 2, Steps: 17 | Train Loss: 1.836 Vali Loss: 1.806 Vali Acc: 0.249 Test Loss: 1.806 Test Acc: 0.249
Validation loss decreased (-0.184952 --> -0.248537).  Saving model ...
Epoch: 3 cost time: 2.109083890914917
Epoch: 3, Steps: 17 | Train Loss: 1.714 Vali Loss: 1.684 Vali Acc: 0.301 Test Loss: 1.684 Test Acc: 0.301
Validation loss decreased (-0.248537 --> -0.300561).  Saving model ...
Epoch: 4 cost time: 2.7023422718048096
Epoch: 4, Steps: 17 | Train Loss: 1.586 Vali Loss: 1.543 Vali Acc: 0.399 Test Loss: 1.543 Test Acc: 0.399
Validation loss decreased (-0.300561 --> -0.398828).  Saving model ...
Epoch: 5 cost time: 2.5667409896850586
Epoch: 5, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.410 Vali Acc: 0.468 Test Loss: 1.410 Test Acc: 0.468
Validation loss decreased (-0.398828 --> -0.468194).  Saving model ...
Epoch: 6 cost time: 2.6108505725860596
Epoch: 6, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.306 Vali Acc: 0.555 Test Loss: 1.306 Test Acc: 0.555
Validation loss decreased (-0.468194 --> -0.554900).  Saving model ...
Epoch: 7 cost time: 2.440577507019043
Epoch: 7, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.228 Vali Acc: 0.578 Test Loss: 1.228 Test Acc: 0.578
Validation loss decreased (-0.554900 --> -0.578022).  Saving model ...
Epoch: 8 cost time: 2.7070674896240234
Epoch: 8, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.142 Vali Acc: 0.647 Test Loss: 1.142 Test Acc: 0.647
Validation loss decreased (-0.578022 --> -0.647387).  Saving model ...
Epoch: 9 cost time: 2.8014891147613525
Epoch: 9, Steps: 17 | Train Loss: 0.894 Vali Loss: 1.036 Vali Acc: 0.642 Test Loss: 1.036 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5014328956604004
Epoch: 10, Steps: 17 | Train Loss: 0.754 Vali Loss: 0.950 Vali Acc: 0.671 Test Loss: 0.950 Test Acc: 0.671
Validation loss decreased (-0.647387 --> -0.670511).  Saving model ...
Epoch: 11 cost time: 2.5145108699798584
Epoch: 11, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.911 Vali Acc: 0.671 Test Loss: 0.911 Test Acc: 0.671
Validation loss decreased (-0.670511 --> -0.670511).  Saving model ...
Epoch: 12 cost time: 2.5864176750183105
Epoch: 12, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.854 Vali Acc: 0.728 Test Loss: 0.854 Test Acc: 0.728
Validation loss decreased (-0.670511 --> -0.728315).  Saving model ...
Epoch: 13 cost time: 2.834613084793091
Epoch: 13, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.812 Vali Acc: 0.746 Test Loss: 0.812 Test Acc: 0.746
Validation loss decreased (-0.728315 --> -0.745657).  Saving model ...
Epoch: 14 cost time: 2.389864921569824
Epoch: 14, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.769 Vali Acc: 0.734 Test Loss: 0.769 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5800366401672363
Epoch: 15, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.674 Vali Acc: 0.751 Test Loss: 0.674 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751438).  Saving model ...
Epoch: 16 cost time: 2.601869583129883
Epoch: 16, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.721 Vali Acc: 0.751 Test Loss: 0.721 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.718219518661499
Epoch: 17, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.656 Vali Acc: 0.775 Test Loss: 0.656 Test Acc: 0.775
Validation loss decreased (-0.751438 --> -0.774560).  Saving model ...
Epoch: 18 cost time: 2.2632696628570557
Epoch: 18, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.629 Vali Acc: 0.775 Test Loss: 0.629 Test Acc: 0.775
Validation loss decreased (-0.774560 --> -0.774560).  Saving model ...
Epoch: 19 cost time: 2.5834856033325195
Epoch: 19, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.634 Vali Acc: 0.792 Test Loss: 0.634 Test Acc: 0.792
Validation loss decreased (-0.774560 --> -0.791901).  Saving model ...
Epoch: 20 cost time: 2.7545905113220215
Epoch: 20, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.618 Vali Acc: 0.775 Test Loss: 0.618 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7927050590515137
Epoch: 21, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.546260118484497
Epoch: 22, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.544 Vali Acc: 0.792 Test Loss: 0.544 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791902).  Saving model ...
Epoch: 23 cost time: 2.2298221588134766
Epoch: 23, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.611 Vali Acc: 0.769 Test Loss: 0.611 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.553739309310913
Epoch: 24, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
Validation loss decreased (-0.791902 --> -0.809243).  Saving model ...
Epoch: 25 cost time: 2.2916431427001953
Epoch: 25, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.560 Vali Acc: 0.786 Test Loss: 0.560 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2791905403137207
Epoch: 26, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 27 cost time: 2.368377923965454
Epoch: 27, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.600590229034424
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.3041021823883057
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.572 Vali Acc: 0.775 Test Loss: 0.572 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.362229824066162
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.546 Vali Acc: 0.786 Test Loss: 0.546 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 117631
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 38.70316457748413
Epoch: 1, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.603 Vali Acc: 0.266 Test Loss: 1.603 Test Acc: 0.266
Validation loss decreased (inf --> -0.265880).  Saving model ...
Epoch: 2 cost time: 35.114018201828
Epoch: 2, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.285 Vali Acc: 0.451 Test Loss: 1.285 Test Acc: 0.451
Validation loss decreased (-0.265880 --> -0.450854).  Saving model ...
Epoch: 3 cost time: 37.77717208862305
Epoch: 3, Steps: 17 | Train Loss: 0.911 Vali Loss: 0.898 Vali Acc: 0.659 Test Loss: 0.898 Test Acc: 0.659
Validation loss decreased (-0.450854 --> -0.658951).  Saving model ...
Epoch: 4 cost time: 31.959974765777588
Epoch: 4, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.824 Vali Acc: 0.630 Test Loss: 0.824 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 34.87314009666443
Epoch: 5, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
Validation loss decreased (-0.658951 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 36.16486954689026
Epoch: 6, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.706 Vali Acc: 0.746 Test Loss: 0.706 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 37.03748321533203
Epoch: 7, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.635 Vali Acc: 0.798 Test Loss: 0.635 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 34.05481672286987
Epoch: 8, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.655 Vali Acc: 0.769 Test Loss: 0.655 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 33.06945586204529
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.522 Vali Acc: 0.815 Test Loss: 0.522 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 10 cost time: 36.44209003448486
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.514 Vali Acc: 0.798 Test Loss: 0.514 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 32.69641971588135
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.815 Test Loss: 0.516 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 12 cost time: 35.60377287864685
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.827 Test Loss: 0.487 Test Acc: 0.827
Validation loss decreased (-0.815024 --> -0.826585).  Saving model ...
Epoch: 13 cost time: 32.20665621757507
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 35.343424797058105
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.827 Test Loss: 0.499 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 36.15387415885925
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.821 Test Loss: 0.499 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 35.629952907562256
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.821 Test Loss: 0.513 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 32.12808895111084
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.821 Test Loss: 0.513 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 32.59836411476135
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 37.42566275596619
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.821 Test Loss: 0.516 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 37.11564373970032
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.821 Test Loss: 0.531 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 38.05361485481262
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.821 Test Loss: 0.525 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 33.068986654281616
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 56736391
model size : 218.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.515115737915039
Epoch: 1, Steps: 17 | Train Loss: 1.831 Vali Loss: 1.619 Vali Acc: 0.295 Test Loss: 1.619 Test Acc: 0.295
Validation loss decreased (inf --> -0.294782).  Saving model ...
Epoch: 2 cost time: 11.77471923828125
Epoch: 2, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.135 Vali Acc: 0.572 Test Loss: 1.135 Test Acc: 0.572
Validation loss decreased (-0.294782 --> -0.572243).  Saving model ...
Epoch: 3 cost time: 12.770185708999634
Epoch: 3, Steps: 17 | Train Loss: 0.840 Vali Loss: 0.977 Vali Acc: 0.618 Test Loss: 0.977 Test Acc: 0.618
Validation loss decreased (-0.572243 --> -0.618487).  Saving model ...
Epoch: 4 cost time: 12.809359312057495
Epoch: 4, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.712 Vali Acc: 0.751 Test Loss: 0.712 Test Acc: 0.751
Validation loss decreased (-0.618487 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 12.853956460952759
Epoch: 5, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
Validation loss decreased (-0.751438 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 13.061920166015625
Epoch: 6, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.650 Vali Acc: 0.751 Test Loss: 0.650 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.784306049346924
Epoch: 7, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.457 Vali Acc: 0.803 Test Loss: 0.457 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.373755931854248
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.555 Vali Acc: 0.775 Test Loss: 0.555 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.609020709991455
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.537 Vali Acc: 0.815 Test Loss: 0.537 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 10 cost time: 12.128636121749878
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
Validation loss decreased (-0.815024 --> -0.843926).  Saving model ...
Epoch: 11 cost time: 12.033634662628174
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.821 Test Loss: 0.454 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.519777059555054
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.815 Test Loss: 0.422 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.355411529541016
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.815 Test Loss: 0.440 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 13.956071853637695
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.815 Test Loss: 0.463 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 13.583750486373901
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.815 Test Loss: 0.449 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 14.103687286376953
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.815 Test Loss: 0.445 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 13.093167781829834
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.815 Test Loss: 0.460 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.979661226272583
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.815 Test Loss: 0.456 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 12.77274775505066
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.809 Test Loss: 0.453 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 13.069183349609375
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.815 Test Loss: 0.465 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 17019271
model size : 67.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 30.73448419570923
Epoch: 1, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.603 Vali Acc: 0.266 Test Loss: 1.603 Test Acc: 0.266
Validation loss decreased (inf --> -0.265880).  Saving model ...
Epoch: 2 cost time: 29.61781644821167
Epoch: 2, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.285 Vali Acc: 0.451 Test Loss: 1.285 Test Acc: 0.451
Validation loss decreased (-0.265880 --> -0.450854).  Saving model ...
Epoch: 3 cost time: 29.67521071434021
Epoch: 3, Steps: 17 | Train Loss: 0.911 Vali Loss: 0.898 Vali Acc: 0.659 Test Loss: 0.898 Test Acc: 0.659
Validation loss decreased (-0.450854 --> -0.658951).  Saving model ...
Epoch: 4 cost time: 26.8947696685791
Epoch: 4, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.824 Vali Acc: 0.630 Test Loss: 0.824 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.827261209487915
Epoch: 5, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
Validation loss decreased (-0.658951 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 26.058767318725586
Epoch: 6, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.706 Vali Acc: 0.746 Test Loss: 0.706 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.872438430786133
Epoch: 7, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.635 Vali Acc: 0.798 Test Loss: 0.635 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 26.887386798858643
Epoch: 8, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.655 Vali Acc: 0.769 Test Loss: 0.655 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 27.63026237487793
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.522 Vali Acc: 0.815 Test Loss: 0.522 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 10 cost time: 24.37889075279236
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.514 Vali Acc: 0.798 Test Loss: 0.514 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.1917781829834
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.815 Test Loss: 0.516 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 12 cost time: 28.533284902572632
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.827 Test Loss: 0.487 Test Acc: 0.827
Validation loss decreased (-0.815024 --> -0.826585).  Saving model ...
Epoch: 13 cost time: 27.382174015045166
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 27.740769624710083
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.827 Test Loss: 0.499 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 27.4902925491333
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.821 Test Loss: 0.499 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 24.314860582351685
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.821 Test Loss: 0.513 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 25.828198671340942
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.821 Test Loss: 0.513 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 28.105552673339844
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 28.26776432991028
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.821 Test Loss: 0.516 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 26.043479442596436
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.821 Test Loss: 0.531 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 25.07360863685608
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.821 Test Loss: 0.525 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 22.753234148025513
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 56736391
model size : 218.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.882482290267944
Epoch: 1, Steps: 17 | Train Loss: 1.831 Vali Loss: 1.619 Vali Acc: 0.295 Test Loss: 1.619 Test Acc: 0.295
Validation loss decreased (inf --> -0.294782).  Saving model ...
Epoch: 2 cost time: 10.242924690246582
Epoch: 2, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.135 Vali Acc: 0.572 Test Loss: 1.135 Test Acc: 0.572
Validation loss decreased (-0.294782 --> -0.572243).  Saving model ...
Epoch: 3 cost time: 10.276989698410034
Epoch: 3, Steps: 17 | Train Loss: 0.840 Vali Loss: 0.977 Vali Acc: 0.618 Test Loss: 0.977 Test Acc: 0.618
Validation loss decreased (-0.572243 --> -0.618487).  Saving model ...
Epoch: 4 cost time: 10.291148662567139
Epoch: 4, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.712 Vali Acc: 0.751 Test Loss: 0.712 Test Acc: 0.751
Validation loss decreased (-0.618487 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 10.026967763900757
Epoch: 5, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
Validation loss decreased (-0.751438 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 10.656657934188843
Epoch: 6, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.650 Vali Acc: 0.751 Test Loss: 0.650 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.729257583618164
Epoch: 7, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.457 Vali Acc: 0.803 Test Loss: 0.457 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.076589107513428
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.555 Vali Acc: 0.775 Test Loss: 0.555 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.496095418930054
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.537 Vali Acc: 0.815 Test Loss: 0.537 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 10 cost time: 9.43468451499939
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
Validation loss decreased (-0.815024 --> -0.843926).  Saving model ...
Epoch: 11 cost time: 9.652637004852295
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.821 Test Loss: 0.454 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.327289819717407
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.815 Test Loss: 0.422 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.875612497329712
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.815 Test Loss: 0.440 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.830334901809692
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.815 Test Loss: 0.463 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.89809799194336
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.815 Test Loss: 0.449 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.578064918518066
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.815 Test Loss: 0.445 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.512480735778809
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.815 Test Loss: 0.460 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 9.195902347564697
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.815 Test Loss: 0.456 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.90375018119812
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.809 Test Loss: 0.453 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.950005054473877
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.815 Test Loss: 0.465 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 17019271
model size : 67.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.671727418899536
Epoch: 1, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.603 Vali Acc: 0.266 Test Loss: 1.603 Test Acc: 0.266
Validation loss decreased (inf --> -0.265880).  Saving model ...
Epoch: 2 cost time: 14.864614009857178
Epoch: 2, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.285 Vali Acc: 0.451 Test Loss: 1.285 Test Acc: 0.451
Validation loss decreased (-0.265880 --> -0.450854).  Saving model ...
Epoch: 3 cost time: 16.06097650527954
Epoch: 3, Steps: 17 | Train Loss: 0.911 Vali Loss: 0.898 Vali Acc: 0.659 Test Loss: 0.898 Test Acc: 0.659
Validation loss decreased (-0.450854 --> -0.658951).  Saving model ...
Epoch: 4 cost time: 15.110972166061401
Epoch: 4, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.824 Vali Acc: 0.630 Test Loss: 0.824 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.956480979919434
Epoch: 5, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
Validation loss decreased (-0.658951 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 17.48984956741333
Epoch: 6, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.706 Vali Acc: 0.746 Test Loss: 0.706 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.813815355300903
Epoch: 7, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.635 Vali Acc: 0.798 Test Loss: 0.635 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.549135208129883
Epoch: 8, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.655 Vali Acc: 0.769 Test Loss: 0.655 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.378283023834229
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.522 Vali Acc: 0.815 Test Loss: 0.522 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 10 cost time: 15.285474061965942
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.514 Vali Acc: 0.798 Test Loss: 0.514 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.651224613189697
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.815 Test Loss: 0.516 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 12 cost time: 13.970801591873169
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.827 Test Loss: 0.487 Test Acc: 0.827
Validation loss decreased (-0.815024 --> -0.826585).  Saving model ...
Epoch: 13 cost time: 17.85117220878601
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 17.496826648712158
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.827 Test Loss: 0.499 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 18.156931161880493
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.821 Test Loss: 0.499 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 18.076263189315796
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.821 Test Loss: 0.513 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 16.047214031219482
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.821 Test Loss: 0.513 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 16.768744945526123
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 16.844192028045654
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.821 Test Loss: 0.515 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 16.88432550430298
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.821 Test Loss: 0.530 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 16.929863452911377
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 14.86864686012268
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 56736391
model size : 218.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.390040874481201
Epoch: 1, Steps: 17 | Train Loss: 1.831 Vali Loss: 1.619 Vali Acc: 0.295 Test Loss: 1.619 Test Acc: 0.295
Validation loss decreased (inf --> -0.294782).  Saving model ...
Epoch: 2 cost time: 6.703096628189087
Epoch: 2, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.135 Vali Acc: 0.572 Test Loss: 1.135 Test Acc: 0.572
Validation loss decreased (-0.294782 --> -0.572243).  Saving model ...
Epoch: 3 cost time: 6.8144755363464355
Epoch: 3, Steps: 17 | Train Loss: 0.840 Vali Loss: 0.977 Vali Acc: 0.618 Test Loss: 0.977 Test Acc: 0.618
Validation loss decreased (-0.572243 --> -0.618487).  Saving model ...
Epoch: 4 cost time: 7.830229759216309
Epoch: 4, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.712 Vali Acc: 0.751 Test Loss: 0.712 Test Acc: 0.751
Validation loss decreased (-0.618487 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 7.656923770904541
Epoch: 5, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
Validation loss decreased (-0.751438 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 7.901341438293457
Epoch: 6, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.650 Vali Acc: 0.751 Test Loss: 0.650 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.977856874465942
Epoch: 7, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.457 Vali Acc: 0.803 Test Loss: 0.457 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.657539129257202
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.555 Vali Acc: 0.775 Test Loss: 0.555 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.116888761520386
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.537 Vali Acc: 0.815 Test Loss: 0.537 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 10 cost time: 8.045467138290405
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
Validation loss decreased (-0.815024 --> -0.843926).  Saving model ...
Epoch: 11 cost time: 8.041728734970093
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.821 Test Loss: 0.454 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.15217900276184
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.815 Test Loss: 0.422 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.834701776504517
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.815 Test Loss: 0.440 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.015226125717163
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.815 Test Loss: 0.463 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.815065622329712
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.815 Test Loss: 0.449 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.029447078704834
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.815 Test Loss: 0.445 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.074898719787598
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.815 Test Loss: 0.460 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.087713241577148
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.815 Test Loss: 0.456 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.840641021728516
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.809 Test Loss: 0.453 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.055501222610474
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.815 Test Loss: 0.465 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 17019271
model size : 67.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 19.37783908843994
Epoch: 1, Steps: 17 | Train Loss: 1.875 Vali Loss: 1.569 Vali Acc: 0.283 Test Loss: 1.569 Test Acc: 0.283
Validation loss decreased (inf --> -0.283221).  Saving model ...
Epoch: 2 cost time: 19.976508140563965
Epoch: 2, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.146 Vali Acc: 0.555 Test Loss: 1.146 Test Acc: 0.555
Validation loss decreased (-0.283221 --> -0.554902).  Saving model ...
Epoch: 3 cost time: 20.48939323425293
Epoch: 3, Steps: 17 | Train Loss: 0.844 Vali Loss: 0.934 Vali Acc: 0.624 Test Loss: 0.934 Test Acc: 0.624
Validation loss decreased (-0.554902 --> -0.624268).  Saving model ...
Epoch: 4 cost time: 20.42305088043213
Epoch: 4, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.831 Vali Acc: 0.647 Test Loss: 0.831 Test Acc: 0.647
Validation loss decreased (-0.624268 --> -0.647391).  Saving model ...
Epoch: 5 cost time: 20.60761260986328
Epoch: 5, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.583 Vali Acc: 0.786 Test Loss: 0.583 Test Acc: 0.786
Validation loss decreased (-0.647391 --> -0.786121).  Saving model ...
Epoch: 6 cost time: 20.72737193107605
Epoch: 6, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.842 Vali Acc: 0.705 Test Loss: 0.842 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.39834976196289
Epoch: 7, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.646 Vali Acc: 0.740 Test Loss: 0.646 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 21.47355055809021
Epoch: 8, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
Validation loss decreased (-0.786121 --> -0.809244).  Saving model ...
Epoch: 9 cost time: 21.147544145584106
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.512 Vali Acc: 0.763 Test Loss: 0.512 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.75091290473938
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.535 Vali Acc: 0.763 Test Loss: 0.535 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.513412475585938
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
Validation loss decreased (-0.809244 --> -0.849706).  Saving model ...
Epoch: 12 cost time: 19.24209690093994
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.792 Test Loss: 0.503 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 19.529345512390137
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.792 Test Loss: 0.491 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 19.625720024108887
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.780 Test Loss: 0.506 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 19.5558078289032
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.780 Test Loss: 0.521 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 19.861830234527588
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.780 Test Loss: 0.512 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 19.883617162704468
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.792 Test Loss: 0.528 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 22.788908004760742
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.780 Test Loss: 0.524 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 22.64599370956421
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.780 Test Loss: 0.520 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.576488971710205
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.792 Test Loss: 0.526 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 20.442242860794067
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.792 Test Loss: 0.539 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 28619143
model size : 111.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.16761302947998
Epoch: 1, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.544 Vali Acc: 0.324 Test Loss: 1.544 Test Acc: 0.324
Validation loss decreased (inf --> -0.323684).  Saving model ...
Epoch: 2 cost time: 9.19985032081604
Epoch: 2, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.203 Vali Acc: 0.474 Test Loss: 1.203 Test Acc: 0.474
Validation loss decreased (-0.323684 --> -0.473976).  Saving model ...
Epoch: 3 cost time: 9.14062786102295
Epoch: 3, Steps: 17 | Train Loss: 0.914 Vali Loss: 0.917 Vali Acc: 0.694 Test Loss: 0.917 Test Acc: 0.694
Validation loss decreased (-0.473976 --> -0.693632).  Saving model ...
Epoch: 4 cost time: 9.174854755401611
Epoch: 4, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.777 Vali Acc: 0.711 Test Loss: 0.777 Test Acc: 0.711
Validation loss decreased (-0.693632 --> -0.710975).  Saving model ...
Epoch: 5 cost time: 9.086397886276245
Epoch: 5, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.615 Vali Acc: 0.792 Test Loss: 0.615 Test Acc: 0.792
Validation loss decreased (-0.710975 --> -0.791901).  Saving model ...
Epoch: 6 cost time: 9.222384214401245
Epoch: 6, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.934653282165527
Epoch: 7, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.522 Vali Acc: 0.792 Test Loss: 0.522 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791902).  Saving model ...
Epoch: 8 cost time: 9.26936388015747
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 9 cost time: 9.057897567749023
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
Validation loss decreased (-0.803463 --> -0.815023).  Saving model ...
Epoch: 10 cost time: 9.411892890930176
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.665 Vali Acc: 0.775 Test Loss: 0.665 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.96517276763916
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.658 Vali Acc: 0.780 Test Loss: 0.658 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.752541065216064
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.775 Test Loss: 0.546 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.749269962310791
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
Validation loss decreased (-0.815023 --> -0.838145).  Saving model ...
Epoch: 14 cost time: 8.819350242614746
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.815 Test Loss: 0.512 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.789662837982178
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.8600914478302
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.827 Test Loss: 0.535 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.947495460510254
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.821 Test Loss: 0.530 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.973217964172363
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.827 Test Loss: 0.545 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.967160940170288
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.827 Test Loss: 0.550 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.020731210708618
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.821 Test Loss: 0.551 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.035115718841553
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.821 Test Loss: 0.553 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.917549133300781
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.821 Test Loss: 0.554 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.712278366088867
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.821 Test Loss: 0.555 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 8760199
model size : 35.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.23416781425476
Epoch: 1, Steps: 17 | Train Loss: 1.875 Vali Loss: 1.569 Vali Acc: 0.283 Test Loss: 1.569 Test Acc: 0.283
Validation loss decreased (inf --> -0.283221).  Saving model ...
Epoch: 2 cost time: 16.532970666885376
Epoch: 2, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.146 Vali Acc: 0.555 Test Loss: 1.146 Test Acc: 0.555
Validation loss decreased (-0.283221 --> -0.554902).  Saving model ...
Epoch: 3 cost time: 16.578014135360718
Epoch: 3, Steps: 17 | Train Loss: 0.844 Vali Loss: 0.934 Vali Acc: 0.624 Test Loss: 0.934 Test Acc: 0.624
Validation loss decreased (-0.554902 --> -0.624268).  Saving model ...
Epoch: 4 cost time: 16.832304000854492
Epoch: 4, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.831 Vali Acc: 0.647 Test Loss: 0.831 Test Acc: 0.647
Validation loss decreased (-0.624268 --> -0.647391).  Saving model ...
Epoch: 5 cost time: 16.880627870559692
Epoch: 5, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.583 Vali Acc: 0.786 Test Loss: 0.583 Test Acc: 0.786
Validation loss decreased (-0.647391 --> -0.786121).  Saving model ...
Epoch: 6 cost time: 17.109167098999023
Epoch: 6, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.842 Vali Acc: 0.705 Test Loss: 0.842 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 16.98133397102356
Epoch: 7, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.646 Vali Acc: 0.740 Test Loss: 0.646 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.5272798538208
Epoch: 8, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
Validation loss decreased (-0.786121 --> -0.809244).  Saving model ...
Epoch: 9 cost time: 15.421111345291138
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.512 Vali Acc: 0.763 Test Loss: 0.512 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.170169353485107
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.535 Vali Acc: 0.763 Test Loss: 0.535 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.377726554870605
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
Validation loss decreased (-0.809244 --> -0.849706).  Saving model ...
Epoch: 12 cost time: 15.587247610092163
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.792 Test Loss: 0.503 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.522769927978516
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.792 Test Loss: 0.491 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.522512197494507
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.780 Test Loss: 0.506 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.512176752090454
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.780 Test Loss: 0.521 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 15.155871868133545
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.780 Test Loss: 0.512 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 15.009591579437256
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.792 Test Loss: 0.528 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 14.778214693069458
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.780 Test Loss: 0.524 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 15.730753898620605
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.780 Test Loss: 0.520 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 15.892946004867554
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.792 Test Loss: 0.526 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.884512901306152
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.792 Test Loss: 0.539 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 28619143
model size : 111.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.707911014556885
Epoch: 1, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.544 Vali Acc: 0.324 Test Loss: 1.544 Test Acc: 0.324
Validation loss decreased (inf --> -0.323684).  Saving model ...
Epoch: 2 cost time: 6.316131830215454
Epoch: 2, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.203 Vali Acc: 0.474 Test Loss: 1.203 Test Acc: 0.474
Validation loss decreased (-0.323684 --> -0.473976).  Saving model ...
Epoch: 3 cost time: 6.338271856307983
Epoch: 3, Steps: 17 | Train Loss: 0.914 Vali Loss: 0.917 Vali Acc: 0.694 Test Loss: 0.917 Test Acc: 0.694
Validation loss decreased (-0.473976 --> -0.693632).  Saving model ...
Epoch: 4 cost time: 5.758901834487915
Epoch: 4, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.777 Vali Acc: 0.711 Test Loss: 0.777 Test Acc: 0.711
Validation loss decreased (-0.693632 --> -0.710975).  Saving model ...
Epoch: 5 cost time: 6.931289196014404
Epoch: 5, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.615 Vali Acc: 0.792 Test Loss: 0.615 Test Acc: 0.792
Validation loss decreased (-0.710975 --> -0.791901).  Saving model ...
Epoch: 6 cost time: 7.019453763961792
Epoch: 6, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.989152669906616
Epoch: 7, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.522 Vali Acc: 0.792 Test Loss: 0.522 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791902).  Saving model ...
Epoch: 8 cost time: 6.467050552368164
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 9 cost time: 6.686061143875122
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
Validation loss decreased (-0.803463 --> -0.815023).  Saving model ...
Epoch: 10 cost time: 6.679875373840332
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.665 Vali Acc: 0.775 Test Loss: 0.665 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.7389817237854
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.658 Vali Acc: 0.780 Test Loss: 0.658 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.6719982624053955
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.775 Test Loss: 0.546 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.734358787536621
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
Validation loss decreased (-0.815023 --> -0.838145).  Saving model ...
Epoch: 14 cost time: 6.6897077560424805
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.815 Test Loss: 0.512 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.703307867050171
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.803416967391968
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.827 Test Loss: 0.535 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.593713998794556
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.821 Test Loss: 0.530 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.600171804428101
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.827 Test Loss: 0.545 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.613984107971191
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.827 Test Loss: 0.550 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.2524285316467285
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.821 Test Loss: 0.551 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.229716777801514
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.821 Test Loss: 0.553 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.928299903869629
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.821 Test Loss: 0.554 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.8131256103515625
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.821 Test Loss: 0.555 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 8760199
model size : 35.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.832310438156128
Epoch: 1, Steps: 17 | Train Loss: 1.875 Vali Loss: 1.569 Vali Acc: 0.283 Test Loss: 1.569 Test Acc: 0.283
Validation loss decreased (inf --> -0.283221).  Saving model ...
Epoch: 2 cost time: 9.385745525360107
Epoch: 2, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.146 Vali Acc: 0.555 Test Loss: 1.146 Test Acc: 0.555
Validation loss decreased (-0.283221 --> -0.554902).  Saving model ...
Epoch: 3 cost time: 9.453141450881958
Epoch: 3, Steps: 17 | Train Loss: 0.844 Vali Loss: 0.934 Vali Acc: 0.624 Test Loss: 0.934 Test Acc: 0.624
Validation loss decreased (-0.554902 --> -0.624268).  Saving model ...
Epoch: 4 cost time: 10.533722877502441
Epoch: 4, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.831 Vali Acc: 0.647 Test Loss: 0.831 Test Acc: 0.647
Validation loss decreased (-0.624268 --> -0.647391).  Saving model ...
Epoch: 5 cost time: 10.634355068206787
Epoch: 5, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.583 Vali Acc: 0.786 Test Loss: 0.583 Test Acc: 0.786
Validation loss decreased (-0.647391 --> -0.786121).  Saving model ...
Epoch: 6 cost time: 10.563964128494263
Epoch: 6, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.842 Vali Acc: 0.705 Test Loss: 0.842 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.592601776123047
Epoch: 7, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.646 Vali Acc: 0.740 Test Loss: 0.646 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.603991508483887
Epoch: 8, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
Validation loss decreased (-0.786121 --> -0.809244).  Saving model ...
Epoch: 9 cost time: 10.58556866645813
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.512 Vali Acc: 0.763 Test Loss: 0.512 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.609955310821533
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.535 Vali Acc: 0.763 Test Loss: 0.535 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.665599822998047
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
Validation loss decreased (-0.809244 --> -0.849706).  Saving model ...
Epoch: 12 cost time: 10.350196361541748
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.792 Test Loss: 0.503 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.622426509857178
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.792 Test Loss: 0.491 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.03902292251587
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.780 Test Loss: 0.506 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.861500978469849
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.780 Test Loss: 0.521 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.885411977767944
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.780 Test Loss: 0.512 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 9.86504864692688
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.792 Test Loss: 0.528 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.76409363746643
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.780 Test Loss: 0.524 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.748805522918701
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.780 Test Loss: 0.520 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.602050304412842
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.792 Test Loss: 0.526 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.76481318473816
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.792 Test Loss: 0.538 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 28619143
model size : 111.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.210860013961792
Epoch: 1, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.544 Vali Acc: 0.324 Test Loss: 1.544 Test Acc: 0.324
Validation loss decreased (inf --> -0.323684).  Saving model ...
Epoch: 2 cost time: 4.352949857711792
Epoch: 2, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.203 Vali Acc: 0.474 Test Loss: 1.203 Test Acc: 0.474
Validation loss decreased (-0.323684 --> -0.473976).  Saving model ...
Epoch: 3 cost time: 4.717731952667236
Epoch: 3, Steps: 17 | Train Loss: 0.914 Vali Loss: 0.917 Vali Acc: 0.694 Test Loss: 0.917 Test Acc: 0.694
Validation loss decreased (-0.473976 --> -0.693632).  Saving model ...
Epoch: 4 cost time: 4.97167181968689
Epoch: 4, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.777 Vali Acc: 0.711 Test Loss: 0.777 Test Acc: 0.711
Validation loss decreased (-0.693632 --> -0.710975).  Saving model ...
Epoch: 5 cost time: 4.99636173248291
Epoch: 5, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.615 Vali Acc: 0.792 Test Loss: 0.615 Test Acc: 0.792
Validation loss decreased (-0.710975 --> -0.791901).  Saving model ...
Epoch: 6 cost time: 4.8581531047821045
Epoch: 6, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.963287591934204
Epoch: 7, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.522 Vali Acc: 0.792 Test Loss: 0.522 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791902).  Saving model ...
Epoch: 8 cost time: 5.034459352493286
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 9 cost time: 4.85496973991394
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
Validation loss decreased (-0.803463 --> -0.815023).  Saving model ...
Epoch: 10 cost time: 4.984452962875366
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.665 Vali Acc: 0.775 Test Loss: 0.665 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.968076705932617
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.658 Vali Acc: 0.780 Test Loss: 0.658 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.8605804443359375
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.775 Test Loss: 0.546 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.959181785583496
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
Validation loss decreased (-0.815023 --> -0.838145).  Saving model ...
Epoch: 14 cost time: 5.020752429962158
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.815 Test Loss: 0.512 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.94504451751709
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.942351579666138
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.827 Test Loss: 0.535 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.072608709335327
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.821 Test Loss: 0.530 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.937896013259888
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.827 Test Loss: 0.545 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.508084535598755
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.827 Test Loss: 0.550 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.037327527999878
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.821 Test Loss: 0.551 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.090080261230469
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.821 Test Loss: 0.553 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.820542573928833
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.821 Test Loss: 0.554 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.455098628997803
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.821 Test Loss: 0.555 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 8760199
model size : 35.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.226744890213013
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.716 Vali Acc: 0.260 Test Loss: 1.716 Test Acc: 0.260
Validation loss decreased (inf --> -0.260098).  Saving model ...
Epoch: 2 cost time: 20.736552238464355
Epoch: 2, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.405 Vali Acc: 0.451 Test Loss: 1.405 Test Acc: 0.451
Validation loss decreased (-0.260098 --> -0.450853).  Saving model ...
Epoch: 3 cost time: 21.66340208053589
Epoch: 3, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.155 Vali Acc: 0.497 Test Loss: 1.155 Test Acc: 0.497
Validation loss decreased (-0.450853 --> -0.497098).  Saving model ...
Epoch: 4 cost time: 21.814473867416382
Epoch: 4, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.963 Vali Acc: 0.624 Test Loss: 0.963 Test Acc: 0.624
Validation loss decreased (-0.497098 --> -0.624268).  Saving model ...
Epoch: 5 cost time: 22.743484020233154
Epoch: 5, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.659 Vali Acc: 0.832 Test Loss: 0.659 Test Acc: 0.832
Validation loss decreased (-0.624268 --> -0.832363).  Saving model ...
Epoch: 6 cost time: 22.722463607788086
Epoch: 6, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.633 Vali Acc: 0.757 Test Loss: 0.633 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.5273699760437
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.625 Vali Acc: 0.798 Test Loss: 0.625 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 23.682931423187256
Epoch: 8, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.695 Vali Acc: 0.699 Test Loss: 0.695 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 21.41783332824707
Epoch: 9, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.482 Vali Acc: 0.815 Test Loss: 0.482 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 21.18668842315674
Epoch: 10, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.454 Vali Acc: 0.838 Test Loss: 0.454 Test Acc: 0.838
Validation loss decreased (-0.832363 --> -0.838146).  Saving model ...
Epoch: 11 cost time: 20.990124702453613
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.440 Vali Acc: 0.832 Test Loss: 0.440 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.503411054611206
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.441 Vali Acc: 0.809 Test Loss: 0.441 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 22.578609228134155
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.432 Vali Acc: 0.838 Test Loss: 0.432 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 14 cost time: 22.628687858581543
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.838 Test Loss: 0.419 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 15 cost time: 22.834832191467285
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.439 Vali Acc: 0.844 Test Loss: 0.439 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 16 cost time: 24.763102054595947
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.832 Test Loss: 0.444 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.647722721099854
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849707).  Saving model ...
Epoch: 18 cost time: 22.80753231048584
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.838 Test Loss: 0.451 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 22.223067045211792
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 21.796048641204834
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 24.284353494644165
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.838 Test Loss: 0.463 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 21.944926023483276
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 22.617564916610718
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.844 Test Loss: 0.454 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 22.62458372116089
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.844 Test Loss: 0.456 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 22.905736446380615
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 22.960485696792603
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 22.268205881118774
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.838 Test Loss: 0.472 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 28370503
model size : 109.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.667725324630737
Epoch: 1, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.678 Vali Acc: 0.254 Test Loss: 1.678 Test Acc: 0.254
Validation loss decreased (inf --> -0.254318).  Saving model ...
Epoch: 2 cost time: 8.824869871139526
Epoch: 2, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.280 Vali Acc: 0.561 Test Loss: 1.280 Test Acc: 0.561
Validation loss decreased (-0.254318 --> -0.560681).  Saving model ...
Epoch: 3 cost time: 9.539655447006226
Epoch: 3, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.022 Vali Acc: 0.642 Test Loss: 1.022 Test Acc: 0.642
Validation loss decreased (-0.560681 --> -0.641608).  Saving model ...
Epoch: 4 cost time: 9.854108333587646
Epoch: 4, Steps: 17 | Train Loss: 0.798 Vali Loss: 0.810 Vali Acc: 0.746 Test Loss: 0.810 Test Acc: 0.746
Validation loss decreased (-0.641608 --> -0.745657).  Saving model ...
Epoch: 5 cost time: 9.778148651123047
Epoch: 5, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.669 Vali Acc: 0.763 Test Loss: 0.669 Test Acc: 0.763
Validation loss decreased (-0.745657 --> -0.762999).  Saving model ...
Epoch: 6 cost time: 9.735961437225342
Epoch: 6, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.629 Vali Acc: 0.740 Test Loss: 0.629 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.833528280258179
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.527 Vali Acc: 0.798 Test Loss: 0.527 Test Acc: 0.798
Validation loss decreased (-0.762999 --> -0.797683).  Saving model ...
Epoch: 8 cost time: 10.002006530761719
Epoch: 8, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
Validation loss decreased (-0.797683 --> -0.803463).  Saving model ...
Epoch: 9 cost time: 9.493007183074951
Epoch: 9, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.433 Vali Acc: 0.821 Test Loss: 0.433 Test Acc: 0.821
Validation loss decreased (-0.803463 --> -0.820805).  Saving model ...
Epoch: 10 cost time: 9.562412977218628
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.414 Vali Acc: 0.832 Test Loss: 0.414 Test Acc: 0.832
Validation loss decreased (-0.820805 --> -0.832366).  Saving model ...
Epoch: 11 cost time: 9.46794843673706
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.483 Vali Acc: 0.827 Test Loss: 0.483 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.695828676223755
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.399 Vali Acc: 0.798 Test Loss: 0.399 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.743555068969727
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.411 Vali Acc: 0.838 Test Loss: 0.411 Test Acc: 0.838
Validation loss decreased (-0.832366 --> -0.838146).  Saving model ...
Epoch: 14 cost time: 9.86826753616333
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.419 Vali Acc: 0.815 Test Loss: 0.419 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.971107006072998
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.427 Vali Acc: 0.838 Test Loss: 0.427 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.50068712234497
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.408 Vali Acc: 0.838 Test Loss: 0.408 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 17 cost time: 8.917551517486572
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
Validation loss decreased (-0.838146 --> -0.849707).  Saving model ...
Epoch: 18 cost time: 9.042996406555176
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.809 Test Loss: 0.424 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.713572263717651
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.239108800888062
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 9.564414024353027
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.838 Test Loss: 0.430 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 10.11552095413208
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.832 Test Loss: 0.437 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 10.166579961776733
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.832 Test Loss: 0.434 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 10.1989426612854
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 10.166604995727539
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.838 Test Loss: 0.434 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 10.107720375061035
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.832 Test Loss: 0.442 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 10.05106234550476
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.443 Vali Acc: 0.832 Test Loss: 0.443 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 8511175
model size : 33.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.456414222717285
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.716 Vali Acc: 0.260 Test Loss: 1.716 Test Acc: 0.260
Validation loss decreased (inf --> -0.260098).  Saving model ...
Epoch: 2 cost time: 16.703325033187866
Epoch: 2, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.405 Vali Acc: 0.451 Test Loss: 1.405 Test Acc: 0.451
Validation loss decreased (-0.260098 --> -0.450853).  Saving model ...
Epoch: 3 cost time: 16.740618467330933
Epoch: 3, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.155 Vali Acc: 0.497 Test Loss: 1.155 Test Acc: 0.497
Validation loss decreased (-0.450853 --> -0.497098).  Saving model ...
Epoch: 4 cost time: 14.961644411087036
Epoch: 4, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.963 Vali Acc: 0.624 Test Loss: 0.963 Test Acc: 0.624
Validation loss decreased (-0.497098 --> -0.624268).  Saving model ...
Epoch: 5 cost time: 15.127339363098145
Epoch: 5, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.659 Vali Acc: 0.832 Test Loss: 0.659 Test Acc: 0.832
Validation loss decreased (-0.624268 --> -0.832363).  Saving model ...
Epoch: 6 cost time: 15.804936408996582
Epoch: 6, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.633 Vali Acc: 0.757 Test Loss: 0.633 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.513217210769653
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.625 Vali Acc: 0.798 Test Loss: 0.625 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 18.50892186164856
Epoch: 8, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.695 Vali Acc: 0.699 Test Loss: 0.695 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 18.540214776992798
Epoch: 9, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.482 Vali Acc: 0.815 Test Loss: 0.482 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 18.177431344985962
Epoch: 10, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.454 Vali Acc: 0.838 Test Loss: 0.454 Test Acc: 0.838
Validation loss decreased (-0.832363 --> -0.838146).  Saving model ...
Epoch: 11 cost time: 18.215413570404053
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.440 Vali Acc: 0.832 Test Loss: 0.440 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 18.016019105911255
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.441 Vali Acc: 0.809 Test Loss: 0.441 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 18.011955976486206
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.432 Vali Acc: 0.838 Test Loss: 0.432 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 14 cost time: 16.475574493408203
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.838 Test Loss: 0.419 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 15 cost time: 16.913079261779785
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.439 Vali Acc: 0.844 Test Loss: 0.439 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 16 cost time: 15.110802173614502
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.832 Test Loss: 0.444 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 15.23894214630127
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849707).  Saving model ...
Epoch: 18 cost time: 15.392794370651245
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.838 Test Loss: 0.451 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 17.356669425964355
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 17.169416427612305
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 17.65195369720459
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.838 Test Loss: 0.463 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 18.096515893936157
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 18.075871229171753
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.844 Test Loss: 0.454 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 17.918864488601685
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.844 Test Loss: 0.456 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 17.79615569114685
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 18.122373819351196
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 17.616681337356567
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.838 Test Loss: 0.472 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 28370503
model size : 109.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.079195022583008
Epoch: 1, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.678 Vali Acc: 0.254 Test Loss: 1.678 Test Acc: 0.254
Validation loss decreased (inf --> -0.254318).  Saving model ...
Epoch: 2 cost time: 6.87641453742981
Epoch: 2, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.280 Vali Acc: 0.561 Test Loss: 1.280 Test Acc: 0.561
Validation loss decreased (-0.254318 --> -0.560681).  Saving model ...
Epoch: 3 cost time: 6.64339804649353
Epoch: 3, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.022 Vali Acc: 0.642 Test Loss: 1.022 Test Acc: 0.642
Validation loss decreased (-0.560681 --> -0.641608).  Saving model ...
Epoch: 4 cost time: 7.796367883682251
Epoch: 4, Steps: 17 | Train Loss: 0.798 Vali Loss: 0.810 Vali Acc: 0.746 Test Loss: 0.810 Test Acc: 0.746
Validation loss decreased (-0.641608 --> -0.745657).  Saving model ...
Epoch: 5 cost time: 7.65968132019043
Epoch: 5, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.669 Vali Acc: 0.763 Test Loss: 0.669 Test Acc: 0.763
Validation loss decreased (-0.745657 --> -0.762999).  Saving model ...
Epoch: 6 cost time: 7.670709133148193
Epoch: 6, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.629 Vali Acc: 0.740 Test Loss: 0.629 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.537171840667725
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.527 Vali Acc: 0.798 Test Loss: 0.527 Test Acc: 0.798
Validation loss decreased (-0.762999 --> -0.797683).  Saving model ...
Epoch: 8 cost time: 7.621862411499023
Epoch: 8, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
Validation loss decreased (-0.797683 --> -0.803463).  Saving model ...
Epoch: 9 cost time: 7.604828119277954
Epoch: 9, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.433 Vali Acc: 0.821 Test Loss: 0.433 Test Acc: 0.821
Validation loss decreased (-0.803463 --> -0.820805).  Saving model ...
Epoch: 10 cost time: 7.635779619216919
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.414 Vali Acc: 0.832 Test Loss: 0.414 Test Acc: 0.832
Validation loss decreased (-0.820805 --> -0.832366).  Saving model ...
Epoch: 11 cost time: 7.637694835662842
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.483 Vali Acc: 0.827 Test Loss: 0.483 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.299799919128418
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.399 Vali Acc: 0.798 Test Loss: 0.399 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.834123373031616
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.411 Vali Acc: 0.838 Test Loss: 0.411 Test Acc: 0.838
Validation loss decreased (-0.832366 --> -0.838146).  Saving model ...
Epoch: 14 cost time: 7.899953842163086
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.419 Vali Acc: 0.815 Test Loss: 0.419 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.9533069133758545
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.427 Vali Acc: 0.838 Test Loss: 0.427 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.856451511383057
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.408 Vali Acc: 0.838 Test Loss: 0.408 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 17 cost time: 7.759212493896484
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
Validation loss decreased (-0.838146 --> -0.849707).  Saving model ...
Epoch: 18 cost time: 7.755980730056763
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.809 Test Loss: 0.424 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.799914360046387
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.270632743835449
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.867851972579956
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.838 Test Loss: 0.430 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.025821208953857
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.832 Test Loss: 0.437 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.919981956481934
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.832 Test Loss: 0.434 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.438438415527344
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.714154958724976
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.838 Test Loss: 0.434 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.265594959259033
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.832 Test Loss: 0.442 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 7.533415794372559
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.443 Vali Acc: 0.832 Test Loss: 0.443 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 8511175
model size : 33.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.635512828826904
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.716 Vali Acc: 0.260 Test Loss: 1.716 Test Acc: 0.260
Validation loss decreased (inf --> -0.260098).  Saving model ...
Epoch: 2 cost time: 10.944116115570068
Epoch: 2, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.405 Vali Acc: 0.451 Test Loss: 1.405 Test Acc: 0.451
Validation loss decreased (-0.260098 --> -0.450853).  Saving model ...
Epoch: 3 cost time: 10.907248735427856
Epoch: 3, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.155 Vali Acc: 0.497 Test Loss: 1.155 Test Acc: 0.497
Validation loss decreased (-0.450853 --> -0.497098).  Saving model ...
Epoch: 4 cost time: 10.910853862762451
Epoch: 4, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.963 Vali Acc: 0.624 Test Loss: 0.963 Test Acc: 0.624
Validation loss decreased (-0.497098 --> -0.624268).  Saving model ...
Epoch: 5 cost time: 10.42526626586914
Epoch: 5, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.659 Vali Acc: 0.832 Test Loss: 0.659 Test Acc: 0.832
Validation loss decreased (-0.624268 --> -0.832363).  Saving model ...
Epoch: 6 cost time: 11.22406268119812
Epoch: 6, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.633 Vali Acc: 0.757 Test Loss: 0.633 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.308258533477783
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.625 Vali Acc: 0.798 Test Loss: 0.625 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.474228143692017
Epoch: 8, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.695 Vali Acc: 0.699 Test Loss: 0.695 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.387535333633423
Epoch: 9, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.482 Vali Acc: 0.815 Test Loss: 0.482 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.251530647277832
Epoch: 10, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.454 Vali Acc: 0.838 Test Loss: 0.454 Test Acc: 0.838
Validation loss decreased (-0.832363 --> -0.838146).  Saving model ...
Epoch: 11 cost time: 10.064688205718994
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.440 Vali Acc: 0.832 Test Loss: 0.440 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.975444316864014
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.441 Vali Acc: 0.809 Test Loss: 0.441 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.064378023147583
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.838 Test Loss: 0.431 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 14 cost time: 10.101926326751709
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.838 Test Loss: 0.419 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 15 cost time: 11.178622961044312
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.439 Vali Acc: 0.844 Test Loss: 0.439 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 16 cost time: 10.039844036102295
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.832 Test Loss: 0.444 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.681274890899658
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849707).  Saving model ...
Epoch: 18 cost time: 10.743268489837646
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.838 Test Loss: 0.451 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.695053100585938
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.443 Vali Acc: 0.844 Test Loss: 0.443 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 10.920426845550537
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.948429822921753
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.838 Test Loss: 0.463 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 11.093876123428345
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 10.898570537567139
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.844 Test Loss: 0.454 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 10.913226842880249
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.844 Test Loss: 0.456 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 11.013392925262451
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 10.566004514694214
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 11.160213470458984
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.838 Test Loss: 0.472 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 28370503
model size : 109.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.311561584472656
Epoch: 1, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.678 Vali Acc: 0.254 Test Loss: 1.678 Test Acc: 0.254
Validation loss decreased (inf --> -0.254318).  Saving model ...
Epoch: 2 cost time: 4.785156726837158
Epoch: 2, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.280 Vali Acc: 0.561 Test Loss: 1.280 Test Acc: 0.561
Validation loss decreased (-0.254318 --> -0.560681).  Saving model ...
Epoch: 3 cost time: 4.851958751678467
Epoch: 3, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.022 Vali Acc: 0.642 Test Loss: 1.022 Test Acc: 0.642
Validation loss decreased (-0.560681 --> -0.641608).  Saving model ...
Epoch: 4 cost time: 4.7686827182769775
Epoch: 4, Steps: 17 | Train Loss: 0.798 Vali Loss: 0.810 Vali Acc: 0.746 Test Loss: 0.810 Test Acc: 0.746
Validation loss decreased (-0.641608 --> -0.745657).  Saving model ...
Epoch: 5 cost time: 4.77239727973938
Epoch: 5, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.669 Vali Acc: 0.763 Test Loss: 0.669 Test Acc: 0.763
Validation loss decreased (-0.745657 --> -0.762999).  Saving model ...
Epoch: 6 cost time: 5.289041519165039
Epoch: 6, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.629 Vali Acc: 0.740 Test Loss: 0.629 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.349226474761963
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.527 Vali Acc: 0.798 Test Loss: 0.527 Test Acc: 0.798
Validation loss decreased (-0.762999 --> -0.797683).  Saving model ...
Epoch: 8 cost time: 5.289759159088135
Epoch: 8, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
Validation loss decreased (-0.797683 --> -0.803463).  Saving model ...
Epoch: 9 cost time: 5.315429925918579
Epoch: 9, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.433 Vali Acc: 0.821 Test Loss: 0.433 Test Acc: 0.821
Validation loss decreased (-0.803463 --> -0.820805).  Saving model ...
Epoch: 10 cost time: 5.194488286972046
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.414 Vali Acc: 0.832 Test Loss: 0.414 Test Acc: 0.832
Validation loss decreased (-0.820805 --> -0.832366).  Saving model ...
Epoch: 11 cost time: 5.273335695266724
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.482 Vali Acc: 0.827 Test Loss: 0.482 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.351595878601074
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.399 Vali Acc: 0.798 Test Loss: 0.399 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.276186466217041
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.411 Vali Acc: 0.838 Test Loss: 0.411 Test Acc: 0.838
Validation loss decreased (-0.832366 --> -0.838146).  Saving model ...
Epoch: 14 cost time: 4.894787549972534
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.419 Vali Acc: 0.815 Test Loss: 0.419 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.987984895706177
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.427 Vali Acc: 0.838 Test Loss: 0.427 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.0403971672058105
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.408 Vali Acc: 0.838 Test Loss: 0.408 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 17 cost time: 5.081238508224487
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
Validation loss decreased (-0.838146 --> -0.849707).  Saving model ...
Epoch: 18 cost time: 5.021195888519287
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.426 Vali Acc: 0.809 Test Loss: 0.426 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.093765497207642
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.844 Test Loss: 0.425 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.125338554382324
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.091968774795532
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.838 Test Loss: 0.430 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.19999361038208
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.832 Test Loss: 0.436 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.15151047706604
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.832 Test Loss: 0.435 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.158335208892822
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.844 Test Loss: 0.448 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.1425535678863525
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.838 Test Loss: 0.434 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.096507549285889
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.832 Test Loss: 0.444 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.174436330795288
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.832 Test Loss: 0.444 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 8511175
model size : 33.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.425156593322754
Epoch: 1, Steps: 17 | Train Loss: 1.955 Vali Loss: 1.788 Vali Acc: 0.260 Test Loss: 1.788 Test Acc: 0.260
Validation loss decreased (inf --> -0.260098).  Saving model ...
Epoch: 2 cost time: 12.338226795196533
Epoch: 2, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.388 Vali Acc: 0.457 Test Loss: 1.388 Test Acc: 0.457
Validation loss decreased (-0.260098 --> -0.456634).  Saving model ...
Epoch: 3 cost time: 12.178212642669678
Epoch: 3, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.114 Vali Acc: 0.566 Test Loss: 1.114 Test Acc: 0.566
Validation loss decreased (-0.456634 --> -0.566463).  Saving model ...
Epoch: 4 cost time: 13.687538385391235
Epoch: 4, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.996 Vali Acc: 0.647 Test Loss: 0.996 Test Acc: 0.647
Validation loss decreased (-0.566463 --> -0.647389).  Saving model ...
Epoch: 5 cost time: 13.575589895248413
Epoch: 5, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.707 Vali Acc: 0.827 Test Loss: 0.707 Test Acc: 0.827
Validation loss decreased (-0.647389 --> -0.826583).  Saving model ...
Epoch: 6 cost time: 13.56799030303955
Epoch: 6, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.650 Vali Acc: 0.780 Test Loss: 0.650 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.403203964233398
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.533 Vali Acc: 0.792 Test Loss: 0.533 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.167319297790527
Epoch: 8, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.660 Vali Acc: 0.769 Test Loss: 0.660 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.097910642623901
Epoch: 9, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.567 Vali Acc: 0.786 Test Loss: 0.567 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.120298147201538
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.507 Vali Acc: 0.832 Test Loss: 0.507 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832365).  Saving model ...
Epoch: 11 cost time: 13.066381454467773
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.481 Vali Acc: 0.798 Test Loss: 0.481 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.868549108505249
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.568 Vali Acc: 0.815 Test Loss: 0.568 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.076131343841553
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.621 Vali Acc: 0.786 Test Loss: 0.621 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.633399486541748
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.524 Vali Acc: 0.821 Test Loss: 0.524 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.705934762954712
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.821 Test Loss: 0.546 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.102968215942383
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.827 Test Loss: 0.531 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.546789169311523
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.821 Test Loss: 0.549 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.791824579238892
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843925).  Saving model ...
Epoch: 19 cost time: 13.614625215530396
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.827 Test Loss: 0.573 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 13.759071350097656
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.838 Test Loss: 0.577 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 13.726519584655762
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.832 Test Loss: 0.569 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 13.549821615219116
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.815 Test Loss: 0.649 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 13.526335716247559
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.821 Test Loss: 0.594 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 13.600359439849854
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.821 Test Loss: 0.593 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 12.760240316390991
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.827 Test Loss: 0.664 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 12.96510934829712
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.821 Test Loss: 0.718 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 13.10930323600769
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.803 Test Loss: 0.727 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 13.144405364990234
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 14310727
model size : 55.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.151710033416748
Epoch: 1, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.702 Vali Acc: 0.283 Test Loss: 1.702 Test Acc: 0.283
Validation loss decreased (inf --> -0.283220).  Saving model ...
Epoch: 2 cost time: 5.269083261489868
Epoch: 2, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.348 Vali Acc: 0.439 Test Loss: 1.348 Test Acc: 0.439
Validation loss decreased (-0.283220 --> -0.439293).  Saving model ...
Epoch: 3 cost time: 4.9288010597229
Epoch: 3, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.128 Vali Acc: 0.526 Test Loss: 1.128 Test Acc: 0.526
Validation loss decreased (-0.439293 --> -0.526000).  Saving model ...
Epoch: 4 cost time: 5.534695148468018
Epoch: 4, Steps: 17 | Train Loss: 0.834 Vali Loss: 0.973 Vali Acc: 0.601 Test Loss: 0.973 Test Acc: 0.601
Validation loss decreased (-0.526000 --> -0.601146).  Saving model ...
Epoch: 5 cost time: 5.276362180709839
Epoch: 5, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.792 Vali Acc: 0.728 Test Loss: 0.792 Test Acc: 0.728
Validation loss decreased (-0.601146 --> -0.728316).  Saving model ...
Epoch: 6 cost time: 5.946515321731567
Epoch: 6, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.664 Vali Acc: 0.780 Test Loss: 0.664 Test Acc: 0.780
Validation loss decreased (-0.728316 --> -0.780340).  Saving model ...
Epoch: 7 cost time: 5.848522901535034
Epoch: 7, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.592 Vali Acc: 0.769 Test Loss: 0.592 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.256170034408569
Epoch: 8, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.553 Vali Acc: 0.786 Test Loss: 0.553 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786122).  Saving model ...
Epoch: 9 cost time: 6.226027250289917
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.539 Vali Acc: 0.827 Test Loss: 0.539 Test Acc: 0.827
Validation loss decreased (-0.786122 --> -0.826584).  Saving model ...
Epoch: 10 cost time: 6.314079284667969
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.275146722793579
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.547 Vali Acc: 0.827 Test Loss: 0.547 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.205461025238037
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.562 Vali Acc: 0.821 Test Loss: 0.562 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.084194898605347
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.591 Vali Acc: 0.827 Test Loss: 0.591 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.319150447845459
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.208292484283447
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.224867343902588
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.821 Test Loss: 0.592 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.312453269958496
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.1208336353302
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.152547359466553
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 4380871
model size : 17.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.255359411239624
Epoch: 1, Steps: 17 | Train Loss: 1.955 Vali Loss: 1.788 Vali Acc: 0.260 Test Loss: 1.788 Test Acc: 0.260
Validation loss decreased (inf --> -0.260098).  Saving model ...
Epoch: 2 cost time: 9.941775560379028
Epoch: 2, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.388 Vali Acc: 0.457 Test Loss: 1.388 Test Acc: 0.457
Validation loss decreased (-0.260098 --> -0.456634).  Saving model ...
Epoch: 3 cost time: 8.94411826133728
Epoch: 3, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.114 Vali Acc: 0.566 Test Loss: 1.114 Test Acc: 0.566
Validation loss decreased (-0.456634 --> -0.566463).  Saving model ...
Epoch: 4 cost time: 8.991383790969849
Epoch: 4, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.996 Vali Acc: 0.647 Test Loss: 0.996 Test Acc: 0.647
Validation loss decreased (-0.566463 --> -0.647389).  Saving model ...
Epoch: 5 cost time: 8.959424257278442
Epoch: 5, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.707 Vali Acc: 0.827 Test Loss: 0.707 Test Acc: 0.827
Validation loss decreased (-0.647389 --> -0.826583).  Saving model ...
Epoch: 6 cost time: 9.10976529121399
Epoch: 6, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.650 Vali Acc: 0.780 Test Loss: 0.650 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.829319715499878
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.533 Vali Acc: 0.792 Test Loss: 0.533 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.253776550292969
Epoch: 8, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.660 Vali Acc: 0.769 Test Loss: 0.660 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.661654233932495
Epoch: 9, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.567 Vali Acc: 0.786 Test Loss: 0.567 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.351607084274292
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.507 Vali Acc: 0.832 Test Loss: 0.507 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832365).  Saving model ...
Epoch: 11 cost time: 8.921694278717041
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.481 Vali Acc: 0.798 Test Loss: 0.481 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.175915241241455
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.568 Vali Acc: 0.815 Test Loss: 0.568 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.3014976978302
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.621 Vali Acc: 0.786 Test Loss: 0.621 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.292055368423462
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.524 Vali Acc: 0.821 Test Loss: 0.524 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.216596364974976
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.821 Test Loss: 0.546 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.27779483795166
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.827 Test Loss: 0.531 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.070613622665405
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.821 Test Loss: 0.549 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.24124026298523
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843925).  Saving model ...
Epoch: 19 cost time: 8.255220651626587
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.827 Test Loss: 0.573 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.906753301620483
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.838 Test Loss: 0.576 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.755360126495361
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.832 Test Loss: 0.569 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 8.812626123428345
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.815 Test Loss: 0.647 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 8.910848617553711
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.821 Test Loss: 0.596 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 8.97213625907898
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.821 Test Loss: 0.607 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 8.211548089981079
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.827 Test Loss: 0.668 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.839493989944458
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.7099339962005615
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.786 Test Loss: 0.738 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.9714741706848145
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.803 Test Loss: 0.618 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 14310727
model size : 55.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.286512851715088
Epoch: 1, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.702 Vali Acc: 0.283 Test Loss: 1.702 Test Acc: 0.283
Validation loss decreased (inf --> -0.283220).  Saving model ...
Epoch: 2 cost time: 4.24441933631897
Epoch: 2, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.348 Vali Acc: 0.439 Test Loss: 1.348 Test Acc: 0.439
Validation loss decreased (-0.283220 --> -0.439293).  Saving model ...
Epoch: 3 cost time: 4.77817964553833
Epoch: 3, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.128 Vali Acc: 0.526 Test Loss: 1.128 Test Acc: 0.526
Validation loss decreased (-0.439293 --> -0.526000).  Saving model ...
Epoch: 4 cost time: 4.745406627655029
Epoch: 4, Steps: 17 | Train Loss: 0.834 Vali Loss: 0.973 Vali Acc: 0.601 Test Loss: 0.973 Test Acc: 0.601
Validation loss decreased (-0.526000 --> -0.601146).  Saving model ...
Epoch: 5 cost time: 4.801696300506592
Epoch: 5, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.792 Vali Acc: 0.728 Test Loss: 0.792 Test Acc: 0.728
Validation loss decreased (-0.601146 --> -0.728316).  Saving model ...
Epoch: 6 cost time: 4.73312783241272
Epoch: 6, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.664 Vali Acc: 0.780 Test Loss: 0.664 Test Acc: 0.780
Validation loss decreased (-0.728316 --> -0.780340).  Saving model ...
Epoch: 7 cost time: 4.292683124542236
Epoch: 7, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.592 Vali Acc: 0.769 Test Loss: 0.592 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.193287372589111
Epoch: 8, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.553 Vali Acc: 0.786 Test Loss: 0.553 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786122).  Saving model ...
Epoch: 9 cost time: 4.150054454803467
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.539 Vali Acc: 0.827 Test Loss: 0.539 Test Acc: 0.827
Validation loss decreased (-0.786122 --> -0.826584).  Saving model ...
Epoch: 10 cost time: 4.113494157791138
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.262358665466309
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.547 Vali Acc: 0.827 Test Loss: 0.547 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.719719409942627
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.562 Vali Acc: 0.821 Test Loss: 0.562 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.9792821407318115
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.591 Vali Acc: 0.827 Test Loss: 0.591 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.784320831298828
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.845589876174927
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.626587629318237
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.821 Test Loss: 0.592 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.755138158798218
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.647905588150024
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.692226886749268
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 4380871
model size : 17.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.1258416175842285
Epoch: 1, Steps: 17 | Train Loss: 1.955 Vali Loss: 1.788 Vali Acc: 0.260 Test Loss: 1.788 Test Acc: 0.260
Validation loss decreased (inf --> -0.260098).  Saving model ...
Epoch: 2 cost time: 5.508138656616211
Epoch: 2, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.388 Vali Acc: 0.457 Test Loss: 1.388 Test Acc: 0.457
Validation loss decreased (-0.260098 --> -0.456634).  Saving model ...
Epoch: 3 cost time: 5.50803279876709
Epoch: 3, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.114 Vali Acc: 0.566 Test Loss: 1.114 Test Acc: 0.566
Validation loss decreased (-0.456634 --> -0.566463).  Saving model ...
Epoch: 4 cost time: 6.245718955993652
Epoch: 4, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.996 Vali Acc: 0.647 Test Loss: 0.996 Test Acc: 0.647
Validation loss decreased (-0.566463 --> -0.647389).  Saving model ...
Epoch: 5 cost time: 6.212157487869263
Epoch: 5, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.707 Vali Acc: 0.827 Test Loss: 0.707 Test Acc: 0.827
Validation loss decreased (-0.647389 --> -0.826583).  Saving model ...
Epoch: 6 cost time: 6.298735857009888
Epoch: 6, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.650 Vali Acc: 0.780 Test Loss: 0.650 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.238199472427368
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.533 Vali Acc: 0.792 Test Loss: 0.533 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.154940843582153
Epoch: 8, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.660 Vali Acc: 0.769 Test Loss: 0.660 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.253587961196899
Epoch: 9, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.567 Vali Acc: 0.786 Test Loss: 0.567 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.232248783111572
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.504 Vali Acc: 0.832 Test Loss: 0.504 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832365).  Saving model ...
Epoch: 11 cost time: 5.772004127502441
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.528 Vali Acc: 0.798 Test Loss: 0.528 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.471176385879517
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.553 Vali Acc: 0.786 Test Loss: 0.553 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.434396266937256
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.535 Vali Acc: 0.815 Test Loss: 0.535 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.480231523513794
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.092243432998657
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.423738479614258
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.526 Vali Acc: 0.821 Test Loss: 0.526 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.5499427318573
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.541 Vali Acc: 0.827 Test Loss: 0.541 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.293542146682739
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.503068208694458
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.815 Test Loss: 0.547 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.540510416030884
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.827 Test Loss: 0.552 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 14310727
model size : 55.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.60044264793396
Epoch: 1, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.702 Vali Acc: 0.283 Test Loss: 1.702 Test Acc: 0.283
Validation loss decreased (inf --> -0.283220).  Saving model ...
Epoch: 2 cost time: 3.3123281002044678
Epoch: 2, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.348 Vali Acc: 0.439 Test Loss: 1.348 Test Acc: 0.439
Validation loss decreased (-0.283220 --> -0.439293).  Saving model ...
Epoch: 3 cost time: 3.0178117752075195
Epoch: 3, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.128 Vali Acc: 0.526 Test Loss: 1.128 Test Acc: 0.526
Validation loss decreased (-0.439293 --> -0.526000).  Saving model ...
Epoch: 4 cost time: 3.03185772895813
Epoch: 4, Steps: 17 | Train Loss: 0.834 Vali Loss: 0.973 Vali Acc: 0.601 Test Loss: 0.973 Test Acc: 0.601
Validation loss decreased (-0.526000 --> -0.601146).  Saving model ...
Epoch: 5 cost time: 3.2534358501434326
Epoch: 5, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.792 Vali Acc: 0.728 Test Loss: 0.792 Test Acc: 0.728
Validation loss decreased (-0.601146 --> -0.728316).  Saving model ...
Epoch: 6 cost time: 3.1187689304351807
Epoch: 6, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.664 Vali Acc: 0.780 Test Loss: 0.664 Test Acc: 0.780
Validation loss decreased (-0.728316 --> -0.780340).  Saving model ...
Epoch: 7 cost time: 3.619494915008545
Epoch: 7, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.592 Vali Acc: 0.769 Test Loss: 0.592 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.606794834136963
Epoch: 8, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.553 Vali Acc: 0.786 Test Loss: 0.553 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786122).  Saving model ...
Epoch: 9 cost time: 3.3277289867401123
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.539 Vali Acc: 0.827 Test Loss: 0.539 Test Acc: 0.827
Validation loss decreased (-0.786122 --> -0.826584).  Saving model ...
Epoch: 10 cost time: 3.7081236839294434
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.552478313446045
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.547 Vali Acc: 0.827 Test Loss: 0.547 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.326154947280884
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.562 Vali Acc: 0.821 Test Loss: 0.562 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.3872785568237305
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.591 Vali Acc: 0.827 Test Loss: 0.591 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2667315006256104
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.4966938495635986
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.3855345249176025
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.821 Test Loss: 0.592 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.373443841934204
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.2508955001831055
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.1256089210510254
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 4380871
model size : 17.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.43159008026123
Epoch: 1, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.724 Vali Acc: 0.243 Test Loss: 1.724 Test Acc: 0.243
Validation loss decreased (inf --> -0.242757).  Saving model ...
Epoch: 2 cost time: 8.031342029571533
Epoch: 2, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.371 Vali Acc: 0.353 Test Loss: 1.371 Test Acc: 0.353
Validation loss decreased (-0.242757 --> -0.352587).  Saving model ...
Epoch: 3 cost time: 7.850122690200806
Epoch: 3, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.119 Vali Acc: 0.671 Test Loss: 1.119 Test Acc: 0.671
Validation loss decreased (-0.352587 --> -0.670509).  Saving model ...
Epoch: 4 cost time: 7.940079689025879
Epoch: 4, Steps: 17 | Train Loss: 0.887 Vali Loss: 0.966 Vali Acc: 0.636 Test Loss: 0.966 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.976880788803101
Epoch: 5, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.848 Vali Acc: 0.671 Test Loss: 0.848 Test Acc: 0.671
Validation loss decreased (-0.670509 --> -0.670512).  Saving model ...
Epoch: 6 cost time: 6.544832944869995
Epoch: 6, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
Validation loss decreased (-0.670512 --> -0.809242).  Saving model ...
Epoch: 7 cost time: 6.727128744125366
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.639 Vali Acc: 0.740 Test Loss: 0.639 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.117634534835815
Epoch: 8, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.578 Vali Acc: 0.786 Test Loss: 0.578 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.545813083648682
Epoch: 9, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.502 Vali Acc: 0.827 Test Loss: 0.502 Test Acc: 0.827
Validation loss decreased (-0.809242 --> -0.826585).  Saving model ...
Epoch: 10 cost time: 8.269121408462524
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.300507307052612
Epoch: 11, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.236814737319946
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.294145584106445
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.475 Vali Acc: 0.780 Test Loss: 0.475 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.8248255252838135
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.299145936965942
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.908726692199707
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.798 Test Loss: 0.497 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.8914573192596436
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.792 Test Loss: 0.519 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.9533374309539795
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.798 Test Loss: 0.508 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.657122850418091
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.792 Test Loss: 0.522 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 7280839
model size : 29.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.77979302406311
Epoch: 1, Steps: 17 | Train Loss: 1.886 Vali Loss: 1.701 Vali Acc: 0.289 Test Loss: 1.701 Test Acc: 0.289
Validation loss decreased (inf --> -0.289000).  Saving model ...
Epoch: 2 cost time: 4.152491807937622
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.343 Vali Acc: 0.491 Test Loss: 1.343 Test Acc: 0.491
Validation loss decreased (-0.289000 --> -0.491316).  Saving model ...
Epoch: 3 cost time: 4.109330177307129
Epoch: 3, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.079 Vali Acc: 0.647 Test Loss: 1.079 Test Acc: 0.647
Validation loss decreased (-0.491316 --> -0.647388).  Saving model ...
Epoch: 4 cost time: 4.11485743522644
Epoch: 4, Steps: 17 | Train Loss: 0.849 Vali Loss: 0.939 Vali Acc: 0.676 Test Loss: 0.939 Test Acc: 0.676
Validation loss decreased (-0.647388 --> -0.676291).  Saving model ...
Epoch: 5 cost time: 3.4902191162109375
Epoch: 5, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.780 Vali Acc: 0.734 Test Loss: 0.780 Test Acc: 0.734
Validation loss decreased (-0.676291 --> -0.734096).  Saving model ...
Epoch: 6 cost time: 3.542532205581665
Epoch: 6, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.772 Vali Acc: 0.734 Test Loss: 0.772 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734096).  Saving model ...
Epoch: 7 cost time: 3.5131731033325195
Epoch: 7, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.685 Vali Acc: 0.734 Test Loss: 0.685 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734097).  Saving model ...
Epoch: 8 cost time: 3.3440823554992676
Epoch: 8, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.603 Vali Acc: 0.740 Test Loss: 0.603 Test Acc: 0.740
Validation loss decreased (-0.734097 --> -0.739878).  Saving model ...
Epoch: 9 cost time: 3.7823805809020996
Epoch: 9, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.576 Vali Acc: 0.769 Test Loss: 0.576 Test Acc: 0.769
Validation loss decreased (-0.739878 --> -0.768780).  Saving model ...
Epoch: 10 cost time: 4.029022216796875
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.507 Vali Acc: 0.792 Test Loss: 0.507 Test Acc: 0.792
Validation loss decreased (-0.768780 --> -0.791902).  Saving model ...
Epoch: 11 cost time: 4.425721645355225
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.580 Vali Acc: 0.786 Test Loss: 0.580 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.4404075145721436
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.568 Vali Acc: 0.775 Test Loss: 0.568 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.327059507369995
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.792 Test Loss: 0.548 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.382656812667847
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.549 Vali Acc: 0.786 Test Loss: 0.549 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.568057060241699
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.786 Test Loss: 0.564 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.330338001251221
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.448655843734741
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.792 Test Loss: 0.564 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.202033042907715
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.786 Test Loss: 0.576 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.592489004135132
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.780 Test Loss: 0.570 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.6656851768493652
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.792 Test Loss: 0.576 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 2315719
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.498816013336182
Epoch: 1, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.724 Vali Acc: 0.243 Test Loss: 1.724 Test Acc: 0.243
Validation loss decreased (inf --> -0.242757).  Saving model ...
Epoch: 2 cost time: 6.525204181671143
Epoch: 2, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.371 Vali Acc: 0.353 Test Loss: 1.371 Test Acc: 0.353
Validation loss decreased (-0.242757 --> -0.352587).  Saving model ...
Epoch: 3 cost time: 6.385885000228882
Epoch: 3, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.119 Vali Acc: 0.671 Test Loss: 1.119 Test Acc: 0.671
Validation loss decreased (-0.352587 --> -0.670509).  Saving model ...
Epoch: 4 cost time: 6.0093770027160645
Epoch: 4, Steps: 17 | Train Loss: 0.887 Vali Loss: 0.966 Vali Acc: 0.636 Test Loss: 0.966 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.2823920249938965
Epoch: 5, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.848 Vali Acc: 0.671 Test Loss: 0.848 Test Acc: 0.671
Validation loss decreased (-0.670509 --> -0.670512).  Saving model ...
Epoch: 6 cost time: 6.35155463218689
Epoch: 6, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
Validation loss decreased (-0.670512 --> -0.809242).  Saving model ...
Epoch: 7 cost time: 6.319254398345947
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.639 Vali Acc: 0.740 Test Loss: 0.639 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.2612693309783936
Epoch: 8, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.578 Vali Acc: 0.786 Test Loss: 0.578 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.527848243713379
Epoch: 9, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.502 Vali Acc: 0.827 Test Loss: 0.502 Test Acc: 0.827
Validation loss decreased (-0.809242 --> -0.826585).  Saving model ...
Epoch: 10 cost time: 5.553756952285767
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.53354024887085
Epoch: 11, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.4701666831970215
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.0516815185546875
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.475 Vali Acc: 0.780 Test Loss: 0.475 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.322479486465454
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.402106761932373
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.4047770500183105
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.798 Test Loss: 0.497 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.259115934371948
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.792 Test Loss: 0.519 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.413056135177612
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.798 Test Loss: 0.508 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.079831123352051
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.792 Test Loss: 0.522 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 7280839
model size : 29.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.500546455383301
Epoch: 1, Steps: 17 | Train Loss: 1.886 Vali Loss: 1.701 Vali Acc: 0.289 Test Loss: 1.701 Test Acc: 0.289
Validation loss decreased (inf --> -0.289000).  Saving model ...
Epoch: 2 cost time: 3.2501611709594727
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.343 Vali Acc: 0.491 Test Loss: 1.343 Test Acc: 0.491
Validation loss decreased (-0.289000 --> -0.491316).  Saving model ...
Epoch: 3 cost time: 3.5102760791778564
Epoch: 3, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.079 Vali Acc: 0.647 Test Loss: 1.079 Test Acc: 0.647
Validation loss decreased (-0.491316 --> -0.647388).  Saving model ...
Epoch: 4 cost time: 3.6317660808563232
Epoch: 4, Steps: 17 | Train Loss: 0.849 Vali Loss: 0.939 Vali Acc: 0.676 Test Loss: 0.939 Test Acc: 0.676
Validation loss decreased (-0.647388 --> -0.676291).  Saving model ...
Epoch: 5 cost time: 3.5110740661621094
Epoch: 5, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.780 Vali Acc: 0.734 Test Loss: 0.780 Test Acc: 0.734
Validation loss decreased (-0.676291 --> -0.734096).  Saving model ...
Epoch: 6 cost time: 3.683649778366089
Epoch: 6, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.772 Vali Acc: 0.734 Test Loss: 0.772 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734096).  Saving model ...
Epoch: 7 cost time: 3.3557891845703125
Epoch: 7, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.685 Vali Acc: 0.734 Test Loss: 0.685 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734097).  Saving model ...
Epoch: 8 cost time: 3.1447014808654785
Epoch: 8, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.603 Vali Acc: 0.740 Test Loss: 0.603 Test Acc: 0.740
Validation loss decreased (-0.734097 --> -0.739878).  Saving model ...
Epoch: 9 cost time: 3.387984037399292
Epoch: 9, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.576 Vali Acc: 0.769 Test Loss: 0.576 Test Acc: 0.769
Validation loss decreased (-0.739878 --> -0.768780).  Saving model ...
Epoch: 10 cost time: 3.5575931072235107
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.507 Vali Acc: 0.792 Test Loss: 0.507 Test Acc: 0.792
Validation loss decreased (-0.768780 --> -0.791902).  Saving model ...
Epoch: 11 cost time: 3.3383171558380127
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.580 Vali Acc: 0.786 Test Loss: 0.580 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4453542232513428
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.568 Vali Acc: 0.775 Test Loss: 0.568 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.463047742843628
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.792 Test Loss: 0.548 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0919089317321777
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.786 Test Loss: 0.550 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.1977806091308594
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.786 Test Loss: 0.564 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.0061256885528564
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.106738805770874
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.792 Test Loss: 0.564 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.889493465423584
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.786 Test Loss: 0.576 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8850460052490234
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.780 Test Loss: 0.570 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.4852700233459473
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.792 Test Loss: 0.577 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 2315719
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.059757709503174
Epoch: 1, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.724 Vali Acc: 0.243 Test Loss: 1.724 Test Acc: 0.243
Validation loss decreased (inf --> -0.242757).  Saving model ...
Epoch: 2 cost time: 4.3216516971588135
Epoch: 2, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.371 Vali Acc: 0.353 Test Loss: 1.371 Test Acc: 0.353
Validation loss decreased (-0.242757 --> -0.352587).  Saving model ...
Epoch: 3 cost time: 4.333873510360718
Epoch: 3, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.119 Vali Acc: 0.671 Test Loss: 1.119 Test Acc: 0.671
Validation loss decreased (-0.352587 --> -0.670509).  Saving model ...
Epoch: 4 cost time: 4.271092891693115
Epoch: 4, Steps: 17 | Train Loss: 0.887 Vali Loss: 0.966 Vali Acc: 0.636 Test Loss: 0.966 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6636123657226562
Epoch: 5, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.848 Vali Acc: 0.671 Test Loss: 0.848 Test Acc: 0.671
Validation loss decreased (-0.670509 --> -0.670512).  Saving model ...
Epoch: 6 cost time: 3.717179775238037
Epoch: 6, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
Validation loss decreased (-0.670512 --> -0.809242).  Saving model ...
Epoch: 7 cost time: 3.756828784942627
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.639 Vali Acc: 0.740 Test Loss: 0.639 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.824293613433838
Epoch: 8, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.578 Vali Acc: 0.786 Test Loss: 0.578 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7938551902770996
Epoch: 9, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.502 Vali Acc: 0.827 Test Loss: 0.502 Test Acc: 0.827
Validation loss decreased (-0.809242 --> -0.826585).  Saving model ...
Epoch: 10 cost time: 3.8167412281036377
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.120307683944702
Epoch: 11, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.302903413772583
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.199189901351929
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.475 Vali Acc: 0.780 Test Loss: 0.475 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.140397548675537
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.2498815059661865
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.227731943130493
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.798 Test Loss: 0.497 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.179839611053467
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.792 Test Loss: 0.519 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.359077453613281
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.798 Test Loss: 0.508 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.29704213142395
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.792 Test Loss: 0.522 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 7280839
model size : 29.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.165508270263672
Epoch: 1, Steps: 17 | Train Loss: 1.886 Vali Loss: 1.701 Vali Acc: 0.289 Test Loss: 1.701 Test Acc: 0.289
Validation loss decreased (inf --> -0.289000).  Saving model ...
Epoch: 2 cost time: 2.7294299602508545
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.343 Vali Acc: 0.491 Test Loss: 1.343 Test Acc: 0.491
Validation loss decreased (-0.289000 --> -0.491316).  Saving model ...
Epoch: 3 cost time: 2.610269546508789
Epoch: 3, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.079 Vali Acc: 0.647 Test Loss: 1.079 Test Acc: 0.647
Validation loss decreased (-0.491316 --> -0.647388).  Saving model ...
Epoch: 4 cost time: 2.637371063232422
Epoch: 4, Steps: 17 | Train Loss: 0.849 Vali Loss: 0.939 Vali Acc: 0.676 Test Loss: 0.939 Test Acc: 0.676
Validation loss decreased (-0.647388 --> -0.676291).  Saving model ...
Epoch: 5 cost time: 2.546309471130371
Epoch: 5, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.780 Vali Acc: 0.734 Test Loss: 0.780 Test Acc: 0.734
Validation loss decreased (-0.676291 --> -0.734096).  Saving model ...
Epoch: 6 cost time: 2.6642086505889893
Epoch: 6, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.772 Vali Acc: 0.734 Test Loss: 0.772 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734096).  Saving model ...
Epoch: 7 cost time: 2.618359327316284
Epoch: 7, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.685 Vali Acc: 0.734 Test Loss: 0.685 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734097).  Saving model ...
Epoch: 8 cost time: 2.453824996948242
Epoch: 8, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.603 Vali Acc: 0.740 Test Loss: 0.603 Test Acc: 0.740
Validation loss decreased (-0.734097 --> -0.739878).  Saving model ...
Epoch: 9 cost time: 2.5562915802001953
Epoch: 9, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.576 Vali Acc: 0.769 Test Loss: 0.576 Test Acc: 0.769
Validation loss decreased (-0.739878 --> -0.768780).  Saving model ...
Epoch: 10 cost time: 2.475487470626831
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.506 Vali Acc: 0.792 Test Loss: 0.506 Test Acc: 0.792
Validation loss decreased (-0.768780 --> -0.791902).  Saving model ...
Epoch: 11 cost time: 2.630927801132202
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.578 Vali Acc: 0.792 Test Loss: 0.578 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5870201587677
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.565 Vali Acc: 0.775 Test Loss: 0.565 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.214320182800293
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.545 Vali Acc: 0.792 Test Loss: 0.545 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.270325183868408
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.792 Test Loss: 0.550 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3504867553710938
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.780 Test Loss: 0.571 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.365236282348633
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.555 Vali Acc: 0.798 Test Loss: 0.555 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797682).  Saving model ...
Epoch: 17 cost time: 2.3954641819000244
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.792 Test Loss: 0.565 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3313634395599365
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.798 Test Loss: 0.571 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.290125608444214
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.803 Test Loss: 0.560 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803463).  Saving model ...
Epoch: 20 cost time: 2.573720932006836
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.792 Test Loss: 0.574 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5688977241516113
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.786 Test Loss: 0.586 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6748547554016113
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.792 Test Loss: 0.579 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.597792148590088
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.798 Test Loss: 0.566 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.669522285461426
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.615384817123413
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.780 Test Loss: 0.598 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.573859453201294
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.5985965728759766
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809243).  Saving model ...
Epoch: 28 cost time: 2.5944230556488037
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.803 Test Loss: 0.591 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.6494336128234863
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.803 Test Loss: 0.602 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.5910415649414062
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.798 Test Loss: 0.611 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 2315719
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.078853845596313
Epoch: 1, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.781 Vali Acc: 0.393 Test Loss: 1.781 Test Acc: 0.393
Validation loss decreased (inf --> -0.393046).  Saving model ...
Epoch: 2 cost time: 7.662299394607544
Epoch: 2, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.471 Vali Acc: 0.468 Test Loss: 1.471 Test Acc: 0.468
Validation loss decreased (-0.393046 --> -0.468193).  Saving model ...
Epoch: 3 cost time: 8.15187406539917
Epoch: 3, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.269 Vali Acc: 0.526 Test Loss: 1.269 Test Acc: 0.526
Validation loss decreased (-0.468193 --> -0.525999).  Saving model ...
Epoch: 4 cost time: 8.422858238220215
Epoch: 4, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.057 Vali Acc: 0.601 Test Loss: 1.057 Test Acc: 0.601
Validation loss decreased (-0.525999 --> -0.601145).  Saving model ...
Epoch: 5 cost time: 8.038508892059326
Epoch: 5, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.877 Vali Acc: 0.711 Test Loss: 0.877 Test Acc: 0.711
Validation loss decreased (-0.601145 --> -0.710974).  Saving model ...
Epoch: 6 cost time: 8.097862482070923
Epoch: 6, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.833 Vali Acc: 0.705 Test Loss: 0.833 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.142313957214355
Epoch: 7, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.653 Vali Acc: 0.809 Test Loss: 0.653 Test Acc: 0.809
Validation loss decreased (-0.710974 --> -0.809242).  Saving model ...
Epoch: 8 cost time: 8.224162340164185
Epoch: 8, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.665 Vali Acc: 0.780 Test Loss: 0.665 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.3317482471466064
Epoch: 9, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.569 Vali Acc: 0.798 Test Loss: 0.569 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.211989641189575
Epoch: 10, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.603 Vali Acc: 0.780 Test Loss: 0.603 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.156269788742065
Epoch: 11, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.576 Vali Acc: 0.798 Test Loss: 0.576 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.091803312301636
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.544 Vali Acc: 0.815 Test Loss: 0.544 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815023).  Saving model ...
Epoch: 13 cost time: 7.763813734054565
Epoch: 13, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.484 Vali Acc: 0.821 Test Loss: 0.484 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820804).  Saving model ...
Epoch: 14 cost time: 8.064305543899536
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.473 Vali Acc: 0.827 Test Loss: 0.473 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826585).  Saving model ...
Epoch: 15 cost time: 7.86034893989563
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.614208459854126
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.948102712631226
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.887272357940674
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.507 Vali Acc: 0.821 Test Loss: 0.507 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.934499263763428
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.555 Vali Acc: 0.798 Test Loss: 0.555 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.793145179748535
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.530 Vali Acc: 0.815 Test Loss: 0.530 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.936499357223511
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.528 Vali Acc: 0.798 Test Loss: 0.528 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.38505220413208
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.541 Vali Acc: 0.798 Test Loss: 0.541 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.919708013534546
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.993367910385132
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.543 Vali Acc: 0.798 Test Loss: 0.543 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 7156519
model size : 27.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.861654043197632
Epoch: 1, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.767 Vali Acc: 0.318 Test Loss: 1.767 Test Acc: 0.318
Validation loss decreased (inf --> -0.317901).  Saving model ...
Epoch: 2 cost time: 4.3270323276519775
Epoch: 2, Steps: 17 | Train Loss: 1.621 Vali Loss: 1.489 Vali Acc: 0.347 Test Loss: 1.489 Test Acc: 0.347
Validation loss decreased (-0.317901 --> -0.346806).  Saving model ...
Epoch: 3 cost time: 3.7414188385009766
Epoch: 3, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.254 Vali Acc: 0.549 Test Loss: 1.254 Test Acc: 0.549
Validation loss decreased (-0.346806 --> -0.549120).  Saving model ...
Epoch: 4 cost time: 3.6428422927856445
Epoch: 4, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.104 Vali Acc: 0.636 Test Loss: 1.104 Test Acc: 0.636
Validation loss decreased (-0.549120 --> -0.635827).  Saving model ...
Epoch: 5 cost time: 3.784454107284546
Epoch: 5, Steps: 17 | Train Loss: 0.887 Vali Loss: 0.994 Vali Acc: 0.590 Test Loss: 0.994 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.794771909713745
Epoch: 6, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.844 Vali Acc: 0.705 Test Loss: 0.844 Test Acc: 0.705
Validation loss decreased (-0.635827 --> -0.705194).  Saving model ...
Epoch: 7 cost time: 3.742079973220825
Epoch: 7, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.765 Vali Acc: 0.717 Test Loss: 0.765 Test Acc: 0.717
Validation loss decreased (-0.705194 --> -0.716755).  Saving model ...
Epoch: 8 cost time: 3.772118091583252
Epoch: 8, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.739 Vali Acc: 0.699 Test Loss: 0.739 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8236920833587646
Epoch: 9, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
Validation loss decreased (-0.716755 --> -0.763000).  Saving model ...
Epoch: 10 cost time: 3.5535879135131836
Epoch: 10, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.588 Vali Acc: 0.757 Test Loss: 0.588 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4615397453308105
Epoch: 11, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
Validation loss decreased (-0.763000 --> -0.803463).  Saving model ...
Epoch: 12 cost time: 3.739299774169922
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.506 Vali Acc: 0.786 Test Loss: 0.506 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.518246650695801
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.496 Vali Acc: 0.792 Test Loss: 0.496 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.636138200759888
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.518 Vali Acc: 0.775 Test Loss: 0.518 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.537829875946045
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.528 Vali Acc: 0.775 Test Loss: 0.528 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.566576957702637
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.530 Vali Acc: 0.786 Test Loss: 0.530 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.343782424926758
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.526 Vali Acc: 0.815 Test Loss: 0.526 Test Acc: 0.815
Validation loss decreased (-0.803463 --> -0.815024).  Saving model ...
Epoch: 18 cost time: 4.391885280609131
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.539 Vali Acc: 0.786 Test Loss: 0.539 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.449314594268799
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.535 Vali Acc: 0.780 Test Loss: 0.535 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.430193662643433
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.540 Vali Acc: 0.780 Test Loss: 0.540 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.461456298828125
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.525 Vali Acc: 0.786 Test Loss: 0.525 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.511355400085449
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.554 Vali Acc: 0.780 Test Loss: 0.554 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.417284727096558
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.769 Test Loss: 0.590 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.733305215835571
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.572763919830322
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.540 Vali Acc: 0.798 Test Loss: 0.540 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.790207147598267
Epoch: 26, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.579 Vali Acc: 0.809 Test Loss: 0.579 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.778607130050659
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.635 Vali Acc: 0.775 Test Loss: 0.635 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 2191207
model size : 8.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.2162766456604
Epoch: 1, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.781 Vali Acc: 0.393 Test Loss: 1.781 Test Acc: 0.393
Validation loss decreased (inf --> -0.393046).  Saving model ...
Epoch: 2 cost time: 6.630266904830933
Epoch: 2, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.471 Vali Acc: 0.468 Test Loss: 1.471 Test Acc: 0.468
Validation loss decreased (-0.393046 --> -0.468193).  Saving model ...
Epoch: 3 cost time: 6.524657487869263
Epoch: 3, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.269 Vali Acc: 0.526 Test Loss: 1.269 Test Acc: 0.526
Validation loss decreased (-0.468193 --> -0.525999).  Saving model ...
Epoch: 4 cost time: 6.53811240196228
Epoch: 4, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.057 Vali Acc: 0.601 Test Loss: 1.057 Test Acc: 0.601
Validation loss decreased (-0.525999 --> -0.601145).  Saving model ...
Epoch: 5 cost time: 6.704246282577515
Epoch: 5, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.877 Vali Acc: 0.711 Test Loss: 0.877 Test Acc: 0.711
Validation loss decreased (-0.601145 --> -0.710974).  Saving model ...
Epoch: 6 cost time: 6.665160894393921
Epoch: 6, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.833 Vali Acc: 0.705 Test Loss: 0.833 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.808324098587036
Epoch: 7, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.653 Vali Acc: 0.809 Test Loss: 0.653 Test Acc: 0.809
Validation loss decreased (-0.710974 --> -0.809242).  Saving model ...
Epoch: 8 cost time: 6.738729953765869
Epoch: 8, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.665 Vali Acc: 0.780 Test Loss: 0.665 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.647886753082275
Epoch: 9, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.569 Vali Acc: 0.798 Test Loss: 0.569 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.762763977050781
Epoch: 10, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.603 Vali Acc: 0.780 Test Loss: 0.603 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.8430705070495605
Epoch: 11, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.576 Vali Acc: 0.798 Test Loss: 0.576 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.490730285644531
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.543 Vali Acc: 0.815 Test Loss: 0.543 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815023).  Saving model ...
Epoch: 13 cost time: 6.464231729507446
Epoch: 13, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.484 Vali Acc: 0.821 Test Loss: 0.484 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820804).  Saving model ...
Epoch: 14 cost time: 6.3754613399505615
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.472 Vali Acc: 0.827 Test Loss: 0.472 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826585).  Saving model ...
Epoch: 15 cost time: 6.471402406692505
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.195175409317017
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.401350975036621
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.2617552280426025
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.522 Vali Acc: 0.798 Test Loss: 0.522 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.167734622955322
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.3808534145355225
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.542 Vali Acc: 0.798 Test Loss: 0.542 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.232757806777954
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.5060296058654785
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.580 Vali Acc: 0.798 Test Loss: 0.580 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.5667784214019775
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.604996204376221
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.798 Test Loss: 0.585 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 7156519
model size : 27.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.312078237533569
Epoch: 1, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.767 Vali Acc: 0.318 Test Loss: 1.767 Test Acc: 0.318
Validation loss decreased (inf --> -0.317901).  Saving model ...
Epoch: 2 cost time: 4.781542539596558
Epoch: 2, Steps: 17 | Train Loss: 1.621 Vali Loss: 1.489 Vali Acc: 0.347 Test Loss: 1.489 Test Acc: 0.347
Validation loss decreased (-0.317901 --> -0.346806).  Saving model ...
Epoch: 3 cost time: 4.563229084014893
Epoch: 3, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.254 Vali Acc: 0.549 Test Loss: 1.254 Test Acc: 0.549
Validation loss decreased (-0.346806 --> -0.549120).  Saving model ...
Epoch: 4 cost time: 4.52181339263916
Epoch: 4, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.104 Vali Acc: 0.636 Test Loss: 1.104 Test Acc: 0.636
Validation loss decreased (-0.549120 --> -0.635827).  Saving model ...
Epoch: 5 cost time: 4.788651466369629
Epoch: 5, Steps: 17 | Train Loss: 0.887 Vali Loss: 0.994 Vali Acc: 0.590 Test Loss: 0.994 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.469717502593994
Epoch: 6, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.844 Vali Acc: 0.705 Test Loss: 0.844 Test Acc: 0.705
Validation loss decreased (-0.635827 --> -0.705194).  Saving model ...
Epoch: 7 cost time: 4.721724510192871
Epoch: 7, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.765 Vali Acc: 0.717 Test Loss: 0.765 Test Acc: 0.717
Validation loss decreased (-0.705194 --> -0.716755).  Saving model ...
Epoch: 8 cost time: 4.6979217529296875
Epoch: 8, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.739 Vali Acc: 0.699 Test Loss: 0.739 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.377614259719849
Epoch: 9, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
Validation loss decreased (-0.716755 --> -0.763000).  Saving model ...
Epoch: 10 cost time: 4.886594772338867
Epoch: 10, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.588 Vali Acc: 0.757 Test Loss: 0.588 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.541170358657837
Epoch: 11, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
Validation loss decreased (-0.763000 --> -0.803463).  Saving model ...
Epoch: 12 cost time: 4.316894054412842
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.506 Vali Acc: 0.786 Test Loss: 0.506 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.745638370513916
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.496 Vali Acc: 0.792 Test Loss: 0.496 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.529578924179077
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.518 Vali Acc: 0.775 Test Loss: 0.518 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.713924884796143
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.528 Vali Acc: 0.775 Test Loss: 0.528 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.509524822235107
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.530 Vali Acc: 0.786 Test Loss: 0.530 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.9886279106140137
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.526 Vali Acc: 0.815 Test Loss: 0.526 Test Acc: 0.815
Validation loss decreased (-0.803463 --> -0.815024).  Saving model ...
Epoch: 18 cost time: 4.619198799133301
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.539 Vali Acc: 0.786 Test Loss: 0.539 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.29473614692688
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.780 Test Loss: 0.536 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.444823741912842
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.780 Test Loss: 0.529 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.596468687057495
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.786 Test Loss: 0.534 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.4897050857543945
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.769 Test Loss: 0.571 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.648426532745361
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.775 Test Loss: 0.573 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.459006309509277
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.769 Test Loss: 0.568 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.44963526725769
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.786 Test Loss: 0.577 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.610407114028931
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.780 Test Loss: 0.658 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.512707233428955
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.780 Test Loss: 0.646 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 2191207
model size : 8.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.764267683029175
Epoch: 1, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.781 Vali Acc: 0.393 Test Loss: 1.781 Test Acc: 0.393
Validation loss decreased (inf --> -0.393046).  Saving model ...
Epoch: 2 cost time: 5.482884407043457
Epoch: 2, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.471 Vali Acc: 0.468 Test Loss: 1.471 Test Acc: 0.468
Validation loss decreased (-0.393046 --> -0.468193).  Saving model ...
Epoch: 3 cost time: 5.10921049118042
Epoch: 3, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.269 Vali Acc: 0.526 Test Loss: 1.269 Test Acc: 0.526
Validation loss decreased (-0.468193 --> -0.525999).  Saving model ...
Epoch: 4 cost time: 5.51368522644043
Epoch: 4, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.057 Vali Acc: 0.601 Test Loss: 1.057 Test Acc: 0.601
Validation loss decreased (-0.525999 --> -0.601145).  Saving model ...
Epoch: 5 cost time: 4.903394937515259
Epoch: 5, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.877 Vali Acc: 0.711 Test Loss: 0.877 Test Acc: 0.711
Validation loss decreased (-0.601145 --> -0.710974).  Saving model ...
Epoch: 6 cost time: 5.547522306442261
Epoch: 6, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.833 Vali Acc: 0.705 Test Loss: 0.833 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.264522314071655
Epoch: 7, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.653 Vali Acc: 0.809 Test Loss: 0.653 Test Acc: 0.809
Validation loss decreased (-0.710974 --> -0.809242).  Saving model ...
Epoch: 8 cost time: 5.611626863479614
Epoch: 8, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.665 Vali Acc: 0.780 Test Loss: 0.665 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.1512908935546875
Epoch: 9, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.569 Vali Acc: 0.792 Test Loss: 0.569 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.777243614196777
Epoch: 10, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.601 Vali Acc: 0.780 Test Loss: 0.601 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.197662353515625
Epoch: 11, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.576 Vali Acc: 0.786 Test Loss: 0.576 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.743727922439575
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.521 Vali Acc: 0.821 Test Loss: 0.521 Test Acc: 0.821
Validation loss decreased (-0.809242 --> -0.820804).  Saving model ...
Epoch: 13 cost time: 5.308323621749878
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.486 Vali Acc: 0.792 Test Loss: 0.486 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.62201452255249
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.476 Vali Acc: 0.832 Test Loss: 0.476 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832365).  Saving model ...
Epoch: 15 cost time: 5.610872507095337
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.479 Vali Acc: 0.821 Test Loss: 0.479 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.747814893722534
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.535010576248169
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.480 Vali Acc: 0.803 Test Loss: 0.480 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.829960107803345
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.548778772354126
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.924328565597534
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.498769044876099
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.925712585449219
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.707818269729614
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.822692394256592
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 7156519
model size : 27.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.13119649887085
Epoch: 1, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.767 Vali Acc: 0.318 Test Loss: 1.767 Test Acc: 0.318
Validation loss decreased (inf --> -0.317901).  Saving model ...
Epoch: 2 cost time: 3.396589517593384
Epoch: 2, Steps: 17 | Train Loss: 1.621 Vali Loss: 1.489 Vali Acc: 0.347 Test Loss: 1.489 Test Acc: 0.347
Validation loss decreased (-0.317901 --> -0.346806).  Saving model ...
Epoch: 3 cost time: 2.530829668045044
Epoch: 3, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.254 Vali Acc: 0.549 Test Loss: 1.254 Test Acc: 0.549
Validation loss decreased (-0.346806 --> -0.549120).  Saving model ...
Epoch: 4 cost time: 3.2641308307647705
Epoch: 4, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.104 Vali Acc: 0.636 Test Loss: 1.104 Test Acc: 0.636
Validation loss decreased (-0.549120 --> -0.635827).  Saving model ...
Epoch: 5 cost time: 3.4038479328155518
Epoch: 5, Steps: 17 | Train Loss: 0.887 Vali Loss: 0.994 Vali Acc: 0.590 Test Loss: 0.994 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.369523286819458
Epoch: 6, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.844 Vali Acc: 0.705 Test Loss: 0.844 Test Acc: 0.705
Validation loss decreased (-0.635827 --> -0.705194).  Saving model ...
Epoch: 7 cost time: 3.3326010704040527
Epoch: 7, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.765 Vali Acc: 0.717 Test Loss: 0.765 Test Acc: 0.717
Validation loss decreased (-0.705194 --> -0.716755).  Saving model ...
Epoch: 8 cost time: 3.386235475540161
Epoch: 8, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.738 Vali Acc: 0.699 Test Loss: 0.738 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.233776807785034
Epoch: 9, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.583 Vali Acc: 0.763 Test Loss: 0.583 Test Acc: 0.763
Validation loss decreased (-0.716755 --> -0.763000).  Saving model ...
Epoch: 10 cost time: 3.2801101207733154
Epoch: 10, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.580 Vali Acc: 0.769 Test Loss: 0.580 Test Acc: 0.769
Validation loss decreased (-0.763000 --> -0.768780).  Saving model ...
Epoch: 11 cost time: 3.486595392227173
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.497 Vali Acc: 0.786 Test Loss: 0.497 Test Acc: 0.786
Validation loss decreased (-0.768780 --> -0.786122).  Saving model ...
Epoch: 12 cost time: 3.288750410079956
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.494 Vali Acc: 0.786 Test Loss: 0.494 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 13 cost time: 3.235840082168579
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.514 Vali Acc: 0.780 Test Loss: 0.514 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.414694309234619
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.529 Vali Acc: 0.769 Test Loss: 0.529 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.201545476913452
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.533 Vali Acc: 0.780 Test Loss: 0.533 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1469101905822754
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.780 Test Loss: 0.522 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.635690212249756
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
Validation loss decreased (-0.786122 --> -0.803463).  Saving model ...
Epoch: 18 cost time: 2.5987491607666016
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.535 Vali Acc: 0.798 Test Loss: 0.535 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.92891526222229
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.792 Test Loss: 0.536 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9544708728790283
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.534 Vali Acc: 0.786 Test Loss: 0.534 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9605770111083984
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.525 Vali Acc: 0.792 Test Loss: 0.525 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.232179880142212
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.554 Vali Acc: 0.775 Test Loss: 0.554 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.2625956535339355
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.775 Test Loss: 0.569 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.9912242889404297
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.775 Test Loss: 0.553 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.080538511276245
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.780 Test Loss: 0.565 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.0780465602874756
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.786 Test Loss: 0.569 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.148282766342163
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.786 Test Loss: 0.598 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 2191207
model size : 8.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.859936237335205
Epoch: 1, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.745 Vali Acc: 0.289 Test Loss: 1.745 Test Acc: 0.289
Validation loss decreased (inf --> -0.289000).  Saving model ...
Epoch: 2 cost time: 5.925143003463745
Epoch: 2, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.477 Vali Acc: 0.382 Test Loss: 1.477 Test Acc: 0.382
Validation loss decreased (-0.289000 --> -0.381488).  Saving model ...
Epoch: 3 cost time: 4.128211259841919
Epoch: 3, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.249 Vali Acc: 0.543 Test Loss: 1.249 Test Acc: 0.543
Validation loss decreased (-0.381488 --> -0.543340).  Saving model ...
Epoch: 4 cost time: 6.9394495487213135
Epoch: 4, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.085 Vali Acc: 0.682 Test Loss: 1.085 Test Acc: 0.682
Validation loss decreased (-0.543340 --> -0.682070).  Saving model ...
Epoch: 5 cost time: 6.763363599777222
Epoch: 5, Steps: 17 | Train Loss: 0.881 Vali Loss: 0.969 Vali Acc: 0.630 Test Loss: 0.969 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.734318971633911
Epoch: 6, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.964 Vali Acc: 0.618 Test Loss: 0.964 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.737814664840698
Epoch: 7, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.720 Vali Acc: 0.746 Test Loss: 0.720 Test Acc: 0.746
Validation loss decreased (-0.682070 --> -0.745658).  Saving model ...
Epoch: 8 cost time: 6.854000568389893
Epoch: 8, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.769 Vali Acc: 0.746 Test Loss: 0.769 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.389583110809326
Epoch: 9, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.530 Vali Acc: 0.832 Test Loss: 0.530 Test Acc: 0.832
Validation loss decreased (-0.745658 --> -0.832365).  Saving model ...
Epoch: 10 cost time: 6.59891939163208
Epoch: 10, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.3446080684661865
Epoch: 11, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.455 Vali Acc: 0.821 Test Loss: 0.455 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.632010221481323
Epoch: 12, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.559 Vali Acc: 0.792 Test Loss: 0.559 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.262657165527344
Epoch: 13, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.596263885498047
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.441 Vali Acc: 0.827 Test Loss: 0.441 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.206699848175049
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.501 Vali Acc: 0.798 Test Loss: 0.501 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.444393873214722
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.780821323394775
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.468 Vali Acc: 0.803 Test Loss: 0.468 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.9426891803741455
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.497128009796143
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 3640999
model size : 14.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.711560010910034
Epoch: 1, Steps: 17 | Train Loss: 2.006 Vali Loss: 1.852 Vali Acc: 0.249 Test Loss: 1.852 Test Acc: 0.249
Validation loss decreased (inf --> -0.248536).  Saving model ...
Epoch: 2 cost time: 4.02368688583374
Epoch: 2, Steps: 17 | Train Loss: 1.669 Vali Loss: 1.562 Vali Acc: 0.347 Test Loss: 1.562 Test Acc: 0.347
Validation loss decreased (-0.248536 --> -0.346805).  Saving model ...
Epoch: 3 cost time: 3.526315689086914
Epoch: 3, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.316 Vali Acc: 0.509 Test Loss: 1.316 Test Acc: 0.509
Validation loss decreased (-0.346805 --> -0.508657).  Saving model ...
Epoch: 4 cost time: 4.066041946411133
Epoch: 4, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.141 Vali Acc: 0.566 Test Loss: 1.141 Test Acc: 0.566
Validation loss decreased (-0.508657 --> -0.566463).  Saving model ...
Epoch: 5 cost time: 3.7488250732421875
Epoch: 5, Steps: 17 | Train Loss: 0.936 Vali Loss: 0.994 Vali Acc: 0.630 Test Loss: 0.994 Test Acc: 0.630
Validation loss decreased (-0.566463 --> -0.630048).  Saving model ...
Epoch: 6 cost time: 4.078219890594482
Epoch: 6, Steps: 17 | Train Loss: 0.778 Vali Loss: 0.903 Vali Acc: 0.653 Test Loss: 0.903 Test Acc: 0.653
Validation loss decreased (-0.630048 --> -0.653170).  Saving model ...
Epoch: 7 cost time: 3.4318337440490723
Epoch: 7, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.771 Vali Acc: 0.717 Test Loss: 0.771 Test Acc: 0.717
Validation loss decreased (-0.653170 --> -0.716755).  Saving model ...
Epoch: 8 cost time: 4.004486083984375
Epoch: 8, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.622 Vali Acc: 0.792 Test Loss: 0.622 Test Acc: 0.792
Validation loss decreased (-0.716755 --> -0.791901).  Saving model ...
Epoch: 9 cost time: 3.412612199783325
Epoch: 9, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.557 Vali Acc: 0.775 Test Loss: 0.557 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.898369073867798
Epoch: 10, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803463).  Saving model ...
Epoch: 11 cost time: 3.882779121398926
Epoch: 11, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.606 Vali Acc: 0.798 Test Loss: 0.606 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.189457654953003
Epoch: 12, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.461 Vali Acc: 0.832 Test Loss: 0.461 Test Acc: 0.832
Validation loss decreased (-0.803463 --> -0.832365).  Saving model ...
Epoch: 13 cost time: 3.6911864280700684
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.462 Vali Acc: 0.815 Test Loss: 0.462 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.026777029037476
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.409 Vali Acc: 0.838 Test Loss: 0.409 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838146).  Saving model ...
Epoch: 15 cost time: 3.8558459281921387
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.456 Vali Acc: 0.809 Test Loss: 0.456 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.046072006225586
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.438 Vali Acc: 0.821 Test Loss: 0.438 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.393588066101074
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.435 Vali Acc: 0.792 Test Loss: 0.435 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.98661732673645
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.441 Vali Acc: 0.809 Test Loss: 0.441 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.988241195678711
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.450 Vali Acc: 0.821 Test Loss: 0.450 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.031929016113281
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.451 Vali Acc: 0.809 Test Loss: 0.451 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.137597560882568
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.455 Vali Acc: 0.809 Test Loss: 0.455 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.002487421035767
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.809 Test Loss: 0.461 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.115442514419556
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.798 Test Loss: 0.472 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.057855129241943
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.474 Vali Acc: 0.815 Test Loss: 0.474 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1158247
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.866530179977417
Epoch: 1, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.745 Vali Acc: 0.289 Test Loss: 1.745 Test Acc: 0.289
Validation loss decreased (inf --> -0.289000).  Saving model ...
Epoch: 2 cost time: 5.533780336380005
Epoch: 2, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.477 Vali Acc: 0.382 Test Loss: 1.477 Test Acc: 0.382
Validation loss decreased (-0.289000 --> -0.381488).  Saving model ...
Epoch: 3 cost time: 4.896342754364014
Epoch: 3, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.249 Vali Acc: 0.543 Test Loss: 1.249 Test Acc: 0.543
Validation loss decreased (-0.381488 --> -0.543340).  Saving model ...
Epoch: 4 cost time: 5.287576675415039
Epoch: 4, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.085 Vali Acc: 0.682 Test Loss: 1.085 Test Acc: 0.682
Validation loss decreased (-0.543340 --> -0.682070).  Saving model ...
Epoch: 5 cost time: 5.3284852504730225
Epoch: 5, Steps: 17 | Train Loss: 0.881 Vali Loss: 0.969 Vali Acc: 0.630 Test Loss: 0.969 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.210180044174194
Epoch: 6, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.964 Vali Acc: 0.618 Test Loss: 0.964 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.3396055698394775
Epoch: 7, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.720 Vali Acc: 0.746 Test Loss: 0.720 Test Acc: 0.746
Validation loss decreased (-0.682070 --> -0.745658).  Saving model ...
Epoch: 8 cost time: 5.326995611190796
Epoch: 8, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.769 Vali Acc: 0.746 Test Loss: 0.769 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.009287118911743
Epoch: 9, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.530 Vali Acc: 0.832 Test Loss: 0.530 Test Acc: 0.832
Validation loss decreased (-0.745658 --> -0.832365).  Saving model ...
Epoch: 10 cost time: 5.556673526763916
Epoch: 10, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.987074375152588
Epoch: 11, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.455 Vali Acc: 0.821 Test Loss: 0.455 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.50613260269165
Epoch: 12, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.559 Vali Acc: 0.792 Test Loss: 0.559 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.524413585662842
Epoch: 13, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.010740756988525
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.441 Vali Acc: 0.827 Test Loss: 0.441 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.81513786315918
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.501 Vali Acc: 0.798 Test Loss: 0.501 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.86726450920105
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.927500247955322
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.467 Vali Acc: 0.803 Test Loss: 0.467 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.6388750076293945
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.003597974777222
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 3640999
model size : 14.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.864422082901001
Epoch: 1, Steps: 17 | Train Loss: 2.006 Vali Loss: 1.852 Vali Acc: 0.249 Test Loss: 1.852 Test Acc: 0.249
Validation loss decreased (inf --> -0.248536).  Saving model ...
Epoch: 2 cost time: 2.87229323387146
Epoch: 2, Steps: 17 | Train Loss: 1.669 Vali Loss: 1.562 Vali Acc: 0.347 Test Loss: 1.562 Test Acc: 0.347
Validation loss decreased (-0.248536 --> -0.346805).  Saving model ...
Epoch: 3 cost time: 3.0212955474853516
Epoch: 3, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.316 Vali Acc: 0.509 Test Loss: 1.316 Test Acc: 0.509
Validation loss decreased (-0.346805 --> -0.508657).  Saving model ...
Epoch: 4 cost time: 2.9165360927581787
Epoch: 4, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.141 Vali Acc: 0.566 Test Loss: 1.141 Test Acc: 0.566
Validation loss decreased (-0.508657 --> -0.566463).  Saving model ...
Epoch: 5 cost time: 2.9044699668884277
Epoch: 5, Steps: 17 | Train Loss: 0.936 Vali Loss: 0.994 Vali Acc: 0.630 Test Loss: 0.994 Test Acc: 0.630
Validation loss decreased (-0.566463 --> -0.630048).  Saving model ...
Epoch: 6 cost time: 3.022670269012451
Epoch: 6, Steps: 17 | Train Loss: 0.778 Vali Loss: 0.903 Vali Acc: 0.653 Test Loss: 0.903 Test Acc: 0.653
Validation loss decreased (-0.630048 --> -0.653170).  Saving model ...
Epoch: 7 cost time: 3.2021777629852295
Epoch: 7, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.771 Vali Acc: 0.717 Test Loss: 0.771 Test Acc: 0.717
Validation loss decreased (-0.653170 --> -0.716755).  Saving model ...
Epoch: 8 cost time: 3.1947333812713623
Epoch: 8, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.622 Vali Acc: 0.792 Test Loss: 0.622 Test Acc: 0.792
Validation loss decreased (-0.716755 --> -0.791901).  Saving model ...
Epoch: 9 cost time: 3.365177631378174
Epoch: 9, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.557 Vali Acc: 0.775 Test Loss: 0.557 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.264615774154663
Epoch: 10, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803463).  Saving model ...
Epoch: 11 cost time: 3.2080841064453125
Epoch: 11, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.606 Vali Acc: 0.798 Test Loss: 0.606 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.182224750518799
Epoch: 12, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.461 Vali Acc: 0.832 Test Loss: 0.461 Test Acc: 0.832
Validation loss decreased (-0.803463 --> -0.832365).  Saving model ...
Epoch: 13 cost time: 2.7355828285217285
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.462 Vali Acc: 0.815 Test Loss: 0.462 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.733938217163086
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.409 Vali Acc: 0.838 Test Loss: 0.409 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838146).  Saving model ...
Epoch: 15 cost time: 3.284874677658081
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.456 Vali Acc: 0.809 Test Loss: 0.456 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.259368658065796
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.438 Vali Acc: 0.821 Test Loss: 0.438 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2798683643341064
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.435 Vali Acc: 0.792 Test Loss: 0.435 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4023795127868652
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.441 Vali Acc: 0.809 Test Loss: 0.441 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.1970179080963135
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.451 Vali Acc: 0.821 Test Loss: 0.451 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.466174602508545
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.451 Vali Acc: 0.809 Test Loss: 0.451 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.9396133422851562
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.455 Vali Acc: 0.809 Test Loss: 0.455 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.211514711380005
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.99597430229187
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.473 Vali Acc: 0.798 Test Loss: 0.473 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.2744545936584473
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.809 Test Loss: 0.475 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1158247
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.806585788726807
Epoch: 1, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.745 Vali Acc: 0.289 Test Loss: 1.745 Test Acc: 0.289
Validation loss decreased (inf --> -0.289000).  Saving model ...
Epoch: 2 cost time: 4.137389898300171
Epoch: 2, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.477 Vali Acc: 0.382 Test Loss: 1.477 Test Acc: 0.382
Validation loss decreased (-0.289000 --> -0.381488).  Saving model ...
Epoch: 3 cost time: 3.485529899597168
Epoch: 3, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.249 Vali Acc: 0.543 Test Loss: 1.249 Test Acc: 0.543
Validation loss decreased (-0.381488 --> -0.543340).  Saving model ...
Epoch: 4 cost time: 3.8434841632843018
Epoch: 4, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.085 Vali Acc: 0.682 Test Loss: 1.085 Test Acc: 0.682
Validation loss decreased (-0.543340 --> -0.682070).  Saving model ...
Epoch: 5 cost time: 3.607482433319092
Epoch: 5, Steps: 17 | Train Loss: 0.881 Vali Loss: 0.969 Vali Acc: 0.630 Test Loss: 0.969 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.064119577407837
Epoch: 6, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.964 Vali Acc: 0.618 Test Loss: 0.964 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.702951669692993
Epoch: 7, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.720 Vali Acc: 0.746 Test Loss: 0.720 Test Acc: 0.746
Validation loss decreased (-0.682070 --> -0.745658).  Saving model ...
Epoch: 8 cost time: 3.844921588897705
Epoch: 8, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.769 Vali Acc: 0.746 Test Loss: 0.769 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7136781215667725
Epoch: 9, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.530 Vali Acc: 0.832 Test Loss: 0.530 Test Acc: 0.832
Validation loss decreased (-0.745658 --> -0.832365).  Saving model ...
Epoch: 10 cost time: 3.9942047595977783
Epoch: 10, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.821415662765503
Epoch: 11, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.455 Vali Acc: 0.821 Test Loss: 0.455 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6506900787353516
Epoch: 12, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.558 Vali Acc: 0.792 Test Loss: 0.558 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.69136118888855
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.517 Vali Acc: 0.815 Test Loss: 0.517 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.068068265914917
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.453 Vali Acc: 0.821 Test Loss: 0.453 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.093303203582764
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.079049348831177
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.467 Vali Acc: 0.798 Test Loss: 0.467 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.3451929092407227
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.474 Vali Acc: 0.803 Test Loss: 0.474 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.4904420375823975
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.491 Vali Acc: 0.803 Test Loss: 0.491 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.806854248046875
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.487 Vali Acc: 0.815 Test Loss: 0.487 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 3640999
model size : 14.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.445995807647705
Epoch: 1, Steps: 17 | Train Loss: 2.006 Vali Loss: 1.852 Vali Acc: 0.249 Test Loss: 1.852 Test Acc: 0.249
Validation loss decreased (inf --> -0.248536).  Saving model ...
Epoch: 2 cost time: 2.221372365951538
Epoch: 2, Steps: 17 | Train Loss: 1.669 Vali Loss: 1.562 Vali Acc: 0.347 Test Loss: 1.562 Test Acc: 0.347
Validation loss decreased (-0.248536 --> -0.346805).  Saving model ...
Epoch: 3 cost time: 2.4090819358825684
Epoch: 3, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.316 Vali Acc: 0.509 Test Loss: 1.316 Test Acc: 0.509
Validation loss decreased (-0.346805 --> -0.508657).  Saving model ...
Epoch: 4 cost time: 2.784637928009033
Epoch: 4, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.141 Vali Acc: 0.566 Test Loss: 1.141 Test Acc: 0.566
Validation loss decreased (-0.508657 --> -0.566463).  Saving model ...
Epoch: 5 cost time: 2.4862194061279297
Epoch: 5, Steps: 17 | Train Loss: 0.936 Vali Loss: 0.994 Vali Acc: 0.630 Test Loss: 0.994 Test Acc: 0.630
Validation loss decreased (-0.566463 --> -0.630048).  Saving model ...
Epoch: 6 cost time: 2.0626630783081055
Epoch: 6, Steps: 17 | Train Loss: 0.778 Vali Loss: 0.903 Vali Acc: 0.653 Test Loss: 0.903 Test Acc: 0.653
Validation loss decreased (-0.630048 --> -0.653170).  Saving model ...
Epoch: 7 cost time: 2.2203562259674072
Epoch: 7, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.771 Vali Acc: 0.717 Test Loss: 0.771 Test Acc: 0.717
Validation loss decreased (-0.653170 --> -0.716755).  Saving model ...
Epoch: 8 cost time: 2.157374858856201
Epoch: 8, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.622 Vali Acc: 0.792 Test Loss: 0.622 Test Acc: 0.792
Validation loss decreased (-0.716755 --> -0.791901).  Saving model ...
Epoch: 9 cost time: 2.122351884841919
Epoch: 9, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.557 Vali Acc: 0.775 Test Loss: 0.557 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2291533946990967
Epoch: 10, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803463).  Saving model ...
Epoch: 11 cost time: 2.424652099609375
Epoch: 11, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.606 Vali Acc: 0.798 Test Loss: 0.606 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4877805709838867
Epoch: 12, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.461 Vali Acc: 0.832 Test Loss: 0.461 Test Acc: 0.832
Validation loss decreased (-0.803463 --> -0.832365).  Saving model ...
Epoch: 13 cost time: 2.4651169776916504
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.462 Vali Acc: 0.815 Test Loss: 0.462 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.772779703140259
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.409 Vali Acc: 0.838 Test Loss: 0.409 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838146).  Saving model ...
Epoch: 15 cost time: 2.7198784351348877
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.456 Vali Acc: 0.809 Test Loss: 0.456 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4293880462646484
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.438 Vali Acc: 0.821 Test Loss: 0.438 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8869757652282715
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.434 Vali Acc: 0.792 Test Loss: 0.434 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8920421600341797
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.440 Vali Acc: 0.809 Test Loss: 0.440 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.552051067352295
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.451 Vali Acc: 0.821 Test Loss: 0.451 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.525895357131958
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.450 Vali Acc: 0.809 Test Loss: 0.450 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.812869071960449
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.454 Vali Acc: 0.809 Test Loss: 0.454 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.5271458625793457
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.809 Test Loss: 0.461 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.800926923751831
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.821 Test Loss: 0.471 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.798900604248047
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1158247
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.219916105270386
Epoch: 1, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.808 Vali Acc: 0.277 Test Loss: 1.808 Test Acc: 0.277
Validation loss decreased (inf --> -0.277439).  Saving model ...
Epoch: 2 cost time: 4.543948650360107
Epoch: 2, Steps: 17 | Train Loss: 1.660 Vali Loss: 1.543 Vali Acc: 0.457 Test Loss: 1.543 Test Acc: 0.457
Validation loss decreased (-0.277439 --> -0.456632).  Saving model ...
Epoch: 3 cost time: 4.618612289428711
Epoch: 3, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.312 Vali Acc: 0.514 Test Loss: 1.312 Test Acc: 0.514
Validation loss decreased (-0.456632 --> -0.514438).  Saving model ...
Epoch: 4 cost time: 4.317296981811523
Epoch: 4, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.123 Vali Acc: 0.595 Test Loss: 1.123 Test Acc: 0.595
Validation loss decreased (-0.514438 --> -0.595364).  Saving model ...
Epoch: 5 cost time: 4.053360462188721
Epoch: 5, Steps: 17 | Train Loss: 0.928 Vali Loss: 0.990 Vali Acc: 0.688 Test Loss: 0.990 Test Acc: 0.688
Validation loss decreased (-0.595364 --> -0.687851).  Saving model ...
Epoch: 6 cost time: 5.3352179527282715
Epoch: 6, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.847 Vali Acc: 0.734 Test Loss: 0.847 Test Acc: 0.734
Validation loss decreased (-0.687851 --> -0.734096).  Saving model ...
Epoch: 7 cost time: 5.074362754821777
Epoch: 7, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.694 Vali Acc: 0.786 Test Loss: 0.694 Test Acc: 0.786
Validation loss decreased (-0.734096 --> -0.786120).  Saving model ...
Epoch: 8 cost time: 5.076837062835693
Epoch: 8, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.605 Vali Acc: 0.832 Test Loss: 0.605 Test Acc: 0.832
Validation loss decreased (-0.786120 --> -0.832364).  Saving model ...
Epoch: 9 cost time: 5.204535245895386
Epoch: 9, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.6418843269348145
Epoch: 10, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.497 Vali Acc: 0.832 Test Loss: 0.497 Test Acc: 0.832
Validation loss decreased (-0.832364 --> -0.832365).  Saving model ...
Epoch: 11 cost time: 4.680939674377441
Epoch: 11, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.472 Vali Acc: 0.798 Test Loss: 0.472 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.019873380661011
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 13 cost time: 4.686530590057373
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.482 Vali Acc: 0.832 Test Loss: 0.482 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.23812198638916
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.512 Vali Acc: 0.775 Test Loss: 0.512 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.822604179382324
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
Validation loss decreased (-0.838145 --> -0.849707).  Saving model ...
Epoch: 16 cost time: 4.770369052886963
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.480 Vali Acc: 0.827 Test Loss: 0.480 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.665139198303223
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.467 Vali Acc: 0.855 Test Loss: 0.467 Test Acc: 0.855
Validation loss decreased (-0.849707 --> -0.855487).  Saving model ...
Epoch: 18 cost time: 4.6516923904418945
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.487 Vali Acc: 0.821 Test Loss: 0.487 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.666221380233765
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.487 Vali Acc: 0.821 Test Loss: 0.487 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.938591241836548
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.480 Vali Acc: 0.832 Test Loss: 0.480 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.4718286991119385
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.832 Test Loss: 0.495 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.6535890102386475
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.544 Vali Acc: 0.786 Test Loss: 0.544 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.853213787078857
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.600365400314331
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.9611246585845947
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.855 Test Loss: 0.507 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.089385271072388
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.5267109870910645
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1883239
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.140962362289429
Epoch: 1, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.828 Vali Acc: 0.289 Test Loss: 1.828 Test Acc: 0.289
Validation loss decreased (inf --> -0.288999).  Saving model ...
Epoch: 2 cost time: 3.100558042526245
Epoch: 2, Steps: 17 | Train Loss: 1.638 Vali Loss: 1.518 Vali Acc: 0.457 Test Loss: 1.518 Test Acc: 0.457
Validation loss decreased (-0.288999 --> -0.456632).  Saving model ...
Epoch: 3 cost time: 3.29787015914917
Epoch: 3, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.285 Vali Acc: 0.543 Test Loss: 1.285 Test Acc: 0.543
Validation loss decreased (-0.456632 --> -0.543340).  Saving model ...
Epoch: 4 cost time: 3.3012421131134033
Epoch: 4, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.172 Vali Acc: 0.526 Test Loss: 1.172 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2811954021453857
Epoch: 5, Steps: 17 | Train Loss: 0.862 Vali Loss: 0.999 Vali Acc: 0.653 Test Loss: 0.999 Test Acc: 0.653
Validation loss decreased (-0.543340 --> -0.653169).  Saving model ...
Epoch: 6 cost time: 2.9789376258850098
Epoch: 6, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.817 Vali Acc: 0.746 Test Loss: 0.817 Test Acc: 0.746
Validation loss decreased (-0.653169 --> -0.745657).  Saving model ...
Epoch: 7 cost time: 3.3342833518981934
Epoch: 7, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.719 Vali Acc: 0.798 Test Loss: 0.719 Test Acc: 0.798
Validation loss decreased (-0.745657 --> -0.797681).  Saving model ...
Epoch: 8 cost time: 3.1803789138793945
Epoch: 8, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.642 Vali Acc: 0.769 Test Loss: 0.642 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4112586975097656
Epoch: 9, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.599 Vali Acc: 0.780 Test Loss: 0.599 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3547914028167725
Epoch: 10, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.565 Vali Acc: 0.798 Test Loss: 0.565 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797682).  Saving model ...
Epoch: 11 cost time: 3.2636637687683105
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.536 Vali Acc: 0.780 Test Loss: 0.536 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.325289487838745
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.546 Vali Acc: 0.792 Test Loss: 0.546 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4442787170410156
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803463).  Saving model ...
Epoch: 14 cost time: 3.5240275859832764
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.567 Vali Acc: 0.769 Test Loss: 0.567 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.249601125717163
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.535 Vali Acc: 0.769 Test Loss: 0.535 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5691940784454346
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.558 Vali Acc: 0.763 Test Loss: 0.558 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.186661958694458
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.554 Vali Acc: 0.786 Test Loss: 0.554 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6150293350219727
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.562 Vali Acc: 0.751 Test Loss: 0.562 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2290732860565186
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.568 Vali Acc: 0.751 Test Loss: 0.568 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.5408143997192383
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.578 Vali Acc: 0.775 Test Loss: 0.578 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.263465166091919
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.579 Vali Acc: 0.751 Test Loss: 0.579 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.5661251544952393
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.751 Test Loss: 0.595 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.2691378593444824
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 641767
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.5422046184539795
Epoch: 1, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.808 Vali Acc: 0.277 Test Loss: 1.808 Test Acc: 0.277
Validation loss decreased (inf --> -0.277439).  Saving model ...
Epoch: 2 cost time: 3.8743507862091064
Epoch: 2, Steps: 17 | Train Loss: 1.660 Vali Loss: 1.543 Vali Acc: 0.457 Test Loss: 1.543 Test Acc: 0.457
Validation loss decreased (-0.277439 --> -0.456632).  Saving model ...
Epoch: 3 cost time: 3.9055328369140625
Epoch: 3, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.312 Vali Acc: 0.514 Test Loss: 1.312 Test Acc: 0.514
Validation loss decreased (-0.456632 --> -0.514438).  Saving model ...
Epoch: 4 cost time: 3.9944255352020264
Epoch: 4, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.123 Vali Acc: 0.595 Test Loss: 1.123 Test Acc: 0.595
Validation loss decreased (-0.514438 --> -0.595364).  Saving model ...
Epoch: 5 cost time: 3.8629472255706787
Epoch: 5, Steps: 17 | Train Loss: 0.928 Vali Loss: 0.990 Vali Acc: 0.688 Test Loss: 0.990 Test Acc: 0.688
Validation loss decreased (-0.595364 --> -0.687851).  Saving model ...
Epoch: 6 cost time: 3.6659748554229736
Epoch: 6, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.847 Vali Acc: 0.734 Test Loss: 0.847 Test Acc: 0.734
Validation loss decreased (-0.687851 --> -0.734096).  Saving model ...
Epoch: 7 cost time: 3.932191848754883
Epoch: 7, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.694 Vali Acc: 0.786 Test Loss: 0.694 Test Acc: 0.786
Validation loss decreased (-0.734096 --> -0.786120).  Saving model ...
Epoch: 8 cost time: 3.994544267654419
Epoch: 8, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.605 Vali Acc: 0.832 Test Loss: 0.605 Test Acc: 0.832
Validation loss decreased (-0.786120 --> -0.832364).  Saving model ...
Epoch: 9 cost time: 3.740619421005249
Epoch: 9, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.746380567550659
Epoch: 10, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.497 Vali Acc: 0.832 Test Loss: 0.497 Test Acc: 0.832
Validation loss decreased (-0.832364 --> -0.832365).  Saving model ...
Epoch: 11 cost time: 3.8995535373687744
Epoch: 11, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.472 Vali Acc: 0.798 Test Loss: 0.472 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.841607093811035
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 13 cost time: 3.9045729637145996
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.482 Vali Acc: 0.832 Test Loss: 0.482 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.828855514526367
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.512 Vali Acc: 0.775 Test Loss: 0.512 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7087247371673584
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
Validation loss decreased (-0.838145 --> -0.849707).  Saving model ...
Epoch: 16 cost time: 3.5616703033447266
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.480 Vali Acc: 0.827 Test Loss: 0.480 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.8807852268218994
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.467 Vali Acc: 0.855 Test Loss: 0.467 Test Acc: 0.855
Validation loss decreased (-0.849707 --> -0.855487).  Saving model ...
Epoch: 18 cost time: 3.5297672748565674
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.488 Vali Acc: 0.821 Test Loss: 0.488 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.747642755508423
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.487 Vali Acc: 0.821 Test Loss: 0.487 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8186607360839844
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.480 Vali Acc: 0.832 Test Loss: 0.480 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.695553779602051
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.7463808059692383
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.492 Vali Acc: 0.792 Test Loss: 0.492 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.972928762435913
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.6794629096984863
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.514 Vali Acc: 0.832 Test Loss: 0.514 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.4634366035461426
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.513 Vali Acc: 0.815 Test Loss: 0.513 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.4404280185699463
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.167207479476929
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1883239
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.6268556118011475
Epoch: 1, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.828 Vali Acc: 0.289 Test Loss: 1.828 Test Acc: 0.289
Validation loss decreased (inf --> -0.288999).  Saving model ...
Epoch: 2 cost time: 2.69124436378479
Epoch: 2, Steps: 17 | Train Loss: 1.638 Vali Loss: 1.518 Vali Acc: 0.457 Test Loss: 1.518 Test Acc: 0.457
Validation loss decreased (-0.288999 --> -0.456632).  Saving model ...
Epoch: 3 cost time: 2.893785238265991
Epoch: 3, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.285 Vali Acc: 0.543 Test Loss: 1.285 Test Acc: 0.543
Validation loss decreased (-0.456632 --> -0.543340).  Saving model ...
Epoch: 4 cost time: 3.2082936763763428
Epoch: 4, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.172 Vali Acc: 0.526 Test Loss: 1.172 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9108645915985107
Epoch: 5, Steps: 17 | Train Loss: 0.862 Vali Loss: 0.999 Vali Acc: 0.653 Test Loss: 0.999 Test Acc: 0.653
Validation loss decreased (-0.543340 --> -0.653169).  Saving model ...
Epoch: 6 cost time: 2.9234354496002197
Epoch: 6, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.817 Vali Acc: 0.746 Test Loss: 0.817 Test Acc: 0.746
Validation loss decreased (-0.653169 --> -0.745657).  Saving model ...
Epoch: 7 cost time: 3.200047016143799
Epoch: 7, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.719 Vali Acc: 0.798 Test Loss: 0.719 Test Acc: 0.798
Validation loss decreased (-0.745657 --> -0.797681).  Saving model ...
Epoch: 8 cost time: 2.8335344791412354
Epoch: 8, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.642 Vali Acc: 0.769 Test Loss: 0.642 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.971977710723877
Epoch: 9, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.599 Vali Acc: 0.780 Test Loss: 0.599 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8022754192352295
Epoch: 10, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.565 Vali Acc: 0.798 Test Loss: 0.565 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797682).  Saving model ...
Epoch: 11 cost time: 2.8037109375
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.536 Vali Acc: 0.780 Test Loss: 0.536 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.149744987487793
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.546 Vali Acc: 0.792 Test Loss: 0.546 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.754809617996216
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803463).  Saving model ...
Epoch: 14 cost time: 2.884582042694092
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.567 Vali Acc: 0.769 Test Loss: 0.567 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.020765781402588
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.535 Vali Acc: 0.769 Test Loss: 0.535 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8112220764160156
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.558 Vali Acc: 0.763 Test Loss: 0.558 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.929664134979248
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.554 Vali Acc: 0.786 Test Loss: 0.554 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.973686456680298
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.562 Vali Acc: 0.751 Test Loss: 0.562 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.0562126636505127
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.568 Vali Acc: 0.751 Test Loss: 0.568 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.1334760189056396
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.578 Vali Acc: 0.775 Test Loss: 0.578 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.882167100906372
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.580 Vali Acc: 0.751 Test Loss: 0.580 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.600399971008301
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.751 Test Loss: 0.595 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.0726935863494873
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.603 Vali Acc: 0.763 Test Loss: 0.603 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 641767
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.6779680252075195
Epoch: 1, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.808 Vali Acc: 0.277 Test Loss: 1.808 Test Acc: 0.277
Validation loss decreased (inf --> -0.277439).  Saving model ...
Epoch: 2 cost time: 2.8885927200317383
Epoch: 2, Steps: 17 | Train Loss: 1.660 Vali Loss: 1.543 Vali Acc: 0.457 Test Loss: 1.543 Test Acc: 0.457
Validation loss decreased (-0.277439 --> -0.456632).  Saving model ...
Epoch: 3 cost time: 3.040579319000244
Epoch: 3, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.312 Vali Acc: 0.514 Test Loss: 1.312 Test Acc: 0.514
Validation loss decreased (-0.456632 --> -0.514438).  Saving model ...
Epoch: 4 cost time: 3.1888158321380615
Epoch: 4, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.123 Vali Acc: 0.595 Test Loss: 1.123 Test Acc: 0.595
Validation loss decreased (-0.514438 --> -0.595364).  Saving model ...
Epoch: 5 cost time: 2.930680513381958
Epoch: 5, Steps: 17 | Train Loss: 0.928 Vali Loss: 0.990 Vali Acc: 0.688 Test Loss: 0.990 Test Acc: 0.688
Validation loss decreased (-0.595364 --> -0.687851).  Saving model ...
Epoch: 6 cost time: 2.836360454559326
Epoch: 6, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.847 Vali Acc: 0.734 Test Loss: 0.847 Test Acc: 0.734
Validation loss decreased (-0.687851 --> -0.734096).  Saving model ...
Epoch: 7 cost time: 3.1830365657806396
Epoch: 7, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.694 Vali Acc: 0.786 Test Loss: 0.694 Test Acc: 0.786
Validation loss decreased (-0.734096 --> -0.786120).  Saving model ...
Epoch: 8 cost time: 3.028160333633423
Epoch: 8, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.605 Vali Acc: 0.832 Test Loss: 0.605 Test Acc: 0.832
Validation loss decreased (-0.786120 --> -0.832364).  Saving model ...
Epoch: 9 cost time: 2.878695249557495
Epoch: 9, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0200889110565186
Epoch: 10, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.497 Vali Acc: 0.832 Test Loss: 0.497 Test Acc: 0.832
Validation loss decreased (-0.832364 --> -0.832365).  Saving model ...
Epoch: 11 cost time: 3.2005133628845215
Epoch: 11, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.472 Vali Acc: 0.798 Test Loss: 0.472 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9729273319244385
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 13 cost time: 2.949216365814209
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.482 Vali Acc: 0.832 Test Loss: 0.482 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1814017295837402
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.512 Vali Acc: 0.775 Test Loss: 0.512 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8093101978302
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
Validation loss decreased (-0.838145 --> -0.849707).  Saving model ...
Epoch: 16 cost time: 2.4716243743896484
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.480 Vali Acc: 0.827 Test Loss: 0.480 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4289822578430176
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
Validation loss decreased (-0.849707 --> -0.855487).  Saving model ...
Epoch: 18 cost time: 2.729705572128296
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.479 Vali Acc: 0.832 Test Loss: 0.479 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8278424739837646
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.478 Vali Acc: 0.821 Test Loss: 0.478 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.595125436782837
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.486 Vali Acc: 0.821 Test Loss: 0.486 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.936650514602661
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.500 Vali Acc: 0.821 Test Loss: 0.500 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6595146656036377
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.8719489574432373
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.505 Vali Acc: 0.832 Test Loss: 0.505 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.844381093978882
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.838 Test Loss: 0.495 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.9894468784332275
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.769814968109131
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.6085281372070312
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.838 Test Loss: 0.505 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1883239
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8932082653045654
Epoch: 1, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.828 Vali Acc: 0.289 Test Loss: 1.828 Test Acc: 0.289
Validation loss decreased (inf --> -0.288999).  Saving model ...
Epoch: 2 cost time: 2.23451828956604
Epoch: 2, Steps: 17 | Train Loss: 1.638 Vali Loss: 1.518 Vali Acc: 0.457 Test Loss: 1.518 Test Acc: 0.457
Validation loss decreased (-0.288999 --> -0.456632).  Saving model ...
Epoch: 3 cost time: 2.134392738342285
Epoch: 3, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.285 Vali Acc: 0.543 Test Loss: 1.285 Test Acc: 0.543
Validation loss decreased (-0.456632 --> -0.543340).  Saving model ...
Epoch: 4 cost time: 2.215184450149536
Epoch: 4, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.172 Vali Acc: 0.526 Test Loss: 1.172 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.134978771209717
Epoch: 5, Steps: 17 | Train Loss: 0.862 Vali Loss: 0.999 Vali Acc: 0.653 Test Loss: 0.999 Test Acc: 0.653
Validation loss decreased (-0.543340 --> -0.653169).  Saving model ...
Epoch: 6 cost time: 2.1625070571899414
Epoch: 6, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.817 Vali Acc: 0.746 Test Loss: 0.817 Test Acc: 0.746
Validation loss decreased (-0.653169 --> -0.745657).  Saving model ...
Epoch: 7 cost time: 2.088733434677124
Epoch: 7, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.719 Vali Acc: 0.798 Test Loss: 0.719 Test Acc: 0.798
Validation loss decreased (-0.745657 --> -0.797681).  Saving model ...
Epoch: 8 cost time: 2.0713798999786377
Epoch: 8, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.642 Vali Acc: 0.769 Test Loss: 0.642 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0535597801208496
Epoch: 9, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.600 Vali Acc: 0.780 Test Loss: 0.600 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.047825574874878
Epoch: 10, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.566 Vali Acc: 0.798 Test Loss: 0.566 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797682).  Saving model ...
Epoch: 11 cost time: 1.9994714260101318
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.544 Vali Acc: 0.769 Test Loss: 0.544 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9977788925170898
Epoch: 12, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.976022481918335
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803463).  Saving model ...
Epoch: 14 cost time: 1.9207603931427002
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.556 Vali Acc: 0.769 Test Loss: 0.556 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8928189277648926
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.538 Vali Acc: 0.769 Test Loss: 0.538 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.176828384399414
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.554 Vali Acc: 0.763 Test Loss: 0.554 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2359459400177
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.555 Vali Acc: 0.786 Test Loss: 0.555 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1569972038269043
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.561 Vali Acc: 0.751 Test Loss: 0.561 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.142098903656006
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.565 Vali Acc: 0.751 Test Loss: 0.565 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1950340270996094
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.775 Test Loss: 0.571 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.518007516860962
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.578 Vali Acc: 0.751 Test Loss: 0.578 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8778057098388672
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.590 Vali Acc: 0.751 Test Loss: 0.590 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0666823387145996
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.769 Test Loss: 0.589 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 641767
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.3577001094818115
Epoch: 1, Steps: 17 | Train Loss: 2.015 Vali Loss: 1.917 Vali Acc: 0.214 Test Loss: 1.917 Test Acc: 0.214
Validation loss decreased (inf --> -0.213854).  Saving model ...
Epoch: 2 cost time: 5.475071668624878
Epoch: 2, Steps: 17 | Train Loss: 1.807 Vali Loss: 1.717 Vali Acc: 0.266 Test Loss: 1.717 Test Acc: 0.266
Validation loss decreased (-0.213854 --> -0.265879).  Saving model ...
Epoch: 3 cost time: 5.649960517883301
Epoch: 3, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.500 Vali Acc: 0.353 Test Loss: 1.500 Test Acc: 0.353
Validation loss decreased (-0.265879 --> -0.352586).  Saving model ...
Epoch: 4 cost time: 5.549517631530762
Epoch: 4, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.323 Vali Acc: 0.486 Test Loss: 1.323 Test Acc: 0.486
Validation loss decreased (-0.352586 --> -0.485536).  Saving model ...
Epoch: 5 cost time: 5.710988759994507
Epoch: 5, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.175 Vali Acc: 0.549 Test Loss: 1.175 Test Acc: 0.549
Validation loss decreased (-0.485536 --> -0.549121).  Saving model ...
Epoch: 6 cost time: 5.569959878921509
Epoch: 6, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.080 Vali Acc: 0.555 Test Loss: 1.080 Test Acc: 0.555
Validation loss decreased (-0.549121 --> -0.554902).  Saving model ...
Epoch: 7 cost time: 5.538917064666748
Epoch: 7, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.923 Vali Acc: 0.699 Test Loss: 0.923 Test Acc: 0.699
Validation loss decreased (-0.554902 --> -0.699413).  Saving model ...
Epoch: 8 cost time: 5.592256784439087
Epoch: 8, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.816 Vali Acc: 0.746 Test Loss: 0.816 Test Acc: 0.746
Validation loss decreased (-0.699413 --> -0.745657).  Saving model ...
Epoch: 9 cost time: 5.737370729446411
Epoch: 9, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.715 Vali Acc: 0.769 Test Loss: 0.715 Test Acc: 0.769
Validation loss decreased (-0.745657 --> -0.768779).  Saving model ...
Epoch: 10 cost time: 5.488543272018433
Epoch: 10, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
Validation loss decreased (-0.768779 --> -0.774559).  Saving model ...
Epoch: 11 cost time: 5.714467525482178
Epoch: 11, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.665 Vali Acc: 0.769 Test Loss: 0.665 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.693100214004517
Epoch: 12, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.727 Vali Acc: 0.740 Test Loss: 0.727 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.48502516746521
Epoch: 13, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
Validation loss decreased (-0.774559 --> -0.809243).  Saving model ...
Epoch: 14 cost time: 5.1187660694122314
Epoch: 14, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.666 Vali Acc: 0.786 Test Loss: 0.666 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.165305137634277
Epoch: 15, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.633 Vali Acc: 0.786 Test Loss: 0.633 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.54475998878479
Epoch: 16, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.588 Vali Acc: 0.786 Test Loss: 0.588 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.639038562774658
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.578 Vali Acc: 0.780 Test Loss: 0.578 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.747054100036621
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.602 Vali Acc: 0.798 Test Loss: 0.602 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.635047197341919
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.620 Vali Acc: 0.821 Test Loss: 0.620 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820803).  Saving model ...
Epoch: 20 cost time: 5.418853521347046
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.684 Vali Acc: 0.775 Test Loss: 0.684 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.406005859375
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.624 Vali Acc: 0.792 Test Loss: 0.624 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.486475467681885
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.612 Vali Acc: 0.786 Test Loss: 0.612 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.071520090103149
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.715 Vali Acc: 0.792 Test Loss: 0.715 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.39125394821167
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.687 Vali Acc: 0.780 Test Loss: 0.687 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.2655110359191895
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.718 Vali Acc: 0.775 Test Loss: 0.718 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.355911016464233
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.473415851593018
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.732 Vali Acc: 0.786 Test Loss: 0.732 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.788665294647217
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.743 Vali Acc: 0.786 Test Loss: 0.743 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.23830509185791
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.775 Test Loss: 0.760 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1821079
model size : 7.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.580528020858765
Epoch: 1, Steps: 17 | Train Loss: 1.904 Vali Loss: 1.816 Vali Acc: 0.312 Test Loss: 1.816 Test Acc: 0.312
Validation loss decreased (inf --> -0.312121).  Saving model ...
Epoch: 2 cost time: 3.250746250152588
Epoch: 2, Steps: 17 | Train Loss: 1.741 Vali Loss: 1.638 Vali Acc: 0.410 Test Loss: 1.638 Test Acc: 0.410
Validation loss decreased (-0.312121 --> -0.410388).  Saving model ...
Epoch: 3 cost time: 3.4213356971740723
Epoch: 3, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.457 Vali Acc: 0.538 Test Loss: 1.457 Test Acc: 0.538
Validation loss decreased (-0.410388 --> -0.537558).  Saving model ...
Epoch: 4 cost time: 3.3511648178100586
Epoch: 4, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.293 Vali Acc: 0.549 Test Loss: 1.293 Test Acc: 0.549
Validation loss decreased (-0.537558 --> -0.549120).  Saving model ...
Epoch: 5 cost time: 3.0216193199157715
Epoch: 5, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.177 Vali Acc: 0.601 Test Loss: 1.177 Test Acc: 0.601
Validation loss decreased (-0.549120 --> -0.601144).  Saving model ...
Epoch: 6 cost time: 3.2829766273498535
Epoch: 6, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.048 Vali Acc: 0.636 Test Loss: 1.048 Test Acc: 0.636
Validation loss decreased (-0.601144 --> -0.635828).  Saving model ...
Epoch: 7 cost time: 3.0026540756225586
Epoch: 7, Steps: 17 | Train Loss: 0.798 Vali Loss: 0.922 Vali Acc: 0.659 Test Loss: 0.922 Test Acc: 0.659
Validation loss decreased (-0.635828 --> -0.658950).  Saving model ...
Epoch: 8 cost time: 3.321967363357544
Epoch: 8, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.883 Vali Acc: 0.671 Test Loss: 0.883 Test Acc: 0.671
Validation loss decreased (-0.658950 --> -0.670511).  Saving model ...
Epoch: 9 cost time: 3.316826820373535
Epoch: 9, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.748 Vali Acc: 0.740 Test Loss: 0.748 Test Acc: 0.740
Validation loss decreased (-0.670511 --> -0.739877).  Saving model ...
Epoch: 10 cost time: 3.3692848682403564
Epoch: 10, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.714 Vali Acc: 0.769 Test Loss: 0.714 Test Acc: 0.769
Validation loss decreased (-0.739877 --> -0.768779).  Saving model ...
Epoch: 11 cost time: 3.2251102924346924
Epoch: 11, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.645 Vali Acc: 0.763 Test Loss: 0.645 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.542935609817505
Epoch: 12, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.581 Vali Acc: 0.780 Test Loss: 0.581 Test Acc: 0.780
Validation loss decreased (-0.768779 --> -0.780341).  Saving model ...
Epoch: 13 cost time: 3.2157363891601562
Epoch: 13, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.597 Vali Acc: 0.786 Test Loss: 0.597 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 14 cost time: 3.517493963241577
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.548 Vali Acc: 0.792 Test Loss: 0.548 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791902).  Saving model ...
Epoch: 15 cost time: 3.378373384475708
Epoch: 15, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.646 Vali Acc: 0.775 Test Loss: 0.646 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6425621509552
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.485 Vali Acc: 0.821 Test Loss: 0.485 Test Acc: 0.821
Validation loss decreased (-0.791902 --> -0.820804).  Saving model ...
Epoch: 17 cost time: 3.2099337577819824
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.386174201965332
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.541 Vali Acc: 0.775 Test Loss: 0.541 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1857690811157227
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.514 Vali Acc: 0.798 Test Loss: 0.514 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.5778141021728516
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.294837236404419
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.545 Vali Acc: 0.786 Test Loss: 0.545 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.49761962890625
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.308377265930176
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.575 Vali Acc: 0.780 Test Loss: 0.575 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.2996578216552734
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.521 Vali Acc: 0.798 Test Loss: 0.521 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.322458505630493
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.565 Vali Acc: 0.780 Test Loss: 0.565 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.3511128425598145
Epoch: 26, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.562 Vali Acc: 0.798 Test Loss: 0.562 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 579511
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.627520322799683
Epoch: 1, Steps: 17 | Train Loss: 2.015 Vali Loss: 1.917 Vali Acc: 0.214 Test Loss: 1.917 Test Acc: 0.214
Validation loss decreased (inf --> -0.213854).  Saving model ...
Epoch: 2 cost time: 4.528587818145752
Epoch: 2, Steps: 17 | Train Loss: 1.807 Vali Loss: 1.717 Vali Acc: 0.266 Test Loss: 1.717 Test Acc: 0.266
Validation loss decreased (-0.213854 --> -0.265879).  Saving model ...
Epoch: 3 cost time: 5.24728798866272
Epoch: 3, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.500 Vali Acc: 0.353 Test Loss: 1.500 Test Acc: 0.353
Validation loss decreased (-0.265879 --> -0.352586).  Saving model ...
Epoch: 4 cost time: 4.411385774612427
Epoch: 4, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.323 Vali Acc: 0.486 Test Loss: 1.323 Test Acc: 0.486
Validation loss decreased (-0.352586 --> -0.485536).  Saving model ...
Epoch: 5 cost time: 4.839014530181885
Epoch: 5, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.175 Vali Acc: 0.549 Test Loss: 1.175 Test Acc: 0.549
Validation loss decreased (-0.485536 --> -0.549121).  Saving model ...
Epoch: 6 cost time: 4.820788383483887
Epoch: 6, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.080 Vali Acc: 0.555 Test Loss: 1.080 Test Acc: 0.555
Validation loss decreased (-0.549121 --> -0.554902).  Saving model ...
Epoch: 7 cost time: 4.527958869934082
Epoch: 7, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.923 Vali Acc: 0.699 Test Loss: 0.923 Test Acc: 0.699
Validation loss decreased (-0.554902 --> -0.699413).  Saving model ...
Epoch: 8 cost time: 5.238712787628174
Epoch: 8, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.816 Vali Acc: 0.746 Test Loss: 0.816 Test Acc: 0.746
Validation loss decreased (-0.699413 --> -0.745657).  Saving model ...
Epoch: 9 cost time: 4.456328868865967
Epoch: 9, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.715 Vali Acc: 0.769 Test Loss: 0.715 Test Acc: 0.769
Validation loss decreased (-0.745657 --> -0.768779).  Saving model ...
Epoch: 10 cost time: 4.983797311782837
Epoch: 10, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
Validation loss decreased (-0.768779 --> -0.774559).  Saving model ...
Epoch: 11 cost time: 4.971859693527222
Epoch: 11, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.665 Vali Acc: 0.769 Test Loss: 0.665 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.389855861663818
Epoch: 12, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.727 Vali Acc: 0.740 Test Loss: 0.727 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.166221380233765
Epoch: 13, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
Validation loss decreased (-0.774559 --> -0.809243).  Saving model ...
Epoch: 14 cost time: 4.943813800811768
Epoch: 14, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.666 Vali Acc: 0.786 Test Loss: 0.666 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.405371189117432
Epoch: 15, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.633 Vali Acc: 0.786 Test Loss: 0.633 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.147785425186157
Epoch: 16, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.587 Vali Acc: 0.792 Test Loss: 0.587 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.2388317584991455
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.780 Test Loss: 0.579 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.924993515014648
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.606 Vali Acc: 0.798 Test Loss: 0.606 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.496005058288574
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.616 Vali Acc: 0.821 Test Loss: 0.616 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820803).  Saving model ...
Epoch: 20 cost time: 4.433878421783447
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.680 Vali Acc: 0.780 Test Loss: 0.680 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.009012699127197
Epoch: 21, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.688 Vali Acc: 0.780 Test Loss: 0.688 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.357824087142944
Epoch: 22, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.644 Vali Acc: 0.798 Test Loss: 0.644 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.439612150192261
Epoch: 23, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.664 Vali Acc: 0.786 Test Loss: 0.664 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.086830377578735
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.682 Vali Acc: 0.780 Test Loss: 0.682 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.340118646621704
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.679 Vali Acc: 0.815 Test Loss: 0.679 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.237178802490234
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.724 Vali Acc: 0.769 Test Loss: 0.724 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.130775690078735
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.706 Vali Acc: 0.798 Test Loss: 0.706 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.9912774562835693
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.728 Vali Acc: 0.792 Test Loss: 0.728 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.373231887817383
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.798 Test Loss: 0.742 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1821079
model size : 7.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.546797275543213
Epoch: 1, Steps: 17 | Train Loss: 1.904 Vali Loss: 1.816 Vali Acc: 0.312 Test Loss: 1.816 Test Acc: 0.312
Validation loss decreased (inf --> -0.312121).  Saving model ...
Epoch: 2 cost time: 2.7217726707458496
Epoch: 2, Steps: 17 | Train Loss: 1.741 Vali Loss: 1.638 Vali Acc: 0.410 Test Loss: 1.638 Test Acc: 0.410
Validation loss decreased (-0.312121 --> -0.410388).  Saving model ...
Epoch: 3 cost time: 2.7228763103485107
Epoch: 3, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.457 Vali Acc: 0.538 Test Loss: 1.457 Test Acc: 0.538
Validation loss decreased (-0.410388 --> -0.537558).  Saving model ...
Epoch: 4 cost time: 2.7925925254821777
Epoch: 4, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.293 Vali Acc: 0.549 Test Loss: 1.293 Test Acc: 0.549
Validation loss decreased (-0.537558 --> -0.549120).  Saving model ...
Epoch: 5 cost time: 2.825594902038574
Epoch: 5, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.177 Vali Acc: 0.601 Test Loss: 1.177 Test Acc: 0.601
Validation loss decreased (-0.549120 --> -0.601144).  Saving model ...
Epoch: 6 cost time: 2.922773599624634
Epoch: 6, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.048 Vali Acc: 0.636 Test Loss: 1.048 Test Acc: 0.636
Validation loss decreased (-0.601144 --> -0.635828).  Saving model ...
Epoch: 7 cost time: 2.6603407859802246
Epoch: 7, Steps: 17 | Train Loss: 0.798 Vali Loss: 0.922 Vali Acc: 0.659 Test Loss: 0.922 Test Acc: 0.659
Validation loss decreased (-0.635828 --> -0.658950).  Saving model ...
Epoch: 8 cost time: 2.817809820175171
Epoch: 8, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.883 Vali Acc: 0.671 Test Loss: 0.883 Test Acc: 0.671
Validation loss decreased (-0.658950 --> -0.670511).  Saving model ...
Epoch: 9 cost time: 2.7083499431610107
Epoch: 9, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.748 Vali Acc: 0.740 Test Loss: 0.748 Test Acc: 0.740
Validation loss decreased (-0.670511 --> -0.739877).  Saving model ...
Epoch: 10 cost time: 2.7290918827056885
Epoch: 10, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.714 Vali Acc: 0.769 Test Loss: 0.714 Test Acc: 0.769
Validation loss decreased (-0.739877 --> -0.768779).  Saving model ...
Epoch: 11 cost time: 2.728541612625122
Epoch: 11, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.645 Vali Acc: 0.763 Test Loss: 0.645 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5839569568634033
Epoch: 12, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.581 Vali Acc: 0.780 Test Loss: 0.581 Test Acc: 0.780
Validation loss decreased (-0.768779 --> -0.780341).  Saving model ...
Epoch: 13 cost time: 2.8902571201324463
Epoch: 13, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.597 Vali Acc: 0.786 Test Loss: 0.597 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 14 cost time: 2.88731050491333
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.548 Vali Acc: 0.792 Test Loss: 0.548 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791902).  Saving model ...
Epoch: 15 cost time: 2.8733184337615967
Epoch: 15, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.645 Vali Acc: 0.775 Test Loss: 0.645 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8402633666992188
Epoch: 16, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.486 Vali Acc: 0.821 Test Loss: 0.486 Test Acc: 0.821
Validation loss decreased (-0.791902 --> -0.820804).  Saving model ...
Epoch: 17 cost time: 3.074843645095825
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8811748027801514
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.554 Vali Acc: 0.775 Test Loss: 0.554 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8647990226745605
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.507 Vali Acc: 0.798 Test Loss: 0.507 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8685503005981445
Epoch: 20, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.8681702613830566
Epoch: 21, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.556 Vali Acc: 0.798 Test Loss: 0.556 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.896296977996826
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.567 Vali Acc: 0.780 Test Loss: 0.567 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.5455868244171143
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.523 Vali Acc: 0.780 Test Loss: 0.523 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.6184744834899902
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.539 Vali Acc: 0.798 Test Loss: 0.539 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.1458683013916016
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.3161814212799072
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 579511
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.034153699874878
Epoch: 1, Steps: 17 | Train Loss: 2.015 Vali Loss: 1.917 Vali Acc: 0.214 Test Loss: 1.917 Test Acc: 0.214
Validation loss decreased (inf --> -0.213854).  Saving model ...
Epoch: 2 cost time: 3.375443935394287
Epoch: 2, Steps: 17 | Train Loss: 1.807 Vali Loss: 1.717 Vali Acc: 0.266 Test Loss: 1.717 Test Acc: 0.266
Validation loss decreased (-0.213854 --> -0.265879).  Saving model ...
Epoch: 3 cost time: 3.699709177017212
Epoch: 3, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.500 Vali Acc: 0.353 Test Loss: 1.500 Test Acc: 0.353
Validation loss decreased (-0.265879 --> -0.352586).  Saving model ...
Epoch: 4 cost time: 3.2308480739593506
Epoch: 4, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.323 Vali Acc: 0.486 Test Loss: 1.323 Test Acc: 0.486
Validation loss decreased (-0.352586 --> -0.485536).  Saving model ...
Epoch: 5 cost time: 3.2938849925994873
Epoch: 5, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.175 Vali Acc: 0.549 Test Loss: 1.175 Test Acc: 0.549
Validation loss decreased (-0.485536 --> -0.549121).  Saving model ...
Epoch: 6 cost time: 3.6011312007904053
Epoch: 6, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.080 Vali Acc: 0.555 Test Loss: 1.080 Test Acc: 0.555
Validation loss decreased (-0.549121 --> -0.554902).  Saving model ...
Epoch: 7 cost time: 3.5590240955352783
Epoch: 7, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.923 Vali Acc: 0.699 Test Loss: 0.923 Test Acc: 0.699
Validation loss decreased (-0.554902 --> -0.699413).  Saving model ...
Epoch: 8 cost time: 3.455488681793213
Epoch: 8, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.816 Vali Acc: 0.746 Test Loss: 0.816 Test Acc: 0.746
Validation loss decreased (-0.699413 --> -0.745657).  Saving model ...
Epoch: 9 cost time: 3.2968804836273193
Epoch: 9, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.716 Vali Acc: 0.763 Test Loss: 0.716 Test Acc: 0.763
Validation loss decreased (-0.745657 --> -0.762999).  Saving model ...
Epoch: 10 cost time: 3.3202366828918457
Epoch: 10, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774559).  Saving model ...
Epoch: 11 cost time: 3.518327474594116
Epoch: 11, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.662 Vali Acc: 0.769 Test Loss: 0.662 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3611767292022705
Epoch: 12, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.724 Vali Acc: 0.740 Test Loss: 0.724 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.281156301498413
Epoch: 13, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
Validation loss decreased (-0.774559 --> -0.809243).  Saving model ...
Epoch: 14 cost time: 2.6375784873962402
Epoch: 14, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.652 Vali Acc: 0.775 Test Loss: 0.652 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2978193759918213
Epoch: 15, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.644 Vali Acc: 0.780 Test Loss: 0.644 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4667704105377197
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.9085922241210938
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.564 Vali Acc: 0.798 Test Loss: 0.564 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3385941982269287
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.623 Vali Acc: 0.792 Test Loss: 0.623 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.197267532348633
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.9536683559417725
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.605 Vali Acc: 0.786 Test Loss: 0.605 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.2527105808258057
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.820847988128662
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.666 Vali Acc: 0.775 Test Loss: 0.666 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.0458059310913086
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.697 Vali Acc: 0.786 Test Loss: 0.697 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1821079
model size : 7.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.073435306549072
Epoch: 1, Steps: 17 | Train Loss: 1.904 Vali Loss: 1.816 Vali Acc: 0.312 Test Loss: 1.816 Test Acc: 0.312
Validation loss decreased (inf --> -0.312121).  Saving model ...
Epoch: 2 cost time: 2.098367929458618
Epoch: 2, Steps: 17 | Train Loss: 1.741 Vali Loss: 1.638 Vali Acc: 0.410 Test Loss: 1.638 Test Acc: 0.410
Validation loss decreased (-0.312121 --> -0.410388).  Saving model ...
Epoch: 3 cost time: 2.5455760955810547
Epoch: 3, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.457 Vali Acc: 0.538 Test Loss: 1.457 Test Acc: 0.538
Validation loss decreased (-0.410388 --> -0.537558).  Saving model ...
Epoch: 4 cost time: 2.3109443187713623
Epoch: 4, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.293 Vali Acc: 0.549 Test Loss: 1.293 Test Acc: 0.549
Validation loss decreased (-0.537558 --> -0.549120).  Saving model ...
Epoch: 5 cost time: 2.469836473464966
Epoch: 5, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.177 Vali Acc: 0.601 Test Loss: 1.177 Test Acc: 0.601
Validation loss decreased (-0.549120 --> -0.601144).  Saving model ...
Epoch: 6 cost time: 2.311140775680542
Epoch: 6, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.048 Vali Acc: 0.636 Test Loss: 1.048 Test Acc: 0.636
Validation loss decreased (-0.601144 --> -0.635828).  Saving model ...
Epoch: 7 cost time: 2.445983648300171
Epoch: 7, Steps: 17 | Train Loss: 0.798 Vali Loss: 0.922 Vali Acc: 0.659 Test Loss: 0.922 Test Acc: 0.659
Validation loss decreased (-0.635828 --> -0.658950).  Saving model ...
Epoch: 8 cost time: 2.4858603477478027
Epoch: 8, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.883 Vali Acc: 0.671 Test Loss: 0.883 Test Acc: 0.671
Validation loss decreased (-0.658950 --> -0.670511).  Saving model ...
Epoch: 9 cost time: 2.276954174041748
Epoch: 9, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.748 Vali Acc: 0.740 Test Loss: 0.748 Test Acc: 0.740
Validation loss decreased (-0.670511 --> -0.739877).  Saving model ...
Epoch: 10 cost time: 2.1853220462799072
Epoch: 10, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.714 Vali Acc: 0.769 Test Loss: 0.714 Test Acc: 0.769
Validation loss decreased (-0.739877 --> -0.768779).  Saving model ...
Epoch: 11 cost time: 2.3379883766174316
Epoch: 11, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.645 Vali Acc: 0.763 Test Loss: 0.645 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.237438201904297
Epoch: 12, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.581 Vali Acc: 0.780 Test Loss: 0.581 Test Acc: 0.780
Validation loss decreased (-0.768779 --> -0.780341).  Saving model ...
Epoch: 13 cost time: 2.3328940868377686
Epoch: 13, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.597 Vali Acc: 0.786 Test Loss: 0.597 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 14 cost time: 2.420132875442505
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.553 Vali Acc: 0.769 Test Loss: 0.553 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.414030075073242
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.651 Vali Acc: 0.757 Test Loss: 0.651 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0703752040863037
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.479 Vali Acc: 0.821 Test Loss: 0.479 Test Acc: 0.821
Validation loss decreased (-0.786121 --> -0.820804).  Saving model ...
Epoch: 17 cost time: 2.447601318359375
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3965141773223877
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.536 Vali Acc: 0.786 Test Loss: 0.536 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4020626544952393
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.516 Vali Acc: 0.792 Test Loss: 0.516 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.316941738128662
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4237260818481445
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.527 Vali Acc: 0.786 Test Loss: 0.527 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1298933029174805
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.031708002090454
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.530 Vali Acc: 0.780 Test Loss: 0.530 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.082028865814209
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.530 Vali Acc: 0.798 Test Loss: 0.530 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.0143299102783203
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.535 Vali Acc: 0.786 Test Loss: 0.535 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.256330966949463
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.552 Vali Acc: 0.815 Test Loss: 0.552 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 579511
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.8378143310546875
Epoch: 1, Steps: 17 | Train Loss: 1.936 Vali Loss: 1.842 Vali Acc: 0.243 Test Loss: 1.842 Test Acc: 0.243
Validation loss decreased (inf --> -0.242756).  Saving model ...
Epoch: 2 cost time: 4.345181465148926
Epoch: 2, Steps: 17 | Train Loss: 1.767 Vali Loss: 1.669 Vali Acc: 0.358 Test Loss: 1.669 Test Acc: 0.358
Validation loss decreased (-0.242756 --> -0.358365).  Saving model ...
Epoch: 3 cost time: 4.38083028793335
Epoch: 3, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.504 Vali Acc: 0.399 Test Loss: 1.504 Test Acc: 0.399
Validation loss decreased (-0.358365 --> -0.398829).  Saving model ...
Epoch: 4 cost time: 4.13728141784668
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.352 Vali Acc: 0.451 Test Loss: 1.352 Test Acc: 0.451
Validation loss decreased (-0.398829 --> -0.450854).  Saving model ...
Epoch: 5 cost time: 4.224337816238403
Epoch: 5, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.240 Vali Acc: 0.538 Test Loss: 1.240 Test Acc: 0.538
Validation loss decreased (-0.450854 --> -0.537560).  Saving model ...
Epoch: 6 cost time: 4.130720376968384
Epoch: 6, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.077 Vali Acc: 0.665 Test Loss: 1.077 Test Acc: 0.665
Validation loss decreased (-0.537560 --> -0.664729).  Saving model ...
Epoch: 7 cost time: 4.324510097503662
Epoch: 7, Steps: 17 | Train Loss: 0.811 Vali Loss: 0.967 Vali Acc: 0.642 Test Loss: 0.967 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.204253196716309
Epoch: 8, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.898 Vali Acc: 0.653 Test Loss: 0.898 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.19040846824646
Epoch: 9, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
Validation loss decreased (-0.664729 --> -0.774559).  Saving model ...
Epoch: 10 cost time: 4.358405113220215
Epoch: 10, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.735 Vali Acc: 0.769 Test Loss: 0.735 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.131078004837036
Epoch: 11, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.607 Vali Acc: 0.832 Test Loss: 0.607 Test Acc: 0.832
Validation loss decreased (-0.774559 --> -0.832364).  Saving model ...
Epoch: 12 cost time: 4.315667390823364
Epoch: 12, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.588 Vali Acc: 0.838 Test Loss: 0.588 Test Acc: 0.838
Validation loss decreased (-0.832364 --> -0.838144).  Saving model ...
Epoch: 13 cost time: 4.116551399230957
Epoch: 13, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.567 Vali Acc: 0.792 Test Loss: 0.567 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.120777606964111
Epoch: 14, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.619 Vali Acc: 0.832 Test Loss: 0.619 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.071673393249512
Epoch: 15, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.672 Vali Acc: 0.763 Test Loss: 0.672 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.097348213195801
Epoch: 16, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.709 Vali Acc: 0.769 Test Loss: 0.709 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.183599948883057
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.659 Vali Acc: 0.786 Test Loss: 0.659 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.7675929069519043
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.642 Vali Acc: 0.786 Test Loss: 0.642 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.5788400173187256
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.691 Vali Acc: 0.763 Test Loss: 0.691 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.528931140899658
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.676 Vali Acc: 0.775 Test Loss: 0.676 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.021725416183472
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.652 Vali Acc: 0.786 Test Loss: 0.652 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.7416279315948486
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.777 Vali Acc: 0.763 Test Loss: 0.777 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 941911
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.624412536621094
Epoch: 1, Steps: 17 | Train Loss: 1.979 Vali Loss: 1.929 Vali Acc: 0.185 Test Loss: 1.929 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 2.9765636920928955
Epoch: 2, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.765 Vali Acc: 0.324 Test Loss: 1.765 Test Acc: 0.324
Validation loss decreased (-0.184952 --> -0.323682).  Saving model ...
Epoch: 3 cost time: 2.726447343826294
Epoch: 3, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.550 Vali Acc: 0.364 Test Loss: 1.550 Test Acc: 0.364
Validation loss decreased (-0.323682 --> -0.364146).  Saving model ...
Epoch: 4 cost time: 2.7156429290771484
Epoch: 4, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.338 Vali Acc: 0.549 Test Loss: 1.338 Test Acc: 0.549
Validation loss decreased (-0.364146 --> -0.549120).  Saving model ...
Epoch: 5 cost time: 2.500943899154663
Epoch: 5, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.204 Vali Acc: 0.555 Test Loss: 1.204 Test Acc: 0.555
Validation loss decreased (-0.549120 --> -0.554901).  Saving model ...
Epoch: 6 cost time: 2.626556158065796
Epoch: 6, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.099 Vali Acc: 0.566 Test Loss: 1.099 Test Acc: 0.566
Validation loss decreased (-0.554901 --> -0.566463).  Saving model ...
Epoch: 7 cost time: 2.807241201400757
Epoch: 7, Steps: 17 | Train Loss: 0.811 Vali Loss: 0.976 Vali Acc: 0.671 Test Loss: 0.976 Test Acc: 0.671
Validation loss decreased (-0.566463 --> -0.670510).  Saving model ...
Epoch: 8 cost time: 2.5243396759033203
Epoch: 8, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.840 Vali Acc: 0.734 Test Loss: 0.840 Test Acc: 0.734
Validation loss decreased (-0.670510 --> -0.734096).  Saving model ...
Epoch: 9 cost time: 2.859341859817505
Epoch: 9, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.768 Vali Acc: 0.763 Test Loss: 0.768 Test Acc: 0.763
Validation loss decreased (-0.734096 --> -0.762998).  Saving model ...
Epoch: 10 cost time: 2.8430240154266357
Epoch: 10, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.708 Vali Acc: 0.780 Test Loss: 0.708 Test Acc: 0.780
Validation loss decreased (-0.762998 --> -0.780340).  Saving model ...
Epoch: 11 cost time: 2.9355621337890625
Epoch: 11, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.598 Vali Acc: 0.821 Test Loss: 0.598 Test Acc: 0.821
Validation loss decreased (-0.780340 --> -0.820803).  Saving model ...
Epoch: 12 cost time: 3.1137404441833496
Epoch: 12, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
Validation loss decreased (-0.820803 --> -0.838145).  Saving model ...
Epoch: 13 cost time: 2.8829684257507324
Epoch: 13, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.506 Vali Acc: 0.798 Test Loss: 0.506 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7417731285095215
Epoch: 14, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
Validation loss decreased (-0.838145 --> -0.849706).  Saving model ...
Epoch: 15 cost time: 2.8828630447387695
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.508 Vali Acc: 0.827 Test Loss: 0.508 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9684653282165527
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.508 Vali Acc: 0.832 Test Loss: 0.508 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.915867328643799
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8491783142089844
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.415 Vali Acc: 0.867 Test Loss: 0.415 Test Acc: 0.867
Validation loss decreased (-0.849706 --> -0.867048).  Saving model ...
Epoch: 19 cost time: 2.847233295440674
Epoch: 19, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9599733352661133
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0859463214874268
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.041928291320801
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0495362281799316
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.9716544151306152
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.0015106201171875
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7808403968811035
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.447 Vali Acc: 0.861 Test Loss: 0.447 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.8901071548461914
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.613262891769409
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 321079
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.368993282318115
Epoch: 1, Steps: 17 | Train Loss: 1.936 Vali Loss: 1.842 Vali Acc: 0.243 Test Loss: 1.842 Test Acc: 0.243
Validation loss decreased (inf --> -0.242756).  Saving model ...
Epoch: 2 cost time: 3.619110584259033
Epoch: 2, Steps: 17 | Train Loss: 1.767 Vali Loss: 1.669 Vali Acc: 0.358 Test Loss: 1.669 Test Acc: 0.358
Validation loss decreased (-0.242756 --> -0.358365).  Saving model ...
Epoch: 3 cost time: 3.489013195037842
Epoch: 3, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.504 Vali Acc: 0.399 Test Loss: 1.504 Test Acc: 0.399
Validation loss decreased (-0.358365 --> -0.398829).  Saving model ...
Epoch: 4 cost time: 3.4607229232788086
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.352 Vali Acc: 0.451 Test Loss: 1.352 Test Acc: 0.451
Validation loss decreased (-0.398829 --> -0.450854).  Saving model ...
Epoch: 5 cost time: 3.603309154510498
Epoch: 5, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.240 Vali Acc: 0.538 Test Loss: 1.240 Test Acc: 0.538
Validation loss decreased (-0.450854 --> -0.537560).  Saving model ...
Epoch: 6 cost time: 3.5115156173706055
Epoch: 6, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.077 Vali Acc: 0.665 Test Loss: 1.077 Test Acc: 0.665
Validation loss decreased (-0.537560 --> -0.664729).  Saving model ...
Epoch: 7 cost time: 3.1801302433013916
Epoch: 7, Steps: 17 | Train Loss: 0.811 Vali Loss: 0.967 Vali Acc: 0.642 Test Loss: 0.967 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.442091703414917
Epoch: 8, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.898 Vali Acc: 0.653 Test Loss: 0.898 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3648531436920166
Epoch: 9, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
Validation loss decreased (-0.664729 --> -0.774559).  Saving model ...
Epoch: 10 cost time: 3.3511440753936768
Epoch: 10, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.735 Vali Acc: 0.769 Test Loss: 0.735 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.384751319885254
Epoch: 11, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.608 Vali Acc: 0.832 Test Loss: 0.608 Test Acc: 0.832
Validation loss decreased (-0.774559 --> -0.832364).  Saving model ...
Epoch: 12 cost time: 3.355302333831787
Epoch: 12, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.582 Vali Acc: 0.838 Test Loss: 0.582 Test Acc: 0.838
Validation loss decreased (-0.832364 --> -0.838144).  Saving model ...
Epoch: 13 cost time: 3.294861316680908
Epoch: 13, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.589 Vali Acc: 0.786 Test Loss: 0.589 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.363755226135254
Epoch: 14, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
Validation loss decreased (-0.838144 --> -0.849705).  Saving model ...
Epoch: 15 cost time: 3.376271963119507
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.655 Vali Acc: 0.769 Test Loss: 0.655 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2457544803619385
Epoch: 16, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.676 Vali Acc: 0.786 Test Loss: 0.676 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.298790216445923
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.603 Vali Acc: 0.798 Test Loss: 0.603 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1695382595062256
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.753 Vali Acc: 0.769 Test Loss: 0.753 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.481675148010254
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.684 Vali Acc: 0.775 Test Loss: 0.684 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5432286262512207
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.696 Vali Acc: 0.786 Test Loss: 0.696 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.684929370880127
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.685 Vali Acc: 0.798 Test Loss: 0.685 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.6761844158172607
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.985745668411255
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.769 Vali Acc: 0.769 Test Loss: 0.769 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.4115726947784424
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.728 Vali Acc: 0.775 Test Loss: 0.728 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 941911
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.4286205768585205
Epoch: 1, Steps: 17 | Train Loss: 1.979 Vali Loss: 1.929 Vali Acc: 0.185 Test Loss: 1.929 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 2.6471376419067383
Epoch: 2, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.765 Vali Acc: 0.324 Test Loss: 1.765 Test Acc: 0.324
Validation loss decreased (-0.184952 --> -0.323682).  Saving model ...
Epoch: 3 cost time: 2.426544189453125
Epoch: 3, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.550 Vali Acc: 0.364 Test Loss: 1.550 Test Acc: 0.364
Validation loss decreased (-0.323682 --> -0.364146).  Saving model ...
Epoch: 4 cost time: 2.628610134124756
Epoch: 4, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.338 Vali Acc: 0.549 Test Loss: 1.338 Test Acc: 0.549
Validation loss decreased (-0.364146 --> -0.549120).  Saving model ...
Epoch: 5 cost time: 2.2247958183288574
Epoch: 5, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.204 Vali Acc: 0.555 Test Loss: 1.204 Test Acc: 0.555
Validation loss decreased (-0.549120 --> -0.554901).  Saving model ...
Epoch: 6 cost time: 2.5670697689056396
Epoch: 6, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.099 Vali Acc: 0.566 Test Loss: 1.099 Test Acc: 0.566
Validation loss decreased (-0.554901 --> -0.566463).  Saving model ...
Epoch: 7 cost time: 2.6968321800231934
Epoch: 7, Steps: 17 | Train Loss: 0.811 Vali Loss: 0.976 Vali Acc: 0.671 Test Loss: 0.976 Test Acc: 0.671
Validation loss decreased (-0.566463 --> -0.670510).  Saving model ...
Epoch: 8 cost time: 2.6356489658355713
Epoch: 8, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.840 Vali Acc: 0.734 Test Loss: 0.840 Test Acc: 0.734
Validation loss decreased (-0.670510 --> -0.734096).  Saving model ...
Epoch: 9 cost time: 2.624760150909424
Epoch: 9, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.768 Vali Acc: 0.763 Test Loss: 0.768 Test Acc: 0.763
Validation loss decreased (-0.734096 --> -0.762998).  Saving model ...
Epoch: 10 cost time: 2.42216157913208
Epoch: 10, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.708 Vali Acc: 0.780 Test Loss: 0.708 Test Acc: 0.780
Validation loss decreased (-0.762998 --> -0.780340).  Saving model ...
Epoch: 11 cost time: 2.4266257286071777
Epoch: 11, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.598 Vali Acc: 0.821 Test Loss: 0.598 Test Acc: 0.821
Validation loss decreased (-0.780340 --> -0.820803).  Saving model ...
Epoch: 12 cost time: 2.2116916179656982
Epoch: 12, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
Validation loss decreased (-0.820803 --> -0.838145).  Saving model ...
Epoch: 13 cost time: 2.662684202194214
Epoch: 13, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.506 Vali Acc: 0.798 Test Loss: 0.506 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6219124794006348
Epoch: 14, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
Validation loss decreased (-0.838145 --> -0.849706).  Saving model ...
Epoch: 15 cost time: 2.4987545013427734
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.508 Vali Acc: 0.827 Test Loss: 0.508 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.673072099685669
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.509 Vali Acc: 0.832 Test Loss: 0.509 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4965596199035645
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.456 Vali Acc: 0.844 Test Loss: 0.456 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4695773124694824
Epoch: 18, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.448 Vali Acc: 0.844 Test Loss: 0.448 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.69215989112854
Epoch: 19, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5468060970306396
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
Validation loss decreased (-0.849706 --> -0.855487).  Saving model ...
Epoch: 21 cost time: 2.474722385406494
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.421 Vali Acc: 0.867 Test Loss: 0.421 Test Acc: 0.867
Validation loss decreased (-0.855487 --> -0.867048).  Saving model ...
Epoch: 22 cost time: 2.806598663330078
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.557896852493286
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6588361263275146
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.439 Vali Acc: 0.855 Test Loss: 0.439 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.7121758460998535
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.442 Vali Acc: 0.873 Test Loss: 0.442 Test Acc: 0.873
Validation loss decreased (-0.867048 --> -0.872828).  Saving model ...
Epoch: 26 cost time: 2.439429998397827
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.588766098022461
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.459 Vali Acc: 0.838 Test Loss: 0.459 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.4919352531433105
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.0058538913726807
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.560258626937866
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.463 Vali Acc: 0.838 Test Loss: 0.463 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 321079
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.584599018096924
Epoch: 1, Steps: 17 | Train Loss: 1.936 Vali Loss: 1.842 Vali Acc: 0.243 Test Loss: 1.842 Test Acc: 0.243
Validation loss decreased (inf --> -0.242756).  Saving model ...
Epoch: 2 cost time: 2.760845422744751
Epoch: 2, Steps: 17 | Train Loss: 1.767 Vali Loss: 1.669 Vali Acc: 0.358 Test Loss: 1.669 Test Acc: 0.358
Validation loss decreased (-0.242756 --> -0.358365).  Saving model ...
Epoch: 3 cost time: 2.867455244064331
Epoch: 3, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.504 Vali Acc: 0.399 Test Loss: 1.504 Test Acc: 0.399
Validation loss decreased (-0.358365 --> -0.398829).  Saving model ...
Epoch: 4 cost time: 2.7489242553710938
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.352 Vali Acc: 0.451 Test Loss: 1.352 Test Acc: 0.451
Validation loss decreased (-0.398829 --> -0.450854).  Saving model ...
Epoch: 5 cost time: 2.320178270339966
Epoch: 5, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.240 Vali Acc: 0.538 Test Loss: 1.240 Test Acc: 0.538
Validation loss decreased (-0.450854 --> -0.537560).  Saving model ...
Epoch: 6 cost time: 2.3477447032928467
Epoch: 6, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.077 Vali Acc: 0.665 Test Loss: 1.077 Test Acc: 0.665
Validation loss decreased (-0.537560 --> -0.664729).  Saving model ...
Epoch: 7 cost time: 2.6981990337371826
Epoch: 7, Steps: 17 | Train Loss: 0.811 Vali Loss: 0.967 Vali Acc: 0.642 Test Loss: 0.967 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6343483924865723
Epoch: 8, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.898 Vali Acc: 0.653 Test Loss: 0.898 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7297520637512207
Epoch: 9, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.738 Vali Acc: 0.757 Test Loss: 0.738 Test Acc: 0.757
Validation loss decreased (-0.664729 --> -0.757218).  Saving model ...
Epoch: 10 cost time: 2.6363861560821533
Epoch: 10, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.729 Vali Acc: 0.769 Test Loss: 0.729 Test Acc: 0.769
Validation loss decreased (-0.757218 --> -0.768779).  Saving model ...
Epoch: 11 cost time: 2.6953792572021484
Epoch: 11, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.607 Vali Acc: 0.821 Test Loss: 0.607 Test Acc: 0.821
Validation loss decreased (-0.768779 --> -0.820803).  Saving model ...
Epoch: 12 cost time: 2.4869489669799805
Epoch: 12, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.572 Vali Acc: 0.832 Test Loss: 0.572 Test Acc: 0.832
Validation loss decreased (-0.820803 --> -0.832364).  Saving model ...
Epoch: 13 cost time: 2.5409531593322754
Epoch: 13, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.650 Vali Acc: 0.751 Test Loss: 0.650 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3963229656219482
Epoch: 14, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.533 Vali Acc: 0.821 Test Loss: 0.533 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6268467903137207
Epoch: 15, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.776 Vali Acc: 0.728 Test Loss: 0.776 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4566304683685303
Epoch: 16, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.564 Vali Acc: 0.792 Test Loss: 0.564 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4504551887512207
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.701 Vali Acc: 0.780 Test Loss: 0.701 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5940449237823486
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.700 Vali Acc: 0.780 Test Loss: 0.700 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.709437131881714
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.651 Vali Acc: 0.786 Test Loss: 0.651 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.469665765762329
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.704 Vali Acc: 0.780 Test Loss: 0.704 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.477890729904175
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.666 Vali Acc: 0.786 Test Loss: 0.666 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.568794012069702
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.740 Vali Acc: 0.769 Test Loss: 0.740 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 941911
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5363645553588867
Epoch: 1, Steps: 17 | Train Loss: 1.979 Vali Loss: 1.929 Vali Acc: 0.185 Test Loss: 1.929 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 1.9921207427978516
Epoch: 2, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.765 Vali Acc: 0.324 Test Loss: 1.765 Test Acc: 0.324
Validation loss decreased (-0.184952 --> -0.323682).  Saving model ...
Epoch: 3 cost time: 2.0013175010681152
Epoch: 3, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.550 Vali Acc: 0.364 Test Loss: 1.550 Test Acc: 0.364
Validation loss decreased (-0.323682 --> -0.364146).  Saving model ...
Epoch: 4 cost time: 1.9002015590667725
Epoch: 4, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.338 Vali Acc: 0.549 Test Loss: 1.338 Test Acc: 0.549
Validation loss decreased (-0.364146 --> -0.549120).  Saving model ...
Epoch: 5 cost time: 1.9496665000915527
Epoch: 5, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.204 Vali Acc: 0.555 Test Loss: 1.204 Test Acc: 0.555
Validation loss decreased (-0.549120 --> -0.554901).  Saving model ...
Epoch: 6 cost time: 1.9653549194335938
Epoch: 6, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.099 Vali Acc: 0.566 Test Loss: 1.099 Test Acc: 0.566
Validation loss decreased (-0.554901 --> -0.566463).  Saving model ...
Epoch: 7 cost time: 1.8183298110961914
Epoch: 7, Steps: 17 | Train Loss: 0.811 Vali Loss: 0.976 Vali Acc: 0.671 Test Loss: 0.976 Test Acc: 0.671
Validation loss decreased (-0.566463 --> -0.670510).  Saving model ...
Epoch: 8 cost time: 1.782646656036377
Epoch: 8, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.840 Vali Acc: 0.734 Test Loss: 0.840 Test Acc: 0.734
Validation loss decreased (-0.670510 --> -0.734096).  Saving model ...
Epoch: 9 cost time: 1.727743148803711
Epoch: 9, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.768 Vali Acc: 0.763 Test Loss: 0.768 Test Acc: 0.763
Validation loss decreased (-0.734096 --> -0.762998).  Saving model ...
Epoch: 10 cost time: 1.956892490386963
Epoch: 10, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.707 Vali Acc: 0.780 Test Loss: 0.707 Test Acc: 0.780
Validation loss decreased (-0.762998 --> -0.780340).  Saving model ...
Epoch: 11 cost time: 2.18570613861084
Epoch: 11, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.598 Vali Acc: 0.821 Test Loss: 0.598 Test Acc: 0.821
Validation loss decreased (-0.780340 --> -0.820803).  Saving model ...
Epoch: 12 cost time: 2.0435001850128174
Epoch: 12, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.546 Vali Acc: 0.821 Test Loss: 0.546 Test Acc: 0.821
Validation loss decreased (-0.820803 --> -0.820804).  Saving model ...
Epoch: 13 cost time: 2.090689182281494
Epoch: 13, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.520 Vali Acc: 0.786 Test Loss: 0.520 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2320399284362793
Epoch: 14, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.491 Vali Acc: 0.867 Test Loss: 0.491 Test Acc: 0.867
Validation loss decreased (-0.820804 --> -0.867047).  Saving model ...
Epoch: 15 cost time: 2.075009346008301
Epoch: 15, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.496 Vali Acc: 0.838 Test Loss: 0.496 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0519680976867676
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.498 Vali Acc: 0.855 Test Loss: 0.498 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.183553695678711
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9731667041778564
Epoch: 18, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.053630828857422
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.460 Vali Acc: 0.832 Test Loss: 0.460 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.143338680267334
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.428 Vali Acc: 0.861 Test Loss: 0.428 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.153186321258545
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.1009483337402344
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.442 Vali Acc: 0.867 Test Loss: 0.442 Test Acc: 0.867
Validation loss decreased (-0.867047 --> -0.867048).  Saving model ...
Epoch: 23 cost time: 2.204310417175293
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9154598712921143
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.439 Vali Acc: 0.861 Test Loss: 0.439 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0422871112823486
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.441 Vali Acc: 0.861 Test Loss: 0.441 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.1630821228027344
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.445 Vali Acc: 0.861 Test Loss: 0.445 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.13724946975708
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.448 Vali Acc: 0.861 Test Loss: 0.448 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.972844123840332
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.454 Vali Acc: 0.861 Test Loss: 0.454 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.2042396068573
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.290212869644165
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.461 Vali Acc: 0.861 Test Loss: 0.461 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 321079
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.886199712753296
Epoch: 1, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.847 Vali Acc: 0.306 Test Loss: 1.847 Test Acc: 0.306
Validation loss decreased (inf --> -0.306340).  Saving model ...
Epoch: 2 cost time: 3.624842405319214
Epoch: 2, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.677 Vali Acc: 0.329 Test Loss: 1.677 Test Acc: 0.329
Validation loss decreased (-0.306340 --> -0.329463).  Saving model ...
Epoch: 3 cost time: 3.738715171813965
Epoch: 3, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.502 Vali Acc: 0.462 Test Loss: 1.502 Test Acc: 0.462
Validation loss decreased (-0.329463 --> -0.462413).  Saving model ...
Epoch: 4 cost time: 3.627073049545288
Epoch: 4, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.360 Vali Acc: 0.503 Test Loss: 1.360 Test Acc: 0.503
Validation loss decreased (-0.462413 --> -0.502877).  Saving model ...
Epoch: 5 cost time: 3.7986834049224854
Epoch: 5, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.222 Vali Acc: 0.607 Test Loss: 1.222 Test Acc: 0.607
Validation loss decreased (-0.502877 --> -0.606924).  Saving model ...
Epoch: 6 cost time: 3.60931134223938
Epoch: 6, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.128 Vali Acc: 0.676 Test Loss: 1.128 Test Acc: 0.676
Validation loss decreased (-0.606924 --> -0.676289).  Saving model ...
Epoch: 7 cost time: 3.8407187461853027
Epoch: 7, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.023 Vali Acc: 0.665 Test Loss: 1.023 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.775510787963867
Epoch: 8, Steps: 17 | Train Loss: 0.748 Vali Loss: 1.026 Vali Acc: 0.607 Test Loss: 1.026 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7211668491363525
Epoch: 9, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.850 Vali Acc: 0.757 Test Loss: 0.850 Test Acc: 0.757
Validation loss decreased (-0.676289 --> -0.757217).  Saving model ...
Epoch: 10 cost time: 3.786276340484619
Epoch: 10, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.776 Vali Acc: 0.740 Test Loss: 0.776 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.934476137161255
Epoch: 11, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.712 Vali Acc: 0.763 Test Loss: 0.712 Test Acc: 0.763
Validation loss decreased (-0.757217 --> -0.762999).  Saving model ...
Epoch: 12 cost time: 3.8784875869750977
Epoch: 12, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.766 Vali Acc: 0.763 Test Loss: 0.766 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3154966831207275
Epoch: 13, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.668 Vali Acc: 0.763 Test Loss: 0.668 Test Acc: 0.763
Validation loss decreased (-0.762999 --> -0.762999).  Saving model ...
Epoch: 14 cost time: 3.195563316345215
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.599 Vali Acc: 0.769 Test Loss: 0.599 Test Acc: 0.769
Validation loss decreased (-0.762999 --> -0.768780).  Saving model ...
Epoch: 15 cost time: 3.560790538787842
Epoch: 15, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
Validation loss decreased (-0.768780 --> -0.809242).  Saving model ...
Epoch: 16 cost time: 3.2477638721466064
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.619 Vali Acc: 0.821 Test Loss: 0.619 Test Acc: 0.821
Validation loss decreased (-0.809242 --> -0.820803).  Saving model ...
Epoch: 17 cost time: 3.5289242267608643
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4902114868164062
Epoch: 18, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.629 Vali Acc: 0.769 Test Loss: 0.629 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.371900796890259
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.604 Vali Acc: 0.827 Test Loss: 0.604 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826584).  Saving model ...
Epoch: 20 cost time: 3.441540479660034
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.508443593978882
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.651 Vali Acc: 0.786 Test Loss: 0.651 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.5071918964385986
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.650 Vali Acc: 0.786 Test Loss: 0.650 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.170340061187744
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.646 Vali Acc: 0.798 Test Loss: 0.646 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.5577313899993896
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.741 Vali Acc: 0.786 Test Loss: 0.741 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.572838306427002
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.717 Vali Acc: 0.786 Test Loss: 0.717 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.3246943950653076
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.691 Vali Acc: 0.809 Test Loss: 0.691 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.457951307296753
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.766 Vali Acc: 0.786 Test Loss: 0.766 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.3978230953216553
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.803 Test Loss: 0.681 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.5235416889190674
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.824 Vali Acc: 0.786 Test Loss: 0.824 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 502327
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.4215075969696045
Epoch: 1, Steps: 17 | Train Loss: 2.003 Vali Loss: 1.917 Vali Acc: 0.162 Test Loss: 1.917 Test Acc: 0.162
Validation loss decreased (inf --> -0.161831).  Saving model ...
Epoch: 2 cost time: 1.8472034931182861
Epoch: 2, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.747 Vali Acc: 0.312 Test Loss: 1.747 Test Acc: 0.312
Validation loss decreased (-0.161831 --> -0.312121).  Saving model ...
Epoch: 3 cost time: 1.7432012557983398
Epoch: 3, Steps: 17 | Train Loss: 1.616 Vali Loss: 1.544 Vali Acc: 0.393 Test Loss: 1.544 Test Acc: 0.393
Validation loss decreased (-0.312121 --> -0.393048).  Saving model ...
Epoch: 4 cost time: 1.9931435585021973
Epoch: 4, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.388 Vali Acc: 0.445 Test Loss: 1.388 Test Acc: 0.445
Validation loss decreased (-0.393048 --> -0.445073).  Saving model ...
Epoch: 5 cost time: 2.4995927810668945
Epoch: 5, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.256 Vali Acc: 0.468 Test Loss: 1.256 Test Acc: 0.468
Validation loss decreased (-0.445073 --> -0.468196).  Saving model ...
Epoch: 6 cost time: 2.6427457332611084
Epoch: 6, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.146 Vali Acc: 0.555 Test Loss: 1.146 Test Acc: 0.555
Validation loss decreased (-0.468196 --> -0.554902).  Saving model ...
Epoch: 7 cost time: 2.8185346126556396
Epoch: 7, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.033 Vali Acc: 0.618 Test Loss: 1.033 Test Acc: 0.618
Validation loss decreased (-0.554902 --> -0.618487).  Saving model ...
Epoch: 8 cost time: 2.8403613567352295
Epoch: 8, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.908 Vali Acc: 0.688 Test Loss: 0.908 Test Acc: 0.688
Validation loss decreased (-0.618487 --> -0.687852).  Saving model ...
Epoch: 9 cost time: 2.8210742473602295
Epoch: 9, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.846 Vali Acc: 0.682 Test Loss: 0.846 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7618722915649414
Epoch: 10, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.749 Vali Acc: 0.792 Test Loss: 0.749 Test Acc: 0.792
Validation loss decreased (-0.687852 --> -0.791900).  Saving model ...
Epoch: 11 cost time: 2.7150700092315674
Epoch: 11, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.695 Vali Acc: 0.792 Test Loss: 0.695 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791901).  Saving model ...
Epoch: 12 cost time: 2.7461917400360107
Epoch: 12, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809243).  Saving model ...
Epoch: 13 cost time: 2.7915797233581543
Epoch: 13, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.597 Vali Acc: 0.775 Test Loss: 0.597 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8612911701202393
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.596 Vali Acc: 0.786 Test Loss: 0.596 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.647465229034424
Epoch: 15, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.480 Vali Acc: 0.838 Test Loss: 0.480 Test Acc: 0.838
Validation loss decreased (-0.809243 --> -0.838145).  Saving model ...
Epoch: 16 cost time: 2.568850040435791
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.573 Vali Acc: 0.746 Test Loss: 0.573 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.878063678741455
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.549 Vali Acc: 0.792 Test Loss: 0.549 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8712830543518066
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.574 Vali Acc: 0.780 Test Loss: 0.574 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9561963081359863
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.526 Vali Acc: 0.792 Test Loss: 0.526 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9211831092834473
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.528 Vali Acc: 0.786 Test Loss: 0.528 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.852586507797241
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.538 Vali Acc: 0.763 Test Loss: 0.538 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.023306131362915
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.578 Vali Acc: 0.780 Test Loss: 0.578 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.8933868408203125
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.607 Vali Acc: 0.786 Test Loss: 0.607 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.867154359817505
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.576 Vali Acc: 0.792 Test Loss: 0.576 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.737931728363037
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.611 Vali Acc: 0.775 Test Loss: 0.611 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 191863
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.733698129653931
Epoch: 1, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.847 Vali Acc: 0.306 Test Loss: 1.847 Test Acc: 0.306
Validation loss decreased (inf --> -0.306340).  Saving model ...
Epoch: 2 cost time: 2.883610486984253
Epoch: 2, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.677 Vali Acc: 0.329 Test Loss: 1.677 Test Acc: 0.329
Validation loss decreased (-0.306340 --> -0.329463).  Saving model ...
Epoch: 3 cost time: 2.988696575164795
Epoch: 3, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.502 Vali Acc: 0.462 Test Loss: 1.502 Test Acc: 0.462
Validation loss decreased (-0.329463 --> -0.462413).  Saving model ...
Epoch: 4 cost time: 3.3512918949127197
Epoch: 4, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.360 Vali Acc: 0.503 Test Loss: 1.360 Test Acc: 0.503
Validation loss decreased (-0.462413 --> -0.502877).  Saving model ...
Epoch: 5 cost time: 3.081148386001587
Epoch: 5, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.222 Vali Acc: 0.607 Test Loss: 1.222 Test Acc: 0.607
Validation loss decreased (-0.502877 --> -0.606924).  Saving model ...
Epoch: 6 cost time: 3.0614731311798096
Epoch: 6, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.128 Vali Acc: 0.676 Test Loss: 1.128 Test Acc: 0.676
Validation loss decreased (-0.606924 --> -0.676289).  Saving model ...
Epoch: 7 cost time: 2.9435136318206787
Epoch: 7, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.023 Vali Acc: 0.665 Test Loss: 1.023 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0800766944885254
Epoch: 8, Steps: 17 | Train Loss: 0.748 Vali Loss: 1.026 Vali Acc: 0.607 Test Loss: 1.026 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.160114049911499
Epoch: 9, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.850 Vali Acc: 0.757 Test Loss: 0.850 Test Acc: 0.757
Validation loss decreased (-0.676289 --> -0.757217).  Saving model ...
Epoch: 10 cost time: 3.131722927093506
Epoch: 10, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.776 Vali Acc: 0.740 Test Loss: 0.776 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1054463386535645
Epoch: 11, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.712 Vali Acc: 0.763 Test Loss: 0.712 Test Acc: 0.763
Validation loss decreased (-0.757217 --> -0.762999).  Saving model ...
Epoch: 12 cost time: 3.033173084259033
Epoch: 12, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.766 Vali Acc: 0.763 Test Loss: 0.766 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0276174545288086
Epoch: 13, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.668 Vali Acc: 0.763 Test Loss: 0.668 Test Acc: 0.763
Validation loss decreased (-0.762999 --> -0.762999).  Saving model ...
Epoch: 14 cost time: 2.9610230922698975
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.599 Vali Acc: 0.769 Test Loss: 0.599 Test Acc: 0.769
Validation loss decreased (-0.762999 --> -0.768780).  Saving model ...
Epoch: 15 cost time: 3.327967405319214
Epoch: 15, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
Validation loss decreased (-0.768780 --> -0.809242).  Saving model ...
Epoch: 16 cost time: 3.046083450317383
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.619 Vali Acc: 0.821 Test Loss: 0.619 Test Acc: 0.821
Validation loss decreased (-0.809242 --> -0.820803).  Saving model ...
Epoch: 17 cost time: 3.0751888751983643
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.943021535873413
Epoch: 18, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.629 Vali Acc: 0.780 Test Loss: 0.629 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8885254859924316
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.604 Vali Acc: 0.827 Test Loss: 0.604 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826584).  Saving model ...
Epoch: 20 cost time: 3.3990607261657715
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.627 Vali Acc: 0.803 Test Loss: 0.627 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3702516555786133
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.649 Vali Acc: 0.798 Test Loss: 0.649 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.335937023162842
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.649 Vali Acc: 0.786 Test Loss: 0.649 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.174471378326416
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.645 Vali Acc: 0.798 Test Loss: 0.645 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.2259116172790527
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.744 Vali Acc: 0.786 Test Loss: 0.744 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.3090994358062744
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.722 Vali Acc: 0.786 Test Loss: 0.722 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.2104318141937256
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.702 Vali Acc: 0.786 Test Loss: 0.702 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.3530497550964355
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.773 Vali Acc: 0.786 Test Loss: 0.773 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.1346781253814697
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.700 Vali Acc: 0.798 Test Loss: 0.700 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.139399290084839
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.780 Test Loss: 0.793 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 502327
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.9093127250671387
Epoch: 1, Steps: 17 | Train Loss: 2.003 Vali Loss: 1.917 Vali Acc: 0.162 Test Loss: 1.917 Test Acc: 0.162
Validation loss decreased (inf --> -0.161831).  Saving model ...
Epoch: 2 cost time: 2.2454724311828613
Epoch: 2, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.747 Vali Acc: 0.312 Test Loss: 1.747 Test Acc: 0.312
Validation loss decreased (-0.161831 --> -0.312121).  Saving model ...
Epoch: 3 cost time: 2.224250078201294
Epoch: 3, Steps: 17 | Train Loss: 1.616 Vali Loss: 1.544 Vali Acc: 0.393 Test Loss: 1.544 Test Acc: 0.393
Validation loss decreased (-0.312121 --> -0.393048).  Saving model ...
Epoch: 4 cost time: 2.479257345199585
Epoch: 4, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.388 Vali Acc: 0.445 Test Loss: 1.388 Test Acc: 0.445
Validation loss decreased (-0.393048 --> -0.445073).  Saving model ...
Epoch: 5 cost time: 2.334296226501465
Epoch: 5, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.256 Vali Acc: 0.468 Test Loss: 1.256 Test Acc: 0.468
Validation loss decreased (-0.445073 --> -0.468196).  Saving model ...
Epoch: 6 cost time: 2.2598729133605957
Epoch: 6, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.146 Vali Acc: 0.555 Test Loss: 1.146 Test Acc: 0.555
Validation loss decreased (-0.468196 --> -0.554902).  Saving model ...
Epoch: 7 cost time: 2.283155679702759
Epoch: 7, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.033 Vali Acc: 0.618 Test Loss: 1.033 Test Acc: 0.618
Validation loss decreased (-0.554902 --> -0.618487).  Saving model ...
Epoch: 8 cost time: 2.2813587188720703
Epoch: 8, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.908 Vali Acc: 0.688 Test Loss: 0.908 Test Acc: 0.688
Validation loss decreased (-0.618487 --> -0.687852).  Saving model ...
Epoch: 9 cost time: 2.3908939361572266
Epoch: 9, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.846 Vali Acc: 0.682 Test Loss: 0.846 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3193652629852295
Epoch: 10, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.749 Vali Acc: 0.792 Test Loss: 0.749 Test Acc: 0.792
Validation loss decreased (-0.687852 --> -0.791900).  Saving model ...
Epoch: 11 cost time: 2.227729558944702
Epoch: 11, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.695 Vali Acc: 0.792 Test Loss: 0.695 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791901).  Saving model ...
Epoch: 12 cost time: 2.2914059162139893
Epoch: 12, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809243).  Saving model ...
Epoch: 13 cost time: 2.4433295726776123
Epoch: 13, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.596 Vali Acc: 0.775 Test Loss: 0.596 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.318147659301758
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.596 Vali Acc: 0.786 Test Loss: 0.596 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2111377716064453
Epoch: 15, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.480 Vali Acc: 0.838 Test Loss: 0.480 Test Acc: 0.838
Validation loss decreased (-0.809243 --> -0.838145).  Saving model ...
Epoch: 16 cost time: 2.326932668685913
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.574 Vali Acc: 0.746 Test Loss: 0.574 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.272024154663086
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.545 Vali Acc: 0.792 Test Loss: 0.545 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.408282995223999
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.571 Vali Acc: 0.775 Test Loss: 0.571 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2951271533966064
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.542 Vali Acc: 0.792 Test Loss: 0.542 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.3530361652374268
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.520 Vali Acc: 0.786 Test Loss: 0.520 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.342240333557129
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.555 Vali Acc: 0.775 Test Loss: 0.555 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.1413538455963135
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.562 Vali Acc: 0.780 Test Loss: 0.562 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.3737306594848633
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.600 Vali Acc: 0.786 Test Loss: 0.600 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.254969358444214
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.568 Vali Acc: 0.786 Test Loss: 0.568 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.086493730545044
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.599 Vali Acc: 0.786 Test Loss: 0.599 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 191863
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.0308380126953125
Epoch: 1, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.847 Vali Acc: 0.306 Test Loss: 1.847 Test Acc: 0.306
Validation loss decreased (inf --> -0.306340).  Saving model ...
Epoch: 2 cost time: 2.5131077766418457
Epoch: 2, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.677 Vali Acc: 0.329 Test Loss: 1.677 Test Acc: 0.329
Validation loss decreased (-0.306340 --> -0.329463).  Saving model ...
Epoch: 3 cost time: 2.4537596702575684
Epoch: 3, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.502 Vali Acc: 0.462 Test Loss: 1.502 Test Acc: 0.462
Validation loss decreased (-0.329463 --> -0.462413).  Saving model ...
Epoch: 4 cost time: 2.552950620651245
Epoch: 4, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.360 Vali Acc: 0.503 Test Loss: 1.360 Test Acc: 0.503
Validation loss decreased (-0.462413 --> -0.502877).  Saving model ...
Epoch: 5 cost time: 2.234687566757202
Epoch: 5, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.222 Vali Acc: 0.607 Test Loss: 1.222 Test Acc: 0.607
Validation loss decreased (-0.502877 --> -0.606924).  Saving model ...
Epoch: 6 cost time: 2.5090479850769043
Epoch: 6, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.128 Vali Acc: 0.676 Test Loss: 1.128 Test Acc: 0.676
Validation loss decreased (-0.606924 --> -0.676289).  Saving model ...
Epoch: 7 cost time: 2.5913872718811035
Epoch: 7, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.023 Vali Acc: 0.665 Test Loss: 1.023 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.516371011734009
Epoch: 8, Steps: 17 | Train Loss: 0.748 Vali Loss: 1.026 Vali Acc: 0.607 Test Loss: 1.026 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3062684535980225
Epoch: 9, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.850 Vali Acc: 0.757 Test Loss: 0.850 Test Acc: 0.757
Validation loss decreased (-0.676289 --> -0.757217).  Saving model ...
Epoch: 10 cost time: 2.2548139095306396
Epoch: 10, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.776 Vali Acc: 0.740 Test Loss: 0.776 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.530076026916504
Epoch: 11, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.711 Vali Acc: 0.763 Test Loss: 0.711 Test Acc: 0.763
Validation loss decreased (-0.757217 --> -0.762999).  Saving model ...
Epoch: 12 cost time: 2.5619564056396484
Epoch: 12, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.772 Vali Acc: 0.751 Test Loss: 0.772 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6374168395996094
Epoch: 13, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.668 Vali Acc: 0.775 Test Loss: 0.668 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774560).  Saving model ...
Epoch: 14 cost time: 2.3018085956573486
Epoch: 14, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.595 Vali Acc: 0.786 Test Loss: 0.595 Test Acc: 0.786
Validation loss decreased (-0.774560 --> -0.786121).  Saving model ...
Epoch: 15 cost time: 2.268052101135254
Epoch: 15, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.637 Vali Acc: 0.803 Test Loss: 0.637 Test Acc: 0.803
Validation loss decreased (-0.786121 --> -0.803462).  Saving model ...
Epoch: 16 cost time: 2.770275831222534
Epoch: 16, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809242).  Saving model ...
Epoch: 17 cost time: 2.3517980575561523
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.576 Vali Acc: 0.809 Test Loss: 0.576 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809243).  Saving model ...
Epoch: 18 cost time: 2.557279586791992
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.781538486480713
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.630 Vali Acc: 0.786 Test Loss: 0.630 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.557124614715576
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.639 Vali Acc: 0.792 Test Loss: 0.639 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2302918434143066
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.651 Vali Acc: 0.798 Test Loss: 0.651 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.27531099319458
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.635 Vali Acc: 0.786 Test Loss: 0.635 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.769327402114868
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.659 Vali Acc: 0.763 Test Loss: 0.659 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.814379930496216
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.681 Vali Acc: 0.798 Test Loss: 0.681 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8465940952301025
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.673 Vali Acc: 0.780 Test Loss: 0.673 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.7890262603759766
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.702 Vali Acc: 0.775 Test Loss: 0.702 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.5643115043640137
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.691 Vali Acc: 0.798 Test Loss: 0.691 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 502327
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.608971118927002
Epoch: 1, Steps: 17 | Train Loss: 2.003 Vali Loss: 1.917 Vali Acc: 0.162 Test Loss: 1.917 Test Acc: 0.162
Validation loss decreased (inf --> -0.161831).  Saving model ...
Epoch: 2 cost time: 2.0523972511291504
Epoch: 2, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.747 Vali Acc: 0.312 Test Loss: 1.747 Test Acc: 0.312
Validation loss decreased (-0.161831 --> -0.312121).  Saving model ...
Epoch: 3 cost time: 2.002934694290161
Epoch: 3, Steps: 17 | Train Loss: 1.616 Vali Loss: 1.544 Vali Acc: 0.393 Test Loss: 1.544 Test Acc: 0.393
Validation loss decreased (-0.312121 --> -0.393048).  Saving model ...
Epoch: 4 cost time: 2.0454301834106445
Epoch: 4, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.388 Vali Acc: 0.445 Test Loss: 1.388 Test Acc: 0.445
Validation loss decreased (-0.393048 --> -0.445073).  Saving model ...
Epoch: 5 cost time: 2.1511809825897217
Epoch: 5, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.256 Vali Acc: 0.468 Test Loss: 1.256 Test Acc: 0.468
Validation loss decreased (-0.445073 --> -0.468196).  Saving model ...
Epoch: 6 cost time: 2.284571647644043
Epoch: 6, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.146 Vali Acc: 0.555 Test Loss: 1.146 Test Acc: 0.555
Validation loss decreased (-0.468196 --> -0.554902).  Saving model ...
Epoch: 7 cost time: 2.2276394367218018
Epoch: 7, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.033 Vali Acc: 0.618 Test Loss: 1.033 Test Acc: 0.618
Validation loss decreased (-0.554902 --> -0.618487).  Saving model ...
Epoch: 8 cost time: 2.1072773933410645
Epoch: 8, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.908 Vali Acc: 0.688 Test Loss: 0.908 Test Acc: 0.688
Validation loss decreased (-0.618487 --> -0.687852).  Saving model ...
Epoch: 9 cost time: 2.2324845790863037
Epoch: 9, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.846 Vali Acc: 0.682 Test Loss: 0.846 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0229151248931885
Epoch: 10, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.749 Vali Acc: 0.792 Test Loss: 0.749 Test Acc: 0.792
Validation loss decreased (-0.687852 --> -0.791900).  Saving model ...
Epoch: 11 cost time: 2.029165506362915
Epoch: 11, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.695 Vali Acc: 0.786 Test Loss: 0.695 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0737931728363037
Epoch: 12, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.548 Vali Acc: 0.832 Test Loss: 0.548 Test Acc: 0.832
Validation loss decreased (-0.791900 --> -0.832364).  Saving model ...
Epoch: 13 cost time: 2.074803352355957
Epoch: 13, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.596 Vali Acc: 0.769 Test Loss: 0.596 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0783939361572266
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.076915979385376
Epoch: 15, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
Validation loss decreased (-0.832364 --> -0.843926).  Saving model ...
Epoch: 16 cost time: 2.146233558654785
Epoch: 16, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.570 Vali Acc: 0.746 Test Loss: 0.570 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2009122371673584
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.548 Vali Acc: 0.780 Test Loss: 0.548 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3129446506500244
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.569 Vali Acc: 0.775 Test Loss: 0.569 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1545095443725586
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.546 Vali Acc: 0.792 Test Loss: 0.546 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.2634317874908447
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.522 Vali Acc: 0.786 Test Loss: 0.522 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.2449326515197754
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.559 Vali Acc: 0.780 Test Loss: 0.559 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.283816337585449
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.566 Vali Acc: 0.780 Test Loss: 0.566 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2201898097991943
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.602 Vali Acc: 0.786 Test Loss: 0.602 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9759409427642822
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.583 Vali Acc: 0.780 Test Loss: 0.583 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0855865478515625
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.606 Vali Acc: 0.786 Test Loss: 0.606 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 191863
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.591534852981567
Epoch: 1, Steps: 17 | Train Loss: 1.940 Vali Loss: 1.891 Vali Acc: 0.225 Test Loss: 1.891 Test Acc: 0.225
Validation loss decreased (inf --> -0.225415).  Saving model ...
Epoch: 2 cost time: 4.350935459136963
Epoch: 2, Steps: 17 | Train Loss: 1.833 Vali Loss: 1.773 Vali Acc: 0.272 Test Loss: 1.773 Test Acc: 0.272
Validation loss decreased (-0.225415 --> -0.271659).  Saving model ...
Epoch: 3 cost time: 4.068491458892822
Epoch: 3, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.634 Vali Acc: 0.370 Test Loss: 1.634 Test Acc: 0.370
Validation loss decreased (-0.271659 --> -0.369926).  Saving model ...
Epoch: 4 cost time: 4.34837794303894
Epoch: 4, Steps: 17 | Train Loss: 1.538 Vali Loss: 1.491 Vali Acc: 0.382 Test Loss: 1.491 Test Acc: 0.382
Validation loss decreased (-0.369926 --> -0.381488).  Saving model ...
Epoch: 5 cost time: 4.240942716598511
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.348 Vali Acc: 0.474 Test Loss: 1.348 Test Acc: 0.474
Validation loss decreased (-0.381488 --> -0.473975).  Saving model ...
Epoch: 6 cost time: 4.295551776885986
Epoch: 6, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.260 Vali Acc: 0.538 Test Loss: 1.260 Test Acc: 0.538
Validation loss decreased (-0.473975 --> -0.537560).  Saving model ...
Epoch: 7 cost time: 4.190822124481201
Epoch: 7, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.156 Vali Acc: 0.601 Test Loss: 1.156 Test Acc: 0.601
Validation loss decreased (-0.537560 --> -0.601145).  Saving model ...
Epoch: 8 cost time: 4.056267261505127
Epoch: 8, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.062 Vali Acc: 0.642 Test Loss: 1.062 Test Acc: 0.642
Validation loss decreased (-0.601145 --> -0.641608).  Saving model ...
Epoch: 9 cost time: 4.324211359024048
Epoch: 9, Steps: 17 | Train Loss: 0.907 Vali Loss: 0.955 Vali Acc: 0.699 Test Loss: 0.955 Test Acc: 0.699
Validation loss decreased (-0.641608 --> -0.699412).  Saving model ...
Epoch: 10 cost time: 4.251128435134888
Epoch: 10, Steps: 17 | Train Loss: 0.783 Vali Loss: 0.903 Vali Acc: 0.676 Test Loss: 0.903 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.2369959354400635
Epoch: 11, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.832 Vali Acc: 0.723 Test Loss: 0.832 Test Acc: 0.723
Validation loss decreased (-0.699412 --> -0.722535).  Saving model ...
Epoch: 12 cost time: 4.213414192199707
Epoch: 12, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.880 Vali Acc: 0.694 Test Loss: 0.880 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.311301946640015
Epoch: 13, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.713 Vali Acc: 0.786 Test Loss: 0.713 Test Acc: 0.786
Validation loss decreased (-0.722535 --> -0.786120).  Saving model ...
Epoch: 14 cost time: 3.9536094665527344
Epoch: 14, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.763 Vali Acc: 0.751 Test Loss: 0.763 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.92893385887146
Epoch: 15, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.691 Vali Acc: 0.786 Test Loss: 0.691 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 16 cost time: 4.59455418586731
Epoch: 16, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.570 Vali Acc: 0.803 Test Loss: 0.570 Test Acc: 0.803
Validation loss decreased (-0.786120 --> -0.803463).  Saving model ...
Epoch: 17 cost time: 4.550475835800171
Epoch: 17, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.574 Vali Acc: 0.827 Test Loss: 0.574 Test Acc: 0.827
Validation loss decreased (-0.803463 --> -0.826584).  Saving model ...
Epoch: 18 cost time: 4.4966795444488525
Epoch: 18, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.563 Vali Acc: 0.792 Test Loss: 0.563 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.565005540847778
Epoch: 19, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.574 Vali Acc: 0.803 Test Loss: 0.574 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.569781541824341
Epoch: 20, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.560 Vali Acc: 0.821 Test Loss: 0.560 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.50961446762085
Epoch: 21, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.586 Vali Acc: 0.786 Test Loss: 0.586 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.583118438720703
Epoch: 22, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.625 Vali Acc: 0.792 Test Loss: 0.625 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.566351652145386
Epoch: 23, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.608468532562256
Epoch: 24, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
Validation loss decreased (-0.826584 --> -0.855487).  Saving model ...
Epoch: 25 cost time: 4.5385894775390625
Epoch: 25, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.559 Vali Acc: 0.827 Test Loss: 0.559 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.7174787521362305
Epoch: 26, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861267).  Saving model ...
Epoch: 27 cost time: 4.410441160202026
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.740596771240234
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.596 Vali Acc: 0.786 Test Loss: 0.596 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.561031103134155
Epoch: 29, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.546 Vali Acc: 0.827 Test Loss: 0.546 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.592955112457275
Epoch: 30, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.665 Vali Acc: 0.751 Test Loss: 0.665 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 911119
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.864973068237305
Epoch: 1, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.891 Vali Acc: 0.185 Test Loss: 1.891 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 2.9578444957733154
Epoch: 2, Steps: 17 | Train Loss: 1.852 Vali Loss: 1.784 Vali Acc: 0.289 Test Loss: 1.784 Test Acc: 0.289
Validation loss decreased (-0.184952 --> -0.289000).  Saving model ...
Epoch: 3 cost time: 2.9489850997924805
Epoch: 3, Steps: 17 | Train Loss: 1.715 Vali Loss: 1.677 Vali Acc: 0.272 Test Loss: 1.677 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0323479175567627
Epoch: 4, Steps: 17 | Train Loss: 1.579 Vali Loss: 1.533 Vali Acc: 0.341 Test Loss: 1.533 Test Acc: 0.341
Validation loss decreased (-0.289000 --> -0.341025).  Saving model ...
Epoch: 5 cost time: 2.9818930625915527
Epoch: 5, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.404 Vali Acc: 0.491 Test Loss: 1.404 Test Acc: 0.491
Validation loss decreased (-0.341025 --> -0.491315).  Saving model ...
Epoch: 6 cost time: 2.9211103916168213
Epoch: 6, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.317 Vali Acc: 0.514 Test Loss: 1.317 Test Acc: 0.514
Validation loss decreased (-0.491315 --> -0.514438).  Saving model ...
Epoch: 7 cost time: 2.9293832778930664
Epoch: 7, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.218 Vali Acc: 0.538 Test Loss: 1.218 Test Acc: 0.538
Validation loss decreased (-0.514438 --> -0.537560).  Saving model ...
Epoch: 8 cost time: 2.9580798149108887
Epoch: 8, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.139 Vali Acc: 0.584 Test Loss: 1.139 Test Acc: 0.584
Validation loss decreased (-0.537560 --> -0.583804).  Saving model ...
Epoch: 9 cost time: 2.9739835262298584
Epoch: 9, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.034 Vali Acc: 0.659 Test Loss: 1.034 Test Acc: 0.659
Validation loss decreased (-0.583804 --> -0.658949).  Saving model ...
Epoch: 10 cost time: 2.8703746795654297
Epoch: 10, Steps: 17 | Train Loss: 0.791 Vali Loss: 0.917 Vali Acc: 0.717 Test Loss: 0.917 Test Acc: 0.717
Validation loss decreased (-0.658949 --> -0.716754).  Saving model ...
Epoch: 11 cost time: 2.7435152530670166
Epoch: 11, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.910 Vali Acc: 0.676 Test Loss: 0.910 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7439565658569336
Epoch: 12, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.770 Vali Acc: 0.717 Test Loss: 0.770 Test Acc: 0.717
Validation loss decreased (-0.716754 --> -0.716755).  Saving model ...
Epoch: 13 cost time: 2.8280303478240967
Epoch: 13, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.739 Vali Acc: 0.728 Test Loss: 0.739 Test Acc: 0.728
Validation loss decreased (-0.716755 --> -0.728316).  Saving model ...
Epoch: 14 cost time: 2.7316958904266357
Epoch: 14, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.687 Vali Acc: 0.723 Test Loss: 0.687 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.841073513031006
Epoch: 15, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.616 Vali Acc: 0.740 Test Loss: 0.616 Test Acc: 0.740
Validation loss decreased (-0.728316 --> -0.739878).  Saving model ...
Epoch: 16 cost time: 2.6584532260894775
Epoch: 16, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.638 Vali Acc: 0.757 Test Loss: 0.638 Test Acc: 0.757
Validation loss decreased (-0.739878 --> -0.757219).  Saving model ...
Epoch: 17 cost time: 2.7473678588867188
Epoch: 17, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.623 Vali Acc: 0.775 Test Loss: 0.623 Test Acc: 0.775
Validation loss decreased (-0.757219 --> -0.774560).  Saving model ...
Epoch: 18 cost time: 2.8254201412200928
Epoch: 18, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.589 Vali Acc: 0.792 Test Loss: 0.589 Test Acc: 0.792
Validation loss decreased (-0.774560 --> -0.791902).  Saving model ...
Epoch: 19 cost time: 2.9671037197113037
Epoch: 19, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.531 Vali Acc: 0.780 Test Loss: 0.531 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2771573066711426
Epoch: 20, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.520 Vali Acc: 0.780 Test Loss: 0.520 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0074269771575928
Epoch: 21, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.519 Vali Acc: 0.780 Test Loss: 0.519 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2580645084381104
Epoch: 22, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.573 Vali Acc: 0.751 Test Loss: 0.573 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.146514654159546
Epoch: 23, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.592 Vali Acc: 0.769 Test Loss: 0.592 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.096640110015869
Epoch: 24, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.525 Vali Acc: 0.798 Test Loss: 0.525 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797683).  Saving model ...
Epoch: 25 cost time: 3.1890692710876465
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
Validation loss decreased (-0.797683 --> -0.809243).  Saving model ...
Epoch: 26 cost time: 3.0515034198760986
Epoch: 26, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.496 Vali Acc: 0.798 Test Loss: 0.496 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.1115846633911133
Epoch: 27, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.523 Vali Acc: 0.792 Test Loss: 0.523 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.229823589324951
Epoch: 28, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.496 Vali Acc: 0.821 Test Loss: 0.496 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820804).  Saving model ...
Epoch: 29 cost time: 3.2584407329559326
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.523 Vali Acc: 0.821 Test Loss: 0.523 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.1788392066955566
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.504 Vali Acc: 0.827 Test Loss: 0.504 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826585).  Saving model ...
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 290143
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.573427200317383
Epoch: 1, Steps: 17 | Train Loss: 1.940 Vali Loss: 1.891 Vali Acc: 0.225 Test Loss: 1.891 Test Acc: 0.225
Validation loss decreased (inf --> -0.225415).  Saving model ...
Epoch: 2 cost time: 3.7908568382263184
Epoch: 2, Steps: 17 | Train Loss: 1.833 Vali Loss: 1.773 Vali Acc: 0.272 Test Loss: 1.773 Test Acc: 0.272
Validation loss decreased (-0.225415 --> -0.271659).  Saving model ...
Epoch: 3 cost time: 3.76291823387146
Epoch: 3, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.634 Vali Acc: 0.370 Test Loss: 1.634 Test Acc: 0.370
Validation loss decreased (-0.271659 --> -0.369926).  Saving model ...
Epoch: 4 cost time: 3.627391815185547
Epoch: 4, Steps: 17 | Train Loss: 1.538 Vali Loss: 1.491 Vali Acc: 0.382 Test Loss: 1.491 Test Acc: 0.382
Validation loss decreased (-0.369926 --> -0.381488).  Saving model ...
Epoch: 5 cost time: 3.5077006816864014
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.348 Vali Acc: 0.474 Test Loss: 1.348 Test Acc: 0.474
Validation loss decreased (-0.381488 --> -0.473975).  Saving model ...
Epoch: 6 cost time: 3.806070327758789
Epoch: 6, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.260 Vali Acc: 0.538 Test Loss: 1.260 Test Acc: 0.538
Validation loss decreased (-0.473975 --> -0.537560).  Saving model ...
Epoch: 7 cost time: 3.7592194080352783
Epoch: 7, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.156 Vali Acc: 0.601 Test Loss: 1.156 Test Acc: 0.601
Validation loss decreased (-0.537560 --> -0.601145).  Saving model ...
Epoch: 8 cost time: 3.704476833343506
Epoch: 8, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.062 Vali Acc: 0.642 Test Loss: 1.062 Test Acc: 0.642
Validation loss decreased (-0.601145 --> -0.641608).  Saving model ...
Epoch: 9 cost time: 3.6842293739318848
Epoch: 9, Steps: 17 | Train Loss: 0.907 Vali Loss: 0.955 Vali Acc: 0.699 Test Loss: 0.955 Test Acc: 0.699
Validation loss decreased (-0.641608 --> -0.699412).  Saving model ...
Epoch: 10 cost time: 3.5942962169647217
Epoch: 10, Steps: 17 | Train Loss: 0.783 Vali Loss: 0.903 Vali Acc: 0.676 Test Loss: 0.903 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7440783977508545
Epoch: 11, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.832 Vali Acc: 0.723 Test Loss: 0.832 Test Acc: 0.723
Validation loss decreased (-0.699412 --> -0.722535).  Saving model ...
Epoch: 12 cost time: 3.7788126468658447
Epoch: 12, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.880 Vali Acc: 0.694 Test Loss: 0.880 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.861875295639038
Epoch: 13, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.713 Vali Acc: 0.786 Test Loss: 0.713 Test Acc: 0.786
Validation loss decreased (-0.722535 --> -0.786120).  Saving model ...
Epoch: 14 cost time: 3.659536600112915
Epoch: 14, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.763 Vali Acc: 0.751 Test Loss: 0.763 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.401085615158081
Epoch: 15, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.689 Vali Acc: 0.786 Test Loss: 0.689 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 16 cost time: 3.517930507659912
Epoch: 16, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.580 Vali Acc: 0.815 Test Loss: 0.580 Test Acc: 0.815
Validation loss decreased (-0.786120 --> -0.815023).  Saving model ...
Epoch: 17 cost time: 3.5396883487701416
Epoch: 17, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5952565670013428
Epoch: 18, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.583 Vali Acc: 0.821 Test Loss: 0.583 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820803).  Saving model ...
Epoch: 19 cost time: 3.531825065612793
Epoch: 19, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.591 Vali Acc: 0.821 Test Loss: 0.591 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.671903133392334
Epoch: 20, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.533 Vali Acc: 0.832 Test Loss: 0.533 Test Acc: 0.832
Validation loss decreased (-0.820803 --> -0.832365).  Saving model ...
Epoch: 21 cost time: 3.634486675262451
Epoch: 21, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.651 Vali Acc: 0.775 Test Loss: 0.651 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4271161556243896
Epoch: 22, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.545 Vali Acc: 0.821 Test Loss: 0.545 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.703472375869751
Epoch: 23, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.611 Vali Acc: 0.792 Test Loss: 0.611 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.746990442276001
Epoch: 24, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.478 Vali Acc: 0.867 Test Loss: 0.478 Test Acc: 0.867
Validation loss decreased (-0.832365 --> -0.867047).  Saving model ...
Epoch: 25 cost time: 3.7285025119781494
Epoch: 25, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.571 Vali Acc: 0.832 Test Loss: 0.571 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7927567958831787
Epoch: 26, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.6655077934265137
Epoch: 27, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.609 Vali Acc: 0.815 Test Loss: 0.609 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.7148780822753906
Epoch: 28, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.633 Vali Acc: 0.769 Test Loss: 0.633 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.7048490047454834
Epoch: 29, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.6982405185699463
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.584 Vali Acc: 0.780 Test Loss: 0.584 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 911119
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.010676383972168
Epoch: 1, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.891 Vali Acc: 0.185 Test Loss: 1.891 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 2.303846836090088
Epoch: 2, Steps: 17 | Train Loss: 1.852 Vali Loss: 1.784 Vali Acc: 0.289 Test Loss: 1.784 Test Acc: 0.289
Validation loss decreased (-0.184952 --> -0.289000).  Saving model ...
Epoch: 3 cost time: 2.278440475463867
Epoch: 3, Steps: 17 | Train Loss: 1.715 Vali Loss: 1.677 Vali Acc: 0.272 Test Loss: 1.677 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3412272930145264
Epoch: 4, Steps: 17 | Train Loss: 1.579 Vali Loss: 1.533 Vali Acc: 0.341 Test Loss: 1.533 Test Acc: 0.341
Validation loss decreased (-0.289000 --> -0.341025).  Saving model ...
Epoch: 5 cost time: 2.4715235233306885
Epoch: 5, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.404 Vali Acc: 0.491 Test Loss: 1.404 Test Acc: 0.491
Validation loss decreased (-0.341025 --> -0.491315).  Saving model ...
Epoch: 6 cost time: 2.4099485874176025
Epoch: 6, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.317 Vali Acc: 0.514 Test Loss: 1.317 Test Acc: 0.514
Validation loss decreased (-0.491315 --> -0.514438).  Saving model ...
Epoch: 7 cost time: 2.555931568145752
Epoch: 7, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.218 Vali Acc: 0.538 Test Loss: 1.218 Test Acc: 0.538
Validation loss decreased (-0.514438 --> -0.537560).  Saving model ...
Epoch: 8 cost time: 2.4663619995117188
Epoch: 8, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.139 Vali Acc: 0.584 Test Loss: 1.139 Test Acc: 0.584
Validation loss decreased (-0.537560 --> -0.583804).  Saving model ...
Epoch: 9 cost time: 2.454251766204834
Epoch: 9, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.034 Vali Acc: 0.659 Test Loss: 1.034 Test Acc: 0.659
Validation loss decreased (-0.583804 --> -0.658949).  Saving model ...
Epoch: 10 cost time: 2.5790152549743652
Epoch: 10, Steps: 17 | Train Loss: 0.791 Vali Loss: 0.917 Vali Acc: 0.717 Test Loss: 0.917 Test Acc: 0.717
Validation loss decreased (-0.658949 --> -0.716754).  Saving model ...
Epoch: 11 cost time: 2.5598795413970947
Epoch: 11, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.911 Vali Acc: 0.676 Test Loss: 0.911 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.511324882507324
Epoch: 12, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.772 Vali Acc: 0.705 Test Loss: 0.772 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5946693420410156
Epoch: 13, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.740 Vali Acc: 0.734 Test Loss: 0.740 Test Acc: 0.734
Validation loss decreased (-0.716754 --> -0.734097).  Saving model ...
Epoch: 14 cost time: 2.4089088439941406
Epoch: 14, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.682 Vali Acc: 0.757 Test Loss: 0.682 Test Acc: 0.757
Validation loss decreased (-0.734097 --> -0.757219).  Saving model ...
Epoch: 15 cost time: 2.4716382026672363
Epoch: 15, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.616 Vali Acc: 0.751 Test Loss: 0.616 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.487870693206787
Epoch: 16, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.628 Vali Acc: 0.746 Test Loss: 0.628 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.522280693054199
Epoch: 17, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.609 Vali Acc: 0.769 Test Loss: 0.609 Test Acc: 0.769
Validation loss decreased (-0.757219 --> -0.768780).  Saving model ...
Epoch: 18 cost time: 2.520479202270508
Epoch: 18, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.560 Vali Acc: 0.798 Test Loss: 0.560 Test Acc: 0.798
Validation loss decreased (-0.768780 --> -0.797682).  Saving model ...
Epoch: 19 cost time: 2.505129814147949
Epoch: 19, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.539 Vali Acc: 0.786 Test Loss: 0.539 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.613424301147461
Epoch: 20, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.574 Vali Acc: 0.780 Test Loss: 0.574 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.56638765335083
Epoch: 21, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.552 Vali Acc: 0.780 Test Loss: 0.552 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.434903621673584
Epoch: 22, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.550 Vali Acc: 0.769 Test Loss: 0.550 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.591301679611206
Epoch: 23, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.610 Vali Acc: 0.746 Test Loss: 0.610 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.5845377445220947
Epoch: 24, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.539 Vali Acc: 0.792 Test Loss: 0.539 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.654395341873169
Epoch: 25, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.549 Vali Acc: 0.734 Test Loss: 0.549 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.0415806770324707
Epoch: 26, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.516 Vali Acc: 0.775 Test Loss: 0.516 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9885632991790771
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.494 Vali Acc: 0.786 Test Loss: 0.494 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.312903881072998
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803463).  Saving model ...
Epoch: 29 cost time: 2.5900797843933105
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.495 Vali Acc: 0.821 Test Loss: 0.495 Test Acc: 0.821
Validation loss decreased (-0.803463 --> -0.820804).  Saving model ...
Epoch: 30 cost time: 2.4194114208221436
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 290143
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.842057228088379
Epoch: 1, Steps: 17 | Train Loss: 1.940 Vali Loss: 1.891 Vali Acc: 0.225 Test Loss: 1.891 Test Acc: 0.225
Validation loss decreased (inf --> -0.225415).  Saving model ...
Epoch: 2 cost time: 2.4658491611480713
Epoch: 2, Steps: 17 | Train Loss: 1.833 Vali Loss: 1.773 Vali Acc: 0.272 Test Loss: 1.773 Test Acc: 0.272
Validation loss decreased (-0.225415 --> -0.271659).  Saving model ...
Epoch: 3 cost time: 2.41738224029541
Epoch: 3, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.634 Vali Acc: 0.370 Test Loss: 1.634 Test Acc: 0.370
Validation loss decreased (-0.271659 --> -0.369926).  Saving model ...
Epoch: 4 cost time: 2.530198335647583
Epoch: 4, Steps: 17 | Train Loss: 1.538 Vali Loss: 1.491 Vali Acc: 0.382 Test Loss: 1.491 Test Acc: 0.382
Validation loss decreased (-0.369926 --> -0.381488).  Saving model ...
Epoch: 5 cost time: 2.591665029525757
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.348 Vali Acc: 0.474 Test Loss: 1.348 Test Acc: 0.474
Validation loss decreased (-0.381488 --> -0.473975).  Saving model ...
Epoch: 6 cost time: 2.562511682510376
Epoch: 6, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.260 Vali Acc: 0.538 Test Loss: 1.260 Test Acc: 0.538
Validation loss decreased (-0.473975 --> -0.537560).  Saving model ...
Epoch: 7 cost time: 2.5338683128356934
Epoch: 7, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.156 Vali Acc: 0.601 Test Loss: 1.156 Test Acc: 0.601
Validation loss decreased (-0.537560 --> -0.601145).  Saving model ...
Epoch: 8 cost time: 2.635315418243408
Epoch: 8, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.062 Vali Acc: 0.642 Test Loss: 1.062 Test Acc: 0.642
Validation loss decreased (-0.601145 --> -0.641608).  Saving model ...
Epoch: 9 cost time: 2.5917277336120605
Epoch: 9, Steps: 17 | Train Loss: 0.907 Vali Loss: 0.955 Vali Acc: 0.699 Test Loss: 0.955 Test Acc: 0.699
Validation loss decreased (-0.641608 --> -0.699412).  Saving model ...
Epoch: 10 cost time: 2.560699462890625
Epoch: 10, Steps: 17 | Train Loss: 0.783 Vali Loss: 0.903 Vali Acc: 0.676 Test Loss: 0.903 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.617405414581299
Epoch: 11, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.832 Vali Acc: 0.723 Test Loss: 0.832 Test Acc: 0.723
Validation loss decreased (-0.699412 --> -0.722535).  Saving model ...
Epoch: 12 cost time: 2.473811626434326
Epoch: 12, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.880 Vali Acc: 0.694 Test Loss: 0.880 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.565336227416992
Epoch: 13, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.712 Vali Acc: 0.780 Test Loss: 0.712 Test Acc: 0.780
Validation loss decreased (-0.722535 --> -0.780340).  Saving model ...
Epoch: 14 cost time: 2.397378921508789
Epoch: 14, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.762 Vali Acc: 0.751 Test Loss: 0.762 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.456389904022217
Epoch: 15, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.697 Vali Acc: 0.780 Test Loss: 0.697 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780340).  Saving model ...
Epoch: 16 cost time: 2.298480987548828
Epoch: 16, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.567 Vali Acc: 0.832 Test Loss: 0.567 Test Acc: 0.832
Validation loss decreased (-0.780340 --> -0.832364).  Saving model ...
Epoch: 17 cost time: 2.37402081489563
Epoch: 17, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.591 Vali Acc: 0.821 Test Loss: 0.591 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.586515426635742
Epoch: 18, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3928306102752686
Epoch: 19, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.546 Vali Acc: 0.832 Test Loss: 0.546 Test Acc: 0.832
Validation loss decreased (-0.832364 --> -0.832364).  Saving model ...
Epoch: 20 cost time: 2.4833571910858154
Epoch: 20, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.533 Vali Acc: 0.855 Test Loss: 0.533 Test Acc: 0.855
Validation loss decreased (-0.832364 --> -0.855486).  Saving model ...
Epoch: 21 cost time: 2.5578396320343018
Epoch: 21, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.582 Vali Acc: 0.786 Test Loss: 0.582 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.716228485107422
Epoch: 22, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3689663410186768
Epoch: 23, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.522326707839966
Epoch: 24, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.505 Vali Acc: 0.832 Test Loss: 0.505 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.796034097671509
Epoch: 25, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.9827780723571777
Epoch: 26, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.476 Vali Acc: 0.873 Test Loss: 0.476 Test Acc: 0.873
Validation loss decreased (-0.855486 --> -0.872828).  Saving model ...
Epoch: 27 cost time: 2.8703417778015137
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.578 Vali Acc: 0.821 Test Loss: 0.578 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0598418712615967
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.599 Vali Acc: 0.786 Test Loss: 0.599 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8581905364990234
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.530 Vali Acc: 0.827 Test Loss: 0.530 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.8463094234466553
Epoch: 30, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.640 Vali Acc: 0.769 Test Loss: 0.640 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 911119
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.535736560821533
Epoch: 1, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.891 Vali Acc: 0.185 Test Loss: 1.891 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 1.9801359176635742
Epoch: 2, Steps: 17 | Train Loss: 1.852 Vali Loss: 1.784 Vali Acc: 0.289 Test Loss: 1.784 Test Acc: 0.289
Validation loss decreased (-0.184952 --> -0.289000).  Saving model ...
Epoch: 3 cost time: 2.0702803134918213
Epoch: 3, Steps: 17 | Train Loss: 1.715 Vali Loss: 1.677 Vali Acc: 0.272 Test Loss: 1.677 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9558782577514648
Epoch: 4, Steps: 17 | Train Loss: 1.579 Vali Loss: 1.533 Vali Acc: 0.341 Test Loss: 1.533 Test Acc: 0.341
Validation loss decreased (-0.289000 --> -0.341025).  Saving model ...
Epoch: 5 cost time: 1.901301383972168
Epoch: 5, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.404 Vali Acc: 0.491 Test Loss: 1.404 Test Acc: 0.491
Validation loss decreased (-0.341025 --> -0.491315).  Saving model ...
Epoch: 6 cost time: 1.934319019317627
Epoch: 6, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.317 Vali Acc: 0.514 Test Loss: 1.317 Test Acc: 0.514
Validation loss decreased (-0.491315 --> -0.514438).  Saving model ...
Epoch: 7 cost time: 2.036884307861328
Epoch: 7, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.218 Vali Acc: 0.538 Test Loss: 1.218 Test Acc: 0.538
Validation loss decreased (-0.514438 --> -0.537560).  Saving model ...
Epoch: 8 cost time: 1.8705358505249023
Epoch: 8, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.139 Vali Acc: 0.584 Test Loss: 1.139 Test Acc: 0.584
Validation loss decreased (-0.537560 --> -0.583804).  Saving model ...
Epoch: 9 cost time: 1.9045274257659912
Epoch: 9, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.034 Vali Acc: 0.659 Test Loss: 1.034 Test Acc: 0.659
Validation loss decreased (-0.583804 --> -0.658949).  Saving model ...
Epoch: 10 cost time: 2.1584038734436035
Epoch: 10, Steps: 17 | Train Loss: 0.791 Vali Loss: 0.922 Vali Acc: 0.717 Test Loss: 0.922 Test Acc: 0.717
Validation loss decreased (-0.658949 --> -0.716754).  Saving model ...
Epoch: 11 cost time: 2.037238359451294
Epoch: 11, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.915 Vali Acc: 0.676 Test Loss: 0.915 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0012576580047607
Epoch: 12, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.769 Vali Acc: 0.705 Test Loss: 0.769 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.067530393600464
Epoch: 13, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.730 Vali Acc: 0.734 Test Loss: 0.730 Test Acc: 0.734
Validation loss decreased (-0.716754 --> -0.734097).  Saving model ...
Epoch: 14 cost time: 2.1356396675109863
Epoch: 14, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.691 Vali Acc: 0.757 Test Loss: 0.691 Test Acc: 0.757
Validation loss decreased (-0.734097 --> -0.757219).  Saving model ...
Epoch: 15 cost time: 2.203608751296997
Epoch: 15, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.641 Vali Acc: 0.734 Test Loss: 0.641 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.218015193939209
Epoch: 16, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.636 Vali Acc: 0.757 Test Loss: 0.636 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 17 cost time: 2.1953299045562744
Epoch: 17, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.588 Vali Acc: 0.746 Test Loss: 0.588 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.188307762145996
Epoch: 18, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.589 Vali Acc: 0.769 Test Loss: 0.589 Test Acc: 0.769
Validation loss decreased (-0.757219 --> -0.768780).  Saving model ...
Epoch: 19 cost time: 2.2326176166534424
Epoch: 19, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.540 Vali Acc: 0.769 Test Loss: 0.540 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768781).  Saving model ...
Epoch: 20 cost time: 2.207533836364746
Epoch: 20, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.541 Vali Acc: 0.780 Test Loss: 0.541 Test Acc: 0.780
Validation loss decreased (-0.768781 --> -0.780341).  Saving model ...
Epoch: 21 cost time: 2.207827568054199
Epoch: 21, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.523 Vali Acc: 0.815 Test Loss: 0.523 Test Acc: 0.815
Validation loss decreased (-0.780341 --> -0.815024).  Saving model ...
Epoch: 22 cost time: 2.2313594818115234
Epoch: 22, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.564 Vali Acc: 0.757 Test Loss: 0.564 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.199556350708008
Epoch: 23, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1344006061553955
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.499 Vali Acc: 0.786 Test Loss: 0.499 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2714147567749023
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.518 Vali Acc: 0.792 Test Loss: 0.518 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.151904344558716
Epoch: 26, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.508 Vali Acc: 0.792 Test Loss: 0.508 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.127192735671997
Epoch: 27, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.514 Vali Acc: 0.815 Test Loss: 0.514 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 28 cost time: 2.2430171966552734
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2004199028015137
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.227003812789917
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.522 Vali Acc: 0.832 Test Loss: 0.522 Test Acc: 0.832
Validation loss decreased (-0.815024 --> -0.832365).  Saving model ...
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 290143
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.063124418258667
Epoch: 1, Steps: 17 | Train Loss: 2.070 Vali Loss: 1.976 Vali Acc: 0.133 Test Loss: 1.976 Test Acc: 0.133
Validation loss decreased (inf --> -0.132928).  Saving model ...
Epoch: 2 cost time: 3.6160976886749268
Epoch: 2, Steps: 17 | Train Loss: 1.918 Vali Loss: 1.860 Vali Acc: 0.266 Test Loss: 1.860 Test Acc: 0.266
Validation loss decreased (-0.132928 --> -0.265877).  Saving model ...
Epoch: 3 cost time: 3.2945327758789062
Epoch: 3, Steps: 17 | Train Loss: 1.800 Vali Loss: 1.715 Vali Acc: 0.318 Test Loss: 1.715 Test Acc: 0.318
Validation loss decreased (-0.265877 --> -0.317902).  Saving model ...
Epoch: 4 cost time: 3.336880683898926
Epoch: 4, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.567 Vali Acc: 0.410 Test Loss: 1.567 Test Acc: 0.410
Validation loss decreased (-0.317902 --> -0.410389).  Saving model ...
Epoch: 5 cost time: 3.6400845050811768
Epoch: 5, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.427 Vali Acc: 0.491 Test Loss: 1.427 Test Acc: 0.491
Validation loss decreased (-0.410389 --> -0.491315).  Saving model ...
Epoch: 6 cost time: 3.7974817752838135
Epoch: 6, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.305 Vali Acc: 0.486 Test Loss: 1.305 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.435060501098633
Epoch: 7, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.207 Vali Acc: 0.584 Test Loss: 1.207 Test Acc: 0.584
Validation loss decreased (-0.491315 --> -0.583803).  Saving model ...
Epoch: 8 cost time: 3.4092652797698975
Epoch: 8, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.109 Vali Acc: 0.647 Test Loss: 1.109 Test Acc: 0.647
Validation loss decreased (-0.583803 --> -0.647388).  Saving model ...
Epoch: 9 cost time: 3.7852203845977783
Epoch: 9, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.032 Vali Acc: 0.647 Test Loss: 1.032 Test Acc: 0.647
Validation loss decreased (-0.647388 --> -0.647389).  Saving model ...
Epoch: 10 cost time: 3.6815428733825684
Epoch: 10, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.913 Vali Acc: 0.734 Test Loss: 0.913 Test Acc: 0.734
Validation loss decreased (-0.647389 --> -0.734095).  Saving model ...
Epoch: 11 cost time: 3.615279197692871
Epoch: 11, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.954 Vali Acc: 0.630 Test Loss: 0.954 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.557874917984009
Epoch: 12, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.879 Vali Acc: 0.665 Test Loss: 0.879 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.7814998626708984
Epoch: 13, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.829 Vali Acc: 0.717 Test Loss: 0.829 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.65273380279541
Epoch: 14, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.755 Vali Acc: 0.699 Test Loss: 0.755 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.5720653533935547
Epoch: 15, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.778 Vali Acc: 0.723 Test Loss: 0.778 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.8104920387268066
Epoch: 16, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.750 Vali Acc: 0.746 Test Loss: 0.750 Test Acc: 0.746
Validation loss decreased (-0.734095 --> -0.745657).  Saving model ...
Epoch: 17 cost time: 3.64382266998291
Epoch: 17, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.663 Vali Acc: 0.751 Test Loss: 0.663 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751438).  Saving model ...
Epoch: 18 cost time: 3.8152241706848145
Epoch: 18, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.633 Vali Acc: 0.763 Test Loss: 0.633 Test Acc: 0.763
Validation loss decreased (-0.751438 --> -0.762999).  Saving model ...
Epoch: 19 cost time: 3.567758321762085
Epoch: 19, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.754 Vali Acc: 0.757 Test Loss: 0.754 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.461643934249878
Epoch: 20, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.672 Vali Acc: 0.775 Test Loss: 0.672 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774560).  Saving model ...
Epoch: 21 cost time: 3.3027968406677246
Epoch: 21, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.724 Vali Acc: 0.757 Test Loss: 0.724 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3519985675811768
Epoch: 22, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.714 Vali Acc: 0.751 Test Loss: 0.714 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.598712205886841
Epoch: 23, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.704 Vali Acc: 0.786 Test Loss: 0.704 Test Acc: 0.786
Validation loss decreased (-0.774560 --> -0.786120).  Saving model ...
Epoch: 24 cost time: 3.0971410274505615
Epoch: 24, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.725 Vali Acc: 0.763 Test Loss: 0.725 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.022782564163208
Epoch: 25, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.704 Vali Acc: 0.809 Test Loss: 0.704 Test Acc: 0.809
Validation loss decreased (-0.786120 --> -0.809242).  Saving model ...
Epoch: 26 cost time: 3.2755649089813232
Epoch: 26, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.691 Vali Acc: 0.786 Test Loss: 0.691 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.607769727706909
Epoch: 27, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.668 Vali Acc: 0.798 Test Loss: 0.668 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.423827648162842
Epoch: 28, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.642 Vali Acc: 0.809 Test Loss: 0.642 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809242).  Saving model ...
Epoch: 29 cost time: 3.497293710708618
Epoch: 29, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.962 Vali Acc: 0.751 Test Loss: 0.962 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.531956195831299
Epoch: 30, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.700 Vali Acc: 0.803 Test Loss: 0.700 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 471247
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.118601322174072
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.873 Vali Acc: 0.220 Test Loss: 1.873 Test Acc: 0.220
Validation loss decreased (inf --> -0.219634).  Saving model ...
Epoch: 2 cost time: 2.5767838954925537
Epoch: 2, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.749 Vali Acc: 0.335 Test Loss: 1.749 Test Acc: 0.335
Validation loss decreased (-0.219634 --> -0.335243).  Saving model ...
Epoch: 3 cost time: 2.5424935817718506
Epoch: 3, Steps: 17 | Train Loss: 1.698 Vali Loss: 1.629 Vali Acc: 0.364 Test Loss: 1.629 Test Acc: 0.364
Validation loss decreased (-0.335243 --> -0.364146).  Saving model ...
Epoch: 4 cost time: 2.4605047702789307
Epoch: 4, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.478 Vali Acc: 0.422 Test Loss: 1.478 Test Acc: 0.422
Validation loss decreased (-0.364146 --> -0.421951).  Saving model ...
Epoch: 5 cost time: 2.6493923664093018
Epoch: 5, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.351 Vali Acc: 0.514 Test Loss: 1.351 Test Acc: 0.514
Validation loss decreased (-0.421951 --> -0.514437).  Saving model ...
Epoch: 6 cost time: 2.693972110748291
Epoch: 6, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.260 Vali Acc: 0.566 Test Loss: 1.260 Test Acc: 0.566
Validation loss decreased (-0.514437 --> -0.566461).  Saving model ...
Epoch: 7 cost time: 2.5279457569122314
Epoch: 7, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.153 Vali Acc: 0.601 Test Loss: 1.153 Test Acc: 0.601
Validation loss decreased (-0.566461 --> -0.601145).  Saving model ...
Epoch: 8 cost time: 2.5378060340881348
Epoch: 8, Steps: 17 | Train Loss: 0.944 Vali Loss: 1.064 Vali Acc: 0.624 Test Loss: 1.064 Test Acc: 0.624
Validation loss decreased (-0.601145 --> -0.624267).  Saving model ...
Epoch: 9 cost time: 2.4555745124816895
Epoch: 9, Steps: 17 | Train Loss: 0.837 Vali Loss: 0.964 Vali Acc: 0.665 Test Loss: 0.964 Test Acc: 0.665
Validation loss decreased (-0.624267 --> -0.664730).  Saving model ...
Epoch: 10 cost time: 2.396815061569214
Epoch: 10, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.983 Vali Acc: 0.630 Test Loss: 0.983 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2390217781066895
Epoch: 11, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.902 Vali Acc: 0.647 Test Loss: 0.902 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.253596544265747
Epoch: 12, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.889 Vali Acc: 0.682 Test Loss: 0.889 Test Acc: 0.682
Validation loss decreased (-0.664730 --> -0.682072).  Saving model ...
Epoch: 13 cost time: 2.212759494781494
Epoch: 13, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.778 Vali Acc: 0.705 Test Loss: 0.778 Test Acc: 0.705
Validation loss decreased (-0.682072 --> -0.705195).  Saving model ...
Epoch: 14 cost time: 2.395892858505249
Epoch: 14, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.724 Vali Acc: 0.751 Test Loss: 0.724 Test Acc: 0.751
Validation loss decreased (-0.705195 --> -0.751438).  Saving model ...
Epoch: 15 cost time: 2.395109176635742
Epoch: 15, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.866 Vali Acc: 0.763 Test Loss: 0.866 Test Acc: 0.763
Validation loss decreased (-0.751438 --> -0.762997).  Saving model ...
Epoch: 16 cost time: 2.5626494884490967
Epoch: 16, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.681 Vali Acc: 0.723 Test Loss: 0.681 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5701308250427246
Epoch: 17, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.761 Vali Acc: 0.705 Test Loss: 0.761 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.5821361541748047
Epoch: 18, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.734 Vali Acc: 0.728 Test Loss: 0.734 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.4784390926361084
Epoch: 19, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.742 Vali Acc: 0.763 Test Loss: 0.742 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762998).  Saving model ...
Epoch: 20 cost time: 2.6033692359924316
Epoch: 20, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.722 Vali Acc: 0.763 Test Loss: 0.722 Test Acc: 0.763
Validation loss decreased (-0.762998 --> -0.762999).  Saving model ...
Epoch: 21 cost time: 2.6309001445770264
Epoch: 21, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.716 Vali Acc: 0.740 Test Loss: 0.716 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.551708698272705
Epoch: 22, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.686 Vali Acc: 0.746 Test Loss: 0.686 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.837109327316284
Epoch: 23, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.917 Vali Acc: 0.723 Test Loss: 0.917 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.5087506771087646
Epoch: 24, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.784 Vali Acc: 0.723 Test Loss: 0.784 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.5259058475494385
Epoch: 25, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.739 Vali Acc: 0.746 Test Loss: 0.739 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.547494888305664
Epoch: 26, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.751 Vali Acc: 0.740 Test Loss: 0.751 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.5482847690582275
Epoch: 27, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.743 Vali Acc: 0.786 Test Loss: 0.743 Test Acc: 0.786
Validation loss decreased (-0.762999 --> -0.786120).  Saving model ...
Epoch: 28 cost time: 2.7303526401519775
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.869 Vali Acc: 0.734 Test Loss: 0.869 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.631838798522949
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.766 Vali Acc: 0.757 Test Loss: 0.766 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.5638046264648438
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.787 Vali Acc: 0.717 Test Loss: 0.787 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 160735
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.858205795288086
Epoch: 1, Steps: 17 | Train Loss: 2.070 Vali Loss: 1.976 Vali Acc: 0.133 Test Loss: 1.976 Test Acc: 0.133
Validation loss decreased (inf --> -0.132928).  Saving model ...
Epoch: 2 cost time: 3.0356390476226807
Epoch: 2, Steps: 17 | Train Loss: 1.918 Vali Loss: 1.860 Vali Acc: 0.266 Test Loss: 1.860 Test Acc: 0.266
Validation loss decreased (-0.132928 --> -0.265877).  Saving model ...
Epoch: 3 cost time: 3.030803680419922
Epoch: 3, Steps: 17 | Train Loss: 1.800 Vali Loss: 1.715 Vali Acc: 0.318 Test Loss: 1.715 Test Acc: 0.318
Validation loss decreased (-0.265877 --> -0.317902).  Saving model ...
Epoch: 4 cost time: 3.003582239151001
Epoch: 4, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.567 Vali Acc: 0.410 Test Loss: 1.567 Test Acc: 0.410
Validation loss decreased (-0.317902 --> -0.410389).  Saving model ...
Epoch: 5 cost time: 2.6693313121795654
Epoch: 5, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.427 Vali Acc: 0.491 Test Loss: 1.427 Test Acc: 0.491
Validation loss decreased (-0.410389 --> -0.491315).  Saving model ...
Epoch: 6 cost time: 2.583326578140259
Epoch: 6, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.305 Vali Acc: 0.486 Test Loss: 1.305 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5951552391052246
Epoch: 7, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.207 Vali Acc: 0.584 Test Loss: 1.207 Test Acc: 0.584
Validation loss decreased (-0.491315 --> -0.583803).  Saving model ...
Epoch: 8 cost time: 2.6477739810943604
Epoch: 8, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.107 Vali Acc: 0.665 Test Loss: 1.107 Test Acc: 0.665
Validation loss decreased (-0.583803 --> -0.664729).  Saving model ...
Epoch: 9 cost time: 2.6512396335601807
Epoch: 9, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.032 Vali Acc: 0.665 Test Loss: 1.032 Test Acc: 0.665
Validation loss decreased (-0.664729 --> -0.664730).  Saving model ...
Epoch: 10 cost time: 2.882532835006714
Epoch: 10, Steps: 17 | Train Loss: 0.772 Vali Loss: 0.911 Vali Acc: 0.734 Test Loss: 0.911 Test Acc: 0.734
Validation loss decreased (-0.664730 --> -0.734095).  Saving model ...
Epoch: 11 cost time: 2.8233907222747803
Epoch: 11, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.965 Vali Acc: 0.613 Test Loss: 0.965 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7637135982513428
Epoch: 12, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.865 Vali Acc: 0.676 Test Loss: 0.865 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7329905033111572
Epoch: 13, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.813 Vali Acc: 0.717 Test Loss: 0.813 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8678910732269287
Epoch: 14, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.771 Vali Acc: 0.728 Test Loss: 0.771 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.726806402206421
Epoch: 15, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.804 Vali Acc: 0.699 Test Loss: 0.804 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.8262064456939697
Epoch: 16, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.679 Vali Acc: 0.763 Test Loss: 0.679 Test Acc: 0.763
Validation loss decreased (-0.734095 --> -0.762999).  Saving model ...
Epoch: 17 cost time: 2.912766456604004
Epoch: 17, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.688 Vali Acc: 0.723 Test Loss: 0.688 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.891587018966675
Epoch: 18, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.697 Vali Acc: 0.717 Test Loss: 0.697 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7323551177978516
Epoch: 19, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.609 Vali Acc: 0.798 Test Loss: 0.609 Test Acc: 0.798
Validation loss decreased (-0.762999 --> -0.797682).  Saving model ...
Epoch: 20 cost time: 2.8461272716522217
Epoch: 20, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.567 Vali Acc: 0.798 Test Loss: 0.567 Test Acc: 0.798
Validation loss decreased (-0.797682 --> -0.797682).  Saving model ...
Epoch: 21 cost time: 2.556518316268921
Epoch: 21, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.673 Vali Acc: 0.775 Test Loss: 0.673 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.879112720489502
Epoch: 22, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.687 Vali Acc: 0.740 Test Loss: 0.687 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7485427856445312
Epoch: 23, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.748 Vali Acc: 0.763 Test Loss: 0.748 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.838560104370117
Epoch: 24, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.815 Vali Acc: 0.746 Test Loss: 0.815 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.855302095413208
Epoch: 25, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.612 Vali Acc: 0.798 Test Loss: 0.612 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.5153703689575195
Epoch: 26, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.624685287475586
Epoch: 27, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.645 Vali Acc: 0.792 Test Loss: 0.645 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.7186384201049805
Epoch: 28, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.648 Vali Acc: 0.821 Test Loss: 0.648 Test Acc: 0.821
Validation loss decreased (-0.797682 --> -0.820803).  Saving model ...
Epoch: 29 cost time: 2.7274973392486572
Epoch: 29, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.682 Vali Acc: 0.798 Test Loss: 0.682 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.6125552654266357
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.626 Vali Acc: 0.827 Test Loss: 0.626 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826583).  Saving model ...
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 471247
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7880516052246094
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.873 Vali Acc: 0.220 Test Loss: 1.873 Test Acc: 0.220
Validation loss decreased (inf --> -0.219634).  Saving model ...
Epoch: 2 cost time: 2.147240161895752
Epoch: 2, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.749 Vali Acc: 0.335 Test Loss: 1.749 Test Acc: 0.335
Validation loss decreased (-0.219634 --> -0.335243).  Saving model ...
Epoch: 3 cost time: 2.4188265800476074
Epoch: 3, Steps: 17 | Train Loss: 1.698 Vali Loss: 1.629 Vali Acc: 0.364 Test Loss: 1.629 Test Acc: 0.364
Validation loss decreased (-0.335243 --> -0.364146).  Saving model ...
Epoch: 4 cost time: 2.242471694946289
Epoch: 4, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.478 Vali Acc: 0.422 Test Loss: 1.478 Test Acc: 0.422
Validation loss decreased (-0.364146 --> -0.421951).  Saving model ...
Epoch: 5 cost time: 2.1880693435668945
Epoch: 5, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.351 Vali Acc: 0.514 Test Loss: 1.351 Test Acc: 0.514
Validation loss decreased (-0.421951 --> -0.514437).  Saving model ...
Epoch: 6 cost time: 2.30908203125
Epoch: 6, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.260 Vali Acc: 0.566 Test Loss: 1.260 Test Acc: 0.566
Validation loss decreased (-0.514437 --> -0.566461).  Saving model ...
Epoch: 7 cost time: 2.11979603767395
Epoch: 7, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.153 Vali Acc: 0.601 Test Loss: 1.153 Test Acc: 0.601
Validation loss decreased (-0.566461 --> -0.601145).  Saving model ...
Epoch: 8 cost time: 2.2204043865203857
Epoch: 8, Steps: 17 | Train Loss: 0.944 Vali Loss: 1.065 Vali Acc: 0.624 Test Loss: 1.065 Test Acc: 0.624
Validation loss decreased (-0.601145 --> -0.624267).  Saving model ...
Epoch: 9 cost time: 2.31215238571167
Epoch: 9, Steps: 17 | Train Loss: 0.837 Vali Loss: 0.964 Vali Acc: 0.676 Test Loss: 0.964 Test Acc: 0.676
Validation loss decreased (-0.624267 --> -0.676291).  Saving model ...
Epoch: 10 cost time: 2.2168312072753906
Epoch: 10, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.982 Vali Acc: 0.630 Test Loss: 0.982 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2720015048980713
Epoch: 11, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.902 Vali Acc: 0.647 Test Loss: 0.902 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.19826078414917
Epoch: 12, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.891 Vali Acc: 0.682 Test Loss: 0.891 Test Acc: 0.682
Validation loss decreased (-0.676291 --> -0.682072).  Saving model ...
Epoch: 13 cost time: 2.2502212524414062
Epoch: 13, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.772 Vali Acc: 0.694 Test Loss: 0.772 Test Acc: 0.694
Validation loss decreased (-0.682072 --> -0.693634).  Saving model ...
Epoch: 14 cost time: 2.1698215007781982
Epoch: 14, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.725 Vali Acc: 0.751 Test Loss: 0.725 Test Acc: 0.751
Validation loss decreased (-0.693634 --> -0.751438).  Saving model ...
Epoch: 15 cost time: 2.1249048709869385
Epoch: 15, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.852 Vali Acc: 0.757 Test Loss: 0.852 Test Acc: 0.757
Validation loss decreased (-0.751438 --> -0.757217).  Saving model ...
Epoch: 16 cost time: 2.1149470806121826
Epoch: 16, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.677 Vali Acc: 0.740 Test Loss: 0.677 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.067857027053833
Epoch: 17, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.773 Vali Acc: 0.717 Test Loss: 0.773 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1191091537475586
Epoch: 18, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.744 Vali Acc: 0.728 Test Loss: 0.744 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.159053087234497
Epoch: 19, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.760 Vali Acc: 0.757 Test Loss: 0.760 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757218).  Saving model ...
Epoch: 20 cost time: 2.063237190246582
Epoch: 20, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.776 Vali Acc: 0.757 Test Loss: 0.776 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9757533073425293
Epoch: 21, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.684 Vali Acc: 0.763 Test Loss: 0.684 Test Acc: 0.763
Validation loss decreased (-0.757218 --> -0.762999).  Saving model ...
Epoch: 22 cost time: 1.9738187789916992
Epoch: 22, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.729 Vali Acc: 0.746 Test Loss: 0.729 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.996051549911499
Epoch: 23, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.779 Vali Acc: 0.751 Test Loss: 0.779 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0733184814453125
Epoch: 24, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.761 Vali Acc: 0.728 Test Loss: 0.761 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9079921245574951
Epoch: 25, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.724 Vali Acc: 0.746 Test Loss: 0.724 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0495810508728027
Epoch: 26, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.753 Vali Acc: 0.734 Test Loss: 0.753 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9456639289855957
Epoch: 27, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.737 Vali Acc: 0.740 Test Loss: 0.737 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.0871517658233643
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.811 Vali Acc: 0.734 Test Loss: 0.811 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.3429758548736572
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.783 Vali Acc: 0.746 Test Loss: 0.783 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.066643476486206
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.805 Vali Acc: 0.728 Test Loss: 0.805 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 160735
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8308258056640625
Epoch: 1, Steps: 17 | Train Loss: 2.070 Vali Loss: 1.976 Vali Acc: 0.121 Test Loss: 1.976 Test Acc: 0.121
Validation loss decreased (inf --> -0.121368).  Saving model ...
Epoch: 2 cost time: 2.284503698348999
Epoch: 2, Steps: 17 | Train Loss: 1.918 Vali Loss: 1.860 Vali Acc: 0.266 Test Loss: 1.860 Test Acc: 0.266
Validation loss decreased (-0.121368 --> -0.265877).  Saving model ...
Epoch: 3 cost time: 2.207123279571533
Epoch: 3, Steps: 17 | Train Loss: 1.800 Vali Loss: 1.716 Vali Acc: 0.318 Test Loss: 1.716 Test Acc: 0.318
Validation loss decreased (-0.265877 --> -0.317902).  Saving model ...
Epoch: 4 cost time: 2.3325817584991455
Epoch: 4, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.567 Vali Acc: 0.410 Test Loss: 1.567 Test Acc: 0.410
Validation loss decreased (-0.317902 --> -0.410389).  Saving model ...
Epoch: 5 cost time: 2.244788885116577
Epoch: 5, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.427 Vali Acc: 0.491 Test Loss: 1.427 Test Acc: 0.491
Validation loss decreased (-0.410389 --> -0.491315).  Saving model ...
Epoch: 6 cost time: 2.3885462284088135
Epoch: 6, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.305 Vali Acc: 0.491 Test Loss: 1.305 Test Acc: 0.491
Validation loss decreased (-0.491315 --> -0.491316).  Saving model ...
Epoch: 7 cost time: 2.384007692337036
Epoch: 7, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.212 Vali Acc: 0.584 Test Loss: 1.212 Test Acc: 0.584
Validation loss decreased (-0.491316 --> -0.583803).  Saving model ...
Epoch: 8 cost time: 2.476362943649292
Epoch: 8, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.101 Vali Acc: 0.694 Test Loss: 1.101 Test Acc: 0.694
Validation loss decreased (-0.583803 --> -0.693631).  Saving model ...
Epoch: 9 cost time: 2.4357259273529053
Epoch: 9, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.025 Vali Acc: 0.659 Test Loss: 1.025 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0729429721832275
Epoch: 10, Steps: 17 | Train Loss: 0.781 Vali Loss: 0.912 Vali Acc: 0.734 Test Loss: 0.912 Test Acc: 0.734
Validation loss decreased (-0.693631 --> -0.734095).  Saving model ...
Epoch: 11 cost time: 2.30871319770813
Epoch: 11, Steps: 17 | Train Loss: 0.674 Vali Loss: 0.941 Vali Acc: 0.636 Test Loss: 0.941 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2232396602630615
Epoch: 12, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.838 Vali Acc: 0.682 Test Loss: 0.838 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.198275566101074
Epoch: 13, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.754 Vali Acc: 0.746 Test Loss: 0.754 Test Acc: 0.746
Validation loss decreased (-0.734095 --> -0.745657).  Saving model ...
Epoch: 14 cost time: 2.132856845855713
Epoch: 14, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.700 Vali Acc: 0.775 Test Loss: 0.700 Test Acc: 0.775
Validation loss decreased (-0.745657 --> -0.774559).  Saving model ...
Epoch: 15 cost time: 2.1531918048858643
Epoch: 15, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.800 Vali Acc: 0.728 Test Loss: 0.800 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.174475908279419
Epoch: 16, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.733 Vali Acc: 0.763 Test Loss: 0.733 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1512560844421387
Epoch: 17, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.726 Vali Acc: 0.711 Test Loss: 0.726 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.1662237644195557
Epoch: 18, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.651 Vali Acc: 0.751 Test Loss: 0.651 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.137977361679077
Epoch: 19, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
Validation loss decreased (-0.774559 --> -0.809243).  Saving model ...
Epoch: 20 cost time: 2.258042335510254
Epoch: 20, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3561747074127197
Epoch: 21, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.585 Vali Acc: 0.815 Test Loss: 0.585 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 22 cost time: 2.3262062072753906
Epoch: 22, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.639 Vali Acc: 0.751 Test Loss: 0.639 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.297060012817383
Epoch: 23, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.583 Vali Acc: 0.769 Test Loss: 0.583 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2356345653533936
Epoch: 24, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0342788696289062
Epoch: 25, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.614 Vali Acc: 0.792 Test Loss: 0.614 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0766499042510986
Epoch: 26, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.3081088066101074
Epoch: 27, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.603 Vali Acc: 0.775 Test Loss: 0.603 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.191251277923584
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.589 Vali Acc: 0.821 Test Loss: 0.589 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820803).  Saving model ...
Epoch: 29 cost time: 2.260509729385376
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.642 Vali Acc: 0.809 Test Loss: 0.642 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.180776596069336
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 471247
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.379523992538452
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.874 Vali Acc: 0.220 Test Loss: 1.874 Test Acc: 0.220
Validation loss decreased (inf --> -0.219634).  Saving model ...
Epoch: 2 cost time: 1.786694049835205
Epoch: 2, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.749 Vali Acc: 0.335 Test Loss: 1.749 Test Acc: 0.335
Validation loss decreased (-0.219634 --> -0.335243).  Saving model ...
Epoch: 3 cost time: 1.7835114002227783
Epoch: 3, Steps: 17 | Train Loss: 1.698 Vali Loss: 1.629 Vali Acc: 0.364 Test Loss: 1.629 Test Acc: 0.364
Validation loss decreased (-0.335243 --> -0.364146).  Saving model ...
Epoch: 4 cost time: 1.8043081760406494
Epoch: 4, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.478 Vali Acc: 0.422 Test Loss: 1.478 Test Acc: 0.422
Validation loss decreased (-0.364146 --> -0.421951).  Saving model ...
Epoch: 5 cost time: 1.624239206314087
Epoch: 5, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.352 Vali Acc: 0.514 Test Loss: 1.352 Test Acc: 0.514
Validation loss decreased (-0.421951 --> -0.514437).  Saving model ...
Epoch: 6 cost time: 1.690349817276001
Epoch: 6, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.259 Vali Acc: 0.566 Test Loss: 1.259 Test Acc: 0.566
Validation loss decreased (-0.514437 --> -0.566461).  Saving model ...
Epoch: 7 cost time: 1.708815574645996
Epoch: 7, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.153 Vali Acc: 0.601 Test Loss: 1.153 Test Acc: 0.601
Validation loss decreased (-0.566461 --> -0.601145).  Saving model ...
Epoch: 8 cost time: 1.739508867263794
Epoch: 8, Steps: 17 | Train Loss: 0.944 Vali Loss: 1.064 Vali Acc: 0.624 Test Loss: 1.064 Test Acc: 0.624
Validation loss decreased (-0.601145 --> -0.624267).  Saving model ...
Epoch: 9 cost time: 1.781764268875122
Epoch: 9, Steps: 17 | Train Loss: 0.837 Vali Loss: 0.964 Vali Acc: 0.665 Test Loss: 0.964 Test Acc: 0.665
Validation loss decreased (-0.624267 --> -0.664730).  Saving model ...
Epoch: 10 cost time: 1.6970770359039307
Epoch: 10, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.985 Vali Acc: 0.630 Test Loss: 0.985 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7310192584991455
Epoch: 11, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.900 Vali Acc: 0.653 Test Loss: 0.900 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8159387111663818
Epoch: 12, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.897 Vali Acc: 0.659 Test Loss: 0.897 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8750741481781006
Epoch: 13, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.768 Vali Acc: 0.694 Test Loss: 0.768 Test Acc: 0.694
Validation loss decreased (-0.664730 --> -0.693634).  Saving model ...
Epoch: 14 cost time: 1.5676753520965576
Epoch: 14, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.726 Vali Acc: 0.751 Test Loss: 0.726 Test Acc: 0.751
Validation loss decreased (-0.693634 --> -0.751438).  Saving model ...
Epoch: 15 cost time: 1.8567163944244385
Epoch: 15, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.853 Vali Acc: 0.757 Test Loss: 0.853 Test Acc: 0.757
Validation loss decreased (-0.751438 --> -0.757217).  Saving model ...
Epoch: 16 cost time: 1.7918927669525146
Epoch: 16, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.674 Vali Acc: 0.746 Test Loss: 0.674 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8406398296356201
Epoch: 17, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.764 Vali Acc: 0.711 Test Loss: 0.764 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7617356777191162
Epoch: 18, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.749 Vali Acc: 0.740 Test Loss: 0.749 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0364675521850586
Epoch: 19, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.761 Vali Acc: 0.757 Test Loss: 0.761 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757218).  Saving model ...
Epoch: 20 cost time: 2.0686702728271484
Epoch: 20, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.761 Vali Acc: 0.757 Test Loss: 0.761 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8912944793701172
Epoch: 21, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.696 Vali Acc: 0.763 Test Loss: 0.696 Test Acc: 0.763
Validation loss decreased (-0.757218 --> -0.762999).  Saving model ...
Epoch: 22 cost time: 1.9692752361297607
Epoch: 22, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.708 Vali Acc: 0.763 Test Loss: 0.708 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9241595268249512
Epoch: 23, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.802 Vali Acc: 0.775 Test Loss: 0.802 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774558).  Saving model ...
Epoch: 24 cost time: 1.866802453994751
Epoch: 24, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.765 Vali Acc: 0.728 Test Loss: 0.765 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.111663579940796
Epoch: 25, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.701 Vali Acc: 0.757 Test Loss: 0.701 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.99367356300354
Epoch: 26, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.749 Vali Acc: 0.734 Test Loss: 0.749 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.888120174407959
Epoch: 27, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.730 Vali Acc: 0.757 Test Loss: 0.730 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8996975421905518
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.804 Vali Acc: 0.734 Test Loss: 0.804 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.908872365951538
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.769 Vali Acc: 0.751 Test Loss: 0.769 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.012261152267456
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.810 Vali Acc: 0.723 Test Loss: 0.810 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 160735
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.750258922576904
Epoch: 1, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.945 Vali Acc: 0.156 Test Loss: 1.945 Test Acc: 0.156
Validation loss decreased (inf --> -0.156050).  Saving model ...
Epoch: 2 cost time: 3.088775396347046
Epoch: 2, Steps: 17 | Train Loss: 1.870 Vali Loss: 1.826 Vali Acc: 0.266 Test Loss: 1.826 Test Acc: 0.266
Validation loss decreased (-0.156050 --> -0.265878).  Saving model ...
Epoch: 3 cost time: 2.8734397888183594
Epoch: 3, Steps: 17 | Train Loss: 1.727 Vali Loss: 1.694 Vali Acc: 0.347 Test Loss: 1.694 Test Acc: 0.347
Validation loss decreased (-0.265878 --> -0.346804).  Saving model ...
Epoch: 4 cost time: 2.757394313812256
Epoch: 4, Steps: 17 | Train Loss: 1.557 Vali Loss: 1.515 Vali Acc: 0.405 Test Loss: 1.515 Test Acc: 0.405
Validation loss decreased (-0.346804 --> -0.404609).  Saving model ...
Epoch: 5 cost time: 2.626366138458252
Epoch: 5, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.373 Vali Acc: 0.457 Test Loss: 1.373 Test Acc: 0.457
Validation loss decreased (-0.404609 --> -0.456634).  Saving model ...
Epoch: 6 cost time: 2.854248523712158
Epoch: 6, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.253 Vali Acc: 0.538 Test Loss: 1.253 Test Acc: 0.538
Validation loss decreased (-0.456634 --> -0.537560).  Saving model ...
Epoch: 7 cost time: 2.8504369258880615
Epoch: 7, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.153 Vali Acc: 0.595 Test Loss: 1.153 Test Acc: 0.595
Validation loss decreased (-0.537560 --> -0.595364).  Saving model ...
Epoch: 8 cost time: 2.7382733821868896
Epoch: 8, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.043 Vali Acc: 0.624 Test Loss: 1.043 Test Acc: 0.624
Validation loss decreased (-0.595364 --> -0.624267).  Saving model ...
Epoch: 9 cost time: 3.0998849868774414
Epoch: 9, Steps: 17 | Train Loss: 0.836 Vali Loss: 0.947 Vali Acc: 0.688 Test Loss: 0.947 Test Acc: 0.688
Validation loss decreased (-0.624267 --> -0.687852).  Saving model ...
Epoch: 10 cost time: 3.0401411056518555
Epoch: 10, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.849 Vali Acc: 0.734 Test Loss: 0.849 Test Acc: 0.734
Validation loss decreased (-0.687852 --> -0.734096).  Saving model ...
Epoch: 11 cost time: 3.3726494312286377
Epoch: 11, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.793 Vali Acc: 0.734 Test Loss: 0.793 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734096).  Saving model ...
Epoch: 12 cost time: 2.9655981063842773
Epoch: 12, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.775 Vali Acc: 0.740 Test Loss: 0.775 Test Acc: 0.740
Validation loss decreased (-0.734096 --> -0.739877).  Saving model ...
Epoch: 13 cost time: 2.870936393737793
Epoch: 13, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.697 Vali Acc: 0.728 Test Loss: 0.697 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.171166181564331
Epoch: 14, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.618 Vali Acc: 0.798 Test Loss: 0.618 Test Acc: 0.798
Validation loss decreased (-0.739877 --> -0.797682).  Saving model ...
Epoch: 15 cost time: 3.0743937492370605
Epoch: 15, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.615 Vali Acc: 0.769 Test Loss: 0.615 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.984041690826416
Epoch: 16, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.567 Vali Acc: 0.780 Test Loss: 0.567 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0203685760498047
Epoch: 17, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0801703929901123
Epoch: 18, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.525 Vali Acc: 0.780 Test Loss: 0.525 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.1324996948242188
Epoch: 19, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.585 Vali Acc: 0.751 Test Loss: 0.585 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.0131072998046875
Epoch: 20, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.548 Vali Acc: 0.763 Test Loss: 0.548 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.0690581798553467
Epoch: 21, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.586 Vali Acc: 0.763 Test Loss: 0.586 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.987412929534912
Epoch: 22, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.594 Vali Acc: 0.786 Test Loss: 0.594 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.8751113414764404
Epoch: 23, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809244).  Saving model ...
Epoch: 24 cost time: 2.6459710597991943
Epoch: 24, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.527 Vali Acc: 0.815 Test Loss: 0.527 Test Acc: 0.815
Validation loss decreased (-0.809244 --> -0.815024).  Saving model ...
Epoch: 25 cost time: 2.6782755851745605
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8479232788085938
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.557 Vali Acc: 0.815 Test Loss: 0.557 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.8678205013275146
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.556 Vali Acc: 0.815 Test Loss: 0.556 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.8413896560668945
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.608 Vali Acc: 0.815 Test Loss: 0.608 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.6678028106689453
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.5343503952026367
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.566 Vali Acc: 0.798 Test Loss: 0.566 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 251311
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.259623289108276
Epoch: 1, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.989 Vali Acc: 0.162 Test Loss: 1.989 Test Acc: 0.162
Validation loss decreased (inf --> -0.161830).  Saving model ...
Epoch: 2 cost time: 2.1989376544952393
Epoch: 2, Steps: 17 | Train Loss: 1.921 Vali Loss: 1.891 Vali Acc: 0.214 Test Loss: 1.891 Test Acc: 0.214
Validation loss decreased (-0.161830 --> -0.213854).  Saving model ...
Epoch: 3 cost time: 2.2452187538146973
Epoch: 3, Steps: 17 | Train Loss: 1.781 Vali Loss: 1.764 Vali Acc: 0.301 Test Loss: 1.764 Test Acc: 0.301
Validation loss decreased (-0.213854 --> -0.300560).  Saving model ...
Epoch: 4 cost time: 2.2751212120056152
Epoch: 4, Steps: 17 | Train Loss: 1.661 Vali Loss: 1.633 Vali Acc: 0.347 Test Loss: 1.633 Test Acc: 0.347
Validation loss decreased (-0.300560 --> -0.346804).  Saving model ...
Epoch: 5 cost time: 2.3115954399108887
Epoch: 5, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.488 Vali Acc: 0.451 Test Loss: 1.488 Test Acc: 0.451
Validation loss decreased (-0.346804 --> -0.450852).  Saving model ...
Epoch: 6 cost time: 2.2752652168273926
Epoch: 6, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.346 Vali Acc: 0.491 Test Loss: 1.346 Test Acc: 0.491
Validation loss decreased (-0.450852 --> -0.491316).  Saving model ...
Epoch: 7 cost time: 2.220677375793457
Epoch: 7, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.223 Vali Acc: 0.555 Test Loss: 1.223 Test Acc: 0.555
Validation loss decreased (-0.491316 --> -0.554901).  Saving model ...
Epoch: 8 cost time: 2.3235526084899902
Epoch: 8, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.117 Vali Acc: 0.578 Test Loss: 1.117 Test Acc: 0.578
Validation loss decreased (-0.554901 --> -0.578024).  Saving model ...
Epoch: 9 cost time: 2.2384300231933594
Epoch: 9, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.044 Vali Acc: 0.676 Test Loss: 1.044 Test Acc: 0.676
Validation loss decreased (-0.578024 --> -0.676290).  Saving model ...
Epoch: 10 cost time: 2.1345503330230713
Epoch: 10, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.950 Vali Acc: 0.734 Test Loss: 0.950 Test Acc: 0.734
Validation loss decreased (-0.676290 --> -0.734095).  Saving model ...
Epoch: 11 cost time: 2.151960849761963
Epoch: 11, Steps: 17 | Train Loss: 0.681 Vali Loss: 0.849 Vali Acc: 0.740 Test Loss: 0.849 Test Acc: 0.740
Validation loss decreased (-0.734095 --> -0.739876).  Saving model ...
Epoch: 12 cost time: 2.1921026706695557
Epoch: 12, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.857 Vali Acc: 0.694 Test Loss: 0.857 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.30438232421875
Epoch: 13, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.748 Vali Acc: 0.757 Test Loss: 0.748 Test Acc: 0.757
Validation loss decreased (-0.739876 --> -0.757218).  Saving model ...
Epoch: 14 cost time: 2.233985662460327
Epoch: 14, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.668 Vali Acc: 0.769 Test Loss: 0.668 Test Acc: 0.769
Validation loss decreased (-0.757218 --> -0.768779).  Saving model ...
Epoch: 15 cost time: 2.2005388736724854
Epoch: 15, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.644 Vali Acc: 0.786 Test Loss: 0.644 Test Acc: 0.786
Validation loss decreased (-0.768779 --> -0.786121).  Saving model ...
Epoch: 16 cost time: 2.144028425216675
Epoch: 16, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
Validation loss decreased (-0.786121 --> -0.803462).  Saving model ...
Epoch: 17 cost time: 2.10965633392334
Epoch: 17, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.589 Vali Acc: 0.780 Test Loss: 0.589 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.256904125213623
Epoch: 18, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.648 Vali Acc: 0.780 Test Loss: 0.648 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1286871433258057
Epoch: 19, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.574 Vali Acc: 0.792 Test Loss: 0.574 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.295811653137207
Epoch: 20, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.771 Vali Acc: 0.711 Test Loss: 0.771 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1817643642425537
Epoch: 21, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.657 Vali Acc: 0.786 Test Loss: 0.657 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1956019401550293
Epoch: 22, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.634 Vali Acc: 0.763 Test Loss: 0.634 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.2598469257354736
Epoch: 23, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.581 Vali Acc: 0.798 Test Loss: 0.581 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.36393666267395
Epoch: 24, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.632 Vali Acc: 0.792 Test Loss: 0.632 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.2592408657073975
Epoch: 25, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.647 Vali Acc: 0.769 Test Loss: 0.647 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.195690870285034
Epoch: 26, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.635 Vali Acc: 0.786 Test Loss: 0.635 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 96031
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.261540412902832
Epoch: 1, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.945 Vali Acc: 0.156 Test Loss: 1.945 Test Acc: 0.156
Validation loss decreased (inf --> -0.156050).  Saving model ...
Epoch: 2 cost time: 2.5799596309661865
Epoch: 2, Steps: 17 | Train Loss: 1.870 Vali Loss: 1.826 Vali Acc: 0.266 Test Loss: 1.826 Test Acc: 0.266
Validation loss decreased (-0.156050 --> -0.265878).  Saving model ...
Epoch: 3 cost time: 2.8835318088531494
Epoch: 3, Steps: 17 | Train Loss: 1.727 Vali Loss: 1.694 Vali Acc: 0.347 Test Loss: 1.694 Test Acc: 0.347
Validation loss decreased (-0.265878 --> -0.346804).  Saving model ...
Epoch: 4 cost time: 2.904315948486328
Epoch: 4, Steps: 17 | Train Loss: 1.557 Vali Loss: 1.515 Vali Acc: 0.405 Test Loss: 1.515 Test Acc: 0.405
Validation loss decreased (-0.346804 --> -0.404609).  Saving model ...
Epoch: 5 cost time: 2.737208843231201
Epoch: 5, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.373 Vali Acc: 0.457 Test Loss: 1.373 Test Acc: 0.457
Validation loss decreased (-0.404609 --> -0.456634).  Saving model ...
Epoch: 6 cost time: 2.9970927238464355
Epoch: 6, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.254 Vali Acc: 0.538 Test Loss: 1.254 Test Acc: 0.538
Validation loss decreased (-0.456634 --> -0.537560).  Saving model ...
Epoch: 7 cost time: 2.9360861778259277
Epoch: 7, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.153 Vali Acc: 0.595 Test Loss: 1.153 Test Acc: 0.595
Validation loss decreased (-0.537560 --> -0.595364).  Saving model ...
Epoch: 8 cost time: 2.720837116241455
Epoch: 8, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.043 Vali Acc: 0.624 Test Loss: 1.043 Test Acc: 0.624
Validation loss decreased (-0.595364 --> -0.624267).  Saving model ...
Epoch: 9 cost time: 3.010951042175293
Epoch: 9, Steps: 17 | Train Loss: 0.836 Vali Loss: 0.947 Vali Acc: 0.688 Test Loss: 0.947 Test Acc: 0.688
Validation loss decreased (-0.624267 --> -0.687852).  Saving model ...
Epoch: 10 cost time: 2.7970306873321533
Epoch: 10, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.849 Vali Acc: 0.734 Test Loss: 0.849 Test Acc: 0.734
Validation loss decreased (-0.687852 --> -0.734096).  Saving model ...
Epoch: 11 cost time: 2.629136562347412
Epoch: 11, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.793 Vali Acc: 0.734 Test Loss: 0.793 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734096).  Saving model ...
Epoch: 12 cost time: 2.600613594055176
Epoch: 12, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.775 Vali Acc: 0.740 Test Loss: 0.775 Test Acc: 0.740
Validation loss decreased (-0.734096 --> -0.739877).  Saving model ...
Epoch: 13 cost time: 2.7470171451568604
Epoch: 13, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.699 Vali Acc: 0.728 Test Loss: 0.699 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6420950889587402
Epoch: 14, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
Validation loss decreased (-0.739877 --> -0.809242).  Saving model ...
Epoch: 15 cost time: 2.634453773498535
Epoch: 15, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.607 Vali Acc: 0.769 Test Loss: 0.607 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5481743812561035
Epoch: 16, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.573 Vali Acc: 0.769 Test Loss: 0.573 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.637178659439087
Epoch: 17, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.587 Vali Acc: 0.780 Test Loss: 0.587 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8786725997924805
Epoch: 18, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.572 Vali Acc: 0.786 Test Loss: 0.572 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.7975680828094482
Epoch: 19, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.623 Vali Acc: 0.746 Test Loss: 0.623 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.485434055328369
Epoch: 20, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.555 Vali Acc: 0.763 Test Loss: 0.555 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.6779584884643555
Epoch: 21, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.531 Vali Acc: 0.815 Test Loss: 0.531 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815024).  Saving model ...
Epoch: 22 cost time: 2.599874973297119
Epoch: 22, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.559 Vali Acc: 0.803 Test Loss: 0.559 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7179982662200928
Epoch: 23, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.552 Vali Acc: 0.780 Test Loss: 0.552 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.762357234954834
Epoch: 24, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.564 Vali Acc: 0.775 Test Loss: 0.564 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.7271053791046143
Epoch: 25, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.5515737533569336
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.561 Vali Acc: 0.798 Test Loss: 0.561 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.589139699935913
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.558 Vali Acc: 0.815 Test Loss: 0.558 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.615325689315796
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.6476688385009766
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.536 Vali Acc: 0.809 Test Loss: 0.536 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.5434484481811523
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 251311
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.413753032684326
Epoch: 1, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.989 Vali Acc: 0.162 Test Loss: 1.989 Test Acc: 0.162
Validation loss decreased (inf --> -0.161830).  Saving model ...
Epoch: 2 cost time: 1.9057042598724365
Epoch: 2, Steps: 17 | Train Loss: 1.921 Vali Loss: 1.891 Vali Acc: 0.214 Test Loss: 1.891 Test Acc: 0.214
Validation loss decreased (-0.161830 --> -0.213854).  Saving model ...
Epoch: 3 cost time: 1.9899885654449463
Epoch: 3, Steps: 17 | Train Loss: 1.781 Vali Loss: 1.764 Vali Acc: 0.301 Test Loss: 1.764 Test Acc: 0.301
Validation loss decreased (-0.213854 --> -0.300560).  Saving model ...
Epoch: 4 cost time: 1.9748451709747314
Epoch: 4, Steps: 17 | Train Loss: 1.661 Vali Loss: 1.633 Vali Acc: 0.347 Test Loss: 1.633 Test Acc: 0.347
Validation loss decreased (-0.300560 --> -0.346804).  Saving model ...
Epoch: 5 cost time: 1.9489421844482422
Epoch: 5, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.488 Vali Acc: 0.451 Test Loss: 1.488 Test Acc: 0.451
Validation loss decreased (-0.346804 --> -0.450852).  Saving model ...
Epoch: 6 cost time: 1.9489693641662598
Epoch: 6, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.346 Vali Acc: 0.491 Test Loss: 1.346 Test Acc: 0.491
Validation loss decreased (-0.450852 --> -0.491316).  Saving model ...
Epoch: 7 cost time: 1.9853811264038086
Epoch: 7, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.223 Vali Acc: 0.555 Test Loss: 1.223 Test Acc: 0.555
Validation loss decreased (-0.491316 --> -0.554901).  Saving model ...
Epoch: 8 cost time: 1.8230507373809814
Epoch: 8, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.117 Vali Acc: 0.578 Test Loss: 1.117 Test Acc: 0.578
Validation loss decreased (-0.554901 --> -0.578024).  Saving model ...
Epoch: 9 cost time: 2.1015758514404297
Epoch: 9, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.044 Vali Acc: 0.676 Test Loss: 1.044 Test Acc: 0.676
Validation loss decreased (-0.578024 --> -0.676290).  Saving model ...
Epoch: 10 cost time: 2.0401229858398438
Epoch: 10, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.950 Vali Acc: 0.734 Test Loss: 0.950 Test Acc: 0.734
Validation loss decreased (-0.676290 --> -0.734095).  Saving model ...
Epoch: 11 cost time: 2.1118712425231934
Epoch: 11, Steps: 17 | Train Loss: 0.681 Vali Loss: 0.849 Vali Acc: 0.740 Test Loss: 0.849 Test Acc: 0.740
Validation loss decreased (-0.734095 --> -0.739876).  Saving model ...
Epoch: 12 cost time: 2.1362292766571045
Epoch: 12, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.862 Vali Acc: 0.688 Test Loss: 0.862 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9908764362335205
Epoch: 13, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.736 Vali Acc: 0.746 Test Loss: 0.736 Test Acc: 0.746
Validation loss decreased (-0.739876 --> -0.745657).  Saving model ...
Epoch: 14 cost time: 2.028991460800171
Epoch: 14, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.662 Vali Acc: 0.792 Test Loss: 0.662 Test Acc: 0.792
Validation loss decreased (-0.745657 --> -0.791901).  Saving model ...
Epoch: 15 cost time: 2.0141701698303223
Epoch: 15, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.636 Vali Acc: 0.786 Test Loss: 0.636 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9928741455078125
Epoch: 16, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.656 Vali Acc: 0.780 Test Loss: 0.656 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7616138458251953
Epoch: 17, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.618 Vali Acc: 0.763 Test Loss: 0.618 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.185936212539673
Epoch: 18, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.683 Vali Acc: 0.780 Test Loss: 0.683 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.17893123626709
Epoch: 19, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809243).  Saving model ...
Epoch: 20 cost time: 2.146590232849121
Epoch: 20, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.629 Vali Acc: 0.780 Test Loss: 0.629 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2043492794036865
Epoch: 21, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.264986038208008
Epoch: 22, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.563 Vali Acc: 0.763 Test Loss: 0.563 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.2053701877593994
Epoch: 23, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.641 Vali Acc: 0.786 Test Loss: 0.641 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0737144947052
Epoch: 24, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.652 Vali Acc: 0.786 Test Loss: 0.652 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2961196899414062
Epoch: 25, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2681336402893066
Epoch: 26, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 27 cost time: 2.1459414958953857
Epoch: 27, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.621 Vali Acc: 0.780 Test Loss: 0.621 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9478154182434082
Epoch: 28, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.797 Vali Acc: 0.734 Test Loss: 0.797 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.064358711242676
Epoch: 29, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.673 Vali Acc: 0.769 Test Loss: 0.673 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.151463747024536
Epoch: 30, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.620 Vali Acc: 0.775 Test Loss: 0.620 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 96031
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.748420238494873
Epoch: 1, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.944 Vali Acc: 0.156 Test Loss: 1.944 Test Acc: 0.156
Validation loss decreased (inf --> -0.156050).  Saving model ...
Epoch: 2 cost time: 1.9678025245666504
Epoch: 2, Steps: 17 | Train Loss: 1.870 Vali Loss: 1.826 Vali Acc: 0.266 Test Loss: 1.826 Test Acc: 0.266
Validation loss decreased (-0.156050 --> -0.265878).  Saving model ...
Epoch: 3 cost time: 2.175020456314087
Epoch: 3, Steps: 17 | Train Loss: 1.727 Vali Loss: 1.694 Vali Acc: 0.347 Test Loss: 1.694 Test Acc: 0.347
Validation loss decreased (-0.265878 --> -0.346804).  Saving model ...
Epoch: 4 cost time: 2.313985586166382
Epoch: 4, Steps: 17 | Train Loss: 1.557 Vali Loss: 1.515 Vali Acc: 0.405 Test Loss: 1.515 Test Acc: 0.405
Validation loss decreased (-0.346804 --> -0.404609).  Saving model ...
Epoch: 5 cost time: 2.3961968421936035
Epoch: 5, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.373 Vali Acc: 0.457 Test Loss: 1.373 Test Acc: 0.457
Validation loss decreased (-0.404609 --> -0.456634).  Saving model ...
Epoch: 6 cost time: 2.314155101776123
Epoch: 6, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.253 Vali Acc: 0.538 Test Loss: 1.253 Test Acc: 0.538
Validation loss decreased (-0.456634 --> -0.537560).  Saving model ...
Epoch: 7 cost time: 2.250199556350708
Epoch: 7, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.153 Vali Acc: 0.595 Test Loss: 1.153 Test Acc: 0.595
Validation loss decreased (-0.537560 --> -0.595364).  Saving model ...
Epoch: 8 cost time: 2.0685672760009766
Epoch: 8, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.043 Vali Acc: 0.630 Test Loss: 1.043 Test Acc: 0.630
Validation loss decreased (-0.595364 --> -0.630047).  Saving model ...
Epoch: 9 cost time: 2.021665573120117
Epoch: 9, Steps: 17 | Train Loss: 0.836 Vali Loss: 0.947 Vali Acc: 0.688 Test Loss: 0.947 Test Acc: 0.688
Validation loss decreased (-0.630047 --> -0.687852).  Saving model ...
Epoch: 10 cost time: 2.069239854812622
Epoch: 10, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.848 Vali Acc: 0.734 Test Loss: 0.848 Test Acc: 0.734
Validation loss decreased (-0.687852 --> -0.734096).  Saving model ...
Epoch: 11 cost time: 2.0937817096710205
Epoch: 11, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.796 Vali Acc: 0.728 Test Loss: 0.796 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.183786392211914
Epoch: 12, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.779 Vali Acc: 0.740 Test Loss: 0.779 Test Acc: 0.740
Validation loss decreased (-0.734096 --> -0.739877).  Saving model ...
Epoch: 13 cost time: 2.0627095699310303
Epoch: 13, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.700 Vali Acc: 0.734 Test Loss: 0.700 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.078994035720825
Epoch: 14, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.624 Vali Acc: 0.763 Test Loss: 0.624 Test Acc: 0.763
Validation loss decreased (-0.739877 --> -0.763000).  Saving model ...
Epoch: 15 cost time: 2.2397050857543945
Epoch: 15, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.618 Vali Acc: 0.780 Test Loss: 0.618 Test Acc: 0.780
Validation loss decreased (-0.763000 --> -0.780341).  Saving model ...
Epoch: 16 cost time: 2.0934979915618896
Epoch: 16, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.586 Vali Acc: 0.769 Test Loss: 0.586 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.18441104888916
Epoch: 17, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.619 Vali Acc: 0.769 Test Loss: 0.619 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.06559681892395
Epoch: 18, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.544 Vali Acc: 0.780 Test Loss: 0.544 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 19 cost time: 2.122107982635498
Epoch: 19, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.584 Vali Acc: 0.769 Test Loss: 0.584 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.290757894515991
Epoch: 20, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.557 Vali Acc: 0.792 Test Loss: 0.557 Test Acc: 0.792
Validation loss decreased (-0.780341 --> -0.791902).  Saving model ...
Epoch: 21 cost time: 1.914428949356079
Epoch: 21, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.566 Vali Acc: 0.786 Test Loss: 0.566 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0573623180389404
Epoch: 22, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
Validation loss decreased (-0.791902 --> -0.809243).  Saving model ...
Epoch: 23 cost time: 2.153465509414673
Epoch: 23, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.92323899269104
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.549 Vali Acc: 0.798 Test Loss: 0.549 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.859609603881836
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.545 Vali Acc: 0.832 Test Loss: 0.545 Test Acc: 0.832
Validation loss decreased (-0.809243 --> -0.832364).  Saving model ...
Epoch: 26 cost time: 1.8678882122039795
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9606285095214844
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.553 Vali Acc: 0.821 Test Loss: 0.553 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9295036792755127
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.540 Vali Acc: 0.821 Test Loss: 0.540 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9237093925476074
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0408518314361572
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.558 Vali Acc: 0.821 Test Loss: 0.558 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 251311
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5499587059020996
Epoch: 1, Steps: 17 | Train Loss: 2.028 Vali Loss: 1.989 Vali Acc: 0.156 Test Loss: 1.989 Test Acc: 0.156
Validation loss decreased (inf --> -0.156049).  Saving model ...
Epoch: 2 cost time: 1.83079195022583
Epoch: 2, Steps: 17 | Train Loss: 1.921 Vali Loss: 1.892 Vali Acc: 0.208 Test Loss: 1.892 Test Acc: 0.208
Validation loss decreased (-0.156049 --> -0.208074).  Saving model ...
Epoch: 3 cost time: 1.884429693222046
Epoch: 3, Steps: 17 | Train Loss: 1.782 Vali Loss: 1.765 Vali Acc: 0.306 Test Loss: 1.765 Test Acc: 0.306
Validation loss decreased (-0.208074 --> -0.306341).  Saving model ...
Epoch: 4 cost time: 1.809755563735962
Epoch: 4, Steps: 17 | Train Loss: 1.661 Vali Loss: 1.634 Vali Acc: 0.347 Test Loss: 1.634 Test Acc: 0.347
Validation loss decreased (-0.306341 --> -0.346804).  Saving model ...
Epoch: 5 cost time: 1.9047374725341797
Epoch: 5, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.488 Vali Acc: 0.451 Test Loss: 1.488 Test Acc: 0.451
Validation loss decreased (-0.346804 --> -0.450852).  Saving model ...
Epoch: 6 cost time: 1.8867003917694092
Epoch: 6, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.347 Vali Acc: 0.491 Test Loss: 1.347 Test Acc: 0.491
Validation loss decreased (-0.450852 --> -0.491316).  Saving model ...
Epoch: 7 cost time: 1.891672134399414
Epoch: 7, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.225 Vali Acc: 0.555 Test Loss: 1.225 Test Acc: 0.555
Validation loss decreased (-0.491316 --> -0.554901).  Saving model ...
Epoch: 8 cost time: 1.8121976852416992
Epoch: 8, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.120 Vali Acc: 0.590 Test Loss: 1.120 Test Acc: 0.590
Validation loss decreased (-0.554901 --> -0.589584).  Saving model ...
Epoch: 9 cost time: 1.9558684825897217
Epoch: 9, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.044 Vali Acc: 0.682 Test Loss: 1.044 Test Acc: 0.682
Validation loss decreased (-0.589584 --> -0.682070).  Saving model ...
Epoch: 10 cost time: 1.809105634689331
Epoch: 10, Steps: 17 | Train Loss: 0.800 Vali Loss: 0.940 Vali Acc: 0.723 Test Loss: 0.940 Test Acc: 0.723
Validation loss decreased (-0.682070 --> -0.722534).  Saving model ...
Epoch: 11 cost time: 1.8658485412597656
Epoch: 11, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.838 Vali Acc: 0.746 Test Loss: 0.838 Test Acc: 0.746
Validation loss decreased (-0.722534 --> -0.745656).  Saving model ...
Epoch: 12 cost time: 1.899125576019287
Epoch: 12, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.835 Vali Acc: 0.717 Test Loss: 0.835 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.814307689666748
Epoch: 13, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.754 Vali Acc: 0.751 Test Loss: 0.754 Test Acc: 0.751
Validation loss decreased (-0.745656 --> -0.751438).  Saving model ...
Epoch: 14 cost time: 1.7772703170776367
Epoch: 14, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.665 Vali Acc: 0.786 Test Loss: 0.665 Test Acc: 0.786
Validation loss decreased (-0.751438 --> -0.786121).  Saving model ...
Epoch: 15 cost time: 1.66162109375
Epoch: 15, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.639 Vali Acc: 0.751 Test Loss: 0.639 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7799139022827148
Epoch: 16, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.643 Vali Acc: 0.769 Test Loss: 0.643 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6834285259246826
Epoch: 17, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.600 Vali Acc: 0.786 Test Loss: 0.600 Test Acc: 0.786
Validation loss decreased (-0.786121 --> -0.786121).  Saving model ...
Epoch: 18 cost time: 1.7716271877288818
Epoch: 18, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.862980604171753
Epoch: 19, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.613 Vali Acc: 0.786 Test Loss: 0.613 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7199757099151611
Epoch: 20, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.676 Vali Acc: 0.751 Test Loss: 0.676 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.812363862991333
Epoch: 21, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
Validation loss decreased (-0.786121 --> -0.803463).  Saving model ...
Epoch: 22 cost time: 1.732905626296997
Epoch: 22, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.591 Vali Acc: 0.757 Test Loss: 0.591 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.241729497909546
Epoch: 23, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.663 Vali Acc: 0.780 Test Loss: 0.663 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.815087080001831
Epoch: 24, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.639 Vali Acc: 0.780 Test Loss: 0.639 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8909399509429932
Epoch: 25, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.671 Vali Acc: 0.780 Test Loss: 0.671 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8528811931610107
Epoch: 26, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.609 Vali Acc: 0.792 Test Loss: 0.609 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8899593353271484
Epoch: 27, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.571 Vali Acc: 0.792 Test Loss: 0.571 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8378968238830566
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.700 Vali Acc: 0.775 Test Loss: 0.700 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9534578323364258
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.599 Vali Acc: 0.792 Test Loss: 0.599 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9626848697662354
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.641 Vali Acc: 0.780 Test Loss: 0.641 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 96031
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.59943151473999
Epoch: 1, Steps: 17 | Train Loss: 1.868 Vali Loss: 1.592 Vali Acc: 0.370 Test Loss: 1.592 Test Acc: 0.370
Validation loss decreased (inf --> -0.369926).  Saving model ...
Epoch: 2 cost time: 18.019492864608765
Epoch: 2, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.176 Vali Acc: 0.503 Test Loss: 1.176 Test Acc: 0.503
Validation loss decreased (-0.369926 --> -0.502878).  Saving model ...
Epoch: 3 cost time: 19.57007336616516
Epoch: 3, Steps: 17 | Train Loss: 0.931 Vali Loss: 0.909 Vali Acc: 0.665 Test Loss: 0.909 Test Acc: 0.665
Validation loss decreased (-0.502878 --> -0.664731).  Saving model ...
Epoch: 4 cost time: 20.798309087753296
Epoch: 4, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.785 Vali Acc: 0.682 Test Loss: 0.785 Test Acc: 0.682
Validation loss decreased (-0.664731 --> -0.682073).  Saving model ...
Epoch: 5 cost time: 21.06433868408203
Epoch: 5, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.754 Vali Acc: 0.671 Test Loss: 0.754 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.315945386886597
Epoch: 6, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.481 Vali Acc: 0.821 Test Loss: 0.481 Test Acc: 0.821
Validation loss decreased (-0.682073 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 19.281859397888184
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.693 Vali Acc: 0.775 Test Loss: 0.693 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.34533190727234
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.517 Vali Acc: 0.827 Test Loss: 0.517 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826584).  Saving model ...
Epoch: 9 cost time: 18.464343309402466
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.553 Vali Acc: 0.769 Test Loss: 0.553 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.754836559295654
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.792 Test Loss: 0.475 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 17.567001581192017
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.958423852920532
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.798 Test Loss: 0.490 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 21.8218355178833
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.821 Test Loss: 0.495 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 22.12019944190979
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.798 Test Loss: 0.503 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 22.73321795463562
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.827 Test Loss: 0.493 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826585).  Saving model ...
Epoch: 16 cost time: 22.021503925323486
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.209606647491455
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.815 Test Loss: 0.505 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 22.199190139770508
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.821 Test Loss: 0.502 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 20.905749320983887
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.815 Test Loss: 0.514 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 20.791199684143066
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.815 Test Loss: 0.514 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 21.522809982299805
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.815 Test Loss: 0.517 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 22.036659955978394
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.815 Test Loss: 0.523 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 21.78322744369507
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.815 Test Loss: 0.531 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 20.56864905357361
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 20.806473970413208
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.815 Test Loss: 0.525 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 37990791
model size : 147.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.378165483474731
Epoch: 1, Steps: 17 | Train Loss: 1.828 Vali Loss: 1.546 Vali Acc: 0.341 Test Loss: 1.546 Test Acc: 0.341
Validation loss decreased (inf --> -0.341025).  Saving model ...
Epoch: 2 cost time: 7.741146564483643
Epoch: 2, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.206 Vali Acc: 0.538 Test Loss: 1.206 Test Acc: 0.538
Validation loss decreased (-0.341025 --> -0.537560).  Saving model ...
Epoch: 3 cost time: 8.011559247970581
Epoch: 3, Steps: 17 | Train Loss: 0.890 Vali Loss: 0.943 Vali Acc: 0.624 Test Loss: 0.943 Test Acc: 0.624
Validation loss decreased (-0.537560 --> -0.624268).  Saving model ...
Epoch: 4 cost time: 8.287471532821655
Epoch: 4, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.777 Vali Acc: 0.705 Test Loss: 0.777 Test Acc: 0.705
Validation loss decreased (-0.624268 --> -0.705195).  Saving model ...
Epoch: 5 cost time: 7.784229516983032
Epoch: 5, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.644 Vali Acc: 0.757 Test Loss: 0.644 Test Acc: 0.757
Validation loss decreased (-0.705195 --> -0.757219).  Saving model ...
Epoch: 6 cost time: 7.6423728466033936
Epoch: 6, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.643 Vali Acc: 0.751 Test Loss: 0.643 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.6085803508758545
Epoch: 7, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.619 Vali Acc: 0.757 Test Loss: 0.619 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 8 cost time: 7.917449951171875
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.456 Vali Acc: 0.827 Test Loss: 0.456 Test Acc: 0.827
Validation loss decreased (-0.757219 --> -0.826585).  Saving model ...
Epoch: 9 cost time: 7.803081035614014
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.671 Vali Acc: 0.746 Test Loss: 0.671 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.987394094467163
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.619 Vali Acc: 0.775 Test Loss: 0.619 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.8586790561676025
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.32176661491394
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.490 Vali Acc: 0.815 Test Loss: 0.490 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.934192895889282
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.019372701644897
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.02732515335083
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.815 Test Loss: 0.485 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.126929998397827
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.11759638786316
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.043487548828125
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.815 Test Loss: 0.495 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 11512711
model size : 46.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.851847648620605
Epoch: 1, Steps: 17 | Train Loss: 1.868 Vali Loss: 1.592 Vali Acc: 0.370 Test Loss: 1.592 Test Acc: 0.370
Validation loss decreased (inf --> -0.369926).  Saving model ...
Epoch: 2 cost time: 16.009251832962036
Epoch: 2, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.176 Vali Acc: 0.503 Test Loss: 1.176 Test Acc: 0.503
Validation loss decreased (-0.369926 --> -0.502878).  Saving model ...
Epoch: 3 cost time: 16.53962254524231
Epoch: 3, Steps: 17 | Train Loss: 0.931 Vali Loss: 0.909 Vali Acc: 0.665 Test Loss: 0.909 Test Acc: 0.665
Validation loss decreased (-0.502878 --> -0.664731).  Saving model ...
Epoch: 4 cost time: 16.706823587417603
Epoch: 4, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.785 Vali Acc: 0.682 Test Loss: 0.785 Test Acc: 0.682
Validation loss decreased (-0.664731 --> -0.682073).  Saving model ...
Epoch: 5 cost time: 15.052230596542358
Epoch: 5, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.754 Vali Acc: 0.671 Test Loss: 0.754 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.911975145339966
Epoch: 6, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.481 Vali Acc: 0.821 Test Loss: 0.481 Test Acc: 0.821
Validation loss decreased (-0.682073 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 14.305350065231323
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.693 Vali Acc: 0.775 Test Loss: 0.693 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.69414210319519
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.517 Vali Acc: 0.827 Test Loss: 0.517 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826584).  Saving model ...
Epoch: 9 cost time: 15.343211650848389
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.553 Vali Acc: 0.769 Test Loss: 0.553 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.635101318359375
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.792 Test Loss: 0.475 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 15.394099235534668
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 15.373802185058594
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.798 Test Loss: 0.490 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 15.156185150146484
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.821 Test Loss: 0.495 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 16.20532774925232
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.798 Test Loss: 0.503 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 16.46832585334778
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.827 Test Loss: 0.493 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826585).  Saving model ...
Epoch: 16 cost time: 16.53023409843445
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 16.379202127456665
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.815 Test Loss: 0.505 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 15.474697589874268
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.821 Test Loss: 0.502 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 15.407266855239868
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.815 Test Loss: 0.514 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 14.957123279571533
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.815 Test Loss: 0.514 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 16.238205671310425
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.815 Test Loss: 0.517 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 16.08600902557373
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.815 Test Loss: 0.523 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 16.921737909317017
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.815 Test Loss: 0.531 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 17.07176899909973
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 16.851091623306274
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.815 Test Loss: 0.525 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 37990791
model size : 147.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.6853928565979
Epoch: 1, Steps: 17 | Train Loss: 1.828 Vali Loss: 1.546 Vali Acc: 0.341 Test Loss: 1.546 Test Acc: 0.341
Validation loss decreased (inf --> -0.341025).  Saving model ...
Epoch: 2 cost time: 6.635049819946289
Epoch: 2, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.206 Vali Acc: 0.538 Test Loss: 1.206 Test Acc: 0.538
Validation loss decreased (-0.341025 --> -0.537560).  Saving model ...
Epoch: 3 cost time: 6.826141357421875
Epoch: 3, Steps: 17 | Train Loss: 0.890 Vali Loss: 0.943 Vali Acc: 0.624 Test Loss: 0.943 Test Acc: 0.624
Validation loss decreased (-0.537560 --> -0.624268).  Saving model ...
Epoch: 4 cost time: 6.342377185821533
Epoch: 4, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.777 Vali Acc: 0.705 Test Loss: 0.777 Test Acc: 0.705
Validation loss decreased (-0.624268 --> -0.705195).  Saving model ...
Epoch: 5 cost time: 5.972510576248169
Epoch: 5, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.644 Vali Acc: 0.757 Test Loss: 0.644 Test Acc: 0.757
Validation loss decreased (-0.705195 --> -0.757219).  Saving model ...
Epoch: 6 cost time: 6.40497088432312
Epoch: 6, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.643 Vali Acc: 0.751 Test Loss: 0.643 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.877638578414917
Epoch: 7, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.619 Vali Acc: 0.757 Test Loss: 0.619 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 8 cost time: 6.2266786098480225
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.456 Vali Acc: 0.827 Test Loss: 0.456 Test Acc: 0.827
Validation loss decreased (-0.757219 --> -0.826585).  Saving model ...
Epoch: 9 cost time: 5.973705291748047
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.671 Vali Acc: 0.746 Test Loss: 0.671 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.902925252914429
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.619 Vali Acc: 0.775 Test Loss: 0.619 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.175524711608887
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.230649471282959
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.490 Vali Acc: 0.815 Test Loss: 0.490 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.206995964050293
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.573654413223267
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.722717523574829
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.815 Test Loss: 0.485 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.78403639793396
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.518001317977905
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.875694513320923
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.815 Test Loss: 0.495 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 11512711
model size : 46.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.357378721237183
Epoch: 1, Steps: 17 | Train Loss: 1.868 Vali Loss: 1.592 Vali Acc: 0.370 Test Loss: 1.592 Test Acc: 0.370
Validation loss decreased (inf --> -0.369926).  Saving model ...
Epoch: 2 cost time: 10.521576881408691
Epoch: 2, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.176 Vali Acc: 0.503 Test Loss: 1.176 Test Acc: 0.503
Validation loss decreased (-0.369926 --> -0.502878).  Saving model ...
Epoch: 3 cost time: 10.712931632995605
Epoch: 3, Steps: 17 | Train Loss: 0.931 Vali Loss: 0.909 Vali Acc: 0.665 Test Loss: 0.909 Test Acc: 0.665
Validation loss decreased (-0.502878 --> -0.664731).  Saving model ...
Epoch: 4 cost time: 10.544613122940063
Epoch: 4, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.785 Vali Acc: 0.682 Test Loss: 0.785 Test Acc: 0.682
Validation loss decreased (-0.664731 --> -0.682073).  Saving model ...
Epoch: 5 cost time: 10.631092548370361
Epoch: 5, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.754 Vali Acc: 0.671 Test Loss: 0.754 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.930793762207031
Epoch: 6, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.481 Vali Acc: 0.821 Test Loss: 0.481 Test Acc: 0.821
Validation loss decreased (-0.682073 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 10.289428234100342
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.693 Vali Acc: 0.775 Test Loss: 0.693 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.253622055053711
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.517 Vali Acc: 0.827 Test Loss: 0.517 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826584).  Saving model ...
Epoch: 9 cost time: 9.86356806755066
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.553 Vali Acc: 0.769 Test Loss: 0.553 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.727394342422485
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.792 Test Loss: 0.475 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.706482648849487
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.4907066822052
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.798 Test Loss: 0.490 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.309026002883911
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.821 Test Loss: 0.495 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.767220735549927
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.798 Test Loss: 0.503 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.244075059890747
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.827 Test Loss: 0.493 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826585).  Saving model ...
Epoch: 16 cost time: 10.194494724273682
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.466017007827759
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.815 Test Loss: 0.505 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.161060571670532
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.821 Test Loss: 0.502 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.223087787628174
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.815 Test Loss: 0.514 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.209055185317993
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.815 Test Loss: 0.514 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.120871543884277
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.815 Test Loss: 0.517 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.946676969528198
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.815 Test Loss: 0.523 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 9.966927528381348
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.815 Test Loss: 0.531 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 9.864885568618774
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 9.782862901687622
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.815 Test Loss: 0.525 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 37990791
model size : 147.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.156429290771484
Epoch: 1, Steps: 17 | Train Loss: 1.828 Vali Loss: 1.546 Vali Acc: 0.341 Test Loss: 1.546 Test Acc: 0.341
Validation loss decreased (inf --> -0.341025).  Saving model ...
Epoch: 2 cost time: 4.4537193775177
Epoch: 2, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.206 Vali Acc: 0.538 Test Loss: 1.206 Test Acc: 0.538
Validation loss decreased (-0.341025 --> -0.537560).  Saving model ...
Epoch: 3 cost time: 4.308285713195801
Epoch: 3, Steps: 17 | Train Loss: 0.890 Vali Loss: 0.943 Vali Acc: 0.624 Test Loss: 0.943 Test Acc: 0.624
Validation loss decreased (-0.537560 --> -0.624268).  Saving model ...
Epoch: 4 cost time: 4.6839423179626465
Epoch: 4, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.777 Vali Acc: 0.705 Test Loss: 0.777 Test Acc: 0.705
Validation loss decreased (-0.624268 --> -0.705195).  Saving model ...
Epoch: 5 cost time: 4.577831506729126
Epoch: 5, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.644 Vali Acc: 0.757 Test Loss: 0.644 Test Acc: 0.757
Validation loss decreased (-0.705195 --> -0.757219).  Saving model ...
Epoch: 6 cost time: 4.665392875671387
Epoch: 6, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.643 Vali Acc: 0.751 Test Loss: 0.643 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.685506820678711
Epoch: 7, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.619 Vali Acc: 0.757 Test Loss: 0.619 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 8 cost time: 4.907482862472534
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.456 Vali Acc: 0.827 Test Loss: 0.456 Test Acc: 0.827
Validation loss decreased (-0.757219 --> -0.826585).  Saving model ...
Epoch: 9 cost time: 5.03273868560791
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.671 Vali Acc: 0.746 Test Loss: 0.671 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.880509376525879
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.619 Vali Acc: 0.775 Test Loss: 0.619 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.883706331253052
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.037502288818359
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.490 Vali Acc: 0.815 Test Loss: 0.490 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.874959230422974
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.829740047454834
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.555493593215942
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.815 Test Loss: 0.485 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.783368110656738
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.8734095096588135
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.715717315673828
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.815 Test Loss: 0.495 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 11512711
model size : 46.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.364293336868286
Epoch: 1, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.517 Vali Acc: 0.318 Test Loss: 1.517 Test Acc: 0.318
Validation loss decreased (inf --> -0.317904).  Saving model ...
Epoch: 2 cost time: 11.534712553024292
Epoch: 2, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.358 Vali Acc: 0.491 Test Loss: 1.358 Test Acc: 0.491
Validation loss decreased (-0.317904 --> -0.491316).  Saving model ...
Epoch: 3 cost time: 11.708117723464966
Epoch: 3, Steps: 17 | Train Loss: 0.920 Vali Loss: 0.951 Vali Acc: 0.705 Test Loss: 0.951 Test Acc: 0.705
Validation loss decreased (-0.491316 --> -0.705193).  Saving model ...
Epoch: 4 cost time: 11.333351373672485
Epoch: 4, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.723 Vali Acc: 0.728 Test Loss: 0.723 Test Acc: 0.728
Validation loss decreased (-0.705193 --> -0.728316).  Saving model ...
Epoch: 5 cost time: 11.422300338745117
Epoch: 5, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.631 Vali Acc: 0.757 Test Loss: 0.631 Test Acc: 0.757
Validation loss decreased (-0.728316 --> -0.757219).  Saving model ...
Epoch: 6 cost time: 10.9819495677948
Epoch: 6, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.609 Vali Acc: 0.746 Test Loss: 0.609 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.719280004501343
Epoch: 7, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.632 Vali Acc: 0.751 Test Loss: 0.632 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.719419002532959
Epoch: 8, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.484 Vali Acc: 0.832 Test Loss: 0.484 Test Acc: 0.832
Validation loss decreased (-0.757219 --> -0.832365).  Saving model ...
Epoch: 9 cost time: 11.12701964378357
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.529 Vali Acc: 0.786 Test Loss: 0.529 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.452039957046509
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.401 Vali Acc: 0.844 Test Loss: 0.401 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843927).  Saving model ...
Epoch: 11 cost time: 11.851075649261475
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.455 Vali Acc: 0.838 Test Loss: 0.455 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.06764841079712
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.832 Test Loss: 0.443 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.114384889602661
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.844 Test Loss: 0.434 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.196582555770874
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.832 Test Loss: 0.440 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.932227611541748
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.838 Test Loss: 0.444 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.29795217514038
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.844 Test Loss: 0.445 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.102945566177368
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.27923059463501
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.832 Test Loss: 0.452 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 12.253863334655762
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.827 Test Loss: 0.457 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.431179761886597
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.838 Test Loss: 0.456 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 19245959
model size : 75.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.716819524765015
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.577 Vali Acc: 0.410 Test Loss: 1.577 Test Acc: 0.410
Validation loss decreased (inf --> -0.410389).  Saving model ...
Epoch: 2 cost time: 4.983221769332886
Epoch: 2, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.228 Vali Acc: 0.486 Test Loss: 1.228 Test Acc: 0.486
Validation loss decreased (-0.410389 --> -0.485537).  Saving model ...
Epoch: 3 cost time: 5.205261468887329
Epoch: 3, Steps: 17 | Train Loss: 0.888 Vali Loss: 0.913 Vali Acc: 0.699 Test Loss: 0.913 Test Acc: 0.699
Validation loss decreased (-0.485537 --> -0.699413).  Saving model ...
Epoch: 4 cost time: 4.928111553192139
Epoch: 4, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.740 Vali Acc: 0.757 Test Loss: 0.740 Test Acc: 0.757
Validation loss decreased (-0.699413 --> -0.757218).  Saving model ...
Epoch: 5 cost time: 5.033632040023804
Epoch: 5, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.689 Vali Acc: 0.740 Test Loss: 0.689 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.187638759613037
Epoch: 6, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.740 Vali Acc: 0.746 Test Loss: 0.740 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.833124399185181
Epoch: 7, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.575 Vali Acc: 0.798 Test Loss: 0.575 Test Acc: 0.798
Validation loss decreased (-0.757218 --> -0.797682).  Saving model ...
Epoch: 8 cost time: 5.117942571640015
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.474 Vali Acc: 0.798 Test Loss: 0.474 Test Acc: 0.798
Validation loss decreased (-0.797682 --> -0.797683).  Saving model ...
Epoch: 9 cost time: 4.682295799255371
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.610 Vali Acc: 0.769 Test Loss: 0.610 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.305140495300293
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.649 Vali Acc: 0.786 Test Loss: 0.649 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.103484392166138
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.513 Vali Acc: 0.827 Test Loss: 0.513 Test Acc: 0.827
Validation loss decreased (-0.797683 --> -0.826584).  Saving model ...
Epoch: 12 cost time: 5.372219085693359
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.0311598777771
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.956952810287476
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.164416551589966
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.0641748905181885
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.191927194595337
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.306173086166382
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.798 Test Loss: 0.518 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.482615232467651
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.103797197341919
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.792 Test Loss: 0.518 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.241345643997192
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 6006663
model size : 25.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.483392715454102
Epoch: 1, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.517 Vali Acc: 0.318 Test Loss: 1.517 Test Acc: 0.318
Validation loss decreased (inf --> -0.317904).  Saving model ...
Epoch: 2 cost time: 9.322190046310425
Epoch: 2, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.358 Vali Acc: 0.491 Test Loss: 1.358 Test Acc: 0.491
Validation loss decreased (-0.317904 --> -0.491316).  Saving model ...
Epoch: 3 cost time: 9.157536268234253
Epoch: 3, Steps: 17 | Train Loss: 0.920 Vali Loss: 0.951 Vali Acc: 0.705 Test Loss: 0.951 Test Acc: 0.705
Validation loss decreased (-0.491316 --> -0.705193).  Saving model ...
Epoch: 4 cost time: 9.653882265090942
Epoch: 4, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.723 Vali Acc: 0.728 Test Loss: 0.723 Test Acc: 0.728
Validation loss decreased (-0.705193 --> -0.728316).  Saving model ...
Epoch: 5 cost time: 8.942638635635376
Epoch: 5, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.631 Vali Acc: 0.757 Test Loss: 0.631 Test Acc: 0.757
Validation loss decreased (-0.728316 --> -0.757219).  Saving model ...
Epoch: 6 cost time: 9.14327073097229
Epoch: 6, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.609 Vali Acc: 0.746 Test Loss: 0.609 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.447871685028076
Epoch: 7, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.632 Vali Acc: 0.751 Test Loss: 0.632 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.541098356246948
Epoch: 8, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.484 Vali Acc: 0.832 Test Loss: 0.484 Test Acc: 0.832
Validation loss decreased (-0.757219 --> -0.832365).  Saving model ...
Epoch: 9 cost time: 9.40321683883667
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.529 Vali Acc: 0.786 Test Loss: 0.529 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.233211278915405
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.401 Vali Acc: 0.844 Test Loss: 0.401 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843927).  Saving model ...
Epoch: 11 cost time: 9.445597410202026
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.455 Vali Acc: 0.838 Test Loss: 0.455 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.488816022872925
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.832 Test Loss: 0.443 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.626654386520386
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.844 Test Loss: 0.434 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.522621154785156
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.832 Test Loss: 0.440 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.576180458068848
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.838 Test Loss: 0.444 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.563145637512207
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.844 Test Loss: 0.445 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.58944845199585
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 9.603529453277588
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.832 Test Loss: 0.452 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.741673946380615
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.827 Test Loss: 0.457 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.7749183177948
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.838 Test Loss: 0.456 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 19245959
model size : 75.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.150599718093872
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.577 Vali Acc: 0.410 Test Loss: 1.577 Test Acc: 0.410
Validation loss decreased (inf --> -0.410389).  Saving model ...
Epoch: 2 cost time: 4.631177663803101
Epoch: 2, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.228 Vali Acc: 0.486 Test Loss: 1.228 Test Acc: 0.486
Validation loss decreased (-0.410389 --> -0.485537).  Saving model ...
Epoch: 3 cost time: 4.290149211883545
Epoch: 3, Steps: 17 | Train Loss: 0.888 Vali Loss: 0.913 Vali Acc: 0.699 Test Loss: 0.913 Test Acc: 0.699
Validation loss decreased (-0.485537 --> -0.699413).  Saving model ...
Epoch: 4 cost time: 4.316356182098389
Epoch: 4, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.740 Vali Acc: 0.757 Test Loss: 0.740 Test Acc: 0.757
Validation loss decreased (-0.699413 --> -0.757218).  Saving model ...
Epoch: 5 cost time: 4.278048276901245
Epoch: 5, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.689 Vali Acc: 0.740 Test Loss: 0.689 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.0654778480529785
Epoch: 6, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.740 Vali Acc: 0.746 Test Loss: 0.740 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9148404598236084
Epoch: 7, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.575 Vali Acc: 0.798 Test Loss: 0.575 Test Acc: 0.798
Validation loss decreased (-0.757218 --> -0.797682).  Saving model ...
Epoch: 8 cost time: 4.380683422088623
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.474 Vali Acc: 0.798 Test Loss: 0.474 Test Acc: 0.798
Validation loss decreased (-0.797682 --> -0.797683).  Saving model ...
Epoch: 9 cost time: 4.331921815872192
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.610 Vali Acc: 0.769 Test Loss: 0.610 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9749915599823
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.649 Vali Acc: 0.786 Test Loss: 0.649 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.97487735748291
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.513 Vali Acc: 0.827 Test Loss: 0.513 Test Acc: 0.827
Validation loss decreased (-0.797683 --> -0.826584).  Saving model ...
Epoch: 12 cost time: 4.348405599594116
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.290146112442017
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.542201280593872
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.121885776519775
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.258139133453369
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.259966135025024
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.960911750793457
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.798 Test Loss: 0.518 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.377853631973267
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.138052225112915
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.792 Test Loss: 0.518 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.9976930618286133
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 6006663
model size : 25.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.73119330406189
Epoch: 1, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.517 Vali Acc: 0.318 Test Loss: 1.517 Test Acc: 0.318
Validation loss decreased (inf --> -0.317904).  Saving model ...
Epoch: 2 cost time: 6.286686420440674
Epoch: 2, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.358 Vali Acc: 0.491 Test Loss: 1.358 Test Acc: 0.491
Validation loss decreased (-0.317904 --> -0.491316).  Saving model ...
Epoch: 3 cost time: 6.434834957122803
Epoch: 3, Steps: 17 | Train Loss: 0.920 Vali Loss: 0.951 Vali Acc: 0.705 Test Loss: 0.951 Test Acc: 0.705
Validation loss decreased (-0.491316 --> -0.705193).  Saving model ...
Epoch: 4 cost time: 6.3433990478515625
Epoch: 4, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.723 Vali Acc: 0.728 Test Loss: 0.723 Test Acc: 0.728
Validation loss decreased (-0.705193 --> -0.728316).  Saving model ...
Epoch: 5 cost time: 6.044286489486694
Epoch: 5, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.631 Vali Acc: 0.757 Test Loss: 0.631 Test Acc: 0.757
Validation loss decreased (-0.728316 --> -0.757219).  Saving model ...
Epoch: 6 cost time: 6.507700681686401
Epoch: 6, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.609 Vali Acc: 0.746 Test Loss: 0.609 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.488285303115845
Epoch: 7, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.632 Vali Acc: 0.751 Test Loss: 0.632 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.385024309158325
Epoch: 8, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.484 Vali Acc: 0.832 Test Loss: 0.484 Test Acc: 0.832
Validation loss decreased (-0.757219 --> -0.832365).  Saving model ...
Epoch: 9 cost time: 6.567353010177612
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.529 Vali Acc: 0.786 Test Loss: 0.529 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.47791600227356
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.401 Vali Acc: 0.844 Test Loss: 0.401 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843927).  Saving model ...
Epoch: 11 cost time: 5.863301753997803
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.455 Vali Acc: 0.838 Test Loss: 0.455 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.033038377761841
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.832 Test Loss: 0.443 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.213430404663086
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.844 Test Loss: 0.434 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.947197437286377
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.832 Test Loss: 0.440 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.090048313140869
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.838 Test Loss: 0.444 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.9887940883636475
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.844 Test Loss: 0.445 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.903708457946777
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.555476427078247
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.832 Test Loss: 0.452 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.312122821807861
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.827 Test Loss: 0.457 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.386403799057007
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.838 Test Loss: 0.456 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 19245959
model size : 75.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.689925670623779
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.577 Vali Acc: 0.410 Test Loss: 1.577 Test Acc: 0.410
Validation loss decreased (inf --> -0.410389).  Saving model ...
Epoch: 2 cost time: 3.188074827194214
Epoch: 2, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.228 Vali Acc: 0.486 Test Loss: 1.228 Test Acc: 0.486
Validation loss decreased (-0.410389 --> -0.485537).  Saving model ...
Epoch: 3 cost time: 3.1014575958251953
Epoch: 3, Steps: 17 | Train Loss: 0.888 Vali Loss: 0.913 Vali Acc: 0.699 Test Loss: 0.913 Test Acc: 0.699
Validation loss decreased (-0.485537 --> -0.699413).  Saving model ...
Epoch: 4 cost time: 3.127894639968872
Epoch: 4, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.740 Vali Acc: 0.757 Test Loss: 0.740 Test Acc: 0.757
Validation loss decreased (-0.699413 --> -0.757218).  Saving model ...
Epoch: 5 cost time: 3.077359914779663
Epoch: 5, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.689 Vali Acc: 0.740 Test Loss: 0.689 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.994661569595337
Epoch: 6, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.740 Vali Acc: 0.746 Test Loss: 0.740 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9229352474212646
Epoch: 7, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.575 Vali Acc: 0.798 Test Loss: 0.575 Test Acc: 0.798
Validation loss decreased (-0.757218 --> -0.797682).  Saving model ...
Epoch: 8 cost time: 2.9765944480895996
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.474 Vali Acc: 0.798 Test Loss: 0.474 Test Acc: 0.798
Validation loss decreased (-0.797682 --> -0.797683).  Saving model ...
Epoch: 9 cost time: 3.153156042098999
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.610 Vali Acc: 0.769 Test Loss: 0.610 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0085678100585938
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.649 Vali Acc: 0.786 Test Loss: 0.649 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9980547428131104
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.513 Vali Acc: 0.827 Test Loss: 0.513 Test Acc: 0.827
Validation loss decreased (-0.797683 --> -0.826584).  Saving model ...
Epoch: 12 cost time: 3.0857107639312744
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.001469135284424
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9845845699310303
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0943734645843506
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0264413356781006
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.045754909515381
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.014761447906494
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.798 Test Loss: 0.518 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.0632083415985107
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.0088157653808594
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.792 Test Loss: 0.518 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.992135763168335
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 6006663
model size : 25.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.445889234542847
Epoch: 1, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.748 Vali Acc: 0.260 Test Loss: 1.748 Test Acc: 0.260
Validation loss decreased (inf --> -0.260098).  Saving model ...
Epoch: 2 cost time: 12.48682689666748
Epoch: 2, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.380 Vali Acc: 0.480 Test Loss: 1.380 Test Acc: 0.480
Validation loss decreased (-0.260098 --> -0.479755).  Saving model ...
Epoch: 3 cost time: 13.51602840423584
Epoch: 3, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.139 Vali Acc: 0.503 Test Loss: 1.139 Test Acc: 0.503
Validation loss decreased (-0.479755 --> -0.502879).  Saving model ...
Epoch: 4 cost time: 13.905411005020142
Epoch: 4, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.001 Vali Acc: 0.613 Test Loss: 1.001 Test Acc: 0.613
Validation loss decreased (-0.502879 --> -0.612707).  Saving model ...
Epoch: 5 cost time: 13.20898699760437
Epoch: 5, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.740 Vali Acc: 0.775 Test Loss: 0.740 Test Acc: 0.775
Validation loss decreased (-0.612707 --> -0.774559).  Saving model ...
Epoch: 6 cost time: 14.020337343215942
Epoch: 6, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.011800289154053
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.535 Vali Acc: 0.809 Test Loss: 0.535 Test Acc: 0.809
Validation loss decreased (-0.774559 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 13.992486238479614
Epoch: 8, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.597 Vali Acc: 0.769 Test Loss: 0.597 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.086815118789673
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.110754489898682
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.630 Vali Acc: 0.775 Test Loss: 0.630 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.104848861694336
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.447 Vali Acc: 0.832 Test Loss: 0.447 Test Acc: 0.832
Validation loss decreased (-0.809243 --> -0.832365).  Saving model ...
Epoch: 12 cost time: 14.185801267623901
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.645 Vali Acc: 0.763 Test Loss: 0.645 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.856613874435425
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.526 Vali Acc: 0.827 Test Loss: 0.526 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.992066383361816
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.631556272506714
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.667842864990234
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 12.534534931182861
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.803 Test Loss: 0.572 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 13.306331157684326
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 13.333940029144287
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.809 Test Loss: 0.559 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 13.07634973526001
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.815 Test Loss: 0.578 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 13.488645315170288
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 18996935
model size : 73.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.4925665855407715
Epoch: 1, Steps: 17 | Train Loss: 2.010 Vali Loss: 1.723 Vali Acc: 0.329 Test Loss: 1.723 Test Acc: 0.329
Validation loss decreased (inf --> -0.329463).  Saving model ...
Epoch: 2 cost time: 5.92465353012085
Epoch: 2, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.379 Vali Acc: 0.376 Test Loss: 1.379 Test Acc: 0.376
Validation loss decreased (-0.329463 --> -0.375709).  Saving model ...
Epoch: 3 cost time: 5.964444160461426
Epoch: 3, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.192 Vali Acc: 0.462 Test Loss: 1.192 Test Acc: 0.462
Validation loss decreased (-0.375709 --> -0.462416).  Saving model ...
Epoch: 4 cost time: 5.915225028991699
Epoch: 4, Steps: 17 | Train Loss: 0.836 Vali Loss: 0.880 Vali Acc: 0.746 Test Loss: 0.880 Test Acc: 0.746
Validation loss decreased (-0.462416 --> -0.745656).  Saving model ...
Epoch: 5 cost time: 5.7259743213653564
Epoch: 5, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.715 Vali Acc: 0.798 Test Loss: 0.715 Test Acc: 0.798
Validation loss decreased (-0.745656 --> -0.797681).  Saving model ...
Epoch: 6 cost time: 5.974079847335815
Epoch: 6, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.593 Vali Acc: 0.815 Test Loss: 0.593 Test Acc: 0.815
Validation loss decreased (-0.797681 --> -0.815023).  Saving model ...
Epoch: 7 cost time: 6.003402948379517
Epoch: 7, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.636 Vali Acc: 0.757 Test Loss: 0.636 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.921139717102051
Epoch: 8, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.537 Vali Acc: 0.827 Test Loss: 0.537 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826584).  Saving model ...
Epoch: 9 cost time: 6.007831335067749
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.523 Vali Acc: 0.821 Test Loss: 0.523 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.670018911361694
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.633965492248535
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.523 Vali Acc: 0.798 Test Loss: 0.523 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.583238124847412
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.509 Vali Acc: 0.780 Test Loss: 0.509 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.5760602951049805
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.510 Vali Acc: 0.780 Test Loss: 0.510 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.496027708053589
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.775 Test Loss: 0.559 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.505429267883301
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.780 Test Loss: 0.549 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.4032785892486572
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.786 Test Loss: 0.610 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.252872705459595
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.792 Test Loss: 0.540 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.923412322998047
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.780 Test Loss: 0.604 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 5757383
model size : 23.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.05208969116211
Epoch: 1, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.748 Vali Acc: 0.260 Test Loss: 1.748 Test Acc: 0.260
Validation loss decreased (inf --> -0.260098).  Saving model ...
Epoch: 2 cost time: 10.400335788726807
Epoch: 2, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.380 Vali Acc: 0.480 Test Loss: 1.380 Test Acc: 0.480
Validation loss decreased (-0.260098 --> -0.479755).  Saving model ...
Epoch: 3 cost time: 10.307188034057617
Epoch: 3, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.139 Vali Acc: 0.503 Test Loss: 1.139 Test Acc: 0.503
Validation loss decreased (-0.479755 --> -0.502879).  Saving model ...
Epoch: 4 cost time: 10.361089706420898
Epoch: 4, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.001 Vali Acc: 0.613 Test Loss: 1.001 Test Acc: 0.613
Validation loss decreased (-0.502879 --> -0.612707).  Saving model ...
Epoch: 5 cost time: 10.099628210067749
Epoch: 5, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.740 Vali Acc: 0.775 Test Loss: 0.740 Test Acc: 0.775
Validation loss decreased (-0.612707 --> -0.774559).  Saving model ...
Epoch: 6 cost time: 9.758543729782104
Epoch: 6, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.841947555541992
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.535 Vali Acc: 0.809 Test Loss: 0.535 Test Acc: 0.809
Validation loss decreased (-0.774559 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 9.672659873962402
Epoch: 8, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.597 Vali Acc: 0.769 Test Loss: 0.597 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.794385194778442
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.836336135864258
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.630 Vali Acc: 0.775 Test Loss: 0.630 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.351231336593628
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.447 Vali Acc: 0.832 Test Loss: 0.447 Test Acc: 0.832
Validation loss decreased (-0.809243 --> -0.832365).  Saving model ...
Epoch: 12 cost time: 10.002216577529907
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.645 Vali Acc: 0.763 Test Loss: 0.645 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.841431856155396
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.526 Vali Acc: 0.827 Test Loss: 0.526 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.01512622833252
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.917203903198242
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.381546020507812
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.395704507827759
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.803 Test Loss: 0.572 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.380099773406982
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.569750308990479
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.809 Test Loss: 0.559 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.597414493560791
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.815 Test Loss: 0.578 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 9.649109125137329
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 18996935
model size : 73.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.054028511047363
Epoch: 1, Steps: 17 | Train Loss: 2.010 Vali Loss: 1.723 Vali Acc: 0.329 Test Loss: 1.723 Test Acc: 0.329
Validation loss decreased (inf --> -0.329463).  Saving model ...
Epoch: 2 cost time: 4.45791220664978
Epoch: 2, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.379 Vali Acc: 0.376 Test Loss: 1.379 Test Acc: 0.376
Validation loss decreased (-0.329463 --> -0.375709).  Saving model ...
Epoch: 3 cost time: 4.485463619232178
Epoch: 3, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.192 Vali Acc: 0.462 Test Loss: 1.192 Test Acc: 0.462
Validation loss decreased (-0.375709 --> -0.462416).  Saving model ...
Epoch: 4 cost time: 4.370302200317383
Epoch: 4, Steps: 17 | Train Loss: 0.836 Vali Loss: 0.880 Vali Acc: 0.746 Test Loss: 0.880 Test Acc: 0.746
Validation loss decreased (-0.462416 --> -0.745656).  Saving model ...
Epoch: 5 cost time: 4.863492965698242
Epoch: 5, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.715 Vali Acc: 0.798 Test Loss: 0.715 Test Acc: 0.798
Validation loss decreased (-0.745656 --> -0.797681).  Saving model ...
Epoch: 6 cost time: 4.835848808288574
Epoch: 6, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.593 Vali Acc: 0.815 Test Loss: 0.593 Test Acc: 0.815
Validation loss decreased (-0.797681 --> -0.815023).  Saving model ...
Epoch: 7 cost time: 4.682895660400391
Epoch: 7, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.636 Vali Acc: 0.757 Test Loss: 0.636 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.870787858963013
Epoch: 8, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.537 Vali Acc: 0.827 Test Loss: 0.537 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826584).  Saving model ...
Epoch: 9 cost time: 4.790440559387207
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.523 Vali Acc: 0.821 Test Loss: 0.523 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.5637593269348145
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.538600444793701
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.523 Vali Acc: 0.798 Test Loss: 0.523 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.560044765472412
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.509 Vali Acc: 0.780 Test Loss: 0.509 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.468291282653809
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.510 Vali Acc: 0.780 Test Loss: 0.510 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.591004133224487
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.775 Test Loss: 0.558 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.495669364929199
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.780 Test Loss: 0.549 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.508291959762573
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.786 Test Loss: 0.608 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.980668544769287
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.541 Vali Acc: 0.792 Test Loss: 0.541 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.311445713043213
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.780 Test Loss: 0.611 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 5757383
model size : 23.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.645372152328491
Epoch: 1, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.748 Vali Acc: 0.260 Test Loss: 1.748 Test Acc: 0.260
Validation loss decreased (inf --> -0.260098).  Saving model ...
Epoch: 2 cost time: 6.171928882598877
Epoch: 2, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.380 Vali Acc: 0.480 Test Loss: 1.380 Test Acc: 0.480
Validation loss decreased (-0.260098 --> -0.479755).  Saving model ...
Epoch: 3 cost time: 5.9070844650268555
Epoch: 3, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.139 Vali Acc: 0.503 Test Loss: 1.139 Test Acc: 0.503
Validation loss decreased (-0.479755 --> -0.502879).  Saving model ...
Epoch: 4 cost time: 6.381535768508911
Epoch: 4, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.001 Vali Acc: 0.613 Test Loss: 1.001 Test Acc: 0.613
Validation loss decreased (-0.502879 --> -0.612707).  Saving model ...
Epoch: 5 cost time: 6.081784963607788
Epoch: 5, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.740 Vali Acc: 0.775 Test Loss: 0.740 Test Acc: 0.775
Validation loss decreased (-0.612707 --> -0.774559).  Saving model ...
Epoch: 6 cost time: 6.6156628131866455
Epoch: 6, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.531220197677612
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.535 Vali Acc: 0.809 Test Loss: 0.535 Test Acc: 0.809
Validation loss decreased (-0.774559 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 6.510900020599365
Epoch: 8, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.597 Vali Acc: 0.769 Test Loss: 0.597 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.460399866104126
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.3629560470581055
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.630 Vali Acc: 0.775 Test Loss: 0.630 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.256639003753662
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.447 Vali Acc: 0.832 Test Loss: 0.447 Test Acc: 0.832
Validation loss decreased (-0.809243 --> -0.832365).  Saving model ...
Epoch: 12 cost time: 6.384373188018799
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.645 Vali Acc: 0.763 Test Loss: 0.645 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.467814922332764
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.526 Vali Acc: 0.827 Test Loss: 0.526 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.4481377601623535
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.803 Test Loss: 0.561 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.964792251586914
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.482643365859985
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.9329915046691895
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.680301904678345
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.815 Test Loss: 0.568 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.312024354934692
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.731663703918457
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.8924806118011475
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 18996935
model size : 73.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.677098989486694
Epoch: 1, Steps: 17 | Train Loss: 2.010 Vali Loss: 1.723 Vali Acc: 0.329 Test Loss: 1.723 Test Acc: 0.329
Validation loss decreased (inf --> -0.329463).  Saving model ...
Epoch: 2 cost time: 3.322660207748413
Epoch: 2, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.379 Vali Acc: 0.376 Test Loss: 1.379 Test Acc: 0.376
Validation loss decreased (-0.329463 --> -0.375709).  Saving model ...
Epoch: 3 cost time: 3.216244697570801
Epoch: 3, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.192 Vali Acc: 0.462 Test Loss: 1.192 Test Acc: 0.462
Validation loss decreased (-0.375709 --> -0.462416).  Saving model ...
Epoch: 4 cost time: 3.2153074741363525
Epoch: 4, Steps: 17 | Train Loss: 0.836 Vali Loss: 0.880 Vali Acc: 0.746 Test Loss: 0.880 Test Acc: 0.746
Validation loss decreased (-0.462416 --> -0.745656).  Saving model ...
Epoch: 5 cost time: 3.472440481185913
Epoch: 5, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.715 Vali Acc: 0.798 Test Loss: 0.715 Test Acc: 0.798
Validation loss decreased (-0.745656 --> -0.797681).  Saving model ...
Epoch: 6 cost time: 3.2547807693481445
Epoch: 6, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.593 Vali Acc: 0.815 Test Loss: 0.593 Test Acc: 0.815
Validation loss decreased (-0.797681 --> -0.815023).  Saving model ...
Epoch: 7 cost time: 3.1853017807006836
Epoch: 7, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.636 Vali Acc: 0.757 Test Loss: 0.636 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.221409559249878
Epoch: 8, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.537 Vali Acc: 0.827 Test Loss: 0.537 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826584).  Saving model ...
Epoch: 9 cost time: 3.3449270725250244
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.523 Vali Acc: 0.821 Test Loss: 0.523 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3391220569610596
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3487958908081055
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.522 Vali Acc: 0.798 Test Loss: 0.522 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3958964347839355
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.501 Vali Acc: 0.780 Test Loss: 0.501 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.4436583518981934
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.786 Test Loss: 0.507 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.308436870574951
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.516 Vali Acc: 0.786 Test Loss: 0.516 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.3901374340057373
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.786 Test Loss: 0.524 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2224388122558594
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.536 Vali Acc: 0.786 Test Loss: 0.536 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.113306999206543
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.786 Test Loss: 0.554 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.1745917797088623
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.792 Test Loss: 0.553 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 5757383
model size : 23.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.806754350662231
Epoch: 1, Steps: 17 | Train Loss: 1.874 Vali Loss: 1.660 Vali Acc: 0.347 Test Loss: 1.660 Test Acc: 0.347
Validation loss decreased (inf --> -0.346804).  Saving model ...
Epoch: 2 cost time: 7.1315295696258545
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.309 Vali Acc: 0.538 Test Loss: 1.309 Test Acc: 0.538
Validation loss decreased (-0.346804 --> -0.537559).  Saving model ...
Epoch: 3 cost time: 6.606783151626587
Epoch: 3, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.160 Vali Acc: 0.509 Test Loss: 1.160 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.693305015563965
Epoch: 4, Steps: 17 | Train Loss: 0.886 Vali Loss: 0.948 Vali Acc: 0.607 Test Loss: 0.948 Test Acc: 0.607
Validation loss decreased (-0.537559 --> -0.606927).  Saving model ...
Epoch: 5 cost time: 7.124633073806763
Epoch: 5, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.735 Vali Acc: 0.740 Test Loss: 0.735 Test Acc: 0.740
Validation loss decreased (-0.606927 --> -0.739877).  Saving model ...
Epoch: 6 cost time: 7.298304557800293
Epoch: 6, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.696 Vali Acc: 0.723 Test Loss: 0.696 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.243263006210327
Epoch: 7, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.611 Vali Acc: 0.780 Test Loss: 0.611 Test Acc: 0.780
Validation loss decreased (-0.739877 --> -0.780341).  Saving model ...
Epoch: 8 cost time: 7.068056106567383
Epoch: 8, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.471 Vali Acc: 0.798 Test Loss: 0.471 Test Acc: 0.798
Validation loss decreased (-0.780341 --> -0.797683).  Saving model ...
Epoch: 9 cost time: 7.935621023178101
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.457 Vali Acc: 0.821 Test Loss: 0.457 Test Acc: 0.821
Validation loss decreased (-0.797683 --> -0.820805).  Saving model ...
Epoch: 10 cost time: 7.789841651916504
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.790704965591431
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.505 Vali Acc: 0.821 Test Loss: 0.505 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.930653810501099
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.487 Vali Acc: 0.832 Test Loss: 0.487 Test Acc: 0.832
Validation loss decreased (-0.820805 --> -0.832365).  Saving model ...
Epoch: 13 cost time: 7.045607566833496
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.249089956283569
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.486 Vali Acc: 0.821 Test Loss: 0.486 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.254826068878174
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.507718324661255
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.821 Test Loss: 0.514 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.126348495483398
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.821 Test Loss: 0.509 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.372924566268921
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.815 Test Loss: 0.525 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.276500225067139
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.523 Vali Acc: 0.815 Test Loss: 0.523 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.516113519668579
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.821 Test Loss: 0.529 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.94441032409668
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.815 Test Loss: 0.533 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.992095947265625
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.821 Test Loss: 0.543 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 9623751
model size : 37.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.091835021972656
Epoch: 1, Steps: 17 | Train Loss: 1.913 Vali Loss: 1.676 Vali Acc: 0.295 Test Loss: 1.676 Test Acc: 0.295
Validation loss decreased (inf --> -0.294781).  Saving model ...
Epoch: 2 cost time: 3.6636593341827393
Epoch: 2, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.324 Vali Acc: 0.468 Test Loss: 1.324 Test Acc: 0.468
Validation loss decreased (-0.294781 --> -0.468195).  Saving model ...
Epoch: 3 cost time: 3.6716270446777344
Epoch: 3, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.189 Vali Acc: 0.462 Test Loss: 1.189 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4120426177978516
Epoch: 4, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.924 Vali Acc: 0.665 Test Loss: 0.924 Test Acc: 0.665
Validation loss decreased (-0.468195 --> -0.664731).  Saving model ...
Epoch: 5 cost time: 3.63399600982666
Epoch: 5, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.739 Vali Acc: 0.792 Test Loss: 0.739 Test Acc: 0.792
Validation loss decreased (-0.664731 --> -0.791900).  Saving model ...
Epoch: 6 cost time: 3.528672456741333
Epoch: 6, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.622 Vali Acc: 0.769 Test Loss: 0.622 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2308642864227295
Epoch: 7, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.551 Vali Acc: 0.827 Test Loss: 0.551 Test Acc: 0.827
Validation loss decreased (-0.791900 --> -0.826584).  Saving model ...
Epoch: 8 cost time: 3.4067764282226562
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2389681339263916
Epoch: 9, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.594 Vali Acc: 0.769 Test Loss: 0.594 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.4174041748046875
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.60493540763855
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
Validation loss decreased (-0.826584 --> -0.843926).  Saving model ...
Epoch: 12 cost time: 3.51650333404541
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3743467330932617
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.584512948989868
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.821 Test Loss: 0.495 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.4786880016326904
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.821 Test Loss: 0.481 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.551089286804199
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.821 Test Loss: 0.482 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.606215715408325
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.821 Test Loss: 0.491 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.6053810119628906
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.338867664337158
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.815 Test Loss: 0.493 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.986091375350952
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.9195468425750732
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3003847
model size : 12.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.769647598266602
Epoch: 1, Steps: 17 | Train Loss: 1.874 Vali Loss: 1.660 Vali Acc: 0.347 Test Loss: 1.660 Test Acc: 0.347
Validation loss decreased (inf --> -0.346804).  Saving model ...
Epoch: 2 cost time: 6.240360260009766
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.309 Vali Acc: 0.538 Test Loss: 1.309 Test Acc: 0.538
Validation loss decreased (-0.346804 --> -0.537559).  Saving model ...
Epoch: 3 cost time: 6.2404491901397705
Epoch: 3, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.160 Vali Acc: 0.509 Test Loss: 1.160 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.388444423675537
Epoch: 4, Steps: 17 | Train Loss: 0.886 Vali Loss: 0.948 Vali Acc: 0.607 Test Loss: 0.948 Test Acc: 0.607
Validation loss decreased (-0.537559 --> -0.606927).  Saving model ...
Epoch: 5 cost time: 6.2767791748046875
Epoch: 5, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.735 Vali Acc: 0.740 Test Loss: 0.735 Test Acc: 0.740
Validation loss decreased (-0.606927 --> -0.739877).  Saving model ...
Epoch: 6 cost time: 5.891962289810181
Epoch: 6, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.696 Vali Acc: 0.723 Test Loss: 0.696 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.111162900924683
Epoch: 7, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.611 Vali Acc: 0.780 Test Loss: 0.611 Test Acc: 0.780
Validation loss decreased (-0.739877 --> -0.780341).  Saving model ...
Epoch: 8 cost time: 5.918600797653198
Epoch: 8, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.471 Vali Acc: 0.798 Test Loss: 0.471 Test Acc: 0.798
Validation loss decreased (-0.780341 --> -0.797683).  Saving model ...
Epoch: 9 cost time: 5.595608949661255
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.457 Vali Acc: 0.821 Test Loss: 0.457 Test Acc: 0.821
Validation loss decreased (-0.797683 --> -0.820805).  Saving model ...
Epoch: 10 cost time: 5.28891396522522
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.729705333709717
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.505 Vali Acc: 0.821 Test Loss: 0.505 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.527180433273315
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.487 Vali Acc: 0.832 Test Loss: 0.487 Test Acc: 0.832
Validation loss decreased (-0.820805 --> -0.832365).  Saving model ...
Epoch: 13 cost time: 5.591635704040527
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.785789728164673
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.486 Vali Acc: 0.821 Test Loss: 0.486 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.3677263259887695
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.337127208709717
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.821 Test Loss: 0.514 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.269122123718262
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.821 Test Loss: 0.509 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.308445930480957
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.815 Test Loss: 0.525 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.217611789703369
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.523 Vali Acc: 0.815 Test Loss: 0.523 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.25014066696167
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.821 Test Loss: 0.529 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.182998895645142
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.815 Test Loss: 0.533 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.084855079650879
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.821 Test Loss: 0.543 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 9623751
model size : 37.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.497478008270264
Epoch: 1, Steps: 17 | Train Loss: 1.913 Vali Loss: 1.676 Vali Acc: 0.295 Test Loss: 1.676 Test Acc: 0.295
Validation loss decreased (inf --> -0.294781).  Saving model ...
Epoch: 2 cost time: 3.0003249645233154
Epoch: 2, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.324 Vali Acc: 0.468 Test Loss: 1.324 Test Acc: 0.468
Validation loss decreased (-0.294781 --> -0.468195).  Saving model ...
Epoch: 3 cost time: 3.1598806381225586
Epoch: 3, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.189 Vali Acc: 0.462 Test Loss: 1.189 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.938488006591797
Epoch: 4, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.924 Vali Acc: 0.665 Test Loss: 0.924 Test Acc: 0.665
Validation loss decreased (-0.468195 --> -0.664731).  Saving model ...
Epoch: 5 cost time: 2.950711250305176
Epoch: 5, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.739 Vali Acc: 0.792 Test Loss: 0.739 Test Acc: 0.792
Validation loss decreased (-0.664731 --> -0.791900).  Saving model ...
Epoch: 6 cost time: 2.9305756092071533
Epoch: 6, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.622 Vali Acc: 0.769 Test Loss: 0.622 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.862797737121582
Epoch: 7, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.551 Vali Acc: 0.827 Test Loss: 0.551 Test Acc: 0.827
Validation loss decreased (-0.791900 --> -0.826584).  Saving model ...
Epoch: 8 cost time: 2.369206190109253
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0956387519836426
Epoch: 9, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.594 Vali Acc: 0.769 Test Loss: 0.594 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.2830753326416016
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.1152002811431885
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
Validation loss decreased (-0.826584 --> -0.843926).  Saving model ...
Epoch: 12 cost time: 3.1891701221466064
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9077036380767822
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9118621349334717
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.821 Test Loss: 0.495 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0040087699890137
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.821 Test Loss: 0.481 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.1084272861480713
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.821 Test Loss: 0.482 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.9915037155151367
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.821 Test Loss: 0.491 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.126696825027466
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.0299813747406006
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.815 Test Loss: 0.493 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.9587833881378174
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.1558034420013428
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3003847
model size : 12.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.982062101364136
Epoch: 1, Steps: 17 | Train Loss: 1.874 Vali Loss: 1.660 Vali Acc: 0.347 Test Loss: 1.660 Test Acc: 0.347
Validation loss decreased (inf --> -0.346804).  Saving model ...
Epoch: 2 cost time: 2.8957250118255615
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.309 Vali Acc: 0.538 Test Loss: 1.309 Test Acc: 0.538
Validation loss decreased (-0.346804 --> -0.537559).  Saving model ...
Epoch: 3 cost time: 2.7624049186706543
Epoch: 3, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.160 Vali Acc: 0.509 Test Loss: 1.160 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5479395389556885
Epoch: 4, Steps: 17 | Train Loss: 0.886 Vali Loss: 0.948 Vali Acc: 0.607 Test Loss: 0.948 Test Acc: 0.607
Validation loss decreased (-0.537559 --> -0.606927).  Saving model ...
Epoch: 5 cost time: 3.6054131984710693
Epoch: 5, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.735 Vali Acc: 0.740 Test Loss: 0.735 Test Acc: 0.740
Validation loss decreased (-0.606927 --> -0.739877).  Saving model ...
Epoch: 6 cost time: 3.135558843612671
Epoch: 6, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.696 Vali Acc: 0.723 Test Loss: 0.696 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.829580068588257
Epoch: 7, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.611 Vali Acc: 0.780 Test Loss: 0.611 Test Acc: 0.780
Validation loss decreased (-0.739877 --> -0.780341).  Saving model ...
Epoch: 8 cost time: 3.827850818634033
Epoch: 8, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.471 Vali Acc: 0.798 Test Loss: 0.471 Test Acc: 0.798
Validation loss decreased (-0.780341 --> -0.797683).  Saving model ...
Epoch: 9 cost time: 3.8828043937683105
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.457 Vali Acc: 0.821 Test Loss: 0.457 Test Acc: 0.821
Validation loss decreased (-0.797683 --> -0.820805).  Saving model ...
Epoch: 10 cost time: 4.01235032081604
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8365488052368164
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.505 Vali Acc: 0.821 Test Loss: 0.505 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.764554500579834
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.487 Vali Acc: 0.832 Test Loss: 0.487 Test Acc: 0.832
Validation loss decreased (-0.820805 --> -0.832365).  Saving model ...
Epoch: 13 cost time: 3.8170993328094482
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.59077525138855
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.487 Vali Acc: 0.821 Test Loss: 0.487 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5040009021759033
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.982468605041504
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.2105767726898193
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.821 Test Loss: 0.509 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0792486667633057
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.815 Test Loss: 0.525 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.440717935562134
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.4892172813415527
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.4723122119903564
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.815 Test Loss: 0.535 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.3804731369018555
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.821 Test Loss: 0.545 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 9623751
model size : 37.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.774841547012329
Epoch: 1, Steps: 17 | Train Loss: 1.913 Vali Loss: 1.676 Vali Acc: 0.295 Test Loss: 1.676 Test Acc: 0.295
Validation loss decreased (inf --> -0.294781).  Saving model ...
Epoch: 2 cost time: 2.3970162868499756
Epoch: 2, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.324 Vali Acc: 0.468 Test Loss: 1.324 Test Acc: 0.468
Validation loss decreased (-0.294781 --> -0.468195).  Saving model ...
Epoch: 3 cost time: 2.065894842147827
Epoch: 3, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.189 Vali Acc: 0.462 Test Loss: 1.189 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2734835147857666
Epoch: 4, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.924 Vali Acc: 0.665 Test Loss: 0.924 Test Acc: 0.665
Validation loss decreased (-0.468195 --> -0.664731).  Saving model ...
Epoch: 5 cost time: 2.103950262069702
Epoch: 5, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.739 Vali Acc: 0.792 Test Loss: 0.739 Test Acc: 0.792
Validation loss decreased (-0.664731 --> -0.791900).  Saving model ...
Epoch: 6 cost time: 2.159724473953247
Epoch: 6, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.622 Vali Acc: 0.769 Test Loss: 0.622 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1950674057006836
Epoch: 7, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.551 Vali Acc: 0.827 Test Loss: 0.551 Test Acc: 0.827
Validation loss decreased (-0.791900 --> -0.826584).  Saving model ...
Epoch: 8 cost time: 2.130131483078003
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.245243549346924
Epoch: 9, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.594 Vali Acc: 0.769 Test Loss: 0.594 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.38197922706604
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.564918279647827
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
Validation loss decreased (-0.826584 --> -0.843926).  Saving model ...
Epoch: 12 cost time: 2.2028021812438965
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.006086587905884
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.080928325653076
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.821 Test Loss: 0.495 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1032350063323975
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.821 Test Loss: 0.481 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2281877994537354
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.821 Test Loss: 0.482 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2509241104125977
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.821 Test Loss: 0.491 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0726494789123535
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1668553352355957
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.815 Test Loss: 0.493 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0795998573303223
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.133742332458496
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3003847
model size : 12.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.1040143966674805
Epoch: 1, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.699 Vali Acc: 0.289 Test Loss: 1.699 Test Acc: 0.289
Validation loss decreased (inf --> -0.289000).  Saving model ...
Epoch: 2 cost time: 5.182616949081421
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.308 Vali Acc: 0.497 Test Loss: 1.308 Test Acc: 0.497
Validation loss decreased (-0.289000 --> -0.497097).  Saving model ...
Epoch: 3 cost time: 5.181770324707031
Epoch: 3, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.105 Vali Acc: 0.572 Test Loss: 1.105 Test Acc: 0.572
Validation loss decreased (-0.497097 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 5.07166862487793
Epoch: 4, Steps: 17 | Train Loss: 0.834 Vali Loss: 1.085 Vali Acc: 0.543 Test Loss: 1.085 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.050624847412109
Epoch: 5, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.852 Vali Acc: 0.659 Test Loss: 0.852 Test Acc: 0.659
Validation loss decreased (-0.572243 --> -0.658951).  Saving model ...
Epoch: 6 cost time: 4.985553503036499
Epoch: 6, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.662 Vali Acc: 0.798 Test Loss: 0.662 Test Acc: 0.798
Validation loss decreased (-0.658951 --> -0.797681).  Saving model ...
Epoch: 7 cost time: 5.05320143699646
Epoch: 7, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.060932397842407
Epoch: 8, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.612 Vali Acc: 0.775 Test Loss: 0.612 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.48771595954895
Epoch: 9, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.602 Vali Acc: 0.775 Test Loss: 0.602 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.3543572425842285
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803463).  Saving model ...
Epoch: 11 cost time: 4.333534479141235
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9519641399383545
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 13 cost time: 4.093355417251587
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.351416110992432
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.511 Vali Acc: 0.780 Test Loss: 0.511 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.696207761764526
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.509 Vali Acc: 0.798 Test Loss: 0.509 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.308539390563965
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.780 Test Loss: 0.520 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.942247629165649
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.792 Test Loss: 0.511 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.033701658248901
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.532 Vali Acc: 0.780 Test Loss: 0.532 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.99287223815918
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.529 Vali Acc: 0.792 Test Loss: 0.529 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.980631351470947
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.786 Test Loss: 0.518 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.97140645980835
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.786 Test Loss: 0.539 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.973674058914185
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.798 Test Loss: 0.538 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 4937159
model size : 20.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6435546875
Epoch: 1, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.688 Vali Acc: 0.283 Test Loss: 1.688 Test Acc: 0.283
Validation loss decreased (inf --> -0.283220).  Saving model ...
Epoch: 2 cost time: 2.42025089263916
Epoch: 2, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.358 Vali Acc: 0.457 Test Loss: 1.358 Test Acc: 0.457
Validation loss decreased (-0.283220 --> -0.456634).  Saving model ...
Epoch: 3 cost time: 2.5405399799346924
Epoch: 3, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.155 Vali Acc: 0.462 Test Loss: 1.155 Test Acc: 0.462
Validation loss decreased (-0.456634 --> -0.462416).  Saving model ...
Epoch: 4 cost time: 2.1872363090515137
Epoch: 4, Steps: 17 | Train Loss: 0.881 Vali Loss: 0.965 Vali Acc: 0.630 Test Loss: 0.965 Test Acc: 0.630
Validation loss decreased (-0.462416 --> -0.630048).  Saving model ...
Epoch: 5 cost time: 2.436769962310791
Epoch: 5, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.838 Vali Acc: 0.740 Test Loss: 0.838 Test Acc: 0.740
Validation loss decreased (-0.630048 --> -0.739876).  Saving model ...
Epoch: 6 cost time: 2.2319624423980713
Epoch: 6, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.621 Vali Acc: 0.792 Test Loss: 0.621 Test Acc: 0.792
Validation loss decreased (-0.739876 --> -0.791901).  Saving model ...
Epoch: 7 cost time: 2.3439536094665527
Epoch: 7, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.590 Vali Acc: 0.786 Test Loss: 0.590 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2842519283294678
Epoch: 8, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809243).  Saving model ...
Epoch: 9 cost time: 2.5029842853546143
Epoch: 9, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.579 Vali Acc: 0.821 Test Loss: 0.579 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820803).  Saving model ...
Epoch: 10 cost time: 2.4022676944732666
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4140758514404297
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.468 Vali Acc: 0.832 Test Loss: 0.468 Test Acc: 0.832
Validation loss decreased (-0.820803 --> -0.832365).  Saving model ...
Epoch: 12 cost time: 2.6776797771453857
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.458 Vali Acc: 0.827 Test Loss: 0.458 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3730459213256836
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 14 cost time: 2.218843936920166
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.41497802734375
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.477 Vali Acc: 0.827 Test Loss: 0.477 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4876255989074707
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.490 Vali Acc: 0.815 Test Loss: 0.490 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3431508541107178
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4381306171417236
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.349991798400879
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.513240337371826
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.4472320079803467
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.2593300342559814
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.815 Test Loss: 0.590 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.524109125137329
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1627079
model size : 7.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.14975643157959
Epoch: 1, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.699 Vali Acc: 0.289 Test Loss: 1.699 Test Acc: 0.289
Validation loss decreased (inf --> -0.289000).  Saving model ...
Epoch: 2 cost time: 3.6363000869750977
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.308 Vali Acc: 0.497 Test Loss: 1.308 Test Acc: 0.497
Validation loss decreased (-0.289000 --> -0.497097).  Saving model ...
Epoch: 3 cost time: 3.5177664756774902
Epoch: 3, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.105 Vali Acc: 0.572 Test Loss: 1.105 Test Acc: 0.572
Validation loss decreased (-0.497097 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 3.370995283126831
Epoch: 4, Steps: 17 | Train Loss: 0.834 Vali Loss: 1.085 Vali Acc: 0.543 Test Loss: 1.085 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8831934928894043
Epoch: 5, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.852 Vali Acc: 0.659 Test Loss: 0.852 Test Acc: 0.659
Validation loss decreased (-0.572243 --> -0.658951).  Saving model ...
Epoch: 6 cost time: 3.3970723152160645
Epoch: 6, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.662 Vali Acc: 0.798 Test Loss: 0.662 Test Acc: 0.798
Validation loss decreased (-0.658951 --> -0.797681).  Saving model ...
Epoch: 7 cost time: 3.488085985183716
Epoch: 7, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.417598009109497
Epoch: 8, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.612 Vali Acc: 0.775 Test Loss: 0.612 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.767042875289917
Epoch: 9, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.602 Vali Acc: 0.775 Test Loss: 0.602 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9478328227996826
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803463).  Saving model ...
Epoch: 11 cost time: 3.7592599391937256
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8489391803741455
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 13 cost time: 3.83024001121521
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7966389656066895
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.511 Vali Acc: 0.780 Test Loss: 0.511 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2937161922454834
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.509 Vali Acc: 0.798 Test Loss: 0.509 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.549529552459717
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.780 Test Loss: 0.520 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.5415782928466797
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.792 Test Loss: 0.511 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.4944896697998047
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.532 Vali Acc: 0.780 Test Loss: 0.532 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.261155366897583
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.529 Vali Acc: 0.792 Test Loss: 0.529 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.1765146255493164
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.786 Test Loss: 0.518 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.1128439903259277
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.786 Test Loss: 0.539 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.1120285987854004
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.798 Test Loss: 0.538 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 4937159
model size : 20.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.766124963760376
Epoch: 1, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.688 Vali Acc: 0.283 Test Loss: 1.688 Test Acc: 0.283
Validation loss decreased (inf --> -0.283220).  Saving model ...
Epoch: 2 cost time: 2.2087550163269043
Epoch: 2, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.358 Vali Acc: 0.457 Test Loss: 1.358 Test Acc: 0.457
Validation loss decreased (-0.283220 --> -0.456634).  Saving model ...
Epoch: 3 cost time: 2.175236463546753
Epoch: 3, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.155 Vali Acc: 0.462 Test Loss: 1.155 Test Acc: 0.462
Validation loss decreased (-0.456634 --> -0.462416).  Saving model ...
Epoch: 4 cost time: 2.141007900238037
Epoch: 4, Steps: 17 | Train Loss: 0.881 Vali Loss: 0.965 Vali Acc: 0.630 Test Loss: 0.965 Test Acc: 0.630
Validation loss decreased (-0.462416 --> -0.630048).  Saving model ...
Epoch: 5 cost time: 2.220954418182373
Epoch: 5, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.838 Vali Acc: 0.740 Test Loss: 0.838 Test Acc: 0.740
Validation loss decreased (-0.630048 --> -0.739876).  Saving model ...
Epoch: 6 cost time: 2.4701502323150635
Epoch: 6, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.621 Vali Acc: 0.792 Test Loss: 0.621 Test Acc: 0.792
Validation loss decreased (-0.739876 --> -0.791901).  Saving model ...
Epoch: 7 cost time: 2.327812910079956
Epoch: 7, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.590 Vali Acc: 0.786 Test Loss: 0.590 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2473642826080322
Epoch: 8, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809243).  Saving model ...
Epoch: 9 cost time: 2.265354633331299
Epoch: 9, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.579 Vali Acc: 0.821 Test Loss: 0.579 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820803).  Saving model ...
Epoch: 10 cost time: 2.188593626022339
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0149693489074707
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.468 Vali Acc: 0.832 Test Loss: 0.468 Test Acc: 0.832
Validation loss decreased (-0.820803 --> -0.832365).  Saving model ...
Epoch: 12 cost time: 1.867445468902588
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.458 Vali Acc: 0.827 Test Loss: 0.458 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1609363555908203
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 14 cost time: 2.1971325874328613
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1236886978149414
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.477 Vali Acc: 0.827 Test Loss: 0.477 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3472189903259277
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.815 Test Loss: 0.491 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.283022165298462
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.248000383377075
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.248992443084717
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.206782579421997
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.809 Test Loss: 0.545 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0943877696990967
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.815 Test Loss: 0.542 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4572842121124268
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.815 Test Loss: 0.591 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.433149576187134
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1627079
model size : 7.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.750185251235962
Epoch: 1, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.699 Vali Acc: 0.289 Test Loss: 1.699 Test Acc: 0.289
Validation loss decreased (inf --> -0.289000).  Saving model ...
Epoch: 2 cost time: 2.4806885719299316
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.308 Vali Acc: 0.497 Test Loss: 1.308 Test Acc: 0.497
Validation loss decreased (-0.289000 --> -0.497097).  Saving model ...
Epoch: 3 cost time: 2.494107484817505
Epoch: 3, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.105 Vali Acc: 0.572 Test Loss: 1.105 Test Acc: 0.572
Validation loss decreased (-0.497097 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 2.450364112854004
Epoch: 4, Steps: 17 | Train Loss: 0.834 Vali Loss: 1.085 Vali Acc: 0.543 Test Loss: 1.085 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3137388229370117
Epoch: 5, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.852 Vali Acc: 0.659 Test Loss: 0.852 Test Acc: 0.659
Validation loss decreased (-0.572243 --> -0.658951).  Saving model ...
Epoch: 6 cost time: 2.1858744621276855
Epoch: 6, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.662 Vali Acc: 0.798 Test Loss: 0.662 Test Acc: 0.798
Validation loss decreased (-0.658951 --> -0.797681).  Saving model ...
Epoch: 7 cost time: 2.544374942779541
Epoch: 7, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3724565505981445
Epoch: 8, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.612 Vali Acc: 0.775 Test Loss: 0.612 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5194737911224365
Epoch: 9, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.602 Vali Acc: 0.775 Test Loss: 0.602 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.270198345184326
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803463).  Saving model ...
Epoch: 11 cost time: 2.460149049758911
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.396489381790161
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 13 cost time: 2.4195749759674072
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.417102813720703
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.510 Vali Acc: 0.780 Test Loss: 0.510 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.465820550918579
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.509 Vali Acc: 0.798 Test Loss: 0.509 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5127367973327637
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.780 Test Loss: 0.519 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.455848217010498
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.792 Test Loss: 0.510 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.624720811843872
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.529 Vali Acc: 0.780 Test Loss: 0.529 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.421051025390625
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.526 Vali Acc: 0.792 Test Loss: 0.526 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6039931774139404
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.786 Test Loss: 0.515 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.471583604812622
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.786 Test Loss: 0.534 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.583871841430664
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.798 Test Loss: 0.532 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 4937159
model size : 20.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.085935354232788
Epoch: 1, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.688 Vali Acc: 0.283 Test Loss: 1.688 Test Acc: 0.283
Validation loss decreased (inf --> -0.283220).  Saving model ...
Epoch: 2 cost time: 1.576340913772583
Epoch: 2, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.358 Vali Acc: 0.457 Test Loss: 1.358 Test Acc: 0.457
Validation loss decreased (-0.283220 --> -0.456634).  Saving model ...
Epoch: 3 cost time: 1.6555159091949463
Epoch: 3, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.155 Vali Acc: 0.462 Test Loss: 1.155 Test Acc: 0.462
Validation loss decreased (-0.456634 --> -0.462416).  Saving model ...
Epoch: 4 cost time: 1.5791430473327637
Epoch: 4, Steps: 17 | Train Loss: 0.881 Vali Loss: 0.965 Vali Acc: 0.630 Test Loss: 0.965 Test Acc: 0.630
Validation loss decreased (-0.462416 --> -0.630048).  Saving model ...
Epoch: 5 cost time: 1.693462610244751
Epoch: 5, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.838 Vali Acc: 0.740 Test Loss: 0.838 Test Acc: 0.740
Validation loss decreased (-0.630048 --> -0.739876).  Saving model ...
Epoch: 6 cost time: 1.628770351409912
Epoch: 6, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.621 Vali Acc: 0.792 Test Loss: 0.621 Test Acc: 0.792
Validation loss decreased (-0.739876 --> -0.791901).  Saving model ...
Epoch: 7 cost time: 1.581648588180542
Epoch: 7, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.590 Vali Acc: 0.786 Test Loss: 0.590 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5877068042755127
Epoch: 8, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809243).  Saving model ...
Epoch: 9 cost time: 1.7091572284698486
Epoch: 9, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.579 Vali Acc: 0.821 Test Loss: 0.579 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820803).  Saving model ...
Epoch: 10 cost time: 1.6659460067749023
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6525466442108154
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.468 Vali Acc: 0.832 Test Loss: 0.468 Test Acc: 0.832
Validation loss decreased (-0.820803 --> -0.832365).  Saving model ...
Epoch: 12 cost time: 1.450990915298462
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.458 Vali Acc: 0.827 Test Loss: 0.458 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6941893100738525
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.496 Vali Acc: 0.838 Test Loss: 0.496 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 14 cost time: 1.616365909576416
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6619608402252197
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.477 Vali Acc: 0.827 Test Loss: 0.477 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6144905090332031
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.489 Vali Acc: 0.815 Test Loss: 0.489 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6264047622680664
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.815 Test Loss: 0.493 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6060280799865723
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.815 Test Loss: 0.500 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.775634527206421
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.486 Vali Acc: 0.815 Test Loss: 0.486 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7435696125030518
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.815 Test Loss: 0.505 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6998045444488525
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.827 Test Loss: 0.490 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.708235263824463
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.815 Test Loss: 0.507 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7744114398956299
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.827 Test Loss: 0.488 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1627079
model size : 7.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.955582618713379
Epoch: 1, Steps: 17 | Train Loss: 1.955 Vali Loss: 1.824 Vali Acc: 0.272 Test Loss: 1.824 Test Acc: 0.272
Validation loss decreased (inf --> -0.271658).  Saving model ...
Epoch: 2 cost time: 4.301136493682861
Epoch: 2, Steps: 17 | Train Loss: 1.682 Vali Loss: 1.539 Vali Acc: 0.393 Test Loss: 1.539 Test Acc: 0.393
Validation loss decreased (-0.271658 --> -0.393048).  Saving model ...
Epoch: 3 cost time: 3.751436233520508
Epoch: 3, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.295 Vali Acc: 0.491 Test Loss: 1.295 Test Acc: 0.491
Validation loss decreased (-0.393048 --> -0.491317).  Saving model ...
Epoch: 4 cost time: 3.8507156372070312
Epoch: 4, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.130 Vali Acc: 0.624 Test Loss: 1.130 Test Acc: 0.624
Validation loss decreased (-0.491317 --> -0.624266).  Saving model ...
Epoch: 5 cost time: 4.109880685806274
Epoch: 5, Steps: 17 | Train Loss: 0.875 Vali Loss: 0.974 Vali Acc: 0.659 Test Loss: 0.974 Test Acc: 0.659
Validation loss decreased (-0.624266 --> -0.658950).  Saving model ...
Epoch: 6 cost time: 3.9763967990875244
Epoch: 6, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.859 Vali Acc: 0.636 Test Loss: 0.859 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.411968946456909
Epoch: 7, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.717 Vali Acc: 0.728 Test Loss: 0.717 Test Acc: 0.728
Validation loss decreased (-0.658950 --> -0.728317).  Saving model ...
Epoch: 8 cost time: 4.88261079788208
Epoch: 8, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
Validation loss decreased (-0.728317 --> -0.757219).  Saving model ...
Epoch: 9 cost time: 4.847771406173706
Epoch: 9, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.588 Vali Acc: 0.775 Test Loss: 0.588 Test Acc: 0.775
Validation loss decreased (-0.757219 --> -0.774561).  Saving model ...
Epoch: 10 cost time: 4.7791454792022705
Epoch: 10, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.578 Vali Acc: 0.780 Test Loss: 0.578 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 11 cost time: 4.813929557800293
Epoch: 11, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.903342962265015
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.482 Vali Acc: 0.827 Test Loss: 0.482 Test Acc: 0.827
Validation loss decreased (-0.780341 --> -0.826585).  Saving model ...
Epoch: 13 cost time: 4.908211708068848
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.476 Vali Acc: 0.832 Test Loss: 0.476 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 14 cost time: 4.8880627155303955
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.490 Vali Acc: 0.827 Test Loss: 0.490 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.367481708526611
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.502 Vali Acc: 0.821 Test Loss: 0.502 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.043034553527832
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.113582134246826
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.568 Vali Acc: 0.798 Test Loss: 0.568 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.9751648902893066
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.566 Vali Acc: 0.798 Test Loss: 0.566 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.069933891296387
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.786 Test Loss: 0.607 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.031542778015137
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.597 Vali Acc: 0.798 Test Loss: 0.597 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.312015533447266
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.780 Test Loss: 0.727 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.3631064891815186
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.960 Vali Acc: 0.757 Test Loss: 0.960 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.858540296554565
Epoch: 23, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.793 Vali Acc: 0.757 Test Loss: 0.793 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 4812647
model size : 18.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.204649448394775
Epoch: 1, Steps: 17 | Train Loss: 1.941 Vali Loss: 1.778 Vali Acc: 0.329 Test Loss: 1.778 Test Acc: 0.329
Validation loss decreased (inf --> -0.329462).  Saving model ...
Epoch: 2 cost time: 2.6077022552490234
Epoch: 2, Steps: 17 | Train Loss: 1.673 Vali Loss: 1.513 Vali Acc: 0.399 Test Loss: 1.513 Test Acc: 0.399
Validation loss decreased (-0.329462 --> -0.398829).  Saving model ...
Epoch: 3 cost time: 2.647740364074707
Epoch: 3, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.283 Vali Acc: 0.584 Test Loss: 1.283 Test Acc: 0.584
Validation loss decreased (-0.398829 --> -0.583802).  Saving model ...
Epoch: 4 cost time: 2.42790150642395
Epoch: 4, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.137 Vali Acc: 0.595 Test Loss: 1.137 Test Acc: 0.595
Validation loss decreased (-0.583802 --> -0.595364).  Saving model ...
Epoch: 5 cost time: 2.494990825653076
Epoch: 5, Steps: 17 | Train Loss: 0.935 Vali Loss: 0.950 Vali Acc: 0.699 Test Loss: 0.950 Test Acc: 0.699
Validation loss decreased (-0.595364 --> -0.699412).  Saving model ...
Epoch: 6 cost time: 2.251225471496582
Epoch: 6, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.847 Vali Acc: 0.734 Test Loss: 0.847 Test Acc: 0.734
Validation loss decreased (-0.699412 --> -0.734096).  Saving model ...
Epoch: 7 cost time: 2.2465429306030273
Epoch: 7, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.670 Vali Acc: 0.803 Test Loss: 0.670 Test Acc: 0.803
Validation loss decreased (-0.734096 --> -0.803462).  Saving model ...
Epoch: 8 cost time: 2.340327739715576
Epoch: 8, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.735 Vali Acc: 0.740 Test Loss: 0.735 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2661848068237305
Epoch: 9, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.591 Vali Acc: 0.786 Test Loss: 0.591 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4694600105285645
Epoch: 10, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.477 Vali Acc: 0.879 Test Loss: 0.477 Test Acc: 0.879
Validation loss decreased (-0.803462 --> -0.878608).  Saving model ...
Epoch: 11 cost time: 2.4389894008636475
Epoch: 11, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.520 Vali Acc: 0.792 Test Loss: 0.520 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.422677755355835
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.609 Vali Acc: 0.751 Test Loss: 0.609 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4317147731781006
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3410377502441406
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.342747926712036
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.431033134460449
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.516 Vali Acc: 0.798 Test Loss: 0.516 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.7046926021575928
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.476 Vali Acc: 0.798 Test Loss: 0.476 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.5804717540740967
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.720527410507202
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.507 Vali Acc: 0.798 Test Loss: 0.507 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.6334543228149414
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.503 Vali Acc: 0.821 Test Loss: 0.503 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 1502439
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.06116795539856
Epoch: 1, Steps: 17 | Train Loss: 1.955 Vali Loss: 1.824 Vali Acc: 0.272 Test Loss: 1.824 Test Acc: 0.272
Validation loss decreased (inf --> -0.271658).  Saving model ...
Epoch: 2 cost time: 3.530378818511963
Epoch: 2, Steps: 17 | Train Loss: 1.682 Vali Loss: 1.539 Vali Acc: 0.393 Test Loss: 1.539 Test Acc: 0.393
Validation loss decreased (-0.271658 --> -0.393048).  Saving model ...
Epoch: 3 cost time: 3.2879984378814697
Epoch: 3, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.295 Vali Acc: 0.491 Test Loss: 1.295 Test Acc: 0.491
Validation loss decreased (-0.393048 --> -0.491317).  Saving model ...
Epoch: 4 cost time: 3.255275249481201
Epoch: 4, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.130 Vali Acc: 0.624 Test Loss: 1.130 Test Acc: 0.624
Validation loss decreased (-0.491317 --> -0.624266).  Saving model ...
Epoch: 5 cost time: 3.44446063041687
Epoch: 5, Steps: 17 | Train Loss: 0.875 Vali Loss: 0.974 Vali Acc: 0.659 Test Loss: 0.974 Test Acc: 0.659
Validation loss decreased (-0.624266 --> -0.658950).  Saving model ...
Epoch: 6 cost time: 3.0933945178985596
Epoch: 6, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.859 Vali Acc: 0.636 Test Loss: 0.859 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.389613389968872
Epoch: 7, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.717 Vali Acc: 0.728 Test Loss: 0.717 Test Acc: 0.728
Validation loss decreased (-0.658950 --> -0.728317).  Saving model ...
Epoch: 8 cost time: 3.3492515087127686
Epoch: 8, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
Validation loss decreased (-0.728317 --> -0.757219).  Saving model ...
Epoch: 9 cost time: 3.362548589706421
Epoch: 9, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.588 Vali Acc: 0.775 Test Loss: 0.588 Test Acc: 0.775
Validation loss decreased (-0.757219 --> -0.774561).  Saving model ...
Epoch: 10 cost time: 3.381984233856201
Epoch: 10, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.578 Vali Acc: 0.780 Test Loss: 0.578 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 11 cost time: 3.5675110816955566
Epoch: 11, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4648830890655518
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.482 Vali Acc: 0.827 Test Loss: 0.482 Test Acc: 0.827
Validation loss decreased (-0.780341 --> -0.826585).  Saving model ...
Epoch: 13 cost time: 3.4159817695617676
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.476 Vali Acc: 0.832 Test Loss: 0.476 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 14 cost time: 3.4608213901519775
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.490 Vali Acc: 0.827 Test Loss: 0.490 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3564517498016357
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.502 Vali Acc: 0.821 Test Loss: 0.502 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3904871940612793
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5602760314941406
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.568 Vali Acc: 0.798 Test Loss: 0.568 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.7832517623901367
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.566 Vali Acc: 0.798 Test Loss: 0.566 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.7399814128875732
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.786 Test Loss: 0.607 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.3207767009735107
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.597 Vali Acc: 0.798 Test Loss: 0.597 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.319754123687744
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.780 Test Loss: 0.727 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.275681257247925
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.960 Vali Acc: 0.757 Test Loss: 0.960 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.48976731300354
Epoch: 23, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.793 Vali Acc: 0.757 Test Loss: 0.793 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 4812647
model size : 18.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3436331748962402
Epoch: 1, Steps: 17 | Train Loss: 1.941 Vali Loss: 1.778 Vali Acc: 0.329 Test Loss: 1.778 Test Acc: 0.329
Validation loss decreased (inf --> -0.329462).  Saving model ...
Epoch: 2 cost time: 2.0801663398742676
Epoch: 2, Steps: 17 | Train Loss: 1.673 Vali Loss: 1.513 Vali Acc: 0.399 Test Loss: 1.513 Test Acc: 0.399
Validation loss decreased (-0.329462 --> -0.398829).  Saving model ...
Epoch: 3 cost time: 1.9839611053466797
Epoch: 3, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.283 Vali Acc: 0.584 Test Loss: 1.283 Test Acc: 0.584
Validation loss decreased (-0.398829 --> -0.583802).  Saving model ...
Epoch: 4 cost time: 2.064835548400879
Epoch: 4, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.137 Vali Acc: 0.595 Test Loss: 1.137 Test Acc: 0.595
Validation loss decreased (-0.583802 --> -0.595364).  Saving model ...
Epoch: 5 cost time: 1.9921464920043945
Epoch: 5, Steps: 17 | Train Loss: 0.935 Vali Loss: 0.950 Vali Acc: 0.699 Test Loss: 0.950 Test Acc: 0.699
Validation loss decreased (-0.595364 --> -0.699412).  Saving model ...
Epoch: 6 cost time: 1.9773576259613037
Epoch: 6, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.847 Vali Acc: 0.734 Test Loss: 0.847 Test Acc: 0.734
Validation loss decreased (-0.699412 --> -0.734096).  Saving model ...
Epoch: 7 cost time: 2.1331520080566406
Epoch: 7, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.670 Vali Acc: 0.803 Test Loss: 0.670 Test Acc: 0.803
Validation loss decreased (-0.734096 --> -0.803462).  Saving model ...
Epoch: 8 cost time: 1.7993011474609375
Epoch: 8, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.735 Vali Acc: 0.740 Test Loss: 0.735 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8550810813903809
Epoch: 9, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.591 Vali Acc: 0.786 Test Loss: 0.591 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.805450677871704
Epoch: 10, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.477 Vali Acc: 0.879 Test Loss: 0.477 Test Acc: 0.879
Validation loss decreased (-0.803462 --> -0.878608).  Saving model ...
Epoch: 11 cost time: 1.8622322082519531
Epoch: 11, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.520 Vali Acc: 0.792 Test Loss: 0.520 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9622697830200195
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.609 Vali Acc: 0.751 Test Loss: 0.609 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1127638816833496
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.164858102798462
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0753674507141113
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1483612060546875
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.516 Vali Acc: 0.798 Test Loss: 0.516 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2343482971191406
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.476 Vali Acc: 0.798 Test Loss: 0.476 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.181567907333374
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1573164463043213
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.507 Vali Acc: 0.798 Test Loss: 0.507 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1334221363067627
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.503 Vali Acc: 0.821 Test Loss: 0.503 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 1502439
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.124988794326782
Epoch: 1, Steps: 17 | Train Loss: 1.955 Vali Loss: 1.824 Vali Acc: 0.272 Test Loss: 1.824 Test Acc: 0.272
Validation loss decreased (inf --> -0.271658).  Saving model ...
Epoch: 2 cost time: 2.8683173656463623
Epoch: 2, Steps: 17 | Train Loss: 1.682 Vali Loss: 1.539 Vali Acc: 0.393 Test Loss: 1.539 Test Acc: 0.393
Validation loss decreased (-0.271658 --> -0.393048).  Saving model ...
Epoch: 3 cost time: 2.806328535079956
Epoch: 3, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.295 Vali Acc: 0.491 Test Loss: 1.295 Test Acc: 0.491
Validation loss decreased (-0.393048 --> -0.491317).  Saving model ...
Epoch: 4 cost time: 2.753169536590576
Epoch: 4, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.130 Vali Acc: 0.624 Test Loss: 1.130 Test Acc: 0.624
Validation loss decreased (-0.491317 --> -0.624266).  Saving model ...
Epoch: 5 cost time: 3.0134761333465576
Epoch: 5, Steps: 17 | Train Loss: 0.875 Vali Loss: 0.974 Vali Acc: 0.659 Test Loss: 0.974 Test Acc: 0.659
Validation loss decreased (-0.624266 --> -0.658950).  Saving model ...
Epoch: 6 cost time: 2.7218191623687744
Epoch: 6, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.859 Vali Acc: 0.636 Test Loss: 0.859 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.551459550857544
Epoch: 7, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.717 Vali Acc: 0.728 Test Loss: 0.717 Test Acc: 0.728
Validation loss decreased (-0.658950 --> -0.728317).  Saving model ...
Epoch: 8 cost time: 2.706850290298462
Epoch: 8, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
Validation loss decreased (-0.728317 --> -0.757219).  Saving model ...
Epoch: 9 cost time: 2.6441447734832764
Epoch: 9, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.588 Vali Acc: 0.775 Test Loss: 0.588 Test Acc: 0.775
Validation loss decreased (-0.757219 --> -0.774561).  Saving model ...
Epoch: 10 cost time: 2.60426926612854
Epoch: 10, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.578 Vali Acc: 0.780 Test Loss: 0.578 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 11 cost time: 2.4310898780822754
Epoch: 11, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4101402759552
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.482 Vali Acc: 0.827 Test Loss: 0.482 Test Acc: 0.827
Validation loss decreased (-0.780341 --> -0.826585).  Saving model ...
Epoch: 13 cost time: 2.649444580078125
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.475 Vali Acc: 0.827 Test Loss: 0.475 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 14 cost time: 2.6637284755706787
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.488 Vali Acc: 0.832 Test Loss: 0.488 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 15 cost time: 2.638580083847046
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.501 Vali Acc: 0.821 Test Loss: 0.501 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6295464038848877
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.562 Vali Acc: 0.809 Test Loss: 0.562 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.700718402862549
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.569 Vali Acc: 0.798 Test Loss: 0.569 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.644839286804199
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.644432783126831
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.580 Vali Acc: 0.786 Test Loss: 0.580 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.6060290336608887
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.603 Vali Acc: 0.786 Test Loss: 0.603 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.629138708114624
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.613 Vali Acc: 0.798 Test Loss: 0.613 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6857519149780273
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.821 Test Loss: 0.559 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.8215296268463135
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.623 Vali Acc: 0.780 Test Loss: 0.623 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.9822094440460205
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.798 Test Loss: 0.600 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 4812647
model size : 18.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.292670488357544
Epoch: 1, Steps: 17 | Train Loss: 1.941 Vali Loss: 1.778 Vali Acc: 0.329 Test Loss: 1.778 Test Acc: 0.329
Validation loss decreased (inf --> -0.329462).  Saving model ...
Epoch: 2 cost time: 1.7781474590301514
Epoch: 2, Steps: 17 | Train Loss: 1.673 Vali Loss: 1.513 Vali Acc: 0.399 Test Loss: 1.513 Test Acc: 0.399
Validation loss decreased (-0.329462 --> -0.398829).  Saving model ...
Epoch: 3 cost time: 1.5904605388641357
Epoch: 3, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.283 Vali Acc: 0.584 Test Loss: 1.283 Test Acc: 0.584
Validation loss decreased (-0.398829 --> -0.583802).  Saving model ...
Epoch: 4 cost time: 1.7273752689361572
Epoch: 4, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.137 Vali Acc: 0.595 Test Loss: 1.137 Test Acc: 0.595
Validation loss decreased (-0.583802 --> -0.595364).  Saving model ...
Epoch: 5 cost time: 1.7662341594696045
Epoch: 5, Steps: 17 | Train Loss: 0.935 Vali Loss: 0.950 Vali Acc: 0.699 Test Loss: 0.950 Test Acc: 0.699
Validation loss decreased (-0.595364 --> -0.699412).  Saving model ...
Epoch: 6 cost time: 1.5806214809417725
Epoch: 6, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.847 Vali Acc: 0.734 Test Loss: 0.847 Test Acc: 0.734
Validation loss decreased (-0.699412 --> -0.734096).  Saving model ...
Epoch: 7 cost time: 1.4516746997833252
Epoch: 7, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.670 Vali Acc: 0.803 Test Loss: 0.670 Test Acc: 0.803
Validation loss decreased (-0.734096 --> -0.803462).  Saving model ...
Epoch: 8 cost time: 1.506626844406128
Epoch: 8, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.735 Vali Acc: 0.740 Test Loss: 0.735 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.531620740890503
Epoch: 9, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.591 Vali Acc: 0.786 Test Loss: 0.591 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4955244064331055
Epoch: 10, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.477 Vali Acc: 0.879 Test Loss: 0.477 Test Acc: 0.879
Validation loss decreased (-0.803462 --> -0.878608).  Saving model ...
Epoch: 11 cost time: 1.483445167541504
Epoch: 11, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.520 Vali Acc: 0.792 Test Loss: 0.520 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.687190294265747
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.609 Vali Acc: 0.751 Test Loss: 0.609 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6812114715576172
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6731081008911133
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.481 Vali Acc: 0.803 Test Loss: 0.481 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6337099075317383
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.784424066543579
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.530 Vali Acc: 0.792 Test Loss: 0.530 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5667831897735596
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.492 Vali Acc: 0.798 Test Loss: 0.492 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6892757415771484
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6558032035827637
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.512 Vali Acc: 0.798 Test Loss: 0.512 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6942028999328613
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.509 Vali Acc: 0.821 Test Loss: 0.509 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 1502439
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.317568063735962
Epoch: 1, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.714 Vali Acc: 0.399 Test Loss: 1.714 Test Acc: 0.399
Validation loss decreased (inf --> -0.398827).  Saving model ...
Epoch: 2 cost time: 3.408782482147217
Epoch: 2, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.446 Vali Acc: 0.514 Test Loss: 1.446 Test Acc: 0.514
Validation loss decreased (-0.398827 --> -0.514436).  Saving model ...
Epoch: 3 cost time: 3.465695381164551
Epoch: 3, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.259 Vali Acc: 0.607 Test Loss: 1.259 Test Acc: 0.607
Validation loss decreased (-0.514436 --> -0.606924).  Saving model ...
Epoch: 4 cost time: 3.418229818344116
Epoch: 4, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.129 Vali Acc: 0.601 Test Loss: 1.129 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.844212293624878
Epoch: 5, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.086 Vali Acc: 0.584 Test Loss: 1.086 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6311018466949463
Epoch: 6, Steps: 17 | Train Loss: 0.787 Vali Loss: 0.946 Vali Acc: 0.624 Test Loss: 0.946 Test Acc: 0.624
Validation loss decreased (-0.606924 --> -0.624268).  Saving model ...
Epoch: 7 cost time: 2.9328391551971436
Epoch: 7, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.763 Vali Acc: 0.757 Test Loss: 0.763 Test Acc: 0.757
Validation loss decreased (-0.624268 --> -0.757218).  Saving model ...
Epoch: 8 cost time: 2.8080689907073975
Epoch: 8, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.678 Vali Acc: 0.786 Test Loss: 0.678 Test Acc: 0.786
Validation loss decreased (-0.757218 --> -0.786120).  Saving model ...
Epoch: 9 cost time: 2.947819709777832
Epoch: 9, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.582 Vali Acc: 0.798 Test Loss: 0.582 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797682).  Saving model ...
Epoch: 10 cost time: 2.9934775829315186
Epoch: 10, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.587 Vali Acc: 0.775 Test Loss: 0.587 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7276272773742676
Epoch: 11, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809243).  Saving model ...
Epoch: 12 cost time: 3.062774419784546
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.511 Vali Acc: 0.827 Test Loss: 0.511 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826584).  Saving model ...
Epoch: 13 cost time: 3.0090737342834473
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.532 Vali Acc: 0.775 Test Loss: 0.532 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1922523975372314
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.543 Vali Acc: 0.780 Test Loss: 0.543 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4061172008514404
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.544 Vali Acc: 0.786 Test Loss: 0.544 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.193378210067749
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.798 Test Loss: 0.522 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.478436231613159
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.7275853157043457
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.588 Vali Acc: 0.798 Test Loss: 0.588 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.4788544178009033
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.6653764247894287
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.696880578994751
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.6794021129608154
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.803 Test Loss: 0.595 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2468967
model size : 10.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5341796875
Epoch: 1, Steps: 17 | Train Loss: 1.949 Vali Loss: 1.793 Vali Acc: 0.329 Test Loss: 1.793 Test Acc: 0.329
Validation loss decreased (inf --> -0.329462).  Saving model ...
Epoch: 2 cost time: 1.9827585220336914
Epoch: 2, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.513 Vali Acc: 0.364 Test Loss: 1.513 Test Acc: 0.364
Validation loss decreased (-0.329462 --> -0.364147).  Saving model ...
Epoch: 3 cost time: 2.0878756046295166
Epoch: 3, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.252 Vali Acc: 0.618 Test Loss: 1.252 Test Acc: 0.618
Validation loss decreased (-0.364147 --> -0.618485).  Saving model ...
Epoch: 4 cost time: 1.9932026863098145
Epoch: 4, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.101 Vali Acc: 0.595 Test Loss: 1.101 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0335633754730225
Epoch: 5, Steps: 17 | Train Loss: 0.871 Vali Loss: 0.951 Vali Acc: 0.647 Test Loss: 0.951 Test Acc: 0.647
Validation loss decreased (-0.618485 --> -0.647389).  Saving model ...
Epoch: 6 cost time: 1.9898865222930908
Epoch: 6, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.816 Vali Acc: 0.757 Test Loss: 0.816 Test Acc: 0.757
Validation loss decreased (-0.647389 --> -0.757217).  Saving model ...
Epoch: 7 cost time: 1.9866089820861816
Epoch: 7, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.708 Vali Acc: 0.734 Test Loss: 0.708 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.835435152053833
Epoch: 8, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.757217 --> -0.843925).  Saving model ...
Epoch: 9 cost time: 2.044796943664551
Epoch: 9, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.543 Vali Acc: 0.780 Test Loss: 0.543 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9191040992736816
Epoch: 10, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.503 Vali Acc: 0.821 Test Loss: 0.503 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5712249279022217
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.507 Vali Acc: 0.780 Test Loss: 0.507 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.204263687133789
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.489 Vali Acc: 0.798 Test Loss: 0.489 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.279883623123169
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.474 Vali Acc: 0.815 Test Loss: 0.474 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.283411741256714
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.437 Vali Acc: 0.809 Test Loss: 0.437 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.163245916366577
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.485 Vali Acc: 0.786 Test Loss: 0.485 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.2878003120422363
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.448 Vali Acc: 0.809 Test Loss: 0.448 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.2705373764038086
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2476766109466553
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 813799
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.528783798217773
Epoch: 1, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.714 Vali Acc: 0.399 Test Loss: 1.714 Test Acc: 0.399
Validation loss decreased (inf --> -0.398827).  Saving model ...
Epoch: 2 cost time: 2.9300825595855713
Epoch: 2, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.446 Vali Acc: 0.514 Test Loss: 1.446 Test Acc: 0.514
Validation loss decreased (-0.398827 --> -0.514436).  Saving model ...
Epoch: 3 cost time: 2.6425695419311523
Epoch: 3, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.259 Vali Acc: 0.607 Test Loss: 1.259 Test Acc: 0.607
Validation loss decreased (-0.514436 --> -0.606924).  Saving model ...
Epoch: 4 cost time: 2.7736992835998535
Epoch: 4, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.129 Vali Acc: 0.601 Test Loss: 1.129 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7531661987304688
Epoch: 5, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.086 Vali Acc: 0.584 Test Loss: 1.086 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.571566343307495
Epoch: 6, Steps: 17 | Train Loss: 0.787 Vali Loss: 0.946 Vali Acc: 0.624 Test Loss: 0.946 Test Acc: 0.624
Validation loss decreased (-0.606924 --> -0.624268).  Saving model ...
Epoch: 7 cost time: 2.36209774017334
Epoch: 7, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.763 Vali Acc: 0.757 Test Loss: 0.763 Test Acc: 0.757
Validation loss decreased (-0.624268 --> -0.757218).  Saving model ...
Epoch: 8 cost time: 2.7277865409851074
Epoch: 8, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.678 Vali Acc: 0.786 Test Loss: 0.678 Test Acc: 0.786
Validation loss decreased (-0.757218 --> -0.786120).  Saving model ...
Epoch: 9 cost time: 2.529114246368408
Epoch: 9, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.582 Vali Acc: 0.798 Test Loss: 0.582 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797682).  Saving model ...
Epoch: 10 cost time: 2.6424407958984375
Epoch: 10, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.587 Vali Acc: 0.775 Test Loss: 0.587 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.401622772216797
Epoch: 11, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809243).  Saving model ...
Epoch: 12 cost time: 2.6120564937591553
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.511 Vali Acc: 0.827 Test Loss: 0.511 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826584).  Saving model ...
Epoch: 13 cost time: 2.5321106910705566
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.532 Vali Acc: 0.775 Test Loss: 0.532 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0016441345214844
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.543 Vali Acc: 0.780 Test Loss: 0.543 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.124382495880127
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.544 Vali Acc: 0.786 Test Loss: 0.544 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.634929656982422
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.798 Test Loss: 0.522 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3767874240875244
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2664897441864014
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.588 Vali Acc: 0.798 Test Loss: 0.588 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.0285911560058594
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.372908115386963
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.4521896839141846
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.4460461139678955
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.803 Test Loss: 0.595 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2468967
model size : 10.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.814300298690796
Epoch: 1, Steps: 17 | Train Loss: 1.949 Vali Loss: 1.793 Vali Acc: 0.329 Test Loss: 1.793 Test Acc: 0.329
Validation loss decreased (inf --> -0.329462).  Saving model ...
Epoch: 2 cost time: 2.0524325370788574
Epoch: 2, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.513 Vali Acc: 0.364 Test Loss: 1.513 Test Acc: 0.364
Validation loss decreased (-0.329462 --> -0.364147).  Saving model ...
Epoch: 3 cost time: 2.107821226119995
Epoch: 3, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.252 Vali Acc: 0.618 Test Loss: 1.252 Test Acc: 0.618
Validation loss decreased (-0.364147 --> -0.618485).  Saving model ...
Epoch: 4 cost time: 1.9487483501434326
Epoch: 4, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.101 Vali Acc: 0.595 Test Loss: 1.101 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.899190902709961
Epoch: 5, Steps: 17 | Train Loss: 0.871 Vali Loss: 0.951 Vali Acc: 0.647 Test Loss: 0.951 Test Acc: 0.647
Validation loss decreased (-0.618485 --> -0.647389).  Saving model ...
Epoch: 6 cost time: 1.872849464416504
Epoch: 6, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.816 Vali Acc: 0.757 Test Loss: 0.816 Test Acc: 0.757
Validation loss decreased (-0.647389 --> -0.757217).  Saving model ...
Epoch: 7 cost time: 1.8785512447357178
Epoch: 7, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.708 Vali Acc: 0.734 Test Loss: 0.708 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9648385047912598
Epoch: 8, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.757217 --> -0.843925).  Saving model ...
Epoch: 9 cost time: 1.9280145168304443
Epoch: 9, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.543 Vali Acc: 0.780 Test Loss: 0.543 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8758020401000977
Epoch: 10, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.503 Vali Acc: 0.821 Test Loss: 0.503 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.86151123046875
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.507 Vali Acc: 0.780 Test Loss: 0.507 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9113574028015137
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.489 Vali Acc: 0.798 Test Loss: 0.489 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9341256618499756
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.474 Vali Acc: 0.815 Test Loss: 0.474 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0146937370300293
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.437 Vali Acc: 0.809 Test Loss: 0.437 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0177221298217773
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.485 Vali Acc: 0.786 Test Loss: 0.485 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.050732135772705
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.448 Vali Acc: 0.809 Test Loss: 0.448 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9924118518829346
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0320990085601807
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.474 Vali Acc: 0.803 Test Loss: 0.474 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 813799
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.166417837142944
Epoch: 1, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.714 Vali Acc: 0.399 Test Loss: 1.714 Test Acc: 0.399
Validation loss decreased (inf --> -0.398827).  Saving model ...
Epoch: 2 cost time: 2.322965383529663
Epoch: 2, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.446 Vali Acc: 0.514 Test Loss: 1.446 Test Acc: 0.514
Validation loss decreased (-0.398827 --> -0.514436).  Saving model ...
Epoch: 3 cost time: 2.370213747024536
Epoch: 3, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.259 Vali Acc: 0.607 Test Loss: 1.259 Test Acc: 0.607
Validation loss decreased (-0.514436 --> -0.606924).  Saving model ...
Epoch: 4 cost time: 2.4437763690948486
Epoch: 4, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.129 Vali Acc: 0.601 Test Loss: 1.129 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3538308143615723
Epoch: 5, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.086 Vali Acc: 0.584 Test Loss: 1.086 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.354086399078369
Epoch: 6, Steps: 17 | Train Loss: 0.787 Vali Loss: 0.946 Vali Acc: 0.624 Test Loss: 0.946 Test Acc: 0.624
Validation loss decreased (-0.606924 --> -0.624268).  Saving model ...
Epoch: 7 cost time: 2.3882510662078857
Epoch: 7, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.763 Vali Acc: 0.757 Test Loss: 0.763 Test Acc: 0.757
Validation loss decreased (-0.624268 --> -0.757218).  Saving model ...
Epoch: 8 cost time: 2.3942010402679443
Epoch: 8, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.678 Vali Acc: 0.786 Test Loss: 0.678 Test Acc: 0.786
Validation loss decreased (-0.757218 --> -0.786120).  Saving model ...
Epoch: 9 cost time: 2.401888132095337
Epoch: 9, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.582 Vali Acc: 0.798 Test Loss: 0.582 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797682).  Saving model ...
Epoch: 10 cost time: 2.361753225326538
Epoch: 10, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.587 Vali Acc: 0.775 Test Loss: 0.587 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.412763833999634
Epoch: 11, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809243).  Saving model ...
Epoch: 12 cost time: 2.3363113403320312
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.511 Vali Acc: 0.827 Test Loss: 0.511 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826584).  Saving model ...
Epoch: 13 cost time: 2.3848438262939453
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.532 Vali Acc: 0.775 Test Loss: 0.532 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2189533710479736
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.543 Vali Acc: 0.780 Test Loss: 0.543 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3530020713806152
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.544 Vali Acc: 0.786 Test Loss: 0.544 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.217381715774536
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.798 Test Loss: 0.522 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1645936965942383
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1346869468688965
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.587 Vali Acc: 0.798 Test Loss: 0.587 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.192084312438965
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2138078212738037
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.561 Vali Acc: 0.803 Test Loss: 0.561 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.1988649368286133
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.1818313598632812
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.803 Test Loss: 0.595 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2468967
model size : 10.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.010856866836548
Epoch: 1, Steps: 17 | Train Loss: 1.949 Vali Loss: 1.793 Vali Acc: 0.329 Test Loss: 1.793 Test Acc: 0.329
Validation loss decreased (inf --> -0.329462).  Saving model ...
Epoch: 2 cost time: 1.6485161781311035
Epoch: 2, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.513 Vali Acc: 0.364 Test Loss: 1.513 Test Acc: 0.364
Validation loss decreased (-0.329462 --> -0.364147).  Saving model ...
Epoch: 3 cost time: 1.6159369945526123
Epoch: 3, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.252 Vali Acc: 0.618 Test Loss: 1.252 Test Acc: 0.618
Validation loss decreased (-0.364147 --> -0.618485).  Saving model ...
Epoch: 4 cost time: 1.6992108821868896
Epoch: 4, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.101 Vali Acc: 0.595 Test Loss: 1.101 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6898910999298096
Epoch: 5, Steps: 17 | Train Loss: 0.871 Vali Loss: 0.951 Vali Acc: 0.647 Test Loss: 0.951 Test Acc: 0.647
Validation loss decreased (-0.618485 --> -0.647389).  Saving model ...
Epoch: 6 cost time: 1.6250340938568115
Epoch: 6, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.816 Vali Acc: 0.757 Test Loss: 0.816 Test Acc: 0.757
Validation loss decreased (-0.647389 --> -0.757217).  Saving model ...
Epoch: 7 cost time: 1.5761439800262451
Epoch: 7, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.708 Vali Acc: 0.734 Test Loss: 0.708 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6317665576934814
Epoch: 8, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.757217 --> -0.843925).  Saving model ...
Epoch: 9 cost time: 1.629082441329956
Epoch: 9, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.543 Vali Acc: 0.780 Test Loss: 0.543 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.612462043762207
Epoch: 10, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.502 Vali Acc: 0.821 Test Loss: 0.502 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.567246437072754
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.508 Vali Acc: 0.780 Test Loss: 0.508 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6187763214111328
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.492 Vali Acc: 0.792 Test Loss: 0.492 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6014604568481445
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.472 Vali Acc: 0.815 Test Loss: 0.472 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.755854845046997
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.440 Vali Acc: 0.798 Test Loss: 0.440 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.679635763168335
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.480 Vali Acc: 0.786 Test Loss: 0.480 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6806459426879883
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.446 Vali Acc: 0.798 Test Loss: 0.446 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6138584613800049
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.464 Vali Acc: 0.803 Test Loss: 0.464 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6648530960083008
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.465 Vali Acc: 0.815 Test Loss: 0.465 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 813799
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.281545639038086
Epoch: 1, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.770 Vali Acc: 0.364 Test Loss: 1.770 Test Acc: 0.364
Validation loss decreased (inf --> -0.364144).  Saving model ...
Epoch: 2 cost time: 2.6714627742767334
Epoch: 2, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.481 Vali Acc: 0.474 Test Loss: 1.481 Test Acc: 0.474
Validation loss decreased (-0.364144 --> -0.473974).  Saving model ...
Epoch: 3 cost time: 2.5631120204925537
Epoch: 3, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.313 Vali Acc: 0.462 Test Loss: 1.313 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6305155754089355
Epoch: 4, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.139 Vali Acc: 0.607 Test Loss: 1.139 Test Acc: 0.607
Validation loss decreased (-0.473974 --> -0.606925).  Saving model ...
Epoch: 5 cost time: 2.626858711242676
Epoch: 5, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.034 Vali Acc: 0.665 Test Loss: 1.034 Test Acc: 0.665
Validation loss decreased (-0.606925 --> -0.664730).  Saving model ...
Epoch: 6 cost time: 2.6629598140716553
Epoch: 6, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.918 Vali Acc: 0.636 Test Loss: 0.918 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.515592336654663
Epoch: 7, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.751 Vali Acc: 0.757 Test Loss: 0.751 Test Acc: 0.757
Validation loss decreased (-0.664730 --> -0.757218).  Saving model ...
Epoch: 8 cost time: 2.9492313861846924
Epoch: 8, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.684 Vali Acc: 0.734 Test Loss: 0.684 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.954627752304077
Epoch: 9, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
Validation loss decreased (-0.757218 --> -0.809243).  Saving model ...
Epoch: 10 cost time: 2.864151954650879
Epoch: 10, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.661 Vali Acc: 0.775 Test Loss: 0.661 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.913203001022339
Epoch: 11, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.644 Vali Acc: 0.780 Test Loss: 0.644 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8521206378936768
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 13 cost time: 2.858471155166626
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.504 Vali Acc: 0.798 Test Loss: 0.504 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8765056133270264
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.542 Vali Acc: 0.815 Test Loss: 0.542 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 15 cost time: 2.8812644481658936
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.533 Vali Acc: 0.832 Test Loss: 0.533 Test Acc: 0.832
Validation loss decreased (-0.815023 --> -0.832365).  Saving model ...
Epoch: 16 cost time: 2.9327425956726074
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843926).  Saving model ...
Epoch: 17 cost time: 2.8719277381896973
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 18 cost time: 2.823075294494629
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8753113746643066
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.524 Vali Acc: 0.827 Test Loss: 0.524 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8904836177825928
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.821 Test Loss: 0.571 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.57641863822937
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.543 Vali Acc: 0.827 Test Loss: 0.543 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.9433624744415283
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.827 Test Loss: 0.556 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.9572551250457764
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.568 Vali Acc: 0.827 Test Loss: 0.568 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.983203887939453
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.560 Vali Acc: 0.827 Test Loss: 0.560 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.9203691482543945
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.838 Test Loss: 0.567 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.9692745208740234
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.838 Test Loss: 0.563 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.7601447105407715
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1297127
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5143139362335205
Epoch: 1, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.827 Vali Acc: 0.225 Test Loss: 1.827 Test Acc: 0.225
Validation loss decreased (inf --> -0.225415).  Saving model ...
Epoch: 2 cost time: 1.886470079421997
Epoch: 2, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.547 Vali Acc: 0.399 Test Loss: 1.547 Test Acc: 0.399
Validation loss decreased (-0.225415 --> -0.398828).  Saving model ...
Epoch: 3 cost time: 1.9015045166015625
Epoch: 3, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.330 Vali Acc: 0.486 Test Loss: 1.330 Test Acc: 0.486
Validation loss decreased (-0.398828 --> -0.485536).  Saving model ...
Epoch: 4 cost time: 1.8995716571807861
Epoch: 4, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.154 Vali Acc: 0.590 Test Loss: 1.154 Test Acc: 0.590
Validation loss decreased (-0.485536 --> -0.589584).  Saving model ...
Epoch: 5 cost time: 2.055598020553589
Epoch: 5, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.049 Vali Acc: 0.613 Test Loss: 1.049 Test Acc: 0.613
Validation loss decreased (-0.589584 --> -0.612706).  Saving model ...
Epoch: 6 cost time: 2.1210010051727295
Epoch: 6, Steps: 17 | Train Loss: 0.745 Vali Loss: 0.887 Vali Acc: 0.723 Test Loss: 0.887 Test Acc: 0.723
Validation loss decreased (-0.612706 --> -0.722534).  Saving model ...
Epoch: 7 cost time: 2.035186290740967
Epoch: 7, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.780 Vali Acc: 0.717 Test Loss: 0.780 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.023803472518921
Epoch: 8, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.719 Vali Acc: 0.803 Test Loss: 0.719 Test Acc: 0.803
Validation loss decreased (-0.722534 --> -0.803461).  Saving model ...
Epoch: 9 cost time: 2.054776906967163
Epoch: 9, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.638 Vali Acc: 0.728 Test Loss: 0.638 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.073184013366699
Epoch: 10, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.578 Vali Acc: 0.798 Test Loss: 0.578 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.137347459793091
Epoch: 11, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.615 Vali Acc: 0.734 Test Loss: 0.615 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0583789348602295
Epoch: 12, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.520 Vali Acc: 0.792 Test Loss: 0.520 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0044403076171875
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.551 Vali Acc: 0.769 Test Loss: 0.551 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0513672828674316
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.611 Vali Acc: 0.746 Test Loss: 0.611 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.070974111557007
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.592 Vali Acc: 0.775 Test Loss: 0.592 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.062617778778076
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.592 Vali Acc: 0.763 Test Loss: 0.592 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0542407035827637
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.599 Vali Acc: 0.775 Test Loss: 0.599 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.042006015777588
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.619 Vali Acc: 0.769 Test Loss: 0.619 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 469479
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.2648890018463135
Epoch: 1, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.770 Vali Acc: 0.364 Test Loss: 1.770 Test Acc: 0.364
Validation loss decreased (inf --> -0.364144).  Saving model ...
Epoch: 2 cost time: 2.6113126277923584
Epoch: 2, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.481 Vali Acc: 0.474 Test Loss: 1.481 Test Acc: 0.474
Validation loss decreased (-0.364144 --> -0.473974).  Saving model ...
Epoch: 3 cost time: 2.5255379676818848
Epoch: 3, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.313 Vali Acc: 0.462 Test Loss: 1.313 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5979971885681152
Epoch: 4, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.139 Vali Acc: 0.607 Test Loss: 1.139 Test Acc: 0.607
Validation loss decreased (-0.473974 --> -0.606925).  Saving model ...
Epoch: 5 cost time: 2.567526340484619
Epoch: 5, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.034 Vali Acc: 0.665 Test Loss: 1.034 Test Acc: 0.665
Validation loss decreased (-0.606925 --> -0.664730).  Saving model ...
Epoch: 6 cost time: 2.6433634757995605
Epoch: 6, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.918 Vali Acc: 0.636 Test Loss: 0.918 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.38370943069458
Epoch: 7, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.751 Vali Acc: 0.757 Test Loss: 0.751 Test Acc: 0.757
Validation loss decreased (-0.664730 --> -0.757218).  Saving model ...
Epoch: 8 cost time: 2.3734588623046875
Epoch: 8, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.684 Vali Acc: 0.734 Test Loss: 0.684 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.305309534072876
Epoch: 9, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
Validation loss decreased (-0.757218 --> -0.809243).  Saving model ...
Epoch: 10 cost time: 2.3048136234283447
Epoch: 10, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.661 Vali Acc: 0.775 Test Loss: 0.661 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.313166379928589
Epoch: 11, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.644 Vali Acc: 0.780 Test Loss: 0.644 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.372662305831909
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 13 cost time: 2.3841028213500977
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.504 Vali Acc: 0.798 Test Loss: 0.504 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.386260986328125
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.542 Vali Acc: 0.815 Test Loss: 0.542 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 15 cost time: 2.4611704349517822
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.533 Vali Acc: 0.832 Test Loss: 0.533 Test Acc: 0.832
Validation loss decreased (-0.815023 --> -0.832365).  Saving model ...
Epoch: 16 cost time: 2.4294793605804443
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843926).  Saving model ...
Epoch: 17 cost time: 2.543715000152588
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 18 cost time: 2.524526357650757
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5868515968322754
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.524 Vali Acc: 0.827 Test Loss: 0.524 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.590498447418213
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.821 Test Loss: 0.571 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.580822467803955
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.543 Vali Acc: 0.827 Test Loss: 0.543 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5629734992980957
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.827 Test Loss: 0.556 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5002880096435547
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.827 Test Loss: 0.567 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.552394390106201
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.560 Vali Acc: 0.827 Test Loss: 0.560 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.6272072792053223
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.838 Test Loss: 0.567 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.461662769317627
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.838 Test Loss: 0.563 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.4845993518829346
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1297127
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.4711837768554688
Epoch: 1, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.827 Vali Acc: 0.225 Test Loss: 1.827 Test Acc: 0.225
Validation loss decreased (inf --> -0.225415).  Saving model ...
Epoch: 2 cost time: 1.8413851261138916
Epoch: 2, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.547 Vali Acc: 0.399 Test Loss: 1.547 Test Acc: 0.399
Validation loss decreased (-0.225415 --> -0.398828).  Saving model ...
Epoch: 3 cost time: 1.900252103805542
Epoch: 3, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.330 Vali Acc: 0.486 Test Loss: 1.330 Test Acc: 0.486
Validation loss decreased (-0.398828 --> -0.485536).  Saving model ...
Epoch: 4 cost time: 1.8511500358581543
Epoch: 4, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.154 Vali Acc: 0.590 Test Loss: 1.154 Test Acc: 0.590
Validation loss decreased (-0.485536 --> -0.589584).  Saving model ...
Epoch: 5 cost time: 1.836146593093872
Epoch: 5, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.049 Vali Acc: 0.613 Test Loss: 1.049 Test Acc: 0.613
Validation loss decreased (-0.589584 --> -0.612706).  Saving model ...
Epoch: 6 cost time: 1.5976855754852295
Epoch: 6, Steps: 17 | Train Loss: 0.745 Vali Loss: 0.887 Vali Acc: 0.723 Test Loss: 0.887 Test Acc: 0.723
Validation loss decreased (-0.612706 --> -0.722534).  Saving model ...
Epoch: 7 cost time: 1.7087318897247314
Epoch: 7, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.780 Vali Acc: 0.717 Test Loss: 0.780 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6942214965820312
Epoch: 8, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.719 Vali Acc: 0.803 Test Loss: 0.719 Test Acc: 0.803
Validation loss decreased (-0.722534 --> -0.803461).  Saving model ...
Epoch: 9 cost time: 1.6632781028747559
Epoch: 9, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.638 Vali Acc: 0.728 Test Loss: 0.638 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6654555797576904
Epoch: 10, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.578 Vali Acc: 0.798 Test Loss: 0.578 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7279605865478516
Epoch: 11, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.615 Vali Acc: 0.734 Test Loss: 0.615 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6911277770996094
Epoch: 12, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.520 Vali Acc: 0.792 Test Loss: 0.520 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6862962245941162
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.551 Vali Acc: 0.769 Test Loss: 0.551 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6475446224212646
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.611 Vali Acc: 0.746 Test Loss: 0.611 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6709799766540527
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.592 Vali Acc: 0.775 Test Loss: 0.592 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7404937744140625
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.592 Vali Acc: 0.763 Test Loss: 0.592 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8864760398864746
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.598 Vali Acc: 0.775 Test Loss: 0.598 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.886338472366333
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.769 Test Loss: 0.618 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 469479
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.198979377746582
Epoch: 1, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.770 Vali Acc: 0.364 Test Loss: 1.770 Test Acc: 0.364
Validation loss decreased (inf --> -0.364144).  Saving model ...
Epoch: 2 cost time: 1.876481294631958
Epoch: 2, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.481 Vali Acc: 0.474 Test Loss: 1.481 Test Acc: 0.474
Validation loss decreased (-0.364144 --> -0.473974).  Saving model ...
Epoch: 3 cost time: 1.8413958549499512
Epoch: 3, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.313 Vali Acc: 0.462 Test Loss: 1.313 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8499939441680908
Epoch: 4, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.139 Vali Acc: 0.607 Test Loss: 1.139 Test Acc: 0.607
Validation loss decreased (-0.473974 --> -0.606925).  Saving model ...
Epoch: 5 cost time: 1.9039523601531982
Epoch: 5, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.034 Vali Acc: 0.665 Test Loss: 1.034 Test Acc: 0.665
Validation loss decreased (-0.606925 --> -0.664730).  Saving model ...
Epoch: 6 cost time: 1.8715391159057617
Epoch: 6, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.918 Vali Acc: 0.636 Test Loss: 0.918 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.931044340133667
Epoch: 7, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.751 Vali Acc: 0.757 Test Loss: 0.751 Test Acc: 0.757
Validation loss decreased (-0.664730 --> -0.757218).  Saving model ...
Epoch: 8 cost time: 1.8451662063598633
Epoch: 8, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.684 Vali Acc: 0.734 Test Loss: 0.684 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.871690034866333
Epoch: 9, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
Validation loss decreased (-0.757218 --> -0.809243).  Saving model ...
Epoch: 10 cost time: 1.859297275543213
Epoch: 10, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.661 Vali Acc: 0.775 Test Loss: 0.661 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8689165115356445
Epoch: 11, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.644 Vali Acc: 0.780 Test Loss: 0.644 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.907498836517334
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 13 cost time: 1.867337942123413
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.504 Vali Acc: 0.798 Test Loss: 0.504 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8336491584777832
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.542 Vali Acc: 0.815 Test Loss: 0.542 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 15 cost time: 1.9738664627075195
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.533 Vali Acc: 0.832 Test Loss: 0.533 Test Acc: 0.832
Validation loss decreased (-0.815023 --> -0.832365).  Saving model ...
Epoch: 16 cost time: 1.886641263961792
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843926).  Saving model ...
Epoch: 17 cost time: 1.7320449352264404
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 18 cost time: 1.7980225086212158
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8070480823516846
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.524 Vali Acc: 0.827 Test Loss: 0.524 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.748523473739624
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.821 Test Loss: 0.571 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6873595714569092
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.542 Vali Acc: 0.827 Test Loss: 0.542 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.798546552658081
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.827 Test Loss: 0.556 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7338926792144775
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.827 Test Loss: 0.567 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.834773063659668
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.827 Test Loss: 0.559 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8184013366699219
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.838 Test Loss: 0.567 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7736077308654785
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.838 Test Loss: 0.563 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9586598873138428
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1297127
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.183182954788208
Epoch: 1, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.827 Vali Acc: 0.225 Test Loss: 1.827 Test Acc: 0.225
Validation loss decreased (inf --> -0.225415).  Saving model ...
Epoch: 2 cost time: 1.8052165508270264
Epoch: 2, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.547 Vali Acc: 0.399 Test Loss: 1.547 Test Acc: 0.399
Validation loss decreased (-0.225415 --> -0.398828).  Saving model ...
Epoch: 3 cost time: 1.6073451042175293
Epoch: 3, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.330 Vali Acc: 0.486 Test Loss: 1.330 Test Acc: 0.486
Validation loss decreased (-0.398828 --> -0.485536).  Saving model ...
Epoch: 4 cost time: 1.5229222774505615
Epoch: 4, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.154 Vali Acc: 0.590 Test Loss: 1.154 Test Acc: 0.590
Validation loss decreased (-0.485536 --> -0.589584).  Saving model ...
Epoch: 5 cost time: 1.648926019668579
Epoch: 5, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.049 Vali Acc: 0.613 Test Loss: 1.049 Test Acc: 0.613
Validation loss decreased (-0.589584 --> -0.612706).  Saving model ...
Epoch: 6 cost time: 1.5900650024414062
Epoch: 6, Steps: 17 | Train Loss: 0.745 Vali Loss: 0.887 Vali Acc: 0.723 Test Loss: 0.887 Test Acc: 0.723
Validation loss decreased (-0.612706 --> -0.722534).  Saving model ...
Epoch: 7 cost time: 1.5543932914733887
Epoch: 7, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.780 Vali Acc: 0.717 Test Loss: 0.780 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5932986736297607
Epoch: 8, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.719 Vali Acc: 0.803 Test Loss: 0.719 Test Acc: 0.803
Validation loss decreased (-0.722534 --> -0.803461).  Saving model ...
Epoch: 9 cost time: 1.5547196865081787
Epoch: 9, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.638 Vali Acc: 0.728 Test Loss: 0.638 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6633164882659912
Epoch: 10, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.578 Vali Acc: 0.798 Test Loss: 0.578 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6100366115570068
Epoch: 11, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.615 Vali Acc: 0.734 Test Loss: 0.615 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5436294078826904
Epoch: 12, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.520 Vali Acc: 0.792 Test Loss: 0.520 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5141758918762207
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.551 Vali Acc: 0.769 Test Loss: 0.551 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5548264980316162
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.611 Vali Acc: 0.746 Test Loss: 0.611 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.547877550125122
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.592 Vali Acc: 0.775 Test Loss: 0.592 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5472967624664307
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.592 Vali Acc: 0.763 Test Loss: 0.592 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5343284606933594
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.595 Vali Acc: 0.780 Test Loss: 0.595 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.601921558380127
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.612 Vali Acc: 0.769 Test Loss: 0.612 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 469479
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.661618232727051
Epoch: 1, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.846 Vali Acc: 0.237 Test Loss: 1.846 Test Acc: 0.237
Validation loss decreased (inf --> -0.236976).  Saving model ...
Epoch: 2 cost time: 3.189713478088379
Epoch: 2, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.648 Vali Acc: 0.341 Test Loss: 1.648 Test Acc: 0.341
Validation loss decreased (-0.236976 --> -0.341024).  Saving model ...
Epoch: 3 cost time: 3.245509624481201
Epoch: 3, Steps: 17 | Train Loss: 1.544 Vali Loss: 1.444 Vali Acc: 0.497 Test Loss: 1.444 Test Acc: 0.497
Validation loss decreased (-0.341024 --> -0.497095).  Saving model ...
Epoch: 4 cost time: 3.180091381072998
Epoch: 4, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.270 Vali Acc: 0.613 Test Loss: 1.270 Test Acc: 0.613
Validation loss decreased (-0.497095 --> -0.612704).  Saving model ...
Epoch: 5 cost time: 3.206770658493042
Epoch: 5, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.119 Vali Acc: 0.728 Test Loss: 1.119 Test Acc: 0.728
Validation loss decreased (-0.612704 --> -0.728313).  Saving model ...
Epoch: 6 cost time: 3.245709180831909
Epoch: 6, Steps: 17 | Train Loss: 0.985 Vali Loss: 0.985 Vali Acc: 0.699 Test Loss: 0.985 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4559524059295654
Epoch: 7, Steps: 17 | Train Loss: 0.800 Vali Loss: 0.847 Vali Acc: 0.809 Test Loss: 0.847 Test Acc: 0.809
Validation loss decreased (-0.728313 --> -0.809240).  Saving model ...
Epoch: 8 cost time: 3.524200201034546
Epoch: 8, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.778 Vali Acc: 0.763 Test Loss: 0.778 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5138189792633057
Epoch: 9, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.4791362285614014
Epoch: 10, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.594 Vali Acc: 0.780 Test Loss: 0.594 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.526890516281128
Epoch: 11, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.572 Vali Acc: 0.786 Test Loss: 0.572 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.481318473815918
Epoch: 12, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.480 Vali Acc: 0.855 Test Loss: 0.480 Test Acc: 0.855
Validation loss decreased (-0.809240 --> -0.855487).  Saving model ...
Epoch: 13 cost time: 3.4322848320007324
Epoch: 13, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.484 Vali Acc: 0.832 Test Loss: 0.484 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5594887733459473
Epoch: 14, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.446 Vali Acc: 0.821 Test Loss: 0.446 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5056636333465576
Epoch: 15, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861267).  Saving model ...
Epoch: 16 cost time: 3.4205169677734375
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.426 Vali Acc: 0.850 Test Loss: 0.426 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.547006845474243
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.381 Vali Acc: 0.867 Test Loss: 0.381 Test Acc: 0.867
Validation loss decreased (-0.861267 --> -0.867048).  Saving model ...
Epoch: 18 cost time: 3.5707905292510986
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.478471517562866
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.397 Vali Acc: 0.844 Test Loss: 0.397 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6065194606781006
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.405 Vali Acc: 0.844 Test Loss: 0.405 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.5780351161956787
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.406 Vali Acc: 0.827 Test Loss: 0.406 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.4071896076202393
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.373 Vali Acc: 0.861 Test Loss: 0.373 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.484260082244873
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.398 Vali Acc: 0.879 Test Loss: 0.398 Test Acc: 0.879
Validation loss decreased (-0.867048 --> -0.878609).  Saving model ...
Epoch: 24 cost time: 3.097222089767456
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.403 Vali Acc: 0.838 Test Loss: 0.403 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1108531951904297
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.1444029808044434
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.407 Vali Acc: 0.844 Test Loss: 0.407 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.03326678276062
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.407 Vali Acc: 0.838 Test Loss: 0.407 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.123955488204956
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.394 Vali Acc: 0.873 Test Loss: 0.394 Test Acc: 0.873
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.175326347351074
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.412 Vali Acc: 0.832 Test Loss: 0.412 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.1575069427490234
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.410 Vali Acc: 0.844 Test Loss: 0.410 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 1234871
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.836358070373535
Epoch: 1, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.781 Vali Acc: 0.329 Test Loss: 1.781 Test Acc: 0.329
Validation loss decreased (inf --> -0.329462).  Saving model ...
Epoch: 2 cost time: 2.1382482051849365
Epoch: 2, Steps: 17 | Train Loss: 1.733 Vali Loss: 1.619 Vali Acc: 0.301 Test Loss: 1.619 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.155764102935791
Epoch: 3, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.435 Vali Acc: 0.457 Test Loss: 1.435 Test Acc: 0.457
Validation loss decreased (-0.329462 --> -0.456633).  Saving model ...
Epoch: 4 cost time: 2.0892107486724854
Epoch: 4, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.286 Vali Acc: 0.509 Test Loss: 1.286 Test Acc: 0.509
Validation loss decreased (-0.456633 --> -0.508658).  Saving model ...
Epoch: 5 cost time: 2.146151542663574
Epoch: 5, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.158 Vali Acc: 0.601 Test Loss: 1.158 Test Acc: 0.601
Validation loss decreased (-0.508658 --> -0.601144).  Saving model ...
Epoch: 6 cost time: 2.1860196590423584
Epoch: 6, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.080 Vali Acc: 0.613 Test Loss: 1.080 Test Acc: 0.613
Validation loss decreased (-0.601144 --> -0.612706).  Saving model ...
Epoch: 7 cost time: 2.091461420059204
Epoch: 7, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.965 Vali Acc: 0.676 Test Loss: 0.965 Test Acc: 0.676
Validation loss decreased (-0.612706 --> -0.676291).  Saving model ...
Epoch: 8 cost time: 2.1467063426971436
Epoch: 8, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.822 Vali Acc: 0.775 Test Loss: 0.822 Test Acc: 0.775
Validation loss decreased (-0.676291 --> -0.774558).  Saving model ...
Epoch: 9 cost time: 2.1376612186431885
Epoch: 9, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.763 Vali Acc: 0.751 Test Loss: 0.763 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1442222595214844
Epoch: 10, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.698 Vali Acc: 0.740 Test Loss: 0.698 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.235039234161377
Epoch: 11, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.695 Vali Acc: 0.763 Test Loss: 0.695 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1216330528259277
Epoch: 12, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.583 Vali Acc: 0.775 Test Loss: 0.583 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774561).  Saving model ...
Epoch: 13 cost time: 2.129441499710083
Epoch: 13, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.579 Vali Acc: 0.815 Test Loss: 0.579 Test Acc: 0.815
Validation loss decreased (-0.774561 --> -0.815023).  Saving model ...
Epoch: 14 cost time: 2.1329879760742188
Epoch: 14, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.596 Vali Acc: 0.757 Test Loss: 0.596 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.140350341796875
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.528 Vali Acc: 0.780 Test Loss: 0.528 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1845703125
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.546 Vali Acc: 0.780 Test Loss: 0.546 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1633431911468506
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.556 Vali Acc: 0.815 Test Loss: 0.556 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815023).  Saving model ...
Epoch: 18 cost time: 2.1548879146575928
Epoch: 18, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.587 Vali Acc: 0.798 Test Loss: 0.587 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9449868202209473
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.569 Vali Acc: 0.792 Test Loss: 0.569 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9604296684265137
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.608 Vali Acc: 0.780 Test Loss: 0.608 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.983173131942749
Epoch: 21, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.615 Vali Acc: 0.798 Test Loss: 0.615 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.023110866546631
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.616 Vali Acc: 0.780 Test Loss: 0.616 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9700345993041992
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.637 Vali Acc: 0.786 Test Loss: 0.637 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.00838565826416
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9751935005187988
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.617 Vali Acc: 0.809 Test Loss: 0.617 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.035604476928711
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.610 Vali Acc: 0.821 Test Loss: 0.610 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820803).  Saving model ...
Epoch: 27 cost time: 2.004037380218506
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9134337902069092
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.665 Vali Acc: 0.809 Test Loss: 0.665 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7349803447723389
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.1491518020629883
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.660 Vali Acc: 0.821 Test Loss: 0.660 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 407159
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.652169227600098
Epoch: 1, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.846 Vali Acc: 0.237 Test Loss: 1.846 Test Acc: 0.237
Validation loss decreased (inf --> -0.236976).  Saving model ...
Epoch: 2 cost time: 2.824558973312378
Epoch: 2, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.648 Vali Acc: 0.341 Test Loss: 1.648 Test Acc: 0.341
Validation loss decreased (-0.236976 --> -0.341024).  Saving model ...
Epoch: 3 cost time: 2.912116050720215
Epoch: 3, Steps: 17 | Train Loss: 1.544 Vali Loss: 1.444 Vali Acc: 0.497 Test Loss: 1.444 Test Acc: 0.497
Validation loss decreased (-0.341024 --> -0.497095).  Saving model ...
Epoch: 4 cost time: 2.9050509929656982
Epoch: 4, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.270 Vali Acc: 0.613 Test Loss: 1.270 Test Acc: 0.613
Validation loss decreased (-0.497095 --> -0.612704).  Saving model ...
Epoch: 5 cost time: 2.8993406295776367
Epoch: 5, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.119 Vali Acc: 0.728 Test Loss: 1.119 Test Acc: 0.728
Validation loss decreased (-0.612704 --> -0.728313).  Saving model ...
Epoch: 6 cost time: 2.877053737640381
Epoch: 6, Steps: 17 | Train Loss: 0.985 Vali Loss: 0.985 Vali Acc: 0.699 Test Loss: 0.985 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.857886791229248
Epoch: 7, Steps: 17 | Train Loss: 0.800 Vali Loss: 0.847 Vali Acc: 0.809 Test Loss: 0.847 Test Acc: 0.809
Validation loss decreased (-0.728313 --> -0.809240).  Saving model ...
Epoch: 8 cost time: 2.8980422019958496
Epoch: 8, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.778 Vali Acc: 0.763 Test Loss: 0.778 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.903913974761963
Epoch: 9, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8522539138793945
Epoch: 10, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.594 Vali Acc: 0.780 Test Loss: 0.594 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8845160007476807
Epoch: 11, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.572 Vali Acc: 0.786 Test Loss: 0.572 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8877007961273193
Epoch: 12, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.480 Vali Acc: 0.855 Test Loss: 0.480 Test Acc: 0.855
Validation loss decreased (-0.809240 --> -0.855487).  Saving model ...
Epoch: 13 cost time: 2.8322861194610596
Epoch: 13, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.484 Vali Acc: 0.832 Test Loss: 0.484 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.778740406036377
Epoch: 14, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.446 Vali Acc: 0.821 Test Loss: 0.446 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.649608612060547
Epoch: 15, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861267).  Saving model ...
Epoch: 16 cost time: 2.626063346862793
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.426 Vali Acc: 0.850 Test Loss: 0.426 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.649387836456299
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.381 Vali Acc: 0.867 Test Loss: 0.381 Test Acc: 0.867
Validation loss decreased (-0.861267 --> -0.867048).  Saving model ...
Epoch: 18 cost time: 2.704782724380493
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.579582929611206
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.397 Vali Acc: 0.844 Test Loss: 0.397 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.651625633239746
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.405 Vali Acc: 0.844 Test Loss: 0.405 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.644890785217285
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.406 Vali Acc: 0.827 Test Loss: 0.406 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.684985399246216
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.373 Vali Acc: 0.861 Test Loss: 0.373 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.8712687492370605
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.397 Vali Acc: 0.879 Test Loss: 0.397 Test Acc: 0.879
Validation loss decreased (-0.867048 --> -0.878609).  Saving model ...
Epoch: 24 cost time: 2.864753246307373
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.403 Vali Acc: 0.838 Test Loss: 0.403 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.876342296600342
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.8687219619750977
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.407 Vali Acc: 0.844 Test Loss: 0.407 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.8468828201293945
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.408 Vali Acc: 0.838 Test Loss: 0.408 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.8343169689178467
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.394 Vali Acc: 0.873 Test Loss: 0.394 Test Acc: 0.873
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.8541526794433594
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.413 Vali Acc: 0.832 Test Loss: 0.413 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.8572611808776855
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.410 Vali Acc: 0.844 Test Loss: 0.410 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 1234871
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7346746921539307
Epoch: 1, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.781 Vali Acc: 0.329 Test Loss: 1.781 Test Acc: 0.329
Validation loss decreased (inf --> -0.329462).  Saving model ...
Epoch: 2 cost time: 1.9395763874053955
Epoch: 2, Steps: 17 | Train Loss: 1.733 Vali Loss: 1.619 Vali Acc: 0.301 Test Loss: 1.619 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0607073307037354
Epoch: 3, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.435 Vali Acc: 0.457 Test Loss: 1.435 Test Acc: 0.457
Validation loss decreased (-0.329462 --> -0.456633).  Saving model ...
Epoch: 4 cost time: 1.8918859958648682
Epoch: 4, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.286 Vali Acc: 0.509 Test Loss: 1.286 Test Acc: 0.509
Validation loss decreased (-0.456633 --> -0.508658).  Saving model ...
Epoch: 5 cost time: 1.9552497863769531
Epoch: 5, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.158 Vali Acc: 0.601 Test Loss: 1.158 Test Acc: 0.601
Validation loss decreased (-0.508658 --> -0.601144).  Saving model ...
Epoch: 6 cost time: 1.9153432846069336
Epoch: 6, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.080 Vali Acc: 0.613 Test Loss: 1.080 Test Acc: 0.613
Validation loss decreased (-0.601144 --> -0.612706).  Saving model ...
Epoch: 7 cost time: 1.9576621055603027
Epoch: 7, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.965 Vali Acc: 0.676 Test Loss: 0.965 Test Acc: 0.676
Validation loss decreased (-0.612706 --> -0.676291).  Saving model ...
Epoch: 8 cost time: 1.912550449371338
Epoch: 8, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.822 Vali Acc: 0.775 Test Loss: 0.822 Test Acc: 0.775
Validation loss decreased (-0.676291 --> -0.774558).  Saving model ...
Epoch: 9 cost time: 1.9610447883605957
Epoch: 9, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.763 Vali Acc: 0.751 Test Loss: 0.763 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9698731899261475
Epoch: 10, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.698 Vali Acc: 0.740 Test Loss: 0.698 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8245792388916016
Epoch: 11, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.695 Vali Acc: 0.763 Test Loss: 0.695 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8117175102233887
Epoch: 12, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.583 Vali Acc: 0.775 Test Loss: 0.583 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774561).  Saving model ...
Epoch: 13 cost time: 1.847135305404663
Epoch: 13, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.579 Vali Acc: 0.815 Test Loss: 0.579 Test Acc: 0.815
Validation loss decreased (-0.774561 --> -0.815023).  Saving model ...
Epoch: 14 cost time: 1.8724453449249268
Epoch: 14, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.596 Vali Acc: 0.757 Test Loss: 0.596 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7764194011688232
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.527 Vali Acc: 0.780 Test Loss: 0.527 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.660569429397583
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.547 Vali Acc: 0.792 Test Loss: 0.547 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9084317684173584
Epoch: 17, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.541 Vali Acc: 0.815 Test Loss: 0.541 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815023).  Saving model ...
Epoch: 18 cost time: 1.7892603874206543
Epoch: 18, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.587 Vali Acc: 0.792 Test Loss: 0.587 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5285241603851318
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.560 Vali Acc: 0.786 Test Loss: 0.560 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.749631404876709
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.625 Vali Acc: 0.792 Test Loss: 0.625 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8170335292816162
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.606 Vali Acc: 0.792 Test Loss: 0.606 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9934630393981934
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.588 Vali Acc: 0.809 Test Loss: 0.588 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8682506084442139
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.671 Vali Acc: 0.780 Test Loss: 0.671 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8896703720092773
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.608 Vali Acc: 0.792 Test Loss: 0.608 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.827805757522583
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.657 Vali Acc: 0.803 Test Loss: 0.657 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9205763339996338
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.664 Vali Acc: 0.780 Test Loss: 0.664 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8718461990356445
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 407159
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8388614654541016
Epoch: 1, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.846 Vali Acc: 0.237 Test Loss: 1.846 Test Acc: 0.237
Validation loss decreased (inf --> -0.236976).  Saving model ...
Epoch: 2 cost time: 2.0379951000213623
Epoch: 2, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.648 Vali Acc: 0.341 Test Loss: 1.648 Test Acc: 0.341
Validation loss decreased (-0.236976 --> -0.341024).  Saving model ...
Epoch: 3 cost time: 2.0962462425231934
Epoch: 3, Steps: 17 | Train Loss: 1.544 Vali Loss: 1.444 Vali Acc: 0.497 Test Loss: 1.444 Test Acc: 0.497
Validation loss decreased (-0.341024 --> -0.497095).  Saving model ...
Epoch: 4 cost time: 2.045189142227173
Epoch: 4, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.270 Vali Acc: 0.613 Test Loss: 1.270 Test Acc: 0.613
Validation loss decreased (-0.497095 --> -0.612704).  Saving model ...
Epoch: 5 cost time: 2.1098995208740234
Epoch: 5, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.119 Vali Acc: 0.728 Test Loss: 1.119 Test Acc: 0.728
Validation loss decreased (-0.612704 --> -0.728313).  Saving model ...
Epoch: 6 cost time: 2.0664122104644775
Epoch: 6, Steps: 17 | Train Loss: 0.985 Vali Loss: 0.985 Vali Acc: 0.699 Test Loss: 0.985 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0528573989868164
Epoch: 7, Steps: 17 | Train Loss: 0.800 Vali Loss: 0.847 Vali Acc: 0.809 Test Loss: 0.847 Test Acc: 0.809
Validation loss decreased (-0.728313 --> -0.809240).  Saving model ...
Epoch: 8 cost time: 2.1005771160125732
Epoch: 8, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.778 Vali Acc: 0.763 Test Loss: 0.778 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0412492752075195
Epoch: 9, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.054356813430786
Epoch: 10, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.594 Vali Acc: 0.780 Test Loss: 0.594 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0682456493377686
Epoch: 11, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.572 Vali Acc: 0.786 Test Loss: 0.572 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.988100528717041
Epoch: 12, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
Validation loss decreased (-0.809240 --> -0.861267).  Saving model ...
Epoch: 13 cost time: 1.8996708393096924
Epoch: 13, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.910942792892456
Epoch: 14, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.430 Vali Acc: 0.844 Test Loss: 0.430 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9439468383789062
Epoch: 15, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.425 Vali Acc: 0.861 Test Loss: 0.425 Test Acc: 0.861
Validation loss decreased (-0.861267 --> -0.861267).  Saving model ...
Epoch: 16 cost time: 1.9735426902770996
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
Validation loss decreased (-0.861267 --> -0.861268).  Saving model ...
Epoch: 17 cost time: 1.9360830783843994
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.381 Vali Acc: 0.867 Test Loss: 0.381 Test Acc: 0.867
Validation loss decreased (-0.861268 --> -0.867048).  Saving model ...
Epoch: 18 cost time: 1.877842664718628
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9345676898956299
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9130816459655762
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.411 Vali Acc: 0.844 Test Loss: 0.411 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9399526119232178
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.409 Vali Acc: 0.832 Test Loss: 0.409 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7918851375579834
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.383 Vali Acc: 0.873 Test Loss: 0.383 Test Acc: 0.873
Validation loss decreased (-0.867048 --> -0.872829).  Saving model ...
Epoch: 23 cost time: 2.1124489307403564
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.400 Vali Acc: 0.867 Test Loss: 0.400 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.133322238922119
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.410 Vali Acc: 0.844 Test Loss: 0.410 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.103496789932251
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.408 Vali Acc: 0.861 Test Loss: 0.408 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.253174066543579
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.409 Vali Acc: 0.844 Test Loss: 0.409 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.262061357498169
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.418 Vali Acc: 0.838 Test Loss: 0.418 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0292327404022217
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.405 Vali Acc: 0.867 Test Loss: 0.405 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.11198353767395
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.0722198486328125
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.416 Vali Acc: 0.844 Test Loss: 0.416 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 1234871
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9207935333251953
Epoch: 1, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.781 Vali Acc: 0.329 Test Loss: 1.781 Test Acc: 0.329
Validation loss decreased (inf --> -0.329462).  Saving model ...
Epoch: 2 cost time: 1.5319983959197998
Epoch: 2, Steps: 17 | Train Loss: 1.733 Vali Loss: 1.619 Vali Acc: 0.301 Test Loss: 1.619 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5790393352508545
Epoch: 3, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.435 Vali Acc: 0.457 Test Loss: 1.435 Test Acc: 0.457
Validation loss decreased (-0.329462 --> -0.456633).  Saving model ...
Epoch: 4 cost time: 1.5840442180633545
Epoch: 4, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.286 Vali Acc: 0.509 Test Loss: 1.286 Test Acc: 0.509
Validation loss decreased (-0.456633 --> -0.508658).  Saving model ...
Epoch: 5 cost time: 1.6267337799072266
Epoch: 5, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.158 Vali Acc: 0.601 Test Loss: 1.158 Test Acc: 0.601
Validation loss decreased (-0.508658 --> -0.601144).  Saving model ...
Epoch: 6 cost time: 1.5400896072387695
Epoch: 6, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.080 Vali Acc: 0.613 Test Loss: 1.080 Test Acc: 0.613
Validation loss decreased (-0.601144 --> -0.612706).  Saving model ...
Epoch: 7 cost time: 1.600196361541748
Epoch: 7, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.965 Vali Acc: 0.676 Test Loss: 0.965 Test Acc: 0.676
Validation loss decreased (-0.612706 --> -0.676291).  Saving model ...
Epoch: 8 cost time: 1.595238208770752
Epoch: 8, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.822 Vali Acc: 0.775 Test Loss: 0.822 Test Acc: 0.775
Validation loss decreased (-0.676291 --> -0.774558).  Saving model ...
Epoch: 9 cost time: 1.565277099609375
Epoch: 9, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.763 Vali Acc: 0.751 Test Loss: 0.763 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5435481071472168
Epoch: 10, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.697 Vali Acc: 0.740 Test Loss: 0.697 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5430431365966797
Epoch: 11, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.695 Vali Acc: 0.763 Test Loss: 0.695 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5606746673583984
Epoch: 12, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.590 Vali Acc: 0.775 Test Loss: 0.590 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774561).  Saving model ...
Epoch: 13 cost time: 1.4933030605316162
Epoch: 13, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
Validation loss decreased (-0.774561 --> -0.809243).  Saving model ...
Epoch: 14 cost time: 1.4981014728546143
Epoch: 14, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.603 Vali Acc: 0.757 Test Loss: 0.603 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4590284824371338
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.529 Vali Acc: 0.780 Test Loss: 0.529 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5022428035736084
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.559 Vali Acc: 0.786 Test Loss: 0.559 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4723458290100098
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 18 cost time: 1.4474947452545166
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.611 Vali Acc: 0.763 Test Loss: 0.611 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4891371726989746
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.566 Vali Acc: 0.780 Test Loss: 0.566 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4725191593170166
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.596 Vali Acc: 0.769 Test Loss: 0.596 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4830403327941895
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.584 Vali Acc: 0.803 Test Loss: 0.584 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4386165142059326
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.606 Vali Acc: 0.798 Test Loss: 0.606 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.465944528579712
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.624 Vali Acc: 0.769 Test Loss: 0.624 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3093318939208984
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.614 Vali Acc: 0.769 Test Loss: 0.614 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.510594129562378
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.615 Vali Acc: 0.798 Test Loss: 0.615 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4656078815460205
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.641 Vali Acc: 0.786 Test Loss: 0.641 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5016698837280273
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.626 Vali Acc: 0.780 Test Loss: 0.626 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 407159
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.174747705459595
Epoch: 1, Steps: 17 | Train Loss: 1.970 Vali Loss: 1.886 Vali Acc: 0.145 Test Loss: 1.886 Test Acc: 0.145
Validation loss decreased (inf --> -0.144490).  Saving model ...
Epoch: 2 cost time: 2.574702501296997
Epoch: 2, Steps: 17 | Train Loss: 1.787 Vali Loss: 1.698 Vali Acc: 0.347 Test Loss: 1.698 Test Acc: 0.347
Validation loss decreased (-0.144490 --> -0.346804).  Saving model ...
Epoch: 3 cost time: 2.631256341934204
Epoch: 3, Steps: 17 | Train Loss: 1.546 Vali Loss: 1.511 Vali Acc: 0.387 Test Loss: 1.511 Test Acc: 0.387
Validation loss decreased (-0.346804 --> -0.387268).  Saving model ...
Epoch: 4 cost time: 2.6732208728790283
Epoch: 4, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.324 Vali Acc: 0.561 Test Loss: 1.324 Test Acc: 0.561
Validation loss decreased (-0.387268 --> -0.560680).  Saving model ...
Epoch: 5 cost time: 2.567885160446167
Epoch: 5, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.214 Vali Acc: 0.543 Test Loss: 1.214 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5396728515625
Epoch: 6, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.070 Vali Acc: 0.659 Test Loss: 1.070 Test Acc: 0.659
Validation loss decreased (-0.560680 --> -0.658949).  Saving model ...
Epoch: 7 cost time: 2.586528778076172
Epoch: 7, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.938 Vali Acc: 0.676 Test Loss: 0.938 Test Acc: 0.676
Validation loss decreased (-0.658949 --> -0.676291).  Saving model ...
Epoch: 8 cost time: 2.6488118171691895
Epoch: 8, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.851 Vali Acc: 0.728 Test Loss: 0.851 Test Acc: 0.728
Validation loss decreased (-0.676291 --> -0.728315).  Saving model ...
Epoch: 9 cost time: 2.5271999835968018
Epoch: 9, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.782 Vali Acc: 0.740 Test Loss: 0.782 Test Acc: 0.740
Validation loss decreased (-0.728315 --> -0.739877).  Saving model ...
Epoch: 10 cost time: 2.460594654083252
Epoch: 10, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.756 Vali Acc: 0.740 Test Loss: 0.756 Test Acc: 0.740
Validation loss decreased (-0.739877 --> -0.739877).  Saving model ...
Epoch: 11 cost time: 2.4729888439178467
Epoch: 11, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.695 Vali Acc: 0.746 Test Loss: 0.695 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745658).  Saving model ...
Epoch: 12 cost time: 2.389455795288086
Epoch: 12, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.632 Vali Acc: 0.786 Test Loss: 0.632 Test Acc: 0.786
Validation loss decreased (-0.745658 --> -0.786121).  Saving model ...
Epoch: 13 cost time: 2.420135736465454
Epoch: 13, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.542 Vali Acc: 0.821 Test Loss: 0.542 Test Acc: 0.821
Validation loss decreased (-0.786121 --> -0.820804).  Saving model ...
Epoch: 14 cost time: 2.3752918243408203
Epoch: 14, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.651 Vali Acc: 0.757 Test Loss: 0.651 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5683112144470215
Epoch: 15, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.595 Vali Acc: 0.792 Test Loss: 0.595 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.619358539581299
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.598 Vali Acc: 0.798 Test Loss: 0.598 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.674316644668579
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.612 Vali Acc: 0.809 Test Loss: 0.612 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6129705905914307
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.574 Vali Acc: 0.786 Test Loss: 0.574 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.5865318775177
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.606 Vali Acc: 0.786 Test Loss: 0.606 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.597810745239258
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.612 Vali Acc: 0.792 Test Loss: 0.612 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.575476884841919
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.636 Vali Acc: 0.786 Test Loss: 0.636 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.6029138565063477
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.620 Vali Acc: 0.815 Test Loss: 0.620 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.655351161956787
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.872 Vali Acc: 0.746 Test Loss: 0.872 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 648759
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.191791296005249
Epoch: 1, Steps: 17 | Train Loss: 1.974 Vali Loss: 1.876 Vali Acc: 0.225 Test Loss: 1.876 Test Acc: 0.225
Validation loss decreased (inf --> -0.225415).  Saving model ...
Epoch: 2 cost time: 1.8578526973724365
Epoch: 2, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.730 Vali Acc: 0.341 Test Loss: 1.730 Test Acc: 0.341
Validation loss decreased (-0.225415 --> -0.341023).  Saving model ...
Epoch: 3 cost time: 1.7893671989440918
Epoch: 3, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.535 Vali Acc: 0.457 Test Loss: 1.535 Test Acc: 0.457
Validation loss decreased (-0.341023 --> -0.456632).  Saving model ...
Epoch: 4 cost time: 1.809152364730835
Epoch: 4, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.358 Vali Acc: 0.480 Test Loss: 1.358 Test Acc: 0.480
Validation loss decreased (-0.456632 --> -0.479755).  Saving model ...
Epoch: 5 cost time: 1.7959928512573242
Epoch: 5, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.226 Vali Acc: 0.526 Test Loss: 1.226 Test Acc: 0.526
Validation loss decreased (-0.479755 --> -0.525999).  Saving model ...
Epoch: 6 cost time: 1.8312349319458008
Epoch: 6, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.101 Vali Acc: 0.572 Test Loss: 1.101 Test Acc: 0.572
Validation loss decreased (-0.525999 --> -0.572243).  Saving model ...
Epoch: 7 cost time: 1.8222107887268066
Epoch: 7, Steps: 17 | Train Loss: 0.842 Vali Loss: 0.981 Vali Acc: 0.676 Test Loss: 0.981 Test Acc: 0.676
Validation loss decreased (-0.572243 --> -0.676291).  Saving model ...
Epoch: 8 cost time: 1.8341622352600098
Epoch: 8, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.882 Vali Acc: 0.746 Test Loss: 0.882 Test Acc: 0.746
Validation loss decreased (-0.676291 --> -0.745656).  Saving model ...
Epoch: 9 cost time: 1.8292834758758545
Epoch: 9, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.805 Vali Acc: 0.746 Test Loss: 0.805 Test Acc: 0.746
Validation loss decreased (-0.745656 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 1.7816407680511475
Epoch: 10, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.742 Vali Acc: 0.740 Test Loss: 0.742 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.807797908782959
Epoch: 11, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.691 Vali Acc: 0.757 Test Loss: 0.691 Test Acc: 0.757
Validation loss decreased (-0.745657 --> -0.757219).  Saving model ...
Epoch: 12 cost time: 1.6654117107391357
Epoch: 12, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.678 Vali Acc: 0.775 Test Loss: 0.678 Test Acc: 0.775
Validation loss decreased (-0.757219 --> -0.774560).  Saving model ...
Epoch: 13 cost time: 1.8329722881317139
Epoch: 13, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.676 Vali Acc: 0.751 Test Loss: 0.676 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7564375400543213
Epoch: 14, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.618 Vali Acc: 0.751 Test Loss: 0.618 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.997441053390503
Epoch: 15, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.610 Vali Acc: 0.740 Test Loss: 0.610 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6767668724060059
Epoch: 16, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.529 Vali Acc: 0.792 Test Loss: 0.529 Test Acc: 0.792
Validation loss decreased (-0.774560 --> -0.791902).  Saving model ...
Epoch: 17 cost time: 1.6685280799865723
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.579 Vali Acc: 0.780 Test Loss: 0.579 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7892684936523438
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.547 Vali Acc: 0.792 Test Loss: 0.547 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8251047134399414
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5184359550476074
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.560 Vali Acc: 0.780 Test Loss: 0.560 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7813026905059814
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.594 Vali Acc: 0.757 Test Loss: 0.594 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7949774265289307
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.568 Vali Acc: 0.780 Test Loss: 0.568 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.802924394607544
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.628 Vali Acc: 0.780 Test Loss: 0.628 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7387945652008057
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803462).  Saving model ...
Epoch: 25 cost time: 1.811722993850708
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.606 Vali Acc: 0.775 Test Loss: 0.606 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.796076774597168
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.612 Vali Acc: 0.775 Test Loss: 0.612 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.823190689086914
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.601 Vali Acc: 0.786 Test Loss: 0.601 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6920108795166016
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.609 Vali Acc: 0.786 Test Loss: 0.609 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6714529991149902
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809243).  Saving model ...
Epoch: 30 cost time: 1.6969923973083496
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 234871
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7494242191314697
Epoch: 1, Steps: 17 | Train Loss: 1.970 Vali Loss: 1.886 Vali Acc: 0.145 Test Loss: 1.886 Test Acc: 0.145
Validation loss decreased (inf --> -0.144490).  Saving model ...
Epoch: 2 cost time: 2.1014862060546875
Epoch: 2, Steps: 17 | Train Loss: 1.787 Vali Loss: 1.698 Vali Acc: 0.347 Test Loss: 1.698 Test Acc: 0.347
Validation loss decreased (-0.144490 --> -0.346804).  Saving model ...
Epoch: 3 cost time: 2.111792802810669
Epoch: 3, Steps: 17 | Train Loss: 1.546 Vali Loss: 1.511 Vali Acc: 0.387 Test Loss: 1.511 Test Acc: 0.387
Validation loss decreased (-0.346804 --> -0.387268).  Saving model ...
Epoch: 4 cost time: 2.269596576690674
Epoch: 4, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.324 Vali Acc: 0.561 Test Loss: 1.324 Test Acc: 0.561
Validation loss decreased (-0.387268 --> -0.560680).  Saving model ...
Epoch: 5 cost time: 1.5148496627807617
Epoch: 5, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.214 Vali Acc: 0.543 Test Loss: 1.214 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2849268913269043
Epoch: 6, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.070 Vali Acc: 0.659 Test Loss: 1.070 Test Acc: 0.659
Validation loss decreased (-0.560680 --> -0.658949).  Saving model ...
Epoch: 7 cost time: 2.0569911003112793
Epoch: 7, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.938 Vali Acc: 0.676 Test Loss: 0.938 Test Acc: 0.676
Validation loss decreased (-0.658949 --> -0.676291).  Saving model ...
Epoch: 8 cost time: 2.062227725982666
Epoch: 8, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.851 Vali Acc: 0.728 Test Loss: 0.851 Test Acc: 0.728
Validation loss decreased (-0.676291 --> -0.728315).  Saving model ...
Epoch: 9 cost time: 2.0432486534118652
Epoch: 9, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.782 Vali Acc: 0.740 Test Loss: 0.782 Test Acc: 0.740
Validation loss decreased (-0.728315 --> -0.739877).  Saving model ...
Epoch: 10 cost time: 2.083784580230713
Epoch: 10, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.756 Vali Acc: 0.740 Test Loss: 0.756 Test Acc: 0.740
Validation loss decreased (-0.739877 --> -0.739877).  Saving model ...
Epoch: 11 cost time: 2.0277435779571533
Epoch: 11, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.695 Vali Acc: 0.746 Test Loss: 0.695 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745658).  Saving model ...
Epoch: 12 cost time: 2.01009202003479
Epoch: 12, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.632 Vali Acc: 0.786 Test Loss: 0.632 Test Acc: 0.786
Validation loss decreased (-0.745658 --> -0.786121).  Saving model ...
Epoch: 13 cost time: 2.2058329582214355
Epoch: 13, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.542 Vali Acc: 0.821 Test Loss: 0.542 Test Acc: 0.821
Validation loss decreased (-0.786121 --> -0.820804).  Saving model ...
Epoch: 14 cost time: 2.238656520843506
Epoch: 14, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.651 Vali Acc: 0.757 Test Loss: 0.651 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.244333505630493
Epoch: 15, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.595 Vali Acc: 0.792 Test Loss: 0.595 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2107536792755127
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.597 Vali Acc: 0.798 Test Loss: 0.597 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2001163959503174
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.607 Vali Acc: 0.798 Test Loss: 0.607 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.235490560531616
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.586 Vali Acc: 0.786 Test Loss: 0.586 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2250657081604004
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.598 Vali Acc: 0.786 Test Loss: 0.598 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2582900524139404
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.611 Vali Acc: 0.786 Test Loss: 0.611 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.2457520961761475
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.641 Vali Acc: 0.780 Test Loss: 0.641 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.241809844970703
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0935146808624268
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.837 Vali Acc: 0.740 Test Loss: 0.837 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 648759
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.2473723888397217
Epoch: 1, Steps: 17 | Train Loss: 1.974 Vali Loss: 1.876 Vali Acc: 0.225 Test Loss: 1.876 Test Acc: 0.225
Validation loss decreased (inf --> -0.225415).  Saving model ...
Epoch: 2 cost time: 1.7068769931793213
Epoch: 2, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.730 Vali Acc: 0.341 Test Loss: 1.730 Test Acc: 0.341
Validation loss decreased (-0.225415 --> -0.341023).  Saving model ...
Epoch: 3 cost time: 1.685391902923584
Epoch: 3, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.535 Vali Acc: 0.457 Test Loss: 1.535 Test Acc: 0.457
Validation loss decreased (-0.341023 --> -0.456632).  Saving model ...
Epoch: 4 cost time: 1.6727371215820312
Epoch: 4, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.358 Vali Acc: 0.480 Test Loss: 1.358 Test Acc: 0.480
Validation loss decreased (-0.456632 --> -0.479755).  Saving model ...
Epoch: 5 cost time: 1.7023754119873047
Epoch: 5, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.226 Vali Acc: 0.526 Test Loss: 1.226 Test Acc: 0.526
Validation loss decreased (-0.479755 --> -0.525999).  Saving model ...
Epoch: 6 cost time: 1.744415044784546
Epoch: 6, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.101 Vali Acc: 0.572 Test Loss: 1.101 Test Acc: 0.572
Validation loss decreased (-0.525999 --> -0.572243).  Saving model ...
Epoch: 7 cost time: 1.7194056510925293
Epoch: 7, Steps: 17 | Train Loss: 0.842 Vali Loss: 0.981 Vali Acc: 0.676 Test Loss: 0.981 Test Acc: 0.676
Validation loss decreased (-0.572243 --> -0.676291).  Saving model ...
Epoch: 8 cost time: 1.691054105758667
Epoch: 8, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.882 Vali Acc: 0.746 Test Loss: 0.882 Test Acc: 0.746
Validation loss decreased (-0.676291 --> -0.745656).  Saving model ...
Epoch: 9 cost time: 1.704766035079956
Epoch: 9, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.805 Vali Acc: 0.746 Test Loss: 0.805 Test Acc: 0.746
Validation loss decreased (-0.745656 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 1.7159755229949951
Epoch: 10, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.742 Vali Acc: 0.740 Test Loss: 0.742 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7657456398010254
Epoch: 11, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.691 Vali Acc: 0.757 Test Loss: 0.691 Test Acc: 0.757
Validation loss decreased (-0.745657 --> -0.757219).  Saving model ...
Epoch: 12 cost time: 1.6286394596099854
Epoch: 12, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.678 Vali Acc: 0.775 Test Loss: 0.678 Test Acc: 0.775
Validation loss decreased (-0.757219 --> -0.774560).  Saving model ...
Epoch: 13 cost time: 1.6156032085418701
Epoch: 13, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.675 Vali Acc: 0.751 Test Loss: 0.675 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.630368947982788
Epoch: 14, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.618 Vali Acc: 0.751 Test Loss: 0.618 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6049776077270508
Epoch: 15, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.610 Vali Acc: 0.740 Test Loss: 0.610 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5736887454986572
Epoch: 16, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.529 Vali Acc: 0.792 Test Loss: 0.529 Test Acc: 0.792
Validation loss decreased (-0.774560 --> -0.791902).  Saving model ...
Epoch: 17 cost time: 1.5873847007751465
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.579 Vali Acc: 0.780 Test Loss: 0.579 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6519391536712646
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.546 Vali Acc: 0.792 Test Loss: 0.546 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6628665924072266
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.577 Vali Acc: 0.763 Test Loss: 0.577 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7578153610229492
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.558 Vali Acc: 0.780 Test Loss: 0.558 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7449378967285156
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.757 Test Loss: 0.596 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7020411491394043
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.570 Vali Acc: 0.780 Test Loss: 0.570 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7519440650939941
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.630 Vali Acc: 0.780 Test Loss: 0.630 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7790768146514893
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.581 Vali Acc: 0.803 Test Loss: 0.581 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803462).  Saving model ...
Epoch: 25 cost time: 1.7409420013427734
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.607 Vali Acc: 0.775 Test Loss: 0.607 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6895184516906738
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.613 Vali Acc: 0.775 Test Loss: 0.613 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7089650630950928
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.599 Vali Acc: 0.780 Test Loss: 0.599 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7145540714263916
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.606 Vali Acc: 0.780 Test Loss: 0.606 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6013307571411133
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.536 Vali Acc: 0.798 Test Loss: 0.536 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7098891735076904
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.720 Vali Acc: 0.769 Test Loss: 0.720 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 234871
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.0889370441436768
Epoch: 1, Steps: 17 | Train Loss: 1.970 Vali Loss: 1.886 Vali Acc: 0.145 Test Loss: 1.886 Test Acc: 0.145
Validation loss decreased (inf --> -0.144490).  Saving model ...
Epoch: 2 cost time: 1.5917084217071533
Epoch: 2, Steps: 17 | Train Loss: 1.787 Vali Loss: 1.698 Vali Acc: 0.347 Test Loss: 1.698 Test Acc: 0.347
Validation loss decreased (-0.144490 --> -0.346804).  Saving model ...
Epoch: 3 cost time: 1.6405296325683594
Epoch: 3, Steps: 17 | Train Loss: 1.546 Vali Loss: 1.511 Vali Acc: 0.387 Test Loss: 1.511 Test Acc: 0.387
Validation loss decreased (-0.346804 --> -0.387268).  Saving model ...
Epoch: 4 cost time: 1.6092960834503174
Epoch: 4, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.324 Vali Acc: 0.561 Test Loss: 1.324 Test Acc: 0.561
Validation loss decreased (-0.387268 --> -0.560680).  Saving model ...
Epoch: 5 cost time: 1.575671911239624
Epoch: 5, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.214 Vali Acc: 0.543 Test Loss: 1.214 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6181600093841553
Epoch: 6, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.070 Vali Acc: 0.659 Test Loss: 1.070 Test Acc: 0.659
Validation loss decreased (-0.560680 --> -0.658949).  Saving model ...
Epoch: 7 cost time: 1.6698789596557617
Epoch: 7, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.939 Vali Acc: 0.676 Test Loss: 0.939 Test Acc: 0.676
Validation loss decreased (-0.658949 --> -0.676291).  Saving model ...
Epoch: 8 cost time: 1.636185884475708
Epoch: 8, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.851 Vali Acc: 0.728 Test Loss: 0.851 Test Acc: 0.728
Validation loss decreased (-0.676291 --> -0.728315).  Saving model ...
Epoch: 9 cost time: 1.6027781963348389
Epoch: 9, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.784 Vali Acc: 0.740 Test Loss: 0.784 Test Acc: 0.740
Validation loss decreased (-0.728315 --> -0.739877).  Saving model ...
Epoch: 10 cost time: 1.5932610034942627
Epoch: 10, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.759 Vali Acc: 0.740 Test Loss: 0.759 Test Acc: 0.740
Validation loss decreased (-0.739877 --> -0.739877).  Saving model ...
Epoch: 11 cost time: 1.500594139099121
Epoch: 11, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.704 Vali Acc: 0.746 Test Loss: 0.704 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745658).  Saving model ...
Epoch: 12 cost time: 1.4744417667388916
Epoch: 12, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.654 Vali Acc: 0.780 Test Loss: 0.654 Test Acc: 0.780
Validation loss decreased (-0.745658 --> -0.780340).  Saving model ...
Epoch: 13 cost time: 1.5328986644744873
Epoch: 13, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.547 Vali Acc: 0.798 Test Loss: 0.547 Test Acc: 0.798
Validation loss decreased (-0.780340 --> -0.797682).  Saving model ...
Epoch: 14 cost time: 1.4128649234771729
Epoch: 14, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.629 Vali Acc: 0.769 Test Loss: 0.629 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.490896463394165
Epoch: 15, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.575 Vali Acc: 0.821 Test Loss: 0.575 Test Acc: 0.821
Validation loss decreased (-0.797682 --> -0.820803).  Saving model ...
Epoch: 16 cost time: 1.5276670455932617
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.571 Vali Acc: 0.815 Test Loss: 0.571 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6456480026245117
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.611 Vali Acc: 0.792 Test Loss: 0.611 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.58628511428833
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.612 Vali Acc: 0.792 Test Loss: 0.612 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6667230129241943
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.605 Vali Acc: 0.798 Test Loss: 0.605 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6228759288787842
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.604 Vali Acc: 0.780 Test Loss: 0.604 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5994312763214111
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.626 Vali Acc: 0.803 Test Loss: 0.626 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5671982765197754
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.636 Vali Acc: 0.815 Test Loss: 0.636 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6064491271972656
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.659 Vali Acc: 0.775 Test Loss: 0.659 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5842037200927734
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.640 Vali Acc: 0.792 Test Loss: 0.640 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5824840068817139
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.639 Vali Acc: 0.827 Test Loss: 0.639 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826583).  Saving model ...
Epoch: 26 cost time: 1.6604430675506592
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.632 Vali Acc: 0.809 Test Loss: 0.632 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5633745193481445
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.699 Vali Acc: 0.803 Test Loss: 0.699 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5257492065429688
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.672 Vali Acc: 0.786 Test Loss: 0.672 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.49342679977417
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.679 Vali Acc: 0.792 Test Loss: 0.679 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4931271076202393
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.687 Vali Acc: 0.792 Test Loss: 0.687 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 648759
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.135490894317627
Epoch: 1, Steps: 17 | Train Loss: 1.974 Vali Loss: 1.876 Vali Acc: 0.225 Test Loss: 1.876 Test Acc: 0.225
Validation loss decreased (inf --> -0.225415).  Saving model ...
Epoch: 2 cost time: 1.3299856185913086
Epoch: 2, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.730 Vali Acc: 0.341 Test Loss: 1.730 Test Acc: 0.341
Validation loss decreased (-0.225415 --> -0.341023).  Saving model ...
Epoch: 3 cost time: 1.3866636753082275
Epoch: 3, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.535 Vali Acc: 0.457 Test Loss: 1.535 Test Acc: 0.457
Validation loss decreased (-0.341023 --> -0.456632).  Saving model ...
Epoch: 4 cost time: 1.3712608814239502
Epoch: 4, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.358 Vali Acc: 0.480 Test Loss: 1.358 Test Acc: 0.480
Validation loss decreased (-0.456632 --> -0.479755).  Saving model ...
Epoch: 5 cost time: 1.3957068920135498
Epoch: 5, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.226 Vali Acc: 0.526 Test Loss: 1.226 Test Acc: 0.526
Validation loss decreased (-0.479755 --> -0.525999).  Saving model ...
Epoch: 6 cost time: 1.3325896263122559
Epoch: 6, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.101 Vali Acc: 0.572 Test Loss: 1.101 Test Acc: 0.572
Validation loss decreased (-0.525999 --> -0.572243).  Saving model ...
Epoch: 7 cost time: 1.377983570098877
Epoch: 7, Steps: 17 | Train Loss: 0.842 Vali Loss: 0.981 Vali Acc: 0.676 Test Loss: 0.981 Test Acc: 0.676
Validation loss decreased (-0.572243 --> -0.676291).  Saving model ...
Epoch: 8 cost time: 1.3780288696289062
Epoch: 8, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.882 Vali Acc: 0.746 Test Loss: 0.882 Test Acc: 0.746
Validation loss decreased (-0.676291 --> -0.745656).  Saving model ...
Epoch: 9 cost time: 1.357891321182251
Epoch: 9, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.805 Vali Acc: 0.746 Test Loss: 0.805 Test Acc: 0.746
Validation loss decreased (-0.745656 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 1.0746521949768066
Epoch: 10, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.743 Vali Acc: 0.740 Test Loss: 0.743 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3503451347351074
Epoch: 11, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.692 Vali Acc: 0.757 Test Loss: 0.692 Test Acc: 0.757
Validation loss decreased (-0.745657 --> -0.757219).  Saving model ...
Epoch: 12 cost time: 1.2628333568572998
Epoch: 12, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.679 Vali Acc: 0.780 Test Loss: 0.679 Test Acc: 0.780
Validation loss decreased (-0.757219 --> -0.780340).  Saving model ...
Epoch: 13 cost time: 1.243748426437378
Epoch: 13, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.675 Vali Acc: 0.751 Test Loss: 0.675 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.25225830078125
Epoch: 14, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.614 Vali Acc: 0.763 Test Loss: 0.614 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3102185726165771
Epoch: 15, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.608 Vali Acc: 0.751 Test Loss: 0.608 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.305788516998291
Epoch: 16, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.543 Vali Acc: 0.780 Test Loss: 0.543 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780341).  Saving model ...
Epoch: 17 cost time: 1.4231159687042236
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.576 Vali Acc: 0.786 Test Loss: 0.576 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 18 cost time: 1.340993881225586
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.543 Vali Acc: 0.798 Test Loss: 0.543 Test Acc: 0.798
Validation loss decreased (-0.786121 --> -0.797682).  Saving model ...
Epoch: 19 cost time: 1.48124098777771
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.590 Vali Acc: 0.775 Test Loss: 0.590 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3962781429290771
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.570 Vali Acc: 0.780 Test Loss: 0.570 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4445528984069824
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.604 Vali Acc: 0.775 Test Loss: 0.604 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4892282485961914
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.602 Vali Acc: 0.775 Test Loss: 0.602 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4260964393615723
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.590 Vali Acc: 0.769 Test Loss: 0.590 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3706672191619873
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.612 Vali Acc: 0.786 Test Loss: 0.612 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3933672904968262
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.586 Vali Acc: 0.769 Test Loss: 0.586 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.370666742324829
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.613 Vali Acc: 0.775 Test Loss: 0.613 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4701895713806152
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.597 Vali Acc: 0.803 Test Loss: 0.597 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803462).  Saving model ...
Epoch: 28 cost time: 1.423436164855957
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.615 Vali Acc: 0.775 Test Loss: 0.615 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4512615203857422
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.632 Vali Acc: 0.775 Test Loss: 0.632 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.300269603729248
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.616 Vali Acc: 0.775 Test Loss: 0.616 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 234871
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.9559903144836426
Epoch: 1, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.833 Vali Acc: 0.254 Test Loss: 1.833 Test Acc: 0.254
Validation loss decreased (inf --> -0.254317).  Saving model ...
Epoch: 2 cost time: 2.318561315536499
Epoch: 2, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.654 Vali Acc: 0.335 Test Loss: 1.654 Test Acc: 0.335
Validation loss decreased (-0.254317 --> -0.335244).  Saving model ...
Epoch: 3 cost time: 2.329472064971924
Epoch: 3, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.458 Vali Acc: 0.503 Test Loss: 1.458 Test Acc: 0.503
Validation loss decreased (-0.335244 --> -0.502876).  Saving model ...
Epoch: 4 cost time: 2.386776924133301
Epoch: 4, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.304 Vali Acc: 0.561 Test Loss: 1.304 Test Acc: 0.561
Validation loss decreased (-0.502876 --> -0.560681).  Saving model ...
Epoch: 5 cost time: 2.3284952640533447
Epoch: 5, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.184 Vali Acc: 0.584 Test Loss: 1.184 Test Acc: 0.584
Validation loss decreased (-0.560681 --> -0.583803).  Saving model ...
Epoch: 6 cost time: 2.392667770385742
Epoch: 6, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.104 Vali Acc: 0.607 Test Loss: 1.104 Test Acc: 0.607
Validation loss decreased (-0.583803 --> -0.606925).  Saving model ...
Epoch: 7 cost time: 2.356931686401367
Epoch: 7, Steps: 17 | Train Loss: 0.904 Vali Loss: 0.972 Vali Acc: 0.723 Test Loss: 0.972 Test Acc: 0.723
Validation loss decreased (-0.606925 --> -0.722534).  Saving model ...
Epoch: 8 cost time: 2.318239450454712
Epoch: 8, Steps: 17 | Train Loss: 0.752 Vali Loss: 0.862 Vali Acc: 0.723 Test Loss: 0.862 Test Acc: 0.723
Validation loss decreased (-0.722534 --> -0.722535).  Saving model ...
Epoch: 9 cost time: 2.3179707527160645
Epoch: 9, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.739 Vali Acc: 0.827 Test Loss: 0.739 Test Acc: 0.827
Validation loss decreased (-0.722535 --> -0.826582).  Saving model ...
Epoch: 10 cost time: 2.276963472366333
Epoch: 10, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.660 Vali Acc: 0.780 Test Loss: 0.660 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.257498025894165
Epoch: 11, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.678 Vali Acc: 0.780 Test Loss: 0.678 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2062370777130127
Epoch: 12, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.627 Vali Acc: 0.786 Test Loss: 0.627 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.232001781463623
Epoch: 13, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.542 Vali Acc: 0.786 Test Loss: 0.542 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1621248722076416
Epoch: 14, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.480 Vali Acc: 0.827 Test Loss: 0.480 Test Acc: 0.827
Validation loss decreased (-0.826582 --> -0.826585).  Saving model ...
Epoch: 15 cost time: 2.140850782394409
Epoch: 15, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.453 Vali Acc: 0.855 Test Loss: 0.453 Test Acc: 0.855
Validation loss decreased (-0.826585 --> -0.855487).  Saving model ...
Epoch: 16 cost time: 2.317516565322876
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.437 Vali Acc: 0.838 Test Loss: 0.437 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.299856185913086
Epoch: 17, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3792853355407715
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.465 Vali Acc: 0.844 Test Loss: 0.465 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3585920333862305
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.442 Vali Acc: 0.867 Test Loss: 0.442 Test Acc: 0.867
Validation loss decreased (-0.855487 --> -0.867048).  Saving model ...
Epoch: 20 cost time: 2.3704025745391846
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.464 Vali Acc: 0.827 Test Loss: 0.464 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.253024101257324
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2927474975585938
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.456 Vali Acc: 0.832 Test Loss: 0.456 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3631434440612793
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.474 Vali Acc: 0.832 Test Loss: 0.474 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3571555614471436
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.460 Vali Acc: 0.827 Test Loss: 0.460 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.3275368213653564
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.444 Vali Acc: 0.832 Test Loss: 0.444 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.177732467651367
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.494 Vali Acc: 0.815 Test Loss: 0.494 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1925761699676514
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.461 Vali Acc: 0.832 Test Loss: 0.461 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.123373031616211
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.569 Vali Acc: 0.821 Test Loss: 0.569 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1759307384490967
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.532 Vali Acc: 0.827 Test Loss: 0.532 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 355703
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3251614570617676
Epoch: 1, Steps: 17 | Train Loss: 1.934 Vali Loss: 1.872 Vali Acc: 0.243 Test Loss: 1.872 Test Acc: 0.243
Validation loss decreased (inf --> -0.242756).  Saving model ...
Epoch: 2 cost time: 1.7570040225982666
Epoch: 2, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.686 Vali Acc: 0.277 Test Loss: 1.686 Test Acc: 0.277
Validation loss decreased (-0.242756 --> -0.277440).  Saving model ...
Epoch: 3 cost time: 1.801893949508667
Epoch: 3, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.490 Vali Acc: 0.457 Test Loss: 1.490 Test Acc: 0.457
Validation loss decreased (-0.277440 --> -0.456632).  Saving model ...
Epoch: 4 cost time: 1.7962746620178223
Epoch: 4, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.332 Vali Acc: 0.520 Test Loss: 1.332 Test Acc: 0.520
Validation loss decreased (-0.456632 --> -0.520218).  Saving model ...
Epoch: 5 cost time: 1.807286024093628
Epoch: 5, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.170 Vali Acc: 0.618 Test Loss: 1.170 Test Acc: 0.618
Validation loss decreased (-0.520218 --> -0.618485).  Saving model ...
Epoch: 6 cost time: 1.7908496856689453
Epoch: 6, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.055 Vali Acc: 0.699 Test Loss: 1.055 Test Acc: 0.699
Validation loss decreased (-0.618485 --> -0.699411).  Saving model ...
Epoch: 7 cost time: 1.8121047019958496
Epoch: 7, Steps: 17 | Train Loss: 0.847 Vali Loss: 0.960 Vali Acc: 0.699 Test Loss: 0.960 Test Acc: 0.699
Validation loss decreased (-0.699411 --> -0.699412).  Saving model ...
Epoch: 8 cost time: 1.7146549224853516
Epoch: 8, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.813 Vali Acc: 0.769 Test Loss: 0.813 Test Acc: 0.769
Validation loss decreased (-0.699412 --> -0.768778).  Saving model ...
Epoch: 9 cost time: 1.7166898250579834
Epoch: 9, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.716 Vali Acc: 0.815 Test Loss: 0.716 Test Acc: 0.815
Validation loss decreased (-0.768778 --> -0.815022).  Saving model ...
Epoch: 10 cost time: 1.6507635116577148
Epoch: 10, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.698 Vali Acc: 0.734 Test Loss: 0.698 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6713745594024658
Epoch: 11, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.628 Vali Acc: 0.815 Test Loss: 0.628 Test Acc: 0.815
Validation loss decreased (-0.815022 --> -0.815023).  Saving model ...
Epoch: 12 cost time: 1.6614468097686768
Epoch: 12, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.606 Vali Acc: 0.780 Test Loss: 0.606 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6515192985534668
Epoch: 13, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8839006423950195
Epoch: 14, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.472 Vali Acc: 0.821 Test Loss: 0.472 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820805).  Saving model ...
Epoch: 15 cost time: 1.791260004043579
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.498 Vali Acc: 0.821 Test Loss: 0.498 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7674827575683594
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.497 Vali Acc: 0.827 Test Loss: 0.497 Test Acc: 0.827
Validation loss decreased (-0.820805 --> -0.826585).  Saving model ...
Epoch: 17 cost time: 1.8477048873901367
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.485 Vali Acc: 0.855 Test Loss: 0.485 Test Acc: 0.855
Validation loss decreased (-0.826585 --> -0.855486).  Saving model ...
Epoch: 18 cost time: 1.7529182434082031
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.484 Vali Acc: 0.821 Test Loss: 0.484 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8205511569976807
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.476 Vali Acc: 0.803 Test Loss: 0.476 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7879221439361572
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.461 Vali Acc: 0.832 Test Loss: 0.461 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7142918109893799
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.439 Vali Acc: 0.832 Test Loss: 0.439 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9076809883117676
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.495 Vali Acc: 0.815 Test Loss: 0.495 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.842963695526123
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.488 Vali Acc: 0.821 Test Loss: 0.488 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6197168827056885
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.485 Vali Acc: 0.827 Test Loss: 0.485 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6833291053771973
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.583580493927002
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.474 Vali Acc: 0.827 Test Loss: 0.474 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6527910232543945
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.519 Vali Acc: 0.821 Test Loss: 0.519 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 148727
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.4763290882110596
Epoch: 1, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.833 Vali Acc: 0.254 Test Loss: 1.833 Test Acc: 0.254
Validation loss decreased (inf --> -0.254317).  Saving model ...
Epoch: 2 cost time: 1.9773995876312256
Epoch: 2, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.654 Vali Acc: 0.335 Test Loss: 1.654 Test Acc: 0.335
Validation loss decreased (-0.254317 --> -0.335244).  Saving model ...
Epoch: 3 cost time: 1.9635801315307617
Epoch: 3, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.458 Vali Acc: 0.503 Test Loss: 1.458 Test Acc: 0.503
Validation loss decreased (-0.335244 --> -0.502876).  Saving model ...
Epoch: 4 cost time: 1.9337117671966553
Epoch: 4, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.304 Vali Acc: 0.561 Test Loss: 1.304 Test Acc: 0.561
Validation loss decreased (-0.502876 --> -0.560681).  Saving model ...
Epoch: 5 cost time: 1.8909335136413574
Epoch: 5, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.184 Vali Acc: 0.584 Test Loss: 1.184 Test Acc: 0.584
Validation loss decreased (-0.560681 --> -0.583803).  Saving model ...
Epoch: 6 cost time: 1.9840779304504395
Epoch: 6, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.104 Vali Acc: 0.607 Test Loss: 1.104 Test Acc: 0.607
Validation loss decreased (-0.583803 --> -0.606925).  Saving model ...
Epoch: 7 cost time: 1.9721779823303223
Epoch: 7, Steps: 17 | Train Loss: 0.904 Vali Loss: 0.972 Vali Acc: 0.723 Test Loss: 0.972 Test Acc: 0.723
Validation loss decreased (-0.606925 --> -0.722534).  Saving model ...
Epoch: 8 cost time: 1.834054946899414
Epoch: 8, Steps: 17 | Train Loss: 0.752 Vali Loss: 0.862 Vali Acc: 0.723 Test Loss: 0.862 Test Acc: 0.723
Validation loss decreased (-0.722534 --> -0.722535).  Saving model ...
Epoch: 9 cost time: 1.7971162796020508
Epoch: 9, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.739 Vali Acc: 0.827 Test Loss: 0.739 Test Acc: 0.827
Validation loss decreased (-0.722535 --> -0.826582).  Saving model ...
Epoch: 10 cost time: 1.7799971103668213
Epoch: 10, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.660 Vali Acc: 0.780 Test Loss: 0.660 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.883901834487915
Epoch: 11, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.678 Vali Acc: 0.780 Test Loss: 0.678 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9169235229492188
Epoch: 12, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.627 Vali Acc: 0.786 Test Loss: 0.627 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.802743673324585
Epoch: 13, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.542 Vali Acc: 0.786 Test Loss: 0.542 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0889995098114014
Epoch: 14, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.480 Vali Acc: 0.827 Test Loss: 0.480 Test Acc: 0.827
Validation loss decreased (-0.826582 --> -0.826585).  Saving model ...
Epoch: 15 cost time: 1.9923627376556396
Epoch: 15, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.453 Vali Acc: 0.855 Test Loss: 0.453 Test Acc: 0.855
Validation loss decreased (-0.826585 --> -0.855487).  Saving model ...
Epoch: 16 cost time: 1.9518651962280273
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.437 Vali Acc: 0.838 Test Loss: 0.437 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0135340690612793
Epoch: 17, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.008476972579956
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.465 Vali Acc: 0.844 Test Loss: 0.465 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9783201217651367
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.442 Vali Acc: 0.867 Test Loss: 0.442 Test Acc: 0.867
Validation loss decreased (-0.855487 --> -0.867048).  Saving model ...
Epoch: 20 cost time: 2.0069515705108643
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.462 Vali Acc: 0.827 Test Loss: 0.462 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9522147178649902
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0809755325317383
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.455 Vali Acc: 0.832 Test Loss: 0.455 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.014798402786255
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.475 Vali Acc: 0.832 Test Loss: 0.475 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8559608459472656
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.461 Vali Acc: 0.827 Test Loss: 0.461 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9584858417510986
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.444 Vali Acc: 0.832 Test Loss: 0.444 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8153836727142334
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.494 Vali Acc: 0.815 Test Loss: 0.494 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8386540412902832
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.461 Vali Acc: 0.832 Test Loss: 0.461 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.837897539138794
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.569 Vali Acc: 0.821 Test Loss: 0.569 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.870612382888794
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.532 Vali Acc: 0.827 Test Loss: 0.532 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 355703
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.227219343185425
Epoch: 1, Steps: 17 | Train Loss: 1.934 Vali Loss: 1.872 Vali Acc: 0.243 Test Loss: 1.872 Test Acc: 0.243
Validation loss decreased (inf --> -0.242756).  Saving model ...
Epoch: 2 cost time: 1.6089670658111572
Epoch: 2, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.686 Vali Acc: 0.277 Test Loss: 1.686 Test Acc: 0.277
Validation loss decreased (-0.242756 --> -0.277440).  Saving model ...
Epoch: 3 cost time: 1.6328418254852295
Epoch: 3, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.490 Vali Acc: 0.457 Test Loss: 1.490 Test Acc: 0.457
Validation loss decreased (-0.277440 --> -0.456632).  Saving model ...
Epoch: 4 cost time: 1.6915366649627686
Epoch: 4, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.332 Vali Acc: 0.520 Test Loss: 1.332 Test Acc: 0.520
Validation loss decreased (-0.456632 --> -0.520218).  Saving model ...
Epoch: 5 cost time: 1.6072719097137451
Epoch: 5, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.170 Vali Acc: 0.618 Test Loss: 1.170 Test Acc: 0.618
Validation loss decreased (-0.520218 --> -0.618485).  Saving model ...
Epoch: 6 cost time: 1.6380743980407715
Epoch: 6, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.055 Vali Acc: 0.699 Test Loss: 1.055 Test Acc: 0.699
Validation loss decreased (-0.618485 --> -0.699411).  Saving model ...
Epoch: 7 cost time: 1.530322790145874
Epoch: 7, Steps: 17 | Train Loss: 0.847 Vali Loss: 0.960 Vali Acc: 0.699 Test Loss: 0.960 Test Acc: 0.699
Validation loss decreased (-0.699411 --> -0.699412).  Saving model ...
Epoch: 8 cost time: 1.483680009841919
Epoch: 8, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.813 Vali Acc: 0.769 Test Loss: 0.813 Test Acc: 0.769
Validation loss decreased (-0.699412 --> -0.768778).  Saving model ...
Epoch: 9 cost time: 1.4500141143798828
Epoch: 9, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.716 Vali Acc: 0.815 Test Loss: 0.716 Test Acc: 0.815
Validation loss decreased (-0.768778 --> -0.815022).  Saving model ...
Epoch: 10 cost time: 1.5097966194152832
Epoch: 10, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.698 Vali Acc: 0.734 Test Loss: 0.698 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5500657558441162
Epoch: 11, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.628 Vali Acc: 0.815 Test Loss: 0.628 Test Acc: 0.815
Validation loss decreased (-0.815022 --> -0.815023).  Saving model ...
Epoch: 12 cost time: 1.5348138809204102
Epoch: 12, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.606 Vali Acc: 0.780 Test Loss: 0.606 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4992930889129639
Epoch: 13, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6336476802825928
Epoch: 14, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.472 Vali Acc: 0.821 Test Loss: 0.472 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820805).  Saving model ...
Epoch: 15 cost time: 1.6591911315917969
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.497 Vali Acc: 0.821 Test Loss: 0.497 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6117310523986816
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.497 Vali Acc: 0.827 Test Loss: 0.497 Test Acc: 0.827
Validation loss decreased (-0.820805 --> -0.826585).  Saving model ...
Epoch: 17 cost time: 1.561750888824463
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.485 Vali Acc: 0.855 Test Loss: 0.485 Test Acc: 0.855
Validation loss decreased (-0.826585 --> -0.855486).  Saving model ...
Epoch: 18 cost time: 1.6150188446044922
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.483 Vali Acc: 0.821 Test Loss: 0.483 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.640998125076294
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.473 Vali Acc: 0.803 Test Loss: 0.473 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6663243770599365
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.464 Vali Acc: 0.832 Test Loss: 0.464 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6284606456756592
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.445 Vali Acc: 0.838 Test Loss: 0.445 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.614084005355835
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.483 Vali Acc: 0.827 Test Loss: 0.483 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5994775295257568
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.476 Vali Acc: 0.821 Test Loss: 0.476 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5874745845794678
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.470 Vali Acc: 0.821 Test Loss: 0.470 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5227632522583008
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.479 Vali Acc: 0.827 Test Loss: 0.479 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4796960353851318
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.487 Vali Acc: 0.832 Test Loss: 0.487 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6034154891967773
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 148727
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.2118453979492188
Epoch: 1, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.833 Vali Acc: 0.254 Test Loss: 1.833 Test Acc: 0.254
Validation loss decreased (inf --> -0.254317).  Saving model ...
Epoch: 2 cost time: 1.6499452590942383
Epoch: 2, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.654 Vali Acc: 0.335 Test Loss: 1.654 Test Acc: 0.335
Validation loss decreased (-0.254317 --> -0.335244).  Saving model ...
Epoch: 3 cost time: 1.6449217796325684
Epoch: 3, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.458 Vali Acc: 0.503 Test Loss: 1.458 Test Acc: 0.503
Validation loss decreased (-0.335244 --> -0.502876).  Saving model ...
Epoch: 4 cost time: 1.624464511871338
Epoch: 4, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.304 Vali Acc: 0.561 Test Loss: 1.304 Test Acc: 0.561
Validation loss decreased (-0.502876 --> -0.560681).  Saving model ...
Epoch: 5 cost time: 1.6073968410491943
Epoch: 5, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.184 Vali Acc: 0.584 Test Loss: 1.184 Test Acc: 0.584
Validation loss decreased (-0.560681 --> -0.583803).  Saving model ...
Epoch: 6 cost time: 1.6399903297424316
Epoch: 6, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.104 Vali Acc: 0.607 Test Loss: 1.104 Test Acc: 0.607
Validation loss decreased (-0.583803 --> -0.606925).  Saving model ...
Epoch: 7 cost time: 1.6610114574432373
Epoch: 7, Steps: 17 | Train Loss: 0.904 Vali Loss: 0.972 Vali Acc: 0.723 Test Loss: 0.972 Test Acc: 0.723
Validation loss decreased (-0.606925 --> -0.722534).  Saving model ...
Epoch: 8 cost time: 1.6990776062011719
Epoch: 8, Steps: 17 | Train Loss: 0.752 Vali Loss: 0.862 Vali Acc: 0.723 Test Loss: 0.862 Test Acc: 0.723
Validation loss decreased (-0.722534 --> -0.722535).  Saving model ...
Epoch: 9 cost time: 1.6305739879608154
Epoch: 9, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.739 Vali Acc: 0.827 Test Loss: 0.739 Test Acc: 0.827
Validation loss decreased (-0.722535 --> -0.826582).  Saving model ...
Epoch: 10 cost time: 1.5083897113800049
Epoch: 10, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.660 Vali Acc: 0.780 Test Loss: 0.660 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4873249530792236
Epoch: 11, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.678 Vali Acc: 0.780 Test Loss: 0.678 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5251224040985107
Epoch: 12, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.627 Vali Acc: 0.786 Test Loss: 0.627 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5474810600280762
Epoch: 13, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.542 Vali Acc: 0.786 Test Loss: 0.542 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.483316421508789
Epoch: 14, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.480 Vali Acc: 0.827 Test Loss: 0.480 Test Acc: 0.827
Validation loss decreased (-0.826582 --> -0.826585).  Saving model ...
Epoch: 15 cost time: 1.5078017711639404
Epoch: 15, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.453 Vali Acc: 0.855 Test Loss: 0.453 Test Acc: 0.855
Validation loss decreased (-0.826585 --> -0.855487).  Saving model ...
Epoch: 16 cost time: 1.4533593654632568
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.437 Vali Acc: 0.838 Test Loss: 0.437 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6413183212280273
Epoch: 17, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5900886058807373
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5803918838500977
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.441 Vali Acc: 0.867 Test Loss: 0.441 Test Acc: 0.867
Validation loss decreased (-0.855487 --> -0.867048).  Saving model ...
Epoch: 20 cost time: 1.5833733081817627
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.441 Vali Acc: 0.821 Test Loss: 0.441 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6080496311187744
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.466 Vali Acc: 0.832 Test Loss: 0.466 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6061644554138184
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.459 Vali Acc: 0.815 Test Loss: 0.459 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.602325677871704
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.477 Vali Acc: 0.815 Test Loss: 0.477 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5627081394195557
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.468 Vali Acc: 0.821 Test Loss: 0.468 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.578355312347412
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.455 Vali Acc: 0.832 Test Loss: 0.455 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6468133926391602
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.496 Vali Acc: 0.827 Test Loss: 0.496 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4601736068725586
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.474 Vali Acc: 0.832 Test Loss: 0.474 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.556178331375122
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.520 Vali Acc: 0.821 Test Loss: 0.520 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5443205833435059
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.495 Vali Acc: 0.838 Test Loss: 0.495 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 355703
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9190518856048584
Epoch: 1, Steps: 17 | Train Loss: 1.934 Vali Loss: 1.872 Vali Acc: 0.243 Test Loss: 1.872 Test Acc: 0.243
Validation loss decreased (inf --> -0.242756).  Saving model ...
Epoch: 2 cost time: 1.392479658126831
Epoch: 2, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.686 Vali Acc: 0.277 Test Loss: 1.686 Test Acc: 0.277
Validation loss decreased (-0.242756 --> -0.277440).  Saving model ...
Epoch: 3 cost time: 1.4268388748168945
Epoch: 3, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.490 Vali Acc: 0.457 Test Loss: 1.490 Test Acc: 0.457
Validation loss decreased (-0.277440 --> -0.456632).  Saving model ...
Epoch: 4 cost time: 1.4083435535430908
Epoch: 4, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.332 Vali Acc: 0.520 Test Loss: 1.332 Test Acc: 0.520
Validation loss decreased (-0.456632 --> -0.520218).  Saving model ...
Epoch: 5 cost time: 1.3840665817260742
Epoch: 5, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.170 Vali Acc: 0.618 Test Loss: 1.170 Test Acc: 0.618
Validation loss decreased (-0.520218 --> -0.618485).  Saving model ...
Epoch: 6 cost time: 1.4190876483917236
Epoch: 6, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.055 Vali Acc: 0.699 Test Loss: 1.055 Test Acc: 0.699
Validation loss decreased (-0.618485 --> -0.699411).  Saving model ...
Epoch: 7 cost time: 1.3969695568084717
Epoch: 7, Steps: 17 | Train Loss: 0.847 Vali Loss: 0.960 Vali Acc: 0.699 Test Loss: 0.960 Test Acc: 0.699
Validation loss decreased (-0.699411 --> -0.699412).  Saving model ...
Epoch: 8 cost time: 1.3766756057739258
Epoch: 8, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.813 Vali Acc: 0.769 Test Loss: 0.813 Test Acc: 0.769
Validation loss decreased (-0.699412 --> -0.768778).  Saving model ...
Epoch: 9 cost time: 1.4947872161865234
Epoch: 9, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.716 Vali Acc: 0.815 Test Loss: 0.716 Test Acc: 0.815
Validation loss decreased (-0.768778 --> -0.815022).  Saving model ...
Epoch: 10 cost time: 1.363987922668457
Epoch: 10, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.698 Vali Acc: 0.734 Test Loss: 0.698 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3707141876220703
Epoch: 11, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.627 Vali Acc: 0.815 Test Loss: 0.627 Test Acc: 0.815
Validation loss decreased (-0.815022 --> -0.815023).  Saving model ...
Epoch: 12 cost time: 1.3035345077514648
Epoch: 12, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.603 Vali Acc: 0.780 Test Loss: 0.603 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3973197937011719
Epoch: 13, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.273371934890747
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.493 Vali Acc: 0.798 Test Loss: 0.493 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3863043785095215
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.495 Vali Acc: 0.821 Test Loss: 0.495 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820804).  Saving model ...
Epoch: 16 cost time: 1.4406323432922363
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.495 Vali Acc: 0.827 Test Loss: 0.495 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826585).  Saving model ...
Epoch: 17 cost time: 1.474060297012329
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
Validation loss decreased (-0.826585 --> -0.849706).  Saving model ...
Epoch: 18 cost time: 1.4606587886810303
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.488 Vali Acc: 0.821 Test Loss: 0.488 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5452427864074707
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.475 Vali Acc: 0.815 Test Loss: 0.475 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.43780517578125
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.468 Vali Acc: 0.832 Test Loss: 0.468 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.420494794845581
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.463 Vali Acc: 0.832 Test Loss: 0.463 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4004065990447998
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 23 cost time: 1.4409117698669434
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 24 cost time: 1.5187783241271973
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.465 Vali Acc: 0.832 Test Loss: 0.465 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3733603954315186
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.481 Vali Acc: 0.821 Test Loss: 0.481 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4024782180786133
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.466 Vali Acc: 0.844 Test Loss: 0.466 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4591729640960693
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3824329376220703
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.475 Vali Acc: 0.832 Test Loss: 0.475 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.365816593170166
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.426213264465332
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.500 Vali Acc: 0.832 Test Loss: 0.500 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 148727
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.599413871765137
Epoch: 1, Steps: 17 | Train Loss: 1.952 Vali Loss: 1.874 Vali Acc: 0.220 Test Loss: 1.874 Test Acc: 0.220
Validation loss decreased (inf --> -0.219634).  Saving model ...
Epoch: 2 cost time: 2.8766391277313232
Epoch: 2, Steps: 17 | Train Loss: 1.811 Vali Loss: 1.744 Vali Acc: 0.266 Test Loss: 1.744 Test Acc: 0.266
Validation loss decreased (-0.219634 --> -0.265879).  Saving model ...
Epoch: 3 cost time: 3.1013758182525635
Epoch: 3, Steps: 17 | Train Loss: 1.664 Vali Loss: 1.628 Vali Acc: 0.301 Test Loss: 1.628 Test Acc: 0.301
Validation loss decreased (-0.265879 --> -0.300562).  Saving model ...
Epoch: 4 cost time: 2.913252592086792
Epoch: 4, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.505 Vali Acc: 0.382 Test Loss: 1.505 Test Acc: 0.382
Validation loss decreased (-0.300562 --> -0.381488).  Saving model ...
Epoch: 5 cost time: 3.0341079235076904
Epoch: 5, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.369 Vali Acc: 0.497 Test Loss: 1.369 Test Acc: 0.497
Validation loss decreased (-0.381488 --> -0.497096).  Saving model ...
Epoch: 6 cost time: 3.0942118167877197
Epoch: 6, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.286 Vali Acc: 0.549 Test Loss: 1.286 Test Acc: 0.549
Validation loss decreased (-0.497096 --> -0.549120).  Saving model ...
Epoch: 7 cost time: 3.090843439102173
Epoch: 7, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.193 Vali Acc: 0.543 Test Loss: 1.193 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.764068365097046
Epoch: 8, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.077 Vali Acc: 0.584 Test Loss: 1.077 Test Acc: 0.584
Validation loss decreased (-0.549120 --> -0.583804).  Saving model ...
Epoch: 9 cost time: 2.751288414001465
Epoch: 9, Steps: 17 | Train Loss: 0.845 Vali Loss: 0.997 Vali Acc: 0.624 Test Loss: 0.997 Test Acc: 0.624
Validation loss decreased (-0.583804 --> -0.624267).  Saving model ...
Epoch: 10 cost time: 2.6156342029571533
Epoch: 10, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.919 Vali Acc: 0.659 Test Loss: 0.919 Test Acc: 0.659
Validation loss decreased (-0.624267 --> -0.658950).  Saving model ...
Epoch: 11 cost time: 2.6859216690063477
Epoch: 11, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.832 Vali Acc: 0.699 Test Loss: 0.832 Test Acc: 0.699
Validation loss decreased (-0.658950 --> -0.699414).  Saving model ...
Epoch: 12 cost time: 2.602750301361084
Epoch: 12, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.802 Vali Acc: 0.723 Test Loss: 0.802 Test Acc: 0.723
Validation loss decreased (-0.699414 --> -0.722535).  Saving model ...
Epoch: 13 cost time: 2.8907039165496826
Epoch: 13, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.760 Vali Acc: 0.728 Test Loss: 0.760 Test Acc: 0.728
Validation loss decreased (-0.722535 --> -0.728316).  Saving model ...
Epoch: 14 cost time: 2.8801283836364746
Epoch: 14, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.738 Vali Acc: 0.740 Test Loss: 0.738 Test Acc: 0.740
Validation loss decreased (-0.728316 --> -0.739877).  Saving model ...
Epoch: 15 cost time: 2.8839619159698486
Epoch: 15, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.728 Vali Acc: 0.728 Test Loss: 0.728 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.849123239517212
Epoch: 16, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.745 Vali Acc: 0.717 Test Loss: 0.745 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.859617233276367
Epoch: 17, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.668 Vali Acc: 0.740 Test Loss: 0.668 Test Acc: 0.740
Validation loss decreased (-0.739877 --> -0.739878).  Saving model ...
Epoch: 18 cost time: 2.9341635704040527
Epoch: 18, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.731 Vali Acc: 0.740 Test Loss: 0.731 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8514606952667236
Epoch: 19, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.770 Vali Acc: 0.717 Test Loss: 0.770 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8917176723480225
Epoch: 20, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.788 Vali Acc: 0.723 Test Loss: 0.788 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.8702609539031982
Epoch: 21, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.599 Vali Acc: 0.775 Test Loss: 0.599 Test Acc: 0.775
Validation loss decreased (-0.739878 --> -0.774560).  Saving model ...
Epoch: 22 cost time: 2.596961736679077
Epoch: 22, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.638 Vali Acc: 0.769 Test Loss: 0.638 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6354849338531494
Epoch: 23, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.560 Vali Acc: 0.803 Test Loss: 0.560 Test Acc: 0.803
Validation loss decreased (-0.774560 --> -0.803463).  Saving model ...
Epoch: 24 cost time: 2.580171823501587
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.603 Vali Acc: 0.827 Test Loss: 0.603 Test Acc: 0.827
Validation loss decreased (-0.803463 --> -0.826584).  Saving model ...
Epoch: 25 cost time: 2.693563461303711
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.641 Vali Acc: 0.786 Test Loss: 0.641 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6143248081207275
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.702 Vali Acc: 0.786 Test Loss: 0.702 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.7857720851898193
Epoch: 27, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.612 Vali Acc: 0.786 Test Loss: 0.612 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.8300514221191406
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.563 Vali Acc: 0.827 Test Loss: 0.563 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826584).  Saving model ...
Epoch: 29 cost time: 2.832550287246704
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.582 Vali Acc: 0.815 Test Loss: 0.582 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.991701602935791
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.598 Vali Acc: 0.803 Test Loss: 0.598 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 617823
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7552971839904785
Epoch: 1, Steps: 17 | Train Loss: 2.011 Vali Loss: 1.935 Vali Acc: 0.133 Test Loss: 1.935 Test Acc: 0.133
Validation loss decreased (inf --> -0.132929).  Saving model ...
Epoch: 2 cost time: 1.8336412906646729
Epoch: 2, Steps: 17 | Train Loss: 1.891 Vali Loss: 1.822 Vali Acc: 0.225 Test Loss: 1.822 Test Acc: 0.225
Validation loss decreased (-0.132929 --> -0.225415).  Saving model ...
Epoch: 3 cost time: 1.8522977828979492
Epoch: 3, Steps: 17 | Train Loss: 1.734 Vali Loss: 1.680 Vali Acc: 0.347 Test Loss: 1.680 Test Acc: 0.347
Validation loss decreased (-0.225415 --> -0.346804).  Saving model ...
Epoch: 4 cost time: 1.7770180702209473
Epoch: 4, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.531 Vali Acc: 0.364 Test Loss: 1.531 Test Acc: 0.364
Validation loss decreased (-0.346804 --> -0.364147).  Saving model ...
Epoch: 5 cost time: 1.8048584461212158
Epoch: 5, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.382 Vali Acc: 0.497 Test Loss: 1.382 Test Acc: 0.497
Validation loss decreased (-0.364147 --> -0.497096).  Saving model ...
Epoch: 6 cost time: 1.8404431343078613
Epoch: 6, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.261 Vali Acc: 0.491 Test Loss: 1.261 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9163720607757568
Epoch: 7, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.163 Vali Acc: 0.595 Test Loss: 1.163 Test Acc: 0.595
Validation loss decreased (-0.497096 --> -0.595364).  Saving model ...
Epoch: 8 cost time: 1.8490352630615234
Epoch: 8, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.067 Vali Acc: 0.630 Test Loss: 1.067 Test Acc: 0.630
Validation loss decreased (-0.595364 --> -0.630047).  Saving model ...
Epoch: 9 cost time: 2.0453147888183594
Epoch: 9, Steps: 17 | Train Loss: 0.873 Vali Loss: 0.961 Vali Acc: 0.699 Test Loss: 0.961 Test Acc: 0.699
Validation loss decreased (-0.630047 --> -0.699412).  Saving model ...
Epoch: 10 cost time: 1.9247663021087646
Epoch: 10, Steps: 17 | Train Loss: 0.781 Vali Loss: 0.893 Vali Acc: 0.630 Test Loss: 0.893 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9708325862884521
Epoch: 11, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.822 Vali Acc: 0.688 Test Loss: 0.822 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9048800468444824
Epoch: 12, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.845 Vali Acc: 0.665 Test Loss: 0.845 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0600035190582275
Epoch: 13, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.763 Vali Acc: 0.694 Test Loss: 0.763 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9194862842559814
Epoch: 14, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.801 Vali Acc: 0.676 Test Loss: 0.801 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9000463485717773
Epoch: 15, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.683 Vali Acc: 0.734 Test Loss: 0.683 Test Acc: 0.734
Validation loss decreased (-0.699412 --> -0.734097).  Saving model ...
Epoch: 16 cost time: 1.9757020473480225
Epoch: 16, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.623 Vali Acc: 0.711 Test Loss: 0.623 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.84208083152771
Epoch: 17, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.590 Vali Acc: 0.792 Test Loss: 0.590 Test Acc: 0.792
Validation loss decreased (-0.734097 --> -0.791902).  Saving model ...
Epoch: 18 cost time: 1.5099403858184814
Epoch: 18, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.681 Vali Acc: 0.688 Test Loss: 0.681 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8628013134002686
Epoch: 19, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.612 Vali Acc: 0.757 Test Loss: 0.612 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.719761848449707
Epoch: 20, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.590 Vali Acc: 0.728 Test Loss: 0.590 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8545351028442383
Epoch: 21, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.605 Vali Acc: 0.734 Test Loss: 0.605 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.832319974899292
Epoch: 22, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.631 Vali Acc: 0.751 Test Loss: 0.631 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9736113548278809
Epoch: 23, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.610 Vali Acc: 0.798 Test Loss: 0.610 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797682).  Saving model ...
Epoch: 24 cost time: 1.993577003479004
Epoch: 24, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.592 Vali Acc: 0.786 Test Loss: 0.592 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9972915649414062
Epoch: 25, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.564 Vali Acc: 0.757 Test Loss: 0.564 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9311888217926025
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.682 Vali Acc: 0.740 Test Loss: 0.682 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9620208740234375
Epoch: 27, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.587 Vali Acc: 0.775 Test Loss: 0.587 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9691545963287354
Epoch: 28, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.599 Vali Acc: 0.792 Test Loss: 0.599 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9187877178192139
Epoch: 29, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.647 Vali Acc: 0.751 Test Loss: 0.647 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9290425777435303
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.676 Vali Acc: 0.757 Test Loss: 0.676 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 203839
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.944056749343872
Epoch: 1, Steps: 17 | Train Loss: 1.952 Vali Loss: 1.874 Vali Acc: 0.220 Test Loss: 1.874 Test Acc: 0.220
Validation loss decreased (inf --> -0.219634).  Saving model ...
Epoch: 2 cost time: 2.1724581718444824
Epoch: 2, Steps: 17 | Train Loss: 1.811 Vali Loss: 1.744 Vali Acc: 0.266 Test Loss: 1.744 Test Acc: 0.266
Validation loss decreased (-0.219634 --> -0.265879).  Saving model ...
Epoch: 3 cost time: 2.1313486099243164
Epoch: 3, Steps: 17 | Train Loss: 1.664 Vali Loss: 1.628 Vali Acc: 0.301 Test Loss: 1.628 Test Acc: 0.301
Validation loss decreased (-0.265879 --> -0.300562).  Saving model ...
Epoch: 4 cost time: 2.231614589691162
Epoch: 4, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.505 Vali Acc: 0.382 Test Loss: 1.505 Test Acc: 0.382
Validation loss decreased (-0.300562 --> -0.381488).  Saving model ...
Epoch: 5 cost time: 2.5318703651428223
Epoch: 5, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.369 Vali Acc: 0.497 Test Loss: 1.369 Test Acc: 0.497
Validation loss decreased (-0.381488 --> -0.497096).  Saving model ...
Epoch: 6 cost time: 2.541022539138794
Epoch: 6, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.286 Vali Acc: 0.549 Test Loss: 1.286 Test Acc: 0.549
Validation loss decreased (-0.497096 --> -0.549120).  Saving model ...
Epoch: 7 cost time: 2.494810104370117
Epoch: 7, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.193 Vali Acc: 0.543 Test Loss: 1.193 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4270694255828857
Epoch: 8, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.077 Vali Acc: 0.584 Test Loss: 1.077 Test Acc: 0.584
Validation loss decreased (-0.549120 --> -0.583804).  Saving model ...
Epoch: 9 cost time: 2.3705921173095703
Epoch: 9, Steps: 17 | Train Loss: 0.845 Vali Loss: 0.997 Vali Acc: 0.624 Test Loss: 0.997 Test Acc: 0.624
Validation loss decreased (-0.583804 --> -0.624267).  Saving model ...
Epoch: 10 cost time: 2.45479416847229
Epoch: 10, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.919 Vali Acc: 0.659 Test Loss: 0.919 Test Acc: 0.659
Validation loss decreased (-0.624267 --> -0.658950).  Saving model ...
Epoch: 11 cost time: 2.373753070831299
Epoch: 11, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.832 Vali Acc: 0.699 Test Loss: 0.832 Test Acc: 0.699
Validation loss decreased (-0.658950 --> -0.699414).  Saving model ...
Epoch: 12 cost time: 2.3202428817749023
Epoch: 12, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.802 Vali Acc: 0.723 Test Loss: 0.802 Test Acc: 0.723
Validation loss decreased (-0.699414 --> -0.722535).  Saving model ...
Epoch: 13 cost time: 2.226393938064575
Epoch: 13, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.760 Vali Acc: 0.728 Test Loss: 0.760 Test Acc: 0.728
Validation loss decreased (-0.722535 --> -0.728316).  Saving model ...
Epoch: 14 cost time: 2.2380051612854004
Epoch: 14, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.739 Vali Acc: 0.740 Test Loss: 0.739 Test Acc: 0.740
Validation loss decreased (-0.728316 --> -0.739877).  Saving model ...
Epoch: 15 cost time: 2.24141526222229
Epoch: 15, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.727 Vali Acc: 0.740 Test Loss: 0.727 Test Acc: 0.740
Validation loss decreased (-0.739877 --> -0.739877).  Saving model ...
Epoch: 16 cost time: 2.2413899898529053
Epoch: 16, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.748 Vali Acc: 0.717 Test Loss: 0.748 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2823593616485596
Epoch: 17, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.669 Vali Acc: 0.740 Test Loss: 0.669 Test Acc: 0.740
Validation loss decreased (-0.739877 --> -0.739878).  Saving model ...
Epoch: 18 cost time: 2.384105920791626
Epoch: 18, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.732 Vali Acc: 0.734 Test Loss: 0.732 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2825589179992676
Epoch: 19, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.743 Vali Acc: 0.734 Test Loss: 0.743 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1200366020202637
Epoch: 20, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.741 Vali Acc: 0.751 Test Loss: 0.741 Test Acc: 0.751
Validation loss decreased (-0.739878 --> -0.751438).  Saving model ...
Epoch: 21 cost time: 2.173011541366577
Epoch: 21, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.567 Vali Acc: 0.821 Test Loss: 0.567 Test Acc: 0.821
Validation loss decreased (-0.751438 --> -0.820804).  Saving model ...
Epoch: 22 cost time: 2.118797540664673
Epoch: 22, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.669 Vali Acc: 0.786 Test Loss: 0.669 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0147745609283447
Epoch: 23, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.589 Vali Acc: 0.786 Test Loss: 0.589 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0130326747894287
Epoch: 24, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.8527932167053223
Epoch: 25, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.627 Vali Acc: 0.803 Test Loss: 0.627 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.829183578491211
Epoch: 26, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.750 Vali Acc: 0.775 Test Loss: 0.750 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.7585341930389404
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.658 Vali Acc: 0.775 Test Loss: 0.658 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.9216108322143555
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.679 Vali Acc: 0.815 Test Loss: 0.679 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.8105175495147705
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.641 Vali Acc: 0.803 Test Loss: 0.641 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.7981200218200684
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.656 Vali Acc: 0.792 Test Loss: 0.656 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 617823
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6686289310455322
Epoch: 1, Steps: 17 | Train Loss: 2.011 Vali Loss: 1.935 Vali Acc: 0.133 Test Loss: 1.935 Test Acc: 0.133
Validation loss decreased (inf --> -0.132929).  Saving model ...
Epoch: 2 cost time: 2.0367720127105713
Epoch: 2, Steps: 17 | Train Loss: 1.891 Vali Loss: 1.822 Vali Acc: 0.225 Test Loss: 1.822 Test Acc: 0.225
Validation loss decreased (-0.132929 --> -0.225415).  Saving model ...
Epoch: 3 cost time: 2.052053928375244
Epoch: 3, Steps: 17 | Train Loss: 1.734 Vali Loss: 1.680 Vali Acc: 0.347 Test Loss: 1.680 Test Acc: 0.347
Validation loss decreased (-0.225415 --> -0.346804).  Saving model ...
Epoch: 4 cost time: 2.0313572883605957
Epoch: 4, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.531 Vali Acc: 0.364 Test Loss: 1.531 Test Acc: 0.364
Validation loss decreased (-0.346804 --> -0.364147).  Saving model ...
Epoch: 5 cost time: 2.0100364685058594
Epoch: 5, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.382 Vali Acc: 0.497 Test Loss: 1.382 Test Acc: 0.497
Validation loss decreased (-0.364147 --> -0.497096).  Saving model ...
Epoch: 6 cost time: 1.983116626739502
Epoch: 6, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.261 Vali Acc: 0.491 Test Loss: 1.261 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9929604530334473
Epoch: 7, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.163 Vali Acc: 0.595 Test Loss: 1.163 Test Acc: 0.595
Validation loss decreased (-0.497096 --> -0.595364).  Saving model ...
Epoch: 8 cost time: 1.9710590839385986
Epoch: 8, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.067 Vali Acc: 0.630 Test Loss: 1.067 Test Acc: 0.630
Validation loss decreased (-0.595364 --> -0.630047).  Saving model ...
Epoch: 9 cost time: 2.0429935455322266
Epoch: 9, Steps: 17 | Train Loss: 0.873 Vali Loss: 0.961 Vali Acc: 0.699 Test Loss: 0.961 Test Acc: 0.699
Validation loss decreased (-0.630047 --> -0.699412).  Saving model ...
Epoch: 10 cost time: 2.0857980251312256
Epoch: 10, Steps: 17 | Train Loss: 0.781 Vali Loss: 0.893 Vali Acc: 0.630 Test Loss: 0.893 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9510104656219482
Epoch: 11, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.822 Vali Acc: 0.688 Test Loss: 0.822 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.019108533859253
Epoch: 12, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.845 Vali Acc: 0.665 Test Loss: 0.845 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.075939655303955
Epoch: 13, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.763 Vali Acc: 0.694 Test Loss: 0.763 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9595370292663574
Epoch: 14, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.801 Vali Acc: 0.676 Test Loss: 0.801 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0806262493133545
Epoch: 15, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.683 Vali Acc: 0.734 Test Loss: 0.683 Test Acc: 0.734
Validation loss decreased (-0.699412 --> -0.734097).  Saving model ...
Epoch: 16 cost time: 2.0365118980407715
Epoch: 16, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.623 Vali Acc: 0.711 Test Loss: 0.623 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0641674995422363
Epoch: 17, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.584 Vali Acc: 0.769 Test Loss: 0.584 Test Acc: 0.769
Validation loss decreased (-0.734097 --> -0.768780).  Saving model ...
Epoch: 18 cost time: 2.0794177055358887
Epoch: 18, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.675 Vali Acc: 0.688 Test Loss: 0.675 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0583417415618896
Epoch: 19, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.971139907836914
Epoch: 20, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.591 Vali Acc: 0.734 Test Loss: 0.591 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9823975563049316
Epoch: 21, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.632 Vali Acc: 0.751 Test Loss: 0.632 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0004944801330566
Epoch: 22, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.633 Vali Acc: 0.746 Test Loss: 0.633 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.056779384613037
Epoch: 23, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.626 Vali Acc: 0.780 Test Loss: 0.626 Test Acc: 0.780
Validation loss decreased (-0.768780 --> -0.780341).  Saving model ...
Epoch: 24 cost time: 2.0742082595825195
Epoch: 24, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.630 Vali Acc: 0.763 Test Loss: 0.630 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0097594261169434
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.574 Vali Acc: 0.769 Test Loss: 0.574 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0008018016815186
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.675 Vali Acc: 0.757 Test Loss: 0.675 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9919710159301758
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.609 Vali Acc: 0.775 Test Loss: 0.609 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9872095584869385
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.566 Vali Acc: 0.780 Test Loss: 0.566 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 29 cost time: 2.1661746501922607
Epoch: 29, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.592 Vali Acc: 0.775 Test Loss: 0.592 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.017582654953003
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.648 Vali Acc: 0.751 Test Loss: 0.648 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 203839
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8733949661254883
Epoch: 1, Steps: 17 | Train Loss: 1.952 Vali Loss: 1.875 Vali Acc: 0.220 Test Loss: 1.875 Test Acc: 0.220
Validation loss decreased (inf --> -0.219634).  Saving model ...
Epoch: 2 cost time: 2.1579551696777344
Epoch: 2, Steps: 17 | Train Loss: 1.811 Vali Loss: 1.744 Vali Acc: 0.266 Test Loss: 1.744 Test Acc: 0.266
Validation loss decreased (-0.219634 --> -0.265879).  Saving model ...
Epoch: 3 cost time: 2.1989638805389404
Epoch: 3, Steps: 17 | Train Loss: 1.664 Vali Loss: 1.628 Vali Acc: 0.301 Test Loss: 1.628 Test Acc: 0.301
Validation loss decreased (-0.265879 --> -0.300562).  Saving model ...
Epoch: 4 cost time: 2.239952564239502
Epoch: 4, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.505 Vali Acc: 0.382 Test Loss: 1.505 Test Acc: 0.382
Validation loss decreased (-0.300562 --> -0.381488).  Saving model ...
Epoch: 5 cost time: 2.1501123905181885
Epoch: 5, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.369 Vali Acc: 0.497 Test Loss: 1.369 Test Acc: 0.497
Validation loss decreased (-0.381488 --> -0.497096).  Saving model ...
Epoch: 6 cost time: 2.269665002822876
Epoch: 6, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.286 Vali Acc: 0.549 Test Loss: 1.286 Test Acc: 0.549
Validation loss decreased (-0.497096 --> -0.549120).  Saving model ...
Epoch: 7 cost time: 2.202457904815674
Epoch: 7, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.193 Vali Acc: 0.543 Test Loss: 1.193 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2645273208618164
Epoch: 8, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.077 Vali Acc: 0.584 Test Loss: 1.077 Test Acc: 0.584
Validation loss decreased (-0.549120 --> -0.583804).  Saving model ...
Epoch: 9 cost time: 2.2565200328826904
Epoch: 9, Steps: 17 | Train Loss: 0.845 Vali Loss: 0.997 Vali Acc: 0.624 Test Loss: 0.997 Test Acc: 0.624
Validation loss decreased (-0.583804 --> -0.624267).  Saving model ...
Epoch: 10 cost time: 2.1648213863372803
Epoch: 10, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.920 Vali Acc: 0.659 Test Loss: 0.920 Test Acc: 0.659
Validation loss decreased (-0.624267 --> -0.658950).  Saving model ...
Epoch: 11 cost time: 1.9286141395568848
Epoch: 11, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.835 Vali Acc: 0.705 Test Loss: 0.835 Test Acc: 0.705
Validation loss decreased (-0.658950 --> -0.705194).  Saving model ...
Epoch: 12 cost time: 2.059291124343872
Epoch: 12, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.805 Vali Acc: 0.723 Test Loss: 0.805 Test Acc: 0.723
Validation loss decreased (-0.705194 --> -0.722535).  Saving model ...
Epoch: 13 cost time: 2.193922519683838
Epoch: 13, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.747 Vali Acc: 0.728 Test Loss: 0.747 Test Acc: 0.728
Validation loss decreased (-0.722535 --> -0.728316).  Saving model ...
Epoch: 14 cost time: 2.1313223838806152
Epoch: 14, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.708 Vali Acc: 0.746 Test Loss: 0.708 Test Acc: 0.746
Validation loss decreased (-0.728316 --> -0.745658).  Saving model ...
Epoch: 15 cost time: 2.1330411434173584
Epoch: 15, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.689 Vali Acc: 0.751 Test Loss: 0.689 Test Acc: 0.751
Validation loss decreased (-0.745658 --> -0.751438).  Saving model ...
Epoch: 16 cost time: 2.1447458267211914
Epoch: 16, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.714 Vali Acc: 0.717 Test Loss: 0.714 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.168048620223999
Epoch: 17, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.674 Vali Acc: 0.757 Test Loss: 0.674 Test Acc: 0.757
Validation loss decreased (-0.751438 --> -0.757219).  Saving model ...
Epoch: 18 cost time: 2.1953036785125732
Epoch: 18, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.703 Vali Acc: 0.751 Test Loss: 0.703 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0204432010650635
Epoch: 19, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.645 Vali Acc: 0.792 Test Loss: 0.645 Test Acc: 0.792
Validation loss decreased (-0.757219 --> -0.791901).  Saving model ...
Epoch: 20 cost time: 1.9106924533843994
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.845 Vali Acc: 0.728 Test Loss: 0.845 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7949373722076416
Epoch: 21, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.562 Vali Acc: 0.821 Test Loss: 0.562 Test Acc: 0.821
Validation loss decreased (-0.791901 --> -0.820804).  Saving model ...
Epoch: 22 cost time: 1.996781587600708
Epoch: 22, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.616 Vali Acc: 0.780 Test Loss: 0.616 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7296288013458252
Epoch: 23, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.587 Vali Acc: 0.786 Test Loss: 0.587 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.035789728164673
Epoch: 24, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.605 Vali Acc: 0.792 Test Loss: 0.605 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.96575927734375
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.640 Vali Acc: 0.792 Test Loss: 0.640 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9750444889068604
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0176491737365723
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.670 Vali Acc: 0.780 Test Loss: 0.670 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9118952751159668
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.615 Vali Acc: 0.792 Test Loss: 0.615 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.949434518814087
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.732 Vali Acc: 0.792 Test Loss: 0.732 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.89924955368042
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.691 Vali Acc: 0.786 Test Loss: 0.691 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 617823
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5102057456970215
Epoch: 1, Steps: 17 | Train Loss: 2.011 Vali Loss: 1.935 Vali Acc: 0.133 Test Loss: 1.935 Test Acc: 0.133
Validation loss decreased (inf --> -0.132929).  Saving model ...
Epoch: 2 cost time: 1.6524596214294434
Epoch: 2, Steps: 17 | Train Loss: 1.891 Vali Loss: 1.822 Vali Acc: 0.225 Test Loss: 1.822 Test Acc: 0.225
Validation loss decreased (-0.132929 --> -0.225415).  Saving model ...
Epoch: 3 cost time: 1.7069091796875
Epoch: 3, Steps: 17 | Train Loss: 1.734 Vali Loss: 1.680 Vali Acc: 0.347 Test Loss: 1.680 Test Acc: 0.347
Validation loss decreased (-0.225415 --> -0.346804).  Saving model ...
Epoch: 4 cost time: 1.6036913394927979
Epoch: 4, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.531 Vali Acc: 0.364 Test Loss: 1.531 Test Acc: 0.364
Validation loss decreased (-0.346804 --> -0.364147).  Saving model ...
Epoch: 5 cost time: 1.6851816177368164
Epoch: 5, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.382 Vali Acc: 0.497 Test Loss: 1.382 Test Acc: 0.497
Validation loss decreased (-0.364147 --> -0.497096).  Saving model ...
Epoch: 6 cost time: 1.6276462078094482
Epoch: 6, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.261 Vali Acc: 0.491 Test Loss: 1.261 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6625549793243408
Epoch: 7, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.163 Vali Acc: 0.595 Test Loss: 1.163 Test Acc: 0.595
Validation loss decreased (-0.497096 --> -0.595364).  Saving model ...
Epoch: 8 cost time: 1.5983631610870361
Epoch: 8, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.067 Vali Acc: 0.630 Test Loss: 1.067 Test Acc: 0.630
Validation loss decreased (-0.595364 --> -0.630047).  Saving model ...
Epoch: 9 cost time: 1.6345279216766357
Epoch: 9, Steps: 17 | Train Loss: 0.873 Vali Loss: 0.961 Vali Acc: 0.699 Test Loss: 0.961 Test Acc: 0.699
Validation loss decreased (-0.630047 --> -0.699412).  Saving model ...
Epoch: 10 cost time: 1.6333670616149902
Epoch: 10, Steps: 17 | Train Loss: 0.781 Vali Loss: 0.893 Vali Acc: 0.630 Test Loss: 0.893 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.612475872039795
Epoch: 11, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.822 Vali Acc: 0.688 Test Loss: 0.822 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6308565139770508
Epoch: 12, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.845 Vali Acc: 0.665 Test Loss: 0.845 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6208088397979736
Epoch: 13, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.758 Vali Acc: 0.699 Test Loss: 0.758 Test Acc: 0.699
Validation loss decreased (-0.699412 --> -0.699414).  Saving model ...
Epoch: 14 cost time: 1.6674742698669434
Epoch: 14, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.800 Vali Acc: 0.682 Test Loss: 0.800 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7369740009307861
Epoch: 15, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.667 Vali Acc: 0.723 Test Loss: 0.667 Test Acc: 0.723
Validation loss decreased (-0.699414 --> -0.722537).  Saving model ...
Epoch: 16 cost time: 1.7036254405975342
Epoch: 16, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.625 Vali Acc: 0.746 Test Loss: 0.625 Test Acc: 0.746
Validation loss decreased (-0.722537 --> -0.745658).  Saving model ...
Epoch: 17 cost time: 1.6902954578399658
Epoch: 17, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.592 Vali Acc: 0.775 Test Loss: 0.592 Test Acc: 0.775
Validation loss decreased (-0.745658 --> -0.774561).  Saving model ...
Epoch: 18 cost time: 1.7156593799591064
Epoch: 18, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.677 Vali Acc: 0.699 Test Loss: 0.677 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6745529174804688
Epoch: 19, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.605 Vali Acc: 0.757 Test Loss: 0.605 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.678809642791748
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.597 Vali Acc: 0.746 Test Loss: 0.597 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7052500247955322
Epoch: 21, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.648 Vali Acc: 0.723 Test Loss: 0.648 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6747503280639648
Epoch: 22, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.639 Vali Acc: 0.763 Test Loss: 0.639 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6433236598968506
Epoch: 23, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.634 Vali Acc: 0.723 Test Loss: 0.634 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6180753707885742
Epoch: 24, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.662 Vali Acc: 0.734 Test Loss: 0.662 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7129063606262207
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.617 Vali Acc: 0.746 Test Loss: 0.617 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6799039840698242
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.715 Vali Acc: 0.734 Test Loss: 0.715 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7017195224761963
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.659 Vali Acc: 0.751 Test Loss: 0.659 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 203839
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.944970607757568
Epoch: 1, Steps: 17 | Train Loss: 2.040 Vali Loss: 1.940 Vali Acc: 0.145 Test Loss: 1.940 Test Acc: 0.145
Validation loss decreased (inf --> -0.144489).  Saving model ...
Epoch: 2 cost time: 2.6954243183135986
Epoch: 2, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.828 Vali Acc: 0.306 Test Loss: 1.828 Test Acc: 0.306
Validation loss decreased (-0.144489 --> -0.306340).  Saving model ...
Epoch: 3 cost time: 2.7678775787353516
Epoch: 3, Steps: 17 | Train Loss: 1.797 Vali Loss: 1.704 Vali Acc: 0.376 Test Loss: 1.704 Test Acc: 0.376
Validation loss decreased (-0.306340 --> -0.375706).  Saving model ...
Epoch: 4 cost time: 2.792950391769409
Epoch: 4, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.560 Vali Acc: 0.439 Test Loss: 1.560 Test Acc: 0.439
Validation loss decreased (-0.375706 --> -0.439291).  Saving model ...
Epoch: 5 cost time: 2.780503273010254
Epoch: 5, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.414 Vali Acc: 0.486 Test Loss: 1.414 Test Acc: 0.486
Validation loss decreased (-0.439291 --> -0.485535).  Saving model ...
Epoch: 6 cost time: 2.741011142730713
Epoch: 6, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.299 Vali Acc: 0.514 Test Loss: 1.299 Test Acc: 0.514
Validation loss decreased (-0.485535 --> -0.514438).  Saving model ...
Epoch: 7 cost time: 2.751826524734497
Epoch: 7, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.183 Vali Acc: 0.613 Test Loss: 1.183 Test Acc: 0.613
Validation loss decreased (-0.514438 --> -0.612705).  Saving model ...
Epoch: 8 cost time: 2.6769790649414062
Epoch: 8, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.108 Vali Acc: 0.607 Test Loss: 1.108 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8952157497406006
Epoch: 9, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.023 Vali Acc: 0.618 Test Loss: 1.023 Test Acc: 0.618
Validation loss decreased (-0.612705 --> -0.618487).  Saving model ...
Epoch: 10 cost time: 2.716636896133423
Epoch: 10, Steps: 17 | Train Loss: 0.806 Vali Loss: 0.899 Vali Acc: 0.705 Test Loss: 0.899 Test Acc: 0.705
Validation loss decreased (-0.618487 --> -0.705193).  Saving model ...
Epoch: 11 cost time: 2.7412540912628174
Epoch: 11, Steps: 17 | Train Loss: 0.689 Vali Loss: 0.828 Vali Acc: 0.723 Test Loss: 0.828 Test Acc: 0.723
Validation loss decreased (-0.705193 --> -0.722535).  Saving model ...
Epoch: 12 cost time: 2.8976492881774902
Epoch: 12, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.764 Vali Acc: 0.757 Test Loss: 0.764 Test Acc: 0.757
Validation loss decreased (-0.722535 --> -0.757218).  Saving model ...
Epoch: 13 cost time: 2.658108711242676
Epoch: 13, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.711 Vali Acc: 0.775 Test Loss: 0.711 Test Acc: 0.775
Validation loss decreased (-0.757218 --> -0.774559).  Saving model ...
Epoch: 14 cost time: 2.7748143672943115
Epoch: 14, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.708 Vali Acc: 0.763 Test Loss: 0.708 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.723386287689209
Epoch: 15, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
Validation loss decreased (-0.774559 --> -0.803462).  Saving model ...
Epoch: 16 cost time: 2.7256407737731934
Epoch: 16, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.605 Vali Acc: 0.786 Test Loss: 0.605 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.697010040283203
Epoch: 17, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803463).  Saving model ...
Epoch: 18 cost time: 2.7241666316986084
Epoch: 18, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809243).  Saving model ...
Epoch: 19 cost time: 2.7742178440093994
Epoch: 19, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.588 Vali Acc: 0.775 Test Loss: 0.588 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.6810426712036133
Epoch: 20, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
Validation loss decreased (-0.809243 --> -0.838145).  Saving model ...
Epoch: 21 cost time: 2.6629257202148438
Epoch: 21, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.491 Vali Acc: 0.827 Test Loss: 0.491 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.714918851852417
Epoch: 22, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.521 Vali Acc: 0.815 Test Loss: 0.521 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.6348462104797363
Epoch: 23, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.530 Vali Acc: 0.821 Test Loss: 0.530 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.629786729812622
Epoch: 24, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.549 Vali Acc: 0.786 Test Loss: 0.549 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.6262972354888916
Epoch: 25, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.579 Vali Acc: 0.769 Test Loss: 0.579 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.678299903869629
Epoch: 26, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
Validation loss decreased (-0.838145 --> -0.843925).  Saving model ...
Epoch: 27 cost time: 2.557741165161133
Epoch: 27, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.578 Vali Acc: 0.780 Test Loss: 0.578 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.591986894607544
Epoch: 28, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.615 Vali Acc: 0.780 Test Loss: 0.615 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.557983160018921
Epoch: 29, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.633 Vali Acc: 0.786 Test Loss: 0.633 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.660538911819458
Epoch: 30, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.619 Vali Acc: 0.798 Test Loss: 0.619 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 324575
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8834726810455322
Epoch: 1, Steps: 17 | Train Loss: 1.920 Vali Loss: 1.884 Vali Acc: 0.220 Test Loss: 1.884 Test Acc: 0.220
Validation loss decreased (inf --> -0.219634).  Saving model ...
Epoch: 2 cost time: 2.084965467453003
Epoch: 2, Steps: 17 | Train Loss: 1.763 Vali Loss: 1.747 Vali Acc: 0.231 Test Loss: 1.747 Test Acc: 0.231
Validation loss decreased (-0.219634 --> -0.231196).  Saving model ...
Epoch: 3 cost time: 2.053046941757202
Epoch: 3, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.601 Vali Acc: 0.295 Test Loss: 1.601 Test Acc: 0.295
Validation loss decreased (-0.231196 --> -0.294782).  Saving model ...
Epoch: 4 cost time: 2.0890517234802246
Epoch: 4, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.457 Vali Acc: 0.376 Test Loss: 1.457 Test Acc: 0.376
Validation loss decreased (-0.294782 --> -0.375708).  Saving model ...
Epoch: 5 cost time: 2.066227674484253
Epoch: 5, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.356 Vali Acc: 0.422 Test Loss: 1.356 Test Acc: 0.422
Validation loss decreased (-0.375708 --> -0.421952).  Saving model ...
Epoch: 6 cost time: 2.0907599925994873
Epoch: 6, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.273 Vali Acc: 0.486 Test Loss: 1.273 Test Acc: 0.486
Validation loss decreased (-0.421952 --> -0.485536).  Saving model ...
Epoch: 7 cost time: 1.9184958934783936
Epoch: 7, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.144 Vali Acc: 0.671 Test Loss: 1.144 Test Acc: 0.671
Validation loss decreased (-0.485536 --> -0.670509).  Saving model ...
Epoch: 8 cost time: 2.1722159385681152
Epoch: 8, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.108 Vali Acc: 0.561 Test Loss: 1.108 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1809425354003906
Epoch: 9, Steps: 17 | Train Loss: 0.890 Vali Loss: 1.018 Vali Acc: 0.636 Test Loss: 1.018 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.128859758377075
Epoch: 10, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.918 Vali Acc: 0.688 Test Loss: 0.918 Test Acc: 0.688
Validation loss decreased (-0.670509 --> -0.687852).  Saving model ...
Epoch: 11 cost time: 2.124621629714966
Epoch: 11, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.901 Vali Acc: 0.636 Test Loss: 0.901 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.070127010345459
Epoch: 12, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.806 Vali Acc: 0.694 Test Loss: 0.806 Test Acc: 0.694
Validation loss decreased (-0.687852 --> -0.693634).  Saving model ...
Epoch: 13 cost time: 2.0788140296936035
Epoch: 13, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
Validation loss decreased (-0.693634 --> -0.774559).  Saving model ...
Epoch: 14 cost time: 2.1370720863342285
Epoch: 14, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.661 Vali Acc: 0.763 Test Loss: 0.661 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.088221311569214
Epoch: 15, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.725 Vali Acc: 0.763 Test Loss: 0.725 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.117326021194458
Epoch: 16, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.684 Vali Acc: 0.780 Test Loss: 0.684 Test Acc: 0.780
Validation loss decreased (-0.774559 --> -0.780340).  Saving model ...
Epoch: 17 cost time: 2.0661327838897705
Epoch: 17, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.690 Vali Acc: 0.717 Test Loss: 0.690 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0875744819641113
Epoch: 18, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.637 Vali Acc: 0.751 Test Loss: 0.637 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.056189775466919
Epoch: 19, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.652 Vali Acc: 0.740 Test Loss: 0.652 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.105708122253418
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.625 Vali Acc: 0.763 Test Loss: 0.625 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1466598510742188
Epoch: 21, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.524 Vali Acc: 0.792 Test Loss: 0.524 Test Acc: 0.792
Validation loss decreased (-0.780340 --> -0.791902).  Saving model ...
Epoch: 22 cost time: 2.0607411861419678
Epoch: 22, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.586 Vali Acc: 0.780 Test Loss: 0.586 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0162882804870605
Epoch: 23, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.566 Vali Acc: 0.763 Test Loss: 0.566 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.252307653427124
Epoch: 24, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.604 Vali Acc: 0.786 Test Loss: 0.604 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.120164155960083
Epoch: 25, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.648 Vali Acc: 0.751 Test Loss: 0.648 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.1740219593048096
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.596 Vali Acc: 0.775 Test Loss: 0.596 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.23413348197937
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.659 Vali Acc: 0.746 Test Loss: 0.659 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.1299021244049072
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.693 Vali Acc: 0.775 Test Loss: 0.693 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.1251261234283447
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.538 Vali Acc: 0.798 Test Loss: 0.538 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797682).  Saving model ...
Epoch: 30 cost time: 2.1020052433013916
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.628 Vali Acc: 0.757 Test Loss: 0.628 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 117567
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.08301305770874
Epoch: 1, Steps: 17 | Train Loss: 2.040 Vali Loss: 1.940 Vali Acc: 0.145 Test Loss: 1.940 Test Acc: 0.145
Validation loss decreased (inf --> -0.144489).  Saving model ...
Epoch: 2 cost time: 2.3927032947540283
Epoch: 2, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.828 Vali Acc: 0.306 Test Loss: 1.828 Test Acc: 0.306
Validation loss decreased (-0.144489 --> -0.306340).  Saving model ...
Epoch: 3 cost time: 2.3383750915527344
Epoch: 3, Steps: 17 | Train Loss: 1.797 Vali Loss: 1.704 Vali Acc: 0.376 Test Loss: 1.704 Test Acc: 0.376
Validation loss decreased (-0.306340 --> -0.375706).  Saving model ...
Epoch: 4 cost time: 2.4785115718841553
Epoch: 4, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.560 Vali Acc: 0.439 Test Loss: 1.560 Test Acc: 0.439
Validation loss decreased (-0.375706 --> -0.439291).  Saving model ...
Epoch: 5 cost time: 2.3731868267059326
Epoch: 5, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.414 Vali Acc: 0.486 Test Loss: 1.414 Test Acc: 0.486
Validation loss decreased (-0.439291 --> -0.485535).  Saving model ...
Epoch: 6 cost time: 2.4907310009002686
Epoch: 6, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.299 Vali Acc: 0.514 Test Loss: 1.299 Test Acc: 0.514
Validation loss decreased (-0.485535 --> -0.514438).  Saving model ...
Epoch: 7 cost time: 2.4933524131774902
Epoch: 7, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.183 Vali Acc: 0.613 Test Loss: 1.183 Test Acc: 0.613
Validation loss decreased (-0.514438 --> -0.612705).  Saving model ...
Epoch: 8 cost time: 2.4540390968322754
Epoch: 8, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.108 Vali Acc: 0.607 Test Loss: 1.108 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4545791149139404
Epoch: 9, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.023 Vali Acc: 0.618 Test Loss: 1.023 Test Acc: 0.618
Validation loss decreased (-0.612705 --> -0.618487).  Saving model ...
Epoch: 10 cost time: 2.5732920169830322
Epoch: 10, Steps: 17 | Train Loss: 0.806 Vali Loss: 0.899 Vali Acc: 0.705 Test Loss: 0.899 Test Acc: 0.705
Validation loss decreased (-0.618487 --> -0.705193).  Saving model ...
Epoch: 11 cost time: 2.4430015087127686
Epoch: 11, Steps: 17 | Train Loss: 0.689 Vali Loss: 0.828 Vali Acc: 0.723 Test Loss: 0.828 Test Acc: 0.723
Validation loss decreased (-0.705193 --> -0.722535).  Saving model ...
Epoch: 12 cost time: 2.4384729862213135
Epoch: 12, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.764 Vali Acc: 0.757 Test Loss: 0.764 Test Acc: 0.757
Validation loss decreased (-0.722535 --> -0.757218).  Saving model ...
Epoch: 13 cost time: 2.3243680000305176
Epoch: 13, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.711 Vali Acc: 0.775 Test Loss: 0.711 Test Acc: 0.775
Validation loss decreased (-0.757218 --> -0.774559).  Saving model ...
Epoch: 14 cost time: 2.4799108505249023
Epoch: 14, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.709 Vali Acc: 0.763 Test Loss: 0.709 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4675474166870117
Epoch: 15, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.610 Vali Acc: 0.780 Test Loss: 0.610 Test Acc: 0.780
Validation loss decreased (-0.774559 --> -0.780341).  Saving model ...
Epoch: 16 cost time: 2.3048202991485596
Epoch: 16, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.609 Vali Acc: 0.780 Test Loss: 0.609 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 17 cost time: 2.431159257888794
Epoch: 17, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.609 Vali Acc: 0.757 Test Loss: 0.609 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4565906524658203
Epoch: 18, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.524 Vali Acc: 0.821 Test Loss: 0.524 Test Acc: 0.821
Validation loss decreased (-0.780341 --> -0.820804).  Saving model ...
Epoch: 19 cost time: 2.424119234085083
Epoch: 19, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.566 Vali Acc: 0.792 Test Loss: 0.566 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4394214153289795
Epoch: 20, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.559 Vali Acc: 0.792 Test Loss: 0.559 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3841545581817627
Epoch: 21, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.521 Vali Acc: 0.792 Test Loss: 0.521 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.373844623565674
Epoch: 22, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.472259044647217
Epoch: 23, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.554 Vali Acc: 0.786 Test Loss: 0.554 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.257455825805664
Epoch: 24, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.566 Vali Acc: 0.775 Test Loss: 0.566 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.329796552658081
Epoch: 25, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.533 Vali Acc: 0.815 Test Loss: 0.533 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.3083908557891846
Epoch: 26, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.582 Vali Acc: 0.798 Test Loss: 0.582 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.266040802001953
Epoch: 27, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.3239574432373047
Epoch: 28, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.598 Vali Acc: 0.798 Test Loss: 0.598 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 324575
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.4272029399871826
Epoch: 1, Steps: 17 | Train Loss: 1.920 Vali Loss: 1.884 Vali Acc: 0.220 Test Loss: 1.884 Test Acc: 0.220
Validation loss decreased (inf --> -0.219634).  Saving model ...
Epoch: 2 cost time: 1.8339920043945312
Epoch: 2, Steps: 17 | Train Loss: 1.763 Vali Loss: 1.747 Vali Acc: 0.231 Test Loss: 1.747 Test Acc: 0.231
Validation loss decreased (-0.219634 --> -0.231196).  Saving model ...
Epoch: 3 cost time: 1.8532934188842773
Epoch: 3, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.601 Vali Acc: 0.295 Test Loss: 1.601 Test Acc: 0.295
Validation loss decreased (-0.231196 --> -0.294782).  Saving model ...
Epoch: 4 cost time: 1.790074110031128
Epoch: 4, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.457 Vali Acc: 0.376 Test Loss: 1.457 Test Acc: 0.376
Validation loss decreased (-0.294782 --> -0.375708).  Saving model ...
Epoch: 5 cost time: 1.7972967624664307
Epoch: 5, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.356 Vali Acc: 0.422 Test Loss: 1.356 Test Acc: 0.422
Validation loss decreased (-0.375708 --> -0.421952).  Saving model ...
Epoch: 6 cost time: 1.8432872295379639
Epoch: 6, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.273 Vali Acc: 0.486 Test Loss: 1.273 Test Acc: 0.486
Validation loss decreased (-0.421952 --> -0.485536).  Saving model ...
Epoch: 7 cost time: 1.7576985359191895
Epoch: 7, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.144 Vali Acc: 0.671 Test Loss: 1.144 Test Acc: 0.671
Validation loss decreased (-0.485536 --> -0.670509).  Saving model ...
Epoch: 8 cost time: 1.791482925415039
Epoch: 8, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.108 Vali Acc: 0.561 Test Loss: 1.108 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.851210594177246
Epoch: 9, Steps: 17 | Train Loss: 0.890 Vali Loss: 1.018 Vali Acc: 0.636 Test Loss: 1.018 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9357967376708984
Epoch: 10, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.918 Vali Acc: 0.688 Test Loss: 0.918 Test Acc: 0.688
Validation loss decreased (-0.670509 --> -0.687852).  Saving model ...
Epoch: 11 cost time: 1.8293869495391846
Epoch: 11, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.901 Vali Acc: 0.636 Test Loss: 0.901 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.863368272781372
Epoch: 12, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.806 Vali Acc: 0.694 Test Loss: 0.806 Test Acc: 0.694
Validation loss decreased (-0.687852 --> -0.693634).  Saving model ...
Epoch: 13 cost time: 1.9650042057037354
Epoch: 13, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
Validation loss decreased (-0.693634 --> -0.774559).  Saving model ...
Epoch: 14 cost time: 1.9321675300598145
Epoch: 14, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.661 Vali Acc: 0.763 Test Loss: 0.661 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9576847553253174
Epoch: 15, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.725 Vali Acc: 0.763 Test Loss: 0.725 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8431892395019531
Epoch: 16, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.684 Vali Acc: 0.780 Test Loss: 0.684 Test Acc: 0.780
Validation loss decreased (-0.774559 --> -0.780340).  Saving model ...
Epoch: 17 cost time: 1.895043134689331
Epoch: 17, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.692 Vali Acc: 0.717 Test Loss: 0.692 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9154260158538818
Epoch: 18, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.636 Vali Acc: 0.751 Test Loss: 0.636 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9055466651916504
Epoch: 19, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.652 Vali Acc: 0.740 Test Loss: 0.652 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9771020412445068
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.625 Vali Acc: 0.763 Test Loss: 0.625 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.999864101409912
Epoch: 21, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.533 Vali Acc: 0.798 Test Loss: 0.533 Test Acc: 0.798
Validation loss decreased (-0.780340 --> -0.797683).  Saving model ...
Epoch: 22 cost time: 2.135056257247925
Epoch: 22, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.574 Vali Acc: 0.786 Test Loss: 0.574 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8947477340698242
Epoch: 23, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.570 Vali Acc: 0.775 Test Loss: 0.570 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.076390027999878
Epoch: 24, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
Validation loss decreased (-0.797683 --> -0.803463).  Saving model ...
Epoch: 25 cost time: 2.0636723041534424
Epoch: 25, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.626 Vali Acc: 0.786 Test Loss: 0.626 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.133229970932007
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.607 Vali Acc: 0.751 Test Loss: 0.607 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.103193759918213
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.624 Vali Acc: 0.775 Test Loss: 0.624 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0694267749786377
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.665 Vali Acc: 0.763 Test Loss: 0.665 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.076977491378784
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0900936126708984
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.714 Vali Acc: 0.734 Test Loss: 0.714 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 117567
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.662855863571167
Epoch: 1, Steps: 17 | Train Loss: 2.040 Vali Loss: 1.938 Vali Acc: 0.162 Test Loss: 1.938 Test Acc: 0.162
Validation loss decreased (inf --> -0.161830).  Saving model ...
Epoch: 2 cost time: 1.9897260665893555
Epoch: 2, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.826 Vali Acc: 0.318 Test Loss: 1.826 Test Acc: 0.318
Validation loss decreased (-0.161830 --> -0.317901).  Saving model ...
Epoch: 3 cost time: 1.9450805187225342
Epoch: 3, Steps: 17 | Train Loss: 1.796 Vali Loss: 1.703 Vali Acc: 0.382 Test Loss: 1.703 Test Acc: 0.382
Validation loss decreased (-0.317901 --> -0.381486).  Saving model ...
Epoch: 4 cost time: 1.9557428359985352
Epoch: 4, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.559 Vali Acc: 0.445 Test Loss: 1.559 Test Acc: 0.445
Validation loss decreased (-0.381486 --> -0.445071).  Saving model ...
Epoch: 5 cost time: 1.9661469459533691
Epoch: 5, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.413 Vali Acc: 0.497 Test Loss: 1.413 Test Acc: 0.497
Validation loss decreased (-0.445071 --> -0.497096).  Saving model ...
Epoch: 6 cost time: 2.004101276397705
Epoch: 6, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.298 Vali Acc: 0.514 Test Loss: 1.298 Test Acc: 0.514
Validation loss decreased (-0.497096 --> -0.514438).  Saving model ...
Epoch: 7 cost time: 1.9273831844329834
Epoch: 7, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.183 Vali Acc: 0.613 Test Loss: 1.183 Test Acc: 0.613
Validation loss decreased (-0.514438 --> -0.612705).  Saving model ...
Epoch: 8 cost time: 1.914297103881836
Epoch: 8, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.111 Vali Acc: 0.607 Test Loss: 1.111 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.963041067123413
Epoch: 9, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.023 Vali Acc: 0.618 Test Loss: 1.023 Test Acc: 0.618
Validation loss decreased (-0.612705 --> -0.618487).  Saving model ...
Epoch: 10 cost time: 2.1637837886810303
Epoch: 10, Steps: 17 | Train Loss: 0.809 Vali Loss: 0.904 Vali Acc: 0.694 Test Loss: 0.904 Test Acc: 0.694
Validation loss decreased (-0.618487 --> -0.693633).  Saving model ...
Epoch: 11 cost time: 1.9800045490264893
Epoch: 11, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.835 Vali Acc: 0.717 Test Loss: 0.835 Test Acc: 0.717
Validation loss decreased (-0.693633 --> -0.716755).  Saving model ...
Epoch: 12 cost time: 1.9868512153625488
Epoch: 12, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.769 Vali Acc: 0.763 Test Loss: 0.769 Test Acc: 0.763
Validation loss decreased (-0.716755 --> -0.762998).  Saving model ...
Epoch: 13 cost time: 1.9562413692474365
Epoch: 13, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.709 Vali Acc: 0.792 Test Loss: 0.709 Test Acc: 0.792
Validation loss decreased (-0.762998 --> -0.791900).  Saving model ...
Epoch: 14 cost time: 2.1580610275268555
Epoch: 14, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.693 Vali Acc: 0.763 Test Loss: 0.693 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.962212085723877
Epoch: 15, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.607 Vali Acc: 0.798 Test Loss: 0.607 Test Acc: 0.798
Validation loss decreased (-0.791900 --> -0.797682).  Saving model ...
Epoch: 16 cost time: 2.0733275413513184
Epoch: 16, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.601 Vali Acc: 0.786 Test Loss: 0.601 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9769365787506104
Epoch: 17, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.551 Vali Acc: 0.821 Test Loss: 0.551 Test Acc: 0.821
Validation loss decreased (-0.797682 --> -0.820804).  Saving model ...
Epoch: 18 cost time: 2.001307487487793
Epoch: 18, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.97328519821167
Epoch: 19, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.581 Vali Acc: 0.775 Test Loss: 0.581 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9579167366027832
Epoch: 20, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.591 Vali Acc: 0.798 Test Loss: 0.591 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9643278121948242
Epoch: 21, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9619908332824707
Epoch: 22, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.539 Vali Acc: 0.815 Test Loss: 0.539 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9572532176971436
Epoch: 23, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.565 Vali Acc: 0.798 Test Loss: 0.565 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.0361387729644775
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.544 Vali Acc: 0.780 Test Loss: 0.544 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9714949131011963
Epoch: 25, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9230563640594482
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.569 Vali Acc: 0.780 Test Loss: 0.569 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9814624786376953
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.561 Vali Acc: 0.792 Test Loss: 0.561 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 324575
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.1752374172210693
Epoch: 1, Steps: 17 | Train Loss: 1.920 Vali Loss: 1.884 Vali Acc: 0.220 Test Loss: 1.884 Test Acc: 0.220
Validation loss decreased (inf --> -0.219634).  Saving model ...
Epoch: 2 cost time: 1.5496149063110352
Epoch: 2, Steps: 17 | Train Loss: 1.763 Vali Loss: 1.747 Vali Acc: 0.231 Test Loss: 1.747 Test Acc: 0.231
Validation loss decreased (-0.219634 --> -0.231196).  Saving model ...
Epoch: 3 cost time: 1.6157279014587402
Epoch: 3, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.601 Vali Acc: 0.295 Test Loss: 1.601 Test Acc: 0.295
Validation loss decreased (-0.231196 --> -0.294782).  Saving model ...
Epoch: 4 cost time: 1.6179537773132324
Epoch: 4, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.457 Vali Acc: 0.376 Test Loss: 1.457 Test Acc: 0.376
Validation loss decreased (-0.294782 --> -0.375708).  Saving model ...
Epoch: 5 cost time: 1.7470057010650635
Epoch: 5, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.356 Vali Acc: 0.422 Test Loss: 1.356 Test Acc: 0.422
Validation loss decreased (-0.375708 --> -0.421952).  Saving model ...
Epoch: 6 cost time: 1.7164838314056396
Epoch: 6, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.273 Vali Acc: 0.486 Test Loss: 1.273 Test Acc: 0.486
Validation loss decreased (-0.421952 --> -0.485536).  Saving model ...
Epoch: 7 cost time: 1.683225154876709
Epoch: 7, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.144 Vali Acc: 0.671 Test Loss: 1.144 Test Acc: 0.671
Validation loss decreased (-0.485536 --> -0.670509).  Saving model ...
Epoch: 8 cost time: 1.6211671829223633
Epoch: 8, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.108 Vali Acc: 0.561 Test Loss: 1.108 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6563270092010498
Epoch: 9, Steps: 17 | Train Loss: 0.890 Vali Loss: 1.018 Vali Acc: 0.636 Test Loss: 1.018 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5843372344970703
Epoch: 10, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.918 Vali Acc: 0.688 Test Loss: 0.918 Test Acc: 0.688
Validation loss decreased (-0.670509 --> -0.687852).  Saving model ...
Epoch: 11 cost time: 1.6007630825042725
Epoch: 11, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.901 Vali Acc: 0.636 Test Loss: 0.901 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.555710792541504
Epoch: 12, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.806 Vali Acc: 0.694 Test Loss: 0.806 Test Acc: 0.694
Validation loss decreased (-0.687852 --> -0.693634).  Saving model ...
Epoch: 13 cost time: 1.6359550952911377
Epoch: 13, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
Validation loss decreased (-0.693634 --> -0.774559).  Saving model ...
Epoch: 14 cost time: 1.6394047737121582
Epoch: 14, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.668 Vali Acc: 0.751 Test Loss: 0.668 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7049684524536133
Epoch: 15, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.729 Vali Acc: 0.769 Test Loss: 0.729 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6666913032531738
Epoch: 16, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.685 Vali Acc: 0.780 Test Loss: 0.685 Test Acc: 0.780
Validation loss decreased (-0.774559 --> -0.780340).  Saving model ...
Epoch: 17 cost time: 1.6154143810272217
Epoch: 17, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6433687210083008
Epoch: 18, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.632 Vali Acc: 0.751 Test Loss: 0.632 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6139426231384277
Epoch: 19, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.669 Vali Acc: 0.734 Test Loss: 0.669 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.690521478652954
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.624 Vali Acc: 0.757 Test Loss: 0.624 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6644697189331055
Epoch: 21, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
Validation loss decreased (-0.780340 --> -0.809243).  Saving model ...
Epoch: 22 cost time: 1.6488525867462158
Epoch: 22, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.571 Vali Acc: 0.775 Test Loss: 0.571 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5208466053009033
Epoch: 23, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.577 Vali Acc: 0.786 Test Loss: 0.577 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7268638610839844
Epoch: 24, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.547 Vali Acc: 0.786 Test Loss: 0.547 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7033195495605469
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.590 Vali Acc: 0.786 Test Loss: 0.590 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.667956829071045
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.587 Vali Acc: 0.775 Test Loss: 0.587 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7350261211395264
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.592 Vali Acc: 0.775 Test Loss: 0.592 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6896531581878662
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.610 Vali Acc: 0.775 Test Loss: 0.610 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7007498741149902
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.557 Vali Acc: 0.821 Test Loss: 0.557 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820804).  Saving model ...
Epoch: 30 cost time: 1.699758768081665
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.615 Vali Acc: 0.792 Test Loss: 0.615 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 117567
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.269776105880737
Epoch: 1, Steps: 17 | Train Loss: 2.026 Vali Loss: 1.956 Vali Acc: 0.173 Test Loss: 1.956 Test Acc: 0.173
Validation loss decreased (inf --> -0.173391).  Saving model ...
Epoch: 2 cost time: 2.466887950897217
Epoch: 2, Steps: 17 | Train Loss: 1.917 Vali Loss: 1.849 Vali Acc: 0.289 Test Loss: 1.849 Test Acc: 0.289
Validation loss decreased (-0.173391 --> -0.288999).  Saving model ...
Epoch: 3 cost time: 2.40303111076355
Epoch: 3, Steps: 17 | Train Loss: 1.768 Vali Loss: 1.713 Vali Acc: 0.347 Test Loss: 1.713 Test Acc: 0.347
Validation loss decreased (-0.288999 --> -0.346804).  Saving model ...
Epoch: 4 cost time: 2.443377733230591
Epoch: 4, Steps: 17 | Train Loss: 1.595 Vali Loss: 1.563 Vali Acc: 0.422 Test Loss: 1.563 Test Acc: 0.422
Validation loss decreased (-0.346804 --> -0.421950).  Saving model ...
Epoch: 5 cost time: 2.368654489517212
Epoch: 5, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.417 Vali Acc: 0.526 Test Loss: 1.417 Test Acc: 0.526
Validation loss decreased (-0.421950 --> -0.525997).  Saving model ...
Epoch: 6 cost time: 2.481112003326416
Epoch: 6, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.314 Vali Acc: 0.549 Test Loss: 1.314 Test Acc: 0.549
Validation loss decreased (-0.525997 --> -0.549120).  Saving model ...
Epoch: 7 cost time: 2.455460548400879
Epoch: 7, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.172 Vali Acc: 0.595 Test Loss: 1.172 Test Acc: 0.595
Validation loss decreased (-0.549120 --> -0.595364).  Saving model ...
Epoch: 8 cost time: 2.4496538639068604
Epoch: 8, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.082 Vali Acc: 0.642 Test Loss: 1.082 Test Acc: 0.642
Validation loss decreased (-0.595364 --> -0.641608).  Saving model ...
Epoch: 9 cost time: 2.3850624561309814
Epoch: 9, Steps: 17 | Train Loss: 0.890 Vali Loss: 1.026 Vali Acc: 0.682 Test Loss: 1.026 Test Acc: 0.682
Validation loss decreased (-0.641608 --> -0.682071).  Saving model ...
Epoch: 10 cost time: 2.485074281692505
Epoch: 10, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.902 Vali Acc: 0.723 Test Loss: 0.902 Test Acc: 0.723
Validation loss decreased (-0.682071 --> -0.722534).  Saving model ...
Epoch: 11 cost time: 2.478203535079956
Epoch: 11, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.821 Vali Acc: 0.728 Test Loss: 0.821 Test Acc: 0.728
Validation loss decreased (-0.722534 --> -0.728315).  Saving model ...
Epoch: 12 cost time: 2.4289116859436035
Epoch: 12, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.736 Vali Acc: 0.757 Test Loss: 0.736 Test Acc: 0.757
Validation loss decreased (-0.728315 --> -0.757218).  Saving model ...
Epoch: 13 cost time: 2.377755880355835
Epoch: 13, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.720 Vali Acc: 0.780 Test Loss: 0.720 Test Acc: 0.780
Validation loss decreased (-0.757218 --> -0.780340).  Saving model ...
Epoch: 14 cost time: 2.485460042953491
Epoch: 14, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.384920358657837
Epoch: 15, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.678 Vali Acc: 0.751 Test Loss: 0.678 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4777743816375732
Epoch: 16, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.620 Vali Acc: 0.780 Test Loss: 0.620 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780341).  Saving model ...
Epoch: 17 cost time: 2.575127124786377
Epoch: 17, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.572 Vali Acc: 0.780 Test Loss: 0.572 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 18 cost time: 2.5116403102874756
Epoch: 18, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.639 Vali Acc: 0.803 Test Loss: 0.639 Test Acc: 0.803
Validation loss decreased (-0.780341 --> -0.803462).  Saving model ...
Epoch: 19 cost time: 2.4760961532592773
Epoch: 19, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.548 Vali Acc: 0.798 Test Loss: 0.548 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4881958961486816
Epoch: 20, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.589 Vali Acc: 0.827 Test Loss: 0.589 Test Acc: 0.827
Validation loss decreased (-0.803462 --> -0.826584).  Saving model ...
Epoch: 21 cost time: 2.511690855026245
Epoch: 21, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.642 Vali Acc: 0.763 Test Loss: 0.642 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.532106399536133
Epoch: 22, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.596 Vali Acc: 0.792 Test Loss: 0.596 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5509634017944336
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.671 Vali Acc: 0.775 Test Loss: 0.671 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.480781078338623
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.611 Vali Acc: 0.792 Test Loss: 0.611 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.514659881591797
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.662 Vali Acc: 0.792 Test Loss: 0.662 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.642615795135498
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.650 Vali Acc: 0.775 Test Loss: 0.650 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.484379768371582
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.680 Vali Acc: 0.734 Test Loss: 0.680 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.479182004928589
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.676 Vali Acc: 0.780 Test Loss: 0.676 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.507546901702881
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.671 Vali Acc: 0.786 Test Loss: 0.671 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.5404229164123535
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.649 Vali Acc: 0.786 Test Loss: 0.649 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 177951
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.97202730178833
Epoch: 1, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.936 Vali Acc: 0.156 Test Loss: 1.936 Test Acc: 0.156
Validation loss decreased (inf --> -0.156050).  Saving model ...
Epoch: 2 cost time: 2.087327480316162
Epoch: 2, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.860 Vali Acc: 0.277 Test Loss: 1.860 Test Acc: 0.277
Validation loss decreased (-0.156050 --> -0.277438).  Saving model ...
Epoch: 3 cost time: 2.0286669731140137
Epoch: 3, Steps: 17 | Train Loss: 1.790 Vali Loss: 1.765 Vali Acc: 0.289 Test Loss: 1.765 Test Acc: 0.289
Validation loss decreased (-0.277438 --> -0.289000).  Saving model ...
Epoch: 4 cost time: 2.0281498432159424
Epoch: 4, Steps: 17 | Train Loss: 1.634 Vali Loss: 1.626 Vali Acc: 0.347 Test Loss: 1.626 Test Acc: 0.347
Validation loss decreased (-0.289000 --> -0.346805).  Saving model ...
Epoch: 5 cost time: 2.0215682983398438
Epoch: 5, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.482 Vali Acc: 0.451 Test Loss: 1.482 Test Acc: 0.451
Validation loss decreased (-0.346805 --> -0.450852).  Saving model ...
Epoch: 6 cost time: 2.033313751220703
Epoch: 6, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.357 Vali Acc: 0.503 Test Loss: 1.357 Test Acc: 0.503
Validation loss decreased (-0.450852 --> -0.502877).  Saving model ...
Epoch: 7 cost time: 2.056671619415283
Epoch: 7, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.245 Vali Acc: 0.578 Test Loss: 1.245 Test Acc: 0.578
Validation loss decreased (-0.502877 --> -0.578022).  Saving model ...
Epoch: 8 cost time: 1.9313547611236572
Epoch: 8, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.136 Vali Acc: 0.653 Test Loss: 1.136 Test Acc: 0.653
Validation loss decreased (-0.578022 --> -0.653168).  Saving model ...
Epoch: 9 cost time: 1.9738538265228271
Epoch: 9, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.101 Vali Acc: 0.590 Test Loss: 1.101 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0277481079101562
Epoch: 10, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.969 Vali Acc: 0.676 Test Loss: 0.969 Test Acc: 0.676
Validation loss decreased (-0.653168 --> -0.676291).  Saving model ...
Epoch: 11 cost time: 1.9848496913909912
Epoch: 11, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.889 Vali Acc: 0.688 Test Loss: 0.889 Test Acc: 0.688
Validation loss decreased (-0.676291 --> -0.687852).  Saving model ...
Epoch: 12 cost time: 2.1161482334136963
Epoch: 12, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.842 Vali Acc: 0.699 Test Loss: 0.842 Test Acc: 0.699
Validation loss decreased (-0.687852 --> -0.699414).  Saving model ...
Epoch: 13 cost time: 1.9668211936950684
Epoch: 13, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.759 Vali Acc: 0.757 Test Loss: 0.759 Test Acc: 0.757
Validation loss decreased (-0.699414 --> -0.757218).  Saving model ...
Epoch: 14 cost time: 2.073742151260376
Epoch: 14, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.714 Vali Acc: 0.740 Test Loss: 0.714 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.034482717514038
Epoch: 15, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.678 Vali Acc: 0.740 Test Loss: 0.678 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.94753098487854
Epoch: 16, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.691 Vali Acc: 0.763 Test Loss: 0.691 Test Acc: 0.763
Validation loss decreased (-0.757218 --> -0.762999).  Saving model ...
Epoch: 17 cost time: 1.9689347743988037
Epoch: 17, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.643 Vali Acc: 0.751 Test Loss: 0.643 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9995875358581543
Epoch: 18, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.660 Vali Acc: 0.734 Test Loss: 0.660 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9890875816345215
Epoch: 19, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.616 Vali Acc: 0.780 Test Loss: 0.616 Test Acc: 0.780
Validation loss decreased (-0.762999 --> -0.780341).  Saving model ...
Epoch: 20 cost time: 2.00380277633667
Epoch: 20, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.567 Vali Acc: 0.780 Test Loss: 0.567 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 21 cost time: 1.9882521629333496
Epoch: 21, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
Validation loss decreased (-0.780341 --> -0.803463).  Saving model ...
Epoch: 22 cost time: 1.9651565551757812
Epoch: 22, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.539 Vali Acc: 0.775 Test Loss: 0.539 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9564414024353027
Epoch: 23, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.528 Vali Acc: 0.798 Test Loss: 0.528 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9269826412200928
Epoch: 24, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.550 Vali Acc: 0.832 Test Loss: 0.550 Test Acc: 0.832
Validation loss decreased (-0.803463 --> -0.832364).  Saving model ...
Epoch: 25 cost time: 1.9568326473236084
Epoch: 25, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.638 Vali Acc: 0.746 Test Loss: 0.638 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0892579555511475
Epoch: 26, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.522 Vali Acc: 0.792 Test Loss: 0.522 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.902238368988037
Epoch: 27, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.534 Vali Acc: 0.786 Test Loss: 0.534 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0629513263702393
Epoch: 28, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.593 Vali Acc: 0.780 Test Loss: 0.593 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.050489902496338
Epoch: 29, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.686 Vali Acc: 0.751 Test Loss: 0.686 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0597386360168457
Epoch: 30, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.594 Vali Acc: 0.775 Test Loss: 0.594 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 74431
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.147305250167847
Epoch: 1, Steps: 17 | Train Loss: 2.026 Vali Loss: 1.956 Vali Acc: 0.173 Test Loss: 1.956 Test Acc: 0.173
Validation loss decreased (inf --> -0.173391).  Saving model ...
Epoch: 2 cost time: 2.365943193435669
Epoch: 2, Steps: 17 | Train Loss: 1.917 Vali Loss: 1.849 Vali Acc: 0.289 Test Loss: 1.849 Test Acc: 0.289
Validation loss decreased (-0.173391 --> -0.288999).  Saving model ...
Epoch: 3 cost time: 2.313389301300049
Epoch: 3, Steps: 17 | Train Loss: 1.768 Vali Loss: 1.713 Vali Acc: 0.347 Test Loss: 1.713 Test Acc: 0.347
Validation loss decreased (-0.288999 --> -0.346804).  Saving model ...
Epoch: 4 cost time: 2.2577199935913086
Epoch: 4, Steps: 17 | Train Loss: 1.595 Vali Loss: 1.563 Vali Acc: 0.422 Test Loss: 1.563 Test Acc: 0.422
Validation loss decreased (-0.346804 --> -0.421950).  Saving model ...
Epoch: 5 cost time: 2.2914512157440186
Epoch: 5, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.417 Vali Acc: 0.526 Test Loss: 1.417 Test Acc: 0.526
Validation loss decreased (-0.421950 --> -0.525997).  Saving model ...
Epoch: 6 cost time: 2.2634871006011963
Epoch: 6, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.314 Vali Acc: 0.549 Test Loss: 1.314 Test Acc: 0.549
Validation loss decreased (-0.525997 --> -0.549120).  Saving model ...
Epoch: 7 cost time: 2.337008237838745
Epoch: 7, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.172 Vali Acc: 0.595 Test Loss: 1.172 Test Acc: 0.595
Validation loss decreased (-0.549120 --> -0.595364).  Saving model ...
Epoch: 8 cost time: 2.3853790760040283
Epoch: 8, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.082 Vali Acc: 0.642 Test Loss: 1.082 Test Acc: 0.642
Validation loss decreased (-0.595364 --> -0.641608).  Saving model ...
Epoch: 9 cost time: 2.302778482437134
Epoch: 9, Steps: 17 | Train Loss: 0.890 Vali Loss: 1.026 Vali Acc: 0.682 Test Loss: 1.026 Test Acc: 0.682
Validation loss decreased (-0.641608 --> -0.682071).  Saving model ...
Epoch: 10 cost time: 2.2726798057556152
Epoch: 10, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.902 Vali Acc: 0.723 Test Loss: 0.902 Test Acc: 0.723
Validation loss decreased (-0.682071 --> -0.722534).  Saving model ...
Epoch: 11 cost time: 2.328084707260132
Epoch: 11, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.821 Vali Acc: 0.734 Test Loss: 0.821 Test Acc: 0.734
Validation loss decreased (-0.722534 --> -0.734096).  Saving model ...
Epoch: 12 cost time: 2.265923023223877
Epoch: 12, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.736 Vali Acc: 0.746 Test Loss: 0.736 Test Acc: 0.746
Validation loss decreased (-0.734096 --> -0.745657).  Saving model ...
Epoch: 13 cost time: 2.232903480529785
Epoch: 13, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.727 Vali Acc: 0.780 Test Loss: 0.727 Test Acc: 0.780
Validation loss decreased (-0.745657 --> -0.780340).  Saving model ...
Epoch: 14 cost time: 2.246232032775879
Epoch: 14, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.679 Vali Acc: 0.769 Test Loss: 0.679 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2256922721862793
Epoch: 15, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.674 Vali Acc: 0.757 Test Loss: 0.674 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2669553756713867
Epoch: 16, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.635 Vali Acc: 0.786 Test Loss: 0.635 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786121).  Saving model ...
Epoch: 17 cost time: 2.2558929920196533
Epoch: 17, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.563 Vali Acc: 0.798 Test Loss: 0.563 Test Acc: 0.798
Validation loss decreased (-0.786121 --> -0.797682).  Saving model ...
Epoch: 18 cost time: 2.2071993350982666
Epoch: 18, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.650 Vali Acc: 0.769 Test Loss: 0.650 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2389369010925293
Epoch: 19, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.555 Vali Acc: 0.786 Test Loss: 0.555 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.214996576309204
Epoch: 20, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.588 Vali Acc: 0.780 Test Loss: 0.588 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2632601261138916
Epoch: 21, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.650 Vali Acc: 0.763 Test Loss: 0.650 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2528445720672607
Epoch: 22, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.595 Vali Acc: 0.775 Test Loss: 0.595 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.282391309738159
Epoch: 23, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.685 Vali Acc: 0.780 Test Loss: 0.685 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1671652793884277
Epoch: 24, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.552 Vali Acc: 0.757 Test Loss: 0.552 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.198899507522583
Epoch: 25, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.677 Vali Acc: 0.780 Test Loss: 0.677 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.2254996299743652
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.641 Vali Acc: 0.769 Test Loss: 0.641 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.1736063957214355
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.719 Vali Acc: 0.751 Test Loss: 0.719 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 177951
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5589444637298584
Epoch: 1, Steps: 17 | Train Loss: 1.992 Vali Loss: 1.936 Vali Acc: 0.156 Test Loss: 1.936 Test Acc: 0.156
Validation loss decreased (inf --> -0.156050).  Saving model ...
Epoch: 2 cost time: 1.8991672992706299
Epoch: 2, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.858 Vali Acc: 0.289 Test Loss: 1.858 Test Acc: 0.289
Validation loss decreased (-0.156050 --> -0.288999).  Saving model ...
Epoch: 3 cost time: 1.8025126457214355
Epoch: 3, Steps: 17 | Train Loss: 1.786 Vali Loss: 1.758 Vali Acc: 0.306 Test Loss: 1.758 Test Acc: 0.306
Validation loss decreased (-0.288999 --> -0.306341).  Saving model ...
Epoch: 4 cost time: 1.8293261528015137
Epoch: 4, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.621 Vali Acc: 0.341 Test Loss: 1.621 Test Acc: 0.341
Validation loss decreased (-0.306341 --> -0.341024).  Saving model ...
Epoch: 5 cost time: 1.8691627979278564
Epoch: 5, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.478 Vali Acc: 0.457 Test Loss: 1.478 Test Acc: 0.457
Validation loss decreased (-0.341024 --> -0.456633).  Saving model ...
Epoch: 6 cost time: 1.9353787899017334
Epoch: 6, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.354 Vali Acc: 0.514 Test Loss: 1.354 Test Acc: 0.514
Validation loss decreased (-0.456633 --> -0.514437).  Saving model ...
Epoch: 7 cost time: 1.8727192878723145
Epoch: 7, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.241 Vali Acc: 0.578 Test Loss: 1.241 Test Acc: 0.578
Validation loss decreased (-0.514437 --> -0.578022).  Saving model ...
Epoch: 8 cost time: 1.9740445613861084
Epoch: 8, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.132 Vali Acc: 0.647 Test Loss: 1.132 Test Acc: 0.647
Validation loss decreased (-0.578022 --> -0.647388).  Saving model ...
Epoch: 9 cost time: 1.9472520351409912
Epoch: 9, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.091 Vali Acc: 0.601 Test Loss: 1.091 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8615045547485352
Epoch: 10, Steps: 17 | Train Loss: 0.795 Vali Loss: 0.963 Vali Acc: 0.688 Test Loss: 0.963 Test Acc: 0.688
Validation loss decreased (-0.647388 --> -0.687852).  Saving model ...
Epoch: 11 cost time: 1.841095209121704
Epoch: 11, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.886 Vali Acc: 0.688 Test Loss: 0.886 Test Acc: 0.688
Validation loss decreased (-0.687852 --> -0.687852).  Saving model ...
Epoch: 12 cost time: 1.8233671188354492
Epoch: 12, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.838 Vali Acc: 0.711 Test Loss: 0.838 Test Acc: 0.711
Validation loss decreased (-0.687852 --> -0.710974).  Saving model ...
Epoch: 13 cost time: 1.8977994918823242
Epoch: 13, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.757 Vali Acc: 0.751 Test Loss: 0.757 Test Acc: 0.751
Validation loss decreased (-0.710974 --> -0.751438).  Saving model ...
Epoch: 14 cost time: 1.891237497329712
Epoch: 14, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.704 Vali Acc: 0.746 Test Loss: 0.704 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8315129280090332
Epoch: 15, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.639 Vali Acc: 0.769 Test Loss: 0.639 Test Acc: 0.769
Validation loss decreased (-0.751438 --> -0.768780).  Saving model ...
Epoch: 16 cost time: 1.865417242050171
Epoch: 16, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.673 Vali Acc: 0.734 Test Loss: 0.673 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8573901653289795
Epoch: 17, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.639 Vali Acc: 0.757 Test Loss: 0.639 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.729135513305664
Epoch: 18, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.626 Vali Acc: 0.757 Test Loss: 0.626 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9066715240478516
Epoch: 19, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.553 Vali Acc: 0.763 Test Loss: 0.553 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8161306381225586
Epoch: 20, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8204450607299805
Epoch: 21, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.548 Vali Acc: 0.763 Test Loss: 0.548 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8112475872039795
Epoch: 22, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.535 Vali Acc: 0.763 Test Loss: 0.535 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7412669658660889
Epoch: 23, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.574 Vali Acc: 0.763 Test Loss: 0.574 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7081193923950195
Epoch: 24, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
Validation loss decreased (-0.768780 --> -0.803463).  Saving model ...
Epoch: 25 cost time: 1.8828775882720947
Epoch: 25, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.643 Vali Acc: 0.775 Test Loss: 0.643 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.847501516342163
Epoch: 26, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.563 Vali Acc: 0.769 Test Loss: 0.563 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8007774353027344
Epoch: 27, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.597 Vali Acc: 0.751 Test Loss: 0.597 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8255510330200195
Epoch: 28, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.647 Vali Acc: 0.740 Test Loss: 0.647 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7817103862762451
Epoch: 29, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.692 Vali Acc: 0.734 Test Loss: 0.692 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8102350234985352
Epoch: 30, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.531 Vali Acc: 0.780 Test Loss: 0.531 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 74431
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.434919595718384
Epoch: 1, Steps: 17 | Train Loss: 2.025 Vali Loss: 1.956 Vali Acc: 0.173 Test Loss: 1.956 Test Acc: 0.173
Validation loss decreased (inf --> -0.173391).  Saving model ...
Epoch: 2 cost time: 1.9500319957733154
Epoch: 2, Steps: 17 | Train Loss: 1.918 Vali Loss: 1.849 Vali Acc: 0.289 Test Loss: 1.849 Test Acc: 0.289
Validation loss decreased (-0.173391 --> -0.288999).  Saving model ...
Epoch: 3 cost time: 1.9002552032470703
Epoch: 3, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.713 Vali Acc: 0.347 Test Loss: 1.713 Test Acc: 0.347
Validation loss decreased (-0.288999 --> -0.346804).  Saving model ...
Epoch: 4 cost time: 1.8794596195220947
Epoch: 4, Steps: 17 | Train Loss: 1.596 Vali Loss: 1.564 Vali Acc: 0.422 Test Loss: 1.564 Test Acc: 0.422
Validation loss decreased (-0.346804 --> -0.421950).  Saving model ...
Epoch: 5 cost time: 1.8934457302093506
Epoch: 5, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.417 Vali Acc: 0.538 Test Loss: 1.417 Test Acc: 0.538
Validation loss decreased (-0.421950 --> -0.537558).  Saving model ...
Epoch: 6 cost time: 1.8765902519226074
Epoch: 6, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.314 Vali Acc: 0.549 Test Loss: 1.314 Test Acc: 0.549
Validation loss decreased (-0.537558 --> -0.549120).  Saving model ...
Epoch: 7 cost time: 1.8765606880187988
Epoch: 7, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.172 Vali Acc: 0.595 Test Loss: 1.172 Test Acc: 0.595
Validation loss decreased (-0.549120 --> -0.595364).  Saving model ...
Epoch: 8 cost time: 2.021043300628662
Epoch: 8, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.082 Vali Acc: 0.642 Test Loss: 1.082 Test Acc: 0.642
Validation loss decreased (-0.595364 --> -0.641608).  Saving model ...
Epoch: 9 cost time: 1.8560478687286377
Epoch: 9, Steps: 17 | Train Loss: 0.891 Vali Loss: 1.026 Vali Acc: 0.694 Test Loss: 1.026 Test Acc: 0.694
Validation loss decreased (-0.641608 --> -0.693631).  Saving model ...
Epoch: 10 cost time: 1.874488353729248
Epoch: 10, Steps: 17 | Train Loss: 0.745 Vali Loss: 0.901 Vali Acc: 0.723 Test Loss: 0.901 Test Acc: 0.723
Validation loss decreased (-0.693631 --> -0.722534).  Saving model ...
Epoch: 11 cost time: 2.018383026123047
Epoch: 11, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.823 Vali Acc: 0.746 Test Loss: 0.823 Test Acc: 0.746
Validation loss decreased (-0.722534 --> -0.745657).  Saving model ...
Epoch: 12 cost time: 1.8829190731048584
Epoch: 12, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.729 Vali Acc: 0.740 Test Loss: 0.729 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9009442329406738
Epoch: 13, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.723 Vali Acc: 0.769 Test Loss: 0.723 Test Acc: 0.769
Validation loss decreased (-0.745657 --> -0.768779).  Saving model ...
Epoch: 14 cost time: 1.8738124370574951
Epoch: 14, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.678 Vali Acc: 0.746 Test Loss: 0.678 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8958425521850586
Epoch: 15, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.706 Vali Acc: 0.723 Test Loss: 0.706 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9270567893981934
Epoch: 16, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.604 Vali Acc: 0.780 Test Loss: 0.604 Test Acc: 0.780
Validation loss decreased (-0.768779 --> -0.780341).  Saving model ...
Epoch: 17 cost time: 1.878685474395752
Epoch: 17, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.566 Vali Acc: 0.798 Test Loss: 0.566 Test Acc: 0.798
Validation loss decreased (-0.780341 --> -0.797682).  Saving model ...
Epoch: 18 cost time: 1.9746263027191162
Epoch: 18, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.636 Vali Acc: 0.775 Test Loss: 0.636 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7673320770263672
Epoch: 19, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.519 Vali Acc: 0.821 Test Loss: 0.519 Test Acc: 0.821
Validation loss decreased (-0.797682 --> -0.820804).  Saving model ...
Epoch: 20 cost time: 1.8841261863708496
Epoch: 20, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.583 Vali Acc: 0.798 Test Loss: 0.583 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.056928873062134
Epoch: 21, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.614 Vali Acc: 0.769 Test Loss: 0.614 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9334132671356201
Epoch: 22, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.568 Vali Acc: 0.798 Test Loss: 0.568 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9562993049621582
Epoch: 23, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.639 Vali Acc: 0.786 Test Loss: 0.639 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8796603679656982
Epoch: 24, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.640 Vali Acc: 0.763 Test Loss: 0.640 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9154913425445557
Epoch: 25, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.645 Vali Acc: 0.780 Test Loss: 0.645 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8939330577850342
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.659 Vali Acc: 0.769 Test Loss: 0.659 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8921310901641846
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.604 Vali Acc: 0.786 Test Loss: 0.604 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.178964853286743
Epoch: 28, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.646 Vali Acc: 0.763 Test Loss: 0.646 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9864120483398438
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.639 Vali Acc: 0.751 Test Loss: 0.639 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 177951
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3194570541381836
Epoch: 1, Steps: 17 | Train Loss: 1.991 Vali Loss: 1.937 Vali Acc: 0.156 Test Loss: 1.937 Test Acc: 0.156
Validation loss decreased (inf --> -0.156050).  Saving model ...
Epoch: 2 cost time: 1.6524584293365479
Epoch: 2, Steps: 17 | Train Loss: 1.895 Vali Loss: 1.855 Vali Acc: 0.283 Test Loss: 1.855 Test Acc: 0.283
Validation loss decreased (-0.156050 --> -0.283218).  Saving model ...
Epoch: 3 cost time: 1.723379135131836
Epoch: 3, Steps: 17 | Train Loss: 1.784 Vali Loss: 1.757 Vali Acc: 0.306 Test Loss: 1.757 Test Acc: 0.306
Validation loss decreased (-0.283218 --> -0.306341).  Saving model ...
Epoch: 4 cost time: 1.7052671909332275
Epoch: 4, Steps: 17 | Train Loss: 1.626 Vali Loss: 1.617 Vali Acc: 0.341 Test Loss: 1.617 Test Acc: 0.341
Validation loss decreased (-0.306341 --> -0.341024).  Saving model ...
Epoch: 5 cost time: 1.7587642669677734
Epoch: 5, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.478 Vali Acc: 0.457 Test Loss: 1.478 Test Acc: 0.457
Validation loss decreased (-0.341024 --> -0.456633).  Saving model ...
Epoch: 6 cost time: 1.7244236469268799
Epoch: 6, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.352 Vali Acc: 0.532 Test Loss: 1.352 Test Acc: 0.532
Validation loss decreased (-0.456633 --> -0.531778).  Saving model ...
Epoch: 7 cost time: 1.7186729907989502
Epoch: 7, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.239 Vali Acc: 0.590 Test Loss: 1.239 Test Acc: 0.590
Validation loss decreased (-0.531778 --> -0.589583).  Saving model ...
Epoch: 8 cost time: 1.6980607509613037
Epoch: 8, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.131 Vali Acc: 0.659 Test Loss: 1.131 Test Acc: 0.659
Validation loss decreased (-0.589583 --> -0.658948).  Saving model ...
Epoch: 9 cost time: 1.7810752391815186
Epoch: 9, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.085 Vali Acc: 0.601 Test Loss: 1.085 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6913337707519531
Epoch: 10, Steps: 17 | Train Loss: 0.794 Vali Loss: 0.964 Vali Acc: 0.682 Test Loss: 0.964 Test Acc: 0.682
Validation loss decreased (-0.658948 --> -0.682071).  Saving model ...
Epoch: 11 cost time: 1.667757272720337
Epoch: 11, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.887 Vali Acc: 0.694 Test Loss: 0.887 Test Acc: 0.694
Validation loss decreased (-0.682071 --> -0.693633).  Saving model ...
Epoch: 12 cost time: 1.619255542755127
Epoch: 12, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.837 Vali Acc: 0.705 Test Loss: 0.837 Test Acc: 0.705
Validation loss decreased (-0.693633 --> -0.705194).  Saving model ...
Epoch: 13 cost time: 1.6680338382720947
Epoch: 13, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.755 Vali Acc: 0.757 Test Loss: 0.755 Test Acc: 0.757
Validation loss decreased (-0.705194 --> -0.757218).  Saving model ...
Epoch: 14 cost time: 1.7229905128479004
Epoch: 14, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.714 Vali Acc: 0.746 Test Loss: 0.714 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6519646644592285
Epoch: 15, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.660 Vali Acc: 0.751 Test Loss: 0.660 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6839265823364258
Epoch: 16, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.662 Vali Acc: 0.757 Test Loss: 0.662 Test Acc: 0.757
Validation loss decreased (-0.757218 --> -0.757219).  Saving model ...
Epoch: 17 cost time: 1.6358740329742432
Epoch: 17, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.617 Vali Acc: 0.775 Test Loss: 0.617 Test Acc: 0.775
Validation loss decreased (-0.757219 --> -0.774560).  Saving model ...
Epoch: 18 cost time: 1.7301216125488281
Epoch: 18, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.626 Vali Acc: 0.734 Test Loss: 0.626 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6673550605773926
Epoch: 19, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.586 Vali Acc: 0.769 Test Loss: 0.586 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6791348457336426
Epoch: 20, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.569 Vali Acc: 0.775 Test Loss: 0.569 Test Acc: 0.775
Validation loss decreased (-0.774560 --> -0.774561).  Saving model ...
Epoch: 21 cost time: 1.6512219905853271
Epoch: 21, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.564 Vali Acc: 0.780 Test Loss: 0.564 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 22 cost time: 1.677055835723877
Epoch: 22, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.536 Vali Acc: 0.798 Test Loss: 0.536 Test Acc: 0.798
Validation loss decreased (-0.780341 --> -0.797683).  Saving model ...
Epoch: 23 cost time: 1.6508078575134277
Epoch: 23, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.564 Vali Acc: 0.775 Test Loss: 0.564 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6755430698394775
Epoch: 24, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.529 Vali Acc: 0.798 Test Loss: 0.529 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 25 cost time: 1.6999156475067139
Epoch: 25, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.600 Vali Acc: 0.769 Test Loss: 0.600 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6184656620025635
Epoch: 26, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.588 Vali Acc: 0.740 Test Loss: 0.588 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.601330280303955
Epoch: 27, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.539 Vali Acc: 0.780 Test Loss: 0.539 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.596933126449585
Epoch: 28, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.617 Vali Acc: 0.775 Test Loss: 0.617 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.626924753189087
Epoch: 29, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.658 Vali Acc: 0.751 Test Loss: 0.658 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6642076969146729
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.563 Vali Acc: 0.769 Test Loss: 0.563 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 74431
model size : 0.45MB
