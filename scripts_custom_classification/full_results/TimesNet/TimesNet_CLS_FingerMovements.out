Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 14.840846538543701
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.782 Vali Acc: 0.470 Test Loss: 0.782 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 13.591058254241943
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.692 Vali Acc: 0.530 Test Loss: 0.692 Test Acc: 0.530
Validation loss decreased (-0.469992 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 12.985705375671387
Epoch: 3, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.547096490859985
Epoch: 4, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.804 Vali Acc: 0.520 Test Loss: 0.804 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.91805911064148
Epoch: 5, Steps: 20 | Train Loss: 0.555 Vali Loss: 1.058 Vali Acc: 0.500 Test Loss: 1.058 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.449742078781128
Epoch: 6, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.916 Vali Acc: 0.500 Test Loss: 0.916 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 17.539746522903442
Epoch: 7, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.755 Vali Acc: 0.560 Test Loss: 0.755 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 15.042659997940063
Epoch: 8, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.855217933654785
Epoch: 9, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.946 Vali Acc: 0.490 Test Loss: 0.946 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.6136736869812
Epoch: 10, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.858 Vali Acc: 0.540 Test Loss: 0.858 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.646255731582642
Epoch: 11, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.919 Vali Acc: 0.540 Test Loss: 0.919 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 15.349868059158325
Epoch: 12, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.185 Vali Acc: 0.520 Test Loss: 1.185 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.766905307769775
Epoch: 13, Steps: 20 | Train Loss: 0.346 Vali Loss: 1.025 Vali Acc: 0.470 Test Loss: 1.025 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 16.37893581390381
Epoch: 14, Steps: 20 | Train Loss: 0.383 Vali Loss: 1.425 Vali Acc: 0.550 Test Loss: 1.425 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 14.866588592529297
Epoch: 15, Steps: 20 | Train Loss: 0.350 Vali Loss: 1.187 Vali Acc: 0.530 Test Loss: 1.187 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 17.669533014297485
Epoch: 16, Steps: 20 | Train Loss: 0.399 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 16.763603687286377
Epoch: 17, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.370 Vali Acc: 0.470 Test Loss: 1.370 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 75006722
model size : 288.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.65489387512207
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.710 Vali Acc: 0.420 Test Loss: 0.710 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 5.418444871902466
Epoch: 2, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
Validation loss decreased (-0.419993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 5.4701831340789795
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.732 Vali Acc: 0.600 Test Loss: 0.732 Test Acc: 0.600
Validation loss decreased (-0.509992 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 5.002907037734985
Epoch: 4, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.829 Vali Acc: 0.480 Test Loss: 0.829 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.53011155128479
Epoch: 5, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.4253089427948
Epoch: 6, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.871 Vali Acc: 0.430 Test Loss: 0.871 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.619818449020386
Epoch: 7, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.900 Vali Acc: 0.510 Test Loss: 0.900 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.429205417633057
Epoch: 8, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.975 Vali Acc: 0.540 Test Loss: 0.975 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.322359085083008
Epoch: 9, Steps: 20 | Train Loss: 0.475 Vali Loss: 1.101 Vali Acc: 0.490 Test Loss: 1.101 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.405712127685547
Epoch: 10, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.883 Vali Acc: 0.570 Test Loss: 0.883 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.369122266769409
Epoch: 11, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.071 Vali Acc: 0.530 Test Loss: 1.071 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.373146295547485
Epoch: 12, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.109 Vali Acc: 0.450 Test Loss: 1.109 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.486863136291504
Epoch: 13, Steps: 20 | Train Loss: 0.347 Vali Loss: 1.252 Vali Acc: 0.450 Test Loss: 1.252 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 22050562
model size : 86.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 13.620869874954224
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.777 Vali Acc: 0.470 Test Loss: 0.777 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 12.457791805267334
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (-0.469992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 10.545793294906616
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.673 Vali Acc: 0.560 Test Loss: 0.673 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 12.434449911117554
Epoch: 4, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.491039991378784
Epoch: 5, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.952 Vali Acc: 0.490 Test Loss: 0.952 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.475314378738403
Epoch: 6, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.805 Vali Acc: 0.500 Test Loss: 0.805 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.498095512390137
Epoch: 7, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.684 Vali Acc: 0.600 Test Loss: 0.684 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 8 cost time: 12.724491357803345
Epoch: 8, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.718 Vali Acc: 0.580 Test Loss: 0.718 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.65696668624878
Epoch: 9, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.807 Vali Acc: 0.620 Test Loss: 0.807 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619992).  Saving model ...
Epoch: 10 cost time: 11.29700779914856
Epoch: 10, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.796 Vali Acc: 0.570 Test Loss: 0.796 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.694865226745605
Epoch: 11, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.914 Vali Acc: 0.550 Test Loss: 0.914 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.525729894638062
Epoch: 12, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.222 Vali Acc: 0.540 Test Loss: 1.222 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.815771102905273
Epoch: 13, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.971 Vali Acc: 0.500 Test Loss: 0.971 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.021318912506104
Epoch: 14, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.001 Vali Acc: 0.590 Test Loss: 1.001 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.725200414657593
Epoch: 15, Steps: 20 | Train Loss: 0.289 Vali Loss: 1.088 Vali Acc: 0.560 Test Loss: 1.088 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 11.917714834213257
Epoch: 16, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.120 Vali Acc: 0.540 Test Loss: 1.120 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 12.609230279922485
Epoch: 17, Steps: 20 | Train Loss: 0.383 Vali Loss: 1.008 Vali Acc: 0.560 Test Loss: 1.008 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 12.885231733322144
Epoch: 18, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.132 Vali Acc: 0.530 Test Loss: 1.132 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.825972318649292
Epoch: 19, Steps: 20 | Train Loss: 0.173 Vali Loss: 1.183 Vali Acc: 0.540 Test Loss: 1.183 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 75006722
model size : 288.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.229988098144531
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.709 Vali Acc: 0.440 Test Loss: 0.709 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 3.971064329147339
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
Validation loss decreased (-0.439993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 3.9207122325897217
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.711 Vali Acc: 0.610 Test Loss: 0.711 Test Acc: 0.610
Validation loss decreased (-0.499992 --> -0.609993).  Saving model ...
Epoch: 4 cost time: 3.183180809020996
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.787 Vali Acc: 0.460 Test Loss: 0.787 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3085052967071533
Epoch: 5, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1877408027648926
Epoch: 6, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.779 Vali Acc: 0.420 Test Loss: 0.779 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.3383712768554688
Epoch: 7, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.796 Vali Acc: 0.520 Test Loss: 0.796 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.4813454151153564
Epoch: 8, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.779 Vali Acc: 0.550 Test Loss: 0.779 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.9583075046539307
Epoch: 9, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.942 Vali Acc: 0.530 Test Loss: 0.942 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.9709980487823486
Epoch: 10, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.931 Vali Acc: 0.550 Test Loss: 0.931 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.961418867111206
Epoch: 11, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.894 Vali Acc: 0.550 Test Loss: 0.894 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.015463352203369
Epoch: 12, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.878 Vali Acc: 0.510 Test Loss: 0.878 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.941549777984619
Epoch: 13, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.154 Vali Acc: 0.480 Test Loss: 1.154 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 22050562
model size : 86.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.6996588706970215
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.778 Vali Acc: 0.470 Test Loss: 0.778 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 4.82606315612793
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.696 Vali Acc: 0.540 Test Loss: 0.696 Test Acc: 0.540
Validation loss decreased (-0.469992 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 4.887996673583984
Epoch: 3, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.681 Vali Acc: 0.550 Test Loss: 0.681 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 5.214912176132202
Epoch: 4, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.758 Vali Acc: 0.510 Test Loss: 0.758 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.067970514297485
Epoch: 5, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.987 Vali Acc: 0.490 Test Loss: 0.987 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.019510746002197
Epoch: 6, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.856 Vali Acc: 0.500 Test Loss: 0.856 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.946506023406982
Epoch: 7, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.674 Vali Acc: 0.600 Test Loss: 0.674 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 8 cost time: 5.318126440048218
Epoch: 8, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.714 Vali Acc: 0.580 Test Loss: 0.714 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.363966464996338
Epoch: 9, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.809 Vali Acc: 0.590 Test Loss: 0.809 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.09925389289856
Epoch: 10, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.776 Vali Acc: 0.590 Test Loss: 0.776 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.283261299133301
Epoch: 11, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.854 Vali Acc: 0.570 Test Loss: 0.854 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.1764748096466064
Epoch: 12, Steps: 20 | Train Loss: 0.370 Vali Loss: 1.117 Vali Acc: 0.540 Test Loss: 1.117 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.433278560638428
Epoch: 13, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.887 Vali Acc: 0.570 Test Loss: 0.887 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.471930027008057
Epoch: 14, Steps: 20 | Train Loss: 0.367 Vali Loss: 0.973 Vali Acc: 0.530 Test Loss: 0.973 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.660398244857788
Epoch: 15, Steps: 20 | Train Loss: 0.304 Vali Loss: 0.955 Vali Acc: 0.540 Test Loss: 0.955 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.355240345001221
Epoch: 16, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.037 Vali Acc: 0.500 Test Loss: 1.037 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.265462398529053
Epoch: 17, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.108 Vali Acc: 0.570 Test Loss: 1.108 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 75006722
model size : 288.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.353025197982788
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.707 Vali Acc: 0.440 Test Loss: 0.707 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.335972785949707
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.762 Vali Acc: 0.510 Test Loss: 0.762 Test Acc: 0.510
Validation loss decreased (-0.439993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 2.357828140258789
Epoch: 3, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.713 Vali Acc: 0.610 Test Loss: 0.713 Test Acc: 0.610
Validation loss decreased (-0.509992 --> -0.609993).  Saving model ...
Epoch: 4 cost time: 2.319169759750366
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.776 Vali Acc: 0.450 Test Loss: 0.776 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.31905460357666
Epoch: 5, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3469560146331787
Epoch: 6, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.780 Vali Acc: 0.450 Test Loss: 0.780 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0330278873443604
Epoch: 7, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.117565393447876
Epoch: 8, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.785 Vali Acc: 0.550 Test Loss: 0.785 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.037933349609375
Epoch: 9, Steps: 20 | Train Loss: 0.499 Vali Loss: 1.017 Vali Acc: 0.490 Test Loss: 1.017 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0806212425231934
Epoch: 10, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.906 Vali Acc: 0.510 Test Loss: 0.906 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.303048610687256
Epoch: 11, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.909 Vali Acc: 0.530 Test Loss: 0.909 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4033772945404053
Epoch: 12, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.792 Vali Acc: 0.490 Test Loss: 0.792 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3050382137298584
Epoch: 13, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.095 Vali Acc: 0.490 Test Loss: 1.095 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 22050562
model size : 86.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.676079273223877
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 7.765068769454956
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.773 Vali Acc: 0.480 Test Loss: 0.773 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 8.512285470962524
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 8.311087846755981
Epoch: 4, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 7.356234073638916
Epoch: 5, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.074726104736328
Epoch: 6, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.848 Vali Acc: 0.540 Test Loss: 0.848 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.32362699508667
Epoch: 7, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.811 Vali Acc: 0.580 Test Loss: 0.811 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579992).  Saving model ...
Epoch: 8 cost time: 8.378638505935669
Epoch: 8, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.775 Vali Acc: 0.550 Test Loss: 0.775 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.357341527938843
Epoch: 9, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.857 Vali Acc: 0.540 Test Loss: 0.857 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.513473033905029
Epoch: 10, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.981 Vali Acc: 0.520 Test Loss: 0.981 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.559945106506348
Epoch: 11, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.996 Vali Acc: 0.530 Test Loss: 0.996 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.536963939666748
Epoch: 12, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.028 Vali Acc: 0.510 Test Loss: 1.028 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.585209608078003
Epoch: 13, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.404 Vali Acc: 0.490 Test Loss: 1.404 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.395564794540405
Epoch: 14, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.181 Vali Acc: 0.510 Test Loss: 1.181 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.382753372192383
Epoch: 15, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.055 Vali Acc: 0.530 Test Loss: 1.055 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.529644966125488
Epoch: 16, Steps: 20 | Train Loss: 0.299 Vali Loss: 1.265 Vali Acc: 0.480 Test Loss: 1.265 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.234382390975952
Epoch: 17, Steps: 20 | Train Loss: 0.258 Vali Loss: 1.325 Vali Acc: 0.540 Test Loss: 1.325 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 37517058
model size : 145.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.131575584411621
Epoch: 1, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.8891046047210693
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 2.894892930984497
Epoch: 3, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.814 Vali Acc: 0.490 Test Loss: 0.814 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.999178409576416
Epoch: 4, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 2.4487767219543457
Epoch: 5, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6297550201416016
Epoch: 6, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.849 Vali Acc: 0.600 Test Loss: 0.849 Test Acc: 0.600
Validation loss decreased (-0.509993 --> -0.599992).  Saving model ...
Epoch: 7 cost time: 2.5949342250823975
Epoch: 7, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.847 Vali Acc: 0.480 Test Loss: 0.847 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6156084537506104
Epoch: 8, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.890 Vali Acc: 0.540 Test Loss: 0.890 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9137187004089355
Epoch: 9, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.872 Vali Acc: 0.530 Test Loss: 0.872 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.898592233657837
Epoch: 10, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.880 Vali Acc: 0.540 Test Loss: 0.880 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8932015895843506
Epoch: 11, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.120 Vali Acc: 0.520 Test Loss: 1.120 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8784775733947754
Epoch: 12, Steps: 20 | Train Loss: 0.272 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.8712780475616455
Epoch: 13, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.036 Vali Acc: 0.560 Test Loss: 1.036 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8813636302948
Epoch: 14, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.091 Vali Acc: 0.590 Test Loss: 1.091 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5955865383148193
Epoch: 15, Steps: 20 | Train Loss: 0.220 Vali Loss: 1.219 Vali Acc: 0.580 Test Loss: 1.219 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6959192752838135
Epoch: 16, Steps: 20 | Train Loss: 0.173 Vali Loss: 1.301 Vali Acc: 0.540 Test Loss: 1.301 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 11038466
model size : 44.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.184468030929565
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 6.013425588607788
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.766 Vali Acc: 0.470 Test Loss: 0.766 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.238855838775635
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.709 Vali Acc: 0.520 Test Loss: 0.709 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 5.227377653121948
Epoch: 4, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.736 Vali Acc: 0.560 Test Loss: 0.736 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 5.8505120277404785
Epoch: 5, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.751 Vali Acc: 0.590 Test Loss: 0.751 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589992).  Saving model ...
Epoch: 6 cost time: 5.9855029582977295
Epoch: 6, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.772 Vali Acc: 0.570 Test Loss: 0.772 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.894969463348389
Epoch: 7, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.790 Vali Acc: 0.510 Test Loss: 0.790 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.314961671829224
Epoch: 8, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.709 Vali Acc: 0.580 Test Loss: 0.709 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.106247901916504
Epoch: 9, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.856 Vali Acc: 0.540 Test Loss: 0.856 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.967225551605225
Epoch: 10, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.801 Vali Acc: 0.580 Test Loss: 0.801 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.699581623077393
Epoch: 11, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.940 Vali Acc: 0.510 Test Loss: 0.940 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.657015085220337
Epoch: 12, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.865 Vali Acc: 0.540 Test Loss: 0.865 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.000378131866455
Epoch: 13, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.020 Vali Acc: 0.500 Test Loss: 1.020 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.434639930725098
Epoch: 14, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.146 Vali Acc: 0.550 Test Loss: 1.146 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.175365209579468
Epoch: 15, Steps: 20 | Train Loss: 0.254 Vali Loss: 1.064 Vali Acc: 0.500 Test Loss: 1.064 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 37517058
model size : 145.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6112565994262695
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.294623851776123
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.267653226852417
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.809 Vali Acc: 0.500 Test Loss: 0.809 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8948488235473633
Epoch: 4, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.713 Vali Acc: 0.550 Test Loss: 0.713 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 2.049649953842163
Epoch: 5, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8945379257202148
Epoch: 6, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.789 Vali Acc: 0.630 Test Loss: 0.789 Test Acc: 0.630
Validation loss decreased (-0.549993 --> -0.629992).  Saving model ...
Epoch: 7 cost time: 2.0246686935424805
Epoch: 7, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.842 Vali Acc: 0.480 Test Loss: 0.842 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.069389820098877
Epoch: 8, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.891 Vali Acc: 0.520 Test Loss: 0.891 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3149683475494385
Epoch: 9, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.796 Vali Acc: 0.520 Test Loss: 0.796 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2742300033569336
Epoch: 10, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.761 Vali Acc: 0.580 Test Loss: 0.761 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.294666051864624
Epoch: 11, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.960 Vali Acc: 0.530 Test Loss: 0.960 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.302612781524658
Epoch: 12, Steps: 20 | Train Loss: 0.394 Vali Loss: 0.834 Vali Acc: 0.550 Test Loss: 0.834 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2419724464416504
Epoch: 13, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.899 Vali Acc: 0.570 Test Loss: 0.899 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2624847888946533
Epoch: 14, Steps: 20 | Train Loss: 0.323 Vali Loss: 0.945 Vali Acc: 0.570 Test Loss: 0.945 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.001674175262451
Epoch: 15, Steps: 20 | Train Loss: 0.296 Vali Loss: 0.969 Vali Acc: 0.570 Test Loss: 0.969 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.020385265350342
Epoch: 16, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.083 Vali Acc: 0.590 Test Loss: 1.083 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 11038466
model size : 44.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.6979405879974365
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 3.562574625015259
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5239412784576416
Epoch: 3, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 3.1824238300323486
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.738 Vali Acc: 0.560 Test Loss: 0.738 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 3.195101499557495
Epoch: 5, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.740 Vali Acc: 0.570 Test Loss: 0.740 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 3.3169493675231934
Epoch: 6, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.746 Vali Acc: 0.580 Test Loss: 0.746 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 7 cost time: 3.5874733924865723
Epoch: 7, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.772 Vali Acc: 0.530 Test Loss: 0.772 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5878734588623047
Epoch: 8, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.703 Vali Acc: 0.580 Test Loss: 0.703 Test Acc: 0.580
Validation loss decreased (-0.579993 --> -0.579993).  Saving model ...
Epoch: 9 cost time: 3.5978353023529053
Epoch: 9, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.882 Vali Acc: 0.540 Test Loss: 0.882 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.608720064163208
Epoch: 10, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.809 Vali Acc: 0.570 Test Loss: 0.809 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1398215293884277
Epoch: 11, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.943 Vali Acc: 0.520 Test Loss: 0.943 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0670905113220215
Epoch: 12, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.873 Vali Acc: 0.520 Test Loss: 0.873 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.25986647605896
Epoch: 13, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.021 Vali Acc: 0.500 Test Loss: 1.021 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.357030153274536
Epoch: 14, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.091 Vali Acc: 0.560 Test Loss: 1.091 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.554450273513794
Epoch: 15, Steps: 20 | Train Loss: 0.277 Vali Loss: 1.057 Vali Acc: 0.520 Test Loss: 1.057 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.6790266036987305
Epoch: 16, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.136 Vali Acc: 0.520 Test Loss: 1.136 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.667022943496704
Epoch: 17, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.436 Vali Acc: 0.520 Test Loss: 1.436 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.7539024353027344
Epoch: 18, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 37517058
model size : 145.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7738804817199707
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.5852375030517578
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5011954307556152
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.806 Vali Acc: 0.510 Test Loss: 0.806 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.557844638824463
Epoch: 4, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.713 Vali Acc: 0.560 Test Loss: 0.713 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 1.5630438327789307
Epoch: 5, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.703 Vali Acc: 0.530 Test Loss: 0.703 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5352766513824463
Epoch: 6, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.813 Vali Acc: 0.620 Test Loss: 0.813 Test Acc: 0.620
Validation loss decreased (-0.559993 --> -0.619992).  Saving model ...
Epoch: 7 cost time: 1.5249767303466797
Epoch: 7, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.830 Vali Acc: 0.490 Test Loss: 0.830 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.428652048110962
Epoch: 8, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.912 Vali Acc: 0.490 Test Loss: 0.912 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4081194400787354
Epoch: 9, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.831 Vali Acc: 0.540 Test Loss: 0.831 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3413984775543213
Epoch: 10, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.820 Vali Acc: 0.600 Test Loss: 0.820 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4192392826080322
Epoch: 11, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.877 Vali Acc: 0.550 Test Loss: 0.877 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.348404884338379
Epoch: 12, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.839 Vali Acc: 0.540 Test Loss: 0.839 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2876293659210205
Epoch: 13, Steps: 20 | Train Loss: 0.395 Vali Loss: 0.866 Vali Acc: 0.550 Test Loss: 0.866 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4078526496887207
Epoch: 14, Steps: 20 | Train Loss: 0.326 Vali Loss: 0.927 Vali Acc: 0.540 Test Loss: 0.927 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2429468631744385
Epoch: 15, Steps: 20 | Train Loss: 0.305 Vali Loss: 0.977 Vali Acc: 0.490 Test Loss: 0.977 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2876415252685547
Epoch: 16, Steps: 20 | Train Loss: 0.274 Vali Loss: 1.008 Vali Acc: 0.620 Test Loss: 1.008 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 11038466
model size : 44.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 9.084154605865479
Epoch: 1, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 10.607434511184692
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.722 Vali Acc: 0.530 Test Loss: 0.722 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 10.15924859046936
Epoch: 3, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.769 Vali Acc: 0.450 Test Loss: 0.769 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.08358359336853
Epoch: 4, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.510860204696655
Epoch: 5, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.837 Vali Acc: 0.480 Test Loss: 0.837 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.603601217269897
Epoch: 6, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.825 Vali Acc: 0.480 Test Loss: 0.825 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.560417890548706
Epoch: 7, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.878 Vali Acc: 0.520 Test Loss: 0.878 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.237457513809204
Epoch: 8, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.753 Vali Acc: 0.570 Test Loss: 0.753 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569992).  Saving model ...
Epoch: 9 cost time: 10.783286571502686
Epoch: 9, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.834 Vali Acc: 0.470 Test Loss: 0.834 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.79342794418335
Epoch: 10, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.898 Vali Acc: 0.490 Test Loss: 0.898 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.191442251205444
Epoch: 11, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.843 Vali Acc: 0.520 Test Loss: 0.843 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.537987232208252
Epoch: 12, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.934 Vali Acc: 0.460 Test Loss: 0.934 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.667005062103271
Epoch: 13, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.895 Vali Acc: 0.510 Test Loss: 0.895 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.637904405593872
Epoch: 14, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.993 Vali Acc: 0.550 Test Loss: 0.993 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.001665830612183
Epoch: 15, Steps: 20 | Train Loss: 0.368 Vali Loss: 1.041 Vali Acc: 0.520 Test Loss: 1.041 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.002125978469849
Epoch: 16, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.025 Vali Acc: 0.500 Test Loss: 1.025 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.829139232635498
Epoch: 17, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.072 Vali Acc: 0.500 Test Loss: 1.072 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.13519287109375
Epoch: 18, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 37506434
model size : 144.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.804855585098267
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.722 Vali Acc: 0.470 Test Loss: 0.722 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 3.582106351852417
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 3.6353566646575928
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.680 Vali Acc: 0.540 Test Loss: 0.680 Test Acc: 0.540
Validation loss decreased (-0.479993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 3.175935745239258
Epoch: 4, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.709 Vali Acc: 0.510 Test Loss: 0.709 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.17745304107666
Epoch: 5, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.694 Vali Acc: 0.580 Test Loss: 0.694 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 3.25287127494812
Epoch: 6, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.796 Vali Acc: 0.470 Test Loss: 0.796 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.652710437774658
Epoch: 7, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.714 Vali Acc: 0.560 Test Loss: 0.714 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.692251443862915
Epoch: 8, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6463711261749268
Epoch: 9, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.6735169887542725
Epoch: 10, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.902 Vali Acc: 0.520 Test Loss: 0.902 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.5280909538269043
Epoch: 11, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.1000499725341797
Epoch: 12, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.811 Vali Acc: 0.560 Test Loss: 0.811 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.9510245323181152
Epoch: 13, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.833 Vali Acc: 0.550 Test Loss: 0.833 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.070448875427246
Epoch: 14, Steps: 20 | Train Loss: 0.358 Vali Loss: 0.855 Vali Acc: 0.520 Test Loss: 0.855 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.520421266555786
Epoch: 15, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.043 Vali Acc: 0.530 Test Loss: 1.043 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 11027330
model size : 43.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.743419647216797
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.710 Vali Acc: 0.480 Test Loss: 0.710 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 6.38204026222229
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 7.597453832626343
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.735 Vali Acc: 0.440 Test Loss: 0.735 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.586528778076172
Epoch: 4, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.720 Vali Acc: 0.520 Test Loss: 0.720 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.616812705993652
Epoch: 5, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.778 Vali Acc: 0.490 Test Loss: 0.778 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.484664678573608
Epoch: 6, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 7 cost time: 6.475902080535889
Epoch: 7, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.899 Vali Acc: 0.540 Test Loss: 0.899 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.430619478225708
Epoch: 8, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 7.44046688079834
Epoch: 9, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.794 Vali Acc: 0.470 Test Loss: 0.794 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.508265972137451
Epoch: 10, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.611515283584595
Epoch: 11, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.856 Vali Acc: 0.530 Test Loss: 0.856 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.55460262298584
Epoch: 12, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.814 Vali Acc: 0.540 Test Loss: 0.814 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.59149956703186
Epoch: 13, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.946 Vali Acc: 0.490 Test Loss: 0.946 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.544628620147705
Epoch: 14, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.890 Vali Acc: 0.510 Test Loss: 0.890 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.618697881698608
Epoch: 15, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.981 Vali Acc: 0.480 Test Loss: 0.981 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.556530237197876
Epoch: 16, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.957 Vali Acc: 0.530 Test Loss: 0.957 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.538907289505005
Epoch: 17, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.018 Vali Acc: 0.540 Test Loss: 1.018 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.669861555099487
Epoch: 18, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.114 Vali Acc: 0.540 Test Loss: 1.114 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 37506434
model size : 144.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7615628242492676
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.723 Vali Acc: 0.460 Test Loss: 0.723 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.284592390060425
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 2.2704477310180664
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.684 Vali Acc: 0.530 Test Loss: 0.684 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 2.3098032474517822
Epoch: 4, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.650843381881714
Epoch: 5, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.692 Vali Acc: 0.560 Test Loss: 0.692 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 2.666888475418091
Epoch: 6, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.785 Vali Acc: 0.450 Test Loss: 0.785 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.688707113265991
Epoch: 7, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.722 Vali Acc: 0.570 Test Loss: 0.722 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 8 cost time: 2.7137739658355713
Epoch: 8, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.745 Vali Acc: 0.540 Test Loss: 0.745 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.69551420211792
Epoch: 9, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.858 Vali Acc: 0.460 Test Loss: 0.858 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7040629386901855
Epoch: 10, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.913 Vali Acc: 0.450 Test Loss: 0.913 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.372619390487671
Epoch: 11, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.373751640319824
Epoch: 12, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.833 Vali Acc: 0.560 Test Loss: 0.833 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3207993507385254
Epoch: 13, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.812 Vali Acc: 0.520 Test Loss: 0.812 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3735129833221436
Epoch: 14, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.898 Vali Acc: 0.520 Test Loss: 0.898 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6842589378356934
Epoch: 15, Steps: 20 | Train Loss: 0.335 Vali Loss: 0.953 Vali Acc: 0.540 Test Loss: 0.953 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.6943092346191406
Epoch: 16, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.119 Vali Acc: 0.480 Test Loss: 1.119 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.736698627471924
Epoch: 17, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.083 Vali Acc: 0.460 Test Loss: 1.083 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 11027330
model size : 43.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.8142383098602295
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 3.4503321647644043
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.724 Vali Acc: 0.540 Test Loss: 0.724 Test Acc: 0.540
Validation loss decreased (-0.489993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 4.171335935592651
Epoch: 3, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.732 Vali Acc: 0.440 Test Loss: 0.732 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.189150094985962
Epoch: 4, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.713 Vali Acc: 0.520 Test Loss: 0.713 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.131951093673706
Epoch: 5, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.229831218719482
Epoch: 6, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.5305469036102295
Epoch: 7, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.871 Vali Acc: 0.550 Test Loss: 0.871 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549991).  Saving model ...
Epoch: 8 cost time: 3.3907203674316406
Epoch: 8, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 3.820667028427124
Epoch: 9, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.1392662525177
Epoch: 10, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.767 Vali Acc: 0.540 Test Loss: 0.767 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.090385437011719
Epoch: 11, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.24309515953064
Epoch: 12, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.751 Vali Acc: 0.580 Test Loss: 0.751 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579992).  Saving model ...
Epoch: 13 cost time: 4.134849786758423
Epoch: 13, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.877 Vali Acc: 0.520 Test Loss: 0.877 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.572021245956421
Epoch: 14, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.915 Vali Acc: 0.500 Test Loss: 0.915 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.459218978881836
Epoch: 15, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.964 Vali Acc: 0.550 Test Loss: 0.964 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.5992372035980225
Epoch: 16, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.892 Vali Acc: 0.540 Test Loss: 0.892 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.220580101013184
Epoch: 17, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.982 Vali Acc: 0.510 Test Loss: 0.982 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.169876337051392
Epoch: 18, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.011 Vali Acc: 0.500 Test Loss: 1.011 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.138895750045776
Epoch: 19, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.239253759384155
Epoch: 20, Steps: 20 | Train Loss: 0.271 Vali Loss: 1.197 Vali Acc: 0.440 Test Loss: 1.197 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.9018919467926025
Epoch: 21, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.6561214923858643
Epoch: 22, Steps: 20 | Train Loss: 0.190 Vali Loss: 1.317 Vali Acc: 0.540 Test Loss: 1.317 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 37506434
model size : 144.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.986294746398926
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.722 Vali Acc: 0.460 Test Loss: 0.722 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.8415534496307373
Epoch: 2, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.8290526866912842
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.683 Vali Acc: 0.550 Test Loss: 0.683 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.8300397396087646
Epoch: 4, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7728338241577148
Epoch: 5, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.681 Vali Acc: 0.560 Test Loss: 0.681 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 1.5668840408325195
Epoch: 6, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.764 Vali Acc: 0.480 Test Loss: 0.764 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.596311330795288
Epoch: 7, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.712 Vali Acc: 0.610 Test Loss: 0.712 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609993).  Saving model ...
Epoch: 8 cost time: 1.5428123474121094
Epoch: 8, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.749 Vali Acc: 0.550 Test Loss: 0.749 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6209802627563477
Epoch: 9, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.842 Vali Acc: 0.490 Test Loss: 0.842 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8112647533416748
Epoch: 10, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.884 Vali Acc: 0.490 Test Loss: 0.884 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.816981315612793
Epoch: 11, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.709 Vali Acc: 0.540 Test Loss: 0.709 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8509550094604492
Epoch: 12, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.824 Vali Acc: 0.540 Test Loss: 0.824 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.806527853012085
Epoch: 13, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.748 Vali Acc: 0.550 Test Loss: 0.748 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7713181972503662
Epoch: 14, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.873 Vali Acc: 0.510 Test Loss: 0.873 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8119351863861084
Epoch: 15, Steps: 20 | Train Loss: 0.347 Vali Loss: 0.948 Vali Acc: 0.520 Test Loss: 0.948 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8130862712860107
Epoch: 16, Steps: 20 | Train Loss: 0.381 Vali Loss: 0.950 Vali Acc: 0.540 Test Loss: 0.950 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8179035186767578
Epoch: 17, Steps: 20 | Train Loss: 0.341 Vali Loss: 0.865 Vali Acc: 0.590 Test Loss: 0.865 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 11027330
model size : 43.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.319786310195923
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.746 Vali Acc: 0.420 Test Loss: 0.746 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 6.0115368366241455
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
Validation loss decreased (-0.419993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 6.060734510421753
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.773 Vali Acc: 0.460 Test Loss: 0.773 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.208932399749756
Epoch: 4, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.794 Vali Acc: 0.470 Test Loss: 0.794 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.141879320144653
Epoch: 5, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.798 Vali Acc: 0.540 Test Loss: 0.798 Test Acc: 0.540
Validation loss decreased (-0.479993 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 6.027086973190308
Epoch: 6, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.867 Vali Acc: 0.490 Test Loss: 0.867 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.044509172439575
Epoch: 7, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.858 Vali Acc: 0.430 Test Loss: 0.858 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.995964527130127
Epoch: 8, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.859 Vali Acc: 0.460 Test Loss: 0.859 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.2996251583099365
Epoch: 9, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.806 Vali Acc: 0.500 Test Loss: 0.806 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.961596727371216
Epoch: 10, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.919 Vali Acc: 0.510 Test Loss: 0.919 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.057035207748413
Epoch: 11, Steps: 20 | Train Loss: 0.385 Vali Loss: 1.007 Vali Acc: 0.490 Test Loss: 1.007 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.930222988128662
Epoch: 12, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.049 Vali Acc: 0.460 Test Loss: 1.049 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.009577751159668
Epoch: 13, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.119 Vali Acc: 0.490 Test Loss: 1.119 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.0040364265441895
Epoch: 14, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.195 Vali Acc: 0.460 Test Loss: 1.195 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.236929893493652
Epoch: 15, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.024 Vali Acc: 0.520 Test Loss: 1.024 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 18760066
model size : 72.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.925389289855957
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.7367708683013916
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.728 Vali Acc: 0.450 Test Loss: 0.728 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.672863245010376
Epoch: 3, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.779 Vali Acc: 0.510 Test Loss: 0.779 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 1.7853548526763916
Epoch: 4, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.723 Vali Acc: 0.520 Test Loss: 0.723 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 1.9121074676513672
Epoch: 5, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6994099617004395
Epoch: 6, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.795 Vali Acc: 0.470 Test Loss: 0.795 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7362370491027832
Epoch: 7, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.700 Vali Acc: 0.550 Test Loss: 0.700 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 1.9154291152954102
Epoch: 8, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.970 Vali Acc: 0.480 Test Loss: 0.970 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.064530372619629
Epoch: 9, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.930 Vali Acc: 0.480 Test Loss: 0.930 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.133307456970215
Epoch: 10, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.165 Vali Acc: 0.460 Test Loss: 1.165 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1586923599243164
Epoch: 11, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.886 Vali Acc: 0.600 Test Loss: 0.886 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599991).  Saving model ...
Epoch: 12 cost time: 2.1538033485412598
Epoch: 12, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.891 Vali Acc: 0.530 Test Loss: 0.891 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.092095375061035
Epoch: 13, Steps: 20 | Train Loss: 0.309 Vali Loss: 1.059 Vali Acc: 0.500 Test Loss: 1.059 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0507049560546875
Epoch: 14, Steps: 20 | Train Loss: 0.258 Vali Loss: 1.237 Vali Acc: 0.520 Test Loss: 1.237 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9794328212738037
Epoch: 15, Steps: 20 | Train Loss: 0.201 Vali Loss: 1.162 Vali Acc: 0.530 Test Loss: 1.162 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9716341495513916
Epoch: 16, Steps: 20 | Train Loss: 0.173 Vali Loss: 1.082 Vali Acc: 0.530 Test Loss: 1.082 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.120767593383789
Epoch: 17, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.343 Vali Acc: 0.520 Test Loss: 1.343 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.037055730819702
Epoch: 18, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.617 Vali Acc: 0.520 Test Loss: 1.617 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.180398941040039
Epoch: 19, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.516 Vali Acc: 0.530 Test Loss: 1.516 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1351146697998047
Epoch: 20, Steps: 20 | Train Loss: 0.165 Vali Loss: 1.257 Vali Acc: 0.540 Test Loss: 1.257 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9643950462341309
Epoch: 21, Steps: 20 | Train Loss: 0.143 Vali Loss: 1.599 Vali Acc: 0.510 Test Loss: 1.599 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5520258
model size : 22.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.980348825454712
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.744 Vali Acc: 0.450 Test Loss: 0.744 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 3.7457354068756104
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
Validation loss decreased (-0.449993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 3.3942577838897705
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.768 Vali Acc: 0.460 Test Loss: 0.768 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3379151821136475
Epoch: 4, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.769 Vali Acc: 0.520 Test Loss: 0.769 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 3.6072628498077393
Epoch: 5, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.737 Vali Acc: 0.550 Test Loss: 0.737 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 3.776338815689087
Epoch: 6, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.807 Vali Acc: 0.520 Test Loss: 0.807 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.759218454360962
Epoch: 7, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.849684000015259
Epoch: 8, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.765 Vali Acc: 0.540 Test Loss: 0.765 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.430471420288086
Epoch: 9, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.813 Vali Acc: 0.480 Test Loss: 0.813 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.391627073287964
Epoch: 10, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.809 Vali Acc: 0.550 Test Loss: 0.809 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.617762327194214
Epoch: 11, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.838 Vali Acc: 0.570 Test Loss: 0.838 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 12 cost time: 3.7772116661071777
Epoch: 12, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.888 Vali Acc: 0.500 Test Loss: 0.888 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.78176212310791
Epoch: 13, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.886 Vali Acc: 0.460 Test Loss: 0.886 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.765935182571411
Epoch: 14, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.970 Vali Acc: 0.470 Test Loss: 0.970 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.283378839492798
Epoch: 15, Steps: 20 | Train Loss: 0.368 Vali Loss: 1.025 Vali Acc: 0.520 Test Loss: 1.025 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.3117213249206543
Epoch: 16, Steps: 20 | Train Loss: 0.326 Vali Loss: 0.927 Vali Acc: 0.510 Test Loss: 0.927 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.366899251937866
Epoch: 17, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.164 Vali Acc: 0.470 Test Loss: 1.164 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.774357557296753
Epoch: 18, Steps: 20 | Train Loss: 0.258 Vali Loss: 1.295 Vali Acc: 0.510 Test Loss: 1.295 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.731752872467041
Epoch: 19, Steps: 20 | Train Loss: 0.240 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.809502363204956
Epoch: 20, Steps: 20 | Train Loss: 0.238 Vali Loss: 1.013 Vali Acc: 0.490 Test Loss: 1.013 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.5038459300994873
Epoch: 21, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.096 Vali Acc: 0.520 Test Loss: 1.096 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 18760066
model size : 72.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7269439697265625
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.735 Vali Acc: 0.480 Test Loss: 0.735 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.6357455253601074
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.557258129119873
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.780 Vali Acc: 0.520 Test Loss: 0.780 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 1.638902187347412
Epoch: 4, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.708 Vali Acc: 0.480 Test Loss: 0.708 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.464120626449585
Epoch: 5, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.462447166442871
Epoch: 6, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4825615882873535
Epoch: 7, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.676 Vali Acc: 0.610 Test Loss: 0.676 Test Acc: 0.610
Validation loss decreased (-0.519992 --> -0.609993).  Saving model ...
Epoch: 8 cost time: 1.5666558742523193
Epoch: 8, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5855646133422852
Epoch: 9, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.773 Vali Acc: 0.560 Test Loss: 0.773 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5528686046600342
Epoch: 10, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.963 Vali Acc: 0.460 Test Loss: 0.963 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.581242561340332
Epoch: 11, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.785 Vali Acc: 0.560 Test Loss: 0.785 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5870609283447266
Epoch: 12, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5705604553222656
Epoch: 13, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.900 Vali Acc: 0.540 Test Loss: 0.900 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5493342876434326
Epoch: 14, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.092 Vali Acc: 0.530 Test Loss: 1.092 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6429767608642578
Epoch: 15, Steps: 20 | Train Loss: 0.339 Vali Loss: 0.980 Vali Acc: 0.570 Test Loss: 0.980 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.45961332321167
Epoch: 16, Steps: 20 | Train Loss: 0.308 Vali Loss: 0.994 Vali Acc: 0.550 Test Loss: 0.994 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4797134399414062
Epoch: 17, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.064 Vali Acc: 0.570 Test Loss: 1.064 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 5520258
model size : 22.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2933127880096436
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.744 Vali Acc: 0.430 Test Loss: 0.744 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 2.213015079498291
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
Validation loss decreased (-0.429993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.1738364696502686
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.767 Vali Acc: 0.450 Test Loss: 0.767 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9183287620544434
Epoch: 4, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.021235942840576
Epoch: 5, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.734 Vali Acc: 0.550 Test Loss: 0.734 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 2.004796266555786
Epoch: 6, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.796 Vali Acc: 0.520 Test Loss: 0.796 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.047940969467163
Epoch: 7, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.820 Vali Acc: 0.520 Test Loss: 0.820 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1859445571899414
Epoch: 8, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2540924549102783
Epoch: 9, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.740 Vali Acc: 0.470 Test Loss: 0.740 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.195488929748535
Epoch: 10, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.751 Vali Acc: 0.580 Test Loss: 0.751 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579992).  Saving model ...
Epoch: 11 cost time: 2.243767499923706
Epoch: 11, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.828 Vali Acc: 0.530 Test Loss: 0.828 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.189894199371338
Epoch: 12, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.798 Vali Acc: 0.550 Test Loss: 0.798 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8997149467468262
Epoch: 13, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.832 Vali Acc: 0.550 Test Loss: 0.832 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0240070819854736
Epoch: 14, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.969 Vali Acc: 0.560 Test Loss: 0.969 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1231954097747803
Epoch: 15, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.907 Vali Acc: 0.500 Test Loss: 0.907 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0105068683624268
Epoch: 16, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.836 Vali Acc: 0.540 Test Loss: 0.836 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3099205493927
Epoch: 17, Steps: 20 | Train Loss: 0.312 Vali Loss: 0.910 Vali Acc: 0.480 Test Loss: 0.910 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.262418270111084
Epoch: 18, Steps: 20 | Train Loss: 0.280 Vali Loss: 0.974 Vali Acc: 0.520 Test Loss: 0.974 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.2494702339172363
Epoch: 19, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.098 Vali Acc: 0.520 Test Loss: 1.098 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.2599165439605713
Epoch: 20, Steps: 20 | Train Loss: 0.232 Vali Loss: 0.965 Vali Acc: 0.490 Test Loss: 0.965 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 18760066
model size : 72.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.3881587982177734
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.737 Vali Acc: 0.460 Test Loss: 0.737 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.140035629272461
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
Validation loss decreased (-0.459993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 1.1543664932250977
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.780 Vali Acc: 0.520 Test Loss: 0.780 Test Acc: 0.520
Validation loss decreased (-0.459993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 1.1419010162353516
Epoch: 4, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1972999572753906
Epoch: 5, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.711 Vali Acc: 0.540 Test Loss: 0.711 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 1.1679348945617676
Epoch: 6, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.720 Vali Acc: 0.450 Test Loss: 0.720 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1935222148895264
Epoch: 7, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.669 Vali Acc: 0.580 Test Loss: 0.669 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 8 cost time: 1.1621525287628174
Epoch: 8, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.791 Vali Acc: 0.560 Test Loss: 0.791 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0334446430206299
Epoch: 9, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.774 Vali Acc: 0.590 Test Loss: 0.774 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 10 cost time: 1.1250934600830078
Epoch: 10, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.982 Vali Acc: 0.450 Test Loss: 0.982 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0531110763549805
Epoch: 11, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.767 Vali Acc: 0.560 Test Loss: 0.767 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.129119634628296
Epoch: 12, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.030973196029663
Epoch: 13, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.858 Vali Acc: 0.540 Test Loss: 0.858 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.186056137084961
Epoch: 14, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.057 Vali Acc: 0.490 Test Loss: 1.057 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1890535354614258
Epoch: 15, Steps: 20 | Train Loss: 0.378 Vali Loss: 0.906 Vali Acc: 0.530 Test Loss: 0.906 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1447093486785889
Epoch: 16, Steps: 20 | Train Loss: 0.349 Vali Loss: 0.975 Vali Acc: 0.530 Test Loss: 0.975 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.167041301727295
Epoch: 17, Steps: 20 | Train Loss: 0.304 Vali Loss: 0.884 Vali Acc: 0.570 Test Loss: 0.884 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.149893045425415
Epoch: 18, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.025 Vali Acc: 0.520 Test Loss: 1.025 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.173110008239746
Epoch: 19, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.064 Vali Acc: 0.500 Test Loss: 1.064 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 5520258
model size : 22.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.65081524848938
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 3.5275027751922607
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6364853382110596
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.765 Vali Acc: 0.460 Test Loss: 0.765 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2213118076324463
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.255612850189209
Epoch: 5, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.1635148525238037
Epoch: 6, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.783 Vali Acc: 0.490 Test Loss: 0.783 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489992).  Saving model ...
Epoch: 7 cost time: 3.463988780975342
Epoch: 7, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.825 Vali Acc: 0.440 Test Loss: 0.825 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.475757360458374
Epoch: 8, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.856 Vali Acc: 0.420 Test Loss: 0.856 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.65824818611145
Epoch: 9, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.810 Vali Acc: 0.490 Test Loss: 0.810 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.509176015853882
Epoch: 10, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.999 Vali Acc: 0.480 Test Loss: 0.999 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0931642055511475
Epoch: 11, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.843 Vali Acc: 0.540 Test Loss: 0.843 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539992).  Saving model ...
Epoch: 12 cost time: 3.085155725479126
Epoch: 12, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.932 Vali Acc: 0.510 Test Loss: 0.932 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.171969175338745
Epoch: 13, Steps: 20 | Train Loss: 0.403 Vali Loss: 0.992 Vali Acc: 0.510 Test Loss: 0.992 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.53790545463562
Epoch: 14, Steps: 20 | Train Loss: 0.386 Vali Loss: 1.036 Vali Acc: 0.490 Test Loss: 1.036 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.554849147796631
Epoch: 15, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.239 Vali Acc: 0.520 Test Loss: 1.239 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.5631155967712402
Epoch: 16, Steps: 20 | Train Loss: 0.311 Vali Loss: 1.112 Vali Acc: 0.510 Test Loss: 1.112 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.523263931274414
Epoch: 17, Steps: 20 | Train Loss: 0.264 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.1535046100616455
Epoch: 18, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.309 Vali Acc: 0.480 Test Loss: 1.309 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.085580825805664
Epoch: 19, Steps: 20 | Train Loss: 0.272 Vali Loss: 1.203 Vali Acc: 0.510 Test Loss: 1.203 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.1133337020874023
Epoch: 20, Steps: 20 | Train Loss: 0.180 Vali Loss: 1.205 Vali Acc: 0.560 Test Loss: 1.205 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559988).  Saving model ...
Epoch: 21 cost time: 3.5472185611724854
Epoch: 21, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.404 Vali Acc: 0.440 Test Loss: 1.404 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4931893348693848
Epoch: 22, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.521 Vali Acc: 0.490 Test Loss: 1.521 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.54282808303833
Epoch: 23, Steps: 20 | Train Loss: 0.091 Vali Loss: 1.336 Vali Acc: 0.520 Test Loss: 1.336 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.5600767135620117
Epoch: 24, Steps: 20 | Train Loss: 0.076 Vali Loss: 1.685 Vali Acc: 0.550 Test Loss: 1.685 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.2230210304260254
Epoch: 25, Steps: 20 | Train Loss: 0.131 Vali Loss: 1.610 Vali Acc: 0.540 Test Loss: 1.610 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.0599563121795654
Epoch: 26, Steps: 20 | Train Loss: 0.103 Vali Loss: 1.685 Vali Acc: 0.520 Test Loss: 1.685 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.087639808654785
Epoch: 27, Steps: 20 | Train Loss: 0.095 Vali Loss: 1.885 Vali Acc: 0.470 Test Loss: 1.885 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.1218738555908203
Epoch: 28, Steps: 20 | Train Loss: 0.068 Vali Loss: 1.711 Vali Acc: 0.520 Test Loss: 1.711 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.896243095397949
Epoch: 29, Steps: 20 | Train Loss: 0.034 Vali Loss: 1.955 Vali Acc: 0.520 Test Loss: 1.955 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.889540433883667
Epoch: 30, Steps: 20 | Train Loss: 0.048 Vali Loss: 1.753 Vali Acc: 0.550 Test Loss: 1.753 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9386882
model size : 37.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9416568279266357
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.675 Vali Acc: 0.540 Test Loss: 0.675 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.722757339477539
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.696 Vali Acc: 0.450 Test Loss: 0.696 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.747692346572876
Epoch: 3, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.728 Vali Acc: 0.470 Test Loss: 0.728 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7106389999389648
Epoch: 4, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.502363681793213
Epoch: 5, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6809518337249756
Epoch: 6, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5781872272491455
Epoch: 7, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.782 Vali Acc: 0.490 Test Loss: 0.782 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6777796745300293
Epoch: 8, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7360577583312988
Epoch: 9, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7169299125671387
Epoch: 10, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.811 Vali Acc: 0.530 Test Loss: 0.811 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.754303216934204
Epoch: 11, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.861 Vali Acc: 0.510 Test Loss: 0.861 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 2766722
model size : 11.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.793741464614868
Epoch: 1, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.6075963973999023
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.743 Vali Acc: 0.470 Test Loss: 0.743 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.67293119430542
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.764 Vali Acc: 0.470 Test Loss: 0.764 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7296226024627686
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.737 Vali Acc: 0.460 Test Loss: 0.737 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.363281726837158
Epoch: 5, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
Validation loss decreased (-0.479993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 2.3165335655212402
Epoch: 6, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.757 Vali Acc: 0.570 Test Loss: 0.757 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 7 cost time: 2.472489595413208
Epoch: 7, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.803 Vali Acc: 0.460 Test Loss: 0.803 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.630439281463623
Epoch: 8, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.794 Vali Acc: 0.460 Test Loss: 0.794 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5978879928588867
Epoch: 9, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6201462745666504
Epoch: 10, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.936 Vali Acc: 0.540 Test Loss: 0.936 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6760456562042236
Epoch: 11, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.789 Vali Acc: 0.550 Test Loss: 0.789 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.267348051071167
Epoch: 12, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.815 Vali Acc: 0.490 Test Loss: 0.815 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.365046501159668
Epoch: 13, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.796 Vali Acc: 0.540 Test Loss: 0.796 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.382835626602173
Epoch: 14, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.985 Vali Acc: 0.430 Test Loss: 0.985 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.58320951461792
Epoch: 15, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.947 Vali Acc: 0.530 Test Loss: 0.947 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5621867179870605
Epoch: 16, Steps: 20 | Train Loss: 0.388 Vali Loss: 0.960 Vali Acc: 0.520 Test Loss: 0.960 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9386882
model size : 37.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.855189561843872
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.677 Vali Acc: 0.560 Test Loss: 0.677 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.4547977447509766
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.696 Vali Acc: 0.430 Test Loss: 0.696 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4579746723175049
Epoch: 3, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4706315994262695
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4551646709442139
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.419680118560791
Epoch: 6, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4315838813781738
Epoch: 7, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3745019435882568
Epoch: 8, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.745 Vali Acc: 0.540 Test Loss: 0.745 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3212425708770752
Epoch: 9, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.732 Vali Acc: 0.520 Test Loss: 0.732 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4340500831604004
Epoch: 10, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.793 Vali Acc: 0.550 Test Loss: 0.793 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4611232280731201
Epoch: 11, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.780 Vali Acc: 0.510 Test Loss: 0.780 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2766722
model size : 11.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.745760440826416
Epoch: 1, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.4875242710113525
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.743 Vali Acc: 0.470 Test Loss: 0.743 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6686015129089355
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.763 Vali Acc: 0.460 Test Loss: 0.763 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5922446250915527
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.735 Vali Acc: 0.470 Test Loss: 0.735 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5872206687927246
Epoch: 5, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 1.6733412742614746
Epoch: 6, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.760 Vali Acc: 0.550 Test Loss: 0.760 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 1.600595474243164
Epoch: 7, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.805 Vali Acc: 0.450 Test Loss: 0.805 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.390568733215332
Epoch: 8, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.783 Vali Acc: 0.460 Test Loss: 0.783 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4511682987213135
Epoch: 9, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4745452404022217
Epoch: 10, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.911 Vali Acc: 0.550 Test Loss: 0.911 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5074610710144043
Epoch: 11, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.781 Vali Acc: 0.560 Test Loss: 0.781 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 12 cost time: 1.6447343826293945
Epoch: 12, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.797 Vali Acc: 0.490 Test Loss: 0.797 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7603859901428223
Epoch: 13, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.803 Vali Acc: 0.560 Test Loss: 0.803 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6409943103790283
Epoch: 14, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.944 Vali Acc: 0.500 Test Loss: 0.944 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6767206192016602
Epoch: 15, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.947 Vali Acc: 0.500 Test Loss: 0.947 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6100926399230957
Epoch: 16, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.928 Vali Acc: 0.560 Test Loss: 0.928 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3946008682250977
Epoch: 17, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.024 Vali Acc: 0.520 Test Loss: 1.024 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4811608791351318
Epoch: 18, Steps: 20 | Train Loss: 0.336 Vali Loss: 1.026 Vali Acc: 0.480 Test Loss: 1.026 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4107770919799805
Epoch: 19, Steps: 20 | Train Loss: 0.307 Vali Loss: 1.389 Vali Acc: 0.480 Test Loss: 1.389 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5005066394805908
Epoch: 20, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.037 Vali Acc: 0.560 Test Loss: 1.037 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5694222450256348
Epoch: 21, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.306 Vali Acc: 0.440 Test Loss: 1.306 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9386882
model size : 37.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.086092948913574
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.675 Vali Acc: 0.570 Test Loss: 0.675 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 0.9728362560272217
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.692 Vali Acc: 0.460 Test Loss: 0.692 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0681571960449219
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0123131275177002
Epoch: 4, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.700 Vali Acc: 0.520 Test Loss: 0.700 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0497469902038574
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0634021759033203
Epoch: 6, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1309127807617188
Epoch: 7, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0522494316101074
Epoch: 8, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.737 Vali Acc: 0.520 Test Loss: 0.737 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0813636779785156
Epoch: 9, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.707 Vali Acc: 0.530 Test Loss: 0.707 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1332478523254395
Epoch: 10, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.776 Vali Acc: 0.560 Test Loss: 0.776 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9303255081176758
Epoch: 11, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.778 Vali Acc: 0.560 Test Loss: 0.778 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2766722
model size : 11.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.921492099761963
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.635136365890503
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.184140205383301
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.12998366355896
Epoch: 4, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.723 Vali Acc: 0.440 Test Loss: 0.723 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.288353443145752
Epoch: 5, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.7200257778167725
Epoch: 6, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.768 Vali Acc: 0.450 Test Loss: 0.768 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.534083843231201
Epoch: 7, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.747 Vali Acc: 0.470 Test Loss: 0.747 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.695589065551758
Epoch: 8, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 3.187505006790161
Epoch: 9, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.804 Vali Acc: 0.440 Test Loss: 0.804 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.158766269683838
Epoch: 10, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.036553144454956
Epoch: 11, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.787 Vali Acc: 0.550 Test Loss: 0.787 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 12 cost time: 2.8070950508117676
Epoch: 12, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.815 Vali Acc: 0.510 Test Loss: 0.815 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.957843780517578
Epoch: 13, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.857 Vali Acc: 0.570 Test Loss: 0.857 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569991).  Saving model ...
Epoch: 14 cost time: 2.827110767364502
Epoch: 14, Steps: 20 | Train Loss: 0.345 Vali Loss: 0.914 Vali Acc: 0.490 Test Loss: 0.914 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.878925323486328
Epoch: 15, Steps: 20 | Train Loss: 0.337 Vali Loss: 0.902 Vali Acc: 0.520 Test Loss: 0.902 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.879131555557251
Epoch: 16, Steps: 20 | Train Loss: 0.294 Vali Loss: 1.000 Vali Acc: 0.530 Test Loss: 1.000 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.289524555206299
Epoch: 17, Steps: 20 | Train Loss: 0.271 Vali Loss: 1.010 Vali Acc: 0.500 Test Loss: 1.010 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.363818407058716
Epoch: 18, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.093 Vali Acc: 0.560 Test Loss: 1.093 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.203094244003296
Epoch: 19, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.088 Vali Acc: 0.540 Test Loss: 1.088 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.051090955734253
Epoch: 20, Steps: 20 | Train Loss: 0.172 Vali Loss: 1.050 Vali Acc: 0.570 Test Loss: 1.050 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.327822685241699
Epoch: 21, Steps: 20 | Train Loss: 0.149 Vali Loss: 1.280 Vali Acc: 0.510 Test Loss: 1.280 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.3321566581726074
Epoch: 22, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.136 Vali Acc: 0.560 Test Loss: 1.136 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.3358333110809326
Epoch: 23, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.123 Vali Acc: 0.550 Test Loss: 1.123 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9381570
model size : 36.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.660752534866333
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.5003833770751953
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5821292400360107
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.719 Vali Acc: 0.450 Test Loss: 0.719 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6849229335784912
Epoch: 4, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.735 Vali Acc: 0.510 Test Loss: 0.735 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6256051063537598
Epoch: 5, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.708 Vali Acc: 0.490 Test Loss: 0.708 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.580660343170166
Epoch: 6, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 1.4971282482147217
Epoch: 7, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.705 Vali Acc: 0.540 Test Loss: 0.705 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 1.6046552658081055
Epoch: 8, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.704 Vali Acc: 0.580 Test Loss: 0.704 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 9 cost time: 1.5934805870056152
Epoch: 9, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4587016105651855
Epoch: 10, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5324556827545166
Epoch: 11, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5844759941101074
Epoch: 12, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5569751262664795
Epoch: 13, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.797 Vali Acc: 0.540 Test Loss: 0.797 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4985401630401611
Epoch: 14, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.807 Vali Acc: 0.490 Test Loss: 0.807 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.438192367553711
Epoch: 15, Steps: 20 | Train Loss: 0.403 Vali Loss: 0.859 Vali Acc: 0.560 Test Loss: 0.859 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5612578392028809
Epoch: 16, Steps: 20 | Train Loss: 0.385 Vali Loss: 0.823 Vali Acc: 0.530 Test Loss: 0.823 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5542492866516113
Epoch: 17, Steps: 20 | Train Loss: 0.365 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4959580898284912
Epoch: 18, Steps: 20 | Train Loss: 0.344 Vali Loss: 0.916 Vali Acc: 0.510 Test Loss: 0.916 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2761154
model size : 11.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5798933506011963
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.190979242324829
Epoch: 2, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.707 Vali Acc: 0.460 Test Loss: 0.707 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1282896995544434
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.714 Vali Acc: 0.460 Test Loss: 0.714 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0982813835144043
Epoch: 4, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.714 Vali Acc: 0.490 Test Loss: 0.714 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.259660005569458
Epoch: 5, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.694 Vali Acc: 0.540 Test Loss: 0.694 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 2.3467934131622314
Epoch: 6, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.744 Vali Acc: 0.450 Test Loss: 0.744 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.325418472290039
Epoch: 7, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.289759874343872
Epoch: 8, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1523122787475586
Epoch: 9, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2961320877075195
Epoch: 10, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.405782699584961
Epoch: 11, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.856 Vali Acc: 0.470 Test Loss: 0.856 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3751742839813232
Epoch: 12, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.817 Vali Acc: 0.510 Test Loss: 0.817 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.351243019104004
Epoch: 13, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3552021980285645
Epoch: 14, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.919 Vali Acc: 0.470 Test Loss: 0.919 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2449417114257812
Epoch: 15, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 9381570
model size : 36.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5058066844940186
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.2899904251098633
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1778435707092285
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.719 Vali Acc: 0.450 Test Loss: 0.719 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.232398271560669
Epoch: 4, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.735 Vali Acc: 0.510 Test Loss: 0.735 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.24699068069458
Epoch: 5, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.708 Vali Acc: 0.490 Test Loss: 0.708 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.22953462600708
Epoch: 6, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.750 Vali Acc: 0.510 Test Loss: 0.750 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3390884399414062
Epoch: 7, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.706 Vali Acc: 0.550 Test Loss: 0.706 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 1.3043313026428223
Epoch: 8, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.695 Vali Acc: 0.560 Test Loss: 0.695 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 1.3518750667572021
Epoch: 9, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.268205165863037
Epoch: 10, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.715 Vali Acc: 0.570 Test Loss: 0.715 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 1.3578925132751465
Epoch: 11, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2522101402282715
Epoch: 12, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.733 Vali Acc: 0.540 Test Loss: 0.733 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3441708087921143
Epoch: 13, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.733 Vali Acc: 0.570 Test Loss: 0.733 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.24818754196167
Epoch: 14, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.743 Vali Acc: 0.540 Test Loss: 0.743 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3071002960205078
Epoch: 15, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.801 Vali Acc: 0.590 Test Loss: 0.801 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 16 cost time: 1.3656301498413086
Epoch: 16, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3103086948394775
Epoch: 17, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.824 Vali Acc: 0.530 Test Loss: 0.824 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2898147106170654
Epoch: 18, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.825 Vali Acc: 0.560 Test Loss: 0.825 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3582873344421387
Epoch: 19, Steps: 20 | Train Loss: 0.397 Vali Loss: 0.924 Vali Acc: 0.550 Test Loss: 0.924 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.400681734085083
Epoch: 20, Steps: 20 | Train Loss: 0.381 Vali Loss: 0.851 Vali Acc: 0.540 Test Loss: 0.851 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.27583646774292
Epoch: 21, Steps: 20 | Train Loss: 0.339 Vali Loss: 0.820 Vali Acc: 0.570 Test Loss: 0.820 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3102023601531982
Epoch: 22, Steps: 20 | Train Loss: 0.297 Vali Loss: 0.956 Vali Acc: 0.550 Test Loss: 0.956 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2844569683074951
Epoch: 23, Steps: 20 | Train Loss: 0.271 Vali Loss: 0.950 Vali Acc: 0.580 Test Loss: 0.950 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2966370582580566
Epoch: 24, Steps: 20 | Train Loss: 0.271 Vali Loss: 1.085 Vali Acc: 0.550 Test Loss: 1.085 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3132693767547607
Epoch: 25, Steps: 20 | Train Loss: 0.243 Vali Loss: 0.932 Vali Acc: 0.550 Test Loss: 0.932 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2761154
model size : 11.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.681687831878662
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.500744342803955
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4010093212127686
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3971376419067383
Epoch: 4, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.715 Vali Acc: 0.460 Test Loss: 0.715 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.431715965270996
Epoch: 5, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.688 Vali Acc: 0.530 Test Loss: 0.688 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 1.4470579624176025
Epoch: 6, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.740 Vali Acc: 0.450 Test Loss: 0.740 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.482107400894165
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.695 Vali Acc: 0.550 Test Loss: 0.695 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 1.5118052959442139
Epoch: 8, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.704 Vali Acc: 0.560 Test Loss: 0.704 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 1.5065863132476807
Epoch: 9, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.488358497619629
Epoch: 10, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5411632061004639
Epoch: 11, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3884761333465576
Epoch: 12, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.731 Vali Acc: 0.560 Test Loss: 0.731 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4403305053710938
Epoch: 13, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.768 Vali Acc: 0.560 Test Loss: 0.768 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5351080894470215
Epoch: 14, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.745 Vali Acc: 0.540 Test Loss: 0.745 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.46309494972229
Epoch: 15, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.402017593383789
Epoch: 16, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.704 Vali Acc: 0.610 Test Loss: 0.704 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609993).  Saving model ...
Epoch: 17 cost time: 1.4244720935821533
Epoch: 17, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.781 Vali Acc: 0.560 Test Loss: 0.781 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4068434238433838
Epoch: 18, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.821 Vali Acc: 0.540 Test Loss: 0.821 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.364015817642212
Epoch: 19, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.908 Vali Acc: 0.540 Test Loss: 0.908 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.276888370513916
Epoch: 20, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.834 Vali Acc: 0.550 Test Loss: 0.834 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.429718255996704
Epoch: 21, Steps: 20 | Train Loss: 0.395 Vali Loss: 0.864 Vali Acc: 0.540 Test Loss: 0.864 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4533920288085938
Epoch: 22, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.918 Vali Acc: 0.540 Test Loss: 0.918 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5037357807159424
Epoch: 23, Steps: 20 | Train Loss: 0.367 Vali Loss: 0.883 Vali Acc: 0.520 Test Loss: 0.883 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5233898162841797
Epoch: 24, Steps: 20 | Train Loss: 0.356 Vali Loss: 0.912 Vali Acc: 0.510 Test Loss: 0.912 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5603582859039307
Epoch: 25, Steps: 20 | Train Loss: 0.320 Vali Loss: 0.906 Vali Acc: 0.550 Test Loss: 0.906 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4920785427093506
Epoch: 26, Steps: 20 | Train Loss: 0.318 Vali Loss: 0.893 Vali Acc: 0.580 Test Loss: 0.893 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9381570
model size : 36.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.170459508895874
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.1063313484191895
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.104118824005127
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.719 Vali Acc: 0.450 Test Loss: 0.719 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0502078533172607
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 0.988314151763916
Epoch: 5, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9898784160614014
Epoch: 6, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.965263843536377
Epoch: 7, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.708 Vali Acc: 0.530 Test Loss: 0.708 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 8 cost time: 1.0217869281768799
Epoch: 8, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.696 Vali Acc: 0.570 Test Loss: 0.696 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 9 cost time: 1.0554141998291016
Epoch: 9, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.731 Vali Acc: 0.540 Test Loss: 0.731 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1126184463500977
Epoch: 10, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.715 Vali Acc: 0.570 Test Loss: 0.715 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.080653429031372
Epoch: 11, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.693 Vali Acc: 0.580 Test Loss: 0.693 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 12 cost time: 0.922905683517456
Epoch: 12, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.702 Vali Acc: 0.570 Test Loss: 0.702 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1143748760223389
Epoch: 13, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.724 Vali Acc: 0.600 Test Loss: 0.724 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599993).  Saving model ...
Epoch: 14 cost time: 0.9917073249816895
Epoch: 14, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.697 Vali Acc: 0.570 Test Loss: 0.697 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.012760877609253
Epoch: 15, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.775 Vali Acc: 0.570 Test Loss: 0.775 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1208775043487549
Epoch: 16, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1480672359466553
Epoch: 17, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.772 Vali Acc: 0.570 Test Loss: 0.772 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.199631929397583
Epoch: 18, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.771 Vali Acc: 0.570 Test Loss: 0.771 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.061661958694458
Epoch: 19, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.841 Vali Acc: 0.510 Test Loss: 0.841 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1564371585845947
Epoch: 20, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.757 Vali Acc: 0.600 Test Loss: 0.757 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.056586503982544
Epoch: 21, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.807 Vali Acc: 0.550 Test Loss: 0.807 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1045646667480469
Epoch: 22, Steps: 20 | Train Loss: 0.346 Vali Loss: 0.812 Vali Acc: 0.540 Test Loss: 0.812 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0763309001922607
Epoch: 23, Steps: 20 | Train Loss: 0.315 Vali Loss: 0.868 Vali Acc: 0.610 Test Loss: 0.868 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609991).  Saving model ...
Epoch: 24 cost time: 0.9487490653991699
Epoch: 24, Steps: 20 | Train Loss: 0.316 Vali Loss: 0.912 Vali Acc: 0.560 Test Loss: 0.912 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0244147777557373
Epoch: 25, Steps: 20 | Train Loss: 0.292 Vali Loss: 0.873 Vali Acc: 0.550 Test Loss: 0.873 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1310670375823975
Epoch: 26, Steps: 20 | Train Loss: 0.278 Vali Loss: 0.952 Vali Acc: 0.560 Test Loss: 0.952 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0265555381774902
Epoch: 27, Steps: 20 | Train Loss: 0.229 Vali Loss: 0.926 Vali Acc: 0.520 Test Loss: 0.926 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9490034580230713
Epoch: 28, Steps: 20 | Train Loss: 0.238 Vali Loss: 0.958 Vali Acc: 0.540 Test Loss: 0.958 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9645390510559082
Epoch: 29, Steps: 20 | Train Loss: 0.228 Vali Loss: 1.080 Vali Acc: 0.580 Test Loss: 1.080 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0495777130126953
Epoch: 30, Steps: 20 | Train Loss: 0.199 Vali Loss: 1.060 Vali Acc: 0.550 Test Loss: 1.060 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2761154
model size : 11.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9951696395874023
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.691 Vali Acc: 0.580 Test Loss: 0.691 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.587460517883301
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.678 Vali Acc: 0.530 Test Loss: 0.678 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.56085467338562
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.698 Vali Acc: 0.480 Test Loss: 0.698 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6570627689361572
Epoch: 4, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.687 Vali Acc: 0.540 Test Loss: 0.687 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.634434223175049
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.733 Vali Acc: 0.540 Test Loss: 0.733 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.601123809814453
Epoch: 6, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.2729129791259766
Epoch: 7, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.718 Vali Acc: 0.530 Test Loss: 0.718 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.345898151397705
Epoch: 8, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2490599155426025
Epoch: 9, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.740 Vali Acc: 0.560 Test Loss: 0.740 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.3823039531707764
Epoch: 10, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4358344078063965
Epoch: 11, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.790 Vali Acc: 0.500 Test Loss: 0.790 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4694210
model size : 18.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9637033939361572
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.722 Vali Acc: 0.430 Test Loss: 0.722 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.6150774955749512
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
Validation loss decreased (-0.429993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.6362378597259521
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6110913753509521
Epoch: 4, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.715 Vali Acc: 0.480 Test Loss: 0.715 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5880203247070312
Epoch: 5, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.53025221824646
Epoch: 6, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 1.5517005920410156
Epoch: 7, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5555076599121094
Epoch: 8, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.684 Vali Acc: 0.550 Test Loss: 0.684 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 1.6485328674316406
Epoch: 9, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.827 Vali Acc: 0.570 Test Loss: 0.827 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 1.55649995803833
Epoch: 10, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6245288848876953
Epoch: 11, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.816 Vali Acc: 0.490 Test Loss: 0.816 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5603969097137451
Epoch: 12, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.792 Vali Acc: 0.530 Test Loss: 0.792 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.545050859451294
Epoch: 13, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5329272747039795
Epoch: 14, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5845973491668701
Epoch: 15, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.767 Vali Acc: 0.560 Test Loss: 0.767 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6016628742218018
Epoch: 16, Steps: 20 | Train Loss: 0.366 Vali Loss: 0.894 Vali Acc: 0.510 Test Loss: 0.894 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6622304916381836
Epoch: 17, Steps: 20 | Train Loss: 0.352 Vali Loss: 0.874 Vali Acc: 0.570 Test Loss: 0.874 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.533172845840454
Epoch: 18, Steps: 20 | Train Loss: 0.315 Vali Loss: 0.861 Vali Acc: 0.510 Test Loss: 0.861 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5768744945526123
Epoch: 19, Steps: 20 | Train Loss: 0.273 Vali Loss: 1.076 Vali Acc: 0.560 Test Loss: 1.076 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1383874
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2367095947265625
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.690 Vali Acc: 0.580 Test Loss: 0.690 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.0166826248168945
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.679 Vali Acc: 0.550 Test Loss: 0.679 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0531067848205566
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.697 Vali Acc: 0.510 Test Loss: 0.697 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9987642765045166
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.684 Vali Acc: 0.510 Test Loss: 0.684 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9956796169281006
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.703 Vali Acc: 0.530 Test Loss: 0.703 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.978076457977295
Epoch: 6, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.700 Vali Acc: 0.550 Test Loss: 0.700 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0107955932617188
Epoch: 7, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7206180095672607
Epoch: 8, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.716 Vali Acc: 0.550 Test Loss: 0.716 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7351739406585693
Epoch: 9, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.711 Vali Acc: 0.550 Test Loss: 0.711 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6925880908966064
Epoch: 10, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.697 Vali Acc: 0.560 Test Loss: 0.697 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7775545120239258
Epoch: 11, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.691 Vali Acc: 0.530 Test Loss: 0.691 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4694210
model size : 18.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.564363718032837
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.723 Vali Acc: 0.420 Test Loss: 0.723 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 1.445882797241211
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
Validation loss decreased (-0.419993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.3187365531921387
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.702 Vali Acc: 0.520 Test Loss: 0.702 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.3356482982635498
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.712 Vali Acc: 0.490 Test Loss: 0.712 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.220263957977295
Epoch: 5, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.423701524734497
Epoch: 6, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3226306438446045
Epoch: 7, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.731 Vali Acc: 0.450 Test Loss: 0.731 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3927533626556396
Epoch: 8, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.693 Vali Acc: 0.560 Test Loss: 0.693 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 1.2689330577850342
Epoch: 9, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.779 Vali Acc: 0.550 Test Loss: 0.779 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3201134204864502
Epoch: 10, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.746 Vali Acc: 0.490 Test Loss: 0.746 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2147283554077148
Epoch: 11, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.804 Vali Acc: 0.490 Test Loss: 0.804 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2758479118347168
Epoch: 12, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.804 Vali Acc: 0.560 Test Loss: 0.804 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3041729927062988
Epoch: 13, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3467512130737305
Epoch: 14, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.767 Vali Acc: 0.510 Test Loss: 0.767 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3894126415252686
Epoch: 15, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.767 Vali Acc: 0.560 Test Loss: 0.767 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3289484977722168
Epoch: 16, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.869 Vali Acc: 0.550 Test Loss: 0.869 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3997199535369873
Epoch: 17, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.782 Vali Acc: 0.590 Test Loss: 0.782 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589992).  Saving model ...
Epoch: 18 cost time: 1.2085211277008057
Epoch: 18, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.854 Vali Acc: 0.600 Test Loss: 0.854 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599991).  Saving model ...
Epoch: 19 cost time: 1.3520045280456543
Epoch: 19, Steps: 20 | Train Loss: 0.368 Vali Loss: 0.937 Vali Acc: 0.580 Test Loss: 0.937 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.409796953201294
Epoch: 20, Steps: 20 | Train Loss: 0.338 Vali Loss: 0.908 Vali Acc: 0.500 Test Loss: 0.908 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4025452136993408
Epoch: 21, Steps: 20 | Train Loss: 0.331 Vali Loss: 0.940 Vali Acc: 0.530 Test Loss: 0.940 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4471619129180908
Epoch: 22, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.006 Vali Acc: 0.490 Test Loss: 1.006 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.264009714126587
Epoch: 23, Steps: 20 | Train Loss: 0.282 Vali Loss: 0.944 Vali Acc: 0.590 Test Loss: 0.944 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3053245544433594
Epoch: 24, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.048 Vali Acc: 0.510 Test Loss: 1.048 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3239428997039795
Epoch: 25, Steps: 20 | Train Loss: 0.240 Vali Loss: 0.983 Vali Acc: 0.580 Test Loss: 0.983 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3840718269348145
Epoch: 26, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.055 Vali Acc: 0.530 Test Loss: 1.055 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2888476848602295
Epoch: 27, Steps: 20 | Train Loss: 0.219 Vali Loss: 1.116 Vali Acc: 0.490 Test Loss: 1.116 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3775336742401123
Epoch: 28, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.166 Vali Acc: 0.540 Test Loss: 1.166 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1383874
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.4320569038391113
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.690 Vali Acc: 0.580 Test Loss: 0.690 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.432548999786377
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.679 Vali Acc: 0.550 Test Loss: 0.679 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.39298677444458
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.698 Vali Acc: 0.510 Test Loss: 0.698 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.463536024093628
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.685 Vali Acc: 0.500 Test Loss: 0.685 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.235851526260376
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2740976810455322
Epoch: 6, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.699 Vali Acc: 0.560 Test Loss: 0.699 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2432072162628174
Epoch: 7, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.692 Vali Acc: 0.550 Test Loss: 0.692 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1647210121154785
Epoch: 8, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.693 Vali Acc: 0.550 Test Loss: 0.693 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3237900733947754
Epoch: 9, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.700 Vali Acc: 0.560 Test Loss: 0.700 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2586090564727783
Epoch: 10, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.687 Vali Acc: 0.560 Test Loss: 0.687 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4032750129699707
Epoch: 11, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.678 Vali Acc: 0.560 Test Loss: 0.678 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4694210
model size : 18.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.1348719596862793
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.723 Vali Acc: 0.420 Test Loss: 0.723 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 1.1379597187042236
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
Validation loss decreased (-0.419993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.0512890815734863
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.0043835639953613
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.714 Vali Acc: 0.480 Test Loss: 0.714 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.135787010192871
Epoch: 5, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9955484867095947
Epoch: 6, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0823819637298584
Epoch: 7, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0201811790466309
Epoch: 8, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.679 Vali Acc: 0.560 Test Loss: 0.679 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 0.9432446956634521
Epoch: 9, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.759 Vali Acc: 0.540 Test Loss: 0.759 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0587148666381836
Epoch: 10, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0177886486053467
Epoch: 11, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1538665294647217
Epoch: 12, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0321838855743408
Epoch: 13, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.716 Vali Acc: 0.550 Test Loss: 0.716 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.11330246925354
Epoch: 14, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1969671249389648
Epoch: 15, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.726 Vali Acc: 0.600 Test Loss: 0.726 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 16 cost time: 0.9683661460876465
Epoch: 16, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9614112377166748
Epoch: 17, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.723 Vali Acc: 0.600 Test Loss: 0.723 Test Acc: 0.600
Validation loss decreased (-0.599993 --> -0.599993).  Saving model ...
Epoch: 18 cost time: 1.1494927406311035
Epoch: 18, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.768 Vali Acc: 0.530 Test Loss: 0.768 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1653261184692383
Epoch: 19, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.734 Vali Acc: 0.550 Test Loss: 0.734 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0371503829956055
Epoch: 20, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.865 Vali Acc: 0.530 Test Loss: 0.865 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1551103591918945
Epoch: 21, Steps: 20 | Train Loss: 0.368 Vali Loss: 0.776 Vali Acc: 0.540 Test Loss: 0.776 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2418479919433594
Epoch: 22, Steps: 20 | Train Loss: 0.366 Vali Loss: 0.854 Vali Acc: 0.550 Test Loss: 0.854 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.131812572479248
Epoch: 23, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.779 Vali Acc: 0.560 Test Loss: 0.779 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0303709506988525
Epoch: 24, Steps: 20 | Train Loss: 0.302 Vali Loss: 0.870 Vali Acc: 0.560 Test Loss: 0.870 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9853010177612305
Epoch: 25, Steps: 20 | Train Loss: 0.304 Vali Loss: 0.853 Vali Acc: 0.540 Test Loss: 0.853 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0584323406219482
Epoch: 26, Steps: 20 | Train Loss: 0.301 Vali Loss: 0.990 Vali Acc: 0.520 Test Loss: 0.990 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.008615493774414
Epoch: 27, Steps: 20 | Train Loss: 0.295 Vali Loss: 0.950 Vali Acc: 0.570 Test Loss: 0.950 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1383874
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5422427654266357
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.2275311946868896
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.696 Vali Acc: 0.460 Test Loss: 0.696 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3435628414154053
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.711 Vali Acc: 0.450 Test Loss: 0.711 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2437191009521484
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 1.99727463722229
Epoch: 5, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.732 Vali Acc: 0.520 Test Loss: 0.732 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 2.051337242126465
Epoch: 6, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.729 Vali Acc: 0.520 Test Loss: 0.729 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 1.9888525009155273
Epoch: 7, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9694509506225586
Epoch: 8, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 2.0443809032440186
Epoch: 9, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 10 cost time: 2.217087745666504
Epoch: 10, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.732 Vali Acc: 0.520 Test Loss: 0.732 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.314250946044922
Epoch: 11, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0952134132385254
Epoch: 12, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.732 Vali Acc: 0.560 Test Loss: 0.732 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 13 cost time: 2.0649573802948
Epoch: 13, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.776 Vali Acc: 0.520 Test Loss: 0.776 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.192171096801758
Epoch: 14, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.765 Vali Acc: 0.550 Test Loss: 0.765 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.233813524246216
Epoch: 15, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.915 Vali Acc: 0.510 Test Loss: 0.915 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.137148141860962
Epoch: 16, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.807 Vali Acc: 0.510 Test Loss: 0.807 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1432278156280518
Epoch: 17, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.828 Vali Acc: 0.460 Test Loss: 0.828 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0221383571624756
Epoch: 18, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.784 Vali Acc: 0.540 Test Loss: 0.784 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.121872901916504
Epoch: 19, Steps: 20 | Train Loss: 0.395 Vali Loss: 0.852 Vali Acc: 0.530 Test Loss: 0.852 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.332728385925293
Epoch: 20, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.910 Vali Acc: 0.540 Test Loss: 0.910 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.207667350769043
Epoch: 21, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.974 Vali Acc: 0.560 Test Loss: 0.974 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.208516836166382
Epoch: 22, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.920 Vali Acc: 0.510 Test Loss: 0.920 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2350530
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.741081476211548
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.691 Vali Acc: 0.520 Test Loss: 0.691 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.3466858863830566
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.728 Vali Acc: 0.480 Test Loss: 0.728 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5406920909881592
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.733 Vali Acc: 0.490 Test Loss: 0.733 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5159504413604736
Epoch: 4, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.718 Vali Acc: 0.450 Test Loss: 0.718 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6046812534332275
Epoch: 5, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5077235698699951
Epoch: 6, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6598889827728271
Epoch: 7, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.715 Vali Acc: 0.480 Test Loss: 0.715 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5543186664581299
Epoch: 8, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.753 Vali Acc: 0.530 Test Loss: 0.753 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 9 cost time: 1.5493659973144531
Epoch: 9, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.752 Vali Acc: 0.460 Test Loss: 0.752 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5779986381530762
Epoch: 10, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.777 Vali Acc: 0.510 Test Loss: 0.777 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5967750549316406
Epoch: 11, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.788 Vali Acc: 0.480 Test Loss: 0.788 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4932847023010254
Epoch: 12, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.767 Vali Acc: 0.550 Test Loss: 0.767 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 13 cost time: 1.5280306339263916
Epoch: 13, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.794 Vali Acc: 0.560 Test Loss: 0.794 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 14 cost time: 1.572838544845581
Epoch: 14, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.849 Vali Acc: 0.520 Test Loss: 0.849 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5250279903411865
Epoch: 15, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.837 Vali Acc: 0.530 Test Loss: 0.837 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3753917217254639
Epoch: 16, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.824 Vali Acc: 0.600 Test Loss: 0.824 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599992).  Saving model ...
Epoch: 17 cost time: 1.5076992511749268
Epoch: 17, Steps: 20 | Train Loss: 0.383 Vali Loss: 0.925 Vali Acc: 0.530 Test Loss: 0.925 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5427851676940918
Epoch: 18, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.898 Vali Acc: 0.580 Test Loss: 0.898 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5805385112762451
Epoch: 19, Steps: 20 | Train Loss: 0.335 Vali Loss: 0.938 Vali Acc: 0.570 Test Loss: 0.938 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6320059299468994
Epoch: 20, Steps: 20 | Train Loss: 0.311 Vali Loss: 1.022 Vali Acc: 0.580 Test Loss: 1.022 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.530357837677002
Epoch: 21, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.037 Vali Acc: 0.560 Test Loss: 1.037 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5640950202941895
Epoch: 22, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.004 Vali Acc: 0.560 Test Loss: 1.004 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5178277492523193
Epoch: 23, Steps: 20 | Train Loss: 0.250 Vali Loss: 1.114 Vali Acc: 0.550 Test Loss: 1.114 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.504289150238037
Epoch: 24, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.072 Vali Acc: 0.550 Test Loss: 1.072 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5461671352386475
Epoch: 25, Steps: 20 | Train Loss: 0.234 Vali Loss: 1.026 Vali Acc: 0.570 Test Loss: 1.026 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.639775037765503
Epoch: 26, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.405 Vali Acc: 0.520 Test Loss: 1.405 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 695234
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.936105489730835
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.7190883159637451
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.696 Vali Acc: 0.460 Test Loss: 0.696 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7283215522766113
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.710 Vali Acc: 0.460 Test Loss: 0.710 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6863765716552734
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 1.697235345840454
Epoch: 5, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.732 Vali Acc: 0.530 Test Loss: 0.732 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 1.729719877243042
Epoch: 6, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.729 Vali Acc: 0.520 Test Loss: 0.729 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7227537631988525
Epoch: 7, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7181169986724854
Epoch: 8, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 1.7257640361785889
Epoch: 9, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.697 Vali Acc: 0.540 Test Loss: 0.697 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 10 cost time: 1.723355770111084
Epoch: 10, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5877559185028076
Epoch: 11, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.724158763885498
Epoch: 12, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.567866563796997
Epoch: 13, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.740 Vali Acc: 0.520 Test Loss: 0.740 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5667037963867188
Epoch: 14, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 15 cost time: 1.6343247890472412
Epoch: 15, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.832 Vali Acc: 0.550 Test Loss: 0.832 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.781642198562622
Epoch: 16, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7617900371551514
Epoch: 17, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.792 Vali Acc: 0.450 Test Loss: 0.792 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7107770442962646
Epoch: 18, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.796 Vali Acc: 0.470 Test Loss: 0.796 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6836886405944824
Epoch: 19, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.940 Vali Acc: 0.520 Test Loss: 0.940 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6797173023223877
Epoch: 20, Steps: 20 | Train Loss: 0.401 Vali Loss: 0.817 Vali Acc: 0.570 Test Loss: 0.817 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 21 cost time: 1.704017162322998
Epoch: 21, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.971 Vali Acc: 0.540 Test Loss: 0.971 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8053112030029297
Epoch: 22, Steps: 20 | Train Loss: 0.383 Vali Loss: 0.979 Vali Acc: 0.550 Test Loss: 0.979 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7945795059204102
Epoch: 23, Steps: 20 | Train Loss: 0.354 Vali Loss: 0.989 Vali Acc: 0.550 Test Loss: 0.989 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6585607528686523
Epoch: 24, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.009 Vali Acc: 0.530 Test Loss: 1.009 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.519599437713623
Epoch: 25, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.170 Vali Acc: 0.520 Test Loss: 1.170 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5840473175048828
Epoch: 26, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.145 Vali Acc: 0.510 Test Loss: 1.145 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4842617511749268
Epoch: 27, Steps: 20 | Train Loss: 0.312 Vali Loss: 1.261 Vali Acc: 0.490 Test Loss: 1.261 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7320911884307861
Epoch: 28, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.138 Vali Acc: 0.550 Test Loss: 1.138 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7132947444915771
Epoch: 29, Steps: 20 | Train Loss: 0.230 Vali Loss: 1.341 Vali Acc: 0.490 Test Loss: 1.341 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7711379528045654
Epoch: 30, Steps: 20 | Train Loss: 0.228 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2350530
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.590813159942627
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.690 Vali Acc: 0.520 Test Loss: 0.690 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.4528040885925293
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3101997375488281
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3926844596862793
Epoch: 4, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.716 Vali Acc: 0.470 Test Loss: 0.716 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3648631572723389
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3817884922027588
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3229913711547852
Epoch: 7, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.403658151626587
Epoch: 8, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.729 Vali Acc: 0.560 Test Loss: 0.729 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 1.4428155422210693
Epoch: 9, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3269212245941162
Epoch: 10, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.746 Vali Acc: 0.480 Test Loss: 0.746 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4133503437042236
Epoch: 11, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.758 Vali Acc: 0.530 Test Loss: 0.758 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3856406211853027
Epoch: 12, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.743 Vali Acc: 0.540 Test Loss: 0.743 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.36781907081604
Epoch: 13, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2902188301086426
Epoch: 14, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.805 Vali Acc: 0.520 Test Loss: 0.805 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2300198078155518
Epoch: 15, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.772 Vali Acc: 0.550 Test Loss: 0.772 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4482088088989258
Epoch: 16, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.755 Vali Acc: 0.590 Test Loss: 0.755 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589992).  Saving model ...
Epoch: 17 cost time: 1.1827256679534912
Epoch: 17, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.821 Vali Acc: 0.550 Test Loss: 0.821 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.24558424949646
Epoch: 18, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.807 Vali Acc: 0.560 Test Loss: 0.807 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3680956363677979
Epoch: 19, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.820 Vali Acc: 0.570 Test Loss: 0.820 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2310206890106201
Epoch: 20, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.930 Vali Acc: 0.540 Test Loss: 0.930 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3195693492889404
Epoch: 21, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.932 Vali Acc: 0.550 Test Loss: 0.932 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3498499393463135
Epoch: 22, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.831 Vali Acc: 0.520 Test Loss: 0.831 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3805632591247559
Epoch: 23, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.000 Vali Acc: 0.520 Test Loss: 1.000 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3808062076568604
Epoch: 24, Steps: 20 | Train Loss: 0.318 Vali Loss: 0.929 Vali Acc: 0.530 Test Loss: 0.929 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3794269561767578
Epoch: 25, Steps: 20 | Train Loss: 0.290 Vali Loss: 1.055 Vali Acc: 0.500 Test Loss: 1.055 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2486279010772705
Epoch: 26, Steps: 20 | Train Loss: 0.274 Vali Loss: 1.131 Vali Acc: 0.530 Test Loss: 1.131 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 695234
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.174867868423462
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.2764441967010498
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.696 Vali Acc: 0.460 Test Loss: 0.696 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1840784549713135
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.710 Vali Acc: 0.460 Test Loss: 0.710 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.168443202972412
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 1.2969067096710205
Epoch: 5, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 1.2114357948303223
Epoch: 6, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 1.4185807704925537
Epoch: 7, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2910144329071045
Epoch: 8, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 1.3365442752838135
Epoch: 9, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.695 Vali Acc: 0.540 Test Loss: 0.695 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 10 cost time: 1.3236396312713623
Epoch: 10, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3666930198669434
Epoch: 11, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.715 Vali Acc: 0.550 Test Loss: 0.715 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 1.2701845169067383
Epoch: 12, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.712 Vali Acc: 0.540 Test Loss: 0.712 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.303344488143921
Epoch: 13, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3373959064483643
Epoch: 14, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.711 Vali Acc: 0.550 Test Loss: 0.711 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 15 cost time: 1.306110143661499
Epoch: 15, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.818 Vali Acc: 0.560 Test Loss: 0.818 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 16 cost time: 1.102752923965454
Epoch: 16, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1186103820800781
Epoch: 17, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.774 Vali Acc: 0.440 Test Loss: 0.774 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2491304874420166
Epoch: 18, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2350287437438965
Epoch: 19, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2011919021606445
Epoch: 20, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.793 Vali Acc: 0.580 Test Loss: 0.793 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 21 cost time: 1.182328462600708
Epoch: 21, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.867 Vali Acc: 0.560 Test Loss: 0.867 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.302567481994629
Epoch: 22, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.860 Vali Acc: 0.580 Test Loss: 0.860 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2471575736999512
Epoch: 23, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.837 Vali Acc: 0.520 Test Loss: 0.837 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2743666172027588
Epoch: 24, Steps: 20 | Train Loss: 0.349 Vali Loss: 0.887 Vali Acc: 0.510 Test Loss: 0.887 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.345069408416748
Epoch: 25, Steps: 20 | Train Loss: 0.348 Vali Loss: 0.943 Vali Acc: 0.540 Test Loss: 0.943 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.293067455291748
Epoch: 26, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.010 Vali Acc: 0.490 Test Loss: 1.010 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2652509212493896
Epoch: 27, Steps: 20 | Train Loss: 0.343 Vali Loss: 0.970 Vali Acc: 0.510 Test Loss: 0.970 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2855234146118164
Epoch: 28, Steps: 20 | Train Loss: 0.301 Vali Loss: 0.959 Vali Acc: 0.530 Test Loss: 0.959 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3537189960479736
Epoch: 29, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3784606456756592
Epoch: 30, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.070 Vali Acc: 0.550 Test Loss: 1.070 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2350530
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.192561626434326
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.690 Vali Acc: 0.520 Test Loss: 0.690 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.073500394821167
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0038039684295654
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9905173778533936
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.715 Vali Acc: 0.480 Test Loss: 0.715 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1212973594665527
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0391950607299805
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0405960083007812
Epoch: 7, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.705 Vali Acc: 0.470 Test Loss: 0.705 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.173630714416504
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.727 Vali Acc: 0.570 Test Loss: 0.727 Test Acc: 0.570
Validation loss decreased (-0.519993 --> -0.569993).  Saving model ...
Epoch: 9 cost time: 1.0472490787506104
Epoch: 9, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.723 Vali Acc: 0.490 Test Loss: 0.723 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9821047782897949
Epoch: 10, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.932746171951294
Epoch: 11, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0775153636932373
Epoch: 12, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.733 Vali Acc: 0.510 Test Loss: 0.733 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9726054668426514
Epoch: 13, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.705 Vali Acc: 0.540 Test Loss: 0.705 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0490930080413818
Epoch: 14, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.782 Vali Acc: 0.560 Test Loss: 0.782 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0201117992401123
Epoch: 15, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.765 Vali Acc: 0.530 Test Loss: 0.765 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.03364896774292
Epoch: 16, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9246485233306885
Epoch: 17, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.788 Vali Acc: 0.540 Test Loss: 0.788 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.060316562652588
Epoch: 18, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 695234
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4780893325805664
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.769 Vali Acc: 0.460 Test Loss: 0.769 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 2.1870899200439453
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.717 Vali Acc: 0.470 Test Loss: 0.717 Test Acc: 0.470
Validation loss decreased (-0.459992 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 2.1813178062438965
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 2.2344770431518555
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.715 Vali Acc: 0.460 Test Loss: 0.715 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9789929389953613
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.708 Vali Acc: 0.520 Test Loss: 0.708 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 2.1952626705169678
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0265493392944336
Epoch: 7, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2404263019561768
Epoch: 8, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.267354965209961
Epoch: 9, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2640647888183594
Epoch: 10, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 2.1932265758514404
Epoch: 11, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.755 Vali Acc: 0.480 Test Loss: 0.755 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1602578163146973
Epoch: 12, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.760 Vali Acc: 0.490 Test Loss: 0.760 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2845513820648193
Epoch: 13, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1679065227508545
Epoch: 14, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.740 Vali Acc: 0.540 Test Loss: 0.740 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9816374778747559
Epoch: 15, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.799 Vali Acc: 0.530 Test Loss: 0.799 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9875850677490234
Epoch: 16, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.748 Vali Acc: 0.610 Test Loss: 0.748 Test Acc: 0.610
Validation loss decreased (-0.539993 --> -0.609993).  Saving model ...
Epoch: 17 cost time: 2.047947883605957
Epoch: 17, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.804 Vali Acc: 0.580 Test Loss: 0.804 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1647872924804688
Epoch: 18, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.199338436126709
Epoch: 19, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.742 Vali Acc: 0.580 Test Loss: 0.742 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.074620008468628
Epoch: 20, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.847 Vali Acc: 0.550 Test Loss: 0.847 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2905619144439697
Epoch: 21, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.835 Vali Acc: 0.510 Test Loss: 0.835 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1750025749206543
Epoch: 22, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.786 Vali Acc: 0.560 Test Loss: 0.786 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1515300273895264
Epoch: 23, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.888 Vali Acc: 0.530 Test Loss: 0.888 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.178759813308716
Epoch: 24, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.798 Vali Acc: 0.580 Test Loss: 0.798 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.1391096115112305
Epoch: 25, Steps: 20 | Train Loss: 0.357 Vali Loss: 0.919 Vali Acc: 0.540 Test Loss: 0.919 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.166975736618042
Epoch: 26, Steps: 20 | Train Loss: 0.339 Vali Loss: 0.979 Vali Acc: 0.480 Test Loss: 0.979 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2347874
model size : 9.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.929246425628662
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.715 Vali Acc: 0.450 Test Loss: 0.715 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.593174695968628
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.699 Vali Acc: 0.480 Test Loss: 0.699 Test Acc: 0.480
Validation loss decreased (-0.449993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.5249059200286865
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.696 Vali Acc: 0.490 Test Loss: 0.696 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 1.722945213317871
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.6661701202392578
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.700 Vali Acc: 0.490 Test Loss: 0.700 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6569888591766357
Epoch: 6, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4099388122558594
Epoch: 7, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.713 Vali Acc: 0.470 Test Loss: 0.713 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5583751201629639
Epoch: 8, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 9 cost time: 1.4937973022460938
Epoch: 9, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.697 Vali Acc: 0.520 Test Loss: 0.697 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 10 cost time: 1.5464518070220947
Epoch: 10, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.691 Vali Acc: 0.540 Test Loss: 0.691 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.598092794418335
Epoch: 11, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.720 Vali Acc: 0.480 Test Loss: 0.720 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.545877456665039
Epoch: 12, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.694 Vali Acc: 0.520 Test Loss: 0.694 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5647368431091309
Epoch: 13, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.717 Vali Acc: 0.570 Test Loss: 0.717 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 14 cost time: 1.5578067302703857
Epoch: 14, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6185743808746338
Epoch: 15, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.788 Vali Acc: 0.570 Test Loss: 0.788 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.618474006652832
Epoch: 16, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.725 Vali Acc: 0.530 Test Loss: 0.725 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.593280553817749
Epoch: 17, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.860 Vali Acc: 0.540 Test Loss: 0.860 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6203725337982178
Epoch: 18, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.773 Vali Acc: 0.530 Test Loss: 0.773 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.595109224319458
Epoch: 19, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.757 Vali Acc: 0.590 Test Loss: 0.757 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 20 cost time: 1.5823338031768799
Epoch: 20, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.828 Vali Acc: 0.580 Test Loss: 0.828 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7936506271362305
Epoch: 21, Steps: 20 | Train Loss: 0.370 Vali Loss: 0.737 Vali Acc: 0.620 Test Loss: 0.737 Test Acc: 0.620
Validation loss decreased (-0.589992 --> -0.619993).  Saving model ...
Epoch: 22 cost time: 1.608370304107666
Epoch: 22, Steps: 20 | Train Loss: 0.352 Vali Loss: 0.869 Vali Acc: 0.560 Test Loss: 0.869 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6751205921173096
Epoch: 23, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.829 Vali Acc: 0.590 Test Loss: 0.829 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.599186658859253
Epoch: 24, Steps: 20 | Train Loss: 0.316 Vali Loss: 0.927 Vali Acc: 0.550 Test Loss: 0.927 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.584362506866455
Epoch: 25, Steps: 20 | Train Loss: 0.258 Vali Loss: 0.887 Vali Acc: 0.620 Test Loss: 0.887 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.636526346206665
Epoch: 26, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.063 Vali Acc: 0.550 Test Loss: 1.063 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4908695220947266
Epoch: 27, Steps: 20 | Train Loss: 0.284 Vali Loss: 0.905 Vali Acc: 0.630 Test Loss: 0.905 Test Acc: 0.630
Validation loss decreased (-0.619993 --> -0.629991).  Saving model ...
Epoch: 28 cost time: 1.6328716278076172
Epoch: 28, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.009 Vali Acc: 0.560 Test Loss: 1.009 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6217072010040283
Epoch: 29, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.135 Vali Acc: 0.580 Test Loss: 1.135 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6602392196655273
Epoch: 30, Steps: 20 | Train Loss: 0.228 Vali Loss: 0.982 Vali Acc: 0.620 Test Loss: 0.982 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 692450
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.919796943664551
Epoch: 1, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.768 Vali Acc: 0.460 Test Loss: 0.768 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.5556542873382568
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.716 Vali Acc: 0.470 Test Loss: 0.716 Test Acc: 0.470
Validation loss decreased (-0.459992 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 1.6583456993103027
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.705 Vali Acc: 0.490 Test Loss: 0.705 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 1.8109571933746338
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.714 Vali Acc: 0.480 Test Loss: 0.714 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6599478721618652
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 1.6118528842926025
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5879714488983154
Epoch: 7, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 1.6415834426879883
Epoch: 8, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4485764503479004
Epoch: 9, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5624232292175293
Epoch: 10, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6296792030334473
Epoch: 11, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5477957725524902
Epoch: 12, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.562068223953247
Epoch: 13, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5657618045806885
Epoch: 14, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.735 Vali Acc: 0.560 Test Loss: 0.735 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 15 cost time: 1.667478084564209
Epoch: 15, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.767 Vali Acc: 0.540 Test Loss: 0.767 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7137868404388428
Epoch: 16, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.713 Vali Acc: 0.570 Test Loss: 0.713 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 17 cost time: 1.6599164009094238
Epoch: 17, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5486652851104736
Epoch: 18, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.770 Vali Acc: 0.590 Test Loss: 0.770 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 19 cost time: 1.6316404342651367
Epoch: 19, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.686 Vali Acc: 0.600 Test Loss: 0.686 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599993).  Saving model ...
Epoch: 20 cost time: 1.609090805053711
Epoch: 20, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.789 Vali Acc: 0.570 Test Loss: 0.789 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6194050312042236
Epoch: 21, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6487791538238525
Epoch: 22, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.731 Vali Acc: 0.590 Test Loss: 0.731 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6469831466674805
Epoch: 23, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.785 Vali Acc: 0.560 Test Loss: 0.785 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6706528663635254
Epoch: 24, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6262929439544678
Epoch: 25, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5667636394500732
Epoch: 26, Steps: 20 | Train Loss: 0.383 Vali Loss: 0.836 Vali Acc: 0.570 Test Loss: 0.836 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6756021976470947
Epoch: 27, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.888 Vali Acc: 0.510 Test Loss: 0.888 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6425514221191406
Epoch: 28, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.817 Vali Acc: 0.610 Test Loss: 0.817 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609992).  Saving model ...
Epoch: 29 cost time: 1.613178014755249
Epoch: 29, Steps: 20 | Train Loss: 0.344 Vali Loss: 0.861 Vali Acc: 0.520 Test Loss: 0.861 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7254228591918945
Epoch: 30, Steps: 20 | Train Loss: 0.316 Vali Loss: 0.985 Vali Acc: 0.520 Test Loss: 0.985 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2347874
model size : 9.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.49364972114563
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.715 Vali Acc: 0.450 Test Loss: 0.715 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.3536412715911865
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.699 Vali Acc: 0.480 Test Loss: 0.699 Test Acc: 0.480
Validation loss decreased (-0.449993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.4037683010101318
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.696 Vali Acc: 0.480 Test Loss: 0.696 Test Acc: 0.480
Validation loss decreased (-0.479993 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 1.1748263835906982
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.3213114738464355
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.700 Vali Acc: 0.480 Test Loss: 0.700 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2714776992797852
Epoch: 6, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3359947204589844
Epoch: 7, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.711 Vali Acc: 0.490 Test Loss: 0.711 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4365475177764893
Epoch: 8, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 9 cost time: 1.4298396110534668
Epoch: 9, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.697 Vali Acc: 0.520 Test Loss: 0.697 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 10 cost time: 1.337489366531372
Epoch: 10, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.687 Vali Acc: 0.560 Test Loss: 0.687 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 11 cost time: 1.442115306854248
Epoch: 11, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.702 Vali Acc: 0.490 Test Loss: 0.702 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3263323307037354
Epoch: 12, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.695 Vali Acc: 0.490 Test Loss: 0.695 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.406055212020874
Epoch: 13, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.700 Vali Acc: 0.530 Test Loss: 0.700 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2935686111450195
Epoch: 14, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.708 Vali Acc: 0.540 Test Loss: 0.708 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2980704307556152
Epoch: 15, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3994555473327637
Epoch: 16, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.719 Vali Acc: 0.520 Test Loss: 0.719 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.344071865081787
Epoch: 17, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.744 Vali Acc: 0.550 Test Loss: 0.744 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4105181694030762
Epoch: 18, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.751 Vali Acc: 0.520 Test Loss: 0.751 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.285111665725708
Epoch: 19, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.735 Vali Acc: 0.550 Test Loss: 0.735 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.399885654449463
Epoch: 20, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.844 Vali Acc: 0.490 Test Loss: 0.844 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 692450
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.277562379837036
Epoch: 1, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.768 Vali Acc: 0.460 Test Loss: 0.768 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.2735600471496582
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.716 Vali Acc: 0.480 Test Loss: 0.716 Test Acc: 0.480
Validation loss decreased (-0.459992 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.13084077835083
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.704 Vali Acc: 0.490 Test Loss: 0.704 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 1.2802081108093262
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.713 Vali Acc: 0.480 Test Loss: 0.713 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3024487495422363
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 1.2492902278900146
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.317873239517212
Epoch: 7, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 1.2255382537841797
Epoch: 8, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.212792158126831
Epoch: 9, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1991920471191406
Epoch: 10, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.701 Vali Acc: 0.550 Test Loss: 0.701 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 11 cost time: 1.2318859100341797
Epoch: 11, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1913213729858398
Epoch: 12, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1393544673919678
Epoch: 13, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2528750896453857
Epoch: 14, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2450745105743408
Epoch: 15, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2570304870605469
Epoch: 16, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.690 Vali Acc: 0.580 Test Loss: 0.690 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 17 cost time: 1.2911059856414795
Epoch: 17, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.703 Vali Acc: 0.550 Test Loss: 0.703 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2054083347320557
Epoch: 18, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.724 Vali Acc: 0.580 Test Loss: 0.724 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2072229385375977
Epoch: 19, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.679 Vali Acc: 0.620 Test Loss: 0.679 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619993).  Saving model ...
Epoch: 20 cost time: 1.2718935012817383
Epoch: 20, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.761 Vali Acc: 0.580 Test Loss: 0.761 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2974748611450195
Epoch: 21, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.727 Vali Acc: 0.560 Test Loss: 0.727 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1245718002319336
Epoch: 22, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.702 Vali Acc: 0.600 Test Loss: 0.702 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.209031105041504
Epoch: 23, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.738 Vali Acc: 0.620 Test Loss: 0.738 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9529759883880615
Epoch: 24, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.717 Vali Acc: 0.580 Test Loss: 0.717 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.159933090209961
Epoch: 25, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.775 Vali Acc: 0.640 Test Loss: 0.775 Test Acc: 0.640
Validation loss decreased (-0.619993 --> -0.639992).  Saving model ...
Epoch: 26 cost time: 1.1866037845611572
Epoch: 26, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.823 Vali Acc: 0.590 Test Loss: 0.823 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1770408153533936
Epoch: 27, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.798 Vali Acc: 0.580 Test Loss: 0.798 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2402825355529785
Epoch: 28, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.786 Vali Acc: 0.610 Test Loss: 0.786 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1089539527893066
Epoch: 29, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.783 Vali Acc: 0.560 Test Loss: 0.783 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.171363353729248
Epoch: 30, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.780 Vali Acc: 0.560 Test Loss: 0.780 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 2347874
model size : 9.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 1.9716486930847168
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.715 Vali Acc: 0.450 Test Loss: 0.715 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.0425453186035156
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.699 Vali Acc: 0.480 Test Loss: 0.699 Test Acc: 0.480
Validation loss decreased (-0.449993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 0.9971089363098145
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.696 Vali Acc: 0.490 Test Loss: 0.696 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 1.0201096534729004
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.0527706146240234
Epoch: 5, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.701 Vali Acc: 0.480 Test Loss: 0.701 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8707115650177002
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.714 Vali Acc: 0.480 Test Loss: 0.714 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8953368663787842
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.720 Vali Acc: 0.450 Test Loss: 0.720 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1589629650115967
Epoch: 8, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.717 Vali Acc: 0.470 Test Loss: 0.717 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0224459171295166
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.703 Vali Acc: 0.520 Test Loss: 0.703 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 10 cost time: 0.995955228805542
Epoch: 10, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.696 Vali Acc: 0.490 Test Loss: 0.696 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9606337547302246
Epoch: 11, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9771523475646973
Epoch: 12, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.699 Vali Acc: 0.550 Test Loss: 0.699 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 13 cost time: 0.9914748668670654
Epoch: 13, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.696 Vali Acc: 0.540 Test Loss: 0.696 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.026700496673584
Epoch: 14, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.699 Vali Acc: 0.560 Test Loss: 0.699 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 15 cost time: 1.0670852661132812
Epoch: 15, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.076305866241455
Epoch: 16, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0408985614776611
Epoch: 17, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.722 Vali Acc: 0.530 Test Loss: 0.722 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0285139083862305
Epoch: 18, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9622890949249268
Epoch: 19, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.716 Vali Acc: 0.590 Test Loss: 0.716 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 20 cost time: 0.911292552947998
Epoch: 20, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0997085571289062
Epoch: 21, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9523530006408691
Epoch: 22, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.806 Vali Acc: 0.510 Test Loss: 0.806 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.127138376235962
Epoch: 23, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.770 Vali Acc: 0.600 Test Loss: 0.770 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 24 cost time: 1.2121074199676514
Epoch: 24, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.784 Vali Acc: 0.480 Test Loss: 0.784 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1198101043701172
Epoch: 25, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.772 Vali Acc: 0.530 Test Loss: 0.772 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.187833309173584
Epoch: 26, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.848 Vali Acc: 0.520 Test Loss: 0.848 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.15299654006958
Epoch: 27, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.799 Vali Acc: 0.540 Test Loss: 0.799 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.082115888595581
Epoch: 28, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0470073223114014
Epoch: 29, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.853 Vali Acc: 0.570 Test Loss: 0.853 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0197649002075195
Epoch: 30, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.847 Vali Acc: 0.560 Test Loss: 0.847 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 692450
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2175028324127197
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.683 Vali Acc: 0.530 Test Loss: 0.683 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.925755500793457
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.690 Vali Acc: 0.440 Test Loss: 0.690 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9261207580566406
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.684 Vali Acc: 0.460 Test Loss: 0.684 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.107839345932007
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.700 Vali Acc: 0.480 Test Loss: 0.700 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8788321018218994
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.698 Vali Acc: 0.530 Test Loss: 0.698 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0392861366271973
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.682 Vali Acc: 0.540 Test Loss: 0.682 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 1.7922992706298828
Epoch: 7, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.709 Vali Acc: 0.470 Test Loss: 0.709 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.03464412689209
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8601782321929932
Epoch: 9, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.719 Vali Acc: 0.480 Test Loss: 0.719 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8984460830688477
Epoch: 10, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9203507900238037
Epoch: 11, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.727 Vali Acc: 0.560 Test Loss: 0.727 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 12 cost time: 1.9655585289001465
Epoch: 12, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0346057415008545
Epoch: 13, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.772 Vali Acc: 0.470 Test Loss: 0.772 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.929309606552124
Epoch: 14, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8394536972045898
Epoch: 15, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9760429859161377
Epoch: 16, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.819 Vali Acc: 0.520 Test Loss: 0.819 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.843848705291748
Epoch: 17, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.854 Vali Acc: 0.500 Test Loss: 0.854 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9926800727844238
Epoch: 18, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9262096881866455
Epoch: 19, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.821 Vali Acc: 0.530 Test Loss: 0.821 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8394992351531982
Epoch: 20, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7651281356811523
Epoch: 21, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.886 Vali Acc: 0.530 Test Loss: 0.886 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1175650
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.832282304763794
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.718 Vali Acc: 0.450 Test Loss: 0.718 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.5636649131774902
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.708 Vali Acc: 0.440 Test Loss: 0.708 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.545605182647705
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.4813380241394043
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.713 Vali Acc: 0.480 Test Loss: 0.713 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4943349361419678
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.733 Vali Acc: 0.450 Test Loss: 0.733 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5347998142242432
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.729 Vali Acc: 0.420 Test Loss: 0.729 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.750204086303711
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 1.4584379196166992
Epoch: 8, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.55043625831604
Epoch: 9, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5560791492462158
Epoch: 10, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.762 Vali Acc: 0.460 Test Loss: 0.762 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5795347690582275
Epoch: 11, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4932708740234375
Epoch: 12, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7004940509796143
Epoch: 13, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.723 Vali Acc: 0.530 Test Loss: 0.723 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 14 cost time: 1.6519689559936523
Epoch: 14, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6707634925842285
Epoch: 15, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.759 Vali Acc: 0.470 Test Loss: 0.759 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5627734661102295
Epoch: 16, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.751 Vali Acc: 0.480 Test Loss: 0.751 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5724148750305176
Epoch: 17, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.783 Vali Acc: 0.450 Test Loss: 0.783 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6027395725250244
Epoch: 18, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.782 Vali Acc: 0.500 Test Loss: 0.782 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.654308557510376
Epoch: 19, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.785 Vali Acc: 0.480 Test Loss: 0.785 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5366237163543701
Epoch: 20, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.808 Vali Acc: 0.470 Test Loss: 0.808 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5544216632843018
Epoch: 21, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.787 Vali Acc: 0.480 Test Loss: 0.787 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5571208000183105
Epoch: 22, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.810 Vali Acc: 0.490 Test Loss: 0.810 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5133869647979736
Epoch: 23, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.893 Vali Acc: 0.420 Test Loss: 0.893 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 347874
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.046424150466919
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.682 Vali Acc: 0.540 Test Loss: 0.682 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.5576412677764893
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.690 Vali Acc: 0.440 Test Loss: 0.690 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6463522911071777
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.684 Vali Acc: 0.460 Test Loss: 0.684 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5833697319030762
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.700 Vali Acc: 0.480 Test Loss: 0.700 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6016077995300293
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.698 Vali Acc: 0.520 Test Loss: 0.698 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5841753482818604
Epoch: 6, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.682 Vali Acc: 0.550 Test Loss: 0.682 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 1.6137824058532715
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.705 Vali Acc: 0.480 Test Loss: 0.705 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.614433765411377
Epoch: 8, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.707 Vali Acc: 0.480 Test Loss: 0.707 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5505421161651611
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.701 Vali Acc: 0.490 Test Loss: 0.701 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6007533073425293
Epoch: 10, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.599989414215088
Epoch: 11, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.695 Vali Acc: 0.550 Test Loss: 0.695 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6656033992767334
Epoch: 12, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.705 Vali Acc: 0.490 Test Loss: 0.705 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.634880542755127
Epoch: 13, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.554941177368164
Epoch: 14, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.695 Vali Acc: 0.520 Test Loss: 0.695 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7835156917572021
Epoch: 15, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6713097095489502
Epoch: 16, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1175650
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.3452181816101074
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.719 Vali Acc: 0.450 Test Loss: 0.719 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.2912602424621582
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.708 Vali Acc: 0.450 Test Loss: 0.708 Test Acc: 0.450
Validation loss decreased (-0.449993 --> -0.449993).  Saving model ...
Epoch: 3 cost time: 1.4192628860473633
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.3469903469085693
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.712 Vali Acc: 0.470 Test Loss: 0.712 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3726177215576172
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.730 Vali Acc: 0.460 Test Loss: 0.730 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.332451343536377
Epoch: 6, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.722 Vali Acc: 0.450 Test Loss: 0.722 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2537977695465088
Epoch: 7, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3321948051452637
Epoch: 8, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1987125873565674
Epoch: 9, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 10 cost time: 1.292518138885498
Epoch: 10, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3267998695373535
Epoch: 11, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.756 Vali Acc: 0.460 Test Loss: 0.756 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3644423484802246
Epoch: 12, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.753 Vali Acc: 0.460 Test Loss: 0.753 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2931411266326904
Epoch: 13, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 14 cost time: 1.2476625442504883
Epoch: 14, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3237838745117188
Epoch: 15, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.758 Vali Acc: 0.480 Test Loss: 0.758 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4594614505767822
Epoch: 16, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2758293151855469
Epoch: 17, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.787 Vali Acc: 0.440 Test Loss: 0.787 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2859244346618652
Epoch: 18, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.292006254196167
Epoch: 19, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3364882469177246
Epoch: 20, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2415564060211182
Epoch: 21, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.782 Vali Acc: 0.480 Test Loss: 0.782 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4491310119628906
Epoch: 22, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.801 Vali Acc: 0.530 Test Loss: 0.801 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 23 cost time: 1.3065941333770752
Epoch: 23, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.815 Vali Acc: 0.480 Test Loss: 0.815 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4368376731872559
Epoch: 24, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3873264789581299
Epoch: 25, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.856 Vali Acc: 0.530 Test Loss: 0.856 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.326794147491455
Epoch: 26, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.856 Vali Acc: 0.510 Test Loss: 0.856 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3544061183929443
Epoch: 27, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.856 Vali Acc: 0.530 Test Loss: 0.856 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3915185928344727
Epoch: 28, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.839 Vali Acc: 0.510 Test Loss: 0.839 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2844328880310059
Epoch: 29, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.895 Vali Acc: 0.490 Test Loss: 0.895 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2580451965332031
Epoch: 30, Steps: 20 | Train Loss: 0.325 Vali Loss: 0.874 Vali Acc: 0.540 Test Loss: 0.874 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539991).  Saving model ...
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 347874
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.3009915351867676
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.682 Vali Acc: 0.540 Test Loss: 0.682 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.1149954795837402
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.690 Vali Acc: 0.450 Test Loss: 0.690 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3435697555541992
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.684 Vali Acc: 0.460 Test Loss: 0.684 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4188694953918457
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.700 Vali Acc: 0.480 Test Loss: 0.700 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3303332328796387
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2941064834594727
Epoch: 6, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.682 Vali Acc: 0.550 Test Loss: 0.682 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 1.1376826763153076
Epoch: 7, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.706 Vali Acc: 0.490 Test Loss: 0.706 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.333392858505249
Epoch: 8, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.708 Vali Acc: 0.480 Test Loss: 0.708 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1168406009674072
Epoch: 9, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.25589919090271
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.709 Vali Acc: 0.520 Test Loss: 0.709 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2221777439117432
Epoch: 11, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.697 Vali Acc: 0.550 Test Loss: 0.697 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1401119232177734
Epoch: 12, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.708 Vali Acc: 0.490 Test Loss: 0.708 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2115662097930908
Epoch: 13, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.712 Vali Acc: 0.480 Test Loss: 0.712 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3085436820983887
Epoch: 14, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.275974988937378
Epoch: 15, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.712 Vali Acc: 0.560 Test Loss: 0.712 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 16 cost time: 1.2622077465057373
Epoch: 16, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.708 Vali Acc: 0.550 Test Loss: 0.708 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.260242223739624
Epoch: 17, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2720534801483154
Epoch: 18, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2422277927398682
Epoch: 19, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.225248098373413
Epoch: 20, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.716 Vali Acc: 0.540 Test Loss: 0.716 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1414992809295654
Epoch: 21, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1508831977844238
Epoch: 22, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1463966369628906
Epoch: 23, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.748 Vali Acc: 0.560 Test Loss: 0.748 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1462316513061523
Epoch: 24, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.788 Vali Acc: 0.520 Test Loss: 0.788 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3113255500793457
Epoch: 25, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.769 Vali Acc: 0.560 Test Loss: 0.769 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1175650
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.085812568664551
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.720 Vali Acc: 0.450 Test Loss: 0.720 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 0.96071457862854
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.709 Vali Acc: 0.450 Test Loss: 0.709 Test Acc: 0.450
Validation loss decreased (-0.449993 --> -0.449993).  Saving model ...
Epoch: 3 cost time: 1.011723518371582
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.025099515914917
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.712 Vali Acc: 0.460 Test Loss: 0.712 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9411976337432861
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.731 Vali Acc: 0.460 Test Loss: 0.731 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9864380359649658
Epoch: 6, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.722 Vali Acc: 0.440 Test Loss: 0.722 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9047896862030029
Epoch: 7, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0357074737548828
Epoch: 8, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9975016117095947
Epoch: 9, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.000023365020752
Epoch: 10, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.749 Vali Acc: 0.460 Test Loss: 0.749 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9981722831726074
Epoch: 11, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.752 Vali Acc: 0.450 Test Loss: 0.752 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0765941143035889
Epoch: 12, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.753 Vali Acc: 0.470 Test Loss: 0.753 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9966959953308105
Epoch: 13, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.723 Vali Acc: 0.460 Test Loss: 0.723 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 347874
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.197519540786743
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.675 Vali Acc: 0.590 Test Loss: 0.675 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.9713108539581299
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.688 Vali Acc: 0.580 Test Loss: 0.688 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9214344024658203
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.697 Vali Acc: 0.550 Test Loss: 0.697 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9113001823425293
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9091613292694092
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.713 Vali Acc: 0.470 Test Loss: 0.713 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.777256727218628
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8664557933807373
Epoch: 7, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9235496520996094
Epoch: 8, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8180510997772217
Epoch: 9, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.744 Vali Acc: 0.450 Test Loss: 0.744 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6634776592254639
Epoch: 10, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.738 Vali Acc: 0.460 Test Loss: 0.738 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0625531673431396
Epoch: 11, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 589538
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.518244981765747
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.720 Vali Acc: 0.390 Test Loss: 0.720 Test Acc: 0.390
Validation loss decreased (inf --> -0.389993).  Saving model ...
Epoch: 2 cost time: 1.4449477195739746
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.718 Vali Acc: 0.410 Test Loss: 0.718 Test Acc: 0.410
Validation loss decreased (-0.389993 --> -0.409993).  Saving model ...
Epoch: 3 cost time: 1.437587022781372
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
Validation loss decreased (-0.409993 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 1.5424540042877197
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.724 Vali Acc: 0.460 Test Loss: 0.724 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4039232730865479
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.728 Vali Acc: 0.450 Test Loss: 0.728 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5964980125427246
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.712 Vali Acc: 0.480 Test Loss: 0.712 Test Acc: 0.480
Validation loss decreased (-0.479993 --> -0.479993).  Saving model ...
Epoch: 7 cost time: 1.4642810821533203
Epoch: 7, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.720 Vali Acc: 0.460 Test Loss: 0.720 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5355339050292969
Epoch: 8, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.728 Vali Acc: 0.460 Test Loss: 0.728 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6072330474853516
Epoch: 9, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.711 Vali Acc: 0.480 Test Loss: 0.711 Test Acc: 0.480
Validation loss decreased (-0.479993 --> -0.479993).  Saving model ...
Epoch: 10 cost time: 1.518491506576538
Epoch: 10, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.727 Vali Acc: 0.470 Test Loss: 0.727 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5423767566680908
Epoch: 11, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 12 cost time: 1.4642317295074463
Epoch: 12, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4560985565185547
Epoch: 13, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.405919075012207
Epoch: 14, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4458105564117432
Epoch: 15, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.738 Vali Acc: 0.460 Test Loss: 0.738 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3436906337738037
Epoch: 16, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.769 Vali Acc: 0.480 Test Loss: 0.769 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4103710651397705
Epoch: 17, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.774 Vali Acc: 0.480 Test Loss: 0.774 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.551473617553711
Epoch: 18, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4989111423492432
Epoch: 19, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.804 Vali Acc: 0.570 Test Loss: 0.804 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569992).  Saving model ...
Epoch: 20 cost time: 1.5334203243255615
Epoch: 20, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.806 Vali Acc: 0.540 Test Loss: 0.806 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4161567687988281
Epoch: 21, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5472497940063477
Epoch: 22, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4495477676391602
Epoch: 23, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.891 Vali Acc: 0.540 Test Loss: 0.891 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4961092472076416
Epoch: 24, Steps: 20 | Train Loss: 0.366 Vali Loss: 0.883 Vali Acc: 0.520 Test Loss: 0.883 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4897964000701904
Epoch: 25, Steps: 20 | Train Loss: 0.367 Vali Loss: 0.949 Vali Acc: 0.550 Test Loss: 0.949 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5310800075531006
Epoch: 26, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.896 Vali Acc: 0.570 Test Loss: 0.896 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3654944896697998
Epoch: 27, Steps: 20 | Train Loss: 0.355 Vali Loss: 0.923 Vali Acc: 0.580 Test Loss: 0.923 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579991).  Saving model ...
Epoch: 28 cost time: 1.4417245388031006
Epoch: 28, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.930 Vali Acc: 0.570 Test Loss: 0.930 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5672833919525146
Epoch: 29, Steps: 20 | Train Loss: 0.324 Vali Loss: 0.981 Vali Acc: 0.530 Test Loss: 0.981 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5411183834075928
Epoch: 30, Steps: 20 | Train Loss: 0.313 Vali Loss: 0.974 Vali Acc: 0.570 Test Loss: 0.974 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 175586
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7077438831329346
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.675 Vali Acc: 0.590 Test Loss: 0.675 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.5328783988952637
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.687 Vali Acc: 0.590 Test Loss: 0.687 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5732710361480713
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.696 Vali Acc: 0.560 Test Loss: 0.696 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6485769748687744
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5406193733215332
Epoch: 5, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.712 Vali Acc: 0.480 Test Loss: 0.712 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.669067144393921
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.714 Vali Acc: 0.490 Test Loss: 0.714 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.567331075668335
Epoch: 7, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.729 Vali Acc: 0.480 Test Loss: 0.729 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.620018482208252
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6326987743377686
Epoch: 9, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.731 Vali Acc: 0.470 Test Loss: 0.731 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5918941497802734
Epoch: 10, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.729 Vali Acc: 0.480 Test Loss: 0.729 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5027778148651123
Epoch: 11, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 589538
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.3313305377960205
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.720 Vali Acc: 0.380 Test Loss: 0.720 Test Acc: 0.380
Validation loss decreased (inf --> -0.379993).  Saving model ...
Epoch: 2 cost time: 1.2582430839538574
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.718 Vali Acc: 0.410 Test Loss: 0.718 Test Acc: 0.410
Validation loss decreased (-0.379993 --> -0.409993).  Saving model ...
Epoch: 3 cost time: 1.1717960834503174
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.723 Vali Acc: 0.480 Test Loss: 0.723 Test Acc: 0.480
Validation loss decreased (-0.409993 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 1.2071964740753174
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.724 Vali Acc: 0.470 Test Loss: 0.724 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4038522243499756
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.728 Vali Acc: 0.450 Test Loss: 0.728 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3354377746582031
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.711 Vali Acc: 0.490 Test Loss: 0.711 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 7 cost time: 1.3195805549621582
Epoch: 7, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.719 Vali Acc: 0.480 Test Loss: 0.719 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3567883968353271
Epoch: 8, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3161420822143555
Epoch: 9, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.710 Vali Acc: 0.480 Test Loss: 0.710 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3843910694122314
Epoch: 10, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3274147510528564
Epoch: 11, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 12 cost time: 1.2453110218048096
Epoch: 12, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3833439350128174
Epoch: 13, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.179631233215332
Epoch: 14, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.738 Vali Acc: 0.540 Test Loss: 0.738 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 15 cost time: 1.4466867446899414
Epoch: 15, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.265869140625
Epoch: 16, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4218640327453613
Epoch: 17, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3242833614349365
Epoch: 18, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.745 Vali Acc: 0.540 Test Loss: 0.745 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3475205898284912
Epoch: 19, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.290785312652588
Epoch: 20, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.781 Vali Acc: 0.480 Test Loss: 0.781 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2512316703796387
Epoch: 21, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3239059448242188
Epoch: 22, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.836 Vali Acc: 0.550 Test Loss: 0.836 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 23 cost time: 1.3065621852874756
Epoch: 23, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.822 Vali Acc: 0.560 Test Loss: 0.822 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 24 cost time: 1.3278985023498535
Epoch: 24, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.813 Vali Acc: 0.540 Test Loss: 0.813 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.341421365737915
Epoch: 25, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.826 Vali Acc: 0.560 Test Loss: 0.826 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3290610313415527
Epoch: 26, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.850 Vali Acc: 0.520 Test Loss: 0.850 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4125409126281738
Epoch: 27, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.960 Vali Acc: 0.520 Test Loss: 0.960 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2751495838165283
Epoch: 28, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.876 Vali Acc: 0.550 Test Loss: 0.876 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2423889636993408
Epoch: 29, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.844 Vali Acc: 0.550 Test Loss: 0.844 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.209200382232666
Epoch: 30, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.893 Vali Acc: 0.550 Test Loss: 0.893 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 175586
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.2445333003997803
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.675 Vali Acc: 0.590 Test Loss: 0.675 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.1801891326904297
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.687 Vali Acc: 0.590 Test Loss: 0.687 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2152507305145264
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.696 Vali Acc: 0.560 Test Loss: 0.696 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.144420862197876
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.237656593322754
Epoch: 5, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.711 Vali Acc: 0.480 Test Loss: 0.711 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.169208288192749
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.714 Vali Acc: 0.480 Test Loss: 0.714 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0916833877563477
Epoch: 7, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1506373882293701
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.208824634552002
Epoch: 9, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2139639854431152
Epoch: 10, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.722 Vali Acc: 0.460 Test Loss: 0.722 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.231593132019043
Epoch: 11, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 589538
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.142648935317993
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.720 Vali Acc: 0.390 Test Loss: 0.720 Test Acc: 0.390
Validation loss decreased (inf --> -0.389993).  Saving model ...
Epoch: 2 cost time: 0.9744915962219238
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.719 Vali Acc: 0.400 Test Loss: 0.719 Test Acc: 0.400
Validation loss decreased (-0.389993 --> -0.399993).  Saving model ...
Epoch: 3 cost time: 0.998279333114624
Epoch: 3, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.723 Vali Acc: 0.470 Test Loss: 0.723 Test Acc: 0.470
Validation loss decreased (-0.399993 --> -0.469993).  Saving model ...
Epoch: 4 cost time: 1.000478744506836
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.726 Vali Acc: 0.470 Test Loss: 0.726 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0139176845550537
Epoch: 5, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.730 Vali Acc: 0.460 Test Loss: 0.730 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9200465679168701
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.714 Vali Acc: 0.480 Test Loss: 0.714 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 7 cost time: 0.8752021789550781
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0956816673278809
Epoch: 8, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.730 Vali Acc: 0.460 Test Loss: 0.730 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.085364580154419
Epoch: 9, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.713 Vali Acc: 0.480 Test Loss: 0.713 Test Acc: 0.480
Validation loss decreased (-0.479993 --> -0.479993).  Saving model ...
Epoch: 10 cost time: 1.0307364463806152
Epoch: 10, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 11 cost time: 0.9769043922424316
Epoch: 11, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 12 cost time: 1.0299394130706787
Epoch: 12, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9799404144287109
Epoch: 13, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0197749137878418
Epoch: 14, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.735 Vali Acc: 0.490 Test Loss: 0.735 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0344245433807373
Epoch: 15, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.732 Vali Acc: 0.550 Test Loss: 0.732 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 16 cost time: 1.0535063743591309
Epoch: 16, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9570469856262207
Epoch: 17, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.720 Vali Acc: 0.520 Test Loss: 0.720 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1353530883789062
Epoch: 18, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.739 Vali Acc: 0.540 Test Loss: 0.739 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9846677780151367
Epoch: 19, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0301611423492432
Epoch: 20, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8759324550628662
Epoch: 21, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.759 Vali Acc: 0.530 Test Loss: 0.759 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0830638408660889
Epoch: 22, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0671474933624268
Epoch: 23, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8517959117889404
Epoch: 24, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0706589221954346
Epoch: 25, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.774 Vali Acc: 0.530 Test Loss: 0.774 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 175586
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2803196907043457
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.700 Vali Acc: 0.490 Test Loss: 0.700 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.063342332839966
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.697 Vali Acc: 0.520 Test Loss: 0.697 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.2203593254089355
Epoch: 3, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.707 Vali Acc: 0.470 Test Loss: 0.707 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.981621265411377
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.722 Vali Acc: 0.420 Test Loss: 0.722 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9923880100250244
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.724 Vali Acc: 0.420 Test Loss: 0.724 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9451308250427246
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.744 Vali Acc: 0.440 Test Loss: 0.744 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.897517442703247
Epoch: 7, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9924190044403076
Epoch: 8, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8181018829345703
Epoch: 9, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.789 Vali Acc: 0.450 Test Loss: 0.789 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8972084522247314
Epoch: 10, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.770 Vali Acc: 0.470 Test Loss: 0.770 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8394038677215576
Epoch: 11, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.788 Vali Acc: 0.480 Test Loss: 0.788 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9477992057800293
Epoch: 12, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.732 Vali Acc: 0.520 Test Loss: 0.732 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 1174706
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.913041591644287
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.678 Vali Acc: 0.590 Test Loss: 0.678 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.6441946029663086
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.681 Vali Acc: 0.590 Test Loss: 0.681 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6092321872711182
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.692 Vali Acc: 0.510 Test Loss: 0.692 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6902995109558105
Epoch: 4, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.703 Vali Acc: 0.470 Test Loss: 0.703 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5516517162322998
Epoch: 5, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.701 Vali Acc: 0.480 Test Loss: 0.701 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6523444652557373
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.716 Vali Acc: 0.450 Test Loss: 0.716 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.471440076828003
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.709 Vali Acc: 0.470 Test Loss: 0.709 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5143699645996094
Epoch: 8, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.713 Vali Acc: 0.470 Test Loss: 0.713 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5436217784881592
Epoch: 9, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.723 Vali Acc: 0.480 Test Loss: 0.723 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4228415489196777
Epoch: 10, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6424596309661865
Epoch: 11, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 346738
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.923733949661255
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.701 Vali Acc: 0.490 Test Loss: 0.701 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.5331568717956543
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.698 Vali Acc: 0.510 Test Loss: 0.698 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.3665380477905273
Epoch: 3, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.707 Vali Acc: 0.450 Test Loss: 0.707 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6726903915405273
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.723 Vali Acc: 0.430 Test Loss: 0.723 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5268912315368652
Epoch: 5, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.725 Vali Acc: 0.420 Test Loss: 0.725 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6486315727233887
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.745 Vali Acc: 0.440 Test Loss: 0.745 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5890827178955078
Epoch: 7, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.497084379196167
Epoch: 8, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5828430652618408
Epoch: 9, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.794 Vali Acc: 0.470 Test Loss: 0.794 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5852222442626953
Epoch: 10, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.413647174835205
Epoch: 11, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.804 Vali Acc: 0.430 Test Loss: 0.804 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6994602680206299
Epoch: 12, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.733 Vali Acc: 0.490 Test Loss: 0.733 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 1174706
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.4793546199798584
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.678 Vali Acc: 0.590 Test Loss: 0.678 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.4103338718414307
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.681 Vali Acc: 0.580 Test Loss: 0.681 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2156336307525635
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.692 Vali Acc: 0.510 Test Loss: 0.692 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3159115314483643
Epoch: 4, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.704 Vali Acc: 0.460 Test Loss: 0.704 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2259187698364258
Epoch: 5, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.700 Vali Acc: 0.480 Test Loss: 0.700 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.31862211227417
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.717 Vali Acc: 0.450 Test Loss: 0.717 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3832828998565674
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.713 Vali Acc: 0.470 Test Loss: 0.713 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1627676486968994
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.719 Vali Acc: 0.460 Test Loss: 0.719 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1620993614196777
Epoch: 9, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.726 Vali Acc: 0.470 Test Loss: 0.726 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2430589199066162
Epoch: 10, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.730 Vali Acc: 0.480 Test Loss: 0.730 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2594361305236816
Epoch: 11, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.725 Vali Acc: 0.470 Test Loss: 0.725 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 346738
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7137393951416016
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.699 Vali Acc: 0.490 Test Loss: 0.699 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.1276323795318604
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 0.9284191131591797
Epoch: 3, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.707 Vali Acc: 0.460 Test Loss: 0.707 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0842530727386475
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.723 Vali Acc: 0.430 Test Loss: 0.723 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.080223798751831
Epoch: 5, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.725 Vali Acc: 0.430 Test Loss: 0.725 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.090419054031372
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.747 Vali Acc: 0.430 Test Loss: 0.747 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1153538227081299
Epoch: 7, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.741 Vali Acc: 0.440 Test Loss: 0.741 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2471778392791748
Epoch: 8, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.731 Vali Acc: 0.440 Test Loss: 0.731 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1601006984710693
Epoch: 9, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.749 Vali Acc: 0.430 Test Loss: 0.749 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2703475952148438
Epoch: 10, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.748 Vali Acc: 0.440 Test Loss: 0.748 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2242884635925293
Epoch: 11, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.738 Vali Acc: 0.460 Test Loss: 0.738 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1446115970611572
Epoch: 12, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.747 Vali Acc: 0.450 Test Loss: 0.747 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 1174706
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.0280706882476807
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.679 Vali Acc: 0.590 Test Loss: 0.679 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.03407621383667
Epoch: 2, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.681 Vali Acc: 0.570 Test Loss: 0.681 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9317164421081543
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.690 Vali Acc: 0.520 Test Loss: 0.690 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8827791213989258
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.700 Vali Acc: 0.490 Test Loss: 0.700 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9476759433746338
Epoch: 5, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.692 Vali Acc: 0.520 Test Loss: 0.692 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9554429054260254
Epoch: 6, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.699 Vali Acc: 0.450 Test Loss: 0.699 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9199247360229492
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.696 Vali Acc: 0.420 Test Loss: 0.696 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.058629035949707
Epoch: 8, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.697 Vali Acc: 0.470 Test Loss: 0.697 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9187190532684326
Epoch: 9, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.712 Vali Acc: 0.440 Test Loss: 0.712 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.040055513381958
Epoch: 10, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.705 Vali Acc: 0.480 Test Loss: 0.705 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9033353328704834
Epoch: 11, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.711 Vali Acc: 0.470 Test Loss: 0.711 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 346738
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.237907886505127
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.765 Vali Acc: 0.430 Test Loss: 0.765 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 1.9747118949890137
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.736 Vali Acc: 0.450 Test Loss: 0.736 Test Acc: 0.450
Validation loss decreased (-0.429992 --> -0.449993).  Saving model ...
Epoch: 3 cost time: 1.8095080852508545
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.718 Vali Acc: 0.460 Test Loss: 0.718 Test Acc: 0.460
Validation loss decreased (-0.449993 --> -0.459993).  Saving model ...
Epoch: 4 cost time: 2.041618824005127
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.706 Vali Acc: 0.470 Test Loss: 0.706 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469993).  Saving model ...
Epoch: 5 cost time: 1.8719031810760498
Epoch: 5, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 2.03702974319458
Epoch: 6, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.715 Vali Acc: 0.470 Test Loss: 0.715 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9115362167358398
Epoch: 7, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.697 Vali Acc: 0.510 Test Loss: 0.697 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 8 cost time: 1.7416613101959229
Epoch: 8, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.713 Vali Acc: 0.480 Test Loss: 0.713 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8636295795440674
Epoch: 9, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.722 Vali Acc: 0.470 Test Loss: 0.722 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8911209106445312
Epoch: 10, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.708 Vali Acc: 0.450 Test Loss: 0.708 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8092162609100342
Epoch: 11, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8424196243286133
Epoch: 12, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.711 Vali Acc: 0.480 Test Loss: 0.711 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.981294870376587
Epoch: 13, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7002780437469482
Epoch: 14, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8004629611968994
Epoch: 15, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 16 cost time: 1.8907372951507568
Epoch: 16, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.756 Vali Acc: 0.470 Test Loss: 0.756 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9960510730743408
Epoch: 17, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.770 Vali Acc: 0.460 Test Loss: 0.770 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9331772327423096
Epoch: 18, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.782 Vali Acc: 0.500 Test Loss: 0.782 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9227373600006104
Epoch: 19, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8611562252044678
Epoch: 20, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.804 Vali Acc: 0.490 Test Loss: 0.804 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7638013362884521
Epoch: 21, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.832 Vali Acc: 0.470 Test Loss: 0.832 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9247543811798096
Epoch: 22, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.819 Vali Acc: 0.500 Test Loss: 0.819 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8628718852996826
Epoch: 23, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.990102767944336
Epoch: 24, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.843 Vali Acc: 0.510 Test Loss: 0.843 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0125412940979004
Epoch: 25, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.857 Vali Acc: 0.540 Test Loss: 0.857 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 588210
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7862117290496826
Epoch: 1, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.697 Vali Acc: 0.520 Test Loss: 0.697 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.2885124683380127
Epoch: 2, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.700 Vali Acc: 0.480 Test Loss: 0.700 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3671455383300781
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6231324672698975
Epoch: 4, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.712 Vali Acc: 0.470 Test Loss: 0.712 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4833579063415527
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.715 Vali Acc: 0.470 Test Loss: 0.715 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5736639499664307
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.725 Vali Acc: 0.450 Test Loss: 0.725 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5136394500732422
Epoch: 7, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.731 Vali Acc: 0.430 Test Loss: 0.731 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5378308296203613
Epoch: 8, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.729 Vali Acc: 0.460 Test Loss: 0.729 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6323974132537842
Epoch: 9, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.732 Vali Acc: 0.470 Test Loss: 0.732 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.373152494430542
Epoch: 10, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.731 Vali Acc: 0.460 Test Loss: 0.731 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3855929374694824
Epoch: 11, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.746 Vali Acc: 0.400 Test Loss: 0.746 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 174194
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7435805797576904
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.768 Vali Acc: 0.430 Test Loss: 0.768 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 1.7210609912872314
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.740 Vali Acc: 0.440 Test Loss: 0.740 Test Acc: 0.440
Validation loss decreased (-0.429992 --> -0.439993).  Saving model ...
Epoch: 3 cost time: 1.5914251804351807
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.723 Vali Acc: 0.450 Test Loss: 0.723 Test Acc: 0.450
Validation loss decreased (-0.439993 --> -0.449993).  Saving model ...
Epoch: 4 cost time: 1.56361985206604
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.711 Vali Acc: 0.470 Test Loss: 0.711 Test Acc: 0.470
Validation loss decreased (-0.449993 --> -0.469993).  Saving model ...
Epoch: 5 cost time: 1.5455291271209717
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.715 Vali Acc: 0.470 Test Loss: 0.715 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.577256679534912
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509993).  Saving model ...
Epoch: 7 cost time: 1.6142818927764893
Epoch: 7, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 8 cost time: 1.4870429039001465
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5444371700286865
Epoch: 9, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.728 Vali Acc: 0.510 Test Loss: 0.728 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5315141677856445
Epoch: 10, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5446574687957764
Epoch: 11, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6062264442443848
Epoch: 12, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5851123332977295
Epoch: 13, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 14 cost time: 1.601057767868042
Epoch: 14, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5470497608184814
Epoch: 15, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5026772022247314
Epoch: 16, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.737 Vali Acc: 0.480 Test Loss: 0.737 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6129460334777832
Epoch: 17, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.718 Vali Acc: 0.540 Test Loss: 0.718 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 18 cost time: 1.6899473667144775
Epoch: 18, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.773 Vali Acc: 0.470 Test Loss: 0.773 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6325292587280273
Epoch: 19, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6822562217712402
Epoch: 20, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6023588180541992
Epoch: 21, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.612637996673584
Epoch: 22, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.770 Vali Acc: 0.530 Test Loss: 0.770 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.660663366317749
Epoch: 23, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.758 Vali Acc: 0.530 Test Loss: 0.758 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5688083171844482
Epoch: 24, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.786 Vali Acc: 0.490 Test Loss: 0.786 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5392780303955078
Epoch: 25, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.821 Vali Acc: 0.510 Test Loss: 0.821 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4701225757598877
Epoch: 26, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.442781925201416
Epoch: 27, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.833 Vali Acc: 0.490 Test Loss: 0.833 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 588210
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7039453983306885
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.697 Vali Acc: 0.520 Test Loss: 0.697 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.254547357559204
Epoch: 2, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.699 Vali Acc: 0.490 Test Loss: 0.699 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3086488246917725
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.257002830505371
Epoch: 4, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.710 Vali Acc: 0.480 Test Loss: 0.710 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3218350410461426
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.712 Vali Acc: 0.490 Test Loss: 0.712 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.352959156036377
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3474419116973877
Epoch: 7, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.726 Vali Acc: 0.470 Test Loss: 0.726 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.369072675704956
Epoch: 8, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.723 Vali Acc: 0.470 Test Loss: 0.723 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.238297939300537
Epoch: 9, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3058080673217773
Epoch: 10, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3254384994506836
Epoch: 11, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.729 Vali Acc: 0.450 Test Loss: 0.729 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 174194
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.2971696853637695
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.768 Vali Acc: 0.430 Test Loss: 0.768 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 1.176518201828003
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.740 Vali Acc: 0.460 Test Loss: 0.740 Test Acc: 0.460
Validation loss decreased (-0.429992 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 1.17140531539917
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.722 Vali Acc: 0.460 Test Loss: 0.722 Test Acc: 0.460
Validation loss decreased (-0.459993 --> -0.459993).  Saving model ...
Epoch: 4 cost time: 1.2173340320587158
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.711 Vali Acc: 0.470 Test Loss: 0.711 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469993).  Saving model ...
Epoch: 5 cost time: 1.3311641216278076
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.716 Vali Acc: 0.480 Test Loss: 0.716 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 6 cost time: 1.108097791671753
Epoch: 6, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 7 cost time: 1.3483591079711914
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 8 cost time: 1.2618615627288818
Epoch: 8, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3551461696624756
Epoch: 9, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1377904415130615
Epoch: 10, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 11 cost time: 1.2359552383422852
Epoch: 11, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2048282623291016
Epoch: 12, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1794655323028564
Epoch: 13, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.729 Vali Acc: 0.520 Test Loss: 0.729 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2144255638122559
Epoch: 14, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.721 Vali Acc: 0.580 Test Loss: 0.721 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579993).  Saving model ...
Epoch: 15 cost time: 1.1415703296661377
Epoch: 15, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.729 Vali Acc: 0.560 Test Loss: 0.729 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.199622631072998
Epoch: 16, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2457494735717773
Epoch: 17, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.719 Vali Acc: 0.550 Test Loss: 0.719 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1115696430206299
Epoch: 18, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1935887336730957
Epoch: 19, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.746 Vali Acc: 0.490 Test Loss: 0.746 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1864538192749023
Epoch: 20, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1477091312408447
Epoch: 21, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.758 Vali Acc: 0.460 Test Loss: 0.758 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.221724510192871
Epoch: 22, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1435458660125732
Epoch: 23, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.20460844039917
Epoch: 24, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 588210
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.516101837158203
Epoch: 1, Steps: 20 | Train Loss: 0.746 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 0.9155080318450928
Epoch: 2, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.698 Vali Acc: 0.490 Test Loss: 0.698 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.905322790145874
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.017913818359375
Epoch: 4, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0396573543548584
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0854151248931885
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.721 Vali Acc: 0.480 Test Loss: 0.721 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8942270278930664
Epoch: 7, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.725 Vali Acc: 0.460 Test Loss: 0.725 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.008319616317749
Epoch: 8, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9869310855865479
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9347827434539795
Epoch: 10, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 11 cost time: 0.9550750255584717
Epoch: 11, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8472583293914795
Epoch: 12, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.717 Vali Acc: 0.490 Test Loss: 0.717 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.066330909729004
Epoch: 13, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.080693244934082
Epoch: 14, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9623594284057617
Epoch: 15, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.727 Vali Acc: 0.540 Test Loss: 0.727 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 16 cost time: 0.855492353439331
Epoch: 16, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8289976119995117
Epoch: 17, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0273010730743408
Epoch: 18, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.763 Vali Acc: 0.500 Test Loss: 0.763 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9979972839355469
Epoch: 19, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.745 Vali Acc: 0.530 Test Loss: 0.745 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0462186336517334
Epoch: 20, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.725 Vali Acc: 0.540 Test Loss: 0.725 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 21 cost time: 0.8910768032073975
Epoch: 21, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9259505271911621
Epoch: 22, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.00687837600708
Epoch: 23, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.750 Vali Acc: 0.510 Test Loss: 0.750 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.874948263168335
Epoch: 24, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0286109447479248
Epoch: 25, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9591822624206543
Epoch: 26, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0104353427886963
Epoch: 27, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.775 Vali Acc: 0.530 Test Loss: 0.775 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0159399509429932
Epoch: 28, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0747954845428467
Epoch: 29, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 30 cost time: 1.038025140762329
Epoch: 30, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.753 Vali Acc: 0.460 Test Loss: 0.753 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 174194
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.197873830795288
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.666 Vali Acc: 0.630 Test Loss: 0.666 Test Acc: 0.630
Validation loss decreased (inf --> -0.629993).  Saving model ...
Epoch: 2 cost time: 1.8959782123565674
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.668 Vali Acc: 0.610 Test Loss: 0.668 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8055176734924316
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.673 Vali Acc: 0.560 Test Loss: 0.673 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7890102863311768
Epoch: 4, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.676 Vali Acc: 0.570 Test Loss: 0.676 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.960237979888916
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.674 Vali Acc: 0.550 Test Loss: 0.674 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8293933868408203
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.679 Vali Acc: 0.570 Test Loss: 0.679 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.640998125076294
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.682 Vali Acc: 0.510 Test Loss: 0.682 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7012934684753418
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.686 Vali Acc: 0.530 Test Loss: 0.686 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7320406436920166
Epoch: 9, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.684 Vali Acc: 0.510 Test Loss: 0.684 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6814827919006348
Epoch: 10, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.690 Vali Acc: 0.510 Test Loss: 0.690 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7149465084075928
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.701 Vali Acc: 0.460 Test Loss: 0.701 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 294962
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.927184581756592
Epoch: 1, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.430938720703125
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.708 Vali Acc: 0.450 Test Loss: 0.708 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5053319931030273
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.705 Vali Acc: 0.490 Test Loss: 0.705 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4400336742401123
Epoch: 4, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.703 Vali Acc: 0.480 Test Loss: 0.703 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5609543323516846
Epoch: 5, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.697 Vali Acc: 0.460 Test Loss: 0.697 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.501871109008789
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.698 Vali Acc: 0.480 Test Loss: 0.698 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5683329105377197
Epoch: 7, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.687 Vali Acc: 0.520 Test Loss: 0.687 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 1.5642528533935547
Epoch: 8, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.692 Vali Acc: 0.530 Test Loss: 0.692 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 1.5184426307678223
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.685 Vali Acc: 0.520 Test Loss: 0.685 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4761512279510498
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.691 Vali Acc: 0.520 Test Loss: 0.691 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5122692584991455
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.692 Vali Acc: 0.480 Test Loss: 0.692 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4849660396575928
Epoch: 12, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.695 Vali Acc: 0.530 Test Loss: 0.695 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5937213897705078
Epoch: 13, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.688 Vali Acc: 0.510 Test Loss: 0.688 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4522488117218018
Epoch: 14, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.687 Vali Acc: 0.500 Test Loss: 0.687 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4977703094482422
Epoch: 15, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.692 Vali Acc: 0.530 Test Loss: 0.692 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 16 cost time: 1.5704729557037354
Epoch: 16, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.692 Vali Acc: 0.540 Test Loss: 0.692 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 17 cost time: 1.536412000656128
Epoch: 17, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4922173023223877
Epoch: 18, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4973833560943604
Epoch: 19, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5498692989349365
Epoch: 20, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.716 Vali Acc: 0.470 Test Loss: 0.716 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6624491214752197
Epoch: 21, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.737 Vali Acc: 0.520 Test Loss: 0.737 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5168981552124023
Epoch: 22, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5312893390655518
Epoch: 23, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.709 Vali Acc: 0.510 Test Loss: 0.709 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.502753734588623
Epoch: 24, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.769 Vali Acc: 0.460 Test Loss: 0.769 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5098512172698975
Epoch: 25, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.420053243637085
Epoch: 26, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.751 Vali Acc: 0.530 Test Loss: 0.751 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 87922
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7825024127960205
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.666 Vali Acc: 0.630 Test Loss: 0.666 Test Acc: 0.630
Validation loss decreased (inf --> -0.629993).  Saving model ...
Epoch: 2 cost time: 1.5861179828643799
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.668 Vali Acc: 0.610 Test Loss: 0.668 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4255321025848389
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.672 Vali Acc: 0.570 Test Loss: 0.672 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3216524124145508
Epoch: 4, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.675 Vali Acc: 0.570 Test Loss: 0.675 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4571483135223389
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.674 Vali Acc: 0.550 Test Loss: 0.674 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5897557735443115
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.681 Vali Acc: 0.550 Test Loss: 0.681 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6169307231903076
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.685 Vali Acc: 0.520 Test Loss: 0.685 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5669147968292236
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.689 Vali Acc: 0.520 Test Loss: 0.689 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5521011352539062
Epoch: 9, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.688 Vali Acc: 0.520 Test Loss: 0.688 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.501115083694458
Epoch: 10, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.694 Vali Acc: 0.490 Test Loss: 0.694 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.524420976638794
Epoch: 11, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.709 Vali Acc: 0.440 Test Loss: 0.709 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 294962
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7450509071350098
Epoch: 1, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.367828369140625
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.706 Vali Acc: 0.460 Test Loss: 0.706 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2678472995758057
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.704 Vali Acc: 0.490 Test Loss: 0.704 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2889397144317627
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 1.287421703338623
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 1.3283865451812744
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.697 Vali Acc: 0.520 Test Loss: 0.697 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 1.3052194118499756
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.686 Vali Acc: 0.530 Test Loss: 0.686 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 8 cost time: 1.157320499420166
Epoch: 8, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.692 Vali Acc: 0.540 Test Loss: 0.692 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.2760813236236572
Epoch: 9, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.685 Vali Acc: 0.530 Test Loss: 0.685 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2056350708007812
Epoch: 10, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.692 Vali Acc: 0.520 Test Loss: 0.692 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3853950500488281
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.693 Vali Acc: 0.470 Test Loss: 0.693 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4346909523010254
Epoch: 12, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.695 Vali Acc: 0.540 Test Loss: 0.695 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2511351108551025
Epoch: 13, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.688 Vali Acc: 0.500 Test Loss: 0.688 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3316187858581543
Epoch: 14, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.688 Vali Acc: 0.490 Test Loss: 0.688 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.30287504196167
Epoch: 15, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.693 Vali Acc: 0.520 Test Loss: 0.693 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2567269802093506
Epoch: 16, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.699 Vali Acc: 0.530 Test Loss: 0.699 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.201432704925537
Epoch: 17, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.722 Vali Acc: 0.530 Test Loss: 0.722 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.195223093032837
Epoch: 18, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.702 Vali Acc: 0.510 Test Loss: 0.702 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 87922
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.3562092781066895
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.665 Vali Acc: 0.620 Test Loss: 0.665 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 1.1077163219451904
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.667 Vali Acc: 0.610 Test Loss: 0.667 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2126245498657227
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.673 Vali Acc: 0.570 Test Loss: 0.673 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.285264015197754
Epoch: 4, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.675 Vali Acc: 0.560 Test Loss: 0.675 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1839439868927002
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.672 Vali Acc: 0.540 Test Loss: 0.672 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1498119831085205
Epoch: 6, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.677 Vali Acc: 0.520 Test Loss: 0.677 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9564461708068848
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.678 Vali Acc: 0.530 Test Loss: 0.678 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.217864990234375
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.685 Vali Acc: 0.500 Test Loss: 0.685 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0362844467163086
Epoch: 9, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.683 Vali Acc: 0.540 Test Loss: 0.683 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1530287265777588
Epoch: 10, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.690 Vali Acc: 0.540 Test Loss: 0.690 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.221721887588501
Epoch: 11, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.700 Vali Acc: 0.480 Test Loss: 0.700 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 294962
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.152320384979248
Epoch: 1, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 0.9413108825683594
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.707 Vali Acc: 0.450 Test Loss: 0.707 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8959674835205078
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.704 Vali Acc: 0.480 Test Loss: 0.704 Test Acc: 0.480
Validation loss decreased (-0.479993 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 0.9099123477935791
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.702 Vali Acc: 0.480 Test Loss: 0.702 Test Acc: 0.480
Validation loss decreased (-0.479993 --> -0.479993).  Saving model ...
Epoch: 5 cost time: 1.0514891147613525
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.697 Vali Acc: 0.480 Test Loss: 0.697 Test Acc: 0.480
Validation loss decreased (-0.479993 --> -0.479993).  Saving model ...
Epoch: 6 cost time: 1.000272512435913
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.698 Vali Acc: 0.520 Test Loss: 0.698 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 1.0952410697937012
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.688 Vali Acc: 0.530 Test Loss: 0.688 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 8 cost time: 1.0639796257019043
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9281377792358398
Epoch: 9, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.685 Vali Acc: 0.520 Test Loss: 0.685 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8977596759796143
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.692 Vali Acc: 0.500 Test Loss: 0.692 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9365050792694092
Epoch: 11, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.693 Vali Acc: 0.450 Test Loss: 0.693 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0057966709136963
Epoch: 12, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9233677387237549
Epoch: 13, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.690 Vali Acc: 0.490 Test Loss: 0.690 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0665953159332275
Epoch: 14, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.688 Vali Acc: 0.510 Test Loss: 0.688 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0195624828338623
Epoch: 15, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.691 Vali Acc: 0.540 Test Loss: 0.691 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 16 cost time: 1.0029609203338623
Epoch: 16, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.687 Vali Acc: 0.540 Test Loss: 0.687 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 17 cost time: 0.8183374404907227
Epoch: 17, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9910995960235596
Epoch: 18, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.687 Vali Acc: 0.520 Test Loss: 0.687 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9421169757843018
Epoch: 19, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.687 Vali Acc: 0.550 Test Loss: 0.687 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 20 cost time: 0.9289488792419434
Epoch: 20, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.683 Vali Acc: 0.520 Test Loss: 0.683 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1015949249267578
Epoch: 21, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.707 Vali Acc: 0.580 Test Loss: 0.707 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 22 cost time: 0.9623041152954102
Epoch: 22, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.676 Vali Acc: 0.550 Test Loss: 0.676 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9741051197052002
Epoch: 23, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.681 Vali Acc: 0.570 Test Loss: 0.681 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9037990570068359
Epoch: 24, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.693 Vali Acc: 0.550 Test Loss: 0.693 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9654009342193604
Epoch: 25, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.685 Vali Acc: 0.570 Test Loss: 0.685 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9669818878173828
Epoch: 26, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.692 Vali Acc: 0.540 Test Loss: 0.692 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8827362060546875
Epoch: 27, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.702 Vali Acc: 0.520 Test Loss: 0.702 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8336765766143799
Epoch: 28, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.675 Vali Acc: 0.580 Test Loss: 0.675 Test Acc: 0.580
Validation loss decreased (-0.579993 --> -0.579993).  Saving model ...
Epoch: 29 cost time: 0.928961992263794
Epoch: 29, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.677 Vali Acc: 0.560 Test Loss: 0.677 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0842196941375732
Epoch: 30, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.689 Vali Acc: 0.550 Test Loss: 0.689 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 87922
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 11.385249137878418
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.735 Vali Acc: 0.450 Test Loss: 0.735 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 9.769510269165039
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
Validation loss decreased (-0.449993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 10.313095569610596
Epoch: 3, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.800 Vali Acc: 0.480 Test Loss: 0.800 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.613478183746338
Epoch: 4, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 10.314193964004517
Epoch: 5, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.802 Vali Acc: 0.480 Test Loss: 0.802 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.681240320205688
Epoch: 6, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.193222999572754
Epoch: 7, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.799 Vali Acc: 0.600 Test Loss: 0.799 Test Acc: 0.600
Validation loss decreased (-0.529993 --> -0.599992).  Saving model ...
Epoch: 8 cost time: 9.928060531616211
Epoch: 8, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.845 Vali Acc: 0.490 Test Loss: 0.845 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.88828444480896
Epoch: 9, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.174 Vali Acc: 0.520 Test Loss: 1.174 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.311349868774414
Epoch: 10, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.823 Vali Acc: 0.560 Test Loss: 0.823 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.787307500839233
Epoch: 11, Steps: 20 | Train Loss: 0.341 Vali Loss: 0.989 Vali Acc: 0.470 Test Loss: 0.989 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.45647931098938
Epoch: 12, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.146 Vali Acc: 0.510 Test Loss: 1.146 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.918866157531738
Epoch: 13, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.065 Vali Acc: 0.540 Test Loss: 1.065 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.229634523391724
Epoch: 14, Steps: 20 | Train Loss: 0.385 Vali Loss: 1.062 Vali Acc: 0.530 Test Loss: 1.062 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.325037002563477
Epoch: 15, Steps: 20 | Train Loss: 0.309 Vali Loss: 1.103 Vali Acc: 0.540 Test Loss: 1.103 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.855739831924438
Epoch: 16, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.354 Vali Acc: 0.520 Test Loss: 1.354 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.390906810760498
Epoch: 17, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.442 Vali Acc: 0.560 Test Loss: 1.442 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 56261122
model size : 217.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.634519577026367
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 3.04569935798645
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 3.0375444889068604
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.135580062866211
Epoch: 4, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.776 Vali Acc: 0.490 Test Loss: 0.776 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.232816219329834
Epoch: 5, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.899 Vali Acc: 0.480 Test Loss: 0.899 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.227654457092285
Epoch: 6, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.863 Vali Acc: 0.500 Test Loss: 0.863 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.241899251937866
Epoch: 7, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.925 Vali Acc: 0.540 Test Loss: 0.925 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539991).  Saving model ...
Epoch: 8 cost time: 3.077314615249634
Epoch: 8, Steps: 20 | Train Loss: 0.507 Vali Loss: 1.080 Vali Acc: 0.500 Test Loss: 1.080 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0609374046325684
Epoch: 9, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.825 Vali Acc: 0.520 Test Loss: 0.825 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.2607998847961426
Epoch: 10, Steps: 20 | Train Loss: 0.475 Vali Loss: 1.054 Vali Acc: 0.510 Test Loss: 1.054 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2707645893096924
Epoch: 11, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.139 Vali Acc: 0.490 Test Loss: 1.139 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.2954699993133545
Epoch: 12, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.915 Vali Acc: 0.580 Test Loss: 0.915 Test Acc: 0.580
Validation loss decreased (-0.539991 --> -0.579991).  Saving model ...
Epoch: 13 cost time: 3.130558490753174
Epoch: 13, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.300 Vali Acc: 0.550 Test Loss: 1.300 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0621352195739746
Epoch: 14, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.212 Vali Acc: 0.560 Test Loss: 1.212 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1836676597595215
Epoch: 15, Steps: 20 | Train Loss: 0.241 Vali Loss: 1.397 Vali Acc: 0.520 Test Loss: 1.397 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2701356410980225
Epoch: 16, Steps: 20 | Train Loss: 0.165 Vali Loss: 1.440 Vali Acc: 0.510 Test Loss: 1.440 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.325190544128418
Epoch: 17, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.440 Vali Acc: 0.520 Test Loss: 1.440 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.157020330429077
Epoch: 18, Steps: 20 | Train Loss: 0.210 Vali Loss: 1.412 Vali Acc: 0.480 Test Loss: 1.412 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.090893507003784
Epoch: 19, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.547 Vali Acc: 0.500 Test Loss: 1.547 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.089759349822998
Epoch: 20, Steps: 20 | Train Loss: 0.136 Vali Loss: 1.582 Vali Acc: 0.470 Test Loss: 1.582 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.311250686645508
Epoch: 21, Steps: 20 | Train Loss: 0.091 Vali Loss: 1.848 Vali Acc: 0.510 Test Loss: 1.848 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.290705442428589
Epoch: 22, Steps: 20 | Train Loss: 0.164 Vali Loss: 1.765 Vali Acc: 0.510 Test Loss: 1.765 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 16544002
model size : 65.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.502218246459961
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.726 Vali Acc: 0.480 Test Loss: 0.726 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 6.855360746383667
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.731 Vali Acc: 0.530 Test Loss: 0.731 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 7.416299104690552
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.156661510467529
Epoch: 4, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.732 Vali Acc: 0.540 Test Loss: 0.732 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 7.002530813217163
Epoch: 5, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.793 Vali Acc: 0.490 Test Loss: 0.793 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.461593866348267
Epoch: 6, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 7.009585857391357
Epoch: 7, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.809 Vali Acc: 0.600 Test Loss: 0.809 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599992).  Saving model ...
Epoch: 8 cost time: 7.355813980102539
Epoch: 8, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.835 Vali Acc: 0.510 Test Loss: 0.835 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.406027317047119
Epoch: 9, Steps: 20 | Train Loss: 0.490 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.025221109390259
Epoch: 10, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.807 Vali Acc: 0.530 Test Loss: 0.807 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.052195310592651
Epoch: 11, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.917 Vali Acc: 0.530 Test Loss: 0.917 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.441833972930908
Epoch: 12, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.985 Vali Acc: 0.560 Test Loss: 0.985 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.156995058059692
Epoch: 13, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.087 Vali Acc: 0.510 Test Loss: 1.087 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.008758783340454
Epoch: 14, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.182 Vali Acc: 0.490 Test Loss: 1.182 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.565961837768555
Epoch: 15, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.034 Vali Acc: 0.520 Test Loss: 1.034 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.561486482620239
Epoch: 16, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.297 Vali Acc: 0.480 Test Loss: 1.297 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.152331113815308
Epoch: 17, Steps: 20 | Train Loss: 0.203 Vali Loss: 1.391 Vali Acc: 0.490 Test Loss: 1.391 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 56261122
model size : 217.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5677006244659424
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.296912908554077
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.376674175262451
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.697 Vali Acc: 0.560 Test Loss: 0.697 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 2.448164939880371
Epoch: 4, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.771 Vali Acc: 0.470 Test Loss: 0.771 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4443750381469727
Epoch: 5, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.892 Vali Acc: 0.480 Test Loss: 0.892 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.441047191619873
Epoch: 6, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.856 Vali Acc: 0.530 Test Loss: 0.856 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2755284309387207
Epoch: 7, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.756 Vali Acc: 0.590 Test Loss: 0.756 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589992).  Saving model ...
Epoch: 8 cost time: 2.2968549728393555
Epoch: 8, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.903 Vali Acc: 0.500 Test Loss: 0.903 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2554759979248047
Epoch: 9, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3129265308380127
Epoch: 10, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.811 Vali Acc: 0.530 Test Loss: 0.811 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1914331912994385
Epoch: 11, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.983 Vali Acc: 0.500 Test Loss: 0.983 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.224942684173584
Epoch: 12, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.757 Vali Acc: 0.600 Test Loss: 0.757 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599992).  Saving model ...
Epoch: 13 cost time: 2.2342185974121094
Epoch: 13, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.974 Vali Acc: 0.560 Test Loss: 0.974 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.127115249633789
Epoch: 14, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.251 Vali Acc: 0.510 Test Loss: 1.251 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2266528606414795
Epoch: 15, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.319 Vali Acc: 0.510 Test Loss: 1.319 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2743980884552
Epoch: 16, Steps: 20 | Train Loss: 0.287 Vali Loss: 0.973 Vali Acc: 0.480 Test Loss: 0.973 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3166558742523193
Epoch: 17, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.239 Vali Acc: 0.490 Test Loss: 1.239 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.7396984100341797
Epoch: 18, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.455 Vali Acc: 0.460 Test Loss: 1.455 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.7425785064697266
Epoch: 19, Steps: 20 | Train Loss: 0.218 Vali Loss: 1.164 Vali Acc: 0.550 Test Loss: 1.164 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.7689549922943115
Epoch: 20, Steps: 20 | Train Loss: 0.156 Vali Loss: 1.551 Vali Acc: 0.510 Test Loss: 1.551 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.7954835891723633
Epoch: 21, Steps: 20 | Train Loss: 0.106 Vali Loss: 1.488 Vali Acc: 0.540 Test Loss: 1.488 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.807832717895508
Epoch: 22, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.292 Vali Acc: 0.540 Test Loss: 1.292 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 16544002
model size : 65.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.608582496643066
Epoch: 1, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 4.707367181777954
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 4.75673246383667
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 4.764010667800903
Epoch: 4, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.738 Vali Acc: 0.530 Test Loss: 0.738 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 4.72435188293457
Epoch: 5, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.776 Vali Acc: 0.460 Test Loss: 0.776 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.178359031677246
Epoch: 6, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.145937919616699
Epoch: 7, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.802 Vali Acc: 0.590 Test Loss: 0.802 Test Acc: 0.590
Validation loss decreased (-0.529993 --> -0.589992).  Saving model ...
Epoch: 8 cost time: 4.209970235824585
Epoch: 8, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.8129918575286865
Epoch: 9, Steps: 20 | Train Loss: 0.497 Vali Loss: 1.220 Vali Acc: 0.520 Test Loss: 1.220 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.85571813583374
Epoch: 10, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.767 Vali Acc: 0.560 Test Loss: 0.767 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.790316104888916
Epoch: 11, Steps: 20 | Train Loss: 0.403 Vali Loss: 0.902 Vali Acc: 0.560 Test Loss: 0.902 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.889025449752808
Epoch: 12, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.004 Vali Acc: 0.530 Test Loss: 1.004 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.627839803695679
Epoch: 13, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.176 Vali Acc: 0.520 Test Loss: 1.176 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.2216057777404785
Epoch: 14, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.064 Vali Acc: 0.490 Test Loss: 1.064 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.102714776992798
Epoch: 15, Steps: 20 | Train Loss: 0.281 Vali Loss: 0.951 Vali Acc: 0.540 Test Loss: 0.951 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.171339750289917
Epoch: 16, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.928605556488037
Epoch: 17, Steps: 20 | Train Loss: 0.197 Vali Loss: 1.317 Vali Acc: 0.530 Test Loss: 1.317 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 56261122
model size : 217.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.041008710861206
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.9323389530181885
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.702 Vali Acc: 0.520 Test Loss: 0.702 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.6074762344360352
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.698 Vali Acc: 0.530 Test Loss: 0.698 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.7003045082092285
Epoch: 4, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.774 Vali Acc: 0.490 Test Loss: 0.774 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5773515701293945
Epoch: 5, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.902 Vali Acc: 0.500 Test Loss: 0.902 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6504642963409424
Epoch: 6, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.815 Vali Acc: 0.560 Test Loss: 0.815 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 7 cost time: 1.7100348472595215
Epoch: 7, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.752 Vali Acc: 0.570 Test Loss: 0.752 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 8 cost time: 1.9290404319763184
Epoch: 8, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9408771991729736
Epoch: 9, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.775 Vali Acc: 0.540 Test Loss: 0.775 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9577314853668213
Epoch: 10, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.821 Vali Acc: 0.540 Test Loss: 0.821 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9106860160827637
Epoch: 11, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.886 Vali Acc: 0.530 Test Loss: 0.886 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8886151313781738
Epoch: 12, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.734 Vali Acc: 0.580 Test Loss: 0.734 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579993).  Saving model ...
Epoch: 13 cost time: 1.8728888034820557
Epoch: 13, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.925 Vali Acc: 0.570 Test Loss: 0.925 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8927514553070068
Epoch: 14, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.163 Vali Acc: 0.510 Test Loss: 1.163 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9351582527160645
Epoch: 15, Steps: 20 | Train Loss: 0.378 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.700824499130249
Epoch: 16, Steps: 20 | Train Loss: 0.298 Vali Loss: 0.940 Vali Acc: 0.520 Test Loss: 0.940 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6628386974334717
Epoch: 17, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.243 Vali Acc: 0.530 Test Loss: 1.243 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7250330448150635
Epoch: 18, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.197 Vali Acc: 0.480 Test Loss: 1.197 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6661581993103027
Epoch: 19, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.100 Vali Acc: 0.560 Test Loss: 1.100 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6513853073120117
Epoch: 20, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.501 Vali Acc: 0.500 Test Loss: 1.501 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.658663272857666
Epoch: 21, Steps: 20 | Train Loss: 0.132 Vali Loss: 1.386 Vali Acc: 0.540 Test Loss: 1.386 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.927114486694336
Epoch: 22, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.264 Vali Acc: 0.570 Test Loss: 1.264 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 16544002
model size : 65.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.438563585281372
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 6.126032590866089
Epoch: 2, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.744 Vali Acc: 0.430 Test Loss: 0.744 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.724629163742065
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.793 Vali Acc: 0.540 Test Loss: 0.793 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 5.757972955703735
Epoch: 4, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.822 Vali Acc: 0.410 Test Loss: 0.822 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.494914293289185
Epoch: 5, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.748 Vali Acc: 0.560 Test Loss: 0.748 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 6.606173038482666
Epoch: 6, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.570220470428467
Epoch: 7, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.804 Vali Acc: 0.460 Test Loss: 0.804 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.130415201187134
Epoch: 8, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.918 Vali Acc: 0.520 Test Loss: 0.918 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.713568687438965
Epoch: 9, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.887 Vali Acc: 0.450 Test Loss: 0.887 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.740232229232788
Epoch: 10, Steps: 20 | Train Loss: 0.520 Vali Loss: 1.128 Vali Acc: 0.520 Test Loss: 1.128 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.596285820007324
Epoch: 11, Steps: 20 | Train Loss: 0.447 Vali Loss: 1.059 Vali Acc: 0.480 Test Loss: 1.059 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.517985105514526
Epoch: 12, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.996 Vali Acc: 0.450 Test Loss: 0.996 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.539694309234619
Epoch: 13, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.023 Vali Acc: 0.560 Test Loss: 1.023 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.307412385940552
Epoch: 14, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.146 Vali Acc: 0.510 Test Loss: 1.146 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.698073625564575
Epoch: 15, Steps: 20 | Train Loss: 0.260 Vali Loss: 1.275 Vali Acc: 0.490 Test Loss: 1.275 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 28143874
model size : 109.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.785647392272949
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.744 Vali Acc: 0.470 Test Loss: 0.744 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.3317697048187256
Epoch: 2, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.793 Vali Acc: 0.460 Test Loss: 0.793 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3021466732025146
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.768 Vali Acc: 0.450 Test Loss: 0.768 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3177177906036377
Epoch: 4, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.731 Vali Acc: 0.530 Test Loss: 0.731 Test Acc: 0.530
Validation loss decreased (-0.469993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 2.318514347076416
Epoch: 5, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.788 Vali Acc: 0.570 Test Loss: 0.788 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 1.9939556121826172
Epoch: 6, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0429060459136963
Epoch: 7, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.823 Vali Acc: 0.520 Test Loss: 0.823 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.103026866912842
Epoch: 8, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.961 Vali Acc: 0.470 Test Loss: 0.961 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.082038164138794
Epoch: 9, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.940 Vali Acc: 0.480 Test Loss: 0.940 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1055819988250732
Epoch: 10, Steps: 20 | Train Loss: 0.439 Vali Loss: 1.034 Vali Acc: 0.460 Test Loss: 1.034 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3529434204101562
Epoch: 11, Steps: 20 | Train Loss: 0.350 Vali Loss: 1.034 Vali Acc: 0.510 Test Loss: 1.034 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3310983180999756
Epoch: 12, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.953 Vali Acc: 0.600 Test Loss: 0.953 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 2.329259157180786
Epoch: 13, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2978365421295166
Epoch: 14, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.182 Vali Acc: 0.530 Test Loss: 1.182 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.417607069015503
Epoch: 15, Steps: 20 | Train Loss: 0.186 Vali Loss: 1.318 Vali Acc: 0.510 Test Loss: 1.318 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.438133716583252
Epoch: 16, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.230 Vali Acc: 0.580 Test Loss: 1.230 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3129866123199463
Epoch: 17, Steps: 20 | Train Loss: 0.238 Vali Loss: 1.556 Vali Acc: 0.520 Test Loss: 1.556 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3925633430480957
Epoch: 18, Steps: 20 | Train Loss: 0.241 Vali Loss: 1.304 Vali Acc: 0.520 Test Loss: 1.304 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1187522411346436
Epoch: 19, Steps: 20 | Train Loss: 0.161 Vali Loss: 1.391 Vali Acc: 0.540 Test Loss: 1.391 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.170091152191162
Epoch: 20, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.635 Vali Acc: 0.560 Test Loss: 1.635 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0296475887298584
Epoch: 21, Steps: 20 | Train Loss: 0.075 Vali Loss: 1.569 Vali Acc: 0.520 Test Loss: 1.569 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.0771892070770264
Epoch: 22, Steps: 20 | Train Loss: 0.111 Vali Loss: 1.692 Vali Acc: 0.550 Test Loss: 1.692 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 8284930
model size : 34.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.0266101360321045
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 4.5836145877838135
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.741 Vali Acc: 0.450 Test Loss: 0.741 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.550242900848389
Epoch: 3, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.756 Vali Acc: 0.530 Test Loss: 0.756 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 4.0775580406188965
Epoch: 4, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.769 Vali Acc: 0.430 Test Loss: 0.769 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.0507519245147705
Epoch: 5, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.698 Vali Acc: 0.560 Test Loss: 0.698 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 4.116065979003906
Epoch: 6, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.691 Vali Acc: 0.540 Test Loss: 0.691 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.592132091522217
Epoch: 7, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.5971972942352295
Epoch: 8, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.639665842056274
Epoch: 9, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.818 Vali Acc: 0.480 Test Loss: 0.818 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.682567834854126
Epoch: 10, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.901 Vali Acc: 0.530 Test Loss: 0.901 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.3271567821502686
Epoch: 11, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.869 Vali Acc: 0.530 Test Loss: 0.869 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.144721746444702
Epoch: 12, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.896 Vali Acc: 0.570 Test Loss: 0.896 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569991).  Saving model ...
Epoch: 13 cost time: 4.180410385131836
Epoch: 13, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.856 Vali Acc: 0.510 Test Loss: 0.856 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.293083429336548
Epoch: 14, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.176 Vali Acc: 0.490 Test Loss: 1.176 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.692439556121826
Epoch: 15, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.025 Vali Acc: 0.520 Test Loss: 1.025 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.72598671913147
Epoch: 16, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.822535037994385
Epoch: 17, Steps: 20 | Train Loss: 0.277 Vali Loss: 1.401 Vali Acc: 0.510 Test Loss: 1.401 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.5652453899383545
Epoch: 18, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.394 Vali Acc: 0.520 Test Loss: 1.394 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.066399335861206
Epoch: 19, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.684 Vali Acc: 0.520 Test Loss: 1.684 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.13480806350708
Epoch: 20, Steps: 20 | Train Loss: 0.224 Vali Loss: 1.604 Vali Acc: 0.510 Test Loss: 1.604 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.140280246734619
Epoch: 21, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.415 Vali Acc: 0.550 Test Loss: 1.415 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.2090370655059814
Epoch: 22, Steps: 20 | Train Loss: 0.096 Vali Loss: 2.059 Vali Acc: 0.520 Test Loss: 2.059 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 28143874
model size : 109.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0821316242218018
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.742 Vali Acc: 0.470 Test Loss: 0.742 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.8212296962738037
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.794 Vali Acc: 0.450 Test Loss: 0.794 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8252675533294678
Epoch: 3, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.762 Vali Acc: 0.460 Test Loss: 0.762 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6505563259124756
Epoch: 4, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.709 Vali Acc: 0.550 Test Loss: 0.709 Test Acc: 0.550
Validation loss decreased (-0.469993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.6327884197235107
Epoch: 5, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.738 Vali Acc: 0.570 Test Loss: 0.738 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 1.6346375942230225
Epoch: 6, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.761 Vali Acc: 0.570 Test Loss: 0.761 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.616628646850586
Epoch: 7, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.737 Vali Acc: 0.570 Test Loss: 0.737 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569993).  Saving model ...
Epoch: 8 cost time: 1.6521275043487549
Epoch: 8, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.849 Vali Acc: 0.470 Test Loss: 0.849 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5854649543762207
Epoch: 9, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.763 Vali Acc: 0.540 Test Loss: 0.763 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8101074695587158
Epoch: 10, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.879 Vali Acc: 0.520 Test Loss: 0.879 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.877617359161377
Epoch: 11, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.753 Vali Acc: 0.570 Test Loss: 0.753 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8496041297912598
Epoch: 12, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.876 Vali Acc: 0.580 Test Loss: 0.876 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579991).  Saving model ...
Epoch: 13 cost time: 1.9294888973236084
Epoch: 13, Steps: 20 | Train Loss: 0.398 Vali Loss: 1.021 Vali Acc: 0.530 Test Loss: 1.021 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8804864883422852
Epoch: 14, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.981 Vali Acc: 0.530 Test Loss: 0.981 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9139902591705322
Epoch: 15, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.213 Vali Acc: 0.570 Test Loss: 1.213 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.890212059020996
Epoch: 16, Steps: 20 | Train Loss: 0.297 Vali Loss: 0.987 Vali Acc: 0.500 Test Loss: 0.987 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7953996658325195
Epoch: 17, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.303 Vali Acc: 0.530 Test Loss: 1.303 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6275742053985596
Epoch: 18, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.301 Vali Acc: 0.570 Test Loss: 1.301 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6093835830688477
Epoch: 19, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.291 Vali Acc: 0.520 Test Loss: 1.291 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6907241344451904
Epoch: 20, Steps: 20 | Train Loss: 0.100 Vali Loss: 1.656 Vali Acc: 0.540 Test Loss: 1.656 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6866137981414795
Epoch: 21, Steps: 20 | Train Loss: 0.181 Vali Loss: 1.602 Vali Acc: 0.460 Test Loss: 1.602 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.660930871963501
Epoch: 22, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.486 Vali Acc: 0.530 Test Loss: 1.486 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 8284930
model size : 34.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.104641437530518
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.8017349243164062
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.739 Vali Acc: 0.450 Test Loss: 0.739 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8498306274414062
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 2.5594024658203125
Epoch: 4, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.759 Vali Acc: 0.440 Test Loss: 0.759 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5374410152435303
Epoch: 5, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.697 Vali Acc: 0.570 Test Loss: 0.697 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 2.552604913711548
Epoch: 6, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.687 Vali Acc: 0.580 Test Loss: 0.687 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 7 cost time: 2.5451712608337402
Epoch: 7, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.52345609664917
Epoch: 8, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.759 Vali Acc: 0.570 Test Loss: 0.759 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5712356567382812
Epoch: 9, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.835 Vali Acc: 0.490 Test Loss: 0.835 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.217866897583008
Epoch: 10, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.835 Vali Acc: 0.590 Test Loss: 0.835 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 11 cost time: 2.358220100402832
Epoch: 11, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.857 Vali Acc: 0.540 Test Loss: 0.857 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3024425506591797
Epoch: 12, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.881 Vali Acc: 0.530 Test Loss: 0.881 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.215998649597168
Epoch: 13, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.859 Vali Acc: 0.570 Test Loss: 0.859 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2244484424591064
Epoch: 14, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.039 Vali Acc: 0.490 Test Loss: 1.039 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3091607093811035
Epoch: 15, Steps: 20 | Train Loss: 0.298 Vali Loss: 0.929 Vali Acc: 0.600 Test Loss: 0.929 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599991).  Saving model ...
Epoch: 16 cost time: 2.5882394313812256
Epoch: 16, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6398322582244873
Epoch: 17, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.664472818374634
Epoch: 18, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.203 Vali Acc: 0.570 Test Loss: 1.203 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6491739749908447
Epoch: 19, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.536 Vali Acc: 0.480 Test Loss: 1.536 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5838019847869873
Epoch: 20, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.414 Vali Acc: 0.530 Test Loss: 1.414 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.6318893432617188
Epoch: 21, Steps: 20 | Train Loss: 0.143 Vali Loss: 1.275 Vali Acc: 0.550 Test Loss: 1.275 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.471726179122925
Epoch: 22, Steps: 20 | Train Loss: 0.078 Vali Loss: 1.632 Vali Acc: 0.500 Test Loss: 1.632 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.521855354309082
Epoch: 23, Steps: 20 | Train Loss: 0.068 Vali Loss: 1.593 Vali Acc: 0.510 Test Loss: 1.593 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.483179807662964
Epoch: 24, Steps: 20 | Train Loss: 0.053 Vali Loss: 1.619 Vali Acc: 0.560 Test Loss: 1.619 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.4314773082733154
Epoch: 25, Steps: 20 | Train Loss: 0.100 Vali Loss: 1.619 Vali Acc: 0.590 Test Loss: 1.619 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 28143874
model size : 109.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.4506969451904297
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.743 Vali Acc: 0.470 Test Loss: 0.743 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.154660701751709
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.791 Vali Acc: 0.460 Test Loss: 0.791 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1925592422485352
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0410139560699463
Epoch: 4, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.705 Vali Acc: 0.560 Test Loss: 0.705 Test Acc: 0.560
Validation loss decreased (-0.469993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 1.1544222831726074
Epoch: 5, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.121450424194336
Epoch: 6, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.760 Vali Acc: 0.580 Test Loss: 0.760 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579992).  Saving model ...
Epoch: 7 cost time: 1.1124823093414307
Epoch: 7, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.750 Vali Acc: 0.560 Test Loss: 0.750 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1219873428344727
Epoch: 8, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.840 Vali Acc: 0.490 Test Loss: 0.840 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1191341876983643
Epoch: 9, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.750 Vali Acc: 0.540 Test Loss: 0.750 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2352793216705322
Epoch: 10, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.910 Vali Acc: 0.530 Test Loss: 0.910 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1685545444488525
Epoch: 11, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.779 Vali Acc: 0.570 Test Loss: 0.779 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1909198760986328
Epoch: 12, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.884 Vali Acc: 0.590 Test Loss: 0.884 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589991).  Saving model ...
Epoch: 13 cost time: 1.206590175628662
Epoch: 13, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.994 Vali Acc: 0.540 Test Loss: 0.994 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2217481136322021
Epoch: 14, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.998 Vali Acc: 0.510 Test Loss: 0.998 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1934573650360107
Epoch: 15, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.132 Vali Acc: 0.550 Test Loss: 1.132 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1856212615966797
Epoch: 16, Steps: 20 | Train Loss: 0.320 Vali Loss: 0.966 Vali Acc: 0.500 Test Loss: 0.966 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1880836486816406
Epoch: 17, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.084 Vali Acc: 0.520 Test Loss: 1.084 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2341060638427734
Epoch: 18, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0844497680664062
Epoch: 19, Steps: 20 | Train Loss: 0.180 Vali Loss: 1.096 Vali Acc: 0.570 Test Loss: 1.096 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1267471313476562
Epoch: 20, Steps: 20 | Train Loss: 0.130 Vali Loss: 1.205 Vali Acc: 0.560 Test Loss: 1.205 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1025383472442627
Epoch: 21, Steps: 20 | Train Loss: 0.094 Vali Loss: 1.475 Vali Acc: 0.500 Test Loss: 1.475 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1297309398651123
Epoch: 22, Steps: 20 | Train Loss: 0.126 Vali Loss: 1.206 Vali Acc: 0.550 Test Loss: 1.206 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 8284930
model size : 34.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.143043041229248
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 6.251291036605835
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.727 Vali Acc: 0.470 Test Loss: 0.727 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.165508031845093
Epoch: 3, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.737 Vali Acc: 0.460 Test Loss: 0.737 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.208358287811279
Epoch: 4, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.787 Vali Acc: 0.490 Test Loss: 0.787 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.779914140701294
Epoch: 5, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.747 Vali Acc: 0.560 Test Loss: 0.747 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 6.824172019958496
Epoch: 6, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.897 Vali Acc: 0.530 Test Loss: 0.897 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.445278882980347
Epoch: 7, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.855 Vali Acc: 0.480 Test Loss: 0.855 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.175351858139038
Epoch: 8, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.802 Vali Acc: 0.560 Test Loss: 0.802 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.267879009246826
Epoch: 9, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.864 Vali Acc: 0.450 Test Loss: 0.864 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.842151641845703
Epoch: 10, Steps: 20 | Train Loss: 0.419 Vali Loss: 1.003 Vali Acc: 0.520 Test Loss: 1.003 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.887027263641357
Epoch: 11, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.892 Vali Acc: 0.500 Test Loss: 0.892 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.7349724769592285
Epoch: 12, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.946 Vali Acc: 0.490 Test Loss: 0.946 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.339395046234131
Epoch: 13, Steps: 20 | Train Loss: 0.296 Vali Loss: 0.994 Vali Acc: 0.500 Test Loss: 0.994 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.277415037155151
Epoch: 14, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.030 Vali Acc: 0.580 Test Loss: 1.030 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579990).  Saving model ...
Epoch: 15 cost time: 6.928603410720825
Epoch: 15, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.029 Vali Acc: 0.500 Test Loss: 1.029 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.9377031326293945
Epoch: 16, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.021 Vali Acc: 0.520 Test Loss: 1.021 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.778688669204712
Epoch: 17, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.308 Vali Acc: 0.500 Test Loss: 1.308 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.1701929569244385
Epoch: 18, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.282 Vali Acc: 0.450 Test Loss: 1.282 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.221216201782227
Epoch: 19, Steps: 20 | Train Loss: 0.198 Vali Loss: 1.057 Vali Acc: 0.590 Test Loss: 1.057 Test Acc: 0.590
Validation loss decreased (-0.579990 --> -0.589989).  Saving model ...
Epoch: 20 cost time: 6.833468198776245
Epoch: 20, Steps: 20 | Train Loss: 0.140 Vali Loss: 1.372 Vali Acc: 0.550 Test Loss: 1.372 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.9054834842681885
Epoch: 21, Steps: 20 | Train Loss: 0.116 Vali Loss: 1.571 Vali Acc: 0.480 Test Loss: 1.571 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.852911949157715
Epoch: 22, Steps: 20 | Train Loss: 0.139 Vali Loss: 1.331 Vali Acc: 0.580 Test Loss: 1.331 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.297358512878418
Epoch: 23, Steps: 20 | Train Loss: 0.159 Vali Loss: 1.459 Vali Acc: 0.480 Test Loss: 1.459 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.287098407745361
Epoch: 24, Steps: 20 | Train Loss: 0.176 Vali Loss: 1.370 Vali Acc: 0.510 Test Loss: 1.370 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.934776306152344
Epoch: 25, Steps: 20 | Train Loss: 0.124 Vali Loss: 1.304 Vali Acc: 0.460 Test Loss: 1.304 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.786931276321411
Epoch: 26, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.484 Vali Acc: 0.490 Test Loss: 1.484 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.94000768661499
Epoch: 27, Steps: 20 | Train Loss: 0.087 Vali Loss: 1.506 Vali Acc: 0.540 Test Loss: 1.506 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.34083890914917
Epoch: 28, Steps: 20 | Train Loss: 0.136 Vali Loss: 1.497 Vali Acc: 0.500 Test Loss: 1.497 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.270621061325073
Epoch: 29, Steps: 20 | Train Loss: 0.109 Vali Loss: 1.673 Vali Acc: 0.520 Test Loss: 1.673 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 28132866
model size : 108.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5790603160858154
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.679 Vali Acc: 0.530 Test Loss: 0.679 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.327181339263916
Epoch: 2, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.339020252227783
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.145183801651001
Epoch: 4, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.750 Vali Acc: 0.510 Test Loss: 0.750 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1619679927825928
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.788 Vali Acc: 0.510 Test Loss: 0.788 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.128506660461426
Epoch: 6, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.763 Vali Acc: 0.530 Test Loss: 0.763 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1559009552001953
Epoch: 7, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.769 Vali Acc: 0.470 Test Loss: 0.769 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.244201421737671
Epoch: 8, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.775 Vali Acc: 0.520 Test Loss: 0.775 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.318201780319214
Epoch: 9, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.870 Vali Acc: 0.470 Test Loss: 0.870 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.227255344390869
Epoch: 10, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.918 Vali Acc: 0.510 Test Loss: 0.918 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.3735716342926025
Epoch: 11, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.951 Vali Acc: 0.560 Test Loss: 0.951 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559990).  Saving model ...
Epoch: 12 cost time: 2.3604817390441895
Epoch: 12, Steps: 20 | Train Loss: 0.315 Vali Loss: 0.990 Vali Acc: 0.550 Test Loss: 0.990 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3161189556121826
Epoch: 13, Steps: 20 | Train Loss: 0.356 Vali Loss: 0.947 Vali Acc: 0.520 Test Loss: 0.947 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3343958854675293
Epoch: 14, Steps: 20 | Train Loss: 0.302 Vali Loss: 0.961 Vali Acc: 0.580 Test Loss: 0.961 Test Acc: 0.580
Validation loss decreased (-0.559990 --> -0.579990).  Saving model ...
Epoch: 15 cost time: 2.063699245452881
Epoch: 15, Steps: 20 | Train Loss: 0.233 Vali Loss: 0.967 Vali Acc: 0.560 Test Loss: 0.967 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0461952686309814
Epoch: 16, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.098 Vali Acc: 0.550 Test Loss: 1.098 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.103236198425293
Epoch: 17, Steps: 20 | Train Loss: 0.210 Vali Loss: 1.139 Vali Acc: 0.550 Test Loss: 1.139 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.074284791946411
Epoch: 18, Steps: 20 | Train Loss: 0.168 Vali Loss: 1.275 Vali Acc: 0.510 Test Loss: 1.275 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.259303331375122
Epoch: 19, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.198 Vali Acc: 0.540 Test Loss: 1.198 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.257885694503784
Epoch: 20, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.441 Vali Acc: 0.560 Test Loss: 1.441 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.360227584838867
Epoch: 21, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.374 Vali Acc: 0.540 Test Loss: 1.374 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.3411998748779297
Epoch: 22, Steps: 20 | Train Loss: 0.077 Vali Loss: 1.446 Vali Acc: 0.550 Test Loss: 1.446 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.3699586391448975
Epoch: 23, Steps: 20 | Train Loss: 0.079 Vali Loss: 1.348 Vali Acc: 0.590 Test Loss: 1.348 Test Acc: 0.590
Validation loss decreased (-0.579990 --> -0.589987).  Saving model ...
Epoch: 24 cost time: 2.3416781425476074
Epoch: 24, Steps: 20 | Train Loss: 0.196 Vali Loss: 1.306 Vali Acc: 0.480 Test Loss: 1.306 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3381049633026123
Epoch: 25, Steps: 20 | Train Loss: 0.142 Vali Loss: 1.478 Vali Acc: 0.580 Test Loss: 1.478 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.2462925910949707
Epoch: 26, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.523 Vali Acc: 0.530 Test Loss: 1.523 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1567928791046143
Epoch: 27, Steps: 20 | Train Loss: 0.157 Vali Loss: 1.344 Vali Acc: 0.510 Test Loss: 1.344 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.3291077613830566
Epoch: 28, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.447 Vali Acc: 0.560 Test Loss: 1.447 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.241697072982788
Epoch: 29, Steps: 20 | Train Loss: 0.109 Vali Loss: 1.604 Vali Acc: 0.540 Test Loss: 1.604 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.344992160797119
Epoch: 30, Steps: 20 | Train Loss: 0.061 Vali Loss: 1.796 Vali Acc: 0.540 Test Loss: 1.796 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 8273538
model size : 32.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.961444139480591
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.685 Vali Acc: 0.530 Test Loss: 0.685 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 4.3991734981536865
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.713 Vali Acc: 0.490 Test Loss: 0.713 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.496692419052124
Epoch: 3, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.756 Vali Acc: 0.450 Test Loss: 0.756 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.465150833129883
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.806 Vali Acc: 0.480 Test Loss: 0.806 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.747879266738892
Epoch: 5, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.808 Vali Acc: 0.530 Test Loss: 0.808 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.793235540390015
Epoch: 6, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.857 Vali Acc: 0.570 Test Loss: 0.857 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569991).  Saving model ...
Epoch: 7 cost time: 4.864269733428955
Epoch: 7, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.806 Vali Acc: 0.460 Test Loss: 0.806 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.470861434936523
Epoch: 8, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.802 Vali Acc: 0.540 Test Loss: 0.802 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.2650957107543945
Epoch: 9, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.310596227645874
Epoch: 10, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.839 Vali Acc: 0.550 Test Loss: 0.839 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.235411882400513
Epoch: 11, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.856 Vali Acc: 0.530 Test Loss: 0.856 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.222893476486206
Epoch: 12, Steps: 20 | Train Loss: 0.394 Vali Loss: 0.920 Vali Acc: 0.510 Test Loss: 0.920 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.066362619400024
Epoch: 13, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.864 Vali Acc: 0.500 Test Loss: 0.864 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.040136098861694
Epoch: 14, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.916 Vali Acc: 0.520 Test Loss: 0.916 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.204084157943726
Epoch: 15, Steps: 20 | Train Loss: 0.335 Vali Loss: 0.901 Vali Acc: 0.480 Test Loss: 0.901 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.22759222984314
Epoch: 16, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.930 Vali Acc: 0.510 Test Loss: 0.930 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 28132866
model size : 108.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.983217477798462
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.675 Vali Acc: 0.550 Test Loss: 0.675 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.7839505672454834
Epoch: 2, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.706 Vali Acc: 0.490 Test Loss: 0.706 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7451751232147217
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7760288715362549
Epoch: 4, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.718 Vali Acc: 0.530 Test Loss: 0.718 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7872567176818848
Epoch: 5, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.934582233428955
Epoch: 6, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.715 Vali Acc: 0.540 Test Loss: 0.715 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9136197566986084
Epoch: 7, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.917931318283081
Epoch: 8, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8834538459777832
Epoch: 9, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.777 Vali Acc: 0.490 Test Loss: 0.777 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8705122470855713
Epoch: 10, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.795 Vali Acc: 0.530 Test Loss: 0.795 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.881612777709961
Epoch: 11, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.809 Vali Acc: 0.560 Test Loss: 0.809 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 12 cost time: 1.731370210647583
Epoch: 12, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.761 Vali Acc: 0.610 Test Loss: 0.761 Test Acc: 0.610
Validation loss decreased (-0.559992 --> -0.609992).  Saving model ...
Epoch: 13 cost time: 1.7516438961029053
Epoch: 13, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.815 Vali Acc: 0.540 Test Loss: 0.815 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6929504871368408
Epoch: 14, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.955 Vali Acc: 0.580 Test Loss: 0.955 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7269971370697021
Epoch: 15, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.913 Vali Acc: 0.530 Test Loss: 0.913 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.745877981185913
Epoch: 16, Steps: 20 | Train Loss: 0.350 Vali Loss: 0.839 Vali Acc: 0.560 Test Loss: 0.839 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9365289211273193
Epoch: 17, Steps: 20 | Train Loss: 0.307 Vali Loss: 1.086 Vali Acc: 0.510 Test Loss: 1.086 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8455142974853516
Epoch: 18, Steps: 20 | Train Loss: 0.344 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8651700019836426
Epoch: 19, Steps: 20 | Train Loss: 0.267 Vali Loss: 0.990 Vali Acc: 0.570 Test Loss: 0.990 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8718152046203613
Epoch: 20, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.137 Vali Acc: 0.530 Test Loss: 1.137 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9145219326019287
Epoch: 21, Steps: 20 | Train Loss: 0.237 Vali Loss: 1.170 Vali Acc: 0.530 Test Loss: 1.170 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8329830169677734
Epoch: 22, Steps: 20 | Train Loss: 0.161 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 8273538
model size : 32.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.051494359970093
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.691 Vali Acc: 0.500 Test Loss: 0.691 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.8774430751800537
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.869072198867798
Epoch: 3, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.727 Vali Acc: 0.440 Test Loss: 0.727 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8953349590301514
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.795 Vali Acc: 0.490 Test Loss: 0.795 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.875950574874878
Epoch: 5, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 2.6296112537384033
Epoch: 6, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.849 Vali Acc: 0.540 Test Loss: 0.849 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5767531394958496
Epoch: 7, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.758 Vali Acc: 0.510 Test Loss: 0.758 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6224403381347656
Epoch: 8, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.898258924484253
Epoch: 9, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.785 Vali Acc: 0.510 Test Loss: 0.785 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.825303554534912
Epoch: 10, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.763 Vali Acc: 0.540 Test Loss: 0.763 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.891942262649536
Epoch: 11, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.780 Vali Acc: 0.510 Test Loss: 0.780 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.936697483062744
Epoch: 12, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.748 Vali Acc: 0.540 Test Loss: 0.748 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8517727851867676
Epoch: 13, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.874 Vali Acc: 0.560 Test Loss: 0.874 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559991).  Saving model ...
Epoch: 14 cost time: 2.624687910079956
Epoch: 14, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.866 Vali Acc: 0.560 Test Loss: 0.866 Test Acc: 0.560
Validation loss decreased (-0.559991 --> -0.559991).  Saving model ...
Epoch: 15 cost time: 2.5866575241088867
Epoch: 15, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.814 Vali Acc: 0.530 Test Loss: 0.814 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.635612964630127
Epoch: 16, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.850 Vali Acc: 0.550 Test Loss: 0.850 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.754988670349121
Epoch: 17, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.990 Vali Acc: 0.520 Test Loss: 0.990 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.848740339279175
Epoch: 18, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.018 Vali Acc: 0.550 Test Loss: 1.018 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.851693868637085
Epoch: 19, Steps: 20 | Train Loss: 0.286 Vali Loss: 0.973 Vali Acc: 0.530 Test Loss: 0.973 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.8927876949310303
Epoch: 20, Steps: 20 | Train Loss: 0.272 Vali Loss: 1.065 Vali Acc: 0.540 Test Loss: 1.065 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.001131772994995
Epoch: 21, Steps: 20 | Train Loss: 0.228 Vali Loss: 1.070 Vali Acc: 0.510 Test Loss: 1.070 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.011470317840576
Epoch: 22, Steps: 20 | Train Loss: 0.196 Vali Loss: 1.076 Vali Acc: 0.540 Test Loss: 1.076 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.6956844329833984
Epoch: 23, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.408 Vali Acc: 0.450 Test Loss: 1.408 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6095528602600098
Epoch: 24, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.137 Vali Acc: 0.540 Test Loss: 1.137 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 28132866
model size : 108.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.652583599090576
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.677 Vali Acc: 0.560 Test Loss: 0.677 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.347060203552246
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.700 Vali Acc: 0.520 Test Loss: 0.700 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.321162223815918
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.698 Vali Acc: 0.510 Test Loss: 0.698 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3280723094940186
Epoch: 4, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.726 Vali Acc: 0.530 Test Loss: 0.726 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1011993885040283
Epoch: 5, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.191401481628418
Epoch: 6, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2413313388824463
Epoch: 7, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.729 Vali Acc: 0.590 Test Loss: 0.729 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 8 cost time: 1.2688567638397217
Epoch: 8, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2196171283721924
Epoch: 9, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.805 Vali Acc: 0.510 Test Loss: 0.805 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3215570449829102
Epoch: 10, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.297091007232666
Epoch: 11, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.789 Vali Acc: 0.550 Test Loss: 0.789 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3196055889129639
Epoch: 12, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.783 Vali Acc: 0.630 Test Loss: 0.783 Test Acc: 0.630
Validation loss decreased (-0.589993 --> -0.629992).  Saving model ...
Epoch: 13 cost time: 1.354454517364502
Epoch: 13, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.774 Vali Acc: 0.540 Test Loss: 0.774 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3281745910644531
Epoch: 14, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.850 Vali Acc: 0.590 Test Loss: 0.850 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.333913803100586
Epoch: 15, Steps: 20 | Train Loss: 0.395 Vali Loss: 0.825 Vali Acc: 0.560 Test Loss: 0.825 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3239762783050537
Epoch: 16, Steps: 20 | Train Loss: 0.357 Vali Loss: 0.815 Vali Acc: 0.550 Test Loss: 0.815 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.330915927886963
Epoch: 17, Steps: 20 | Train Loss: 0.313 Vali Loss: 0.947 Vali Acc: 0.550 Test Loss: 0.947 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.311140775680542
Epoch: 18, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.281 Vali Acc: 0.460 Test Loss: 1.281 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2056715488433838
Epoch: 19, Steps: 20 | Train Loss: 0.282 Vali Loss: 0.958 Vali Acc: 0.570 Test Loss: 0.958 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2181353569030762
Epoch: 20, Steps: 20 | Train Loss: 0.276 Vali Loss: 0.894 Vali Acc: 0.550 Test Loss: 0.894 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2018711566925049
Epoch: 21, Steps: 20 | Train Loss: 0.266 Vali Loss: 0.992 Vali Acc: 0.580 Test Loss: 0.992 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1880216598510742
Epoch: 22, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.221 Vali Acc: 0.550 Test Loss: 1.221 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 8273538
model size : 32.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.3347392082214355
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.760 Vali Acc: 0.470 Test Loss: 0.760 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 4.119402647018433
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.744 Vali Acc: 0.470 Test Loss: 0.744 Test Acc: 0.470
Validation loss decreased (-0.469992 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 3.6601696014404297
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.837 Vali Acc: 0.470 Test Loss: 0.837 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6585099697113037
Epoch: 4, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 3.754321813583374
Epoch: 5, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 4.051093578338623
Epoch: 6, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.834 Vali Acc: 0.460 Test Loss: 0.834 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.089750289916992
Epoch: 7, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 4.181043863296509
Epoch: 8, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.950198173522949
Epoch: 9, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.881 Vali Acc: 0.500 Test Loss: 0.881 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.734403610229492
Epoch: 10, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.892 Vali Acc: 0.500 Test Loss: 0.892 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.640658140182495
Epoch: 11, Steps: 20 | Train Loss: 0.404 Vali Loss: 1.075 Vali Acc: 0.520 Test Loss: 1.075 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.992588996887207
Epoch: 12, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.048 Vali Acc: 0.490 Test Loss: 1.048 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.198800325393677
Epoch: 13, Steps: 20 | Train Loss: 0.381 Vali Loss: 1.021 Vali Acc: 0.510 Test Loss: 1.021 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.103143930435181
Epoch: 14, Steps: 20 | Train Loss: 0.344 Vali Loss: 1.009 Vali Acc: 0.520 Test Loss: 1.009 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.064807653427124
Epoch: 15, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.126 Vali Acc: 0.560 Test Loss: 1.126 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559989).  Saving model ...
Epoch: 16 cost time: 3.730485200881958
Epoch: 16, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.240 Vali Acc: 0.460 Test Loss: 1.240 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.679835796356201
Epoch: 17, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.072 Vali Acc: 0.510 Test Loss: 1.072 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.6997382640838623
Epoch: 18, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.096 Vali Acc: 0.510 Test Loss: 1.096 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.210818529129028
Epoch: 19, Steps: 20 | Train Loss: 0.174 Vali Loss: 1.262 Vali Acc: 0.480 Test Loss: 1.262 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.111337184906006
Epoch: 20, Steps: 20 | Train Loss: 0.119 Vali Loss: 1.410 Vali Acc: 0.500 Test Loss: 1.410 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.221825361251831
Epoch: 21, Steps: 20 | Train Loss: 0.173 Vali Loss: 1.443 Vali Acc: 0.520 Test Loss: 1.443 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.152704238891602
Epoch: 22, Steps: 20 | Train Loss: 0.203 Vali Loss: 1.281 Vali Acc: 0.520 Test Loss: 1.281 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.6939172744750977
Epoch: 23, Steps: 20 | Train Loss: 0.112 Vali Loss: 1.339 Vali Acc: 0.560 Test Loss: 1.339 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.610059976577759
Epoch: 24, Steps: 20 | Train Loss: 0.096 Vali Loss: 1.493 Vali Acc: 0.490 Test Loss: 1.493 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.7353692054748535
Epoch: 25, Steps: 20 | Train Loss: 0.068 Vali Loss: 1.547 Vali Acc: 0.500 Test Loss: 1.547 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 14073090
model size : 54.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.002068519592285
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.714 Vali Acc: 0.470 Test Loss: 0.714 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.6509191989898682
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.713 Vali Acc: 0.420 Test Loss: 0.713 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6169407367706299
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.700 Vali Acc: 0.520 Test Loss: 0.700 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.5099225044250488
Epoch: 4, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4771568775177002
Epoch: 5, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.763 Vali Acc: 0.490 Test Loss: 0.763 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.534942865371704
Epoch: 6, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.737 Vali Acc: 0.470 Test Loss: 0.737 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5264818668365479
Epoch: 7, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.782 Vali Acc: 0.470 Test Loss: 0.782 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6640117168426514
Epoch: 8, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.839 Vali Acc: 0.510 Test Loss: 0.839 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6869306564331055
Epoch: 9, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.989 Vali Acc: 0.490 Test Loss: 0.989 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6838335990905762
Epoch: 10, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.970 Vali Acc: 0.460 Test Loss: 0.970 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6893837451934814
Epoch: 11, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.881 Vali Acc: 0.560 Test Loss: 0.881 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559991).  Saving model ...
Epoch: 12 cost time: 1.6896886825561523
Epoch: 12, Steps: 20 | Train Loss: 0.397 Vali Loss: 1.083 Vali Acc: 0.530 Test Loss: 1.083 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7439994812011719
Epoch: 13, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.012 Vali Acc: 0.440 Test Loss: 1.012 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6043267250061035
Epoch: 14, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.338 Vali Acc: 0.440 Test Loss: 1.338 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4219400882720947
Epoch: 15, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.191 Vali Acc: 0.520 Test Loss: 1.191 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.53725004196167
Epoch: 16, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.310 Vali Acc: 0.540 Test Loss: 1.310 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.475019931793213
Epoch: 17, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.269 Vali Acc: 0.550 Test Loss: 1.269 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4749717712402344
Epoch: 18, Steps: 20 | Train Loss: 0.171 Vali Loss: 1.464 Vali Acc: 0.490 Test Loss: 1.464 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4517412185668945
Epoch: 19, Steps: 20 | Train Loss: 0.170 Vali Loss: 1.700 Vali Acc: 0.530 Test Loss: 1.700 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7689778804779053
Epoch: 20, Steps: 20 | Train Loss: 0.128 Vali Loss: 1.429 Vali Acc: 0.500 Test Loss: 1.429 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6840715408325195
Epoch: 21, Steps: 20 | Train Loss: 0.095 Vali Loss: 1.871 Vali Acc: 0.440 Test Loss: 1.871 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 4143234
model size : 17.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8965675830841064
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.760 Vali Acc: 0.450 Test Loss: 0.760 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 2.6582772731781006
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
Validation loss decreased (-0.449992 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.6791434288024902
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.815 Vali Acc: 0.470 Test Loss: 0.815 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.680605173110962
Epoch: 4, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.714 Vali Acc: 0.540 Test Loss: 0.714 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 2.6654717922210693
Epoch: 5, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4174416065216064
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.805 Vali Acc: 0.460 Test Loss: 0.805 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3575315475463867
Epoch: 7, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.699 Vali Acc: 0.540 Test Loss: 0.699 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 2.353970527648926
Epoch: 8, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.697 Vali Acc: 0.520 Test Loss: 0.697 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.32745361328125
Epoch: 9, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.782 Vali Acc: 0.540 Test Loss: 0.782 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7131094932556152
Epoch: 10, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7445850372314453
Epoch: 11, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.767 Vali Acc: 0.560 Test Loss: 0.767 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 12 cost time: 2.7992641925811768
Epoch: 12, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.807 Vali Acc: 0.540 Test Loss: 0.807 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7333195209503174
Epoch: 13, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.731513738632202
Epoch: 14, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.814 Vali Acc: 0.560 Test Loss: 0.814 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.5346932411193848
Epoch: 15, Steps: 20 | Train Loss: 0.385 Vali Loss: 0.985 Vali Acc: 0.500 Test Loss: 0.985 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5600600242614746
Epoch: 16, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.906 Vali Acc: 0.590 Test Loss: 0.906 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589991).  Saving model ...
Epoch: 17 cost time: 2.5236029624938965
Epoch: 17, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.069 Vali Acc: 0.520 Test Loss: 1.069 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.708966016769409
Epoch: 18, Steps: 20 | Train Loss: 0.314 Vali Loss: 0.886 Vali Acc: 0.580 Test Loss: 0.886 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.680227279663086
Epoch: 19, Steps: 20 | Train Loss: 0.311 Vali Loss: 1.025 Vali Acc: 0.510 Test Loss: 1.025 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7577931880950928
Epoch: 20, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.110 Vali Acc: 0.530 Test Loss: 1.110 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.804654121398926
Epoch: 21, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.003 Vali Acc: 0.560 Test Loss: 1.003 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.4841248989105225
Epoch: 22, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.024 Vali Acc: 0.510 Test Loss: 1.024 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4597954750061035
Epoch: 23, Steps: 20 | Train Loss: 0.206 Vali Loss: 1.136 Vali Acc: 0.530 Test Loss: 1.136 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.512735366821289
Epoch: 24, Steps: 20 | Train Loss: 0.152 Vali Loss: 1.302 Vali Acc: 0.530 Test Loss: 1.302 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.7567944526672363
Epoch: 25, Steps: 20 | Train Loss: 0.087 Vali Loss: 1.317 Vali Acc: 0.520 Test Loss: 1.317 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.660810708999634
Epoch: 26, Steps: 20 | Train Loss: 0.103 Vali Loss: 1.541 Vali Acc: 0.490 Test Loss: 1.541 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 14073090
model size : 54.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5101141929626465
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.713 Vali Acc: 0.480 Test Loss: 0.713 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.2552165985107422
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.715 Vali Acc: 0.440 Test Loss: 0.715 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1785526275634766
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.703 Vali Acc: 0.550 Test Loss: 0.703 Test Acc: 0.550
Validation loss decreased (-0.479993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.3026025295257568
Epoch: 4, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.723 Vali Acc: 0.440 Test Loss: 0.723 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3029718399047852
Epoch: 5, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.757 Vali Acc: 0.480 Test Loss: 0.757 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2688632011413574
Epoch: 6, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.236814260482788
Epoch: 7, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3508021831512451
Epoch: 8, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2973406314849854
Epoch: 9, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.965 Vali Acc: 0.500 Test Loss: 0.965 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2306554317474365
Epoch: 10, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.839 Vali Acc: 0.530 Test Loss: 0.839 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1335530281066895
Epoch: 11, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.755 Vali Acc: 0.580 Test Loss: 0.755 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579992).  Saving model ...
Epoch: 12 cost time: 1.1931378841400146
Epoch: 12, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.898 Vali Acc: 0.510 Test Loss: 0.898 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2349464893341064
Epoch: 13, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.978 Vali Acc: 0.500 Test Loss: 0.978 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1712028980255127
Epoch: 14, Steps: 20 | Train Loss: 0.384 Vali Loss: 1.016 Vali Acc: 0.460 Test Loss: 1.016 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.264256477355957
Epoch: 15, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.941 Vali Acc: 0.570 Test Loss: 0.941 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2417387962341309
Epoch: 16, Steps: 20 | Train Loss: 0.331 Vali Loss: 1.002 Vali Acc: 0.540 Test Loss: 1.002 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2826623916625977
Epoch: 17, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.062 Vali Acc: 0.510 Test Loss: 1.062 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3322033882141113
Epoch: 18, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.128 Vali Acc: 0.490 Test Loss: 1.128 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2864055633544922
Epoch: 19, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.257 Vali Acc: 0.520 Test Loss: 1.257 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2546825408935547
Epoch: 20, Steps: 20 | Train Loss: 0.224 Vali Loss: 1.138 Vali Acc: 0.560 Test Loss: 1.138 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2638766765594482
Epoch: 21, Steps: 20 | Train Loss: 0.164 Vali Loss: 1.250 Vali Acc: 0.520 Test Loss: 1.250 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4143234
model size : 17.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.804095506668091
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.760 Vali Acc: 0.460 Test Loss: 0.760 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.6740977764129639
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.742 Vali Acc: 0.470 Test Loss: 0.742 Test Acc: 0.470
Validation loss decreased (-0.459992 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 1.6327567100524902
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.814 Vali Acc: 0.470 Test Loss: 0.814 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.611840009689331
Epoch: 4, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
Validation loss decreased (-0.469993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 1.5180299282073975
Epoch: 5, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.703 Vali Acc: 0.520 Test Loss: 0.703 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5503337383270264
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.815 Vali Acc: 0.500 Test Loss: 0.815 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5211021900177002
Epoch: 7, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.694 Vali Acc: 0.600 Test Loss: 0.694 Test Acc: 0.600
Validation loss decreased (-0.529993 --> -0.599993).  Saving model ...
Epoch: 8 cost time: 1.5753440856933594
Epoch: 8, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6171231269836426
Epoch: 9, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6103532314300537
Epoch: 10, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.758 Vali Acc: 0.480 Test Loss: 0.758 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.671154499053955
Epoch: 11, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.751 Vali Acc: 0.570 Test Loss: 0.751 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5685908794403076
Epoch: 12, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.819 Vali Acc: 0.550 Test Loss: 0.819 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6263957023620605
Epoch: 13, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5842952728271484
Epoch: 14, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.810 Vali Acc: 0.530 Test Loss: 0.810 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.621504783630371
Epoch: 15, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.879 Vali Acc: 0.480 Test Loss: 0.879 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5712108612060547
Epoch: 16, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.921 Vali Acc: 0.550 Test Loss: 0.921 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.523491382598877
Epoch: 17, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.974 Vali Acc: 0.570 Test Loss: 0.974 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 14073090
model size : 54.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.0306077003479004
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.714 Vali Acc: 0.470 Test Loss: 0.714 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 0.9791262149810791
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.712 Vali Acc: 0.430 Test Loss: 0.712 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9500515460968018
Epoch: 3, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.701 Vali Acc: 0.520 Test Loss: 0.701 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 0.9049217700958252
Epoch: 4, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.719 Vali Acc: 0.450 Test Loss: 0.719 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8235054016113281
Epoch: 5, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.745 Vali Acc: 0.490 Test Loss: 0.745 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9224975109100342
Epoch: 6, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.707 Vali Acc: 0.520 Test Loss: 0.707 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8876602649688721
Epoch: 7, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.751 Vali Acc: 0.450 Test Loss: 0.751 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9411921501159668
Epoch: 8, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.755 Vali Acc: 0.480 Test Loss: 0.755 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8207287788391113
Epoch: 9, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.908 Vali Acc: 0.530 Test Loss: 0.908 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529991).  Saving model ...
Epoch: 10 cost time: 0.8977477550506592
Epoch: 10, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9601123332977295
Epoch: 11, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.711 Vali Acc: 0.620 Test Loss: 0.711 Test Acc: 0.620
Validation loss decreased (-0.529991 --> -0.619993).  Saving model ...
Epoch: 12 cost time: 0.9820656776428223
Epoch: 12, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.845 Vali Acc: 0.530 Test Loss: 0.845 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.964766263961792
Epoch: 13, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.835 Vali Acc: 0.530 Test Loss: 0.835 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9223735332489014
Epoch: 14, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.887 Vali Acc: 0.520 Test Loss: 0.887 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9707727432250977
Epoch: 15, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.832 Vali Acc: 0.590 Test Loss: 0.832 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9928755760192871
Epoch: 16, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.928 Vali Acc: 0.520 Test Loss: 0.928 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9158055782318115
Epoch: 17, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.891 Vali Acc: 0.570 Test Loss: 0.891 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8518621921539307
Epoch: 18, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.080 Vali Acc: 0.450 Test Loss: 1.080 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8988206386566162
Epoch: 19, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.086 Vali Acc: 0.510 Test Loss: 1.086 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8579552173614502
Epoch: 20, Steps: 20 | Train Loss: 0.240 Vali Loss: 1.055 Vali Acc: 0.520 Test Loss: 1.055 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8539326190948486
Epoch: 21, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.231 Vali Acc: 0.490 Test Loss: 1.231 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 4143234
model size : 17.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7736432552337646
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.685 Vali Acc: 0.500 Test Loss: 0.685 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.5944526195526123
Epoch: 2, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.686 Vali Acc: 0.490 Test Loss: 0.686 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3490793704986572
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.685 Vali Acc: 0.490 Test Loss: 0.685 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.41487979888916
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.712 Vali Acc: 0.490 Test Loss: 0.712 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.411471366882324
Epoch: 5, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.680 Vali Acc: 0.540 Test Loss: 0.680 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 2.3689358234405518
Epoch: 6, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.795 Vali Acc: 0.450 Test Loss: 0.795 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.533585786819458
Epoch: 7, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.771 Vali Acc: 0.590 Test Loss: 0.771 Test Acc: 0.590
Validation loss decreased (-0.539993 --> -0.589992).  Saving model ...
Epoch: 8 cost time: 2.618792772293091
Epoch: 8, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.807 Vali Acc: 0.500 Test Loss: 0.807 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.627981662750244
Epoch: 9, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.828 Vali Acc: 0.540 Test Loss: 0.828 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.59273099899292
Epoch: 10, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.918 Vali Acc: 0.460 Test Loss: 0.918 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3560028076171875
Epoch: 11, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.915 Vali Acc: 0.580 Test Loss: 0.915 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3713955879211426
Epoch: 12, Steps: 20 | Train Loss: 0.493 Vali Loss: 1.258 Vali Acc: 0.470 Test Loss: 1.258 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.392624616622925
Epoch: 13, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.900 Vali Acc: 0.480 Test Loss: 0.900 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.386014223098755
Epoch: 14, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.961 Vali Acc: 0.450 Test Loss: 0.961 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.487725019454956
Epoch: 15, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.934 Vali Acc: 0.500 Test Loss: 0.934 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5684142112731934
Epoch: 16, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.136 Vali Acc: 0.510 Test Loss: 1.136 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.50549054145813
Epoch: 17, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.118 Vali Acc: 0.520 Test Loss: 1.118 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 7043202
model size : 28.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.670250654220581
Epoch: 1, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.3378057479858398
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.3422508239746094
Epoch: 3, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.3677380084991455
Epoch: 4, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4266619682312012
Epoch: 5, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 1.3199818134307861
Epoch: 6, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.765 Vali Acc: 0.550 Test Loss: 0.765 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 1.3914339542388916
Epoch: 7, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.753 Vali Acc: 0.480 Test Loss: 0.753 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.20369553565979
Epoch: 8, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3215863704681396
Epoch: 9, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.744 Vali Acc: 0.550 Test Loss: 0.744 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549993).  Saving model ...
Epoch: 10 cost time: 1.270507574081421
Epoch: 10, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.838 Vali Acc: 0.520 Test Loss: 0.838 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2987020015716553
Epoch: 11, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.875 Vali Acc: 0.520 Test Loss: 0.875 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.307321548461914
Epoch: 12, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.856 Vali Acc: 0.520 Test Loss: 0.856 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3954486846923828
Epoch: 13, Steps: 20 | Train Loss: 0.336 Vali Loss: 0.955 Vali Acc: 0.510 Test Loss: 0.955 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3327863216400146
Epoch: 14, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.034 Vali Acc: 0.530 Test Loss: 1.034 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2689909934997559
Epoch: 15, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.075 Vali Acc: 0.560 Test Loss: 1.075 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559989).  Saving model ...
Epoch: 16 cost time: 1.3928418159484863
Epoch: 16, Steps: 20 | Train Loss: 0.238 Vali Loss: 1.118 Vali Acc: 0.550 Test Loss: 1.118 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3258943557739258
Epoch: 17, Steps: 20 | Train Loss: 0.212 Vali Loss: 1.235 Vali Acc: 0.570 Test Loss: 1.235 Test Acc: 0.570
Validation loss decreased (-0.559989 --> -0.569988).  Saving model ...
Epoch: 18 cost time: 1.4615051746368408
Epoch: 18, Steps: 20 | Train Loss: 0.201 Vali Loss: 1.274 Vali Acc: 0.520 Test Loss: 1.274 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2120587825775146
Epoch: 19, Steps: 20 | Train Loss: 0.165 Vali Loss: 1.442 Vali Acc: 0.490 Test Loss: 1.442 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4076554775238037
Epoch: 20, Steps: 20 | Train Loss: 0.152 Vali Loss: 1.310 Vali Acc: 0.520 Test Loss: 1.310 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.232023000717163
Epoch: 21, Steps: 20 | Train Loss: 0.119 Vali Loss: 1.306 Vali Acc: 0.580 Test Loss: 1.306 Test Acc: 0.580
Validation loss decreased (-0.569988 --> -0.579987).  Saving model ...
Epoch: 22 cost time: 1.295530080795288
Epoch: 22, Steps: 20 | Train Loss: 0.084 Vali Loss: 1.555 Vali Acc: 0.540 Test Loss: 1.555 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2118988037109375
Epoch: 23, Steps: 20 | Train Loss: 0.093 Vali Loss: 1.692 Vali Acc: 0.520 Test Loss: 1.692 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4319651126861572
Epoch: 24, Steps: 20 | Train Loss: 0.116 Vali Loss: 1.394 Vali Acc: 0.540 Test Loss: 1.394 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3265392780303955
Epoch: 25, Steps: 20 | Train Loss: 0.148 Vali Loss: 1.457 Vali Acc: 0.590 Test Loss: 1.457 Test Acc: 0.590
Validation loss decreased (-0.579987 --> -0.589985).  Saving model ...
Epoch: 26 cost time: 1.300220012664795
Epoch: 26, Steps: 20 | Train Loss: 0.085 Vali Loss: 1.449 Vali Acc: 0.570 Test Loss: 1.449 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2768406867980957
Epoch: 27, Steps: 20 | Train Loss: 0.073 Vali Loss: 1.578 Vali Acc: 0.570 Test Loss: 1.578 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2632198333740234
Epoch: 28, Steps: 20 | Train Loss: 0.068 Vali Loss: 1.709 Vali Acc: 0.540 Test Loss: 1.709 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2642035484313965
Epoch: 29, Steps: 20 | Train Loss: 0.058 Vali Loss: 1.517 Vali Acc: 0.550 Test Loss: 1.517 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2983295917510986
Epoch: 30, Steps: 20 | Train Loss: 0.046 Vali Loss: 1.893 Vali Acc: 0.530 Test Loss: 1.893 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2078082
model size : 9.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.161801338195801
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.685 Vali Acc: 0.500 Test Loss: 0.685 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.9087507724761963
Epoch: 2, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.685 Vali Acc: 0.510 Test Loss: 0.685 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.930917501449585
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.676 Vali Acc: 0.510 Test Loss: 0.676 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.7172434329986572
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 1.7581675052642822
Epoch: 5, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.668 Vali Acc: 0.550 Test Loss: 0.668 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.769404649734497
Epoch: 6, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.741 Vali Acc: 0.460 Test Loss: 0.741 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.769803762435913
Epoch: 7, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.665 Vali Acc: 0.600 Test Loss: 0.665 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 8 cost time: 1.9117186069488525
Epoch: 8, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.897230625152588
Epoch: 9, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9098849296569824
Epoch: 10, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.795 Vali Acc: 0.460 Test Loss: 0.795 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8917264938354492
Epoch: 11, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.793 Vali Acc: 0.570 Test Loss: 0.793 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7402377128601074
Epoch: 12, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.986 Vali Acc: 0.480 Test Loss: 0.986 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7246575355529785
Epoch: 13, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.745 Vali Acc: 0.550 Test Loss: 0.745 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7128105163574219
Epoch: 14, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7579503059387207
Epoch: 15, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9003026485443115
Epoch: 16, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.875 Vali Acc: 0.570 Test Loss: 0.875 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8878517150878906
Epoch: 17, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.808 Vali Acc: 0.570 Test Loss: 0.808 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 7043202
model size : 28.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.4958887100219727
Epoch: 1, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.1368412971496582
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.1235954761505127
Epoch: 3, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.725 Vali Acc: 0.520 Test Loss: 0.725 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.1432054042816162
Epoch: 4, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 1.0973994731903076
Epoch: 5, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.723 Vali Acc: 0.570 Test Loss: 0.723 Test Acc: 0.570
Validation loss decreased (-0.519993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 1.1062211990356445
Epoch: 6, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.034463882446289
Epoch: 7, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1833205223083496
Epoch: 8, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.704 Vali Acc: 0.570 Test Loss: 0.704 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569993).  Saving model ...
Epoch: 9 cost time: 1.1909139156341553
Epoch: 9, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.711 Vali Acc: 0.540 Test Loss: 0.711 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0802662372589111
Epoch: 10, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.11238694190979
Epoch: 11, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.073880910873413
Epoch: 12, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1353816986083984
Epoch: 13, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.111279010772705
Epoch: 14, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.916 Vali Acc: 0.520 Test Loss: 0.916 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0803589820861816
Epoch: 15, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.827 Vali Acc: 0.550 Test Loss: 0.827 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1418075561523438
Epoch: 16, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.178 Vali Acc: 0.520 Test Loss: 1.178 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0621535778045654
Epoch: 17, Steps: 20 | Train Loss: 0.368 Vali Loss: 0.983 Vali Acc: 0.500 Test Loss: 0.983 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1088018417358398
Epoch: 18, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.090 Vali Acc: 0.510 Test Loss: 1.090 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2078082
model size : 9.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.474116086959839
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.685 Vali Acc: 0.500 Test Loss: 0.685 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.2197027206420898
Epoch: 2, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.685 Vali Acc: 0.510 Test Loss: 0.685 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.2364280223846436
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.676 Vali Acc: 0.490 Test Loss: 0.676 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2545561790466309
Epoch: 4, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 1.2489595413208008
Epoch: 5, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.666 Vali Acc: 0.550 Test Loss: 0.666 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.248643159866333
Epoch: 6, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.740 Vali Acc: 0.460 Test Loss: 0.740 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0722510814666748
Epoch: 7, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.667 Vali Acc: 0.600 Test Loss: 0.667 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 8 cost time: 1.1730289459228516
Epoch: 8, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0955233573913574
Epoch: 9, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.699 Vali Acc: 0.550 Test Loss: 0.699 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1541335582733154
Epoch: 10, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.797 Vali Acc: 0.510 Test Loss: 0.797 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2020673751831055
Epoch: 11, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.803 Vali Acc: 0.580 Test Loss: 0.803 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2209548950195312
Epoch: 12, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.974 Vali Acc: 0.460 Test Loss: 0.974 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2088863849639893
Epoch: 13, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.751 Vali Acc: 0.570 Test Loss: 0.751 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2253148555755615
Epoch: 14, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2100200653076172
Epoch: 15, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.794 Vali Acc: 0.550 Test Loss: 0.794 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.210069179534912
Epoch: 16, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.914 Vali Acc: 0.530 Test Loss: 0.914 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1864891052246094
Epoch: 17, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.795 Vali Acc: 0.590 Test Loss: 0.795 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 7043202
model size : 28.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.0624301433563232
Epoch: 1, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.028146743774414
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 0.9543778896331787
Epoch: 3, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 0.881192684173584
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9217722415924072
Epoch: 5, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.729 Vali Acc: 0.570 Test Loss: 0.729 Test Acc: 0.570
Validation loss decreased (-0.519993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 0.9222526550292969
Epoch: 6, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.765 Vali Acc: 0.540 Test Loss: 0.765 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8756198883056641
Epoch: 7, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7963104248046875
Epoch: 8, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.702 Vali Acc: 0.580 Test Loss: 0.702 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 9 cost time: 0.8302359580993652
Epoch: 9, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.700 Vali Acc: 0.530 Test Loss: 0.700 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.894554853439331
Epoch: 10, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.771 Vali Acc: 0.470 Test Loss: 0.771 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9335525035858154
Epoch: 11, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.781 Vali Acc: 0.570 Test Loss: 0.781 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8921701908111572
Epoch: 12, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.753 Vali Acc: 0.530 Test Loss: 0.753 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9013831615447998
Epoch: 13, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.776 Vali Acc: 0.490 Test Loss: 0.776 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.933929443359375
Epoch: 14, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.904 Vali Acc: 0.460 Test Loss: 0.904 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9645843505859375
Epoch: 15, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.743 Vali Acc: 0.580 Test Loss: 0.743 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.986624002456665
Epoch: 16, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.996 Vali Acc: 0.500 Test Loss: 0.996 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9384365081787109
Epoch: 17, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.893 Vali Acc: 0.540 Test Loss: 0.893 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8500535488128662
Epoch: 18, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.921 Vali Acc: 0.490 Test Loss: 0.921 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2078082
model size : 9.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.774925947189331
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.684 Vali Acc: 0.530 Test Loss: 0.684 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.572809934616089
Epoch: 2, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.715 Vali Acc: 0.510 Test Loss: 0.715 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5849766731262207
Epoch: 3, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.423516035079956
Epoch: 4, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.727 Vali Acc: 0.470 Test Loss: 0.727 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3132221698760986
Epoch: 5, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.739 Vali Acc: 0.450 Test Loss: 0.739 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.309067726135254
Epoch: 6, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.763 Vali Acc: 0.420 Test Loss: 0.763 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.55684232711792
Epoch: 7, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.779 Vali Acc: 0.440 Test Loss: 0.779 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.56794810295105
Epoch: 8, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.758 Vali Acc: 0.480 Test Loss: 0.758 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.619666814804077
Epoch: 9, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.855 Vali Acc: 0.490 Test Loss: 0.855 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.563453197479248
Epoch: 10, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.802 Vali Acc: 0.470 Test Loss: 0.802 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.3593478202819824
Epoch: 11, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.914 Vali Acc: 0.460 Test Loss: 0.914 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 7037698
model size : 27.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.566115140914917
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.699 Vali Acc: 0.580 Test Loss: 0.699 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.3290438652038574
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.718 Vali Acc: 0.450 Test Loss: 0.718 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4046101570129395
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.719 Vali Acc: 0.460 Test Loss: 0.719 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3112590312957764
Epoch: 4, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.739 Vali Acc: 0.460 Test Loss: 0.739 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3493742942810059
Epoch: 5, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.217205286026001
Epoch: 6, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2876551151275635
Epoch: 7, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.747 Vali Acc: 0.450 Test Loss: 0.747 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2581610679626465
Epoch: 8, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2978932857513428
Epoch: 9, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3365273475646973
Epoch: 10, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3262760639190674
Epoch: 11, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.823 Vali Acc: 0.490 Test Loss: 0.823 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2072386
model size : 8.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4918229579925537
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.682 Vali Acc: 0.540 Test Loss: 0.682 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.8686583042144775
Epoch: 2, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.710 Vali Acc: 0.520 Test Loss: 0.710 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.905534029006958
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8596901893615723
Epoch: 4, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8754315376281738
Epoch: 5, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.716 Vali Acc: 0.460 Test Loss: 0.716 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7827033996582031
Epoch: 6, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.733 Vali Acc: 0.480 Test Loss: 0.733 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7988967895507812
Epoch: 7, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.784485101699829
Epoch: 8, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.757826805114746
Epoch: 9, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.865 Vali Acc: 0.510 Test Loss: 0.865 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7436914443969727
Epoch: 10, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.783 Vali Acc: 0.490 Test Loss: 0.783 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.784925937652588
Epoch: 11, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.891 Vali Acc: 0.440 Test Loss: 0.891 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 7037698
model size : 27.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.2138419151306152
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.697 Vali Acc: 0.580 Test Loss: 0.697 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.1634197235107422
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.711 Vali Acc: 0.470 Test Loss: 0.711 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1972548961639404
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1536016464233398
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9890401363372803
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1468870639801025
Epoch: 6, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.720 Vali Acc: 0.480 Test Loss: 0.720 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.080597162246704
Epoch: 7, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.725 Vali Acc: 0.460 Test Loss: 0.725 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.145075798034668
Epoch: 8, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.736 Vali Acc: 0.560 Test Loss: 0.736 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1642014980316162
Epoch: 9, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.780 Vali Acc: 0.460 Test Loss: 0.780 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1720738410949707
Epoch: 10, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.719 Vali Acc: 0.520 Test Loss: 0.719 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.218292236328125
Epoch: 11, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2072386
model size : 8.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.466893434524536
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.684 Vali Acc: 0.550 Test Loss: 0.684 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.19840669631958
Epoch: 2, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2064249515533447
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.12998366355896
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1480467319488525
Epoch: 5, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.733 Vali Acc: 0.460 Test Loss: 0.733 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1203553676605225
Epoch: 6, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.741 Vali Acc: 0.470 Test Loss: 0.741 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1794264316558838
Epoch: 7, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.235807180404663
Epoch: 8, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.720 Vali Acc: 0.450 Test Loss: 0.720 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2348277568817139
Epoch: 9, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.822 Vali Acc: 0.490 Test Loss: 0.822 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1859829425811768
Epoch: 10, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1489920616149902
Epoch: 11, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.821 Vali Acc: 0.510 Test Loss: 0.821 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 7037698
model size : 27.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.1177520751953125
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.697 Vali Acc: 0.570 Test Loss: 0.697 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 0.8911564350128174
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.712 Vali Acc: 0.470 Test Loss: 0.712 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8870849609375
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8392090797424316
Epoch: 4, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8870010375976562
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8738844394683838
Epoch: 6, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8676853179931641
Epoch: 7, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.712 Vali Acc: 0.470 Test Loss: 0.712 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8649213314056396
Epoch: 8, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.731 Vali Acc: 0.530 Test Loss: 0.731 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8300561904907227
Epoch: 9, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.766 Vali Acc: 0.450 Test Loss: 0.766 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8624477386474609
Epoch: 10, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.689 Vali Acc: 0.580 Test Loss: 0.689 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 11 cost time: 0.7673966884613037
Epoch: 11, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.727 Vali Acc: 0.610 Test Loss: 0.727 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609993).  Saving model ...
Epoch: 12 cost time: 0.7628040313720703
Epoch: 12, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.694 Vali Acc: 0.540 Test Loss: 0.694 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9739651679992676
Epoch: 13, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.768 Vali Acc: 0.580 Test Loss: 0.768 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9170520305633545
Epoch: 14, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.725 Vali Acc: 0.590 Test Loss: 0.725 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8617715835571289
Epoch: 15, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.800 Vali Acc: 0.520 Test Loss: 0.800 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8848507404327393
Epoch: 16, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.750 Vali Acc: 0.560 Test Loss: 0.750 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.845911979675293
Epoch: 17, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.787 Vali Acc: 0.510 Test Loss: 0.787 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8164305686950684
Epoch: 18, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.858 Vali Acc: 0.510 Test Loss: 0.858 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8233201503753662
Epoch: 19, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.809 Vali Acc: 0.500 Test Loss: 0.809 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8182022571563721
Epoch: 20, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.901 Vali Acc: 0.510 Test Loss: 0.901 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.776630163192749
Epoch: 21, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.934 Vali Acc: 0.510 Test Loss: 0.934 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2072386
model size : 8.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.33064866065979
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.740 Vali Acc: 0.420 Test Loss: 0.740 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 1.702991008758545
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
Validation loss decreased (-0.419993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 1.726832628250122
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.723 Vali Acc: 0.440 Test Loss: 0.723 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7555418014526367
Epoch: 4, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.736 Vali Acc: 0.440 Test Loss: 0.736 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7675983905792236
Epoch: 5, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489993).  Saving model ...
Epoch: 6 cost time: 1.7375636100769043
Epoch: 6, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.728 Vali Acc: 0.450 Test Loss: 0.728 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6371800899505615
Epoch: 7, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7720575332641602
Epoch: 8, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 9 cost time: 1.7313196659088135
Epoch: 9, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 10 cost time: 1.722747564315796
Epoch: 10, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.661113977432251
Epoch: 11, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.755 Vali Acc: 0.480 Test Loss: 0.755 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7121739387512207
Epoch: 12, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.748 Vali Acc: 0.490 Test Loss: 0.748 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.800750970840454
Epoch: 13, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.775 Vali Acc: 0.540 Test Loss: 0.775 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 14 cost time: 1.7335717678070068
Epoch: 14, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.772 Vali Acc: 0.490 Test Loss: 0.772 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.819969654083252
Epoch: 15, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.836 Vali Acc: 0.470 Test Loss: 0.836 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6922976970672607
Epoch: 16, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.761 Vali Acc: 0.570 Test Loss: 0.761 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 17 cost time: 1.7454569339752197
Epoch: 17, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.865 Vali Acc: 0.520 Test Loss: 0.865 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.682973861694336
Epoch: 18, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.792 Vali Acc: 0.550 Test Loss: 0.792 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7606608867645264
Epoch: 19, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.800 Vali Acc: 0.470 Test Loss: 0.800 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.775268793106079
Epoch: 20, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.851 Vali Acc: 0.520 Test Loss: 0.851 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7347509860992432
Epoch: 21, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.835 Vali Acc: 0.590 Test Loss: 0.835 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589992).  Saving model ...
Epoch: 22 cost time: 1.8190975189208984
Epoch: 22, Steps: 20 | Train Loss: 0.384 Vali Loss: 1.059 Vali Acc: 0.480 Test Loss: 1.059 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8577897548675537
Epoch: 23, Steps: 20 | Train Loss: 0.352 Vali Loss: 0.913 Vali Acc: 0.540 Test Loss: 0.913 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6973342895507812
Epoch: 24, Steps: 20 | Train Loss: 0.310 Vali Loss: 1.027 Vali Acc: 0.490 Test Loss: 1.027 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7297067642211914
Epoch: 25, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.060 Vali Acc: 0.530 Test Loss: 1.060 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7568039894104004
Epoch: 26, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.011 Vali Acc: 0.550 Test Loss: 1.011 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7113127708435059
Epoch: 27, Steps: 20 | Train Loss: 0.250 Vali Loss: 1.003 Vali Acc: 0.540 Test Loss: 1.003 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6734356880187988
Epoch: 28, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.120 Vali Acc: 0.530 Test Loss: 1.120 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.801142930984497
Epoch: 29, Steps: 20 | Train Loss: 0.152 Vali Loss: 1.274 Vali Acc: 0.480 Test Loss: 1.274 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7872207164764404
Epoch: 30, Steps: 20 | Train Loss: 0.163 Vali Loss: 1.177 Vali Acc: 0.450 Test Loss: 1.177 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3522178
model size : 14.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5687808990478516
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.712 Vali Acc: 0.490 Test Loss: 0.712 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.2990758419036865
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.715 Vali Acc: 0.480 Test Loss: 0.715 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3525323867797852
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.708 Vali Acc: 0.450 Test Loss: 0.708 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3611974716186523
Epoch: 4, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.713 Vali Acc: 0.480 Test Loss: 0.713 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3485958576202393
Epoch: 5, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 1.1985580921173096
Epoch: 6, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.692 Vali Acc: 0.560 Test Loss: 0.692 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559993).  Saving model ...
Epoch: 7 cost time: 1.3681161403656006
Epoch: 7, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.713 Vali Acc: 0.520 Test Loss: 0.713 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3380565643310547
Epoch: 8, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.715 Vali Acc: 0.510 Test Loss: 0.715 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3598942756652832
Epoch: 9, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.737 Vali Acc: 0.570 Test Loss: 0.737 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 10 cost time: 1.387582540512085
Epoch: 10, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3110325336456299
Epoch: 11, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2959749698638916
Epoch: 12, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3497052192687988
Epoch: 13, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.822 Vali Acc: 0.540 Test Loss: 0.822 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2538235187530518
Epoch: 14, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.804 Vali Acc: 0.560 Test Loss: 0.804 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3137719631195068
Epoch: 15, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.903 Vali Acc: 0.500 Test Loss: 0.903 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3529021739959717
Epoch: 16, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.945 Vali Acc: 0.500 Test Loss: 0.945 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3813068866729736
Epoch: 17, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.957 Vali Acc: 0.510 Test Loss: 0.957 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1454908847808838
Epoch: 18, Steps: 20 | Train Loss: 0.367 Vali Loss: 0.885 Vali Acc: 0.560 Test Loss: 0.885 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3170335292816162
Epoch: 19, Steps: 20 | Train Loss: 0.309 Vali Loss: 0.995 Vali Acc: 0.530 Test Loss: 0.995 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1039426
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.674286127090454
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.740 Vali Acc: 0.410 Test Loss: 0.740 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 1.4010167121887207
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.727 Vali Acc: 0.470 Test Loss: 0.727 Test Acc: 0.470
Validation loss decreased (-0.409993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 1.364072322845459
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.723 Vali Acc: 0.420 Test Loss: 0.723 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3527483940124512
Epoch: 4, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.736 Vali Acc: 0.440 Test Loss: 0.736 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.387704849243164
Epoch: 5, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 1.3194525241851807
Epoch: 6, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.725 Vali Acc: 0.460 Test Loss: 0.725 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2990965843200684
Epoch: 7, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.725 Vali Acc: 0.470 Test Loss: 0.725 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4383156299591064
Epoch: 8, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.395298957824707
Epoch: 9, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 10 cost time: 2.4468271732330322
Epoch: 10, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.724 Vali Acc: 0.470 Test Loss: 0.724 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4076480865478516
Epoch: 11, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.427065849304199
Epoch: 12, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3732481002807617
Epoch: 13, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.404515266418457
Epoch: 14, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 15 cost time: 2.4082322120666504
Epoch: 15, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.760 Vali Acc: 0.520 Test Loss: 0.760 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.460866689682007
Epoch: 16, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4390041828155518
Epoch: 17, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.835 Vali Acc: 0.500 Test Loss: 0.835 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4807796478271484
Epoch: 18, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.764 Vali Acc: 0.520 Test Loss: 0.764 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4790544509887695
Epoch: 19, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.773 Vali Acc: 0.570 Test Loss: 0.773 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 20 cost time: 2.6056723594665527
Epoch: 20, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.776 Vali Acc: 0.550 Test Loss: 0.776 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.427642583847046
Epoch: 21, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.815 Vali Acc: 0.580 Test Loss: 0.815 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 22 cost time: 2.4671759605407715
Epoch: 22, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.922 Vali Acc: 0.500 Test Loss: 0.922 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4720187187194824
Epoch: 23, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.900 Vali Acc: 0.520 Test Loss: 0.900 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.4910202026367188
Epoch: 24, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.879 Vali Acc: 0.510 Test Loss: 0.879 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4805140495300293
Epoch: 25, Steps: 20 | Train Loss: 0.342 Vali Loss: 0.878 Vali Acc: 0.540 Test Loss: 0.878 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.4989304542541504
Epoch: 26, Steps: 20 | Train Loss: 0.332 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.530165910720825
Epoch: 27, Steps: 20 | Train Loss: 0.306 Vali Loss: 0.899 Vali Acc: 0.570 Test Loss: 0.899 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.4670462608337402
Epoch: 28, Steps: 20 | Train Loss: 0.250 Vali Loss: 0.897 Vali Acc: 0.560 Test Loss: 0.897 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.4981114864349365
Epoch: 29, Steps: 20 | Train Loss: 0.230 Vali Loss: 0.928 Vali Acc: 0.550 Test Loss: 0.928 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.527284860610962
Epoch: 30, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.046 Vali Acc: 0.560 Test Loss: 1.046 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3522178
model size : 14.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.016122579574585
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.711 Vali Acc: 0.470 Test Loss: 0.711 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.5969867706298828
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.715 Vali Acc: 0.480 Test Loss: 0.715 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.6329197883605957
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.6087803840637207
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.713 Vali Acc: 0.490 Test Loss: 0.713 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.551828145980835
Epoch: 5, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 6 cost time: 1.6631178855895996
Epoch: 6, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.685 Vali Acc: 0.560 Test Loss: 0.685 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 7 cost time: 1.6068296432495117
Epoch: 7, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6369338035583496
Epoch: 8, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.698 Vali Acc: 0.490 Test Loss: 0.698 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.578817367553711
Epoch: 9, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.686 Vali Acc: 0.590 Test Loss: 0.686 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 10 cost time: 1.7574450969696045
Epoch: 10, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.694 Vali Acc: 0.570 Test Loss: 0.694 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7170283794403076
Epoch: 11, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5715951919555664
Epoch: 12, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.724 Vali Acc: 0.540 Test Loss: 0.724 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6317436695098877
Epoch: 13, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.708 Vali Acc: 0.600 Test Loss: 0.708 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599993).  Saving model ...
Epoch: 14 cost time: 1.6231930255889893
Epoch: 14, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.693 Vali Acc: 0.600 Test Loss: 0.693 Test Acc: 0.600
Validation loss decreased (-0.599993 --> -0.599993).  Saving model ...
Epoch: 15 cost time: 1.6597046852111816
Epoch: 15, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.716 Vali Acc: 0.560 Test Loss: 0.716 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6570122241973877
Epoch: 16, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.798 Vali Acc: 0.560 Test Loss: 0.798 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.523369312286377
Epoch: 17, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5166995525360107
Epoch: 18, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.775 Vali Acc: 0.540 Test Loss: 0.775 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4941728115081787
Epoch: 19, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.796 Vali Acc: 0.570 Test Loss: 0.796 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.483328104019165
Epoch: 20, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.843 Vali Acc: 0.490 Test Loss: 0.843 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5292201042175293
Epoch: 21, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.856 Vali Acc: 0.540 Test Loss: 0.856 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5860424041748047
Epoch: 22, Steps: 20 | Train Loss: 0.344 Vali Loss: 0.894 Vali Acc: 0.560 Test Loss: 0.894 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5462191104888916
Epoch: 23, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.945 Vali Acc: 0.560 Test Loss: 0.945 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6500186920166016
Epoch: 24, Steps: 20 | Train Loss: 0.310 Vali Loss: 0.895 Vali Acc: 0.500 Test Loss: 0.895 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1039426
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.918894052505493
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.740 Vali Acc: 0.410 Test Loss: 0.740 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 1.6856591701507568
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.727 Vali Acc: 0.470 Test Loss: 0.727 Test Acc: 0.470
Validation loss decreased (-0.409993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 1.7352075576782227
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.722 Vali Acc: 0.430 Test Loss: 0.722 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6935462951660156
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.736 Vali Acc: 0.450 Test Loss: 0.736 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.720989465713501
Epoch: 5, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 1.7458901405334473
Epoch: 6, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.723 Vali Acc: 0.480 Test Loss: 0.723 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6531248092651367
Epoch: 7, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.724 Vali Acc: 0.470 Test Loss: 0.724 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.773033618927002
Epoch: 8, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7286477088928223
Epoch: 9, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 10 cost time: 1.618969440460205
Epoch: 10, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.720 Vali Acc: 0.480 Test Loss: 0.720 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7837905883789062
Epoch: 11, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.744 Vali Acc: 0.490 Test Loss: 0.744 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8101091384887695
Epoch: 12, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.757 Vali Acc: 0.530 Test Loss: 0.757 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 13 cost time: 1.7806272506713867
Epoch: 13, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8298192024230957
Epoch: 14, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.730 Vali Acc: 0.560 Test Loss: 0.730 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559993).  Saving model ...
Epoch: 15 cost time: 1.834557056427002
Epoch: 15, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.812239170074463
Epoch: 16, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7551686763763428
Epoch: 17, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.845 Vali Acc: 0.520 Test Loss: 0.845 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.80149245262146
Epoch: 18, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.758 Vali Acc: 0.540 Test Loss: 0.758 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7874901294708252
Epoch: 19, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.809584140777588
Epoch: 20, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.771 Vali Acc: 0.540 Test Loss: 0.771 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8735909461975098
Epoch: 21, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.815 Vali Acc: 0.590 Test Loss: 0.815 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589992).  Saving model ...
Epoch: 22 cost time: 1.8579905033111572
Epoch: 22, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.889 Vali Acc: 0.510 Test Loss: 0.889 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8449006080627441
Epoch: 23, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.881 Vali Acc: 0.520 Test Loss: 0.881 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8320393562316895
Epoch: 24, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8229641914367676
Epoch: 25, Steps: 20 | Train Loss: 0.358 Vali Loss: 0.883 Vali Acc: 0.580 Test Loss: 0.883 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8212628364562988
Epoch: 26, Steps: 20 | Train Loss: 0.354 Vali Loss: 0.774 Vali Acc: 0.580 Test Loss: 0.774 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8076155185699463
Epoch: 27, Steps: 20 | Train Loss: 0.337 Vali Loss: 0.786 Vali Acc: 0.560 Test Loss: 0.786 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8314979076385498
Epoch: 28, Steps: 20 | Train Loss: 0.279 Vali Loss: 0.839 Vali Acc: 0.570 Test Loss: 0.839 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.826953411102295
Epoch: 29, Steps: 20 | Train Loss: 0.253 Vali Loss: 0.841 Vali Acc: 0.610 Test Loss: 0.841 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609992).  Saving model ...
Epoch: 30 cost time: 1.813882827758789
Epoch: 30, Steps: 20 | Train Loss: 0.288 Vali Loss: 0.913 Vali Acc: 0.530 Test Loss: 0.913 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3522178
model size : 14.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.6385653018951416
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.712 Vali Acc: 0.480 Test Loss: 0.712 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.4137959480285645
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.716 Vali Acc: 0.480 Test Loss: 0.716 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3915715217590332
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.343372106552124
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.713 Vali Acc: 0.490 Test Loss: 0.713 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3814818859100342
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.701 Vali Acc: 0.510 Test Loss: 0.701 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 6 cost time: 1.4055545330047607
Epoch: 6, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.679 Vali Acc: 0.570 Test Loss: 0.679 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569993).  Saving model ...
Epoch: 7 cost time: 1.4039654731750488
Epoch: 7, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3844702243804932
Epoch: 8, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.342320442199707
Epoch: 9, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.687 Vali Acc: 0.570 Test Loss: 0.687 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3688757419586182
Epoch: 10, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.686 Vali Acc: 0.560 Test Loss: 0.686 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.381286382675171
Epoch: 11, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4434523582458496
Epoch: 12, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.705 Vali Acc: 0.570 Test Loss: 0.705 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4771695137023926
Epoch: 13, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.692 Vali Acc: 0.580 Test Loss: 0.692 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 14 cost time: 1.4417927265167236
Epoch: 14, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.691 Vali Acc: 0.530 Test Loss: 0.691 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3561100959777832
Epoch: 15, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.699 Vali Acc: 0.590 Test Loss: 0.699 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 16 cost time: 1.3771209716796875
Epoch: 16, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.738 Vali Acc: 0.560 Test Loss: 0.738 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3764524459838867
Epoch: 17, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.39552903175354
Epoch: 18, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.739 Vali Acc: 0.570 Test Loss: 0.739 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.351743221282959
Epoch: 19, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.749 Vali Acc: 0.590 Test Loss: 0.749 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.395322561264038
Epoch: 20, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.795 Vali Acc: 0.540 Test Loss: 0.795 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3683805465698242
Epoch: 21, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.843 Vali Acc: 0.530 Test Loss: 0.843 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3477027416229248
Epoch: 22, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.800 Vali Acc: 0.580 Test Loss: 0.800 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4223575592041016
Epoch: 23, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.808 Vali Acc: 0.580 Test Loss: 0.808 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.426161289215088
Epoch: 24, Steps: 20 | Train Loss: 0.342 Vali Loss: 0.857 Vali Acc: 0.560 Test Loss: 0.857 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4428966045379639
Epoch: 25, Steps: 20 | Train Loss: 0.334 Vali Loss: 0.900 Vali Acc: 0.520 Test Loss: 0.900 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1039426
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.800365686416626
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.4746501445770264
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.5325708389282227
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.719 Vali Acc: 0.470 Test Loss: 0.719 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.40708589553833
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4622585773468018
Epoch: 5, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.735 Vali Acc: 0.460 Test Loss: 0.735 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.369459867477417
Epoch: 6, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.764 Vali Acc: 0.480 Test Loss: 0.764 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.563187837600708
Epoch: 7, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5060181617736816
Epoch: 8, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4778754711151123
Epoch: 9, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.464174747467041
Epoch: 10, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.767 Vali Acc: 0.470 Test Loss: 0.767 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.46740460395813
Epoch: 11, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.800 Vali Acc: 0.460 Test Loss: 0.800 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4890975952148438
Epoch: 12, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.808 Vali Acc: 0.470 Test Loss: 0.808 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1764418
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.291738510131836
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.684 Vali Acc: 0.500 Test Loss: 0.684 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.8851332664489746
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.698 Vali Acc: 0.490 Test Loss: 0.698 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8573384284973145
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.694 Vali Acc: 0.540 Test Loss: 0.694 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 1.9069733619689941
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8409359455108643
Epoch: 5, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.698 Vali Acc: 0.550 Test Loss: 0.698 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.8328089714050293
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.705 Vali Acc: 0.480 Test Loss: 0.705 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9604756832122803
Epoch: 7, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8349924087524414
Epoch: 8, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9882712364196777
Epoch: 9, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9115147590637207
Epoch: 10, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.698 Vali Acc: 0.600 Test Loss: 0.698 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 11 cost time: 1.7881731986999512
Epoch: 11, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8933050632476807
Epoch: 12, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8381738662719727
Epoch: 13, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9837820529937744
Epoch: 14, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.713 Vali Acc: 0.520 Test Loss: 0.713 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.873852014541626
Epoch: 15, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9091992378234863
Epoch: 16, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.820 Vali Acc: 0.490 Test Loss: 0.820 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7949018478393555
Epoch: 17, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.823 Vali Acc: 0.460 Test Loss: 0.823 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8745360374450684
Epoch: 18, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.825 Vali Acc: 0.570 Test Loss: 0.825 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8534717559814453
Epoch: 19, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.878 Vali Acc: 0.470 Test Loss: 0.878 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8655154705047607
Epoch: 20, Steps: 20 | Train Loss: 0.364 Vali Loss: 0.875 Vali Acc: 0.500 Test Loss: 0.875 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 522946
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.439901351928711
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.073117971420288
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.695 Vali Acc: 0.560 Test Loss: 0.695 Test Acc: 0.560
Validation loss decreased (-0.489993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.1311302185058594
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.717 Vali Acc: 0.490 Test Loss: 0.717 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0875470638275146
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.714 Vali Acc: 0.530 Test Loss: 0.714 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1140894889831543
Epoch: 5, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.728 Vali Acc: 0.470 Test Loss: 0.728 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0548763275146484
Epoch: 6, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1268105506896973
Epoch: 7, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9321720600128174
Epoch: 8, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.037989854812622
Epoch: 9, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.720 Vali Acc: 0.550 Test Loss: 0.720 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0247645378112793
Epoch: 10, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0939815044403076
Epoch: 11, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.02862811088562
Epoch: 12, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1764418
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8174586296081543
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.684 Vali Acc: 0.510 Test Loss: 0.684 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.53016996383667
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.698 Vali Acc: 0.470 Test Loss: 0.698 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4841506481170654
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.695 Vali Acc: 0.540 Test Loss: 0.695 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 1.554124116897583
Epoch: 4, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.705 Vali Acc: 0.490 Test Loss: 0.705 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3540372848510742
Epoch: 5, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.698 Vali Acc: 0.560 Test Loss: 0.698 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 1.5564277172088623
Epoch: 6, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.701 Vali Acc: 0.480 Test Loss: 0.701 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5935213565826416
Epoch: 7, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.710 Vali Acc: 0.540 Test Loss: 0.710 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5931174755096436
Epoch: 8, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.712 Vali Acc: 0.530 Test Loss: 0.712 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.588526964187622
Epoch: 9, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.695 Vali Acc: 0.530 Test Loss: 0.695 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5207891464233398
Epoch: 10, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.673 Vali Acc: 0.570 Test Loss: 0.673 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 1.5225656032562256
Epoch: 11, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.695 Vali Acc: 0.550 Test Loss: 0.695 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5736939907073975
Epoch: 12, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.713 Vali Acc: 0.540 Test Loss: 0.713 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6141705513000488
Epoch: 13, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.761 Vali Acc: 0.510 Test Loss: 0.761 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4852960109710693
Epoch: 14, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.698 Vali Acc: 0.530 Test Loss: 0.698 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5126848220825195
Epoch: 15, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.684 Vali Acc: 0.550 Test Loss: 0.684 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.236752986907959
Epoch: 16, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.736 Vali Acc: 0.570 Test Loss: 0.736 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6603081226348877
Epoch: 17, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5840189456939697
Epoch: 18, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4660110473632812
Epoch: 19, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.729 Vali Acc: 0.550 Test Loss: 0.729 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4604909420013428
Epoch: 20, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.693 Vali Acc: 0.540 Test Loss: 0.693 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 522946
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7318778038024902
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.564741611480713
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.696 Vali Acc: 0.560 Test Loss: 0.696 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.5526537895202637
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5634312629699707
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.716 Vali Acc: 0.530 Test Loss: 0.716 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5217101573944092
Epoch: 5, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.534074068069458
Epoch: 6, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5386738777160645
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.721 Vali Acc: 0.480 Test Loss: 0.721 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5408446788787842
Epoch: 8, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5316252708435059
Epoch: 9, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5241830348968506
Epoch: 10, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4514472484588623
Epoch: 11, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.745 Vali Acc: 0.490 Test Loss: 0.745 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.636216640472412
Epoch: 12, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1764418
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.533371925354004
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.684 Vali Acc: 0.510 Test Loss: 0.684 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.3686659336090088
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.698 Vali Acc: 0.480 Test Loss: 0.698 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3306913375854492
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.695 Vali Acc: 0.540 Test Loss: 0.695 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 1.2858238220214844
Epoch: 4, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.705 Vali Acc: 0.480 Test Loss: 0.705 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.367366075515747
Epoch: 5, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.698 Vali Acc: 0.560 Test Loss: 0.698 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 1.3264946937561035
Epoch: 6, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.702 Vali Acc: 0.480 Test Loss: 0.702 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.373093605041504
Epoch: 7, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.710 Vali Acc: 0.540 Test Loss: 0.710 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3840627670288086
Epoch: 8, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.713 Vali Acc: 0.530 Test Loss: 0.713 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3258953094482422
Epoch: 9, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.696 Vali Acc: 0.540 Test Loss: 0.696 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4037048816680908
Epoch: 10, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.675 Vali Acc: 0.570 Test Loss: 0.675 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 1.3652467727661133
Epoch: 11, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.696 Vali Acc: 0.540 Test Loss: 0.696 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3459696769714355
Epoch: 12, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.717 Vali Acc: 0.530 Test Loss: 0.717 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3402771949768066
Epoch: 13, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.759 Vali Acc: 0.490 Test Loss: 0.759 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3578875064849854
Epoch: 14, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.705 Vali Acc: 0.550 Test Loss: 0.705 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3608462810516357
Epoch: 15, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4006147384643555
Epoch: 16, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.742 Vali Acc: 0.540 Test Loss: 0.742 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3634974956512451
Epoch: 17, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.707 Vali Acc: 0.540 Test Loss: 0.707 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.381829023361206
Epoch: 18, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3730576038360596
Epoch: 19, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3320643901824951
Epoch: 20, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 522946
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.105601787567139
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.787 Vali Acc: 0.380 Test Loss: 0.787 Test Acc: 0.380
Validation loss decreased (inf --> -0.379992).  Saving model ...
Epoch: 2 cost time: 2.6088461875915527
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.770 Vali Acc: 0.360 Test Loss: 0.770 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.590294599533081
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.750 Vali Acc: 0.440 Test Loss: 0.750 Test Acc: 0.440
Validation loss decreased (-0.379992 --> -0.439992).  Saving model ...
Epoch: 4 cost time: 2.5743160247802734
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
Validation loss decreased (-0.439992 --> -0.479992).  Saving model ...
Epoch: 5 cost time: 2.608023166656494
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499992).  Saving model ...
Epoch: 6 cost time: 2.6227216720581055
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 7 cost time: 2.590359687805176
Epoch: 7, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 8 cost time: 2.610811233520508
Epoch: 8, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 9 cost time: 2.5564825534820557
Epoch: 9, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.755 Vali Acc: 0.520 Test Loss: 0.755 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 10 cost time: 2.60064959526062
Epoch: 10, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3975255489349365
Epoch: 11, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4247913360595703
Epoch: 12, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.772 Vali Acc: 0.530 Test Loss: 0.772 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 13 cost time: 2.446953296661377
Epoch: 13, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.798 Vali Acc: 0.510 Test Loss: 0.798 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.440241813659668
Epoch: 14, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4660842418670654
Epoch: 15, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.839 Vali Acc: 0.500 Test Loss: 0.839 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.521359920501709
Epoch: 16, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 17 cost time: 2.4948604106903076
Epoch: 17, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.46344256401062
Epoch: 18, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.811 Vali Acc: 0.510 Test Loss: 0.811 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.219165563583374
Epoch: 19, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.863 Vali Acc: 0.510 Test Loss: 0.863 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.47687029838562
Epoch: 20, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4995529651641846
Epoch: 21, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.996 Vali Acc: 0.480 Test Loss: 0.996 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.433274745941162
Epoch: 22, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.903 Vali Acc: 0.530 Test Loss: 0.903 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.488269567489624
Epoch: 23, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.870 Vali Acc: 0.520 Test Loss: 0.870 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.4896836280822754
Epoch: 24, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.864 Vali Acc: 0.580 Test Loss: 0.864 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579991).  Saving model ...
Epoch: 25 cost time: 2.512601613998413
Epoch: 25, Steps: 20 | Train Loss: 0.397 Vali Loss: 0.814 Vali Acc: 0.540 Test Loss: 0.814 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.43050479888916
Epoch: 26, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.086 Vali Acc: 0.520 Test Loss: 1.086 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.10534405708313
Epoch: 27, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.946 Vali Acc: 0.560 Test Loss: 0.946 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.5366411209106445
Epoch: 28, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.038 Vali Acc: 0.560 Test Loss: 1.038 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.637885093688965
Epoch: 29, Steps: 20 | Train Loss: 0.317 Vali Loss: 0.982 Vali Acc: 0.510 Test Loss: 0.982 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.5502383708953857
Epoch: 30, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.061 Vali Acc: 0.570 Test Loss: 1.061 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1761666
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.247711658477783
Epoch: 1, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.716 Vali Acc: 0.520 Test Loss: 0.716 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.8072946071624756
Epoch: 2, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.729 Vali Acc: 0.430 Test Loss: 0.729 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7195539474487305
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.724 Vali Acc: 0.440 Test Loss: 0.724 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9005184173583984
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.721 Vali Acc: 0.450 Test Loss: 0.721 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8557300567626953
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0712053775787354
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.729 Vali Acc: 0.450 Test Loss: 0.729 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.894277811050415
Epoch: 7, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.818420171737671
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.742 Vali Acc: 0.410 Test Loss: 0.742 Test Acc: 0.410
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.875108003616333
Epoch: 9, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9017035961151123
Epoch: 10, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.733 Vali Acc: 0.490 Test Loss: 0.733 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.831972360610962
Epoch: 11, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.773 Vali Acc: 0.450 Test Loss: 0.773 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 520098
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5286855697631836
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.787 Vali Acc: 0.380 Test Loss: 0.787 Test Acc: 0.380
Validation loss decreased (inf --> -0.379992).  Saving model ...
Epoch: 2 cost time: 2.075941562652588
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.769 Vali Acc: 0.360 Test Loss: 0.769 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.059068202972412
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.748 Vali Acc: 0.450 Test Loss: 0.748 Test Acc: 0.450
Validation loss decreased (-0.379992 --> -0.449993).  Saving model ...
Epoch: 4 cost time: 2.0875613689422607
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
Validation loss decreased (-0.449993 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 2.0916364192962646
Epoch: 5, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.106800079345703
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.746 Vali Acc: 0.480 Test Loss: 0.746 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.161031723022461
Epoch: 7, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 2.113473892211914
Epoch: 8, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.739 Vali Acc: 0.540 Test Loss: 0.739 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 2.1356842517852783
Epoch: 9, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.099353075027466
Epoch: 10, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.740 Vali Acc: 0.490 Test Loss: 0.740 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0778825283050537
Epoch: 11, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.139242649078369
Epoch: 12, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.735 Vali Acc: 0.560 Test Loss: 0.735 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 13 cost time: 2.152416467666626
Epoch: 13, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.748 Vali Acc: 0.520 Test Loss: 0.748 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0862107276916504
Epoch: 14, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1008784770965576
Epoch: 15, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.776 Vali Acc: 0.570 Test Loss: 0.776 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 16 cost time: 2.076056957244873
Epoch: 16, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.734 Vali Acc: 0.560 Test Loss: 0.734 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1085381507873535
Epoch: 17, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1286792755126953
Epoch: 18, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.741 Vali Acc: 0.590 Test Loss: 0.741 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589993).  Saving model ...
Epoch: 19 cost time: 2.1075541973114014
Epoch: 19, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.769 Vali Acc: 0.570 Test Loss: 0.769 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0981569290161133
Epoch: 20, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.775 Vali Acc: 0.530 Test Loss: 0.775 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0872812271118164
Epoch: 21, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.844 Vali Acc: 0.530 Test Loss: 0.844 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8995938301086426
Epoch: 22, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.876 Vali Acc: 0.490 Test Loss: 0.876 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.022456169128418
Epoch: 23, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.811 Vali Acc: 0.510 Test Loss: 0.811 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9705283641815186
Epoch: 24, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.783 Vali Acc: 0.570 Test Loss: 0.783 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.07392954826355
Epoch: 25, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.863 Vali Acc: 0.510 Test Loss: 0.863 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.066591739654541
Epoch: 26, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.982 Vali Acc: 0.620 Test Loss: 0.982 Test Acc: 0.620
Validation loss decreased (-0.589993 --> -0.619990).  Saving model ...
Epoch: 27 cost time: 1.9693303108215332
Epoch: 27, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.843 Vali Acc: 0.590 Test Loss: 0.843 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9484858512878418
Epoch: 28, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.964 Vali Acc: 0.600 Test Loss: 0.964 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.0069451332092285
Epoch: 29, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.881 Vali Acc: 0.570 Test Loss: 0.881 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9668467044830322
Epoch: 30, Steps: 20 | Train Loss: 0.376 Vali Loss: 0.871 Vali Acc: 0.530 Test Loss: 0.871 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1761666
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8679540157318115
Epoch: 1, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.5071227550506592
Epoch: 2, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.730 Vali Acc: 0.420 Test Loss: 0.730 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6451680660247803
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.725 Vali Acc: 0.430 Test Loss: 0.725 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5232622623443604
Epoch: 4, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.722 Vali Acc: 0.470 Test Loss: 0.722 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.580599069595337
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5638225078582764
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.730 Vali Acc: 0.440 Test Loss: 0.730 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5701262950897217
Epoch: 7, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1219699382781982
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.742 Vali Acc: 0.430 Test Loss: 0.742 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6107840538024902
Epoch: 9, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6353280544281006
Epoch: 10, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5829355716705322
Epoch: 11, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.770 Vali Acc: 0.450 Test Loss: 0.770 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 520098
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.866403341293335
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.787 Vali Acc: 0.380 Test Loss: 0.787 Test Acc: 0.380
Validation loss decreased (inf --> -0.379992).  Saving model ...
Epoch: 2 cost time: 1.5573818683624268
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.769 Vali Acc: 0.360 Test Loss: 0.769 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5664339065551758
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.748 Vali Acc: 0.450 Test Loss: 0.748 Test Acc: 0.450
Validation loss decreased (-0.379992 --> -0.449993).  Saving model ...
Epoch: 4 cost time: 1.5821914672851562
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
Validation loss decreased (-0.449993 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 1.5897705554962158
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5449695587158203
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.559572458267212
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 8 cost time: 1.545236587524414
Epoch: 8, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 9 cost time: 1.6049351692199707
Epoch: 9, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.620107889175415
Epoch: 10, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.742 Vali Acc: 0.470 Test Loss: 0.742 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5700562000274658
Epoch: 11, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 12 cost time: 1.5667414665222168
Epoch: 12, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6078236103057861
Epoch: 13, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6066153049468994
Epoch: 14, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.744 Vali Acc: 0.480 Test Loss: 0.744 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.579315423965454
Epoch: 15, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.776 Vali Acc: 0.540 Test Loss: 0.776 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 16 cost time: 1.56193208694458
Epoch: 16, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.756 Vali Acc: 0.520 Test Loss: 0.756 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5599365234375
Epoch: 17, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5518321990966797
Epoch: 18, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.784 Vali Acc: 0.490 Test Loss: 0.784 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5776000022888184
Epoch: 19, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.764 Vali Acc: 0.550 Test Loss: 0.764 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 20 cost time: 1.5809671878814697
Epoch: 20, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.756 Vali Acc: 0.570 Test Loss: 0.756 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 21 cost time: 1.5823194980621338
Epoch: 21, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5458204746246338
Epoch: 22, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5531840324401855
Epoch: 23, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.558485746383667
Epoch: 24, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5982389450073242
Epoch: 25, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.857 Vali Acc: 0.480 Test Loss: 0.857 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6057343482971191
Epoch: 26, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5587694644927979
Epoch: 27, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5730187892913818
Epoch: 28, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.873 Vali Acc: 0.480 Test Loss: 0.873 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5285513401031494
Epoch: 29, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.816 Vali Acc: 0.540 Test Loss: 0.816 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5834784507751465
Epoch: 30, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.849 Vali Acc: 0.480 Test Loss: 0.849 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1761666
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5797135829925537
Epoch: 1, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.3778870105743408
Epoch: 2, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.730 Vali Acc: 0.420 Test Loss: 0.730 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4042418003082275
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.725 Vali Acc: 0.450 Test Loss: 0.725 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3511805534362793
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3676209449768066
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.736 Vali Acc: 0.460 Test Loss: 0.736 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3751583099365234
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.729 Vali Acc: 0.460 Test Loss: 0.729 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3467252254486084
Epoch: 7, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.741 Vali Acc: 0.470 Test Loss: 0.741 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.411306619644165
Epoch: 8, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.740 Vali Acc: 0.450 Test Loss: 0.740 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5055615901947021
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.741 Vali Acc: 0.440 Test Loss: 0.741 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.430807113647461
Epoch: 10, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.732 Vali Acc: 0.460 Test Loss: 0.732 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3934152126312256
Epoch: 11, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.763 Vali Acc: 0.470 Test Loss: 0.763 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 520098
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6574110984802246
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.696 Vali Acc: 0.530 Test Loss: 0.696 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.1983954906463623
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.690 Vali Acc: 0.560 Test Loss: 0.690 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.286242723464966
Epoch: 3, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.687 Vali Acc: 0.590 Test Loss: 0.687 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 2.239771604537964
Epoch: 4, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.687 Vali Acc: 0.510 Test Loss: 0.687 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1488637924194336
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.703 Vali Acc: 0.520 Test Loss: 0.703 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.270115375518799
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.687 Vali Acc: 0.530 Test Loss: 0.687 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2592403888702393
Epoch: 7, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.234524965286255
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.697 Vali Acc: 0.530 Test Loss: 0.697 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.243293285369873
Epoch: 9, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.24467134475708
Epoch: 10, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2159578800201416
Epoch: 11, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.696 Vali Acc: 0.560 Test Loss: 0.696 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2154653072357178
Epoch: 12, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.162442445755005
Epoch: 13, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 882498
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2368175983428955
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.691 Vali Acc: 0.520 Test Loss: 0.691 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.886537790298462
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.680 Vali Acc: 0.530 Test Loss: 0.680 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.9009499549865723
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.687 Vali Acc: 0.530 Test Loss: 0.687 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.856825590133667
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.684 Vali Acc: 0.490 Test Loss: 0.684 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9071464538574219
Epoch: 5, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.685 Vali Acc: 0.480 Test Loss: 0.685 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8473339080810547
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.705 Vali Acc: 0.460 Test Loss: 0.705 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.822950839996338
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.702 Vali Acc: 0.460 Test Loss: 0.702 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7583444118499756
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.697 Vali Acc: 0.480 Test Loss: 0.697 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8784568309783936
Epoch: 9, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.705 Vali Acc: 0.490 Test Loss: 0.705 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7581815719604492
Epoch: 10, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.731816291809082
Epoch: 11, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.711 Vali Acc: 0.470 Test Loss: 0.711 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8695404529571533
Epoch: 12, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 261666
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.507411003112793
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.697 Vali Acc: 0.510 Test Loss: 0.697 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.0061516761779785
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.690 Vali Acc: 0.560 Test Loss: 0.690 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.9367258548736572
Epoch: 3, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.687 Vali Acc: 0.600 Test Loss: 0.687 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 1.9234824180603027
Epoch: 4, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.687 Vali Acc: 0.510 Test Loss: 0.687 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9202344417572021
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0422627925872803
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.688 Vali Acc: 0.520 Test Loss: 0.688 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0019471645355225
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9365646839141846
Epoch: 8, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.697 Vali Acc: 0.480 Test Loss: 0.697 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9271597862243652
Epoch: 9, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.698 Vali Acc: 0.520 Test Loss: 0.698 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9101207256317139
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.690 Vali Acc: 0.520 Test Loss: 0.690 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9661259651184082
Epoch: 11, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.679 Vali Acc: 0.570 Test Loss: 0.679 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9203300476074219
Epoch: 12, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.698 Vali Acc: 0.510 Test Loss: 0.698 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.924015998840332
Epoch: 13, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.693 Vali Acc: 0.540 Test Loss: 0.693 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 882498
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0015056133270264
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.691 Vali Acc: 0.520 Test Loss: 0.691 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.5376882553100586
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.680 Vali Acc: 0.540 Test Loss: 0.680 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.5245375633239746
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.687 Vali Acc: 0.530 Test Loss: 0.687 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7096917629241943
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.684 Vali Acc: 0.500 Test Loss: 0.684 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6162760257720947
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.682 Vali Acc: 0.480 Test Loss: 0.682 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.589005470275879
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.703 Vali Acc: 0.450 Test Loss: 0.703 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5349173545837402
Epoch: 7, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.696 Vali Acc: 0.480 Test Loss: 0.696 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6883466243743896
Epoch: 8, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.688 Vali Acc: 0.520 Test Loss: 0.688 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6373677253723145
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.217543363571167
Epoch: 10, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.714 Vali Acc: 0.470 Test Loss: 0.714 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5623738765716553
Epoch: 11, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6223969459533691
Epoch: 12, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 261666
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.771909475326538
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.4808299541473389
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.690 Vali Acc: 0.560 Test Loss: 0.690 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.3884882926940918
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.687 Vali Acc: 0.590 Test Loss: 0.687 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 1.217540979385376
Epoch: 4, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.686 Vali Acc: 0.520 Test Loss: 0.686 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5362498760223389
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.702 Vali Acc: 0.520 Test Loss: 0.702 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4879076480865479
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.687 Vali Acc: 0.520 Test Loss: 0.687 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5198533535003662
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5097529888153076
Epoch: 8, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.696 Vali Acc: 0.480 Test Loss: 0.696 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.592926263809204
Epoch: 9, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.698 Vali Acc: 0.490 Test Loss: 0.698 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5279152393341064
Epoch: 10, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.691 Vali Acc: 0.500 Test Loss: 0.691 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.584430456161499
Epoch: 11, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.677 Vali Acc: 0.550 Test Loss: 0.677 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4834516048431396
Epoch: 12, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4210057258605957
Epoch: 13, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.693 Vali Acc: 0.520 Test Loss: 0.693 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 882498
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.611229181289673
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.691 Vali Acc: 0.530 Test Loss: 0.691 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.3974316120147705
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.680 Vali Acc: 0.530 Test Loss: 0.680 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.3584113121032715
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.687 Vali Acc: 0.530 Test Loss: 0.687 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3680264949798584
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.684 Vali Acc: 0.500 Test Loss: 0.684 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3319227695465088
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.682 Vali Acc: 0.470 Test Loss: 0.682 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4324898719787598
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.704 Vali Acc: 0.450 Test Loss: 0.704 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3672237396240234
Epoch: 7, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.697 Vali Acc: 0.480 Test Loss: 0.697 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4100005626678467
Epoch: 8, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.688 Vali Acc: 0.520 Test Loss: 0.688 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3630919456481934
Epoch: 9, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4076929092407227
Epoch: 10, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.715 Vali Acc: 0.470 Test Loss: 0.715 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.371713638305664
Epoch: 11, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4148032665252686
Epoch: 12, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 261666
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4991655349731445
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.1650969982147217
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.724 Vali Acc: 0.460 Test Loss: 0.724 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0761773586273193
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1920571327209473
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.724 Vali Acc: 0.450 Test Loss: 0.724 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.192216634750366
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.24076771736145
Epoch: 6, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.722 Vali Acc: 0.440 Test Loss: 0.722 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.206275224685669
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.726 Vali Acc: 0.440 Test Loss: 0.726 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.202594041824341
Epoch: 8, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.738 Vali Acc: 0.460 Test Loss: 0.738 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2326250076293945
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.745 Vali Acc: 0.460 Test Loss: 0.745 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.228525161743164
Epoch: 10, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.741 Vali Acc: 0.470 Test Loss: 0.741 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.237534999847412
Epoch: 11, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 12 cost time: 2.2377848625183105
Epoch: 12, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.314302921295166
Epoch: 13, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.763 Vali Acc: 0.490 Test Loss: 0.763 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.293205976486206
Epoch: 14, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.766 Vali Acc: 0.420 Test Loss: 0.766 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.27913236618042
Epoch: 15, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.786 Vali Acc: 0.490 Test Loss: 0.786 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.188476800918579
Epoch: 16, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.766 Vali Acc: 0.450 Test Loss: 0.766 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2250776290893555
Epoch: 17, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.763 Vali Acc: 0.470 Test Loss: 0.763 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.225839853286743
Epoch: 18, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.768 Vali Acc: 0.510 Test Loss: 0.768 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2049896717071533
Epoch: 19, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.771 Vali Acc: 0.460 Test Loss: 0.771 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2874655723571777
Epoch: 20, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.838 Vali Acc: 0.510 Test Loss: 0.838 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.254202127456665
Epoch: 21, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.805 Vali Acc: 0.480 Test Loss: 0.805 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 442914
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.963136672973633
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.7767906188964844
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.892099380493164
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.705 Vali Acc: 0.490 Test Loss: 0.705 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8159544467926025
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8787596225738525
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.712 Vali Acc: 0.480 Test Loss: 0.712 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8534495830535889
Epoch: 6, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.719 Vali Acc: 0.470 Test Loss: 0.719 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7995140552520752
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.711 Vali Acc: 0.490 Test Loss: 0.711 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7693750858306885
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9114999771118164
Epoch: 9, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.719 Vali Acc: 0.460 Test Loss: 0.719 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.846613883972168
Epoch: 10, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.723 Vali Acc: 0.560 Test Loss: 0.723 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 11 cost time: 1.752195119857788
Epoch: 11, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.743004322052002
Epoch: 12, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.719 Vali Acc: 0.580 Test Loss: 0.719 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 13 cost time: 1.740738868713379
Epoch: 13, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7411108016967773
Epoch: 14, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.772 Vali Acc: 0.550 Test Loss: 0.772 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8529798984527588
Epoch: 15, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.767 Vali Acc: 0.570 Test Loss: 0.767 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7643418312072754
Epoch: 16, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.750 Vali Acc: 0.550 Test Loss: 0.750 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8042783737182617
Epoch: 17, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.832 Vali Acc: 0.540 Test Loss: 0.832 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8719918727874756
Epoch: 18, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.783 Vali Acc: 0.560 Test Loss: 0.783 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6568710803985596
Epoch: 19, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.826 Vali Acc: 0.540 Test Loss: 0.826 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9135401248931885
Epoch: 20, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.840 Vali Acc: 0.580 Test Loss: 0.840 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8847274780273438
Epoch: 21, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.854 Vali Acc: 0.550 Test Loss: 0.854 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8528785705566406
Epoch: 22, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.893 Vali Acc: 0.480 Test Loss: 0.893 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 132450
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.096736431121826
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.7242896556854248
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.724 Vali Acc: 0.460 Test Loss: 0.724 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8919227123260498
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.728 Vali Acc: 0.470 Test Loss: 0.728 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9344663619995117
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.724 Vali Acc: 0.450 Test Loss: 0.724 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9254751205444336
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8259737491607666
Epoch: 6, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.722 Vali Acc: 0.440 Test Loss: 0.722 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.924461841583252
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.726 Vali Acc: 0.430 Test Loss: 0.726 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8969597816467285
Epoch: 8, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.737 Vali Acc: 0.470 Test Loss: 0.737 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8914353847503662
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.744 Vali Acc: 0.460 Test Loss: 0.744 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.925642967224121
Epoch: 10, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.739 Vali Acc: 0.460 Test Loss: 0.739 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8848159313201904
Epoch: 11, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 442914
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.761467695236206
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.5834555625915527
Epoch: 2, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5005812644958496
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.706 Vali Acc: 0.480 Test Loss: 0.706 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5760865211486816
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.714 Vali Acc: 0.480 Test Loss: 0.714 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.595787525177002
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.712 Vali Acc: 0.480 Test Loss: 0.712 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.626828908920288
Epoch: 6, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.720 Vali Acc: 0.490 Test Loss: 0.720 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5290427207946777
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.711 Vali Acc: 0.470 Test Loss: 0.711 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.654402256011963
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.721 Vali Acc: 0.460 Test Loss: 0.721 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5873596668243408
Epoch: 9, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.720 Vali Acc: 0.490 Test Loss: 0.720 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5487487316131592
Epoch: 10, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.631598711013794
Epoch: 11, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 132450
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7152652740478516
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.4874234199523926
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.724 Vali Acc: 0.460 Test Loss: 0.724 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5054404735565186
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.728 Vali Acc: 0.470 Test Loss: 0.728 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5231044292449951
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.724 Vali Acc: 0.460 Test Loss: 0.724 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.457045078277588
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3955252170562744
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.722 Vali Acc: 0.440 Test Loss: 0.722 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4025752544403076
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.725 Vali Acc: 0.430 Test Loss: 0.725 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4041674137115479
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.561342716217041
Epoch: 9, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.743 Vali Acc: 0.470 Test Loss: 0.743 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4276025295257568
Epoch: 10, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.737 Vali Acc: 0.460 Test Loss: 0.737 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0172524452209473
Epoch: 11, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.746 Vali Acc: 0.490 Test Loss: 0.746 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 442914
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5039620399475098
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.2656190395355225
Epoch: 2, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.706 Vali Acc: 0.490 Test Loss: 0.706 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.257795810699463
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2517480850219727
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2711613178253174
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.715 Vali Acc: 0.470 Test Loss: 0.715 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.138946771621704
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.723 Vali Acc: 0.480 Test Loss: 0.723 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2933204174041748
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.715 Vali Acc: 0.460 Test Loss: 0.715 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3115870952606201
Epoch: 8, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.725 Vali Acc: 0.440 Test Loss: 0.725 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.347517728805542
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3050835132598877
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.727 Vali Acc: 0.470 Test Loss: 0.727 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3353557586669922
Epoch: 11, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.733 Vali Acc: 0.490 Test Loss: 0.733 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 132450
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.496082067489624
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.701 Vali Acc: 0.570 Test Loss: 0.701 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.52778697013855
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.459848165512085
Epoch: 3, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.700 Vali Acc: 0.550 Test Loss: 0.700 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4595143795013428
Epoch: 4, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.695 Vali Acc: 0.560 Test Loss: 0.695 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4966671466827393
Epoch: 5, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5195133686065674
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5567033290863037
Epoch: 7, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.530080556869507
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.733 Vali Acc: 0.460 Test Loss: 0.733 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.5553431510925293
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.733 Vali Acc: 0.480 Test Loss: 0.733 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.427258253097534
Epoch: 10, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.718 Vali Acc: 0.550 Test Loss: 0.718 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.484637498855591
Epoch: 11, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.744 Vali Acc: 0.460 Test Loss: 0.744 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 881410
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.198106527328491
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.703 Vali Acc: 0.480 Test Loss: 0.703 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.9556312561035156
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.698 Vali Acc: 0.490 Test Loss: 0.698 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.891275405883789
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.702 Vali Acc: 0.470 Test Loss: 0.702 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9612476825714111
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 1.8473236560821533
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.710 Vali Acc: 0.480 Test Loss: 0.710 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9353852272033691
Epoch: 6, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9426350593566895
Epoch: 7, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.717 Vali Acc: 0.490 Test Loss: 0.717 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.916851282119751
Epoch: 8, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 9 cost time: 1.8825325965881348
Epoch: 9, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9184136390686035
Epoch: 10, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8978698253631592
Epoch: 11, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.738 Vali Acc: 0.460 Test Loss: 0.738 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8371601104736328
Epoch: 12, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.930269479751587
Epoch: 13, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.758 Vali Acc: 0.480 Test Loss: 0.758 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8541522026062012
Epoch: 14, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.773 Vali Acc: 0.470 Test Loss: 0.773 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9443902969360352
Epoch: 15, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.743 Vali Acc: 0.460 Test Loss: 0.743 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8847825527191162
Epoch: 16, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.759 Vali Acc: 0.470 Test Loss: 0.759 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.787294626235962
Epoch: 17, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8275017738342285
Epoch: 18, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.787 Vali Acc: 0.470 Test Loss: 0.787 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 260434
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.449411392211914
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.702 Vali Acc: 0.540 Test Loss: 0.702 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.1181721687316895
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9876821041107178
Epoch: 3, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.045823097229004
Epoch: 4, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.696 Vali Acc: 0.580 Test Loss: 0.696 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 2.054637908935547
Epoch: 5, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.055428981781006
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6680865287780762
Epoch: 7, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.713 Vali Acc: 0.480 Test Loss: 0.713 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9152565002441406
Epoch: 8, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8934252262115479
Epoch: 9, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9396226406097412
Epoch: 10, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.712 Vali Acc: 0.540 Test Loss: 0.712 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8967218399047852
Epoch: 11, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.737 Vali Acc: 0.480 Test Loss: 0.737 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9843335151672363
Epoch: 12, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.713 Vali Acc: 0.520 Test Loss: 0.713 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.003483295440674
Epoch: 13, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9832069873809814
Epoch: 14, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.715 Vali Acc: 0.510 Test Loss: 0.715 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 881410
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.813538074493408
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.704 Vali Acc: 0.480 Test Loss: 0.704 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.6794261932373047
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.699 Vali Acc: 0.490 Test Loss: 0.699 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.6763889789581299
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.703 Vali Acc: 0.470 Test Loss: 0.703 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5891573429107666
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.6186795234680176
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.710 Vali Acc: 0.480 Test Loss: 0.710 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5928966999053955
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 7 cost time: 1.5715219974517822
Epoch: 7, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5543603897094727
Epoch: 8, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.714 Vali Acc: 0.530 Test Loss: 0.714 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 1.131516456604004
Epoch: 9, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6053650379180908
Epoch: 10, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.821645736694336
Epoch: 11, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7069065570831299
Epoch: 12, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7851018905639648
Epoch: 13, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7829434871673584
Epoch: 14, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7661030292510986
Epoch: 15, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.655496597290039
Epoch: 16, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.715 Vali Acc: 0.470 Test Loss: 0.715 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6519978046417236
Epoch: 17, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.736 Vali Acc: 0.460 Test Loss: 0.736 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5990605354309082
Epoch: 18, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.742 Vali Acc: 0.470 Test Loss: 0.742 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 260434
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.886991500854492
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.703 Vali Acc: 0.550 Test Loss: 0.703 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.6149795055389404
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.695 Vali Acc: 0.520 Test Loss: 0.695 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.622131586074829
Epoch: 3, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.702 Vali Acc: 0.520 Test Loss: 0.702 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.543668508529663
Epoch: 4, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.636828899383545
Epoch: 5, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6156284809112549
Epoch: 6, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.635263442993164
Epoch: 7, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6237480640411377
Epoch: 8, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.62321138381958
Epoch: 9, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5797555446624756
Epoch: 10, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6324224472045898
Epoch: 11, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 881410
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.6428353786468506
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.707 Vali Acc: 0.480 Test Loss: 0.707 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.3922834396362305
Epoch: 2, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.704 Vali Acc: 0.470 Test Loss: 0.704 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.411564826965332
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.709 Vali Acc: 0.460 Test Loss: 0.709 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4615166187286377
Epoch: 4, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 1.4006516933441162
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4808018207550049
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 7 cost time: 1.435396432876587
Epoch: 7, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.348397970199585
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.423757553100586
Epoch: 9, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.728 Vali Acc: 0.480 Test Loss: 0.728 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4169378280639648
Epoch: 10, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4279694557189941
Epoch: 11, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.450913906097412
Epoch: 12, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4369657039642334
Epoch: 13, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3891100883483887
Epoch: 14, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.738 Vali Acc: 0.470 Test Loss: 0.738 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4104180335998535
Epoch: 15, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 16 cost time: 1.453010082244873
Epoch: 16, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.723 Vali Acc: 0.530 Test Loss: 0.723 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 17 cost time: 1.3941912651062012
Epoch: 17, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.346562385559082
Epoch: 18, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.443974256515503
Epoch: 19, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4717719554901123
Epoch: 20, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.719 Vali Acc: 0.520 Test Loss: 0.719 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3933517932891846
Epoch: 21, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.718 Vali Acc: 0.540 Test Loss: 0.718 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 22 cost time: 1.0584306716918945
Epoch: 22, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 23 cost time: 1.3992321491241455
Epoch: 23, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.723 Vali Acc: 0.540 Test Loss: 0.723 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3898372650146484
Epoch: 24, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.709 Vali Acc: 0.550 Test Loss: 0.709 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3277113437652588
Epoch: 25, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.718 Vali Acc: 0.560 Test Loss: 0.718 Test Acc: 0.560
Validation loss decreased (-0.559993 --> -0.559993).  Saving model ...
Epoch: 26 cost time: 1.4276814460754395
Epoch: 26, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.718 Vali Acc: 0.540 Test Loss: 0.718 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4467451572418213
Epoch: 27, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.751 Vali Acc: 0.520 Test Loss: 0.751 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.390852451324463
Epoch: 28, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.718 Vali Acc: 0.570 Test Loss: 0.718 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 29 cost time: 1.4174044132232666
Epoch: 29, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.739 Vali Acc: 0.550 Test Loss: 0.739 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3989670276641846
Epoch: 30, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.731 Vali Acc: 0.570 Test Loss: 0.731 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 260434
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3958404064178467
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.665 Vali Acc: 0.560 Test Loss: 0.665 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.233367443084717
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.675 Vali Acc: 0.560 Test Loss: 0.675 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.241180181503296
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.680 Vali Acc: 0.590 Test Loss: 0.680 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 2.230942487716675
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.688 Vali Acc: 0.560 Test Loss: 0.688 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.182901620864868
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.694 Vali Acc: 0.580 Test Loss: 0.694 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1416256427764893
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.703 Vali Acc: 0.530 Test Loss: 0.703 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2494468688964844
Epoch: 7, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.699 Vali Acc: 0.550 Test Loss: 0.699 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.529963493347168
Epoch: 8, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2908003330230713
Epoch: 9, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2696542739868164
Epoch: 10, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.715 Vali Acc: 0.550 Test Loss: 0.715 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.179840564727783
Epoch: 11, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.720 Vali Acc: 0.560 Test Loss: 0.720 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.263831377029419
Epoch: 12, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.733 Vali Acc: 0.550 Test Loss: 0.733 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.2750606536865234
Epoch: 13, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 441538
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.179781675338745
Epoch: 1, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.685 Vali Acc: 0.550 Test Loss: 0.685 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.018364429473877
Epoch: 2, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.680 Vali Acc: 0.540 Test Loss: 0.680 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9679913520812988
Epoch: 3, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.677 Vali Acc: 0.570 Test Loss: 0.677 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 1.8173589706420898
Epoch: 4, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.679 Vali Acc: 0.550 Test Loss: 0.679 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9749159812927246
Epoch: 5, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.679 Vali Acc: 0.490 Test Loss: 0.679 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.978097915649414
Epoch: 6, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.687 Vali Acc: 0.480 Test Loss: 0.687 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0311009883880615
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.690 Vali Acc: 0.500 Test Loss: 0.690 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.016113758087158
Epoch: 8, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0340676307678223
Epoch: 9, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.699 Vali Acc: 0.460 Test Loss: 0.699 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9915857315063477
Epoch: 10, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9149434566497803
Epoch: 11, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.704 Vali Acc: 0.460 Test Loss: 0.704 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9025986194610596
Epoch: 12, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0076303482055664
Epoch: 13, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 131026
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.340160846710205
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.665 Vali Acc: 0.550 Test Loss: 0.665 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.9991066455841064
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.674 Vali Acc: 0.560 Test Loss: 0.674 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.983762264251709
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.679 Vali Acc: 0.590 Test Loss: 0.679 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 1.8577327728271484
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.687 Vali Acc: 0.570 Test Loss: 0.687 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.959944725036621
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.694 Vali Acc: 0.580 Test Loss: 0.694 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.979945182800293
Epoch: 6, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.702 Vali Acc: 0.520 Test Loss: 0.702 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8947250843048096
Epoch: 7, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.700 Vali Acc: 0.550 Test Loss: 0.700 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8905043601989746
Epoch: 8, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.710 Vali Acc: 0.550 Test Loss: 0.710 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.00333571434021
Epoch: 9, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.722 Vali Acc: 0.530 Test Loss: 0.722 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9363160133361816
Epoch: 10, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.715 Vali Acc: 0.550 Test Loss: 0.715 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9778101444244385
Epoch: 11, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.717 Vali Acc: 0.570 Test Loss: 0.717 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.920304536819458
Epoch: 12, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.087317705154419
Epoch: 13, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 441538
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.016792058944702
Epoch: 1, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.685 Vali Acc: 0.560 Test Loss: 0.685 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.510024070739746
Epoch: 2, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.680 Vali Acc: 0.540 Test Loss: 0.680 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6335926055908203
Epoch: 3, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.677 Vali Acc: 0.560 Test Loss: 0.677 Test Acc: 0.560
Validation loss decreased (-0.559993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 1.6004853248596191
Epoch: 4, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.678 Vali Acc: 0.540 Test Loss: 0.678 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.610015869140625
Epoch: 5, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.676 Vali Acc: 0.490 Test Loss: 0.676 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5734896659851074
Epoch: 6, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.682 Vali Acc: 0.520 Test Loss: 0.682 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5819547176361084
Epoch: 7, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.686 Vali Acc: 0.490 Test Loss: 0.686 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6323487758636475
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.689 Vali Acc: 0.510 Test Loss: 0.689 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6190142631530762
Epoch: 9, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.691 Vali Acc: 0.460 Test Loss: 0.691 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5486538410186768
Epoch: 10, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.690 Vali Acc: 0.500 Test Loss: 0.690 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.637220859527588
Epoch: 11, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.692 Vali Acc: 0.510 Test Loss: 0.692 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5324428081512451
Epoch: 12, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.690 Vali Acc: 0.540 Test Loss: 0.690 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.640977382659912
Epoch: 13, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 131026
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9416441917419434
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.664 Vali Acc: 0.550 Test Loss: 0.664 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.4452252388000488
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.673 Vali Acc: 0.580 Test Loss: 0.673 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 1.4961683750152588
Epoch: 3, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.679 Vali Acc: 0.600 Test Loss: 0.679 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 1.6513290405273438
Epoch: 4, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.688 Vali Acc: 0.580 Test Loss: 0.688 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.618025779724121
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.694 Vali Acc: 0.550 Test Loss: 0.694 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5622344017028809
Epoch: 6, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.705 Vali Acc: 0.510 Test Loss: 0.705 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6792938709259033
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.701 Vali Acc: 0.550 Test Loss: 0.701 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4852321147918701
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.713 Vali Acc: 0.540 Test Loss: 0.713 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5978517532348633
Epoch: 9, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.723 Vali Acc: 0.530 Test Loss: 0.723 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6233398914337158
Epoch: 10, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.721 Vali Acc: 0.540 Test Loss: 0.721 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6294307708740234
Epoch: 11, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.715 Vali Acc: 0.540 Test Loss: 0.715 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6716110706329346
Epoch: 12, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.725 Vali Acc: 0.530 Test Loss: 0.725 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4893367290496826
Epoch: 13, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.729 Vali Acc: 0.470 Test Loss: 0.729 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 441538
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.663686752319336
Epoch: 1, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.684 Vali Acc: 0.580 Test Loss: 0.684 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.4363768100738525
Epoch: 2, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.678 Vali Acc: 0.560 Test Loss: 0.678 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4674794673919678
Epoch: 3, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.674 Vali Acc: 0.610 Test Loss: 0.674 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609993).  Saving model ...
Epoch: 4 cost time: 1.5652482509613037
Epoch: 4, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.673 Vali Acc: 0.560 Test Loss: 0.673 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3804912567138672
Epoch: 5, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.669 Vali Acc: 0.560 Test Loss: 0.669 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5005574226379395
Epoch: 6, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.676 Vali Acc: 0.550 Test Loss: 0.676 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3565013408660889
Epoch: 7, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.680 Vali Acc: 0.520 Test Loss: 0.680 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4591045379638672
Epoch: 8, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.684 Vali Acc: 0.510 Test Loss: 0.684 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.448958158493042
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.685 Vali Acc: 0.490 Test Loss: 0.685 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5453712940216064
Epoch: 10, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.683 Vali Acc: 0.500 Test Loss: 0.683 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.42802095413208
Epoch: 11, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.684 Vali Acc: 0.500 Test Loss: 0.684 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3968472480773926
Epoch: 12, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.687 Vali Acc: 0.500 Test Loss: 0.687 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4118924140930176
Epoch: 13, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 131026
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5400519371032715
Epoch: 1, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.740 Vali Acc: 0.420 Test Loss: 0.740 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 2.1576337814331055
Epoch: 2, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.708 Vali Acc: 0.460 Test Loss: 0.708 Test Acc: 0.460
Validation loss decreased (-0.419993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 2.182204484939575
Epoch: 3, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.696 Vali Acc: 0.510 Test Loss: 0.696 Test Acc: 0.510
Validation loss decreased (-0.459993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 2.318328857421875
Epoch: 4, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.687 Vali Acc: 0.490 Test Loss: 0.687 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.208983898162842
Epoch: 5, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.686 Vali Acc: 0.490 Test Loss: 0.686 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2218916416168213
Epoch: 6, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.685 Vali Acc: 0.520 Test Loss: 0.685 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 2.07477068901062
Epoch: 7, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.683 Vali Acc: 0.520 Test Loss: 0.683 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 2.10111141204834
Epoch: 8, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.682 Vali Acc: 0.520 Test Loss: 0.682 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 9 cost time: 2.241739511489868
Epoch: 9, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.679 Vali Acc: 0.530 Test Loss: 0.679 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 10 cost time: 2.239993095397949
Epoch: 10, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.687 Vali Acc: 0.510 Test Loss: 0.687 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.320826530456543
Epoch: 11, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.684 Vali Acc: 0.550 Test Loss: 0.684 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 2.2524774074554443
Epoch: 12, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.690 Vali Acc: 0.490 Test Loss: 0.690 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3249289989471436
Epoch: 13, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.676 Vali Acc: 0.540 Test Loss: 0.676 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.213752031326294
Epoch: 14, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.674 Vali Acc: 0.550 Test Loss: 0.674 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 15 cost time: 2.3340346813201904
Epoch: 15, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.674 Vali Acc: 0.530 Test Loss: 0.674 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.097132444381714
Epoch: 16, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.691 Vali Acc: 0.550 Test Loss: 0.691 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.135607957839966
Epoch: 17, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.699 Vali Acc: 0.560 Test Loss: 0.699 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 18 cost time: 2.139564037322998
Epoch: 18, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.699 Vali Acc: 0.580 Test Loss: 0.699 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 19 cost time: 2.1595535278320312
Epoch: 19, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.675 Vali Acc: 0.500 Test Loss: 0.675 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1797423362731934
Epoch: 20, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.677 Vali Acc: 0.560 Test Loss: 0.677 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.160684585571289
Epoch: 21, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.705 Vali Acc: 0.540 Test Loss: 0.705 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2151660919189453
Epoch: 22, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.690 Vali Acc: 0.550 Test Loss: 0.690 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.2419979572296143
Epoch: 23, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.704 Vali Acc: 0.560 Test Loss: 0.704 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.98935866355896
Epoch: 24, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.772 Vali Acc: 0.490 Test Loss: 0.772 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.1216881275177
Epoch: 25, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.1517815589904785
Epoch: 26, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.168185234069824
Epoch: 27, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.894 Vali Acc: 0.480 Test Loss: 0.894 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.293665647506714
Epoch: 28, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.878 Vali Acc: 0.520 Test Loss: 0.878 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 221602
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.793501138687134
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.9639079570770264
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.901045799255371
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.705 Vali Acc: 0.490 Test Loss: 0.705 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 1.8977489471435547
Epoch: 4, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.700 Vali Acc: 0.470 Test Loss: 0.700 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.987182855606079
Epoch: 5, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.695 Vali Acc: 0.480 Test Loss: 0.695 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0193686485290527
Epoch: 6, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.695 Vali Acc: 0.440 Test Loss: 0.695 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0092577934265137
Epoch: 7, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.699 Vali Acc: 0.480 Test Loss: 0.699 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9077000617980957
Epoch: 8, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 9 cost time: 2.000441551208496
Epoch: 9, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9898571968078613
Epoch: 10, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.692 Vali Acc: 0.530 Test Loss: 0.692 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 11 cost time: 1.9463462829589844
Epoch: 11, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.692 Vali Acc: 0.520 Test Loss: 0.692 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9082117080688477
Epoch: 12, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.701 Vali Acc: 0.550 Test Loss: 0.701 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 13 cost time: 1.9620089530944824
Epoch: 13, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.689 Vali Acc: 0.550 Test Loss: 0.689 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 14 cost time: 2.1073012351989746
Epoch: 14, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.698 Vali Acc: 0.530 Test Loss: 0.698 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.962073802947998
Epoch: 15, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.713 Vali Acc: 0.580 Test Loss: 0.713 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 16 cost time: 1.9426062107086182
Epoch: 16, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.075486660003662
Epoch: 17, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.716 Vali Acc: 0.570 Test Loss: 0.716 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9673280715942383
Epoch: 18, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.717 Vali Acc: 0.560 Test Loss: 0.717 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0014398097991943
Epoch: 19, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.715 Vali Acc: 0.560 Test Loss: 0.715 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9906713962554932
Epoch: 20, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.737 Vali Acc: 0.620 Test Loss: 0.737 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619993).  Saving model ...
Epoch: 21 cost time: 1.9925763607025146
Epoch: 21, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.736 Vali Acc: 0.580 Test Loss: 0.736 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.982945203781128
Epoch: 22, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.714 Vali Acc: 0.560 Test Loss: 0.714 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1766316890716553
Epoch: 23, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.715 Vali Acc: 0.570 Test Loss: 0.715 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8670156002044678
Epoch: 24, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.733 Vali Acc: 0.550 Test Loss: 0.733 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0241308212280273
Epoch: 25, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.719 Vali Acc: 0.570 Test Loss: 0.719 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9242503643035889
Epoch: 26, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.753 Vali Acc: 0.570 Test Loss: 0.753 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9377083778381348
Epoch: 27, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.715 Vali Acc: 0.590 Test Loss: 0.715 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.9564099311828613
Epoch: 28, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.750 Vali Acc: 0.570 Test Loss: 0.750 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9070520401000977
Epoch: 29, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.731 Vali Acc: 0.600 Test Loss: 0.731 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9815425872802734
Epoch: 30, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.753 Vali Acc: 0.560 Test Loss: 0.753 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 66322
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.379610538482666
Epoch: 1, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.740 Vali Acc: 0.410 Test Loss: 0.740 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 1.8609590530395508
Epoch: 2, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.708 Vali Acc: 0.460 Test Loss: 0.708 Test Acc: 0.460
Validation loss decreased (-0.409993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 2.009704113006592
Epoch: 3, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
Validation loss decreased (-0.459993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 2.0376203060150146
Epoch: 4, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.687 Vali Acc: 0.470 Test Loss: 0.687 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.897949457168579
Epoch: 5, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.687 Vali Acc: 0.490 Test Loss: 0.687 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.02154278755188
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.686 Vali Acc: 0.550 Test Loss: 0.686 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 1.9404404163360596
Epoch: 7, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.683 Vali Acc: 0.530 Test Loss: 0.683 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8768508434295654
Epoch: 8, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.681 Vali Acc: 0.560 Test Loss: 0.681 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 1.8779759407043457
Epoch: 9, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.681 Vali Acc: 0.530 Test Loss: 0.681 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.804002285003662
Epoch: 10, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.928530216217041
Epoch: 11, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.686 Vali Acc: 0.540 Test Loss: 0.686 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9123597145080566
Epoch: 12, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.693 Vali Acc: 0.530 Test Loss: 0.693 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9408624172210693
Epoch: 13, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.668 Vali Acc: 0.580 Test Loss: 0.668 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 14 cost time: 1.9246604442596436
Epoch: 14, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.670 Vali Acc: 0.570 Test Loss: 0.670 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9979166984558105
Epoch: 15, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.666 Vali Acc: 0.540 Test Loss: 0.666 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9651668071746826
Epoch: 16, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.676 Vali Acc: 0.600 Test Loss: 0.676 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599993).  Saving model ...
Epoch: 17 cost time: 1.9523379802703857
Epoch: 17, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.686 Vali Acc: 0.570 Test Loss: 0.686 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7558786869049072
Epoch: 18, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.680 Vali Acc: 0.610 Test Loss: 0.680 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609993).  Saving model ...
Epoch: 19 cost time: 1.819023609161377
Epoch: 19, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.662 Vali Acc: 0.550 Test Loss: 0.662 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8052866458892822
Epoch: 20, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.667 Vali Acc: 0.590 Test Loss: 0.667 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9000060558319092
Epoch: 21, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.687 Vali Acc: 0.540 Test Loss: 0.687 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8907840251922607
Epoch: 22, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.691 Vali Acc: 0.580 Test Loss: 0.691 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.106992244720459
Epoch: 23, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.682 Vali Acc: 0.580 Test Loss: 0.682 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0118236541748047
Epoch: 24, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.1331355571746826
Epoch: 25, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.742 Vali Acc: 0.550 Test Loss: 0.742 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8869750499725342
Epoch: 26, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.750 Vali Acc: 0.560 Test Loss: 0.750 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9556057453155518
Epoch: 27, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.815 Vali Acc: 0.510 Test Loss: 0.815 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.0589566230773926
Epoch: 28, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.835 Vali Acc: 0.500 Test Loss: 0.835 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 221602
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8757596015930176
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.6679017543792725
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.710 Vali Acc: 0.480 Test Loss: 0.710 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.6977627277374268
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.705 Vali Acc: 0.490 Test Loss: 0.705 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 1.8084444999694824
Epoch: 4, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.699 Vali Acc: 0.470 Test Loss: 0.699 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7790648937225342
Epoch: 5, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.694 Vali Acc: 0.480 Test Loss: 0.694 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6963496208190918
Epoch: 6, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.695 Vali Acc: 0.470 Test Loss: 0.695 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6979870796203613
Epoch: 7, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.698 Vali Acc: 0.460 Test Loss: 0.698 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.600489854812622
Epoch: 8, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.694 Vali Acc: 0.520 Test Loss: 0.694 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 9 cost time: 1.6885669231414795
Epoch: 9, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.696 Vali Acc: 0.490 Test Loss: 0.696 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7306311130523682
Epoch: 10, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5906591415405273
Epoch: 11, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.694 Vali Acc: 0.480 Test Loss: 0.694 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6267008781433105
Epoch: 12, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 13 cost time: 1.7199862003326416
Epoch: 13, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.694 Vali Acc: 0.530 Test Loss: 0.694 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6643621921539307
Epoch: 14, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.700 Vali Acc: 0.530 Test Loss: 0.700 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6985421180725098
Epoch: 15, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.714 Vali Acc: 0.580 Test Loss: 0.714 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 16 cost time: 1.6079390048980713
Epoch: 16, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.700 Vali Acc: 0.550 Test Loss: 0.700 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6604759693145752
Epoch: 17, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.714 Vali Acc: 0.580 Test Loss: 0.714 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6717557907104492
Epoch: 18, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.718 Vali Acc: 0.590 Test Loss: 0.718 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 19 cost time: 1.651045322418213
Epoch: 19, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.718 Vali Acc: 0.560 Test Loss: 0.718 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7397856712341309
Epoch: 20, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.734 Vali Acc: 0.560 Test Loss: 0.734 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7643687725067139
Epoch: 21, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.737 Vali Acc: 0.550 Test Loss: 0.737 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6680843830108643
Epoch: 22, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.723 Vali Acc: 0.540 Test Loss: 0.723 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7684359550476074
Epoch: 23, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.713 Vali Acc: 0.540 Test Loss: 0.713 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5615959167480469
Epoch: 24, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.741 Vali Acc: 0.530 Test Loss: 0.741 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6404833793640137
Epoch: 25, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.714 Vali Acc: 0.560 Test Loss: 0.714 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4852688312530518
Epoch: 26, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6843235492706299
Epoch: 27, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6726148128509521
Epoch: 28, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 66322
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7938482761383057
Epoch: 1, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.742 Vali Acc: 0.410 Test Loss: 0.742 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 1.490082025527954
Epoch: 2, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.710 Vali Acc: 0.450 Test Loss: 0.710 Test Acc: 0.450
Validation loss decreased (-0.409993 --> -0.449993).  Saving model ...
Epoch: 3 cost time: 1.609755516052246
Epoch: 3, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.697 Vali Acc: 0.510 Test Loss: 0.697 Test Acc: 0.510
Validation loss decreased (-0.449993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.4958734512329102
Epoch: 4, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.687 Vali Acc: 0.490 Test Loss: 0.687 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.507936954498291
Epoch: 5, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.687 Vali Acc: 0.510 Test Loss: 0.687 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 6 cost time: 1.440835952758789
Epoch: 6, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.688 Vali Acc: 0.500 Test Loss: 0.688 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4815847873687744
Epoch: 7, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.687 Vali Acc: 0.520 Test Loss: 0.687 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 1.5286240577697754
Epoch: 8, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.685 Vali Acc: 0.520 Test Loss: 0.685 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 9 cost time: 1.6278436183929443
Epoch: 9, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.683 Vali Acc: 0.550 Test Loss: 0.683 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 10 cost time: 1.562117576599121
Epoch: 10, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.693 Vali Acc: 0.530 Test Loss: 0.693 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1695990562438965
Epoch: 11, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3933534622192383
Epoch: 12, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.38399338722229
Epoch: 13, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.692 Vali Acc: 0.540 Test Loss: 0.692 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4996728897094727
Epoch: 14, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.477088212966919
Epoch: 15, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.702 Vali Acc: 0.540 Test Loss: 0.702 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4462857246398926
Epoch: 16, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.504871129989624
Epoch: 17, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4486160278320312
Epoch: 18, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.600818157196045
Epoch: 19, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.705 Vali Acc: 0.480 Test Loss: 0.705 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 221602
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.481458902359009
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.721 Vali Acc: 0.460 Test Loss: 0.721 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.3915989398956299
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.711 Vali Acc: 0.480 Test Loss: 0.711 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.2981972694396973
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.705 Vali Acc: 0.490 Test Loss: 0.705 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 1.364119052886963
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.699 Vali Acc: 0.460 Test Loss: 0.699 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.322347640991211
Epoch: 5, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 1.3728840351104736
Epoch: 6, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.694 Vali Acc: 0.460 Test Loss: 0.694 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3220717906951904
Epoch: 7, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.696 Vali Acc: 0.450 Test Loss: 0.696 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.267266035079956
Epoch: 8, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.693 Vali Acc: 0.530 Test Loss: 0.693 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 1.2792344093322754
Epoch: 9, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3770813941955566
Epoch: 10, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.692 Vali Acc: 0.500 Test Loss: 0.692 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3768630027770996
Epoch: 11, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.692 Vali Acc: 0.460 Test Loss: 0.692 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3660857677459717
Epoch: 12, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3842172622680664
Epoch: 13, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.692 Vali Acc: 0.530 Test Loss: 0.692 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 14 cost time: 1.423410415649414
Epoch: 14, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.700 Vali Acc: 0.470 Test Loss: 0.700 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.403099536895752
Epoch: 15, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.371626377105713
Epoch: 16, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 17 cost time: 1.361729383468628
Epoch: 17, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.713 Vali Acc: 0.530 Test Loss: 0.713 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4239938259124756
Epoch: 18, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.713 Vali Acc: 0.490 Test Loss: 0.713 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3880367279052734
Epoch: 19, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.713 Vali Acc: 0.520 Test Loss: 0.713 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.486624002456665
Epoch: 20, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 21 cost time: 1.3728141784667969
Epoch: 21, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.728 Vali Acc: 0.510 Test Loss: 0.728 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4210734367370605
Epoch: 22, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4429872035980225
Epoch: 23, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4218575954437256
Epoch: 24, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.727 Vali Acc: 0.570 Test Loss: 0.727 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 25 cost time: 1.399742841720581
Epoch: 25, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.704 Vali Acc: 0.540 Test Loss: 0.704 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.364041805267334
Epoch: 26, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3409006595611572
Epoch: 27, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.723 Vali Acc: 0.560 Test Loss: 0.723 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3427715301513672
Epoch: 28, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.719 Vali Acc: 0.570 Test Loss: 0.719 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569993).  Saving model ...
Epoch: 29 cost time: 1.4566562175750732
Epoch: 29, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.724 Vali Acc: 0.540 Test Loss: 0.724 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3931210041046143
Epoch: 30, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.710 Vali Acc: 0.550 Test Loss: 0.710 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 66322
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 13.376742362976074
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.751 Vali Acc: 0.450 Test Loss: 0.751 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 12.015407800674438
Epoch: 2, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
Validation loss decreased (-0.449992 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 11.79601764678955
Epoch: 3, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.775 Vali Acc: 0.430 Test Loss: 0.775 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.829795598983765
Epoch: 4, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.753 Vali Acc: 0.430 Test Loss: 0.753 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.898179531097412
Epoch: 5, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.862 Vali Acc: 0.460 Test Loss: 0.862 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.976624250411987
Epoch: 6, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.895 Vali Acc: 0.490 Test Loss: 0.895 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.332486867904663
Epoch: 7, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.998 Vali Acc: 0.530 Test Loss: 0.998 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.085705757141113
Epoch: 8, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.985 Vali Acc: 0.480 Test Loss: 0.985 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 11.090101480484009
Epoch: 9, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.028 Vali Acc: 0.530 Test Loss: 1.028 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 11.158121347427368
Epoch: 10, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.997 Vali Acc: 0.480 Test Loss: 0.997 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 10.727472066879272
Epoch: 11, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.095 Vali Acc: 0.410 Test Loss: 1.095 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.850950956344604
Epoch: 12, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.997 Vali Acc: 0.480 Test Loss: 0.997 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 37515522
model size : 145.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.149641036987305
Epoch: 1, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.728 Vali Acc: 0.480 Test Loss: 0.728 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 3.941784381866455
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.796 Vali Acc: 0.460 Test Loss: 0.796 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9202284812927246
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.701 Vali Acc: 0.520 Test Loss: 0.701 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 3.998734712600708
Epoch: 4, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.752 Vali Acc: 0.460 Test Loss: 0.752 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8849093914031982
Epoch: 5, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.843 Vali Acc: 0.540 Test Loss: 0.843 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 3.9397308826446533
Epoch: 6, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.886 Vali Acc: 0.440 Test Loss: 0.886 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8622794151306152
Epoch: 7, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.815 Vali Acc: 0.490 Test Loss: 0.815 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.872803211212158
Epoch: 8, Steps: 20 | Train Loss: 0.473 Vali Loss: 1.068 Vali Acc: 0.450 Test Loss: 1.068 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.048407554626465
Epoch: 9, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.977 Vali Acc: 0.480 Test Loss: 0.977 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.9576311111450195
Epoch: 10, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.935 Vali Acc: 0.540 Test Loss: 0.935 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.9301562309265137
Epoch: 11, Steps: 20 | Train Loss: 0.370 Vali Loss: 1.051 Vali Acc: 0.590 Test Loss: 1.051 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589989).  Saving model ...
Epoch: 12 cost time: 3.8949661254882812
Epoch: 12, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.988 Vali Acc: 0.520 Test Loss: 0.988 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8394715785980225
Epoch: 13, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.093 Vali Acc: 0.520 Test Loss: 1.093 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.9158105850219727
Epoch: 14, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.247 Vali Acc: 0.490 Test Loss: 1.247 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.8517186641693115
Epoch: 15, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.035 Vali Acc: 0.540 Test Loss: 1.035 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.811846971511841
Epoch: 16, Steps: 20 | Train Loss: 0.211 Vali Loss: 1.516 Vali Acc: 0.490 Test Loss: 1.516 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.947206497192383
Epoch: 17, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.340 Vali Acc: 0.500 Test Loss: 1.340 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.859626054763794
Epoch: 18, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.484 Vali Acc: 0.470 Test Loss: 1.484 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.7873213291168213
Epoch: 19, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.551 Vali Acc: 0.530 Test Loss: 1.551 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.9228458404541016
Epoch: 20, Steps: 20 | Train Loss: 0.096 Vali Loss: 1.401 Vali Acc: 0.550 Test Loss: 1.401 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.81298565864563
Epoch: 21, Steps: 20 | Train Loss: 0.062 Vali Loss: 1.494 Vali Acc: 0.520 Test Loss: 1.494 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 11037442
model size : 44.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 9.813190937042236
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 8.372268915176392
Epoch: 2, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
Validation loss decreased (-0.469992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 8.734981060028076
Epoch: 3, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.761 Vali Acc: 0.450 Test Loss: 0.761 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.63606071472168
Epoch: 4, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.721 Vali Acc: 0.470 Test Loss: 0.721 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.286038398742676
Epoch: 5, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.783 Vali Acc: 0.520 Test Loss: 0.783 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.09208607673645
Epoch: 6, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.787 Vali Acc: 0.510 Test Loss: 0.787 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.104381799697876
Epoch: 7, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.882 Vali Acc: 0.580 Test Loss: 0.882 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579991).  Saving model ...
Epoch: 8 cost time: 8.232777118682861
Epoch: 8, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.821 Vali Acc: 0.520 Test Loss: 0.821 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.04946756362915
Epoch: 9, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.870 Vali Acc: 0.580 Test Loss: 0.870 Test Acc: 0.580
Validation loss decreased (-0.579991 --> -0.579991).  Saving model ...
Epoch: 10 cost time: 8.079116106033325
Epoch: 10, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.834 Vali Acc: 0.520 Test Loss: 0.834 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.017130136489868
Epoch: 11, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.927 Vali Acc: 0.460 Test Loss: 0.927 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.06666111946106
Epoch: 12, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.897 Vali Acc: 0.510 Test Loss: 0.897 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.019707202911377
Epoch: 13, Steps: 20 | Train Loss: 0.395 Vali Loss: 0.955 Vali Acc: 0.550 Test Loss: 0.955 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.42964220046997
Epoch: 14, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.012 Vali Acc: 0.590 Test Loss: 1.012 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589990).  Saving model ...
Epoch: 15 cost time: 8.793224573135376
Epoch: 15, Steps: 20 | Train Loss: 0.368 Vali Loss: 0.920 Vali Acc: 0.560 Test Loss: 0.920 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.79367709159851
Epoch: 16, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.026 Vali Acc: 0.550 Test Loss: 1.026 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.972096681594849
Epoch: 17, Steps: 20 | Train Loss: 0.212 Vali Loss: 1.371 Vali Acc: 0.430 Test Loss: 1.371 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.879205703735352
Epoch: 18, Steps: 20 | Train Loss: 0.264 Vali Loss: 1.473 Vali Acc: 0.460 Test Loss: 1.473 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.905848979949951
Epoch: 19, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.663 Vali Acc: 0.480 Test Loss: 1.663 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.761611938476562
Epoch: 20, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.481 Vali Acc: 0.500 Test Loss: 1.481 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.850094556808472
Epoch: 21, Steps: 20 | Train Loss: 0.143 Vali Loss: 1.484 Vali Acc: 0.550 Test Loss: 1.484 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.721420288085938
Epoch: 22, Steps: 20 | Train Loss: 0.103 Vali Loss: 1.868 Vali Acc: 0.420 Test Loss: 1.868 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.775732517242432
Epoch: 23, Steps: 20 | Train Loss: 0.091 Vali Loss: 1.639 Vali Acc: 0.530 Test Loss: 1.639 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.699773073196411
Epoch: 24, Steps: 20 | Train Loss: 0.106 Vali Loss: 1.905 Vali Acc: 0.470 Test Loss: 1.905 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 37515522
model size : 145.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.217369794845581
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 3.037325859069824
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.788 Vali Acc: 0.450 Test Loss: 0.788 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0268163681030273
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.689 Vali Acc: 0.520 Test Loss: 0.689 Test Acc: 0.520
Validation loss decreased (-0.459993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 3.066196918487549
Epoch: 4, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.723 Vali Acc: 0.490 Test Loss: 0.723 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.982592821121216
Epoch: 5, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.837 Vali Acc: 0.560 Test Loss: 0.837 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 3.036776304244995
Epoch: 6, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.961 Vali Acc: 0.460 Test Loss: 0.961 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.048586130142212
Epoch: 7, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0536434650421143
Epoch: 8, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.878 Vali Acc: 0.450 Test Loss: 0.878 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0288572311401367
Epoch: 9, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.853 Vali Acc: 0.510 Test Loss: 0.853 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0354509353637695
Epoch: 10, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.824 Vali Acc: 0.550 Test Loss: 0.824 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.9923620223999023
Epoch: 11, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.887 Vali Acc: 0.520 Test Loss: 0.887 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.002382516860962
Epoch: 12, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.840 Vali Acc: 0.520 Test Loss: 0.840 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.22770094871521
Epoch: 13, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.966 Vali Acc: 0.550 Test Loss: 0.966 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.875520944595337
Epoch: 14, Steps: 20 | Train Loss: 0.344 Vali Loss: 1.011 Vali Acc: 0.560 Test Loss: 1.011 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.866518020629883
Epoch: 15, Steps: 20 | Train Loss: 0.275 Vali Loss: 1.026 Vali Acc: 0.460 Test Loss: 1.026 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 11037442
model size : 44.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.890834808349609
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 4.534109830856323
Epoch: 2, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
Validation loss decreased (-0.469992 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 4.512796401977539
Epoch: 3, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.514230251312256
Epoch: 4, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.602848291397095
Epoch: 5, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.774 Vali Acc: 0.520 Test Loss: 0.774 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.618311643600464
Epoch: 6, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.773 Vali Acc: 0.510 Test Loss: 0.773 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.622978448867798
Epoch: 7, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.880 Vali Acc: 0.530 Test Loss: 0.880 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.417761564254761
Epoch: 8, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.809 Vali Acc: 0.520 Test Loss: 0.809 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.984017610549927
Epoch: 9, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.892 Vali Acc: 0.520 Test Loss: 0.892 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.971377611160278
Epoch: 10, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.836 Vali Acc: 0.520 Test Loss: 0.836 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.975966215133667
Epoch: 11, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.913 Vali Acc: 0.480 Test Loss: 0.913 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.055407762527466
Epoch: 12, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.859 Vali Acc: 0.500 Test Loss: 0.859 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 37515522
model size : 145.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2989208698272705
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.0412888526916504
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.789 Vali Acc: 0.470 Test Loss: 0.789 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 2.0793802738189697
Epoch: 3, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.697 Vali Acc: 0.520 Test Loss: 0.697 Test Acc: 0.520
Validation loss decreased (-0.469992 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 2.0902111530303955
Epoch: 4, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0743470191955566
Epoch: 5, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.866 Vali Acc: 0.540 Test Loss: 0.866 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539991).  Saving model ...
Epoch: 6 cost time: 2.041125535964966
Epoch: 6, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.872 Vali Acc: 0.480 Test Loss: 0.872 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0829215049743652
Epoch: 7, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0668487548828125
Epoch: 8, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.820 Vali Acc: 0.470 Test Loss: 0.820 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0452566146850586
Epoch: 9, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.064840078353882
Epoch: 10, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.771 Vali Acc: 0.550 Test Loss: 0.771 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 2.1329262256622314
Epoch: 11, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.859 Vali Acc: 0.510 Test Loss: 0.859 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0187301635742188
Epoch: 12, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.851 Vali Acc: 0.570 Test Loss: 0.851 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569991).  Saving model ...
Epoch: 13 cost time: 2.0572586059570312
Epoch: 13, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.903 Vali Acc: 0.550 Test Loss: 0.903 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.044785976409912
Epoch: 14, Steps: 20 | Train Loss: 0.383 Vali Loss: 0.848 Vali Acc: 0.580 Test Loss: 0.848 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579992).  Saving model ...
Epoch: 15 cost time: 2.0997939109802246
Epoch: 15, Steps: 20 | Train Loss: 0.305 Vali Loss: 0.905 Vali Acc: 0.520 Test Loss: 0.905 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0602149963378906
Epoch: 16, Steps: 20 | Train Loss: 0.315 Vali Loss: 1.110 Vali Acc: 0.490 Test Loss: 1.110 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0671160221099854
Epoch: 17, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.119 Vali Acc: 0.590 Test Loss: 1.119 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589989).  Saving model ...
Epoch: 18 cost time: 2.09721302986145
Epoch: 18, Steps: 20 | Train Loss: 0.303 Vali Loss: 0.978 Vali Acc: 0.520 Test Loss: 0.978 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0450100898742676
Epoch: 19, Steps: 20 | Train Loss: 0.196 Vali Loss: 1.155 Vali Acc: 0.520 Test Loss: 1.155 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0610408782958984
Epoch: 20, Steps: 20 | Train Loss: 0.158 Vali Loss: 1.336 Vali Acc: 0.530 Test Loss: 1.336 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0611977577209473
Epoch: 21, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0330300331115723
Epoch: 22, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.018 Vali Acc: 0.570 Test Loss: 1.018 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.0867457389831543
Epoch: 23, Steps: 20 | Train Loss: 0.109 Vali Loss: 1.316 Vali Acc: 0.490 Test Loss: 1.316 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.0367443561553955
Epoch: 24, Steps: 20 | Train Loss: 0.079 Vali Loss: 1.231 Vali Acc: 0.540 Test Loss: 1.231 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.083301067352295
Epoch: 25, Steps: 20 | Train Loss: 0.100 Vali Loss: 1.836 Vali Acc: 0.520 Test Loss: 1.836 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.133070230484009
Epoch: 26, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.432 Vali Acc: 0.530 Test Loss: 1.432 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.1110708713531494
Epoch: 27, Steps: 20 | Train Loss: 0.067 Vali Loss: 1.677 Vali Acc: 0.540 Test Loss: 1.677 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 11037442
model size : 44.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.065748929977417
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.726 Vali Acc: 0.440 Test Loss: 0.726 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 6.822880268096924
Epoch: 2, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.737 Vali Acc: 0.480 Test Loss: 0.737 Test Acc: 0.480
Validation loss decreased (-0.439993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 6.262688398361206
Epoch: 3, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.744 Vali Acc: 0.490 Test Loss: 0.744 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 6.2442028522491455
Epoch: 4, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 6.256748199462891
Epoch: 5, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.260932207107544
Epoch: 6, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.752 Vali Acc: 0.460 Test Loss: 0.752 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.236789703369141
Epoch: 7, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.844 Vali Acc: 0.540 Test Loss: 0.844 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 6.208651542663574
Epoch: 8, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539992).  Saving model ...
Epoch: 9 cost time: 6.110835552215576
Epoch: 9, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.809 Vali Acc: 0.580 Test Loss: 0.809 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579992).  Saving model ...
Epoch: 10 cost time: 6.158146858215332
Epoch: 10, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.915 Vali Acc: 0.490 Test Loss: 0.915 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.150511026382446
Epoch: 11, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.051 Vali Acc: 0.500 Test Loss: 1.051 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.6059300899505615
Epoch: 12, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.975 Vali Acc: 0.590 Test Loss: 0.975 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589990).  Saving model ...
Epoch: 13 cost time: 6.752972841262817
Epoch: 13, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.246 Vali Acc: 0.560 Test Loss: 1.246 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.747949600219727
Epoch: 14, Steps: 20 | Train Loss: 0.294 Vali Loss: 1.115 Vali Acc: 0.560 Test Loss: 1.115 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.698015213012695
Epoch: 15, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.065 Vali Acc: 0.590 Test Loss: 1.065 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.785836219787598
Epoch: 16, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.358 Vali Acc: 0.500 Test Loss: 1.358 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.795713186264038
Epoch: 17, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.282 Vali Acc: 0.490 Test Loss: 1.282 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.815561056137085
Epoch: 18, Steps: 20 | Train Loss: 0.188 Vali Loss: 1.491 Vali Acc: 0.480 Test Loss: 1.491 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.766486406326294
Epoch: 19, Steps: 20 | Train Loss: 0.210 Vali Loss: 1.458 Vali Acc: 0.530 Test Loss: 1.458 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.772557735443115
Epoch: 20, Steps: 20 | Train Loss: 0.186 Vali Loss: 1.598 Vali Acc: 0.510 Test Loss: 1.598 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.837534666061401
Epoch: 21, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.747 Vali Acc: 0.410 Test Loss: 1.747 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.532808780670166
Epoch: 22, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.764 Vali Acc: 0.430 Test Loss: 1.764 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 18770690
model size : 74.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8160274028778076
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.716 Vali Acc: 0.470 Test Loss: 0.716 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.5884041786193848
Epoch: 2, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.706 Vali Acc: 0.470 Test Loss: 0.706 Test Acc: 0.470
Validation loss decreased (-0.469993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 2.6387126445770264
Epoch: 3, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.834 Vali Acc: 0.520 Test Loss: 0.834 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 2.56298828125
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.744 Vali Acc: 0.460 Test Loss: 0.744 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7212417125701904
Epoch: 5, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 2.6208364963531494
Epoch: 6, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.798 Vali Acc: 0.490 Test Loss: 0.798 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6225407123565674
Epoch: 7, Steps: 20 | Train Loss: 0.530 Vali Loss: 1.068 Vali Acc: 0.490 Test Loss: 1.068 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5974080562591553
Epoch: 8, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.803 Vali Acc: 0.500 Test Loss: 0.803 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.570558547973633
Epoch: 9, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.892 Vali Acc: 0.510 Test Loss: 0.892 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.602813243865967
Epoch: 10, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.905 Vali Acc: 0.510 Test Loss: 0.905 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5950210094451904
Epoch: 11, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.151 Vali Acc: 0.480 Test Loss: 1.151 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.6824615001678467
Epoch: 12, Steps: 20 | Train Loss: 0.327 Vali Loss: 0.964 Vali Acc: 0.540 Test Loss: 0.964 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539990).  Saving model ...
Epoch: 13 cost time: 2.630533456802368
Epoch: 13, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.062 Vali Acc: 0.530 Test Loss: 1.062 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6741344928741455
Epoch: 14, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.231 Vali Acc: 0.490 Test Loss: 1.231 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5623583793640137
Epoch: 15, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.195 Vali Acc: 0.490 Test Loss: 1.195 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7060444355010986
Epoch: 16, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.248 Vali Acc: 0.530 Test Loss: 1.248 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5870556831359863
Epoch: 17, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.512 Vali Acc: 0.520 Test Loss: 1.512 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.6457788944244385
Epoch: 18, Steps: 20 | Train Loss: 0.186 Vali Loss: 1.602 Vali Acc: 0.510 Test Loss: 1.602 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.642707347869873
Epoch: 19, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.460 Vali Acc: 0.530 Test Loss: 1.460 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9035518169403076
Epoch: 20, Steps: 20 | Train Loss: 0.159 Vali Loss: 1.380 Vali Acc: 0.500 Test Loss: 1.380 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.426300287246704
Epoch: 21, Steps: 20 | Train Loss: 0.160 Vali Loss: 1.575 Vali Acc: 0.510 Test Loss: 1.575 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4786956310272217
Epoch: 22, Steps: 20 | Train Loss: 0.204 Vali Loss: 1.522 Vali Acc: 0.470 Test Loss: 1.522 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 5531394
model size : 23.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.773326873779297
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.725 Vali Acc: 0.440 Test Loss: 0.725 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 4.173613786697388
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.736 Vali Acc: 0.470 Test Loss: 0.736 Test Acc: 0.470
Validation loss decreased (-0.439993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 4.522735118865967
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 4.552874565124512
Epoch: 4, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.716 Vali Acc: 0.560 Test Loss: 0.716 Test Acc: 0.560
Validation loss decreased (-0.489993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 4.553956031799316
Epoch: 5, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.716 Vali Acc: 0.520 Test Loss: 0.716 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.380690097808838
Epoch: 6, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.474293231964111
Epoch: 7, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.771 Vali Acc: 0.550 Test Loss: 0.771 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.147793292999268
Epoch: 8, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.831838846206665
Epoch: 9, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.721 Vali Acc: 0.610 Test Loss: 0.721 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609993).  Saving model ...
Epoch: 10 cost time: 4.9791505336761475
Epoch: 10, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.813 Vali Acc: 0.540 Test Loss: 0.813 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.840101003646851
Epoch: 11, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.834 Vali Acc: 0.560 Test Loss: 0.834 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.82225227355957
Epoch: 12, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.778 Vali Acc: 0.560 Test Loss: 0.778 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.907113552093506
Epoch: 13, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.050 Vali Acc: 0.540 Test Loss: 1.050 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.960647106170654
Epoch: 14, Steps: 20 | Train Loss: 0.364 Vali Loss: 0.867 Vali Acc: 0.550 Test Loss: 0.867 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.9268999099731445
Epoch: 15, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.069 Vali Acc: 0.560 Test Loss: 1.069 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.993982553482056
Epoch: 16, Steps: 20 | Train Loss: 0.309 Vali Loss: 1.183 Vali Acc: 0.510 Test Loss: 1.183 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.802796840667725
Epoch: 17, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.121 Vali Acc: 0.520 Test Loss: 1.121 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.887622594833374
Epoch: 18, Steps: 20 | Train Loss: 0.211 Vali Loss: 1.226 Vali Acc: 0.500 Test Loss: 1.226 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.819832801818848
Epoch: 19, Steps: 20 | Train Loss: 0.224 Vali Loss: 1.418 Vali Acc: 0.440 Test Loss: 1.418 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 18770690
model size : 74.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5539889335632324
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.716 Vali Acc: 0.460 Test Loss: 0.716 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.059354066848755
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.708 Vali Acc: 0.470 Test Loss: 0.708 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 2.248443603515625
Epoch: 3, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.817 Vali Acc: 0.520 Test Loss: 0.817 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 2.113509178161621
Epoch: 4, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.743 Vali Acc: 0.450 Test Loss: 0.743 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.067645311355591
Epoch: 5, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.694 Vali Acc: 0.510 Test Loss: 0.694 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.046706199645996
Epoch: 6, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0468428134918213
Epoch: 7, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.960 Vali Acc: 0.520 Test Loss: 0.960 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0230374336242676
Epoch: 8, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.726 Vali Acc: 0.560 Test Loss: 0.726 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 2.049365997314453
Epoch: 9, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1698503494262695
Epoch: 10, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.866 Vali Acc: 0.600 Test Loss: 0.866 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599991).  Saving model ...
Epoch: 11 cost time: 2.1115310192108154
Epoch: 11, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.995 Vali Acc: 0.510 Test Loss: 0.995 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.070072650909424
Epoch: 12, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.800 Vali Acc: 0.530 Test Loss: 0.800 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1216962337493896
Epoch: 13, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.841 Vali Acc: 0.580 Test Loss: 0.841 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.097776174545288
Epoch: 14, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.981 Vali Acc: 0.510 Test Loss: 0.981 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0515711307525635
Epoch: 15, Steps: 20 | Train Loss: 0.318 Vali Loss: 0.984 Vali Acc: 0.550 Test Loss: 0.984 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0510001182556152
Epoch: 16, Steps: 20 | Train Loss: 0.294 Vali Loss: 0.953 Vali Acc: 0.550 Test Loss: 0.953 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.042005777359009
Epoch: 17, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.048 Vali Acc: 0.510 Test Loss: 1.048 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0557668209075928
Epoch: 18, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.121 Vali Acc: 0.510 Test Loss: 1.121 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.0264229774475098
Epoch: 19, Steps: 20 | Train Loss: 0.218 Vali Loss: 1.133 Vali Acc: 0.480 Test Loss: 1.133 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0984177589416504
Epoch: 20, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.286 Vali Acc: 0.540 Test Loss: 1.286 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5531394
model size : 23.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6668248176574707
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.724 Vali Acc: 0.440 Test Loss: 0.724 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.882275342941284
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.736 Vali Acc: 0.460 Test Loss: 0.736 Test Acc: 0.460
Validation loss decreased (-0.439993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 2.832037925720215
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.733 Vali Acc: 0.480 Test Loss: 0.733 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 2.8822383880615234
Epoch: 4, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 2.873992919921875
Epoch: 5, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.710 Vali Acc: 0.550 Test Loss: 0.710 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 2.8407623767852783
Epoch: 6, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8011562824249268
Epoch: 7, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.784 Vali Acc: 0.560 Test Loss: 0.784 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 2.3968160152435303
Epoch: 8, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.748 Vali Acc: 0.550 Test Loss: 0.748 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8868894577026367
Epoch: 9, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.724 Vali Acc: 0.620 Test Loss: 0.724 Test Acc: 0.620
Validation loss decreased (-0.559992 --> -0.619993).  Saving model ...
Epoch: 10 cost time: 2.7886362075805664
Epoch: 10, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.794 Vali Acc: 0.490 Test Loss: 0.794 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.779890298843384
Epoch: 11, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.740 Vali Acc: 0.520 Test Loss: 0.740 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8038651943206787
Epoch: 12, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.814 Vali Acc: 0.610 Test Loss: 0.814 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.848020315170288
Epoch: 13, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.065 Vali Acc: 0.510 Test Loss: 1.065 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.825561046600342
Epoch: 14, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.794 Vali Acc: 0.520 Test Loss: 0.794 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.797462224960327
Epoch: 15, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8634395599365234
Epoch: 16, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.200 Vali Acc: 0.520 Test Loss: 1.200 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.0374481678009033
Epoch: 17, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.031 Vali Acc: 0.500 Test Loss: 1.031 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.115626335144043
Epoch: 18, Steps: 20 | Train Loss: 0.237 Vali Loss: 1.218 Vali Acc: 0.490 Test Loss: 1.218 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.1225647926330566
Epoch: 19, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.267 Vali Acc: 0.490 Test Loss: 1.267 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 18770690
model size : 74.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.755523204803467
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.716 Vali Acc: 0.460 Test Loss: 0.716 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.5541605949401855
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.706 Vali Acc: 0.470 Test Loss: 0.706 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 1.5875253677368164
Epoch: 3, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.819 Vali Acc: 0.520 Test Loss: 0.819 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 1.551604986190796
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.745 Vali Acc: 0.450 Test Loss: 0.745 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5175487995147705
Epoch: 5, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.510190725326538
Epoch: 6, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.746 Vali Acc: 0.530 Test Loss: 0.746 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 1.5559191703796387
Epoch: 7, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.954 Vali Acc: 0.520 Test Loss: 0.954 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5505218505859375
Epoch: 8, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.5099997520446777
Epoch: 9, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.785 Vali Acc: 0.550 Test Loss: 0.785 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 1.5531463623046875
Epoch: 10, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.747 Vali Acc: 0.620 Test Loss: 0.747 Test Acc: 0.620
Validation loss decreased (-0.549992 --> -0.619993).  Saving model ...
Epoch: 11 cost time: 1.5847158432006836
Epoch: 11, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.903 Vali Acc: 0.550 Test Loss: 0.903 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5638906955718994
Epoch: 12, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.767 Vali Acc: 0.570 Test Loss: 0.767 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5418157577514648
Epoch: 13, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.822 Vali Acc: 0.560 Test Loss: 0.822 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5099787712097168
Epoch: 14, Steps: 20 | Train Loss: 0.388 Vali Loss: 1.007 Vali Acc: 0.490 Test Loss: 1.007 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.556344747543335
Epoch: 15, Steps: 20 | Train Loss: 0.349 Vali Loss: 0.897 Vali Acc: 0.520 Test Loss: 0.897 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4992201328277588
Epoch: 16, Steps: 20 | Train Loss: 0.304 Vali Loss: 0.902 Vali Acc: 0.540 Test Loss: 0.902 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5362346172332764
Epoch: 17, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.019 Vali Acc: 0.530 Test Loss: 1.019 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5985186100006104
Epoch: 18, Steps: 20 | Train Loss: 0.277 Vali Loss: 1.130 Vali Acc: 0.490 Test Loss: 1.130 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5002026557922363
Epoch: 19, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.055 Vali Acc: 0.530 Test Loss: 1.055 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5547702312469482
Epoch: 20, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.194 Vali Acc: 0.610 Test Loss: 1.194 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 5531394
model size : 23.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 9.089105606079102
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 7.714855432510376
Epoch: 2, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.714 Vali Acc: 0.490 Test Loss: 0.714 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.54802131652832
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.724 Vali Acc: 0.530 Test Loss: 0.724 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 7.625330686569214
Epoch: 4, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.703 Vali Acc: 0.530 Test Loss: 0.703 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 7.713081359863281
Epoch: 5, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.763 Vali Acc: 0.530 Test Loss: 0.763 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.708326816558838
Epoch: 6, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.798 Vali Acc: 0.470 Test Loss: 0.798 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.696772575378418
Epoch: 7, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.819 Vali Acc: 0.470 Test Loss: 0.819 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.012568950653076
Epoch: 8, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.793 Vali Acc: 0.500 Test Loss: 0.793 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.199358701705933
Epoch: 9, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.888 Vali Acc: 0.460 Test Loss: 0.888 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.196034908294678
Epoch: 10, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.848 Vali Acc: 0.570 Test Loss: 0.848 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569992).  Saving model ...
Epoch: 11 cost time: 7.266833305358887
Epoch: 11, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.798 Vali Acc: 0.550 Test Loss: 0.798 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.190288782119751
Epoch: 12, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.011 Vali Acc: 0.490 Test Loss: 1.011 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.102222919464111
Epoch: 13, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.966 Vali Acc: 0.540 Test Loss: 0.966 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.085521936416626
Epoch: 14, Steps: 20 | Train Loss: 0.323 Vali Loss: 0.983 Vali Acc: 0.530 Test Loss: 0.983 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.059746026992798
Epoch: 15, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.164 Vali Acc: 0.520 Test Loss: 1.164 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.149465322494507
Epoch: 16, Steps: 20 | Train Loss: 0.273 Vali Loss: 0.995 Vali Acc: 0.560 Test Loss: 0.995 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.663008213043213
Epoch: 17, Steps: 20 | Train Loss: 0.235 Vali Loss: 1.020 Vali Acc: 0.560 Test Loss: 1.020 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.784209966659546
Epoch: 18, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.281 Vali Acc: 0.510 Test Loss: 1.281 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.822921276092529
Epoch: 19, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.329 Vali Acc: 0.430 Test Loss: 1.329 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.870283365249634
Epoch: 20, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.212 Vali Acc: 0.510 Test Loss: 1.212 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 18759298
model size : 72.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.536746501922607
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.0805442333221436
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.731 Vali Acc: 0.460 Test Loss: 0.731 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0063958168029785
Epoch: 3, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.974740743637085
Epoch: 4, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.92848539352417
Epoch: 5, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.711 Vali Acc: 0.480 Test Loss: 0.711 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.939667224884033
Epoch: 6, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.715 Vali Acc: 0.540 Test Loss: 0.715 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 2.9397213459014893
Epoch: 7, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.791 Vali Acc: 0.490 Test Loss: 0.791 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8944969177246094
Epoch: 8, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.858 Vali Acc: 0.560 Test Loss: 0.858 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559991).  Saving model ...
Epoch: 9 cost time: 2.8888559341430664
Epoch: 9, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.771 Vali Acc: 0.520 Test Loss: 0.771 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9829790592193604
Epoch: 10, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.849 Vali Acc: 0.530 Test Loss: 0.849 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8313727378845215
Epoch: 11, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.822 Vali Acc: 0.480 Test Loss: 0.822 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8802132606506348
Epoch: 12, Steps: 20 | Train Loss: 0.397 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8560118675231934
Epoch: 13, Steps: 20 | Train Loss: 0.370 Vali Loss: 0.976 Vali Acc: 0.510 Test Loss: 0.976 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.8562159538269043
Epoch: 14, Steps: 20 | Train Loss: 0.347 Vali Loss: 1.056 Vali Acc: 0.520 Test Loss: 1.056 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.8650503158569336
Epoch: 15, Steps: 20 | Train Loss: 0.329 Vali Loss: 0.992 Vali Acc: 0.550 Test Loss: 0.992 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.851712942123413
Epoch: 16, Steps: 20 | Train Loss: 0.284 Vali Loss: 1.229 Vali Acc: 0.570 Test Loss: 1.229 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569988).  Saving model ...
Epoch: 17 cost time: 2.9029252529144287
Epoch: 17, Steps: 20 | Train Loss: 0.304 Vali Loss: 1.084 Vali Acc: 0.480 Test Loss: 1.084 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9644174575805664
Epoch: 18, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.284 Vali Acc: 0.470 Test Loss: 1.284 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.917633295059204
Epoch: 19, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.295 Vali Acc: 0.520 Test Loss: 1.295 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8758673667907715
Epoch: 20, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.467 Vali Acc: 0.520 Test Loss: 1.467 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.95710825920105
Epoch: 21, Steps: 20 | Train Loss: 0.124 Vali Loss: 1.336 Vali Acc: 0.460 Test Loss: 1.336 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.897793769836426
Epoch: 22, Steps: 20 | Train Loss: 0.109 Vali Loss: 1.610 Vali Acc: 0.520 Test Loss: 1.610 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.8954455852508545
Epoch: 23, Steps: 20 | Train Loss: 0.100 Vali Loss: 1.589 Vali Acc: 0.510 Test Loss: 1.589 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.890228033065796
Epoch: 24, Steps: 20 | Train Loss: 0.075 Vali Loss: 1.722 Vali Acc: 0.490 Test Loss: 1.722 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.048788070678711
Epoch: 25, Steps: 20 | Train Loss: 0.100 Vali Loss: 1.699 Vali Acc: 0.500 Test Loss: 1.699 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.928504467010498
Epoch: 26, Steps: 20 | Train Loss: 0.054 Vali Loss: 1.809 Vali Acc: 0.480 Test Loss: 1.809 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5519746
model size : 22.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.5634377002716064
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 5.243723154067993
Epoch: 2, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.719 Vali Acc: 0.480 Test Loss: 0.719 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.217858076095581
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 5.188143968582153
Epoch: 4, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.698 Vali Acc: 0.550 Test Loss: 0.698 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 5.167066335678101
Epoch: 5, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.752 Vali Acc: 0.550 Test Loss: 0.752 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.4564549922943115
Epoch: 6, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.784 Vali Acc: 0.560 Test Loss: 0.784 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 7 cost time: 5.063561677932739
Epoch: 7, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.727 Vali Acc: 0.550 Test Loss: 0.727 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.118014812469482
Epoch: 8, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.055735111236572
Epoch: 9, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.835 Vali Acc: 0.450 Test Loss: 0.835 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.012495756149292
Epoch: 10, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.802 Vali Acc: 0.550 Test Loss: 0.802 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.182817220687866
Epoch: 11, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.815 Vali Acc: 0.520 Test Loss: 0.815 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.534430503845215
Epoch: 12, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.877 Vali Acc: 0.550 Test Loss: 0.877 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.583709478378296
Epoch: 13, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.812 Vali Acc: 0.560 Test Loss: 0.812 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.547195672988892
Epoch: 14, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.843 Vali Acc: 0.570 Test Loss: 0.843 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 15 cost time: 5.540863513946533
Epoch: 15, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.174 Vali Acc: 0.520 Test Loss: 1.174 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.537077188491821
Epoch: 16, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.852 Vali Acc: 0.540 Test Loss: 0.852 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.545133590698242
Epoch: 17, Steps: 20 | Train Loss: 0.347 Vali Loss: 0.997 Vali Acc: 0.540 Test Loss: 0.997 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.607630491256714
Epoch: 18, Steps: 20 | Train Loss: 0.294 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.680263519287109
Epoch: 19, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.105 Vali Acc: 0.500 Test Loss: 1.105 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.60747218132019
Epoch: 20, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.163 Vali Acc: 0.440 Test Loss: 1.163 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.699788808822632
Epoch: 21, Steps: 20 | Train Loss: 0.234 Vali Loss: 1.088 Vali Acc: 0.480 Test Loss: 1.088 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.5341150760650635
Epoch: 22, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.643702507019043
Epoch: 23, Steps: 20 | Train Loss: 0.202 Vali Loss: 1.140 Vali Acc: 0.560 Test Loss: 1.140 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.623683929443359
Epoch: 24, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.149 Vali Acc: 0.490 Test Loss: 1.149 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 18759298
model size : 72.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4393303394317627
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.178701877593994
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1925363540649414
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.205515146255493
Epoch: 4, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2142906188964844
Epoch: 5, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2500104904174805
Epoch: 6, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.712 Vali Acc: 0.530 Test Loss: 0.712 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 2.207984685897827
Epoch: 7, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.21280837059021
Epoch: 8, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.766 Vali Acc: 0.600 Test Loss: 0.766 Test Acc: 0.600
Validation loss decreased (-0.529993 --> -0.599992).  Saving model ...
Epoch: 9 cost time: 2.208491802215576
Epoch: 9, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.726 Vali Acc: 0.550 Test Loss: 0.726 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.216792106628418
Epoch: 10, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.721 Vali Acc: 0.580 Test Loss: 0.721 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1993155479431152
Epoch: 11, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.806 Vali Acc: 0.520 Test Loss: 0.806 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.262906312942505
Epoch: 12, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.885 Vali Acc: 0.560 Test Loss: 0.885 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.174556255340576
Epoch: 13, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.819 Vali Acc: 0.550 Test Loss: 0.819 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2709968090057373
Epoch: 14, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.919 Vali Acc: 0.570 Test Loss: 0.919 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2261264324188232
Epoch: 15, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.809 Vali Acc: 0.590 Test Loss: 0.809 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.2194697856903076
Epoch: 16, Steps: 20 | Train Loss: 0.398 Vali Loss: 1.092 Vali Acc: 0.480 Test Loss: 1.092 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1933586597442627
Epoch: 17, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.886 Vali Acc: 0.520 Test Loss: 0.886 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.185554265975952
Epoch: 18, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.069 Vali Acc: 0.510 Test Loss: 1.069 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5519746
model size : 22.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.617358446121216
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.995180368423462
Epoch: 2, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.997602701187134
Epoch: 3, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 3.018695116043091
Epoch: 4, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.690 Vali Acc: 0.570 Test Loss: 0.690 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 3.02036452293396
Epoch: 5, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.754 Vali Acc: 0.540 Test Loss: 0.754 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9725213050842285
Epoch: 6, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.702 Vali Acc: 0.580 Test Loss: 0.702 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 7 cost time: 3.0436995029449463
Epoch: 7, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.713 Vali Acc: 0.560 Test Loss: 0.713 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.890097141265869
Epoch: 8, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.697 Vali Acc: 0.590 Test Loss: 0.697 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 9 cost time: 2.9655561447143555
Epoch: 9, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.762 Vali Acc: 0.440 Test Loss: 0.762 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9572174549102783
Epoch: 10, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.735 Vali Acc: 0.600 Test Loss: 0.735 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599993).  Saving model ...
Epoch: 11 cost time: 3.0485382080078125
Epoch: 11, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9342100620269775
Epoch: 12, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.832 Vali Acc: 0.500 Test Loss: 0.832 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0521719455718994
Epoch: 13, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.808 Vali Acc: 0.520 Test Loss: 0.808 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.15047287940979
Epoch: 14, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.763 Vali Acc: 0.620 Test Loss: 0.763 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619992).  Saving model ...
Epoch: 15 cost time: 3.213958263397217
Epoch: 15, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.032 Vali Acc: 0.530 Test Loss: 1.032 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3139445781707764
Epoch: 16, Steps: 20 | Train Loss: 0.421 Vali Loss: 0.756 Vali Acc: 0.570 Test Loss: 0.756 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.161539316177368
Epoch: 17, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.958 Vali Acc: 0.500 Test Loss: 0.958 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.226134777069092
Epoch: 18, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.958 Vali Acc: 0.570 Test Loss: 0.958 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.231050968170166
Epoch: 19, Steps: 20 | Train Loss: 0.311 Vali Loss: 1.044 Vali Acc: 0.560 Test Loss: 1.044 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.2224082946777344
Epoch: 20, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.070 Vali Acc: 0.460 Test Loss: 1.070 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1876823902130127
Epoch: 21, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.015 Vali Acc: 0.530 Test Loss: 1.015 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.2069272994995117
Epoch: 22, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.147 Vali Acc: 0.490 Test Loss: 1.147 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.227154493331909
Epoch: 23, Steps: 20 | Train Loss: 0.211 Vali Loss: 1.130 Vali Acc: 0.530 Test Loss: 1.130 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.214334487915039
Epoch: 24, Steps: 20 | Train Loss: 0.169 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 18759298
model size : 72.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8709216117858887
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.6586132049560547
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.731 Vali Acc: 0.490 Test Loss: 0.731 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6599955558776855
Epoch: 3, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.708 Vali Acc: 0.520 Test Loss: 0.708 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.6280097961425781
Epoch: 4, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.677535057067871
Epoch: 5, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.701 Vali Acc: 0.490 Test Loss: 0.701 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6607749462127686
Epoch: 6, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.708 Vali Acc: 0.540 Test Loss: 0.708 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 1.633763074874878
Epoch: 7, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.737 Vali Acc: 0.590 Test Loss: 0.737 Test Acc: 0.590
Validation loss decreased (-0.539993 --> -0.589993).  Saving model ...
Epoch: 8 cost time: 1.6386456489562988
Epoch: 8, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.768 Vali Acc: 0.600 Test Loss: 0.768 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 9 cost time: 1.6815335750579834
Epoch: 9, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.711 Vali Acc: 0.520 Test Loss: 0.711 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6160709857940674
Epoch: 10, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.754 Vali Acc: 0.590 Test Loss: 0.754 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6336627006530762
Epoch: 11, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.798 Vali Acc: 0.530 Test Loss: 0.798 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7029986381530762
Epoch: 12, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.863 Vali Acc: 0.560 Test Loss: 0.863 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.634251594543457
Epoch: 13, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.828 Vali Acc: 0.560 Test Loss: 0.828 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6800992488861084
Epoch: 14, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.866 Vali Acc: 0.590 Test Loss: 0.866 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6487782001495361
Epoch: 15, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.897 Vali Acc: 0.480 Test Loss: 0.897 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6071412563323975
Epoch: 16, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.015 Vali Acc: 0.500 Test Loss: 1.015 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6165802478790283
Epoch: 17, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.868 Vali Acc: 0.520 Test Loss: 0.868 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6671032905578613
Epoch: 18, Steps: 20 | Train Loss: 0.340 Vali Loss: 0.950 Vali Acc: 0.530 Test Loss: 0.950 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5519746
model size : 22.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.843433141708374
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.720 Vali Acc: 0.450 Test Loss: 0.720 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 4.580733060836792
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.721 Vali Acc: 0.420 Test Loss: 0.721 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.524399757385254
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
Validation loss decreased (-0.449993 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 4.58666729927063
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.764 Vali Acc: 0.510 Test Loss: 0.764 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 4.519400119781494
Epoch: 5, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.771 Vali Acc: 0.460 Test Loss: 0.771 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.518560409545898
Epoch: 6, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.789 Vali Acc: 0.470 Test Loss: 0.789 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.2142839431762695
Epoch: 7, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.836 Vali Acc: 0.450 Test Loss: 0.836 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.255096435546875
Epoch: 8, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.787 Vali Acc: 0.490 Test Loss: 0.787 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.261420965194702
Epoch: 9, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.860 Vali Acc: 0.480 Test Loss: 0.860 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.209859132766724
Epoch: 10, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.802 Vali Acc: 0.510 Test Loss: 0.802 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.26460075378418
Epoch: 11, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.874 Vali Acc: 0.520 Test Loss: 0.874 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519991).  Saving model ...
Epoch: 12 cost time: 4.1877195835113525
Epoch: 12, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.995 Vali Acc: 0.500 Test Loss: 0.995 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4562454223632812
Epoch: 13, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.104 Vali Acc: 0.510 Test Loss: 1.104 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.194965839385986
Epoch: 14, Steps: 20 | Train Loss: 0.378 Vali Loss: 0.909 Vali Acc: 0.560 Test Loss: 0.909 Test Acc: 0.560
Validation loss decreased (-0.519991 --> -0.559991).  Saving model ...
Epoch: 15 cost time: 4.217225551605225
Epoch: 15, Steps: 20 | Train Loss: 0.378 Vali Loss: 1.218 Vali Acc: 0.480 Test Loss: 1.218 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.186286926269531
Epoch: 16, Steps: 20 | Train Loss: 0.314 Vali Loss: 1.180 Vali Acc: 0.480 Test Loss: 1.180 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.157325983047485
Epoch: 17, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.246 Vali Acc: 0.540 Test Loss: 1.246 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.1826066970825195
Epoch: 18, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.203761100769043
Epoch: 19, Steps: 20 | Train Loss: 0.210 Vali Loss: 1.263 Vali Acc: 0.500 Test Loss: 1.263 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.468371152877808
Epoch: 20, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.782 Vali Acc: 0.450 Test Loss: 1.782 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.378918170928955
Epoch: 21, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.458 Vali Acc: 0.470 Test Loss: 1.458 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.506340742111206
Epoch: 22, Steps: 20 | Train Loss: 0.140 Vali Loss: 1.573 Vali Acc: 0.490 Test Loss: 1.573 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.4806060791015625
Epoch: 23, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.618 Vali Acc: 0.490 Test Loss: 1.618 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.34009861946106
Epoch: 24, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.579 Vali Acc: 0.460 Test Loss: 1.579 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9386114
model size : 37.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.932598114013672
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.684 Vali Acc: 0.520 Test Loss: 0.684 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.1437737941741943
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.700 Vali Acc: 0.450 Test Loss: 0.700 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0581846237182617
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.760 Vali Acc: 0.460 Test Loss: 0.760 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0568368434906006
Epoch: 4, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.729 Vali Acc: 0.460 Test Loss: 0.729 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0195467472076416
Epoch: 5, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.680 Vali Acc: 0.560 Test Loss: 0.680 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 2.093353271484375
Epoch: 6, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.061277389526367
Epoch: 7, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.754 Vali Acc: 0.450 Test Loss: 0.754 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.007319450378418
Epoch: 8, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.779 Vali Acc: 0.520 Test Loss: 0.779 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.024501323699951
Epoch: 9, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.744 Vali Acc: 0.610 Test Loss: 0.744 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609993).  Saving model ...
Epoch: 10 cost time: 2.140059471130371
Epoch: 10, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.786 Vali Acc: 0.590 Test Loss: 0.786 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.008554697036743
Epoch: 11, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.857 Vali Acc: 0.560 Test Loss: 0.857 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.011233329772949
Epoch: 12, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.897 Vali Acc: 0.500 Test Loss: 0.897 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0682308673858643
Epoch: 13, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.884 Vali Acc: 0.560 Test Loss: 0.884 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0499141216278076
Epoch: 14, Steps: 20 | Train Loss: 0.343 Vali Loss: 0.923 Vali Acc: 0.500 Test Loss: 0.923 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.056217908859253
Epoch: 15, Steps: 20 | Train Loss: 0.362 Vali Loss: 0.953 Vali Acc: 0.510 Test Loss: 0.953 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1142544746398926
Epoch: 16, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.145 Vali Acc: 0.530 Test Loss: 1.145 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.038329601287842
Epoch: 17, Steps: 20 | Train Loss: 0.273 Vali Loss: 1.057 Vali Acc: 0.530 Test Loss: 1.057 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0747714042663574
Epoch: 18, Steps: 20 | Train Loss: 0.228 Vali Loss: 1.035 Vali Acc: 0.520 Test Loss: 1.035 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0486559867858887
Epoch: 19, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.145 Vali Acc: 0.490 Test Loss: 1.145 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2766210
model size : 11.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.672926664352417
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.720 Vali Acc: 0.450 Test Loss: 0.720 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 3.3879339694976807
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.721 Vali Acc: 0.450 Test Loss: 0.721 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.268970489501953
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 3.3470118045806885
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2604012489318848
Epoch: 5, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.748 Vali Acc: 0.490 Test Loss: 0.748 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.263023853302002
Epoch: 6, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.292104959487915
Epoch: 7, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.782 Vali Acc: 0.460 Test Loss: 0.782 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2660629749298096
Epoch: 8, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.750 Vali Acc: 0.550 Test Loss: 0.750 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 3.0834717750549316
Epoch: 9, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.803 Vali Acc: 0.510 Test Loss: 0.803 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0534934997558594
Epoch: 10, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.736 Vali Acc: 0.600 Test Loss: 0.736 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 11 cost time: 3.001319169998169
Epoch: 11, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.734 Vali Acc: 0.580 Test Loss: 0.734 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.106674909591675
Epoch: 12, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.791 Vali Acc: 0.540 Test Loss: 0.791 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.070620059967041
Epoch: 13, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0597896575927734
Epoch: 14, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.777 Vali Acc: 0.600 Test Loss: 0.777 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0491833686828613
Epoch: 15, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.979 Vali Acc: 0.500 Test Loss: 0.979 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.088533401489258
Epoch: 16, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.903 Vali Acc: 0.510 Test Loss: 0.903 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.1572349071502686
Epoch: 17, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.981 Vali Acc: 0.550 Test Loss: 0.981 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.0570414066314697
Epoch: 18, Steps: 20 | Train Loss: 0.376 Vali Loss: 0.939 Vali Acc: 0.510 Test Loss: 0.939 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.180095911026001
Epoch: 19, Steps: 20 | Train Loss: 0.311 Vali Loss: 0.982 Vali Acc: 0.560 Test Loss: 0.982 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.0160176753997803
Epoch: 20, Steps: 20 | Train Loss: 0.274 Vali Loss: 1.274 Vali Acc: 0.480 Test Loss: 1.274 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 9386114
model size : 37.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.729480266571045
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.683 Vali Acc: 0.530 Test Loss: 0.683 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 0.8014469146728516
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.698 Vali Acc: 0.440 Test Loss: 0.698 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6081185340881348
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.756 Vali Acc: 0.460 Test Loss: 0.756 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.635910987854004
Epoch: 4, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.712 Vali Acc: 0.490 Test Loss: 0.712 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6284444332122803
Epoch: 5, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.675 Vali Acc: 0.580 Test Loss: 0.675 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 1.5860998630523682
Epoch: 6, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6198806762695312
Epoch: 7, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6374049186706543
Epoch: 8, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.720 Vali Acc: 0.520 Test Loss: 0.720 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6194405555725098
Epoch: 9, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.720 Vali Acc: 0.590 Test Loss: 0.720 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 10 cost time: 1.602518081665039
Epoch: 10, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.783 Vali Acc: 0.570 Test Loss: 0.783 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.627002239227295
Epoch: 11, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.825 Vali Acc: 0.580 Test Loss: 0.825 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.713775396347046
Epoch: 12, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.879 Vali Acc: 0.520 Test Loss: 0.879 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.640392541885376
Epoch: 13, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.864 Vali Acc: 0.530 Test Loss: 0.864 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.64272141456604
Epoch: 14, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.891 Vali Acc: 0.470 Test Loss: 0.891 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7239069938659668
Epoch: 15, Steps: 20 | Train Loss: 0.397 Vali Loss: 0.828 Vali Acc: 0.580 Test Loss: 0.828 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6833744049072266
Epoch: 16, Steps: 20 | Train Loss: 0.378 Vali Loss: 1.102 Vali Acc: 0.510 Test Loss: 1.102 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6074628829956055
Epoch: 17, Steps: 20 | Train Loss: 0.357 Vali Loss: 0.952 Vali Acc: 0.560 Test Loss: 0.952 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.757378339767456
Epoch: 18, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.071 Vali Acc: 0.480 Test Loss: 1.071 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6692802906036377
Epoch: 19, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.196 Vali Acc: 0.510 Test Loss: 1.196 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2766210
model size : 11.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4305741786956787
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.720 Vali Acc: 0.450 Test Loss: 0.720 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 2.0918047428131104
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.721 Vali Acc: 0.450 Test Loss: 0.721 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0462169647216797
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
Validation loss decreased (-0.449993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 2.120668411254883
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 2.1128110885620117
Epoch: 5, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 2.1244070529937744
Epoch: 6, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1863458156585693
Epoch: 7, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.781 Vali Acc: 0.470 Test Loss: 0.781 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.128249168395996
Epoch: 8, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.753 Vali Acc: 0.530 Test Loss: 0.753 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529992).  Saving model ...
Epoch: 9 cost time: 2.1563615798950195
Epoch: 9, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.789 Vali Acc: 0.520 Test Loss: 0.789 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.161539077758789
Epoch: 10, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.738 Vali Acc: 0.580 Test Loss: 0.738 Test Acc: 0.580
Validation loss decreased (-0.529992 --> -0.579993).  Saving model ...
Epoch: 11 cost time: 2.1851320266723633
Epoch: 11, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.737 Vali Acc: 0.600 Test Loss: 0.737 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599993).  Saving model ...
Epoch: 12 cost time: 2.1271777153015137
Epoch: 12, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.764 Vali Acc: 0.540 Test Loss: 0.764 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1344504356384277
Epoch: 13, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.853 Vali Acc: 0.470 Test Loss: 0.853 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1210198402404785
Epoch: 14, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.784 Vali Acc: 0.580 Test Loss: 0.784 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1302616596221924
Epoch: 15, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.930 Vali Acc: 0.500 Test Loss: 0.930 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.118636131286621
Epoch: 16, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.892 Vali Acc: 0.520 Test Loss: 0.892 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1055197715759277
Epoch: 17, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.899 Vali Acc: 0.520 Test Loss: 0.899 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.13946533203125
Epoch: 18, Steps: 20 | Train Loss: 0.397 Vali Loss: 0.900 Vali Acc: 0.560 Test Loss: 0.900 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1872780323028564
Epoch: 19, Steps: 20 | Train Loss: 0.333 Vali Loss: 0.968 Vali Acc: 0.520 Test Loss: 0.968 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1429247856140137
Epoch: 20, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1933562755584717
Epoch: 21, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.197 Vali Acc: 0.490 Test Loss: 1.197 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 9386114
model size : 37.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.571622133255005
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.683 Vali Acc: 0.520 Test Loss: 0.683 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.307983636856079
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.698 Vali Acc: 0.450 Test Loss: 0.698 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2202045917510986
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2354340553283691
Epoch: 4, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2292242050170898
Epoch: 5, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.673 Vali Acc: 0.590 Test Loss: 0.673 Test Acc: 0.590
Validation loss decreased (-0.519993 --> -0.589993).  Saving model ...
Epoch: 6 cost time: 1.2249987125396729
Epoch: 6, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.702 Vali Acc: 0.510 Test Loss: 0.702 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1445198059082031
Epoch: 7, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.111496925354004
Epoch: 8, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.692 Vali Acc: 0.560 Test Loss: 0.692 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.117776870727539
Epoch: 9, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.701 Vali Acc: 0.570 Test Loss: 0.701 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2242553234100342
Epoch: 10, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.746 Vali Acc: 0.550 Test Loss: 0.746 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1545929908752441
Epoch: 11, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.765 Vali Acc: 0.550 Test Loss: 0.765 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1062560081481934
Epoch: 12, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.765 Vali Acc: 0.560 Test Loss: 0.765 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.195282220840454
Epoch: 13, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.779 Vali Acc: 0.550 Test Loss: 0.779 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1345062255859375
Epoch: 14, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.783 Vali Acc: 0.550 Test Loss: 0.783 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.119755506515503
Epoch: 15, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.716 Vali Acc: 0.580 Test Loss: 0.716 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2766210
model size : 11.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.096983909606934
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.701 Vali Acc: 0.480 Test Loss: 0.701 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.907918930053711
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.702 Vali Acc: 0.510 Test Loss: 0.702 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.8919897079467773
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.718 Vali Acc: 0.450 Test Loss: 0.718 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9201455116271973
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.760 Vali Acc: 0.490 Test Loss: 0.760 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.898993730545044
Epoch: 5, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.734 Vali Acc: 0.570 Test Loss: 0.734 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 2.8897705078125
Epoch: 6, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.893174409866333
Epoch: 7, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.713 Vali Acc: 0.560 Test Loss: 0.713 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8908114433288574
Epoch: 8, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.822 Vali Acc: 0.520 Test Loss: 0.822 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0824997425079346
Epoch: 9, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.717 Vali Acc: 0.550 Test Loss: 0.717 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.126774787902832
Epoch: 10, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.777 Vali Acc: 0.490 Test Loss: 0.777 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0241973400115967
Epoch: 11, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.707 Vali Acc: 0.550 Test Loss: 0.707 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.1766719818115234
Epoch: 12, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.0718390941619873
Epoch: 13, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.762 Vali Acc: 0.570 Test Loss: 0.762 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.0762805938720703
Epoch: 14, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.995 Vali Acc: 0.520 Test Loss: 0.995 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.0605320930480957
Epoch: 15, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.939 Vali Acc: 0.520 Test Loss: 0.939 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 4699522
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.209291934967041
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.684 Vali Acc: 0.550 Test Loss: 0.684 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.7037043571472168
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.711 Vali Acc: 0.560 Test Loss: 0.711 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.6529324054718018
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6740906238555908
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6006383895874023
Epoch: 5, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.705 Vali Acc: 0.580 Test Loss: 0.705 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 1.6601836681365967
Epoch: 6, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.788 Vali Acc: 0.430 Test Loss: 0.788 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6164851188659668
Epoch: 7, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6799507141113281
Epoch: 8, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.750 Vali Acc: 0.510 Test Loss: 0.750 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.69854736328125
Epoch: 9, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.777 Vali Acc: 0.490 Test Loss: 0.777 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6144518852233887
Epoch: 10, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6795148849487305
Epoch: 11, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.603722095489502
Epoch: 12, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.799 Vali Acc: 0.550 Test Loss: 0.799 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7363579273223877
Epoch: 13, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7388322353363037
Epoch: 14, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.829 Vali Acc: 0.550 Test Loss: 0.829 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6857035160064697
Epoch: 15, Steps: 20 | Train Loss: 0.381 Vali Loss: 0.873 Vali Acc: 0.520 Test Loss: 0.873 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1389442
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.716179609298706
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.701 Vali Acc: 0.470 Test Loss: 0.701 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.4078104496002197
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.699 Vali Acc: 0.520 Test Loss: 0.699 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.343397378921509
Epoch: 3, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.711 Vali Acc: 0.490 Test Loss: 0.711 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3551127910614014
Epoch: 4, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3498165607452393
Epoch: 5, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.694 Vali Acc: 0.580 Test Loss: 0.694 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 2.342158555984497
Epoch: 6, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3527636528015137
Epoch: 7, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.707 Vali Acc: 0.560 Test Loss: 0.707 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3476431369781494
Epoch: 8, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.349794626235962
Epoch: 9, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3589212894439697
Epoch: 10, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3346455097198486
Epoch: 11, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.719 Vali Acc: 0.570 Test Loss: 0.719 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.382200002670288
Epoch: 12, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3663079738616943
Epoch: 13, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.757 Vali Acc: 0.580 Test Loss: 0.757 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2981090545654297
Epoch: 14, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.959 Vali Acc: 0.550 Test Loss: 0.959 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.3293168544769287
Epoch: 15, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.905 Vali Acc: 0.500 Test Loss: 0.905 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4699522
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.734649658203125
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.684 Vali Acc: 0.550 Test Loss: 0.684 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.346182107925415
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3743581771850586
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.721 Vali Acc: 0.470 Test Loss: 0.721 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3575239181518555
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.702 Vali Acc: 0.520 Test Loss: 0.702 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3635587692260742
Epoch: 5, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.704 Vali Acc: 0.570 Test Loss: 0.704 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 1.3320188522338867
Epoch: 6, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.773 Vali Acc: 0.440 Test Loss: 0.773 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.388512372970581
Epoch: 7, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.714 Vali Acc: 0.560 Test Loss: 0.714 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3029491901397705
Epoch: 8, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.734 Vali Acc: 0.550 Test Loss: 0.734 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3607368469238281
Epoch: 9, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.739 Vali Acc: 0.480 Test Loss: 0.739 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3180041313171387
Epoch: 10, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.690 Vali Acc: 0.550 Test Loss: 0.690 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3397071361541748
Epoch: 11, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.767 Vali Acc: 0.540 Test Loss: 0.767 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3471107482910156
Epoch: 12, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3318920135498047
Epoch: 13, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.752 Vali Acc: 0.530 Test Loss: 0.752 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3195559978485107
Epoch: 14, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.762 Vali Acc: 0.560 Test Loss: 0.762 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.281446933746338
Epoch: 15, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.819 Vali Acc: 0.550 Test Loss: 0.819 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1389442
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.840589761734009
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.701 Vali Acc: 0.470 Test Loss: 0.701 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.6214735507965088
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.699 Vali Acc: 0.520 Test Loss: 0.699 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.56834077835083
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5753819942474365
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.751 Vali Acc: 0.520 Test Loss: 0.751 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5861623287200928
Epoch: 5, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.691 Vali Acc: 0.570 Test Loss: 0.691 Test Acc: 0.570
Validation loss decreased (-0.519993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 1.6492893695831299
Epoch: 6, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6008079051971436
Epoch: 7, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.678 Vali Acc: 0.580 Test Loss: 0.678 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 8 cost time: 1.56392502784729
Epoch: 8, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.788 Vali Acc: 0.510 Test Loss: 0.788 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5752413272857666
Epoch: 9, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.689 Vali Acc: 0.590 Test Loss: 0.689 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 10 cost time: 1.5813186168670654
Epoch: 10, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.711 Vali Acc: 0.590 Test Loss: 0.711 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6030552387237549
Epoch: 11, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.669 Vali Acc: 0.620 Test Loss: 0.669 Test Acc: 0.620
Validation loss decreased (-0.589993 --> -0.619993).  Saving model ...
Epoch: 12 cost time: 1.6007614135742188
Epoch: 12, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.715 Vali Acc: 0.570 Test Loss: 0.715 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6165251731872559
Epoch: 13, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.686 Vali Acc: 0.600 Test Loss: 0.686 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6097495555877686
Epoch: 14, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.782 Vali Acc: 0.580 Test Loss: 0.782 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5793204307556152
Epoch: 15, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.854 Vali Acc: 0.520 Test Loss: 0.854 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5963640213012695
Epoch: 16, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.928 Vali Acc: 0.490 Test Loss: 0.928 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.658249855041504
Epoch: 17, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.59881591796875
Epoch: 18, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.831 Vali Acc: 0.550 Test Loss: 0.831 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5602235794067383
Epoch: 19, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.893 Vali Acc: 0.560 Test Loss: 0.893 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.650162696838379
Epoch: 20, Steps: 20 | Train Loss: 0.414 Vali Loss: 1.000 Vali Acc: 0.490 Test Loss: 1.000 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5797886848449707
Epoch: 21, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.859 Vali Acc: 0.580 Test Loss: 0.859 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 4699522
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.43717885017395
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.684 Vali Acc: 0.550 Test Loss: 0.684 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.1542246341705322
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1020009517669678
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.721 Vali Acc: 0.470 Test Loss: 0.721 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1146256923675537
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.702 Vali Acc: 0.520 Test Loss: 0.702 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1066339015960693
Epoch: 5, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.703 Vali Acc: 0.560 Test Loss: 0.703 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 1.106642246246338
Epoch: 6, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.771 Vali Acc: 0.440 Test Loss: 0.771 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1126008033752441
Epoch: 7, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.715 Vali Acc: 0.560 Test Loss: 0.715 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.111198902130127
Epoch: 8, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.737 Vali Acc: 0.540 Test Loss: 0.737 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1673805713653564
Epoch: 9, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.174126386642456
Epoch: 10, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.693 Vali Acc: 0.550 Test Loss: 0.693 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.134763240814209
Epoch: 11, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.760 Vali Acc: 0.540 Test Loss: 0.760 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.098280429840088
Epoch: 12, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.717 Vali Acc: 0.550 Test Loss: 0.717 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1771209239959717
Epoch: 13, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.733 Vali Acc: 0.560 Test Loss: 0.733 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1288604736328125
Epoch: 14, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0693237781524658
Epoch: 15, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.797 Vali Acc: 0.590 Test Loss: 0.797 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589992).  Saving model ...
Epoch: 16 cost time: 1.1179215908050537
Epoch: 16, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.753 Vali Acc: 0.560 Test Loss: 0.753 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1014809608459473
Epoch: 17, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.911 Vali Acc: 0.570 Test Loss: 0.911 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.113602876663208
Epoch: 18, Steps: 20 | Train Loss: 0.381 Vali Loss: 0.868 Vali Acc: 0.520 Test Loss: 0.868 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1082804203033447
Epoch: 19, Steps: 20 | Train Loss: 0.367 Vali Loss: 0.858 Vali Acc: 0.520 Test Loss: 0.858 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.086787223815918
Epoch: 20, Steps: 20 | Train Loss: 0.368 Vali Loss: 0.932 Vali Acc: 0.530 Test Loss: 0.932 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1606242656707764
Epoch: 21, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.925 Vali Acc: 0.480 Test Loss: 0.925 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1121551990509033
Epoch: 22, Steps: 20 | Train Loss: 0.304 Vali Loss: 0.922 Vali Acc: 0.510 Test Loss: 0.922 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.078052282333374
Epoch: 23, Steps: 20 | Train Loss: 0.264 Vali Loss: 0.936 Vali Acc: 0.540 Test Loss: 0.936 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.190913438796997
Epoch: 24, Steps: 20 | Train Loss: 0.253 Vali Loss: 0.942 Vali Acc: 0.490 Test Loss: 0.942 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1224727630615234
Epoch: 25, Steps: 20 | Train Loss: 0.246 Vali Loss: 0.961 Vali Acc: 0.490 Test Loss: 0.961 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1389442
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.549704313278198
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.680 Vali Acc: 0.530 Test Loss: 0.680 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.814802885055542
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.686 Vali Acc: 0.540 Test Loss: 0.686 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.902705669403076
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8698065280914307
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9125864505767822
Epoch: 5, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.728 Vali Acc: 0.460 Test Loss: 0.728 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.922652006149292
Epoch: 6, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.718 Vali Acc: 0.490 Test Loss: 0.718 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9345664978027344
Epoch: 7, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9358978271484375
Epoch: 8, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.942661762237549
Epoch: 9, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3221888542175293
Epoch: 10, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.897693395614624
Epoch: 11, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.9594779014587402
Epoch: 12, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.853 Vali Acc: 0.510 Test Loss: 0.853 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 4693826
model size : 18.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.974553346633911
Epoch: 1, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.718 Vali Acc: 0.440 Test Loss: 0.718 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.6241190433502197
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.709 Vali Acc: 0.460 Test Loss: 0.709 Test Acc: 0.460
Validation loss decreased (-0.439993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 1.2075634002685547
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.694 Vali Acc: 0.510 Test Loss: 0.694 Test Acc: 0.510
Validation loss decreased (-0.459993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.7447710037231445
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.708 Vali Acc: 0.470 Test Loss: 0.708 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6940677165985107
Epoch: 5, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.783715009689331
Epoch: 6, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.701 Vali Acc: 0.520 Test Loss: 0.701 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 1.7046887874603271
Epoch: 7, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6963591575622559
Epoch: 8, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.699 Vali Acc: 0.530 Test Loss: 0.699 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 1.7113006114959717
Epoch: 9, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6631379127502441
Epoch: 10, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.659393072128296
Epoch: 11, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.747 Vali Acc: 0.570 Test Loss: 0.747 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 1.6662523746490479
Epoch: 12, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.749 Vali Acc: 0.590 Test Loss: 0.749 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 13 cost time: 1.6973636150360107
Epoch: 13, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.762 Vali Acc: 0.530 Test Loss: 0.762 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.66867995262146
Epoch: 14, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.880 Vali Acc: 0.520 Test Loss: 0.880 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6999871730804443
Epoch: 15, Steps: 20 | Train Loss: 0.383 Vali Loss: 0.811 Vali Acc: 0.520 Test Loss: 0.811 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6906111240386963
Epoch: 16, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.821 Vali Acc: 0.540 Test Loss: 0.821 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6957342624664307
Epoch: 17, Steps: 20 | Train Loss: 0.357 Vali Loss: 0.813 Vali Acc: 0.560 Test Loss: 0.813 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7054855823516846
Epoch: 18, Steps: 20 | Train Loss: 0.323 Vali Loss: 0.896 Vali Acc: 0.520 Test Loss: 0.896 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7450900077819824
Epoch: 19, Steps: 20 | Train Loss: 0.292 Vali Loss: 0.919 Vali Acc: 0.580 Test Loss: 0.919 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7339794635772705
Epoch: 20, Steps: 20 | Train Loss: 0.295 Vali Loss: 0.952 Vali Acc: 0.570 Test Loss: 0.952 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.723703384399414
Epoch: 21, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.086 Vali Acc: 0.530 Test Loss: 1.086 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6887290477752686
Epoch: 22, Steps: 20 | Train Loss: 0.228 Vali Loss: 1.025 Vali Acc: 0.580 Test Loss: 1.025 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1383618
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6634292602539062
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.680 Vali Acc: 0.520 Test Loss: 0.680 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.3604965209960938
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.685 Vali Acc: 0.530 Test Loss: 0.685 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.359560489654541
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 2.3825924396514893
Epoch: 4, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4151883125305176
Epoch: 5, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.716 Vali Acc: 0.450 Test Loss: 0.716 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3152425289154053
Epoch: 6, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3442232608795166
Epoch: 7, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.704 Vali Acc: 0.490 Test Loss: 0.704 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3689773082733154
Epoch: 8, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.696 Vali Acc: 0.580 Test Loss: 0.696 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 9 cost time: 2.3521347045898438
Epoch: 9, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.701 Vali Acc: 0.590 Test Loss: 0.701 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 10 cost time: 2.333096981048584
Epoch: 10, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.377051830291748
Epoch: 11, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.675 Vali Acc: 0.620 Test Loss: 0.675 Test Acc: 0.620
Validation loss decreased (-0.589993 --> -0.619993).  Saving model ...
Epoch: 12 cost time: 2.404895782470703
Epoch: 12, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.747 Vali Acc: 0.530 Test Loss: 0.747 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4125218391418457
Epoch: 13, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.686 Vali Acc: 0.540 Test Loss: 0.686 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2892329692840576
Epoch: 14, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.683 Vali Acc: 0.600 Test Loss: 0.683 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.316953420639038
Epoch: 15, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.697 Vali Acc: 0.540 Test Loss: 0.697 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3236701488494873
Epoch: 16, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3468430042266846
Epoch: 17, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.761 Vali Acc: 0.570 Test Loss: 0.761 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.359715700149536
Epoch: 18, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.414083480834961
Epoch: 19, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.703 Vali Acc: 0.610 Test Loss: 0.703 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3901169300079346
Epoch: 20, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.810 Vali Acc: 0.560 Test Loss: 0.810 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.3284971714019775
Epoch: 21, Steps: 20 | Train Loss: 0.374 Vali Loss: 0.848 Vali Acc: 0.500 Test Loss: 0.848 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 4693826
model size : 18.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9788293838500977
Epoch: 1, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.718 Vali Acc: 0.440 Test Loss: 0.718 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.3829820156097412
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.710 Vali Acc: 0.460 Test Loss: 0.710 Test Acc: 0.460
Validation loss decreased (-0.439993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 1.3692033290863037
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
Validation loss decreased (-0.459993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.3791232109069824
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.42954421043396
Epoch: 5, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 1.4217205047607422
Epoch: 6, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.445746660232544
Epoch: 7, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.421785831451416
Epoch: 8, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.683 Vali Acc: 0.540 Test Loss: 0.683 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.4455280303955078
Epoch: 9, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.718 Vali Acc: 0.570 Test Loss: 0.718 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 10 cost time: 0.9330024719238281
Epoch: 10, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.675 Vali Acc: 0.540 Test Loss: 0.675 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3391938209533691
Epoch: 11, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.691 Vali Acc: 0.570 Test Loss: 0.691 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 1.4125666618347168
Epoch: 12, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.715 Vali Acc: 0.570 Test Loss: 0.715 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3189897537231445
Epoch: 13, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3446784019470215
Epoch: 14, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.772 Vali Acc: 0.560 Test Loss: 0.772 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3359925746917725
Epoch: 15, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.715 Vali Acc: 0.550 Test Loss: 0.715 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.345391035079956
Epoch: 16, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3747978210449219
Epoch: 17, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.715 Vali Acc: 0.540 Test Loss: 0.715 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4291033744812012
Epoch: 18, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.802 Vali Acc: 0.570 Test Loss: 0.802 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4043259620666504
Epoch: 19, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.746 Vali Acc: 0.570 Test Loss: 0.746 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3445053100585938
Epoch: 20, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.789 Vali Acc: 0.570 Test Loss: 0.789 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3603050708770752
Epoch: 21, Steps: 20 | Train Loss: 0.388 Vali Loss: 0.831 Vali Acc: 0.580 Test Loss: 0.831 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 22 cost time: 0.8335535526275635
Epoch: 22, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.894 Vali Acc: 0.510 Test Loss: 0.894 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3768284320831299
Epoch: 23, Steps: 20 | Train Loss: 0.338 Vali Loss: 0.785 Vali Acc: 0.550 Test Loss: 0.785 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.403611421585083
Epoch: 24, Steps: 20 | Train Loss: 0.327 Vali Loss: 0.784 Vali Acc: 0.610 Test Loss: 0.784 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609992).  Saving model ...
Epoch: 25 cost time: 1.402428150177002
Epoch: 25, Steps: 20 | Train Loss: 0.290 Vali Loss: 0.885 Vali Acc: 0.550 Test Loss: 0.885 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4430742263793945
Epoch: 26, Steps: 20 | Train Loss: 0.263 Vali Loss: 0.936 Vali Acc: 0.540 Test Loss: 0.936 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3956058025360107
Epoch: 27, Steps: 20 | Train Loss: 0.262 Vali Loss: 0.962 Vali Acc: 0.550 Test Loss: 0.962 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.421983242034912
Epoch: 28, Steps: 20 | Train Loss: 0.246 Vali Loss: 0.914 Vali Acc: 0.560 Test Loss: 0.914 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4748890399932861
Epoch: 29, Steps: 20 | Train Loss: 0.235 Vali Loss: 0.968 Vali Acc: 0.540 Test Loss: 0.968 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.433419942855835
Epoch: 30, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.054 Vali Acc: 0.520 Test Loss: 1.054 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1383618
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.3545868396759033
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.680 Vali Acc: 0.540 Test Loss: 0.680 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 0.95027756690979
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.686 Vali Acc: 0.540 Test Loss: 0.686 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9053332805633545
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.698 Vali Acc: 0.560 Test Loss: 0.698 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 0.9447412490844727
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.10494065284729
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.715 Vali Acc: 0.450 Test Loss: 0.715 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9104945659637451
Epoch: 6, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.700 Vali Acc: 0.520 Test Loss: 0.700 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9181981086730957
Epoch: 7, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.701 Vali Acc: 0.510 Test Loss: 0.701 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9199113845825195
Epoch: 8, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.692 Vali Acc: 0.530 Test Loss: 0.692 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9122803211212158
Epoch: 9, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.706 Vali Acc: 0.570 Test Loss: 0.706 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 10 cost time: 1.1762628555297852
Epoch: 10, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.691 Vali Acc: 0.500 Test Loss: 0.691 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4913709163665771
Epoch: 11, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.674 Vali Acc: 0.620 Test Loss: 0.674 Test Acc: 0.620
Validation loss decreased (-0.569993 --> -0.619993).  Saving model ...
Epoch: 12 cost time: 1.520374059677124
Epoch: 12, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.732 Vali Acc: 0.550 Test Loss: 0.732 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.542492151260376
Epoch: 13, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.672 Vali Acc: 0.530 Test Loss: 0.672 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.589796543121338
Epoch: 14, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.664 Vali Acc: 0.590 Test Loss: 0.664 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.536299228668213
Epoch: 15, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.663 Vali Acc: 0.560 Test Loss: 0.663 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.518401861190796
Epoch: 16, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.725 Vali Acc: 0.560 Test Loss: 0.725 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5197780132293701
Epoch: 17, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.700 Vali Acc: 0.610 Test Loss: 0.700 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.543874979019165
Epoch: 18, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5569548606872559
Epoch: 19, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.689 Vali Acc: 0.560 Test Loss: 0.689 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5721142292022705
Epoch: 20, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.741 Vali Acc: 0.570 Test Loss: 0.741 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.51945161819458
Epoch: 21, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.786 Vali Acc: 0.530 Test Loss: 0.786 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 4693826
model size : 18.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.691540241241455
Epoch: 1, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.718 Vali Acc: 0.440 Test Loss: 0.718 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 0.7461028099060059
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.710 Vali Acc: 0.460 Test Loss: 0.710 Test Acc: 0.460
Validation loss decreased (-0.439993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 1.0717191696166992
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
Validation loss decreased (-0.459993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.0025627613067627
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0759263038635254
Epoch: 5, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.701 Vali Acc: 0.520 Test Loss: 0.701 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 1.1381101608276367
Epoch: 6, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8155813217163086
Epoch: 7, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1391966342926025
Epoch: 8, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.685 Vali Acc: 0.540 Test Loss: 0.685 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.1587374210357666
Epoch: 9, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.715 Vali Acc: 0.560 Test Loss: 0.715 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 10 cost time: 1.1320879459381104
Epoch: 10, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.677 Vali Acc: 0.550 Test Loss: 0.677 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1076059341430664
Epoch: 11, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.684 Vali Acc: 0.600 Test Loss: 0.684 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 12 cost time: 1.2196922302246094
Epoch: 12, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.704 Vali Acc: 0.570 Test Loss: 0.704 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2388081550598145
Epoch: 13, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2631151676177979
Epoch: 14, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.771 Vali Acc: 0.570 Test Loss: 0.771 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2422685623168945
Epoch: 15, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.693 Vali Acc: 0.590 Test Loss: 0.693 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2597994804382324
Epoch: 16, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.702 Vali Acc: 0.560 Test Loss: 0.702 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2583153247833252
Epoch: 17, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.709 Vali Acc: 0.550 Test Loss: 0.709 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1297321319580078
Epoch: 18, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.734 Vali Acc: 0.570 Test Loss: 0.734 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1933720111846924
Epoch: 19, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.719 Vali Acc: 0.520 Test Loss: 0.719 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.183718204498291
Epoch: 20, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.747 Vali Acc: 0.570 Test Loss: 0.747 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2220191955566406
Epoch: 21, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.765 Vali Acc: 0.610 Test Loss: 0.765 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609992).  Saving model ...
Epoch: 22 cost time: 1.236631155014038
Epoch: 22, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.833 Vali Acc: 0.520 Test Loss: 0.833 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2314093112945557
Epoch: 23, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.761 Vali Acc: 0.610 Test Loss: 0.761 Test Acc: 0.610
Validation loss decreased (-0.609992 --> -0.609992).  Saving model ...
Epoch: 24 cost time: 1.259429693222046
Epoch: 24, Steps: 20 | Train Loss: 0.385 Vali Loss: 0.757 Vali Acc: 0.570 Test Loss: 0.757 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1600341796875
Epoch: 25, Steps: 20 | Train Loss: 0.336 Vali Loss: 0.777 Vali Acc: 0.580 Test Loss: 0.777 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1908104419708252
Epoch: 26, Steps: 20 | Train Loss: 0.324 Vali Loss: 0.825 Vali Acc: 0.540 Test Loss: 0.825 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.256566047668457
Epoch: 27, Steps: 20 | Train Loss: 0.315 Vali Loss: 0.856 Vali Acc: 0.540 Test Loss: 0.856 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2697508335113525
Epoch: 28, Steps: 20 | Train Loss: 0.295 Vali Loss: 0.909 Vali Acc: 0.560 Test Loss: 0.909 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.259326457977295
Epoch: 29, Steps: 20 | Train Loss: 0.262 Vali Loss: 0.919 Vali Acc: 0.620 Test Loss: 0.919 Test Acc: 0.620
Validation loss decreased (-0.609992 --> -0.619991).  Saving model ...
Epoch: 30 cost time: 1.2603018283843994
Epoch: 30, Steps: 20 | Train Loss: 0.254 Vali Loss: 0.993 Vali Acc: 0.540 Test Loss: 0.993 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1383618
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5223865509033203
Epoch: 1, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.0335347652435303
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.702 Vali Acc: 0.480 Test Loss: 0.702 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.424609661102295
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.720 Vali Acc: 0.480 Test Loss: 0.720 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2937049865722656
Epoch: 4, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.717 Vali Acc: 0.490 Test Loss: 0.717 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 2.3073015213012695
Epoch: 5, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2168374061584473
Epoch: 6, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.701 Vali Acc: 0.490 Test Loss: 0.701 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 7 cost time: 2.236565113067627
Epoch: 7, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.728 Vali Acc: 0.470 Test Loss: 0.728 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.354013442993164
Epoch: 8, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.708 Vali Acc: 0.460 Test Loss: 0.708 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3212387561798096
Epoch: 9, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.701 Vali Acc: 0.580 Test Loss: 0.701 Test Acc: 0.580
Validation loss decreased (-0.489993 --> -0.579993).  Saving model ...
Epoch: 10 cost time: 2.223001718521118
Epoch: 10, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.249180793762207
Epoch: 11, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.242253303527832
Epoch: 12, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.35062313079834
Epoch: 13, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.757 Vali Acc: 0.610 Test Loss: 0.757 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609992).  Saving model ...
Epoch: 14 cost time: 2.3039371967315674
Epoch: 14, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.767 Vali Acc: 0.570 Test Loss: 0.767 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.32572603225708
Epoch: 15, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4102396965026855
Epoch: 16, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.800 Vali Acc: 0.480 Test Loss: 0.800 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2879247665405273
Epoch: 17, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.857 Vali Acc: 0.510 Test Loss: 0.857 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.185009002685547
Epoch: 18, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.863 Vali Acc: 0.540 Test Loss: 0.863 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9400639533996582
Epoch: 19, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1295433044433594
Epoch: 20, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.823 Vali Acc: 0.600 Test Loss: 0.823 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6100635528564453
Epoch: 21, Steps: 20 | Train Loss: 0.370 Vali Loss: 0.865 Vali Acc: 0.560 Test Loss: 0.865 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0109965801239014
Epoch: 22, Steps: 20 | Train Loss: 0.325 Vali Loss: 0.893 Vali Acc: 0.540 Test Loss: 0.893 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.136601686477661
Epoch: 23, Steps: 20 | Train Loss: 0.315 Vali Loss: 0.921 Vali Acc: 0.560 Test Loss: 0.921 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2350146
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9035749435424805
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.678 Vali Acc: 0.650 Test Loss: 0.678 Test Acc: 0.650
Validation loss decreased (inf --> -0.649993).  Saving model ...
Epoch: 2 cost time: 1.4137935638427734
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.691 Vali Acc: 0.500 Test Loss: 0.691 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.531165361404419
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.676 Vali Acc: 0.530 Test Loss: 0.676 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5835678577423096
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.684 Vali Acc: 0.470 Test Loss: 0.684 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5402252674102783
Epoch: 5, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.689 Vali Acc: 0.520 Test Loss: 0.689 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4193575382232666
Epoch: 6, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.677 Vali Acc: 0.520 Test Loss: 0.677 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5688047409057617
Epoch: 7, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.713 Vali Acc: 0.490 Test Loss: 0.713 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5770046710968018
Epoch: 8, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.688 Vali Acc: 0.530 Test Loss: 0.688 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5658624172210693
Epoch: 9, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.697 Vali Acc: 0.520 Test Loss: 0.697 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.443645715713501
Epoch: 10, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.740 Vali Acc: 0.560 Test Loss: 0.740 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4000327587127686
Epoch: 11, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 694978
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1204631328582764
Epoch: 1, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.6076536178588867
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.703 Vali Acc: 0.480 Test Loss: 0.703 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3794372081756592
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7007787227630615
Epoch: 4, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 1.5853064060211182
Epoch: 5, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 6 cost time: 1.58241868019104
Epoch: 6, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.700 Vali Acc: 0.480 Test Loss: 0.700 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1112308502197266
Epoch: 7, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.729 Vali Acc: 0.470 Test Loss: 0.729 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8089931011199951
Epoch: 8, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7904267311096191
Epoch: 9, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.703 Vali Acc: 0.560 Test Loss: 0.703 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 10 cost time: 1.7461562156677246
Epoch: 10, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7760438919067383
Epoch: 11, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.706 Vali Acc: 0.570 Test Loss: 0.706 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 12 cost time: 1.8267650604248047
Epoch: 12, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7729721069335938
Epoch: 13, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.722 Vali Acc: 0.610 Test Loss: 0.722 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609993).  Saving model ...
Epoch: 14 cost time: 1.7990446090698242
Epoch: 14, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.737 Vali Acc: 0.570 Test Loss: 0.737 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8213257789611816
Epoch: 15, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.695 Vali Acc: 0.540 Test Loss: 0.695 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7662301063537598
Epoch: 16, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7913594245910645
Epoch: 17, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8426034450531006
Epoch: 18, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.810 Vali Acc: 0.580 Test Loss: 0.810 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.877997636795044
Epoch: 19, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.786 Vali Acc: 0.560 Test Loss: 0.786 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7753536701202393
Epoch: 20, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.865 Vali Acc: 0.560 Test Loss: 0.865 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.826408863067627
Epoch: 21, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.841 Vali Acc: 0.550 Test Loss: 0.841 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7729392051696777
Epoch: 22, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.775 Vali Acc: 0.550 Test Loss: 0.775 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.787667989730835
Epoch: 23, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.829 Vali Acc: 0.500 Test Loss: 0.829 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2350146
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.663670063018799
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.678 Vali Acc: 0.660 Test Loss: 0.678 Test Acc: 0.660
Validation loss decreased (inf --> -0.659993).  Saving model ...
Epoch: 2 cost time: 1.1324381828308105
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.691 Vali Acc: 0.500 Test Loss: 0.691 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2464053630828857
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.676 Vali Acc: 0.530 Test Loss: 0.676 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8563621044158936
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.684 Vali Acc: 0.480 Test Loss: 0.684 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2738263607025146
Epoch: 5, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.689 Vali Acc: 0.510 Test Loss: 0.689 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2693336009979248
Epoch: 6, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.679 Vali Acc: 0.510 Test Loss: 0.679 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2508118152618408
Epoch: 7, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.713 Vali Acc: 0.490 Test Loss: 0.713 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2708251476287842
Epoch: 8, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.688 Vali Acc: 0.530 Test Loss: 0.688 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2915618419647217
Epoch: 9, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.696 Vali Acc: 0.490 Test Loss: 0.696 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2272439002990723
Epoch: 10, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.727 Vali Acc: 0.550 Test Loss: 0.727 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1971447467803955
Epoch: 11, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 694978
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.6403050422668457
Epoch: 1, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.3270184993743896
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.703 Vali Acc: 0.480 Test Loss: 0.703 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.383781909942627
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.719 Vali Acc: 0.480 Test Loss: 0.719 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3624417781829834
Epoch: 4, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 1.3641510009765625
Epoch: 5, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.723 Vali Acc: 0.480 Test Loss: 0.723 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4236462116241455
Epoch: 6, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.699 Vali Acc: 0.480 Test Loss: 0.699 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.360442876815796
Epoch: 7, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0236718654632568
Epoch: 8, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 9 cost time: 1.1634235382080078
Epoch: 9, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 10 cost time: 1.193803310394287
Epoch: 10, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.711 Vali Acc: 0.520 Test Loss: 0.711 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2791540622711182
Epoch: 11, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.709 Vali Acc: 0.540 Test Loss: 0.709 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2237083911895752
Epoch: 12, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.720 Vali Acc: 0.480 Test Loss: 0.720 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2420146465301514
Epoch: 13, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.712 Vali Acc: 0.570 Test Loss: 0.712 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 14 cost time: 1.2673060894012451
Epoch: 14, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.726 Vali Acc: 0.550 Test Loss: 0.726 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2261145114898682
Epoch: 15, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.688 Vali Acc: 0.530 Test Loss: 0.688 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2552027702331543
Epoch: 16, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9960510730743408
Epoch: 17, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3239161968231201
Epoch: 18, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.793 Vali Acc: 0.580 Test Loss: 0.793 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 19 cost time: 1.354006290435791
Epoch: 19, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.772 Vali Acc: 0.560 Test Loss: 0.772 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3501536846160889
Epoch: 20, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.875 Vali Acc: 0.530 Test Loss: 0.875 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2966105937957764
Epoch: 21, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.804 Vali Acc: 0.540 Test Loss: 0.804 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3123977184295654
Epoch: 22, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.784 Vali Acc: 0.510 Test Loss: 0.784 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3509550094604492
Epoch: 23, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.809 Vali Acc: 0.500 Test Loss: 0.809 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2754895687103271
Epoch: 24, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.840 Vali Acc: 0.600 Test Loss: 0.840 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599992).  Saving model ...
Epoch: 25 cost time: 1.3915307521820068
Epoch: 25, Steps: 20 | Train Loss: 0.374 Vali Loss: 0.842 Vali Acc: 0.540 Test Loss: 0.842 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3702163696289062
Epoch: 26, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.886 Vali Acc: 0.560 Test Loss: 0.886 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3569467067718506
Epoch: 27, Steps: 20 | Train Loss: 0.347 Vali Loss: 0.918 Vali Acc: 0.510 Test Loss: 0.918 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3837635517120361
Epoch: 28, Steps: 20 | Train Loss: 0.303 Vali Loss: 0.934 Vali Acc: 0.520 Test Loss: 0.934 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3975112438201904
Epoch: 29, Steps: 20 | Train Loss: 0.286 Vali Loss: 0.977 Vali Acc: 0.540 Test Loss: 0.977 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3303320407867432
Epoch: 30, Steps: 20 | Train Loss: 0.253 Vali Loss: 0.947 Vali Acc: 0.590 Test Loss: 0.947 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2350146
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.4157023429870605
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.677 Vali Acc: 0.650 Test Loss: 0.677 Test Acc: 0.650
Validation loss decreased (inf --> -0.649993).  Saving model ...
Epoch: 2 cost time: 1.0130674839019775
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.689 Vali Acc: 0.490 Test Loss: 0.689 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0280427932739258
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.676 Vali Acc: 0.550 Test Loss: 0.676 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.027827501296997
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.688 Vali Acc: 0.490 Test Loss: 0.688 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0047171115875244
Epoch: 5, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.691 Vali Acc: 0.520 Test Loss: 0.691 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.049983024597168
Epoch: 6, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.678 Vali Acc: 0.520 Test Loss: 0.678 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0170142650604248
Epoch: 7, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1164989471435547
Epoch: 8, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.681 Vali Acc: 0.560 Test Loss: 0.681 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0066187381744385
Epoch: 9, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.680 Vali Acc: 0.570 Test Loss: 0.680 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9850568771362305
Epoch: 10, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.715 Vali Acc: 0.580 Test Loss: 0.715 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9441754817962646
Epoch: 11, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.723 Vali Acc: 0.520 Test Loss: 0.723 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 694978
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2929444313049316
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.728 Vali Acc: 0.440 Test Loss: 0.728 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.8938398361206055
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.691 Vali Acc: 0.520 Test Loss: 0.691 Test Acc: 0.520
Validation loss decreased (-0.439993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.9907822608947754
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.694 Vali Acc: 0.510 Test Loss: 0.694 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.949988842010498
Epoch: 4, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.708 Vali Acc: 0.470 Test Loss: 0.708 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0847084522247314
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.716 Vali Acc: 0.450 Test Loss: 0.716 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9923474788665771
Epoch: 6, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.708 Vali Acc: 0.480 Test Loss: 0.708 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.856994867324829
Epoch: 7, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.710 Vali Acc: 0.440 Test Loss: 0.710 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9175233840942383
Epoch: 8, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0000052452087402
Epoch: 9, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.729 Vali Acc: 0.490 Test Loss: 0.729 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.930525779724121
Epoch: 10, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.713 Vali Acc: 0.540 Test Loss: 0.713 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.9222722053527832
Epoch: 11, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9113366603851318
Epoch: 12, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.730 Vali Acc: 0.610 Test Loss: 0.730 Test Acc: 0.610
Validation loss decreased (-0.539993 --> -0.609993).  Saving model ...
Epoch: 13 cost time: 1.8883156776428223
Epoch: 13, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.74387788772583
Epoch: 14, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.806 Vali Acc: 0.490 Test Loss: 0.806 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6212680339813232
Epoch: 15, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.837 Vali Acc: 0.480 Test Loss: 0.837 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7619335651397705
Epoch: 16, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.834 Vali Acc: 0.520 Test Loss: 0.834 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6782145500183105
Epoch: 17, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.881 Vali Acc: 0.490 Test Loss: 0.881 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5602819919586182
Epoch: 18, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7073745727539062
Epoch: 19, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.937 Vali Acc: 0.490 Test Loss: 0.937 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7658002376556396
Epoch: 20, Steps: 20 | Train Loss: 0.365 Vali Loss: 0.902 Vali Acc: 0.530 Test Loss: 0.902 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7231249809265137
Epoch: 21, Steps: 20 | Train Loss: 0.334 Vali Loss: 0.877 Vali Acc: 0.520 Test Loss: 0.877 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6761744022369385
Epoch: 22, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.022 Vali Acc: 0.530 Test Loss: 1.022 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1178306
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.652078866958618
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.665 Vali Acc: 0.570 Test Loss: 0.665 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.4130566120147705
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.659 Vali Acc: 0.600 Test Loss: 0.659 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 1.411992073059082
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.686 Vali Acc: 0.530 Test Loss: 0.686 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4346911907196045
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.681 Vali Acc: 0.520 Test Loss: 0.681 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.466313123703003
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.688 Vali Acc: 0.530 Test Loss: 0.688 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4782183170318604
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.685 Vali Acc: 0.480 Test Loss: 0.685 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2949321269989014
Epoch: 7, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.718 Vali Acc: 0.530 Test Loss: 0.718 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3743574619293213
Epoch: 8, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.678 Vali Acc: 0.580 Test Loss: 0.678 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.464259386062622
Epoch: 9, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3912465572357178
Epoch: 10, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4643843173980713
Epoch: 11, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.705 Vali Acc: 0.560 Test Loss: 0.705 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4156270027160645
Epoch: 12, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.713 Vali Acc: 0.530 Test Loss: 0.713 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 350658
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.6364240646362305
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.727 Vali Acc: 0.440 Test Loss: 0.727 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.48866605758667
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.690 Vali Acc: 0.520 Test Loss: 0.690 Test Acc: 0.520
Validation loss decreased (-0.439993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.40968656539917
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4300260543823242
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.705 Vali Acc: 0.490 Test Loss: 0.705 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2362570762634277
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.711 Vali Acc: 0.450 Test Loss: 0.711 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.607933521270752
Epoch: 6, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.702 Vali Acc: 0.480 Test Loss: 0.702 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6097328662872314
Epoch: 7, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.700 Vali Acc: 0.450 Test Loss: 0.700 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5974493026733398
Epoch: 8, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.684 Vali Acc: 0.500 Test Loss: 0.684 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6552517414093018
Epoch: 9, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.700 Vali Acc: 0.490 Test Loss: 0.700 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6131916046142578
Epoch: 10, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.697 Vali Acc: 0.530 Test Loss: 0.697 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 11 cost time: 1.6149311065673828
Epoch: 11, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.731 Vali Acc: 0.480 Test Loss: 0.731 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5737791061401367
Epoch: 12, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.694 Vali Acc: 0.630 Test Loss: 0.694 Test Acc: 0.630
Validation loss decreased (-0.529993 --> -0.629993).  Saving model ...
Epoch: 13 cost time: 1.5127334594726562
Epoch: 13, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.763 Vali Acc: 0.570 Test Loss: 0.763 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5935204029083252
Epoch: 14, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.774 Vali Acc: 0.520 Test Loss: 0.774 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5964043140411377
Epoch: 15, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.827 Vali Acc: 0.510 Test Loss: 0.827 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5892174243927002
Epoch: 16, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.798 Vali Acc: 0.500 Test Loss: 0.798 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5666227340698242
Epoch: 17, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.826 Vali Acc: 0.510 Test Loss: 0.826 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4705784320831299
Epoch: 18, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.778 Vali Acc: 0.480 Test Loss: 0.778 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5600864887237549
Epoch: 19, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.856 Vali Acc: 0.490 Test Loss: 0.856 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5614738464355469
Epoch: 20, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.843 Vali Acc: 0.530 Test Loss: 0.843 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.518721580505371
Epoch: 21, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.782 Vali Acc: 0.570 Test Loss: 0.782 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.602477788925171
Epoch: 22, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.909 Vali Acc: 0.550 Test Loss: 0.909 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1178306
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.489373207092285
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.662 Vali Acc: 0.570 Test Loss: 0.662 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.2390458583831787
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.658 Vali Acc: 0.610 Test Loss: 0.658 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609993).  Saving model ...
Epoch: 3 cost time: 1.227285385131836
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.684 Vali Acc: 0.530 Test Loss: 0.684 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2436957359313965
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.679 Vali Acc: 0.520 Test Loss: 0.679 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3585872650146484
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.687 Vali Acc: 0.520 Test Loss: 0.687 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.308875322341919
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.680 Vali Acc: 0.460 Test Loss: 0.680 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2455062866210938
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.711 Vali Acc: 0.520 Test Loss: 0.711 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.205949306488037
Epoch: 8, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.679 Vali Acc: 0.590 Test Loss: 0.679 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2391407489776611
Epoch: 9, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2839012145996094
Epoch: 10, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.685 Vali Acc: 0.560 Test Loss: 0.685 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3516969680786133
Epoch: 11, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.693 Vali Acc: 0.550 Test Loss: 0.693 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2588355541229248
Epoch: 12, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 350658
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5788185596466064
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.728 Vali Acc: 0.450 Test Loss: 0.728 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.246518850326538
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.690 Vali Acc: 0.520 Test Loss: 0.690 Test Acc: 0.520
Validation loss decreased (-0.449993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.3291573524475098
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.287860631942749
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.705 Vali Acc: 0.490 Test Loss: 0.705 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2537915706634521
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.710 Vali Acc: 0.460 Test Loss: 0.710 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.220689058303833
Epoch: 6, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.701 Vali Acc: 0.480 Test Loss: 0.701 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2216103076934814
Epoch: 7, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.699 Vali Acc: 0.460 Test Loss: 0.699 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1655018329620361
Epoch: 8, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.682 Vali Acc: 0.500 Test Loss: 0.682 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0270938873291016
Epoch: 9, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.695 Vali Acc: 0.480 Test Loss: 0.695 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0809903144836426
Epoch: 10, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.687 Vali Acc: 0.530 Test Loss: 0.687 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 11 cost time: 1.080094814300537
Epoch: 11, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.084993600845337
Epoch: 12, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.671 Vali Acc: 0.600 Test Loss: 0.671 Test Acc: 0.600
Validation loss decreased (-0.529993 --> -0.599993).  Saving model ...
Epoch: 13 cost time: 1.0907247066497803
Epoch: 13, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.071634292602539
Epoch: 14, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.17734694480896
Epoch: 15, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1879143714904785
Epoch: 16, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.688 Vali Acc: 0.590 Test Loss: 0.688 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1632335186004639
Epoch: 17, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.773 Vali Acc: 0.530 Test Loss: 0.773 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2421741485595703
Epoch: 18, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.718 Vali Acc: 0.550 Test Loss: 0.718 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2125794887542725
Epoch: 19, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.724 Vali Acc: 0.570 Test Loss: 0.724 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1911733150482178
Epoch: 20, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.762 Vali Acc: 0.600 Test Loss: 0.762 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.28997802734375
Epoch: 21, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.677 Vali Acc: 0.550 Test Loss: 0.677 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2258169651031494
Epoch: 22, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.722 Vali Acc: 0.560 Test Loss: 0.722 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1178306
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.358633518218994
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.666 Vali Acc: 0.560 Test Loss: 0.666 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.1315984725952148
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.662 Vali Acc: 0.610 Test Loss: 0.662 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609993).  Saving model ...
Epoch: 3 cost time: 1.0317535400390625
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.688 Vali Acc: 0.510 Test Loss: 0.688 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.093811273574829
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.682 Vali Acc: 0.520 Test Loss: 0.682 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0957562923431396
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.690 Vali Acc: 0.520 Test Loss: 0.690 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0824315547943115
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.683 Vali Acc: 0.460 Test Loss: 0.683 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.030552864074707
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0806291103363037
Epoch: 8, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.675 Vali Acc: 0.600 Test Loss: 0.675 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.043572187423706
Epoch: 9, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.699 Vali Acc: 0.520 Test Loss: 0.699 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1335289478302002
Epoch: 10, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.684 Vali Acc: 0.530 Test Loss: 0.684 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9630286693572998
Epoch: 11, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.689 Vali Acc: 0.540 Test Loss: 0.689 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9982767105102539
Epoch: 12, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.705 Vali Acc: 0.560 Test Loss: 0.705 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 350658
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4579532146453857
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.713 Vali Acc: 0.470 Test Loss: 0.713 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.2629389762878418
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.719 Vali Acc: 0.440 Test Loss: 0.719 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9674744606018066
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.724 Vali Acc: 0.410 Test Loss: 0.724 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9342396259307861
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.713 Vali Acc: 0.430 Test Loss: 0.713 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9017062187194824
Epoch: 5, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.719 Vali Acc: 0.470 Test Loss: 0.719 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9207510948181152
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.725 Vali Acc: 0.450 Test Loss: 0.725 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9447352886199951
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.738 Vali Acc: 0.470 Test Loss: 0.738 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.019270896911621
Epoch: 8, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.720 Vali Acc: 0.480 Test Loss: 0.720 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 9 cost time: 1.9278929233551025
Epoch: 9, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9123854637145996
Epoch: 10, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.749 Vali Acc: 0.470 Test Loss: 0.749 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9214649200439453
Epoch: 11, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.775 Vali Acc: 0.440 Test Loss: 0.775 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9347641468048096
Epoch: 12, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.737 Vali Acc: 0.520 Test Loss: 0.737 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 13 cost time: 1.9463109970092773
Epoch: 13, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9336512088775635
Epoch: 14, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.783 Vali Acc: 0.470 Test Loss: 0.783 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9438936710357666
Epoch: 15, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 16 cost time: 1.939465045928955
Epoch: 16, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.780 Vali Acc: 0.470 Test Loss: 0.780 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9529762268066406
Epoch: 17, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.750 Vali Acc: 0.510 Test Loss: 0.750 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9655945301055908
Epoch: 18, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.806 Vali Acc: 0.480 Test Loss: 0.806 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.651564121246338
Epoch: 19, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.763 Vali Acc: 0.560 Test Loss: 0.763 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 20 cost time: 1.6806697845458984
Epoch: 20, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.831 Vali Acc: 0.520 Test Loss: 0.831 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.71421217918396
Epoch: 21, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.70029616355896
Epoch: 22, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.866 Vali Acc: 0.580 Test Loss: 0.866 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579991).  Saving model ...
Epoch: 23 cost time: 1.7583560943603516
Epoch: 23, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.810619831085205
Epoch: 24, Steps: 20 | Train Loss: 0.401 Vali Loss: 0.790 Vali Acc: 0.490 Test Loss: 0.790 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7825024127960205
Epoch: 25, Steps: 20 | Train Loss: 0.355 Vali Loss: 0.897 Vali Acc: 0.500 Test Loss: 0.897 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7680740356445312
Epoch: 26, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.827 Vali Acc: 0.570 Test Loss: 0.827 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9631609916687012
Epoch: 27, Steps: 20 | Train Loss: 0.332 Vali Loss: 0.928 Vali Acc: 0.550 Test Loss: 0.928 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.966383934020996
Epoch: 28, Steps: 20 | Train Loss: 0.296 Vali Loss: 0.824 Vali Acc: 0.570 Test Loss: 0.824 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9689397811889648
Epoch: 29, Steps: 20 | Train Loss: 0.267 Vali Loss: 0.921 Vali Acc: 0.550 Test Loss: 0.921 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9889564514160156
Epoch: 30, Steps: 20 | Train Loss: 0.298 Vali Loss: 0.902 Vali Acc: 0.560 Test Loss: 0.902 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1175458
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8595125675201416
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.699 Vali Acc: 0.560 Test Loss: 0.699 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.358044147491455
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4662234783172607
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.708 Vali Acc: 0.460 Test Loss: 0.708 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2928431034088135
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.337242603302002
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.711 Vali Acc: 0.470 Test Loss: 0.711 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4604167938232422
Epoch: 6, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.35935378074646
Epoch: 7, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.719 Vali Acc: 0.520 Test Loss: 0.719 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5127065181732178
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2462644577026367
Epoch: 9, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3080933094024658
Epoch: 10, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.699 Vali Acc: 0.530 Test Loss: 0.699 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.310950517654419
Epoch: 11, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.711 Vali Acc: 0.490 Test Loss: 0.711 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 347746
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.6357836723327637
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.713 Vali Acc: 0.470 Test Loss: 0.713 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.4830255508422852
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.718 Vali Acc: 0.440 Test Loss: 0.718 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5661463737487793
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.724 Vali Acc: 0.410 Test Loss: 0.724 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5572750568389893
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.713 Vali Acc: 0.440 Test Loss: 0.713 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.576578140258789
Epoch: 5, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.719 Vali Acc: 0.480 Test Loss: 0.719 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 6 cost time: 1.5321125984191895
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.724 Vali Acc: 0.450 Test Loss: 0.724 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6418988704681396
Epoch: 7, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.735 Vali Acc: 0.450 Test Loss: 0.735 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.639801025390625
Epoch: 8, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 9 cost time: 1.6633696556091309
Epoch: 9, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5898568630218506
Epoch: 10, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5083107948303223
Epoch: 11, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.755 Vali Acc: 0.480 Test Loss: 0.755 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5454707145690918
Epoch: 12, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 13 cost time: 1.6091368198394775
Epoch: 13, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.738 Vali Acc: 0.510 Test Loss: 0.738 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5574259757995605
Epoch: 14, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6750504970550537
Epoch: 15, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5886471271514893
Epoch: 16, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.764 Vali Acc: 0.480 Test Loss: 0.764 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5569241046905518
Epoch: 17, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 18 cost time: 1.6678969860076904
Epoch: 18, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.778 Vali Acc: 0.450 Test Loss: 0.778 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5852675437927246
Epoch: 19, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9357407093048096
Epoch: 20, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.777 Vali Acc: 0.490 Test Loss: 0.777 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4048502445220947
Epoch: 21, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.802 Vali Acc: 0.540 Test Loss: 0.802 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 22 cost time: 1.5360286235809326
Epoch: 22, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.866 Vali Acc: 0.530 Test Loss: 0.866 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4029090404510498
Epoch: 23, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.822 Vali Acc: 0.470 Test Loss: 0.822 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4091496467590332
Epoch: 24, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.818 Vali Acc: 0.490 Test Loss: 0.818 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4112205505371094
Epoch: 25, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.884 Vali Acc: 0.470 Test Loss: 0.884 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4198870658874512
Epoch: 26, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.819 Vali Acc: 0.560 Test Loss: 0.819 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 27 cost time: 1.4176855087280273
Epoch: 27, Steps: 20 | Train Loss: 0.365 Vali Loss: 0.861 Vali Acc: 0.520 Test Loss: 0.861 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3981823921203613
Epoch: 28, Steps: 20 | Train Loss: 0.349 Vali Loss: 0.868 Vali Acc: 0.500 Test Loss: 0.868 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.532766580581665
Epoch: 29, Steps: 20 | Train Loss: 0.336 Vali Loss: 0.937 Vali Acc: 0.520 Test Loss: 0.937 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6403133869171143
Epoch: 30, Steps: 20 | Train Loss: 0.341 Vali Loss: 0.942 Vali Acc: 0.530 Test Loss: 0.942 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1175458
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5985286235809326
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.697 Vali Acc: 0.550 Test Loss: 0.697 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.2732985019683838
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2400739192962646
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.708 Vali Acc: 0.470 Test Loss: 0.708 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2460277080535889
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2554986476898193
Epoch: 5, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.714 Vali Acc: 0.470 Test Loss: 0.714 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3055033683776855
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2246007919311523
Epoch: 7, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.725 Vali Acc: 0.520 Test Loss: 0.725 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3030471801757812
Epoch: 8, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.720 Vali Acc: 0.520 Test Loss: 0.720 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2621352672576904
Epoch: 9, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2119495868682861
Epoch: 10, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.703 Vali Acc: 0.520 Test Loss: 0.703 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2570114135742188
Epoch: 11, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.719 Vali Acc: 0.490 Test Loss: 0.719 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 347746
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.4744715690612793
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.712 Vali Acc: 0.470 Test Loss: 0.712 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.111612319946289
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.718 Vali Acc: 0.440 Test Loss: 0.718 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2210149765014648
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.724 Vali Acc: 0.410 Test Loss: 0.724 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1602823734283447
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.711 Vali Acc: 0.430 Test Loss: 0.711 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8327946662902832
Epoch: 5, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 6 cost time: 1.1628692150115967
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.723 Vali Acc: 0.450 Test Loss: 0.723 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.227308988571167
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1817822456359863
Epoch: 8, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 9 cost time: 1.257948637008667
Epoch: 9, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.730 Vali Acc: 0.480 Test Loss: 0.730 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2046732902526855
Epoch: 10, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.215700626373291
Epoch: 11, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1564586162567139
Epoch: 12, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 13 cost time: 1.2111003398895264
Epoch: 13, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2025763988494873
Epoch: 14, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.305299997329712
Epoch: 15, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.723 Vali Acc: 0.520 Test Loss: 0.723 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 16 cost time: 1.2643640041351318
Epoch: 16, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 17 cost time: 1.3069849014282227
Epoch: 17, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.725 Vali Acc: 0.540 Test Loss: 0.725 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 18 cost time: 1.2754144668579102
Epoch: 18, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.279817819595337
Epoch: 19, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.719 Vali Acc: 0.560 Test Loss: 0.719 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 20 cost time: 1.247230052947998
Epoch: 20, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.747 Vali Acc: 0.560 Test Loss: 0.747 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.255753755569458
Epoch: 21, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2860074043273926
Epoch: 22, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.762 Vali Acc: 0.530 Test Loss: 0.762 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.26625657081604
Epoch: 23, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.768 Vali Acc: 0.510 Test Loss: 0.768 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2394137382507324
Epoch: 24, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1277549266815186
Epoch: 25, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.791 Vali Acc: 0.550 Test Loss: 0.791 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.143397331237793
Epoch: 26, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.723 Vali Acc: 0.590 Test Loss: 0.723 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 27 cost time: 1.1966285705566406
Epoch: 27, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.749 Vali Acc: 0.580 Test Loss: 0.749 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1570909023284912
Epoch: 28, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.782 Vali Acc: 0.580 Test Loss: 0.782 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0702190399169922
Epoch: 29, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.769 Vali Acc: 0.580 Test Loss: 0.769 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2919185161590576
Epoch: 30, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.803 Vali Acc: 0.530 Test Loss: 0.803 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1175458
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.3527772426605225
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.696 Vali Acc: 0.560 Test Loss: 0.696 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.0851247310638428
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.701 Vali Acc: 0.510 Test Loss: 0.701 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.037095069885254
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.708 Vali Acc: 0.470 Test Loss: 0.708 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0807969570159912
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.230154037475586
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.714 Vali Acc: 0.470 Test Loss: 0.714 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0910730361938477
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.014327049255371
Epoch: 7, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0641851425170898
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1079809665679932
Epoch: 9, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.724 Vali Acc: 0.530 Test Loss: 0.724 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.152106761932373
Epoch: 10, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.701 Vali Acc: 0.510 Test Loss: 0.701 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0582144260406494
Epoch: 11, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 347746
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.365283727645874
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.686 Vali Acc: 0.540 Test Loss: 0.686 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.4893732070922852
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.689 Vali Acc: 0.570 Test Loss: 0.689 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 1.448512315750122
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.691 Vali Acc: 0.540 Test Loss: 0.691 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4937505722045898
Epoch: 4, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.686 Vali Acc: 0.510 Test Loss: 0.686 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.625657081604004
Epoch: 5, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.690 Vali Acc: 0.540 Test Loss: 0.690 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4135792255401611
Epoch: 6, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.697 Vali Acc: 0.510 Test Loss: 0.697 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6017816066741943
Epoch: 7, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5915722846984863
Epoch: 8, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.693 Vali Acc: 0.530 Test Loss: 0.693 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5792853832244873
Epoch: 9, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3334171772003174
Epoch: 10, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7733986377716064
Epoch: 11, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8771014213562012
Epoch: 12, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.703 Vali Acc: 0.520 Test Loss: 0.703 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 589346
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.720489501953125
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.667 Vali Acc: 0.580 Test Loss: 0.667 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.4718477725982666
Epoch: 2, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.668 Vali Acc: 0.580 Test Loss: 0.668 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5429394245147705
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.674 Vali Acc: 0.500 Test Loss: 0.674 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.463876485824585
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.684 Vali Acc: 0.470 Test Loss: 0.684 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.429459810256958
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.685 Vali Acc: 0.480 Test Loss: 0.685 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5376121997833252
Epoch: 6, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.695 Vali Acc: 0.520 Test Loss: 0.695 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4656896591186523
Epoch: 7, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.711 Vali Acc: 0.490 Test Loss: 0.711 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.520495891571045
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.694 Vali Acc: 0.510 Test Loss: 0.694 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5399458408355713
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.698 Vali Acc: 0.490 Test Loss: 0.698 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4185378551483154
Epoch: 10, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.099735975265503
Epoch: 11, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 175458
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.759082794189453
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.686 Vali Acc: 0.540 Test Loss: 0.686 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.3289752006530762
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.689 Vali Acc: 0.570 Test Loss: 0.689 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 1.1461129188537598
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.691 Vali Acc: 0.540 Test Loss: 0.691 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.472717523574829
Epoch: 4, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.686 Vali Acc: 0.530 Test Loss: 0.686 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.497922420501709
Epoch: 5, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.690 Vali Acc: 0.540 Test Loss: 0.690 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.511709213256836
Epoch: 6, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.697 Vali Acc: 0.510 Test Loss: 0.697 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.496274471282959
Epoch: 7, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.477302074432373
Epoch: 8, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.693 Vali Acc: 0.530 Test Loss: 0.693 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5348529815673828
Epoch: 9, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4526538848876953
Epoch: 10, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5208549499511719
Epoch: 11, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4671249389648438
Epoch: 12, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.703 Vali Acc: 0.520 Test Loss: 0.703 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 589346
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.452285051345825
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.667 Vali Acc: 0.570 Test Loss: 0.667 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.1781082153320312
Epoch: 2, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.668 Vali Acc: 0.570 Test Loss: 0.668 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3565740585327148
Epoch: 3, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.673 Vali Acc: 0.500 Test Loss: 0.673 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.190091848373413
Epoch: 4, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.683 Vali Acc: 0.470 Test Loss: 0.683 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2032675743103027
Epoch: 5, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.684 Vali Acc: 0.470 Test Loss: 0.684 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1682884693145752
Epoch: 6, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.694 Vali Acc: 0.520 Test Loss: 0.694 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2190208435058594
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.711 Vali Acc: 0.490 Test Loss: 0.711 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.243314266204834
Epoch: 8, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1880340576171875
Epoch: 9, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9835538864135742
Epoch: 10, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.702 Vali Acc: 0.480 Test Loss: 0.702 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1553857326507568
Epoch: 11, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 175458
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.797947883605957
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.686 Vali Acc: 0.550 Test Loss: 0.686 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.222386360168457
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.690 Vali Acc: 0.560 Test Loss: 0.690 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.249140977859497
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.696 Vali Acc: 0.510 Test Loss: 0.696 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2114317417144775
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.693 Vali Acc: 0.550 Test Loss: 0.693 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2114346027374268
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.700 Vali Acc: 0.570 Test Loss: 0.700 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 1.1750361919403076
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.707 Vali Acc: 0.520 Test Loss: 0.707 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1461386680603027
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.176074504852295
Epoch: 8, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.701 Vali Acc: 0.560 Test Loss: 0.701 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3018977642059326
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3439831733703613
Epoch: 10, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.729 Vali Acc: 0.520 Test Loss: 0.729 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.265730619430542
Epoch: 11, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3198952674865723
Epoch: 12, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.716 Vali Acc: 0.560 Test Loss: 0.716 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2403786182403564
Epoch: 13, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2166197299957275
Epoch: 14, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.717 Vali Acc: 0.550 Test Loss: 0.717 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.21958589553833
Epoch: 15, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 589346
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5985755920410156
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.667 Vali Acc: 0.570 Test Loss: 0.667 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.0589933395385742
Epoch: 2, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.668 Vali Acc: 0.570 Test Loss: 0.668 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9976062774658203
Epoch: 3, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.673 Vali Acc: 0.500 Test Loss: 0.673 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0432980060577393
Epoch: 4, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.683 Vali Acc: 0.470 Test Loss: 0.683 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.000758409500122
Epoch: 5, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.684 Vali Acc: 0.480 Test Loss: 0.684 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.937556266784668
Epoch: 6, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.694 Vali Acc: 0.510 Test Loss: 0.694 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0484230518341064
Epoch: 7, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.711 Vali Acc: 0.490 Test Loss: 0.711 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.076237678527832
Epoch: 8, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0569674968719482
Epoch: 9, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.696 Vali Acc: 0.480 Test Loss: 0.696 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0843536853790283
Epoch: 10, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.702 Vali Acc: 0.480 Test Loss: 0.702 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0437695980072021
Epoch: 11, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 175458
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1153640747070312
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.674 Vali Acc: 0.580 Test Loss: 0.674 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.6937313079833984
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.695 Vali Acc: 0.510 Test Loss: 0.695 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6676666736602783
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6407487392425537
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.712263822555542
Epoch: 5, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6606030464172363
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6865942478179932
Epoch: 7, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.698 Vali Acc: 0.560 Test Loss: 0.698 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5962913036346436
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.279062271118164
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.698 Vali Acc: 0.530 Test Loss: 0.698 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5138275623321533
Epoch: 10, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5100295543670654
Epoch: 11, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 296290
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.66963529586792
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.707 Vali Acc: 0.480 Test Loss: 0.707 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.522207260131836
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.711 Vali Acc: 0.460 Test Loss: 0.711 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3929972648620605
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.484309196472168
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.709 Vali Acc: 0.520 Test Loss: 0.709 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 1.4617350101470947
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 1.3473024368286133
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.693 Vali Acc: 0.520 Test Loss: 0.693 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3617582321166992
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2920937538146973
Epoch: 8, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.688 Vali Acc: 0.550 Test Loss: 0.688 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 1.4430675506591797
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.685 Vali Acc: 0.560 Test Loss: 0.685 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 10 cost time: 1.4136900901794434
Epoch: 10, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.691 Vali Acc: 0.510 Test Loss: 0.691 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4154245853424072
Epoch: 11, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.701 Vali Acc: 0.550 Test Loss: 0.701 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4554638862609863
Epoch: 12, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.690 Vali Acc: 0.570 Test Loss: 0.690 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 13 cost time: 1.4411451816558838
Epoch: 13, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.690 Vali Acc: 0.510 Test Loss: 0.690 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3771624565124512
Epoch: 14, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.691 Vali Acc: 0.520 Test Loss: 0.691 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.428523063659668
Epoch: 15, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3730695247650146
Epoch: 16, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.701 Vali Acc: 0.590 Test Loss: 0.701 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 17 cost time: 1.386479377746582
Epoch: 17, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.731 Vali Acc: 0.530 Test Loss: 0.731 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.372265338897705
Epoch: 18, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.718 Vali Acc: 0.580 Test Loss: 0.718 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3749990463256836
Epoch: 19, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.729 Vali Acc: 0.570 Test Loss: 0.729 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3131685256958008
Epoch: 20, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.738 Vali Acc: 0.570 Test Loss: 0.738 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2991442680358887
Epoch: 21, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.748 Vali Acc: 0.560 Test Loss: 0.748 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3592259883880615
Epoch: 22, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.377532958984375
Epoch: 23, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.744 Vali Acc: 0.580 Test Loss: 0.744 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3293840885162354
Epoch: 24, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.779 Vali Acc: 0.550 Test Loss: 0.779 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3041787147521973
Epoch: 25, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.791 Vali Acc: 0.550 Test Loss: 0.791 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3417582511901855
Epoch: 26, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.825 Vali Acc: 0.530 Test Loss: 0.825 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 89314
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9738943576812744
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.674 Vali Acc: 0.580 Test Loss: 0.674 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 1.5245845317840576
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4450528621673584
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.416250467300415
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4686346054077148
Epoch: 5, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.706 Vali Acc: 0.490 Test Loss: 0.706 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4769690036773682
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.352086067199707
Epoch: 7, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.698 Vali Acc: 0.550 Test Loss: 0.698 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4018938541412354
Epoch: 8, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4459614753723145
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.697 Vali Acc: 0.510 Test Loss: 0.697 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.463576316833496
Epoch: 10, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4010798931121826
Epoch: 11, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 296290
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.6118335723876953
Epoch: 1, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.708 Vali Acc: 0.490 Test Loss: 0.708 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.3563601970672607
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.712 Vali Acc: 0.480 Test Loss: 0.712 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1878869533538818
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.713 Vali Acc: 0.520 Test Loss: 0.713 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.2086443901062012
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.709 Vali Acc: 0.510 Test Loss: 0.709 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1737418174743652
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.699 Vali Acc: 0.530 Test Loss: 0.699 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 1.1813714504241943
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.695 Vali Acc: 0.530 Test Loss: 0.695 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 0.9422197341918945
Epoch: 7, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.699 Vali Acc: 0.520 Test Loss: 0.699 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9025025367736816
Epoch: 8, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.689 Vali Acc: 0.540 Test Loss: 0.689 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.1285724639892578
Epoch: 9, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.687 Vali Acc: 0.550 Test Loss: 0.687 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 10 cost time: 1.1875097751617432
Epoch: 10, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1756591796875
Epoch: 11, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.703 Vali Acc: 0.540 Test Loss: 0.703 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.824662446975708
Epoch: 12, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.692 Vali Acc: 0.550 Test Loss: 0.692 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8934690952301025
Epoch: 13, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.694 Vali Acc: 0.530 Test Loss: 0.694 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.863924503326416
Epoch: 14, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.693 Vali Acc: 0.540 Test Loss: 0.693 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7498347759246826
Epoch: 15, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.703 Vali Acc: 0.520 Test Loss: 0.703 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8428623676300049
Epoch: 16, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.699 Vali Acc: 0.600 Test Loss: 0.699 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599993).  Saving model ...
Epoch: 17 cost time: 0.923792839050293
Epoch: 17, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8673417568206787
Epoch: 18, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.701 Vali Acc: 0.590 Test Loss: 0.701 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8243753910064697
Epoch: 19, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8307716846466064
Epoch: 20, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.727 Vali Acc: 0.580 Test Loss: 0.727 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9184026718139648
Epoch: 21, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.705 Vali Acc: 0.590 Test Loss: 0.705 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8958325386047363
Epoch: 22, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.721 Vali Acc: 0.580 Test Loss: 0.721 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8197729587554932
Epoch: 23, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.714 Vali Acc: 0.560 Test Loss: 0.714 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2376213073730469
Epoch: 24, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.736 Vali Acc: 0.570 Test Loss: 0.736 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2317039966583252
Epoch: 25, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.789 Vali Acc: 0.540 Test Loss: 0.789 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1856772899627686
Epoch: 26, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.784 Vali Acc: 0.550 Test Loss: 0.784 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 89314
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.3583524227142334
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.674 Vali Acc: 0.570 Test Loss: 0.674 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.170443058013916
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.695 Vali Acc: 0.510 Test Loss: 0.695 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1125082969665527
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.159153699874878
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1351125240325928
Epoch: 5, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.707 Vali Acc: 0.490 Test Loss: 0.707 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2160565853118896
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1816439628601074
Epoch: 7, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.698 Vali Acc: 0.550 Test Loss: 0.698 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2935824394226074
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2454209327697754
Epoch: 9, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.697 Vali Acc: 0.520 Test Loss: 0.697 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2223238945007324
Epoch: 10, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1480309963226318
Epoch: 11, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.699 Vali Acc: 0.520 Test Loss: 0.699 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 296290
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5080487728118896
Epoch: 1, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.1096806526184082
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.713 Vali Acc: 0.470 Test Loss: 0.713 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0695905685424805
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.0826382637023926
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.111567497253418
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 1.1649494171142578
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.698 Vali Acc: 0.510 Test Loss: 0.698 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.069096565246582
Epoch: 7, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.704 Vali Acc: 0.490 Test Loss: 0.704 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0977489948272705
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.693 Vali Acc: 0.520 Test Loss: 0.693 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0349748134613037
Epoch: 9, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.692 Vali Acc: 0.570 Test Loss: 0.692 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 10 cost time: 1.0935473442077637
Epoch: 10, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0534131526947021
Epoch: 11, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.707 Vali Acc: 0.550 Test Loss: 0.707 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1318860054016113
Epoch: 12, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.691 Vali Acc: 0.580 Test Loss: 0.691 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 13 cost time: 1.0892553329467773
Epoch: 13, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.691 Vali Acc: 0.530 Test Loss: 0.691 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0595126152038574
Epoch: 14, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.689 Vali Acc: 0.530 Test Loss: 0.689 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0744860172271729
Epoch: 15, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0608491897583008
Epoch: 16, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.693 Vali Acc: 0.590 Test Loss: 0.693 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 17 cost time: 1.0979604721069336
Epoch: 17, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.702 Vali Acc: 0.580 Test Loss: 0.702 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.09257173538208
Epoch: 18, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.691 Vali Acc: 0.580 Test Loss: 0.691 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0765790939331055
Epoch: 19, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.704 Vali Acc: 0.570 Test Loss: 0.704 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7466320991516113
Epoch: 20, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.702 Vali Acc: 0.580 Test Loss: 0.702 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0402867794036865
Epoch: 21, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.698 Vali Acc: 0.580 Test Loss: 0.698 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.074662208557129
Epoch: 22, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.712 Vali Acc: 0.570 Test Loss: 0.712 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.072667121887207
Epoch: 23, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0297508239746094
Epoch: 24, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.727 Vali Acc: 0.570 Test Loss: 0.727 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.121246099472046
Epoch: 25, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.737 Vali Acc: 0.590 Test Loss: 0.737 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.149101734161377
Epoch: 26, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.758 Vali Acc: 0.570 Test Loss: 0.758 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 89314
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2841241359710693
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.742 Vali Acc: 0.460 Test Loss: 0.742 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.7584788799285889
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.8360800743103027
Epoch: 3, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.706 Vali Acc: 0.470 Test Loss: 0.706 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7969801425933838
Epoch: 4, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.702 Vali Acc: 0.490 Test Loss: 0.702 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 1.5258114337921143
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.711 Vali Acc: 0.490 Test Loss: 0.711 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.910163164138794
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.701 Vali Acc: 0.520 Test Loss: 0.701 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 1.8660225868225098
Epoch: 7, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.703 Vali Acc: 0.470 Test Loss: 0.703 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9871699810028076
Epoch: 8, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9216523170471191
Epoch: 9, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 10 cost time: 2.001082420349121
Epoch: 10, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.686 Vali Acc: 0.560 Test Loss: 0.686 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 11 cost time: 1.9929027557373047
Epoch: 11, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9801230430603027
Epoch: 12, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.689 Vali Acc: 0.550 Test Loss: 0.689 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8361468315124512
Epoch: 13, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.719 Vali Acc: 0.550 Test Loss: 0.719 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9006357192993164
Epoch: 14, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.717 Vali Acc: 0.570 Test Loss: 0.717 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 15 cost time: 1.841393232345581
Epoch: 15, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.818 Vali Acc: 0.470 Test Loss: 0.818 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.890319585800171
Epoch: 16, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.710 Vali Acc: 0.480 Test Loss: 0.710 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9576454162597656
Epoch: 17, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.706 Vali Acc: 0.490 Test Loss: 0.706 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9191360473632812
Epoch: 18, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.930016040802002
Epoch: 19, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.716 Vali Acc: 0.560 Test Loss: 0.716 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9766974449157715
Epoch: 20, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.757 Vali Acc: 0.460 Test Loss: 0.757 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9066689014434814
Epoch: 21, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.833 Vali Acc: 0.470 Test Loss: 0.833 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9167184829711914
Epoch: 22, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9694852828979492
Epoch: 23, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.910 Vali Acc: 0.480 Test Loss: 0.910 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.941704511642456
Epoch: 24, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.808 Vali Acc: 0.570 Test Loss: 0.808 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 588114
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0124940872192383
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.722 Vali Acc: 0.430 Test Loss: 0.722 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.5251085758209229
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.723 Vali Acc: 0.410 Test Loss: 0.723 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6471216678619385
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.723 Vali Acc: 0.420 Test Loss: 0.723 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6444032192230225
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.719 Vali Acc: 0.420 Test Loss: 0.719 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6211929321289062
Epoch: 5, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.721 Vali Acc: 0.380 Test Loss: 0.721 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6212232112884521
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.724 Vali Acc: 0.420 Test Loss: 0.724 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5745704174041748
Epoch: 7, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.720 Vali Acc: 0.430 Test Loss: 0.720 Test Acc: 0.430
Validation loss decreased (-0.429993 --> -0.429993).  Saving model ...
Epoch: 8 cost time: 1.764808177947998
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.723 Vali Acc: 0.450 Test Loss: 0.723 Test Acc: 0.450
Validation loss decreased (-0.429993 --> -0.449993).  Saving model ...
Epoch: 9 cost time: 1.6294572353363037
Epoch: 9, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
Validation loss decreased (-0.449993 --> -0.479993).  Saving model ...
Epoch: 10 cost time: 1.6594443321228027
Epoch: 10, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.740 Vali Acc: 0.480 Test Loss: 0.740 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5828073024749756
Epoch: 11, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.725 Vali Acc: 0.460 Test Loss: 0.725 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1820602416992188
Epoch: 12, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.746 Vali Acc: 0.450 Test Loss: 0.746 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4777350425720215
Epoch: 13, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.728 Vali Acc: 0.430 Test Loss: 0.728 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4283900260925293
Epoch: 14, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.762 Vali Acc: 0.510 Test Loss: 0.762 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509992).  Saving model ...
Epoch: 15 cost time: 1.4387357234954834
Epoch: 15, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5693936347961426
Epoch: 16, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.784 Vali Acc: 0.460 Test Loss: 0.784 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.597593069076538
Epoch: 17, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.746 Vali Acc: 0.460 Test Loss: 0.746 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4221978187561035
Epoch: 18, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5116395950317383
Epoch: 19, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.737 Vali Acc: 0.470 Test Loss: 0.737 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3458092212677002
Epoch: 20, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.537508487701416
Epoch: 21, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.782 Vali Acc: 0.490 Test Loss: 0.782 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.507096290588379
Epoch: 22, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.781 Vali Acc: 0.490 Test Loss: 0.781 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4697933197021484
Epoch: 23, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5140681266784668
Epoch: 24, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.815 Vali Acc: 0.500 Test Loss: 0.815 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 174130
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0494441986083984
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.741 Vali Acc: 0.460 Test Loss: 0.741 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.6298344135284424
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
Validation loss decreased (-0.459993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.6800031661987305
Epoch: 3, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.705 Vali Acc: 0.460 Test Loss: 0.705 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6649386882781982
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.702 Vali Acc: 0.490 Test Loss: 0.702 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.682675838470459
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.711 Vali Acc: 0.490 Test Loss: 0.711 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7263264656066895
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 7 cost time: 1.6525225639343262
Epoch: 7, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5838468074798584
Epoch: 8, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7138423919677734
Epoch: 9, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6716079711914062
Epoch: 10, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.692 Vali Acc: 0.570 Test Loss: 0.692 Test Acc: 0.570
Validation loss decreased (-0.499993 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 1.6394555568695068
Epoch: 11, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6416122913360596
Epoch: 12, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.693 Vali Acc: 0.540 Test Loss: 0.693 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6633875370025635
Epoch: 13, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.729 Vali Acc: 0.480 Test Loss: 0.729 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6873972415924072
Epoch: 14, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.723 Vali Acc: 0.530 Test Loss: 0.723 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7050509452819824
Epoch: 15, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.751 Vali Acc: 0.420 Test Loss: 0.751 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6545631885528564
Epoch: 16, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.682091236114502
Epoch: 17, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.752 Vali Acc: 0.420 Test Loss: 0.752 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6470427513122559
Epoch: 18, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.738 Vali Acc: 0.460 Test Loss: 0.738 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.640564203262329
Epoch: 19, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6153252124786377
Epoch: 20, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.739 Vali Acc: 0.480 Test Loss: 0.739 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 588114
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8526663780212402
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.721 Vali Acc: 0.430 Test Loss: 0.721 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.3206841945648193
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.721 Vali Acc: 0.420 Test Loss: 0.721 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3606493473052979
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.720 Vali Acc: 0.440 Test Loss: 0.720 Test Acc: 0.440
Validation loss decreased (-0.429993 --> -0.439993).  Saving model ...
Epoch: 4 cost time: 1.4502506256103516
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.718 Vali Acc: 0.400 Test Loss: 0.718 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.475975751876831
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.719 Vali Acc: 0.410 Test Loss: 0.719 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.392099142074585
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.725 Vali Acc: 0.410 Test Loss: 0.725 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3487977981567383
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.722 Vali Acc: 0.440 Test Loss: 0.722 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.288313627243042
Epoch: 8, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.725 Vali Acc: 0.440 Test Loss: 0.725 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3176398277282715
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.730 Vali Acc: 0.460 Test Loss: 0.730 Test Acc: 0.460
Validation loss decreased (-0.439993 --> -0.459993).  Saving model ...
Epoch: 10 cost time: 1.4210095405578613
Epoch: 10, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.741 Vali Acc: 0.460 Test Loss: 0.741 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.381246566772461
Epoch: 11, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.735 Vali Acc: 0.440 Test Loss: 0.735 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2571384906768799
Epoch: 12, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.755 Vali Acc: 0.390 Test Loss: 0.755 Test Acc: 0.390
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3255500793457031
Epoch: 13, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.736 Vali Acc: 0.410 Test Loss: 0.736 Test Acc: 0.410
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2917439937591553
Epoch: 14, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.768 Vali Acc: 0.420 Test Loss: 0.768 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2649340629577637
Epoch: 15, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.745 Vali Acc: 0.420 Test Loss: 0.745 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.348663568496704
Epoch: 16, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.775 Vali Acc: 0.410 Test Loss: 0.775 Test Acc: 0.410
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2896130084991455
Epoch: 17, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.748 Vali Acc: 0.410 Test Loss: 0.748 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.346822738647461
Epoch: 18, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.760 Vali Acc: 0.410 Test Loss: 0.760 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3335223197937012
Epoch: 19, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.727 Vali Acc: 0.450 Test Loss: 0.727 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.46
model parameter : 174130
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5468547344207764
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.740 Vali Acc: 0.460 Test Loss: 0.740 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.2244884967803955
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 1.2178077697753906
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.706 Vali Acc: 0.470 Test Loss: 0.706 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7787294387817383
Epoch: 4, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.702 Vali Acc: 0.490 Test Loss: 0.702 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 0.8841233253479004
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.709 Vali Acc: 0.470 Test Loss: 0.709 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3181219100952148
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.702 Vali Acc: 0.480 Test Loss: 0.702 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2959470748901367
Epoch: 7, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.703 Vali Acc: 0.470 Test Loss: 0.703 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2998883724212646
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3060574531555176
Epoch: 9, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2866880893707275
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 11 cost time: 1.302126407623291
Epoch: 11, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.697 Vali Acc: 0.490 Test Loss: 0.697 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3144845962524414
Epoch: 12, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.698 Vali Acc: 0.490 Test Loss: 0.698 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.254683017730713
Epoch: 13, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.695 Vali Acc: 0.490 Test Loss: 0.695 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2988810539245605
Epoch: 14, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.704 Vali Acc: 0.480 Test Loss: 0.704 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2745308876037598
Epoch: 15, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.703 Vali Acc: 0.480 Test Loss: 0.703 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3125600814819336
Epoch: 16, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.681 Vali Acc: 0.520 Test Loss: 0.681 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 17 cost time: 1.378723382949829
Epoch: 17, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.695 Vali Acc: 0.490 Test Loss: 0.695 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2773430347442627
Epoch: 18, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.678 Vali Acc: 0.510 Test Loss: 0.678 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3262319564819336
Epoch: 19, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.671 Vali Acc: 0.510 Test Loss: 0.671 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3342983722686768
Epoch: 20, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.704 Vali Acc: 0.480 Test Loss: 0.704 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2978284358978271
Epoch: 21, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.695 Vali Acc: 0.510 Test Loss: 0.695 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3109099864959717
Epoch: 22, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.707 Vali Acc: 0.440 Test Loss: 0.707 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2940466403961182
Epoch: 23, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.685 Vali Acc: 0.500 Test Loss: 0.685 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3302555084228516
Epoch: 24, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.674 Vali Acc: 0.520 Test Loss: 0.674 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 25 cost time: 1.3005616664886475
Epoch: 25, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.683 Vali Acc: 0.490 Test Loss: 0.683 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.326685905456543
Epoch: 26, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3136491775512695
Epoch: 27, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 28 cost time: 1.290266513824463
Epoch: 28, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.699 Vali Acc: 0.470 Test Loss: 0.699 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2975709438323975
Epoch: 29, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3382837772369385
Epoch: 30, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.718 Vali Acc: 0.460 Test Loss: 0.718 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 588114
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.4209070205688477
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.722 Vali Acc: 0.430 Test Loss: 0.722 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.1756727695465088
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.723 Vali Acc: 0.420 Test Loss: 0.723 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2808010578155518
Epoch: 3, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.722 Vali Acc: 0.440 Test Loss: 0.722 Test Acc: 0.440
Validation loss decreased (-0.429993 --> -0.439993).  Saving model ...
Epoch: 4 cost time: 1.1456027030944824
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.718 Vali Acc: 0.440 Test Loss: 0.718 Test Acc: 0.440
Validation loss decreased (-0.439993 --> -0.439993).  Saving model ...
Epoch: 5 cost time: 1.179426908493042
Epoch: 5, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.718 Vali Acc: 0.440 Test Loss: 0.718 Test Acc: 0.440
Validation loss decreased (-0.439993 --> -0.439993).  Saving model ...
Epoch: 6 cost time: 1.2985563278198242
Epoch: 6, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.721 Vali Acc: 0.440 Test Loss: 0.721 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2035369873046875
Epoch: 7, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.719 Vali Acc: 0.420 Test Loss: 0.719 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.224910020828247
Epoch: 8, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.714 Vali Acc: 0.460 Test Loss: 0.714 Test Acc: 0.460
Validation loss decreased (-0.439993 --> -0.459993).  Saving model ...
Epoch: 9 cost time: 1.1862175464630127
Epoch: 9, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479993).  Saving model ...
Epoch: 10 cost time: 1.2117328643798828
Epoch: 10, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.728 Vali Acc: 0.480 Test Loss: 0.728 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1977593898773193
Epoch: 11, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.717 Vali Acc: 0.460 Test Loss: 0.717 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1534230709075928
Epoch: 12, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 13 cost time: 1.171351671218872
Epoch: 13, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.728 Vali Acc: 0.460 Test Loss: 0.728 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1644039154052734
Epoch: 14, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.729 Vali Acc: 0.480 Test Loss: 0.729 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.182297945022583
Epoch: 15, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 16 cost time: 1.1565508842468262
Epoch: 16, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.187692642211914
Epoch: 17, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1581213474273682
Epoch: 18, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 19 cost time: 1.1723506450653076
Epoch: 19, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7854783535003662
Epoch: 20, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.696 Vali Acc: 0.560 Test Loss: 0.696 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 21 cost time: 1.1087315082550049
Epoch: 21, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1653661727905273
Epoch: 22, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1746668815612793
Epoch: 23, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1489334106445312
Epoch: 24, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1364514827728271
Epoch: 25, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.725 Vali Acc: 0.530 Test Loss: 0.725 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1653342247009277
Epoch: 26, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.747 Vali Acc: 0.520 Test Loss: 0.747 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2169413566589355
Epoch: 27, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.732 Vali Acc: 0.520 Test Loss: 0.732 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.127528190612793
Epoch: 28, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.713 Vali Acc: 0.530 Test Loss: 0.713 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6721878051757812
Epoch: 29, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.182985782623291
Epoch: 30, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 174130
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1559791564941406
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.727109670639038
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.6895406246185303
Epoch: 3, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.703 Vali Acc: 0.530 Test Loss: 0.703 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.7868854999542236
Epoch: 4, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.694 Vali Acc: 0.530 Test Loss: 0.694 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 1.775602102279663
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.690 Vali Acc: 0.600 Test Loss: 0.690 Test Acc: 0.600
Validation loss decreased (-0.529993 --> -0.599993).  Saving model ...
Epoch: 6 cost time: 1.8343448638916016
Epoch: 6, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.691 Vali Acc: 0.570 Test Loss: 0.691 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7418692111968994
Epoch: 7, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.693 Vali Acc: 0.550 Test Loss: 0.693 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8076295852661133
Epoch: 8, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.695 Vali Acc: 0.580 Test Loss: 0.695 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9903619289398193
Epoch: 9, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.694 Vali Acc: 0.540 Test Loss: 0.694 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.818835973739624
Epoch: 10, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.705 Vali Acc: 0.510 Test Loss: 0.705 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7880668640136719
Epoch: 11, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9032726287841797
Epoch: 12, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9054551124572754
Epoch: 13, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8970882892608643
Epoch: 14, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.921912431716919
Epoch: 15, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 294866
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8715054988861084
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.702 Vali Acc: 0.510 Test Loss: 0.702 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.58394193649292
Epoch: 2, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.700 Vali Acc: 0.440 Test Loss: 0.700 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5600073337554932
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.701 Vali Acc: 0.430 Test Loss: 0.701 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.609804391860962
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.696 Vali Acc: 0.430 Test Loss: 0.696 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6584148406982422
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.695 Vali Acc: 0.480 Test Loss: 0.695 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5560927391052246
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.707 Vali Acc: 0.440 Test Loss: 0.707 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5952870845794678
Epoch: 7, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.691 Vali Acc: 0.440 Test Loss: 0.691 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5362238883972168
Epoch: 8, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.698 Vali Acc: 0.450 Test Loss: 0.698 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6021718978881836
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.700 Vali Acc: 0.470 Test Loss: 0.700 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5552787780761719
Epoch: 10, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.686 Vali Acc: 0.480 Test Loss: 0.686 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6009836196899414
Epoch: 11, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.699 Vali Acc: 0.480 Test Loss: 0.699 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 87858
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9442687034606934
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.3786976337432861
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.3657286167144775
Epoch: 3, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.703 Vali Acc: 0.530 Test Loss: 0.703 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.420036792755127
Epoch: 4, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.693 Vali Acc: 0.540 Test Loss: 0.693 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 1.5064582824707031
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.690 Vali Acc: 0.610 Test Loss: 0.690 Test Acc: 0.610
Validation loss decreased (-0.539993 --> -0.609993).  Saving model ...
Epoch: 6 cost time: 1.52201247215271
Epoch: 6, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.690 Vali Acc: 0.570 Test Loss: 0.690 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3513123989105225
Epoch: 7, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.693 Vali Acc: 0.550 Test Loss: 0.693 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.449941873550415
Epoch: 8, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.694 Vali Acc: 0.590 Test Loss: 0.694 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.539327621459961
Epoch: 9, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.693 Vali Acc: 0.560 Test Loss: 0.693 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4849646091461182
Epoch: 10, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0980820655822754
Epoch: 11, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.702 Vali Acc: 0.540 Test Loss: 0.702 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5655121803283691
Epoch: 12, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.709 Vali Acc: 0.540 Test Loss: 0.709 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4548165798187256
Epoch: 13, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5501329898834229
Epoch: 14, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5139069557189941
Epoch: 15, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.727 Vali Acc: 0.540 Test Loss: 0.727 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 294866
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7360403537750244
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.3727223873138428
Epoch: 2, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.700 Vali Acc: 0.430 Test Loss: 0.700 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3943171501159668
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.701 Vali Acc: 0.420 Test Loss: 0.701 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3520514965057373
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.695 Vali Acc: 0.430 Test Loss: 0.695 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3924815654754639
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.694 Vali Acc: 0.470 Test Loss: 0.694 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3353455066680908
Epoch: 6, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.707 Vali Acc: 0.440 Test Loss: 0.707 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4281227588653564
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.692 Vali Acc: 0.430 Test Loss: 0.692 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3306186199188232
Epoch: 8, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.699 Vali Acc: 0.440 Test Loss: 0.699 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3824021816253662
Epoch: 9, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.701 Vali Acc: 0.470 Test Loss: 0.701 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3200695514678955
Epoch: 10, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.687 Vali Acc: 0.480 Test Loss: 0.687 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2991418838500977
Epoch: 11, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.701 Vali Acc: 0.480 Test Loss: 0.701 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 87858
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5746026039123535
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.286590576171875
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2799439430236816
Epoch: 3, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.704 Vali Acc: 0.540 Test Loss: 0.704 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 1.2879586219787598
Epoch: 4, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.695 Vali Acc: 0.530 Test Loss: 0.695 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2939095497131348
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.691 Vali Acc: 0.550 Test Loss: 0.691 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.3319504261016846
Epoch: 6, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.690 Vali Acc: 0.560 Test Loss: 0.690 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 7 cost time: 1.27349853515625
Epoch: 7, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.693 Vali Acc: 0.560 Test Loss: 0.693 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2752835750579834
Epoch: 8, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.693 Vali Acc: 0.580 Test Loss: 0.693 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 9 cost time: 1.295051097869873
Epoch: 9, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.692 Vali Acc: 0.540 Test Loss: 0.692 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2404184341430664
Epoch: 10, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2671499252319336
Epoch: 11, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.698 Vali Acc: 0.510 Test Loss: 0.698 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.251577377319336
Epoch: 12, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.285104751586914
Epoch: 13, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.700 Vali Acc: 0.530 Test Loss: 0.700 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.309361219406128
Epoch: 14, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3010406494140625
Epoch: 15, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7872755527496338
Epoch: 16, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1891391277313232
Epoch: 17, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.713 Vali Acc: 0.550 Test Loss: 0.713 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.222447156906128
Epoch: 18, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.711 Vali Acc: 0.540 Test Loss: 0.711 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 294866
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.084482431411743
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.700 Vali Acc: 0.490 Test Loss: 0.700 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.16111421585083
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.699 Vali Acc: 0.450 Test Loss: 0.699 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.172163724899292
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.699 Vali Acc: 0.440 Test Loss: 0.699 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1274118423461914
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.693 Vali Acc: 0.450 Test Loss: 0.693 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2004520893096924
Epoch: 5, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 6 cost time: 1.2188293933868408
Epoch: 6, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.703 Vali Acc: 0.480 Test Loss: 0.703 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1756236553192139
Epoch: 7, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.691 Vali Acc: 0.500 Test Loss: 0.691 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 8 cost time: 1.1179049015045166
Epoch: 8, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.696 Vali Acc: 0.490 Test Loss: 0.696 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1127662658691406
Epoch: 9, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.697 Vali Acc: 0.480 Test Loss: 0.697 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.808293342590332
Epoch: 10, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.687 Vali Acc: 0.500 Test Loss: 0.687 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 11 cost time: 1.1747329235076904
Epoch: 11, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.697 Vali Acc: 0.490 Test Loss: 0.697 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.215031623840332
Epoch: 12, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.693 Vali Acc: 0.470 Test Loss: 0.693 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2232661247253418
Epoch: 13, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.691 Vali Acc: 0.520 Test Loss: 0.691 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 14 cost time: 1.2479207515716553
Epoch: 14, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1989309787750244
Epoch: 15, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.686 Vali Acc: 0.510 Test Loss: 0.686 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2013885974884033
Epoch: 16, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.695 Vali Acc: 0.510 Test Loss: 0.695 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2750980854034424
Epoch: 17, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.679 Vali Acc: 0.540 Test Loss: 0.679 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 18 cost time: 1.2900810241699219
Epoch: 18, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.694 Vali Acc: 0.510 Test Loss: 0.694 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2372932434082031
Epoch: 19, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2056834697723389
Epoch: 20, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2694151401519775
Epoch: 21, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.704 Vali Acc: 0.540 Test Loss: 0.704 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2228147983551025
Epoch: 22, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.696 Vali Acc: 0.540 Test Loss: 0.696 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2066192626953125
Epoch: 23, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.701 Vali Acc: 0.560 Test Loss: 0.701 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 24 cost time: 1.2832670211791992
Epoch: 24, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.701 Vali Acc: 0.550 Test Loss: 0.701 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2143604755401611
Epoch: 25, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.277815341949463
Epoch: 26, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2746357917785645
Epoch: 27, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.702 Vali Acc: 0.540 Test Loss: 0.702 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.18043851852417
Epoch: 28, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.703 Vali Acc: 0.530 Test Loss: 0.703 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2748775482177734
Epoch: 29, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.744 Vali Acc: 0.540 Test Loss: 0.744 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2511789798736572
Epoch: 30, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.702 Vali Acc: 0.570 Test Loss: 0.702 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 87858
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1126317977905273
Epoch: 1, Steps: 20 | Train Loss: 0.782 Vali Loss: 0.790 Vali Acc: 0.460 Test Loss: 0.790 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.7965202331542969
Epoch: 2, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.751 Vali Acc: 0.470 Test Loss: 0.751 Test Acc: 0.470
Validation loss decreased (-0.459992 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 1.797135829925537
Epoch: 3, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.725 Vali Acc: 0.450 Test Loss: 0.725 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.807619333267212
Epoch: 4, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.713 Vali Acc: 0.440 Test Loss: 0.713 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.897136926651001
Epoch: 5, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.708 Vali Acc: 0.440 Test Loss: 0.708 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8076579570770264
Epoch: 6, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.705 Vali Acc: 0.460 Test Loss: 0.705 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8418083190917969
Epoch: 7, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
Validation loss decreased (-0.469992 --> -0.499993).  Saving model ...
Epoch: 8 cost time: 1.8083453178405762
Epoch: 8, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.719 Vali Acc: 0.420 Test Loss: 0.719 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7329015731811523
Epoch: 9, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.727 Vali Acc: 0.450 Test Loss: 0.727 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8727915287017822
Epoch: 10, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.732 Vali Acc: 0.430 Test Loss: 0.732 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8414325714111328
Epoch: 11, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.730 Vali Acc: 0.480 Test Loss: 0.730 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8087575435638428
Epoch: 12, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.738 Vali Acc: 0.490 Test Loss: 0.738 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8236088752746582
Epoch: 13, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.742 Vali Acc: 0.450 Test Loss: 0.742 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.779341697692871
Epoch: 14, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.740 Vali Acc: 0.480 Test Loss: 0.740 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7198762893676758
Epoch: 15, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.768979787826538
Epoch: 16, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 17 cost time: 1.717895746231079
Epoch: 17, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.733 Vali Acc: 0.510 Test Loss: 0.733 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 18 cost time: 1.6569905281066895
Epoch: 18, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7343640327453613
Epoch: 19, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 20 cost time: 1.7311725616455078
Epoch: 20, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6972167491912842
Epoch: 21, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.794337272644043
Epoch: 22, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.759 Vali Acc: 0.510 Test Loss: 0.759 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7550649642944336
Epoch: 23, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 24 cost time: 1.7232863903045654
Epoch: 24, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.763 Vali Acc: 0.540 Test Loss: 0.763 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 25 cost time: 1.6946699619293213
Epoch: 25, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8284673690795898
Epoch: 26, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.807 Vali Acc: 0.520 Test Loss: 0.807 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7266607284545898
Epoch: 27, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.768 Vali Acc: 0.550 Test Loss: 0.768 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 28 cost time: 1.845848798751831
Epoch: 28, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.781 Vali Acc: 0.570 Test Loss: 0.781 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 29 cost time: 1.850090742111206
Epoch: 29, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8115854263305664
Epoch: 30, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.800 Vali Acc: 0.520 Test Loss: 0.800 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 148242
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.911179780960083
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.691 Vali Acc: 0.510 Test Loss: 0.691 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.5744216442108154
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5460686683654785
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.698 Vali Acc: 0.480 Test Loss: 0.698 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4829325675964355
Epoch: 4, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.701 Vali Acc: 0.480 Test Loss: 0.701 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6089823246002197
Epoch: 5, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.591890811920166
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.705 Vali Acc: 0.510 Test Loss: 0.705 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5945062637329102
Epoch: 7, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.708 Vali Acc: 0.480 Test Loss: 0.708 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5253517627716064
Epoch: 8, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.63680100440979
Epoch: 9, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5425984859466553
Epoch: 10, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5658879280090332
Epoch: 11, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 44722
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8800048828125
Epoch: 1, Steps: 20 | Train Loss: 0.782 Vali Loss: 0.790 Vali Acc: 0.460 Test Loss: 0.790 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.6050968170166016
Epoch: 2, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.751 Vali Acc: 0.470 Test Loss: 0.751 Test Acc: 0.470
Validation loss decreased (-0.459992 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 1.6249768733978271
Epoch: 3, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.725 Vali Acc: 0.440 Test Loss: 0.725 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6456265449523926
Epoch: 4, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.711 Vali Acc: 0.450 Test Loss: 0.711 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6084175109863281
Epoch: 5, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.706 Vali Acc: 0.450 Test Loss: 0.706 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5631370544433594
Epoch: 6, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.702 Vali Acc: 0.490 Test Loss: 0.702 Test Acc: 0.490
Validation loss decreased (-0.469992 --> -0.489993).  Saving model ...
Epoch: 7 cost time: 1.520592451095581
Epoch: 7, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 8 cost time: 1.6067173480987549
Epoch: 8, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.714 Vali Acc: 0.420 Test Loss: 0.714 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5779950618743896
Epoch: 9, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.720 Vali Acc: 0.460 Test Loss: 0.720 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5519006252288818
Epoch: 10, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.725 Vali Acc: 0.420 Test Loss: 0.725 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7453842163085938
Epoch: 11, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.567528247833252
Epoch: 12, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.608311653137207
Epoch: 13, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1159493923187256
Epoch: 14, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.729 Vali Acc: 0.470 Test Loss: 0.729 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.38503098487854
Epoch: 15, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4492924213409424
Epoch: 16, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 17 cost time: 1.5079600811004639
Epoch: 17, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 18 cost time: 1.5037078857421875
Epoch: 18, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.762 Vali Acc: 0.510 Test Loss: 0.762 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4692773818969727
Epoch: 19, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 20 cost time: 1.4629192352294922
Epoch: 20, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.764 Vali Acc: 0.510 Test Loss: 0.764 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.376551628112793
Epoch: 21, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 22 cost time: 1.312485933303833
Epoch: 22, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.729 Vali Acc: 0.540 Test Loss: 0.729 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.445101022720337
Epoch: 23, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.612396478652954
Epoch: 24, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.732 Vali Acc: 0.570 Test Loss: 0.732 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 25 cost time: 1.308973789215088
Epoch: 25, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.752 Vali Acc: 0.530 Test Loss: 0.752 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5161044597625732
Epoch: 26, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.780 Vali Acc: 0.570 Test Loss: 0.780 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4752240180969238
Epoch: 27, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.752 Vali Acc: 0.560 Test Loss: 0.752 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5014257431030273
Epoch: 28, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.792 Vali Acc: 0.550 Test Loss: 0.792 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.149716854095459
Epoch: 29, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.789 Vali Acc: 0.560 Test Loss: 0.789 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3223447799682617
Epoch: 30, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.764 Vali Acc: 0.560 Test Loss: 0.764 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 148242
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.713101387023926
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.691 Vali Acc: 0.510 Test Loss: 0.691 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.3705532550811768
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.325843334197998
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.698 Vali Acc: 0.480 Test Loss: 0.698 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.380852222442627
Epoch: 4, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.701 Vali Acc: 0.480 Test Loss: 0.701 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4755642414093018
Epoch: 5, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2807810306549072
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3668267726898193
Epoch: 7, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.709 Vali Acc: 0.470 Test Loss: 0.709 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3200185298919678
Epoch: 8, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.719 Vali Acc: 0.470 Test Loss: 0.719 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4218158721923828
Epoch: 9, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.365199089050293
Epoch: 10, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3814914226531982
Epoch: 11, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.715 Vali Acc: 0.470 Test Loss: 0.715 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 44722
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.6162943840026855
Epoch: 1, Steps: 20 | Train Loss: 0.782 Vali Loss: 0.789 Vali Acc: 0.460 Test Loss: 0.789 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.3119449615478516
Epoch: 2, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
Validation loss decreased (-0.459992 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 1.2367167472839355
Epoch: 3, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.724 Vali Acc: 0.440 Test Loss: 0.724 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3034470081329346
Epoch: 4, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.711 Vali Acc: 0.460 Test Loss: 0.711 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3123221397399902
Epoch: 5, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.705 Vali Acc: 0.440 Test Loss: 0.705 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3812592029571533
Epoch: 6, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
Validation loss decreased (-0.469992 --> -0.499993).  Saving model ...
Epoch: 7 cost time: 1.322516679763794
Epoch: 7, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 1.332430362701416
Epoch: 8, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.708 Vali Acc: 0.460 Test Loss: 0.708 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2676165103912354
Epoch: 9, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.712 Vali Acc: 0.480 Test Loss: 0.712 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.329854965209961
Epoch: 10, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.712 Vali Acc: 0.450 Test Loss: 0.712 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3433935642242432
Epoch: 11, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.711 Vali Acc: 0.520 Test Loss: 0.711 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1915884017944336
Epoch: 12, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2709629535675049
Epoch: 13, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.720 Vali Acc: 0.480 Test Loss: 0.720 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2552132606506348
Epoch: 14, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.720 Vali Acc: 0.520 Test Loss: 0.720 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2418131828308105
Epoch: 15, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2399146556854248
Epoch: 16, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2507450580596924
Epoch: 17, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 148242
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.5434114933013916
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.0899722576141357
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.695 Vali Acc: 0.460 Test Loss: 0.695 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.080857753753662
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.700 Vali Acc: 0.460 Test Loss: 0.700 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.140115737915039
Epoch: 4, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.702 Vali Acc: 0.490 Test Loss: 0.702 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.088365077972412
Epoch: 5, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.701 Vali Acc: 0.510 Test Loss: 0.701 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 6 cost time: 0.8434927463531494
Epoch: 6, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0659708976745605
Epoch: 7, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.709 Vali Acc: 0.470 Test Loss: 0.709 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1459400653839111
Epoch: 8, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.721 Vali Acc: 0.470 Test Loss: 0.721 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1513490676879883
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0894136428833008
Epoch: 10, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0776000022888184
Epoch: 11, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1746838092803955
Epoch: 12, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1144523620605469
Epoch: 13, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 14 cost time: 1.1478209495544434
Epoch: 14, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7030735015869141
Epoch: 15, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 16 cost time: 1.2235896587371826
Epoch: 16, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.711 Vali Acc: 0.520 Test Loss: 0.711 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0769963264465332
Epoch: 17, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.716 Vali Acc: 0.520 Test Loss: 0.716 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1686794757843018
Epoch: 18, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1573810577392578
Epoch: 19, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.708 Vali Acc: 0.540 Test Loss: 0.708 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 20 cost time: 1.166520357131958
Epoch: 20, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1951098442077637
Epoch: 21, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2463040351867676
Epoch: 22, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1219730377197266
Epoch: 23, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.725 Vali Acc: 0.560 Test Loss: 0.725 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 24 cost time: 1.2404303550720215
Epoch: 24, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.716 Vali Acc: 0.520 Test Loss: 0.716 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1878950595855713
Epoch: 25, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.702 Vali Acc: 0.560 Test Loss: 0.702 Test Acc: 0.560
Validation loss decreased (-0.559993 --> -0.559993).  Saving model ...
Epoch: 26 cost time: 1.2726547718048096
Epoch: 26, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.712 Vali Acc: 0.560 Test Loss: 0.712 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1208622455596924
Epoch: 27, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.708 Vali Acc: 0.560 Test Loss: 0.708 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1829862594604492
Epoch: 28, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1656358242034912
Epoch: 29, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.744 Vali Acc: 0.560 Test Loss: 0.744 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2153167724609375
Epoch: 30, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_FingerMovements_TimesNet_UEA_ftM_sl50_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 44722
model size : 0.34MB
