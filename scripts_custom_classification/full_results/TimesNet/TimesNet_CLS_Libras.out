Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 27.184736967086792
Epoch: 1, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.325 Vali Acc: 0.317 Test Loss: 2.325 Test Acc: 0.317
Validation loss decreased (inf --> -0.316643).  Saving model ...
Epoch: 2 cost time: 25.421817779541016
Epoch: 2, Steps: 12 | Train Loss: 2.017 Vali Loss: 1.641 Vali Acc: 0.511 Test Loss: 1.641 Test Acc: 0.511
Validation loss decreased (-0.316643 --> -0.511095).  Saving model ...
Epoch: 3 cost time: 26.314321756362915
Epoch: 3, Steps: 12 | Train Loss: 1.350 Vali Loss: 1.221 Vali Acc: 0.628 Test Loss: 1.221 Test Acc: 0.628
Validation loss decreased (-0.511095 --> -0.627766).  Saving model ...
Epoch: 4 cost time: 24.42151117324829
Epoch: 4, Steps: 12 | Train Loss: 0.919 Vali Loss: 0.962 Vali Acc: 0.650 Test Loss: 0.962 Test Acc: 0.650
Validation loss decreased (-0.627766 --> -0.649990).  Saving model ...
Epoch: 5 cost time: 23.33616042137146
Epoch: 5, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.839 Vali Acc: 0.717 Test Loss: 0.839 Test Acc: 0.717
Validation loss decreased (-0.649990 --> -0.716658).  Saving model ...
Epoch: 6 cost time: 21.447073221206665
Epoch: 6, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.766 Vali Acc: 0.717 Test Loss: 0.766 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716659).  Saving model ...
Epoch: 7 cost time: 23.40597939491272
Epoch: 7, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.655 Vali Acc: 0.772 Test Loss: 0.655 Test Acc: 0.772
Validation loss decreased (-0.716659 --> -0.772216).  Saving model ...
Epoch: 8 cost time: 25.308562517166138
Epoch: 8, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.696 Vali Acc: 0.733 Test Loss: 0.696 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.503373384475708
Epoch: 9, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.615 Vali Acc: 0.789 Test Loss: 0.615 Test Acc: 0.789
Validation loss decreased (-0.772216 --> -0.788883).  Saving model ...
Epoch: 10 cost time: 25.157449960708618
Epoch: 10, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.718 Vali Acc: 0.744 Test Loss: 0.718 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.127413749694824
Epoch: 11, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.676 Vali Acc: 0.772 Test Loss: 0.676 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 25.52590847015381
Epoch: 12, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.807 Vali Acc: 0.722 Test Loss: 0.807 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 24.865530014038086
Epoch: 13, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.871 Vali Acc: 0.772 Test Loss: 0.871 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 26.83956480026245
Epoch: 14, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.833 Vali Acc: 0.744 Test Loss: 0.833 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 24.33314085006714
Epoch: 15, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.661 Vali Acc: 0.789 Test Loss: 0.661 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 25.120238780975342
Epoch: 16, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.717 Vali Acc: 0.778 Test Loss: 0.717 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 25.114352464675903
Epoch: 17, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.676 Vali Acc: 0.817 Test Loss: 0.676 Test Acc: 0.817
Validation loss decreased (-0.788883 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 24.12286138534546
Epoch: 18, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.738 Vali Acc: 0.783 Test Loss: 0.738 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 26.328044176101685
Epoch: 19, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.615 Vali Acc: 0.828 Test Loss: 0.615 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
Epoch: 20 cost time: 25.870049238204956
Epoch: 20, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.675 Vali Acc: 0.811 Test Loss: 0.675 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 26.414941787719727
Epoch: 21, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 24.700241804122925
Epoch: 22, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 23 cost time: 24.101003646850586
Epoch: 23, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 24 cost time: 25.119518756866455
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.687 Vali Acc: 0.800 Test Loss: 0.687 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 24.625519514083862
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.800 Vali Acc: 0.800 Test Loss: 0.800 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 25.623319387435913
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 24.85718011856079
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.717 Vali Acc: 0.817 Test Loss: 0.717 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 25.179219722747803
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.600 Vali Acc: 0.839 Test Loss: 0.600 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 25.46744203567505
Epoch: 29, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 26.679030656814575
Epoch: 30, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 75070351
model size : 288.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 9.514388799667358
Epoch: 1, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.411 Vali Acc: 0.233 Test Loss: 2.411 Test Acc: 0.233
Validation loss decreased (inf --> -0.233309).  Saving model ...
Epoch: 2 cost time: 9.135771989822388
Epoch: 2, Steps: 12 | Train Loss: 2.047 Vali Loss: 1.736 Vali Acc: 0.483 Test Loss: 1.736 Test Acc: 0.483
Validation loss decreased (-0.233309 --> -0.483316).  Saving model ...
Epoch: 3 cost time: 9.312409162521362
Epoch: 3, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.295 Vali Acc: 0.594 Test Loss: 1.295 Test Acc: 0.594
Validation loss decreased (-0.483316 --> -0.594431).  Saving model ...
Epoch: 4 cost time: 8.725579500198364
Epoch: 4, Steps: 12 | Train Loss: 0.934 Vali Loss: 1.062 Vali Acc: 0.628 Test Loss: 1.062 Test Acc: 0.628
Validation loss decreased (-0.594431 --> -0.627767).  Saving model ...
Epoch: 5 cost time: 9.264250755310059
Epoch: 5, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.912 Vali Acc: 0.639 Test Loss: 0.912 Test Acc: 0.639
Validation loss decreased (-0.627767 --> -0.638880).  Saving model ...
Epoch: 6 cost time: 9.305996417999268
Epoch: 6, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.871 Vali Acc: 0.689 Test Loss: 0.871 Test Acc: 0.689
Validation loss decreased (-0.638880 --> -0.688880).  Saving model ...
Epoch: 7 cost time: 8.823184728622437
Epoch: 7, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.752 Vali Acc: 0.711 Test Loss: 0.752 Test Acc: 0.711
Validation loss decreased (-0.688880 --> -0.711104).  Saving model ...
Epoch: 8 cost time: 9.004142045974731
Epoch: 8, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.704 Vali Acc: 0.739 Test Loss: 0.704 Test Acc: 0.739
Validation loss decreased (-0.711104 --> -0.738882).  Saving model ...
Epoch: 9 cost time: 8.527446269989014
Epoch: 9, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.698 Vali Acc: 0.778 Test Loss: 0.698 Test Acc: 0.778
Validation loss decreased (-0.738882 --> -0.777771).  Saving model ...
Epoch: 10 cost time: 8.77742314338684
Epoch: 10, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.707 Vali Acc: 0.767 Test Loss: 0.707 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.8218355178833
Epoch: 11, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.660 Vali Acc: 0.772 Test Loss: 0.660 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.736904859542847
Epoch: 12, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.709 Vali Acc: 0.739 Test Loss: 0.709 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.188647508621216
Epoch: 13, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.690 Vali Acc: 0.778 Test Loss: 0.690 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 14 cost time: 7.882657527923584
Epoch: 14, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
Validation loss decreased (-0.777771 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 9.666377305984497
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.741 Vali Acc: 0.778 Test Loss: 0.741 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.168940782546997
Epoch: 16, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.710 Vali Acc: 0.767 Test Loss: 0.710 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.542277097702026
Epoch: 17, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.723 Vali Acc: 0.772 Test Loss: 0.723 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.292499542236328
Epoch: 18, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.772 Vali Acc: 0.789 Test Loss: 0.772 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.04606294631958
Epoch: 19, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.709 Vali Acc: 0.778 Test Loss: 0.709 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.510915279388428
Epoch: 20, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.721 Vali Acc: 0.811 Test Loss: 0.721 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 21 cost time: 8.303625345230103
Epoch: 21, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.680 Vali Acc: 0.822 Test Loss: 0.680 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 8.44749140739441
Epoch: 22, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.714 Vali Acc: 0.794 Test Loss: 0.714 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.16642165184021
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.731 Vali Acc: 0.817 Test Loss: 0.731 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 8.316259145736694
Epoch: 24, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.759 Vali Acc: 0.783 Test Loss: 0.759 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 8.205714225769043
Epoch: 25, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.787 Vali Acc: 0.778 Test Loss: 0.787 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 8.514647245407104
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 8.401230812072754
Epoch: 27, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.926 Vali Acc: 0.756 Test Loss: 0.926 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 8.135703802108765
Epoch: 28, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.992 Vali Acc: 0.744 Test Loss: 0.992 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 8.079760074615479
Epoch: 29, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.686 Vali Acc: 0.800 Test Loss: 0.686 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 8.85339617729187
Epoch: 30, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.713 Vali Acc: 0.822 Test Loss: 0.713 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 22114191
model size : 86.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 17.390285968780518
Epoch: 1, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.324 Vali Acc: 0.306 Test Loss: 2.324 Test Acc: 0.306
Validation loss decreased (inf --> -0.305532).  Saving model ...
Epoch: 2 cost time: 18.516218662261963
Epoch: 2, Steps: 12 | Train Loss: 2.020 Vali Loss: 1.638 Vali Acc: 0.511 Test Loss: 1.638 Test Acc: 0.511
Validation loss decreased (-0.305532 --> -0.511095).  Saving model ...
Epoch: 3 cost time: 18.622037887573242
Epoch: 3, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.218 Vali Acc: 0.622 Test Loss: 1.218 Test Acc: 0.622
Validation loss decreased (-0.511095 --> -0.622210).  Saving model ...
Epoch: 4 cost time: 19.039379835128784
Epoch: 4, Steps: 12 | Train Loss: 0.956 Vali Loss: 0.961 Vali Acc: 0.656 Test Loss: 0.961 Test Acc: 0.656
Validation loss decreased (-0.622210 --> -0.655546).  Saving model ...
Epoch: 5 cost time: 18.60643982887268
Epoch: 5, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.840 Vali Acc: 0.700 Test Loss: 0.840 Test Acc: 0.700
Validation loss decreased (-0.655546 --> -0.699992).  Saving model ...
Epoch: 6 cost time: 17.95665144920349
Epoch: 6, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.765 Vali Acc: 0.722 Test Loss: 0.765 Test Acc: 0.722
Validation loss decreased (-0.699992 --> -0.722215).  Saving model ...
Epoch: 7 cost time: 17.0228271484375
Epoch: 7, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.683 Vali Acc: 0.750 Test Loss: 0.683 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 17.628959894180298
Epoch: 8, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.722 Vali Acc: 0.711 Test Loss: 0.722 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.130401372909546
Epoch: 9, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.618 Vali Acc: 0.789 Test Loss: 0.618 Test Acc: 0.789
Validation loss decreased (-0.749993 --> -0.788883).  Saving model ...
Epoch: 10 cost time: 14.307706594467163
Epoch: 10, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.743 Vali Acc: 0.733 Test Loss: 0.743 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.113718032836914
Epoch: 11, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.707 Vali Acc: 0.783 Test Loss: 0.707 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.11604595184326
Epoch: 12, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.732 Vali Acc: 0.739 Test Loss: 0.732 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 19.578990697860718
Epoch: 13, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.728 Vali Acc: 0.756 Test Loss: 0.728 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 19.609617233276367
Epoch: 14, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.591 Vali Acc: 0.783 Test Loss: 0.591 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 18.60621404647827
Epoch: 15, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.831 Vali Acc: 0.717 Test Loss: 0.831 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 18.973140478134155
Epoch: 16, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
Validation loss decreased (-0.788883 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 16.946685791015625
Epoch: 17, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 18.080122709274292
Epoch: 18, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.680 Vali Acc: 0.789 Test Loss: 0.680 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.98426580429077
Epoch: 19, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.734 Vali Acc: 0.806 Test Loss: 0.734 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 18.657663345336914
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.717 Vali Acc: 0.817 Test Loss: 0.717 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 19.435824871063232
Epoch: 21, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.705 Vali Acc: 0.817 Test Loss: 0.705 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 17.979958295822144
Epoch: 22, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.697 Vali Acc: 0.828 Test Loss: 0.697 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 21.446218013763428
Epoch: 23, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.697 Vali Acc: 0.822 Test Loss: 0.697 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 20.196067571640015
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.698 Vali Acc: 0.828 Test Loss: 0.698 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 20.611202001571655
Epoch: 25, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.686 Vali Acc: 0.822 Test Loss: 0.686 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 21.30875325202942
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.676 Vali Acc: 0.822 Test Loss: 0.676 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 75070351
model size : 288.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 9.648397445678711
Epoch: 1, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.409 Vali Acc: 0.244 Test Loss: 2.409 Test Acc: 0.244
Validation loss decreased (inf --> -0.244420).  Saving model ...
Epoch: 2 cost time: 7.90747857093811
Epoch: 2, Steps: 12 | Train Loss: 2.048 Vali Loss: 1.733 Vali Acc: 0.472 Test Loss: 1.733 Test Acc: 0.472
Validation loss decreased (-0.244420 --> -0.472205).  Saving model ...
Epoch: 3 cost time: 7.381157398223877
Epoch: 3, Steps: 12 | Train Loss: 1.353 Vali Loss: 1.291 Vali Acc: 0.594 Test Loss: 1.291 Test Acc: 0.594
Validation loss decreased (-0.472205 --> -0.594432).  Saving model ...
Epoch: 4 cost time: 7.193793058395386
Epoch: 4, Steps: 12 | Train Loss: 0.944 Vali Loss: 1.061 Vali Acc: 0.633 Test Loss: 1.061 Test Acc: 0.633
Validation loss decreased (-0.594432 --> -0.633323).  Saving model ...
Epoch: 5 cost time: 7.547878742218018
Epoch: 5, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.915 Vali Acc: 0.644 Test Loss: 0.915 Test Acc: 0.644
Validation loss decreased (-0.633323 --> -0.644435).  Saving model ...
Epoch: 6 cost time: 7.946057081222534
Epoch: 6, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.861 Vali Acc: 0.694 Test Loss: 0.861 Test Acc: 0.694
Validation loss decreased (-0.644435 --> -0.694436).  Saving model ...
Epoch: 7 cost time: 7.644057035446167
Epoch: 7, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.745 Vali Acc: 0.728 Test Loss: 0.745 Test Acc: 0.728
Validation loss decreased (-0.694436 --> -0.727770).  Saving model ...
Epoch: 8 cost time: 7.209208965301514
Epoch: 8, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.699 Vali Acc: 0.744 Test Loss: 0.699 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744437).  Saving model ...
Epoch: 9 cost time: 7.484758138656616
Epoch: 9, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.696 Vali Acc: 0.767 Test Loss: 0.696 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766660).  Saving model ...
Epoch: 10 cost time: 7.329813718795776
Epoch: 10, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.715 Vali Acc: 0.750 Test Loss: 0.715 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.513965129852295
Epoch: 11, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.670 Vali Acc: 0.761 Test Loss: 0.670 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.266497850418091
Epoch: 12, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.720 Vali Acc: 0.767 Test Loss: 0.720 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.514859199523926
Epoch: 13, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.705 Vali Acc: 0.778 Test Loss: 0.705 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 14 cost time: 7.509894371032715
Epoch: 14, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.722 Vali Acc: 0.783 Test Loss: 0.722 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783326).  Saving model ...
Epoch: 15 cost time: 7.426068544387817
Epoch: 15, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.756 Vali Acc: 0.767 Test Loss: 0.756 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.902646064758301
Epoch: 16, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.716 Vali Acc: 0.783 Test Loss: 0.716 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 17 cost time: 8.152864217758179
Epoch: 17, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.761 Vali Acc: 0.778 Test Loss: 0.761 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.417691230773926
Epoch: 18, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.698 Vali Acc: 0.767 Test Loss: 0.698 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.377407789230347
Epoch: 19, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.741 Vali Acc: 0.783 Test Loss: 0.741 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.6971259117126465
Epoch: 20, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.767 Vali Acc: 0.772 Test Loss: 0.767 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 8.115482330322266
Epoch: 21, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.982 Vali Acc: 0.756 Test Loss: 0.982 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.892185926437378
Epoch: 22, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.647 Vali Acc: 0.800 Test Loss: 0.647 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 7.4441306591033936
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.968 Vali Acc: 0.767 Test Loss: 0.968 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.689760208129883
Epoch: 24, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.772 Vali Acc: 0.772 Test Loss: 0.772 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.7502970695495605
Epoch: 25, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.781 Vali Acc: 0.772 Test Loss: 0.781 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.847223997116089
Epoch: 26, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.785 Vali Acc: 0.794 Test Loss: 0.785 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.496524095535278
Epoch: 27, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.906 Vali Acc: 0.772 Test Loss: 0.906 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.675970792770386
Epoch: 28, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.813 Vali Acc: 0.772 Test Loss: 0.813 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.507017135620117
Epoch: 29, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.711 Vali Acc: 0.811 Test Loss: 0.711 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811104).  Saving model ...
Epoch: 30 cost time: 7.232642889022827
Epoch: 30, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.703 Vali Acc: 0.817 Test Loss: 0.703 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 22114191
model size : 86.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 13.855499267578125
Epoch: 1, Steps: 12 | Train Loss: 2.718 Vali Loss: 2.439 Vali Acc: 0.244 Test Loss: 2.439 Test Acc: 0.244
Validation loss decreased (inf --> -0.244420).  Saving model ...
Epoch: 2 cost time: 11.116639375686646
Epoch: 2, Steps: 12 | Train Loss: 2.207 Vali Loss: 1.904 Vali Acc: 0.489 Test Loss: 1.904 Test Acc: 0.489
Validation loss decreased (-0.244420 --> -0.488870).  Saving model ...
Epoch: 3 cost time: 12.075212717056274
Epoch: 3, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.493 Vali Acc: 0.578 Test Loss: 1.493 Test Acc: 0.578
Validation loss decreased (-0.488870 --> -0.577763).  Saving model ...
Epoch: 4 cost time: 12.036377668380737
Epoch: 4, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.196 Vali Acc: 0.606 Test Loss: 1.196 Test Acc: 0.606
Validation loss decreased (-0.577763 --> -0.605544).  Saving model ...
Epoch: 5 cost time: 11.34914779663086
Epoch: 5, Steps: 12 | Train Loss: 0.926 Vali Loss: 1.042 Vali Acc: 0.606 Test Loss: 1.042 Test Acc: 0.606
Validation loss decreased (-0.605544 --> -0.605545).  Saving model ...
Epoch: 6 cost time: 12.056309700012207
Epoch: 6, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.982 Vali Acc: 0.656 Test Loss: 0.982 Test Acc: 0.656
Validation loss decreased (-0.605545 --> -0.655546).  Saving model ...
Epoch: 7 cost time: 12.182936191558838
Epoch: 7, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.845 Vali Acc: 0.689 Test Loss: 0.845 Test Acc: 0.689
Validation loss decreased (-0.655546 --> -0.688880).  Saving model ...
Epoch: 8 cost time: 12.11060619354248
Epoch: 8, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.891 Vali Acc: 0.678 Test Loss: 0.891 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.855591535568237
Epoch: 9, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.720 Vali Acc: 0.750 Test Loss: 0.720 Test Acc: 0.750
Validation loss decreased (-0.688880 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 12.249526262283325
Epoch: 10, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.783 Vali Acc: 0.761 Test Loss: 0.783 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761103).  Saving model ...
Epoch: 11 cost time: 12.686107635498047
Epoch: 11, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.781 Vali Acc: 0.756 Test Loss: 0.781 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.44254183769226
Epoch: 12, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.886 Vali Acc: 0.728 Test Loss: 0.886 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.869567155838013
Epoch: 13, Steps: 12 | Train Loss: 0.276 Vali Loss: 1.321 Vali Acc: 0.694 Test Loss: 1.321 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.149622440338135
Epoch: 14, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.872 Vali Acc: 0.733 Test Loss: 0.872 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.141732931137085
Epoch: 15, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.895 Vali Acc: 0.756 Test Loss: 0.895 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.397446393966675
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.842 Vali Acc: 0.711 Test Loss: 0.842 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.182535409927368
Epoch: 17, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.873 Vali Acc: 0.722 Test Loss: 0.873 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.617196559906006
Epoch: 18, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.921 Vali Acc: 0.728 Test Loss: 0.921 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.469318389892578
Epoch: 19, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.933 Vali Acc: 0.722 Test Loss: 0.933 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.242511987686157
Epoch: 20, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.763 Vali Acc: 0.789 Test Loss: 0.763 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788881).  Saving model ...
Epoch: 21 cost time: 11.821376085281372
Epoch: 21, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.707 Vali Acc: 0.789 Test Loss: 0.707 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788882).  Saving model ...
Epoch: 22 cost time: 12.354977369308472
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.006 Vali Acc: 0.733 Test Loss: 1.006 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 11.464905023574829
Epoch: 23, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.987 Vali Acc: 0.739 Test Loss: 0.987 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 12.337740421295166
Epoch: 24, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.086 Vali Acc: 0.739 Test Loss: 1.086 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 12.248042583465576
Epoch: 25, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.993 Vali Acc: 0.772 Test Loss: 0.993 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 10.998159646987915
Epoch: 26, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.676 Vali Acc: 0.806 Test Loss: 0.676 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 27 cost time: 11.616875648498535
Epoch: 27, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.935 Vali Acc: 0.772 Test Loss: 0.935 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 11.916579484939575
Epoch: 28, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.960 Vali Acc: 0.761 Test Loss: 0.960 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 11.582112550735474
Epoch: 29, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.820 Vali Acc: 0.767 Test Loss: 0.820 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 11.423553228378296
Epoch: 30, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.867 Vali Acc: 0.778 Test Loss: 0.867 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 75070351
model size : 288.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.2995030879974365
Epoch: 1, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.502 Vali Acc: 0.161 Test Loss: 2.502 Test Acc: 0.161
Validation loss decreased (inf --> -0.161086).  Saving model ...
Epoch: 2 cost time: 4.802964448928833
Epoch: 2, Steps: 12 | Train Loss: 2.237 Vali Loss: 1.969 Vali Acc: 0.450 Test Loss: 1.969 Test Acc: 0.450
Validation loss decreased (-0.161086 --> -0.449980).  Saving model ...
Epoch: 3 cost time: 3.5649259090423584
Epoch: 3, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.558 Vali Acc: 0.522 Test Loss: 1.558 Test Acc: 0.522
Validation loss decreased (-0.449980 --> -0.522207).  Saving model ...
Epoch: 4 cost time: 4.32348108291626
Epoch: 4, Steps: 12 | Train Loss: 1.193 Vali Loss: 1.290 Vali Acc: 0.567 Test Loss: 1.290 Test Acc: 0.567
Validation loss decreased (-0.522207 --> -0.566654).  Saving model ...
Epoch: 5 cost time: 4.185956001281738
Epoch: 5, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.121 Vali Acc: 0.589 Test Loss: 1.121 Test Acc: 0.589
Validation loss decreased (-0.566654 --> -0.588878).  Saving model ...
Epoch: 6 cost time: 4.071325778961182
Epoch: 6, Steps: 12 | Train Loss: 0.838 Vali Loss: 1.098 Vali Acc: 0.628 Test Loss: 1.098 Test Acc: 0.628
Validation loss decreased (-0.588878 --> -0.627767).  Saving model ...
Epoch: 7 cost time: 4.201709747314453
Epoch: 7, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.982 Vali Acc: 0.639 Test Loss: 0.982 Test Acc: 0.639
Validation loss decreased (-0.627767 --> -0.638879).  Saving model ...
Epoch: 8 cost time: 3.358299970626831
Epoch: 8, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.894 Vali Acc: 0.694 Test Loss: 0.894 Test Acc: 0.694
Validation loss decreased (-0.638879 --> -0.694436).  Saving model ...
Epoch: 9 cost time: 4.163114309310913
Epoch: 9, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.902 Vali Acc: 0.683 Test Loss: 0.902 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.009793281555176
Epoch: 10, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.800 Vali Acc: 0.733 Test Loss: 0.800 Test Acc: 0.733
Validation loss decreased (-0.694436 --> -0.733325).  Saving model ...
Epoch: 11 cost time: 4.520028352737427
Epoch: 11, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.732 Vali Acc: 0.761 Test Loss: 0.732 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761104).  Saving model ...
Epoch: 12 cost time: 3.882873058319092
Epoch: 12, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.723 Vali Acc: 0.783 Test Loss: 0.723 Test Acc: 0.783
Validation loss decreased (-0.761104 --> -0.783326).  Saving model ...
Epoch: 13 cost time: 4.286390066146851
Epoch: 13, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.786 Vali Acc: 0.783 Test Loss: 0.786 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.416761875152588
Epoch: 14, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.792 Vali Acc: 0.756 Test Loss: 0.792 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.784691095352173
Epoch: 15, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.780 Vali Acc: 0.778 Test Loss: 0.780 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.002979040145874
Epoch: 16, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.759 Vali Acc: 0.772 Test Loss: 0.759 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.409130334854126
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.778 Vali Acc: 0.794 Test Loss: 0.778 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 18 cost time: 4.092637300491333
Epoch: 18, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.776 Vali Acc: 0.794 Test Loss: 0.776 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 19 cost time: 4.768079519271851
Epoch: 19, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.743 Vali Acc: 0.811 Test Loss: 0.743 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 20 cost time: 4.373452663421631
Epoch: 20, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.469372272491455
Epoch: 21, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.898 Vali Acc: 0.783 Test Loss: 0.898 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.058974027633667
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.665313720703125
Epoch: 23, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.829 Vali Acc: 0.789 Test Loss: 0.829 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.573277235031128
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.758 Vali Acc: 0.772 Test Loss: 0.758 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.072879791259766
Epoch: 25, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.794 Vali Acc: 0.783 Test Loss: 0.794 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.33379864692688
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.801 Vali Acc: 0.800 Test Loss: 0.801 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.093873739242554
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.848 Vali Acc: 0.794 Test Loss: 0.848 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.828748464584351
Epoch: 28, Steps: 12 | Train Loss: 0.193 Vali Loss: 1.103 Vali Acc: 0.756 Test Loss: 1.103 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.421637058258057
Epoch: 29, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.855 Vali Acc: 0.772 Test Loss: 0.855 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 22114191
model size : 86.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 16.4603750705719
Epoch: 1, Steps: 12 | Train Loss: 2.744 Vali Loss: 2.437 Vali Acc: 0.272 Test Loss: 2.437 Test Acc: 0.272
Validation loss decreased (inf --> -0.272198).  Saving model ...
Epoch: 2 cost time: 13.858013153076172
Epoch: 2, Steps: 12 | Train Loss: 2.116 Vali Loss: 1.800 Vali Acc: 0.511 Test Loss: 1.800 Test Acc: 0.511
Validation loss decreased (-0.272198 --> -0.511093).  Saving model ...
Epoch: 3 cost time: 14.537712335586548
Epoch: 3, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.394 Vali Acc: 0.544 Test Loss: 1.394 Test Acc: 0.544
Validation loss decreased (-0.511093 --> -0.544431).  Saving model ...
Epoch: 4 cost time: 14.22146725654602
Epoch: 4, Steps: 12 | Train Loss: 1.025 Vali Loss: 1.070 Vali Acc: 0.639 Test Loss: 1.070 Test Acc: 0.639
Validation loss decreased (-0.544431 --> -0.638878).  Saving model ...
Epoch: 5 cost time: 13.875291347503662
Epoch: 5, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.878 Vali Acc: 0.689 Test Loss: 0.878 Test Acc: 0.689
Validation loss decreased (-0.638878 --> -0.688880).  Saving model ...
Epoch: 6 cost time: 14.98949933052063
Epoch: 6, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.774 Vali Acc: 0.717 Test Loss: 0.774 Test Acc: 0.717
Validation loss decreased (-0.688880 --> -0.716659).  Saving model ...
Epoch: 7 cost time: 14.569166898727417
Epoch: 7, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.723 Vali Acc: 0.733 Test Loss: 0.723 Test Acc: 0.733
Validation loss decreased (-0.716659 --> -0.733326).  Saving model ...
Epoch: 8 cost time: 13.401851415634155
Epoch: 8, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.689 Vali Acc: 0.756 Test Loss: 0.689 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 15.392826795578003
Epoch: 9, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.667 Vali Acc: 0.750 Test Loss: 0.667 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.094895601272583
Epoch: 10, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.680 Vali Acc: 0.778 Test Loss: 0.680 Test Acc: 0.778
Validation loss decreased (-0.755549 --> -0.777771).  Saving model ...
Epoch: 11 cost time: 16.529541730880737
Epoch: 11, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.675 Vali Acc: 0.789 Test Loss: 0.675 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 12 cost time: 14.676039934158325
Epoch: 12, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.676 Vali Acc: 0.778 Test Loss: 0.676 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.75853681564331
Epoch: 13, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.784 Vali Acc: 0.739 Test Loss: 0.784 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 14.280113220214844
Epoch: 14, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.718 Vali Acc: 0.800 Test Loss: 0.718 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 13.566879272460938
Epoch: 15, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.803 Vali Acc: 0.733 Test Loss: 0.803 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.649786233901978
Epoch: 16, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.686 Vali Acc: 0.806 Test Loss: 0.686 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 17 cost time: 14.289515495300293
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.687 Vali Acc: 0.789 Test Loss: 0.687 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 15.20791220664978
Epoch: 18, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.668 Vali Acc: 0.811 Test Loss: 0.668 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811104).  Saving model ...
Epoch: 19 cost time: 15.22846269607544
Epoch: 19, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.624 Vali Acc: 0.806 Test Loss: 0.624 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 14.5998215675354
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.709 Vali Acc: 0.778 Test Loss: 0.709 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 16.38646101951599
Epoch: 21, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.702 Vali Acc: 0.817 Test Loss: 0.702 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 22 cost time: 15.270911931991577
Epoch: 22, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.839 Vali Acc: 0.806 Test Loss: 0.839 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 15.597795486450195
Epoch: 23, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.730 Vali Acc: 0.811 Test Loss: 0.730 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 15.369336366653442
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.632 Vali Acc: 0.828 Test Loss: 0.632 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 25 cost time: 14.553981304168701
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.762 Vali Acc: 0.828 Test Loss: 0.762 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 15.81789255142212
Epoch: 26, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.760 Vali Acc: 0.822 Test Loss: 0.760 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 14.453732252120972
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.682 Vali Acc: 0.828 Test Loss: 0.682 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 15.699249982833862
Epoch: 28, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.809 Vali Acc: 0.778 Test Loss: 0.809 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 15.054741859436035
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.725 Vali Acc: 0.811 Test Loss: 0.725 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 14.796588659286499
Epoch: 30, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.673 Vali Acc: 0.828 Test Loss: 0.673 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 37580687
model size : 145.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.0831937789917
Epoch: 1, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.385 Vali Acc: 0.328 Test Loss: 2.385 Test Acc: 0.328
Validation loss decreased (inf --> -0.327754).  Saving model ...
Epoch: 2 cost time: 5.484464406967163
Epoch: 2, Steps: 12 | Train Loss: 2.047 Vali Loss: 1.778 Vali Acc: 0.533 Test Loss: 1.778 Test Acc: 0.533
Validation loss decreased (-0.327754 --> -0.533316).  Saving model ...
Epoch: 3 cost time: 6.24429988861084
Epoch: 3, Steps: 12 | Train Loss: 1.474 Vali Loss: 1.367 Vali Acc: 0.600 Test Loss: 1.367 Test Acc: 0.600
Validation loss decreased (-0.533316 --> -0.599986).  Saving model ...
Epoch: 4 cost time: 6.232767820358276
Epoch: 4, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.094 Vali Acc: 0.639 Test Loss: 1.094 Test Acc: 0.639
Validation loss decreased (-0.599986 --> -0.638878).  Saving model ...
Epoch: 5 cost time: 6.189974308013916
Epoch: 5, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.905 Vali Acc: 0.706 Test Loss: 0.905 Test Acc: 0.706
Validation loss decreased (-0.638878 --> -0.705547).  Saving model ...
Epoch: 6 cost time: 5.751496315002441
Epoch: 6, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.832 Vali Acc: 0.700 Test Loss: 0.832 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.694134950637817
Epoch: 7, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.747 Vali Acc: 0.717 Test Loss: 0.747 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716659).  Saving model ...
Epoch: 8 cost time: 4.955135822296143
Epoch: 8, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.690 Vali Acc: 0.761 Test Loss: 0.690 Test Acc: 0.761
Validation loss decreased (-0.716659 --> -0.761104).  Saving model ...
Epoch: 9 cost time: 5.4671471118927
Epoch: 9, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.691 Vali Acc: 0.789 Test Loss: 0.691 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788882).  Saving model ...
Epoch: 10 cost time: 5.840338706970215
Epoch: 10, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.701 Vali Acc: 0.750 Test Loss: 0.701 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.645676851272583
Epoch: 11, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.746 Vali Acc: 0.744 Test Loss: 0.746 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.83437705039978
Epoch: 12, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.698 Vali Acc: 0.739 Test Loss: 0.698 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.971015214920044
Epoch: 13, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.661 Vali Acc: 0.794 Test Loss: 0.661 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 14 cost time: 5.620117902755737
Epoch: 14, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.776 Vali Acc: 0.772 Test Loss: 0.776 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.802954196929932
Epoch: 15, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.701 Vali Acc: 0.794 Test Loss: 0.701 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.570816278457642
Epoch: 16, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.737 Vali Acc: 0.778 Test Loss: 0.737 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.216708421707153
Epoch: 17, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.856 Vali Acc: 0.728 Test Loss: 0.856 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.033580303192139
Epoch: 18, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.738 Vali Acc: 0.794 Test Loss: 0.738 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.55197286605835
Epoch: 19, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.749 Vali Acc: 0.806 Test Loss: 0.749 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805548).  Saving model ...
Epoch: 20 cost time: 5.559166193008423
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.704 Vali Acc: 0.778 Test Loss: 0.704 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.233802318572998
Epoch: 21, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.749 Vali Acc: 0.811 Test Loss: 0.749 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 22 cost time: 6.594754695892334
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.743 Vali Acc: 0.817 Test Loss: 0.743 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816659).  Saving model ...
Epoch: 23 cost time: 5.666009902954102
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.702 Vali Acc: 0.817 Test Loss: 0.702 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 24 cost time: 5.496109485626221
Epoch: 24, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833326).  Saving model ...
Epoch: 25 cost time: 5.42562460899353
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.721 Vali Acc: 0.833 Test Loss: 0.721 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.864734172821045
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.740 Vali Acc: 0.806 Test Loss: 0.740 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.439598560333252
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.748 Vali Acc: 0.817 Test Loss: 0.748 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.589421987533569
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.740 Vali Acc: 0.817 Test Loss: 0.740 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.118100643157959
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.822 Test Loss: 0.717 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.525498390197754
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.721 Vali Acc: 0.817 Test Loss: 0.721 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 11102095
model size : 44.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 12.57394003868103
Epoch: 1, Steps: 12 | Train Loss: 2.744 Vali Loss: 2.435 Vali Acc: 0.272 Test Loss: 2.435 Test Acc: 0.272
Validation loss decreased (inf --> -0.272198).  Saving model ...
Epoch: 2 cost time: 10.560807704925537
Epoch: 2, Steps: 12 | Train Loss: 2.117 Vali Loss: 1.797 Vali Acc: 0.511 Test Loss: 1.797 Test Acc: 0.511
Validation loss decreased (-0.272198 --> -0.511093).  Saving model ...
Epoch: 3 cost time: 10.463263511657715
Epoch: 3, Steps: 12 | Train Loss: 1.507 Vali Loss: 1.391 Vali Acc: 0.544 Test Loss: 1.391 Test Acc: 0.544
Validation loss decreased (-0.511093 --> -0.544431).  Saving model ...
Epoch: 4 cost time: 10.60892915725708
Epoch: 4, Steps: 12 | Train Loss: 1.031 Vali Loss: 1.070 Vali Acc: 0.633 Test Loss: 1.070 Test Acc: 0.633
Validation loss decreased (-0.544431 --> -0.633323).  Saving model ...
Epoch: 5 cost time: 10.66446828842163
Epoch: 5, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.884 Vali Acc: 0.672 Test Loss: 0.884 Test Acc: 0.672
Validation loss decreased (-0.633323 --> -0.672213).  Saving model ...
Epoch: 6 cost time: 10.805775880813599
Epoch: 6, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.774 Vali Acc: 0.706 Test Loss: 0.774 Test Acc: 0.706
Validation loss decreased (-0.672213 --> -0.705548).  Saving model ...
Epoch: 7 cost time: 9.619925022125244
Epoch: 7, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.717 Vali Acc: 0.744 Test Loss: 0.717 Test Acc: 0.744
Validation loss decreased (-0.705548 --> -0.744437).  Saving model ...
Epoch: 8 cost time: 12.696775197982788
Epoch: 8, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.687 Vali Acc: 0.750 Test Loss: 0.687 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 11.493910551071167
Epoch: 9, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.712 Vali Acc: 0.728 Test Loss: 0.712 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.058539867401123
Epoch: 10, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.675 Vali Acc: 0.778 Test Loss: 0.675 Test Acc: 0.778
Validation loss decreased (-0.749993 --> -0.777771).  Saving model ...
Epoch: 11 cost time: 12.440705299377441
Epoch: 11, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.730 Vali Acc: 0.783 Test Loss: 0.730 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783326).  Saving model ...
Epoch: 12 cost time: 11.08037543296814
Epoch: 12, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.627 Vali Acc: 0.778 Test Loss: 0.627 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.55647611618042
Epoch: 13, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.736 Vali Acc: 0.772 Test Loss: 0.736 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.753498077392578
Epoch: 14, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.878 Vali Acc: 0.717 Test Loss: 0.878 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.52391529083252
Epoch: 15, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.755 Vali Acc: 0.800 Test Loss: 0.755 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 11.907564640045166
Epoch: 16, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.757 Vali Acc: 0.783 Test Loss: 0.757 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.175850629806519
Epoch: 17, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.797 Vali Acc: 0.789 Test Loss: 0.797 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.552411556243896
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.763 Vali Acc: 0.789 Test Loss: 0.763 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.91190218925476
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.768 Vali Acc: 0.822 Test Loss: 0.768 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822215).  Saving model ...
Epoch: 20 cost time: 11.184036016464233
Epoch: 20, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.762 Vali Acc: 0.806 Test Loss: 0.762 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 11.963497638702393
Epoch: 21, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.790 Vali Acc: 0.800 Test Loss: 0.790 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 12.137520790100098
Epoch: 22, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.810 Vali Acc: 0.789 Test Loss: 0.810 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 11.488935232162476
Epoch: 23, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.877 Vali Acc: 0.817 Test Loss: 0.877 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 12.408275604248047
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.020 Vali Acc: 0.789 Test Loss: 1.020 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 11.637812852859497
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 12.014809608459473
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.815 Vali Acc: 0.817 Test Loss: 0.815 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 12.662115097045898
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.925 Vali Acc: 0.772 Test Loss: 0.925 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 11.623193502426147
Epoch: 28, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.859 Vali Acc: 0.806 Test Loss: 0.859 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 12.744041204452515
Epoch: 29, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.761 Vali Acc: 0.822 Test Loss: 0.761 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 30 cost time: 11.492361545562744
Epoch: 30, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.758 Vali Acc: 0.833 Test Loss: 0.758 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 37580687
model size : 145.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.012955188751221
Epoch: 1, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.383 Vali Acc: 0.328 Test Loss: 2.383 Test Acc: 0.328
Validation loss decreased (inf --> -0.327754).  Saving model ...
Epoch: 2 cost time: 5.029192686080933
Epoch: 2, Steps: 12 | Train Loss: 2.050 Vali Loss: 1.771 Vali Acc: 0.539 Test Loss: 1.771 Test Acc: 0.539
Validation loss decreased (-0.327754 --> -0.538871).  Saving model ...
Epoch: 3 cost time: 5.022488117218018
Epoch: 3, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.360 Vali Acc: 0.611 Test Loss: 1.360 Test Acc: 0.611
Validation loss decreased (-0.538871 --> -0.611098).  Saving model ...
Epoch: 4 cost time: 5.151792049407959
Epoch: 4, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.087 Vali Acc: 0.628 Test Loss: 1.087 Test Acc: 0.628
Validation loss decreased (-0.611098 --> -0.627767).  Saving model ...
Epoch: 5 cost time: 5.377649784088135
Epoch: 5, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.903 Vali Acc: 0.706 Test Loss: 0.903 Test Acc: 0.706
Validation loss decreased (-0.627767 --> -0.705547).  Saving model ...
Epoch: 6 cost time: 5.33901834487915
Epoch: 6, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.822 Vali Acc: 0.706 Test Loss: 0.822 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 7 cost time: 5.250833034515381
Epoch: 7, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.741 Vali Acc: 0.722 Test Loss: 0.741 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722215).  Saving model ...
Epoch: 8 cost time: 5.140091180801392
Epoch: 8, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.692 Vali Acc: 0.750 Test Loss: 0.692 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 5.179384708404541
Epoch: 9, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.702 Vali Acc: 0.794 Test Loss: 0.702 Test Acc: 0.794
Validation loss decreased (-0.749993 --> -0.794437).  Saving model ...
Epoch: 10 cost time: 5.2759318351745605
Epoch: 10, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.695 Vali Acc: 0.750 Test Loss: 0.695 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.901910066604614
Epoch: 11, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.694 Vali Acc: 0.733 Test Loss: 0.694 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.313649892807007
Epoch: 12, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.701 Vali Acc: 0.750 Test Loss: 0.701 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.211002826690674
Epoch: 13, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.07253885269165
Epoch: 14, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.764 Vali Acc: 0.783 Test Loss: 0.764 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.220031023025513
Epoch: 15, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.667 Vali Acc: 0.794 Test Loss: 0.667 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 16 cost time: 4.818202972412109
Epoch: 16, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.804 Vali Acc: 0.767 Test Loss: 0.804 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.392483711242676
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.137228965759277
Epoch: 18, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.682 Vali Acc: 0.778 Test Loss: 0.682 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.977476119995117
Epoch: 19, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.741 Vali Acc: 0.783 Test Loss: 0.741 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.3113694190979
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.735 Vali Acc: 0.767 Test Loss: 0.735 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.467694044113159
Epoch: 21, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.746 Vali Acc: 0.783 Test Loss: 0.746 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.368159294128418
Epoch: 22, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.791 Vali Acc: 0.794 Test Loss: 0.791 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.070417881011963
Epoch: 23, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.751 Vali Acc: 0.789 Test Loss: 0.751 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.028798341751099
Epoch: 24, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.713 Vali Acc: 0.817 Test Loss: 0.713 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816660).  Saving model ...
Epoch: 25 cost time: 5.4873785972595215
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.796 Vali Acc: 0.806 Test Loss: 0.796 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.563197135925293
Epoch: 26, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.838 Vali Acc: 0.800 Test Loss: 0.838 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.155797719955444
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.824 Vali Acc: 0.794 Test Loss: 0.824 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.917852878570557
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.810 Vali Acc: 0.811 Test Loss: 0.810 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.543163061141968
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.798 Vali Acc: 0.811 Test Loss: 0.798 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.230316162109375
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.804 Vali Acc: 0.811 Test Loss: 0.804 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 11102095
model size : 44.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.868654012680054
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.503 Vali Acc: 0.200 Test Loss: 2.503 Test Acc: 0.200
Validation loss decreased (inf --> -0.199975).  Saving model ...
Epoch: 2 cost time: 6.4380269050598145
Epoch: 2, Steps: 12 | Train Loss: 2.247 Vali Loss: 2.019 Vali Acc: 0.461 Test Loss: 2.019 Test Acc: 0.461
Validation loss decreased (-0.199975 --> -0.461091).  Saving model ...
Epoch: 3 cost time: 6.865916967391968
Epoch: 3, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.649 Vali Acc: 0.500 Test Loss: 1.649 Test Acc: 0.500
Validation loss decreased (-0.461091 --> -0.499984).  Saving model ...
Epoch: 4 cost time: 6.616971015930176
Epoch: 4, Steps: 12 | Train Loss: 1.299 Vali Loss: 1.309 Vali Acc: 0.578 Test Loss: 1.309 Test Acc: 0.578
Validation loss decreased (-0.499984 --> -0.577765).  Saving model ...
Epoch: 5 cost time: 6.518890380859375
Epoch: 5, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.156 Vali Acc: 0.600 Test Loss: 1.156 Test Acc: 0.600
Validation loss decreased (-0.577765 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 6.822773456573486
Epoch: 6, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.997 Vali Acc: 0.639 Test Loss: 0.997 Test Acc: 0.639
Validation loss decreased (-0.599988 --> -0.638879).  Saving model ...
Epoch: 7 cost time: 7.166368007659912
Epoch: 7, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.899 Vali Acc: 0.678 Test Loss: 0.899 Test Acc: 0.678
Validation loss decreased (-0.638879 --> -0.677769).  Saving model ...
Epoch: 8 cost time: 7.115222930908203
Epoch: 8, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.848 Vali Acc: 0.706 Test Loss: 0.848 Test Acc: 0.706
Validation loss decreased (-0.677769 --> -0.705547).  Saving model ...
Epoch: 9 cost time: 6.861649751663208
Epoch: 9, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.778 Vali Acc: 0.744 Test Loss: 0.778 Test Acc: 0.744
Validation loss decreased (-0.705547 --> -0.744437).  Saving model ...
Epoch: 10 cost time: 6.8167405128479
Epoch: 10, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.753 Vali Acc: 0.744 Test Loss: 0.753 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 11 cost time: 6.603217124938965
Epoch: 11, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.737 Vali Acc: 0.772 Test Loss: 0.737 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772215).  Saving model ...
Epoch: 12 cost time: 6.730498313903809
Epoch: 12, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.752 Vali Acc: 0.783 Test Loss: 0.752 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 13 cost time: 6.489400386810303
Epoch: 13, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.875 Vali Acc: 0.706 Test Loss: 0.875 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.247084617614746
Epoch: 14, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.764 Vali Acc: 0.767 Test Loss: 0.764 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.7374584674835205
Epoch: 15, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.720 Vali Acc: 0.811 Test Loss: 0.720 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811104).  Saving model ...
Epoch: 16 cost time: 7.051089286804199
Epoch: 16, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.776 Vali Acc: 0.761 Test Loss: 0.776 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.494331359863281
Epoch: 17, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.746 Vali Acc: 0.778 Test Loss: 0.746 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.540248870849609
Epoch: 18, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.754 Vali Acc: 0.783 Test Loss: 0.754 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.993894100189209
Epoch: 19, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.879 Vali Acc: 0.750 Test Loss: 0.879 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.289855241775513
Epoch: 20, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.728471279144287
Epoch: 21, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.708 Vali Acc: 0.811 Test Loss: 0.708 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 22 cost time: 6.5544493198394775
Epoch: 22, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.759 Vali Acc: 0.817 Test Loss: 0.759 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816659).  Saving model ...
Epoch: 23 cost time: 6.587552785873413
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.702 Vali Acc: 0.844 Test Loss: 0.702 Test Acc: 0.844
Validation loss decreased (-0.816659 --> -0.844437).  Saving model ...
Epoch: 24 cost time: 4.270157098770142
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.788 Vali Acc: 0.806 Test Loss: 0.788 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.909756183624268
Epoch: 25, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.753 Vali Acc: 0.839 Test Loss: 0.753 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.982851982116699
Epoch: 26, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.979 Vali Acc: 0.772 Test Loss: 0.979 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.789313077926636
Epoch: 27, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.855 Vali Acc: 0.767 Test Loss: 0.855 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.35059928894043
Epoch: 28, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.871 Vali Acc: 0.733 Test Loss: 0.871 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.090900897979736
Epoch: 29, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.741 Vali Acc: 0.794 Test Loss: 0.741 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.405047178268433
Epoch: 30, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.962 Vali Acc: 0.767 Test Loss: 0.962 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 37580687
model size : 145.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.803762197494507
Epoch: 1, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.457 Vali Acc: 0.289 Test Loss: 2.457 Test Acc: 0.289
Validation loss decreased (inf --> -0.288864).  Saving model ...
Epoch: 2 cost time: 2.894896984100342
Epoch: 2, Steps: 12 | Train Loss: 2.227 Vali Loss: 1.966 Vali Acc: 0.506 Test Loss: 1.966 Test Acc: 0.506
Validation loss decreased (-0.288864 --> -0.505536).  Saving model ...
Epoch: 3 cost time: 3.0761044025421143
Epoch: 3, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.564 Vali Acc: 0.561 Test Loss: 1.564 Test Acc: 0.561
Validation loss decreased (-0.505536 --> -0.561095).  Saving model ...
Epoch: 4 cost time: 2.9775826930999756
Epoch: 4, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.301 Vali Acc: 0.583 Test Loss: 1.301 Test Acc: 0.583
Validation loss decreased (-0.561095 --> -0.583320).  Saving model ...
Epoch: 5 cost time: 3.063378095626831
Epoch: 5, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.126 Vali Acc: 0.594 Test Loss: 1.126 Test Acc: 0.594
Validation loss decreased (-0.583320 --> -0.594433).  Saving model ...
Epoch: 6 cost time: 3.3247568607330322
Epoch: 6, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.997 Vali Acc: 0.661 Test Loss: 0.997 Test Acc: 0.661
Validation loss decreased (-0.594433 --> -0.661101).  Saving model ...
Epoch: 7 cost time: 2.867899179458618
Epoch: 7, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.945 Vali Acc: 0.656 Test Loss: 0.945 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9041600227355957
Epoch: 8, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.887 Vali Acc: 0.667 Test Loss: 0.887 Test Acc: 0.667
Validation loss decreased (-0.661101 --> -0.666658).  Saving model ...
Epoch: 9 cost time: 2.7942702770233154
Epoch: 9, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.957 Vali Acc: 0.661 Test Loss: 0.957 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8860063552856445
Epoch: 10, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.910 Vali Acc: 0.683 Test Loss: 0.910 Test Acc: 0.683
Validation loss decreased (-0.666658 --> -0.683324).  Saving model ...
Epoch: 11 cost time: 2.9760568141937256
Epoch: 11, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.846 Vali Acc: 0.728 Test Loss: 0.846 Test Acc: 0.728
Validation loss decreased (-0.683324 --> -0.727769).  Saving model ...
Epoch: 12 cost time: 2.73732852935791
Epoch: 12, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.871 Vali Acc: 0.711 Test Loss: 0.871 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.833470582962036
Epoch: 13, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.704 Vali Acc: 0.778 Test Loss: 0.704 Test Acc: 0.778
Validation loss decreased (-0.727769 --> -0.777771).  Saving model ...
Epoch: 14 cost time: 3.010510206222534
Epoch: 14, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.745 Vali Acc: 0.789 Test Loss: 0.745 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788881).  Saving model ...
Epoch: 15 cost time: 2.904301643371582
Epoch: 15, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.864 Vali Acc: 0.728 Test Loss: 0.864 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8008370399475098
Epoch: 16, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.983 Vali Acc: 0.722 Test Loss: 0.983 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.62709641456604
Epoch: 17, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.855 Vali Acc: 0.750 Test Loss: 0.855 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7717084884643555
Epoch: 18, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.812 Vali Acc: 0.789 Test Loss: 0.812 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.115468740463257
Epoch: 19, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.773 Vali Acc: 0.789 Test Loss: 0.773 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1221368312835693
Epoch: 20, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.738 Vali Acc: 0.783 Test Loss: 0.738 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.095139980316162
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.812 Vali Acc: 0.772 Test Loss: 0.812 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8013503551483154
Epoch: 22, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 2.9640564918518066
Epoch: 23, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.817 Vali Acc: 0.772 Test Loss: 0.817 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1480586528778076
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.716 Vali Acc: 0.811 Test Loss: 0.716 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 25 cost time: 3.128986120223999
Epoch: 25, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.788 Vali Acc: 0.811 Test Loss: 0.788 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.085042953491211
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.749 Vali Acc: 0.822 Test Loss: 0.749 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 27 cost time: 2.8612382411956787
Epoch: 27, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.922 Vali Acc: 0.761 Test Loss: 0.922 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.814211368560791
Epoch: 28, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.776 Vali Acc: 0.783 Test Loss: 0.776 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.1223130226135254
Epoch: 29, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.830 Vali Acc: 0.806 Test Loss: 0.830 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.7888941764831543
Epoch: 30, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.844 Vali Acc: 0.783 Test Loss: 0.844 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 11102095
model size : 44.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 17.061926126480103
Epoch: 1, Steps: 12 | Train Loss: 2.744 Vali Loss: 2.543 Vali Acc: 0.244 Test Loss: 2.543 Test Acc: 0.244
Validation loss decreased (inf --> -0.244419).  Saving model ...
Epoch: 2 cost time: 15.17596697807312
Epoch: 2, Steps: 12 | Train Loss: 2.346 Vali Loss: 2.080 Vali Acc: 0.472 Test Loss: 2.080 Test Acc: 0.472
Validation loss decreased (-0.244419 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 15.945268154144287
Epoch: 3, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.652 Vali Acc: 0.550 Test Loss: 1.652 Test Acc: 0.550
Validation loss decreased (-0.472201 --> -0.549983).  Saving model ...
Epoch: 4 cost time: 14.88399600982666
Epoch: 4, Steps: 12 | Train Loss: 1.344 Vali Loss: 1.376 Vali Acc: 0.594 Test Loss: 1.376 Test Acc: 0.594
Validation loss decreased (-0.549983 --> -0.594431).  Saving model ...
Epoch: 5 cost time: 15.828279256820679
Epoch: 5, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.141 Vali Acc: 0.617 Test Loss: 1.141 Test Acc: 0.617
Validation loss decreased (-0.594431 --> -0.616655).  Saving model ...
Epoch: 6 cost time: 16.338502168655396
Epoch: 6, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.987 Vali Acc: 0.644 Test Loss: 0.987 Test Acc: 0.644
Validation loss decreased (-0.616655 --> -0.644435).  Saving model ...
Epoch: 7 cost time: 16.91416335105896
Epoch: 7, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.885 Vali Acc: 0.689 Test Loss: 0.885 Test Acc: 0.689
Validation loss decreased (-0.644435 --> -0.688880).  Saving model ...
Epoch: 8 cost time: 17.640535831451416
Epoch: 8, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.803 Vali Acc: 0.706 Test Loss: 0.803 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705548).  Saving model ...
Epoch: 9 cost time: 17.168163776397705
Epoch: 9, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.754 Vali Acc: 0.711 Test Loss: 0.754 Test Acc: 0.711
Validation loss decreased (-0.705548 --> -0.711104).  Saving model ...
Epoch: 10 cost time: 15.09672999382019
Epoch: 10, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.652 Vali Acc: 0.778 Test Loss: 0.652 Test Acc: 0.778
Validation loss decreased (-0.711104 --> -0.777771).  Saving model ...
Epoch: 11 cost time: 14.956607580184937
Epoch: 11, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.684 Vali Acc: 0.750 Test Loss: 0.684 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.015048265457153
Epoch: 12, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.648 Vali Acc: 0.728 Test Loss: 0.648 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.760149240493774
Epoch: 13, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.706 Vali Acc: 0.733 Test Loss: 0.706 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 16.976468801498413
Epoch: 14, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.674 Vali Acc: 0.767 Test Loss: 0.674 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 17.191550731658936
Epoch: 15, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.716 Vali Acc: 0.756 Test Loss: 0.716 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 16.681987047195435
Epoch: 16, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.702 Vali Acc: 0.761 Test Loss: 0.702 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 15.479757308959961
Epoch: 17, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.653 Vali Acc: 0.789 Test Loss: 0.653 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 18 cost time: 16.18165612220764
Epoch: 18, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.656 Vali Acc: 0.811 Test Loss: 0.656 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811105).  Saving model ...
Epoch: 19 cost time: 15.547443628311157
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833327).  Saving model ...
Epoch: 20 cost time: 15.661483526229858
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 21 cost time: 15.376056671142578
Epoch: 21, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 13.11505126953125
Epoch: 22, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.729 Vali Acc: 0.772 Test Loss: 0.729 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 14.349267482757568
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.706 Vali Acc: 0.800 Test Loss: 0.706 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 14.065222024917603
Epoch: 24, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.630 Vali Acc: 0.817 Test Loss: 0.630 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 13.618950605392456
Epoch: 25, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.620 Vali Acc: 0.822 Test Loss: 0.620 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 13.654942035675049
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 14.072055101394653
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.623 Vali Acc: 0.833 Test Loss: 0.623 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 15.021385908126831
Epoch: 28, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.643 Vali Acc: 0.822 Test Loss: 0.643 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 14.547961473464966
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.655 Vali Acc: 0.828 Test Loss: 0.655 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 13.708979845046997
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.649 Vali Acc: 0.828 Test Loss: 0.649 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 37538255
model size : 144.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.318845748901367
Epoch: 1, Steps: 12 | Train Loss: 2.733 Vali Loss: 2.560 Vali Acc: 0.211 Test Loss: 2.560 Test Acc: 0.211
Validation loss decreased (inf --> -0.211086).  Saving model ...
Epoch: 2 cost time: 4.997241735458374
Epoch: 2, Steps: 12 | Train Loss: 2.346 Vali Loss: 2.092 Vali Acc: 0.428 Test Loss: 2.092 Test Acc: 0.428
Validation loss decreased (-0.211086 --> -0.427757).  Saving model ...
Epoch: 3 cost time: 4.805396795272827
Epoch: 3, Steps: 12 | Train Loss: 1.814 Vali Loss: 1.691 Vali Acc: 0.578 Test Loss: 1.691 Test Acc: 0.578
Validation loss decreased (-0.427757 --> -0.577761).  Saving model ...
Epoch: 4 cost time: 5.548006772994995
Epoch: 4, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.352 Vali Acc: 0.617 Test Loss: 1.352 Test Acc: 0.617
Validation loss decreased (-0.577761 --> -0.616653).  Saving model ...
Epoch: 5 cost time: 5.200260877609253
Epoch: 5, Steps: 12 | Train Loss: 1.137 Vali Loss: 1.134 Vali Acc: 0.650 Test Loss: 1.134 Test Acc: 0.650
Validation loss decreased (-0.616653 --> -0.649989).  Saving model ...
Epoch: 6 cost time: 5.03316330909729
Epoch: 6, Steps: 12 | Train Loss: 0.861 Vali Loss: 0.979 Vali Acc: 0.672 Test Loss: 0.979 Test Acc: 0.672
Validation loss decreased (-0.649989 --> -0.672212).  Saving model ...
Epoch: 7 cost time: 5.659805059432983
Epoch: 7, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.854 Vali Acc: 0.711 Test Loss: 0.854 Test Acc: 0.711
Validation loss decreased (-0.672212 --> -0.711103).  Saving model ...
Epoch: 8 cost time: 5.458378553390503
Epoch: 8, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.778 Vali Acc: 0.728 Test Loss: 0.778 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 9 cost time: 5.670178174972534
Epoch: 9, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.706 Vali Acc: 0.744 Test Loss: 0.706 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744437).  Saving model ...
Epoch: 10 cost time: 5.730990171432495
Epoch: 10, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.637 Vali Acc: 0.761 Test Loss: 0.637 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761105).  Saving model ...
Epoch: 11 cost time: 5.354170560836792
Epoch: 11, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.556148290634155
Epoch: 12, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.621 Vali Acc: 0.800 Test Loss: 0.621 Test Acc: 0.800
Validation loss decreased (-0.761105 --> -0.799994).  Saving model ...
Epoch: 13 cost time: 5.465008020401001
Epoch: 13, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.650 Vali Acc: 0.761 Test Loss: 0.650 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.901580333709717
Epoch: 14, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.659 Vali Acc: 0.800 Test Loss: 0.659 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.213180065155029
Epoch: 15, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.652 Vali Acc: 0.783 Test Loss: 0.652 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.554879426956177
Epoch: 16, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.710989952087402
Epoch: 17, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.647 Vali Acc: 0.767 Test Loss: 0.647 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.569273471832275
Epoch: 18, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.652 Vali Acc: 0.789 Test Loss: 0.652 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.896929025650024
Epoch: 19, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.4306721687316895
Epoch: 20, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.596 Vali Acc: 0.806 Test Loss: 0.596 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805550).  Saving model ...
Epoch: 21 cost time: 5.551891326904297
Epoch: 21, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.623215913772583
Epoch: 22, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.586 Vali Acc: 0.811 Test Loss: 0.586 Test Acc: 0.811
Validation loss decreased (-0.805550 --> -0.811105).  Saving model ...
Epoch: 23 cost time: 5.533497333526611
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.591 Vali Acc: 0.822 Test Loss: 0.591 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 24 cost time: 5.115320444107056
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 25 cost time: 5.070301532745361
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.61356258392334
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 27 cost time: 5.895570993423462
Epoch: 27, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.595 Vali Acc: 0.828 Test Loss: 0.595 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.871026515960693
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.608 Vali Acc: 0.833 Test Loss: 0.608 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.221686601638794
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.71014666557312
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.650 Vali Acc: 0.822 Test Loss: 0.650 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 11059151
model size : 43.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 10.128857135772705
Epoch: 1, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.542 Vali Acc: 0.239 Test Loss: 2.542 Test Acc: 0.239
Validation loss decreased (inf --> -0.238863).  Saving model ...
Epoch: 2 cost time: 8.812702178955078
Epoch: 2, Steps: 12 | Train Loss: 2.347 Vali Loss: 2.076 Vali Acc: 0.472 Test Loss: 2.076 Test Acc: 0.472
Validation loss decreased (-0.238863 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 9.753549337387085
Epoch: 3, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.651 Vali Acc: 0.550 Test Loss: 1.651 Test Acc: 0.550
Validation loss decreased (-0.472201 --> -0.549983).  Saving model ...
Epoch: 4 cost time: 9.857345342636108
Epoch: 4, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.377 Vali Acc: 0.594 Test Loss: 1.377 Test Acc: 0.594
Validation loss decreased (-0.549983 --> -0.594431).  Saving model ...
Epoch: 5 cost time: 9.462632894515991
Epoch: 5, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.143 Vali Acc: 0.617 Test Loss: 1.143 Test Acc: 0.617
Validation loss decreased (-0.594431 --> -0.616655).  Saving model ...
Epoch: 6 cost time: 8.42642068862915
Epoch: 6, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.988 Vali Acc: 0.656 Test Loss: 0.988 Test Acc: 0.656
Validation loss decreased (-0.616655 --> -0.655546).  Saving model ...
Epoch: 7 cost time: 8.476861000061035
Epoch: 7, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.885 Vali Acc: 0.678 Test Loss: 0.885 Test Acc: 0.678
Validation loss decreased (-0.655546 --> -0.677769).  Saving model ...
Epoch: 8 cost time: 8.727077007293701
Epoch: 8, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.799 Vali Acc: 0.706 Test Loss: 0.799 Test Acc: 0.706
Validation loss decreased (-0.677769 --> -0.705548).  Saving model ...
Epoch: 9 cost time: 9.814490556716919
Epoch: 9, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.766 Vali Acc: 0.700 Test Loss: 0.766 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.330071926116943
Epoch: 10, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.668 Vali Acc: 0.739 Test Loss: 0.668 Test Acc: 0.739
Validation loss decreased (-0.705548 --> -0.738882).  Saving model ...
Epoch: 11 cost time: 8.986007690429688
Epoch: 11, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.675 Vali Acc: 0.756 Test Loss: 0.675 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 12 cost time: 9.549899101257324
Epoch: 12, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.672 Vali Acc: 0.733 Test Loss: 0.672 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.505579948425293
Epoch: 13, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.681 Vali Acc: 0.756 Test Loss: 0.681 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.762474060058594
Epoch: 14, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.645 Vali Acc: 0.772 Test Loss: 0.645 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772216).  Saving model ...
Epoch: 15 cost time: 10.834398984909058
Epoch: 15, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.683 Vali Acc: 0.750 Test Loss: 0.683 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.53761339187622
Epoch: 16, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.688 Vali Acc: 0.772 Test Loss: 0.688 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.592869520187378
Epoch: 17, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783327).  Saving model ...
Epoch: 18 cost time: 11.224569320678711
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.642 Vali Acc: 0.767 Test Loss: 0.642 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.705775737762451
Epoch: 19, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.584 Vali Acc: 0.811 Test Loss: 0.584 Test Acc: 0.811
Validation loss decreased (-0.783327 --> -0.811105).  Saving model ...
Epoch: 20 cost time: 10.310068845748901
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.663 Vali Acc: 0.811 Test Loss: 0.663 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.019366025924683
Epoch: 21, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.610 Vali Acc: 0.811 Test Loss: 0.610 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 12.242056846618652
Epoch: 22, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.630 Vali Acc: 0.828 Test Loss: 0.630 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 10.94676947593689
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 12.64889931678772
Epoch: 24, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.618 Vali Acc: 0.800 Test Loss: 0.618 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 11.015800952911377
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.573 Vali Acc: 0.817 Test Loss: 0.573 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 11.10396146774292
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833328).  Saving model ...
Epoch: 27 cost time: 11.593518257141113
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.610 Vali Acc: 0.833 Test Loss: 0.610 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 11.31689977645874
Epoch: 28, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.595 Vali Acc: 0.828 Test Loss: 0.595 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 12.8571195602417
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.601 Vali Acc: 0.839 Test Loss: 0.601 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838883).  Saving model ...
Epoch: 30 cost time: 11.629669427871704
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.595 Vali Acc: 0.828 Test Loss: 0.595 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 37538255
model size : 144.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.6041035652160645
Epoch: 1, Steps: 12 | Train Loss: 2.733 Vali Loss: 2.560 Vali Acc: 0.211 Test Loss: 2.560 Test Acc: 0.211
Validation loss decreased (inf --> -0.211086).  Saving model ...
Epoch: 2 cost time: 4.640672445297241
Epoch: 2, Steps: 12 | Train Loss: 2.347 Vali Loss: 2.091 Vali Acc: 0.433 Test Loss: 2.091 Test Acc: 0.433
Validation loss decreased (-0.211086 --> -0.433312).  Saving model ...
Epoch: 3 cost time: 4.577304124832153
Epoch: 3, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.689 Vali Acc: 0.578 Test Loss: 1.689 Test Acc: 0.578
Validation loss decreased (-0.433312 --> -0.577761).  Saving model ...
Epoch: 4 cost time: 5.100194215774536
Epoch: 4, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.350 Vali Acc: 0.622 Test Loss: 1.350 Test Acc: 0.622
Validation loss decreased (-0.577761 --> -0.622209).  Saving model ...
Epoch: 5 cost time: 5.007733345031738
Epoch: 5, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.128 Vali Acc: 0.656 Test Loss: 1.128 Test Acc: 0.656
Validation loss decreased (-0.622209 --> -0.655544).  Saving model ...
Epoch: 6 cost time: 4.80360746383667
Epoch: 6, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.978 Vali Acc: 0.678 Test Loss: 0.978 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677768).  Saving model ...
Epoch: 7 cost time: 4.954056262969971
Epoch: 7, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.853 Vali Acc: 0.711 Test Loss: 0.853 Test Acc: 0.711
Validation loss decreased (-0.677768 --> -0.711103).  Saving model ...
Epoch: 8 cost time: 5.349239110946655
Epoch: 8, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.790 Vali Acc: 0.722 Test Loss: 0.790 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722214).  Saving model ...
Epoch: 9 cost time: 5.1951377391815186
Epoch: 9, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.733 Vali Acc: 0.733 Test Loss: 0.733 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733326).  Saving model ...
Epoch: 10 cost time: 5.1994524002075195
Epoch: 10, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.668 Vali Acc: 0.761 Test Loss: 0.668 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761104).  Saving model ...
Epoch: 11 cost time: 5.131301164627075
Epoch: 11, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.657 Vali Acc: 0.772 Test Loss: 0.657 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772216).  Saving model ...
Epoch: 12 cost time: 5.106984615325928
Epoch: 12, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.613 Vali Acc: 0.794 Test Loss: 0.613 Test Acc: 0.794
Validation loss decreased (-0.772216 --> -0.794438).  Saving model ...
Epoch: 13 cost time: 5.067266464233398
Epoch: 13, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.652 Vali Acc: 0.767 Test Loss: 0.652 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.037586688995361
Epoch: 14, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.9809370040893555
Epoch: 15, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.629 Vali Acc: 0.778 Test Loss: 0.629 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.66796612739563
Epoch: 16, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.688 Vali Acc: 0.789 Test Loss: 0.688 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.013422250747681
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.066423416137695
Epoch: 18, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.633 Vali Acc: 0.794 Test Loss: 0.633 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.98632025718689
Epoch: 19, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.658 Vali Acc: 0.794 Test Loss: 0.658 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.217617988586426
Epoch: 20, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.589 Vali Acc: 0.794 Test Loss: 0.589 Test Acc: 0.794
Validation loss decreased (-0.794438 --> -0.794439).  Saving model ...
Epoch: 21 cost time: 5.101419687271118
Epoch: 21, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.633 Vali Acc: 0.794 Test Loss: 0.633 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.357245445251465
Epoch: 22, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.331110000610352
Epoch: 23, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.623 Vali Acc: 0.817 Test Loss: 0.623 Test Acc: 0.817
Validation loss decreased (-0.794439 --> -0.816660).  Saving model ...
Epoch: 24 cost time: 5.2066545486450195
Epoch: 24, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.682 Vali Acc: 0.789 Test Loss: 0.682 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.184046983718872
Epoch: 25, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.658 Vali Acc: 0.806 Test Loss: 0.658 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.752302885055542
Epoch: 26, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.767 Vali Acc: 0.783 Test Loss: 0.767 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.096556186676025
Epoch: 27, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.751 Vali Acc: 0.744 Test Loss: 0.751 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.06252384185791
Epoch: 28, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.790 Vali Acc: 0.761 Test Loss: 0.790 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.871169805526733
Epoch: 29, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.969779968261719
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.655 Vali Acc: 0.806 Test Loss: 0.655 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 11059151
model size : 43.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.420773029327393
Epoch: 1, Steps: 12 | Train Loss: 2.762 Vali Loss: 2.599 Vali Acc: 0.178 Test Loss: 2.599 Test Acc: 0.178
Validation loss decreased (inf --> -0.177752).  Saving model ...
Epoch: 2 cost time: 6.97455358505249
Epoch: 2, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.236 Vali Acc: 0.433 Test Loss: 2.236 Test Acc: 0.433
Validation loss decreased (-0.177752 --> -0.433311).  Saving model ...
Epoch: 3 cost time: 7.1401896476745605
Epoch: 3, Steps: 12 | Train Loss: 2.035 Vali Loss: 1.898 Vali Acc: 0.500 Test Loss: 1.898 Test Acc: 0.500
Validation loss decreased (-0.433311 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 7.398963451385498
Epoch: 4, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.634 Vali Acc: 0.533 Test Loss: 1.634 Test Acc: 0.533
Validation loss decreased (-0.499981 --> -0.533317).  Saving model ...
Epoch: 5 cost time: 6.946415424346924
Epoch: 5, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.377 Vali Acc: 0.594 Test Loss: 1.377 Test Acc: 0.594
Validation loss decreased (-0.533317 --> -0.594431).  Saving model ...
Epoch: 6 cost time: 6.798826694488525
Epoch: 6, Steps: 12 | Train Loss: 1.096 Vali Loss: 1.196 Vali Acc: 0.600 Test Loss: 1.196 Test Acc: 0.600
Validation loss decreased (-0.594431 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 7.193713903427124
Epoch: 7, Steps: 12 | Train Loss: 0.902 Vali Loss: 1.083 Vali Acc: 0.622 Test Loss: 1.083 Test Acc: 0.622
Validation loss decreased (-0.599988 --> -0.622211).  Saving model ...
Epoch: 8 cost time: 6.797100782394409
Epoch: 8, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.974 Vali Acc: 0.678 Test Loss: 0.974 Test Acc: 0.678
Validation loss decreased (-0.622211 --> -0.677768).  Saving model ...
Epoch: 9 cost time: 6.224469184875488
Epoch: 9, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.920 Vali Acc: 0.650 Test Loss: 0.920 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.688838481903076
Epoch: 10, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.797 Vali Acc: 0.728 Test Loss: 0.797 Test Acc: 0.728
Validation loss decreased (-0.677768 --> -0.727770).  Saving model ...
Epoch: 11 cost time: 5.986958742141724
Epoch: 11, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.763 Vali Acc: 0.728 Test Loss: 0.763 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727770).  Saving model ...
Epoch: 12 cost time: 6.358298063278198
Epoch: 12, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.938104867935181
Epoch: 13, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.694 Vali Acc: 0.756 Test Loss: 0.694 Test Acc: 0.756
Validation loss decreased (-0.727770 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 6.840169191360474
Epoch: 14, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.706 Vali Acc: 0.767 Test Loss: 0.706 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 15 cost time: 6.666938066482544
Epoch: 15, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.797 Vali Acc: 0.733 Test Loss: 0.797 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.481438875198364
Epoch: 16, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.712 Vali Acc: 0.756 Test Loss: 0.712 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.135795593261719
Epoch: 17, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.796 Vali Acc: 0.678 Test Loss: 0.796 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.604442834854126
Epoch: 18, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.838 Vali Acc: 0.733 Test Loss: 0.838 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.12480616569519
Epoch: 19, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.761 Vali Acc: 0.744 Test Loss: 0.761 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.9486777782440186
Epoch: 20, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.747 Vali Acc: 0.728 Test Loss: 0.747 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.993674278259277
Epoch: 21, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.664 Vali Acc: 0.778 Test Loss: 0.664 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 22 cost time: 6.999275207519531
Epoch: 22, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.822 Vali Acc: 0.722 Test Loss: 0.822 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.395488023757935
Epoch: 23, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.661 Vali Acc: 0.778 Test Loss: 0.661 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 24 cost time: 7.107646226882935
Epoch: 24, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.605 Vali Acc: 0.806 Test Loss: 0.605 Test Acc: 0.806
Validation loss decreased (-0.777771 --> -0.805550).  Saving model ...
Epoch: 25 cost time: 7.011149168014526
Epoch: 25, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.554 Vali Acc: 0.806 Test Loss: 0.554 Test Acc: 0.806
Validation loss decreased (-0.805550 --> -0.805550).  Saving model ...
Epoch: 26 cost time: 6.109341621398926
Epoch: 26, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.701 Vali Acc: 0.806 Test Loss: 0.701 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.5477614402771
Epoch: 27, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.769 Vali Acc: 0.783 Test Loss: 0.769 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.4080588817596436
Epoch: 28, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.937 Vali Acc: 0.767 Test Loss: 0.937 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.676681041717529
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.345292091369629
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.801 Vali Acc: 0.772 Test Loss: 0.801 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 37538255
model size : 144.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.077409267425537
Epoch: 1, Steps: 12 | Train Loss: 2.745 Vali Loss: 2.623 Vali Acc: 0.128 Test Loss: 2.623 Test Acc: 0.128
Validation loss decreased (inf --> -0.127752).  Saving model ...
Epoch: 2 cost time: 3.329716682434082
Epoch: 2, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.268 Vali Acc: 0.372 Test Loss: 2.268 Test Acc: 0.372
Validation loss decreased (-0.127752 --> -0.372200).  Saving model ...
Epoch: 3 cost time: 3.4059388637542725
Epoch: 3, Steps: 12 | Train Loss: 2.045 Vali Loss: 1.919 Vali Acc: 0.539 Test Loss: 1.919 Test Acc: 0.539
Validation loss decreased (-0.372200 --> -0.538870).  Saving model ...
Epoch: 4 cost time: 3.2471978664398193
Epoch: 4, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.624 Vali Acc: 0.589 Test Loss: 1.624 Test Acc: 0.589
Validation loss decreased (-0.538870 --> -0.588873).  Saving model ...
Epoch: 5 cost time: 3.103339910507202
Epoch: 5, Steps: 12 | Train Loss: 1.419 Vali Loss: 1.419 Vali Acc: 0.567 Test Loss: 1.419 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.583693265914917
Epoch: 6, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.248 Vali Acc: 0.583 Test Loss: 1.248 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.168797254562378
Epoch: 7, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.090 Vali Acc: 0.617 Test Loss: 1.090 Test Acc: 0.617
Validation loss decreased (-0.588873 --> -0.616656).  Saving model ...
Epoch: 8 cost time: 3.379685401916504
Epoch: 8, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.969 Vali Acc: 0.706 Test Loss: 0.969 Test Acc: 0.706
Validation loss decreased (-0.616656 --> -0.705546).  Saving model ...
Epoch: 9 cost time: 3.000291109085083
Epoch: 9, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.930 Vali Acc: 0.694 Test Loss: 0.930 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.008449077606201
Epoch: 10, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.816 Vali Acc: 0.739 Test Loss: 0.816 Test Acc: 0.739
Validation loss decreased (-0.705546 --> -0.738881).  Saving model ...
Epoch: 11 cost time: 3.0908210277557373
Epoch: 11, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.810 Vali Acc: 0.761 Test Loss: 0.810 Test Acc: 0.761
Validation loss decreased (-0.738881 --> -0.761103).  Saving model ...
Epoch: 12 cost time: 3.072948455810547
Epoch: 12, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.799 Vali Acc: 0.756 Test Loss: 0.799 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2781386375427246
Epoch: 13, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.749 Vali Acc: 0.772 Test Loss: 0.749 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772215).  Saving model ...
Epoch: 14 cost time: 3.3056294918060303
Epoch: 14, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.770 Vali Acc: 0.767 Test Loss: 0.770 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9387216567993164
Epoch: 15, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.769 Vali Acc: 0.767 Test Loss: 0.769 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.374588966369629
Epoch: 16, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.774 Vali Acc: 0.750 Test Loss: 0.774 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.1905341148376465
Epoch: 17, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.683 Vali Acc: 0.778 Test Loss: 0.683 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 18 cost time: 3.2575597763061523
Epoch: 18, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.689 Vali Acc: 0.767 Test Loss: 0.689 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.637190103530884
Epoch: 19, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.706 Vali Acc: 0.794 Test Loss: 0.706 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794437).  Saving model ...
Epoch: 20 cost time: 3.42697811126709
Epoch: 20, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.707 Vali Acc: 0.778 Test Loss: 0.707 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1492276191711426
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.731 Vali Acc: 0.767 Test Loss: 0.731 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.346999406814575
Epoch: 22, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.853 Vali Acc: 0.733 Test Loss: 0.853 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.1593339443206787
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.857 Vali Acc: 0.750 Test Loss: 0.857 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.144840717315674
Epoch: 24, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.716 Vali Acc: 0.778 Test Loss: 0.716 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.181840419769287
Epoch: 25, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.766 Vali Acc: 0.772 Test Loss: 0.766 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.2512285709381104
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.734 Vali Acc: 0.756 Test Loss: 0.734 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.3544154167175293
Epoch: 27, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.770 Vali Acc: 0.767 Test Loss: 0.770 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.009286403656006
Epoch: 28, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.865 Vali Acc: 0.783 Test Loss: 0.865 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.0349583625793457
Epoch: 29, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.725 Vali Acc: 0.789 Test Loss: 0.725 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 11059151
model size : 43.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 9.639591455459595
Epoch: 1, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.643 Vali Acc: 0.178 Test Loss: 2.643 Test Acc: 0.178
Validation loss decreased (inf --> -0.177751).  Saving model ...
Epoch: 2 cost time: 10.046860933303833
Epoch: 2, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.208 Vali Acc: 0.472 Test Loss: 2.208 Test Acc: 0.472
Validation loss decreased (-0.177751 --> -0.472200).  Saving model ...
Epoch: 3 cost time: 9.48379898071289
Epoch: 3, Steps: 12 | Train Loss: 1.913 Vali Loss: 1.772 Vali Acc: 0.500 Test Loss: 1.772 Test Acc: 0.500
Validation loss decreased (-0.472200 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 9.82314658164978
Epoch: 4, Steps: 12 | Train Loss: 1.400 Vali Loss: 1.436 Vali Acc: 0.539 Test Loss: 1.436 Test Acc: 0.539
Validation loss decreased (-0.499982 --> -0.538875).  Saving model ...
Epoch: 5 cost time: 9.024497509002686
Epoch: 5, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.199 Vali Acc: 0.583 Test Loss: 1.199 Test Acc: 0.583
Validation loss decreased (-0.538875 --> -0.583321).  Saving model ...
Epoch: 6 cost time: 8.197523832321167
Epoch: 6, Steps: 12 | Train Loss: 0.835 Vali Loss: 1.027 Vali Acc: 0.622 Test Loss: 1.027 Test Acc: 0.622
Validation loss decreased (-0.583321 --> -0.622212).  Saving model ...
Epoch: 7 cost time: 8.797789335250854
Epoch: 7, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.931 Vali Acc: 0.633 Test Loss: 0.931 Test Acc: 0.633
Validation loss decreased (-0.622212 --> -0.633324).  Saving model ...
Epoch: 8 cost time: 9.045296907424927
Epoch: 8, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.774 Vali Acc: 0.689 Test Loss: 0.774 Test Acc: 0.689
Validation loss decreased (-0.633324 --> -0.688881).  Saving model ...
Epoch: 9 cost time: 10.623401165008545
Epoch: 9, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.716 Vali Acc: 0.711 Test Loss: 0.716 Test Acc: 0.711
Validation loss decreased (-0.688881 --> -0.711104).  Saving model ...
Epoch: 10 cost time: 9.443253517150879
Epoch: 10, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.730 Vali Acc: 0.711 Test Loss: 0.730 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.597761869430542
Epoch: 11, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.677 Vali Acc: 0.733 Test Loss: 0.677 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733327).  Saving model ...
Epoch: 12 cost time: 8.74813961982727
Epoch: 12, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.649 Vali Acc: 0.739 Test Loss: 0.649 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 9.693543434143066
Epoch: 13, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.628 Vali Acc: 0.772 Test Loss: 0.628 Test Acc: 0.772
Validation loss decreased (-0.738882 --> -0.772216).  Saving model ...
Epoch: 14 cost time: 8.12509298324585
Epoch: 14, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.635 Vali Acc: 0.750 Test Loss: 0.635 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.545542001724243
Epoch: 15, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.637 Vali Acc: 0.772 Test Loss: 0.637 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.334153175354004
Epoch: 16, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.698 Vali Acc: 0.783 Test Loss: 0.698 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783326).  Saving model ...
Epoch: 17 cost time: 7.9962968826293945
Epoch: 17, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.661 Vali Acc: 0.772 Test Loss: 0.661 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.048463821411133
Epoch: 18, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.753 Vali Acc: 0.761 Test Loss: 0.753 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 10.016625165939331
Epoch: 19, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.683 Vali Acc: 0.761 Test Loss: 0.683 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 10.457483291625977
Epoch: 20, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.719 Vali Acc: 0.772 Test Loss: 0.719 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 9.623893737792969
Epoch: 21, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.741 Vali Acc: 0.767 Test Loss: 0.741 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 10.73809266090393
Epoch: 22, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.679 Vali Acc: 0.794 Test Loss: 0.679 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 23 cost time: 9.908297061920166
Epoch: 23, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.570 Vali Acc: 0.806 Test Loss: 0.570 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805550).  Saving model ...
Epoch: 24 cost time: 11.03980302810669
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.528 Vali Acc: 0.811 Test Loss: 0.528 Test Acc: 0.811
Validation loss decreased (-0.805550 --> -0.811106).  Saving model ...
Epoch: 25 cost time: 9.591078758239746
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.589 Vali Acc: 0.817 Test Loss: 0.589 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816661).  Saving model ...
Epoch: 26 cost time: 10.873470783233643
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822216).  Saving model ...
Epoch: 27 cost time: 10.311794519424438
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.585 Vali Acc: 0.833 Test Loss: 0.585 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 28 cost time: 10.596312761306763
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.587 Vali Acc: 0.833 Test Loss: 0.587 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 10.257930994033813
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.598 Vali Acc: 0.828 Test Loss: 0.598 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 10.289273738861084
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 18791887
model size : 72.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.317415475845337
Epoch: 1, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.527 Vali Acc: 0.250 Test Loss: 2.527 Test Acc: 0.250
Validation loss decreased (inf --> -0.249975).  Saving model ...
Epoch: 2 cost time: 4.357097148895264
Epoch: 2, Steps: 12 | Train Loss: 2.387 Vali Loss: 2.147 Vali Acc: 0.461 Test Loss: 2.147 Test Acc: 0.461
Validation loss decreased (-0.249975 --> -0.461090).  Saving model ...
Epoch: 3 cost time: 4.530653476715088
Epoch: 3, Steps: 12 | Train Loss: 1.945 Vali Loss: 1.747 Vali Acc: 0.561 Test Loss: 1.747 Test Acc: 0.561
Validation loss decreased (-0.461090 --> -0.561094).  Saving model ...
Epoch: 4 cost time: 4.516673564910889
Epoch: 4, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.464 Vali Acc: 0.578 Test Loss: 1.464 Test Acc: 0.578
Validation loss decreased (-0.561094 --> -0.577763).  Saving model ...
Epoch: 5 cost time: 4.039748907089233
Epoch: 5, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.207 Vali Acc: 0.644 Test Loss: 1.207 Test Acc: 0.644
Validation loss decreased (-0.577763 --> -0.644432).  Saving model ...
Epoch: 6 cost time: 4.2091991901397705
Epoch: 6, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.056 Vali Acc: 0.650 Test Loss: 1.056 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 4.899072885513306
Epoch: 7, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.925 Vali Acc: 0.656 Test Loss: 0.925 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655546).  Saving model ...
Epoch: 8 cost time: 4.706204414367676
Epoch: 8, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.838 Vali Acc: 0.694 Test Loss: 0.838 Test Acc: 0.694
Validation loss decreased (-0.655546 --> -0.694436).  Saving model ...
Epoch: 9 cost time: 4.311613321304321
Epoch: 9, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.766 Vali Acc: 0.711 Test Loss: 0.766 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711103).  Saving model ...
Epoch: 10 cost time: 4.129699468612671
Epoch: 10, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.720 Vali Acc: 0.711 Test Loss: 0.720 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711104).  Saving model ...
Epoch: 11 cost time: 4.904075860977173
Epoch: 11, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.658 Vali Acc: 0.750 Test Loss: 0.658 Test Acc: 0.750
Validation loss decreased (-0.711104 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 4.7158753871917725
Epoch: 12, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.653 Vali Acc: 0.744 Test Loss: 0.653 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.253308057785034
Epoch: 13, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.661 Vali Acc: 0.744 Test Loss: 0.661 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.13927149772644
Epoch: 14, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.661 Vali Acc: 0.778 Test Loss: 0.661 Test Acc: 0.778
Validation loss decreased (-0.749993 --> -0.777771).  Saving model ...
Epoch: 15 cost time: 4.672105550765991
Epoch: 15, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.677 Vali Acc: 0.767 Test Loss: 0.677 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.4895195960998535
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.666 Vali Acc: 0.800 Test Loss: 0.666 Test Acc: 0.800
Validation loss decreased (-0.777771 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 4.46541690826416
Epoch: 17, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.698 Vali Acc: 0.756 Test Loss: 0.698 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.540520429611206
Epoch: 18, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.723 Vali Acc: 0.789 Test Loss: 0.723 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.552257537841797
Epoch: 19, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.784 Vali Acc: 0.778 Test Loss: 0.784 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.550959825515747
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.755 Vali Acc: 0.761 Test Loss: 0.755 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.548869371414185
Epoch: 21, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.702 Vali Acc: 0.761 Test Loss: 0.702 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.531323194503784
Epoch: 22, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.783 Vali Acc: 0.761 Test Loss: 0.783 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.4431774616241455
Epoch: 23, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.848 Vali Acc: 0.733 Test Loss: 0.848 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.359466075897217
Epoch: 24, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.781 Vali Acc: 0.761 Test Loss: 0.781 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.570811748504639
Epoch: 25, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.766 Vali Acc: 0.761 Test Loss: 0.766 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.697232007980347
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.788 Vali Acc: 0.778 Test Loss: 0.788 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 5552079
model size : 22.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 9.744569540023804
Epoch: 1, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.642 Vali Acc: 0.178 Test Loss: 2.642 Test Acc: 0.178
Validation loss decreased (inf --> -0.177751).  Saving model ...
Epoch: 2 cost time: 8.169106245040894
Epoch: 2, Steps: 12 | Train Loss: 2.431 Vali Loss: 2.206 Vali Acc: 0.478 Test Loss: 2.206 Test Acc: 0.478
Validation loss decreased (-0.177751 --> -0.477756).  Saving model ...
Epoch: 3 cost time: 7.327824831008911
Epoch: 3, Steps: 12 | Train Loss: 1.914 Vali Loss: 1.770 Vali Acc: 0.506 Test Loss: 1.770 Test Acc: 0.506
Validation loss decreased (-0.477756 --> -0.505538).  Saving model ...
Epoch: 4 cost time: 8.475478649139404
Epoch: 4, Steps: 12 | Train Loss: 1.406 Vali Loss: 1.436 Vali Acc: 0.539 Test Loss: 1.436 Test Acc: 0.539
Validation loss decreased (-0.505538 --> -0.538875).  Saving model ...
Epoch: 5 cost time: 7.5133984088897705
Epoch: 5, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.202 Vali Acc: 0.578 Test Loss: 1.202 Test Acc: 0.578
Validation loss decreased (-0.538875 --> -0.577766).  Saving model ...
Epoch: 6 cost time: 7.655566692352295
Epoch: 6, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.029 Vali Acc: 0.622 Test Loss: 1.029 Test Acc: 0.622
Validation loss decreased (-0.577766 --> -0.622212).  Saving model ...
Epoch: 7 cost time: 8.2236967086792
Epoch: 7, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.933 Vali Acc: 0.639 Test Loss: 0.933 Test Acc: 0.639
Validation loss decreased (-0.622212 --> -0.638880).  Saving model ...
Epoch: 8 cost time: 7.569885015487671
Epoch: 8, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.805 Vali Acc: 0.678 Test Loss: 0.805 Test Acc: 0.678
Validation loss decreased (-0.638880 --> -0.677770).  Saving model ...
Epoch: 9 cost time: 8.069902658462524
Epoch: 9, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.741 Vali Acc: 0.706 Test Loss: 0.741 Test Acc: 0.706
Validation loss decreased (-0.677770 --> -0.705548).  Saving model ...
Epoch: 10 cost time: 7.665663957595825
Epoch: 10, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.742 Vali Acc: 0.717 Test Loss: 0.742 Test Acc: 0.717
Validation loss decreased (-0.705548 --> -0.716659).  Saving model ...
Epoch: 11 cost time: 7.582616806030273
Epoch: 11, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.691 Vali Acc: 0.700 Test Loss: 0.691 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.540262699127197
Epoch: 12, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.639 Vali Acc: 0.739 Test Loss: 0.639 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 7.848193645477295
Epoch: 13, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.614 Vali Acc: 0.778 Test Loss: 0.614 Test Acc: 0.778
Validation loss decreased (-0.738882 --> -0.777772).  Saving model ...
Epoch: 14 cost time: 7.721464395523071
Epoch: 14, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.626 Vali Acc: 0.756 Test Loss: 0.626 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.927197694778442
Epoch: 15, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.651 Vali Acc: 0.800 Test Loss: 0.651 Test Acc: 0.800
Validation loss decreased (-0.777772 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 7.264944076538086
Epoch: 16, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.658 Vali Acc: 0.783 Test Loss: 0.658 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.7448201179504395
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.647 Vali Acc: 0.772 Test Loss: 0.647 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.4262189865112305
Epoch: 18, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.699 Vali Acc: 0.767 Test Loss: 0.699 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.92987585067749
Epoch: 19, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.669 Vali Acc: 0.767 Test Loss: 0.669 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.889973402023315
Epoch: 20, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.515126943588257
Epoch: 21, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.689 Vali Acc: 0.756 Test Loss: 0.689 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.2125632762908936
Epoch: 22, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.639 Vali Acc: 0.817 Test Loss: 0.639 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 7.421095371246338
Epoch: 23, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.600 Vali Acc: 0.789 Test Loss: 0.600 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.8473241329193115
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.647 Vali Acc: 0.794 Test Loss: 0.647 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.245486736297607
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.622 Vali Acc: 0.817 Test Loss: 0.622 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 26 cost time: 7.375083684921265
Epoch: 26, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.662 Vali Acc: 0.789 Test Loss: 0.662 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.166835784912109
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.622 Vali Acc: 0.811 Test Loss: 0.622 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.774639368057251
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.672 Vali Acc: 0.772 Test Loss: 0.672 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.381627082824707
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.677 Vali Acc: 0.817 Test Loss: 0.677 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.348924160003662
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.606 Vali Acc: 0.828 Test Loss: 0.606 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 18791887
model size : 72.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.269651412963867
Epoch: 1, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.527 Vali Acc: 0.250 Test Loss: 2.527 Test Acc: 0.250
Validation loss decreased (inf --> -0.249975).  Saving model ...
Epoch: 2 cost time: 3.3551716804504395
Epoch: 2, Steps: 12 | Train Loss: 2.388 Vali Loss: 2.145 Vali Acc: 0.461 Test Loss: 2.145 Test Acc: 0.461
Validation loss decreased (-0.249975 --> -0.461090).  Saving model ...
Epoch: 3 cost time: 3.42972993850708
Epoch: 3, Steps: 12 | Train Loss: 1.947 Vali Loss: 1.744 Vali Acc: 0.561 Test Loss: 1.744 Test Acc: 0.561
Validation loss decreased (-0.461090 --> -0.561094).  Saving model ...
Epoch: 4 cost time: 3.059959888458252
Epoch: 4, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.461 Vali Acc: 0.583 Test Loss: 1.461 Test Acc: 0.583
Validation loss decreased (-0.561094 --> -0.583319).  Saving model ...
Epoch: 5 cost time: 3.412508726119995
Epoch: 5, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.205 Vali Acc: 0.639 Test Loss: 1.205 Test Acc: 0.639
Validation loss decreased (-0.583319 --> -0.638877).  Saving model ...
Epoch: 6 cost time: 3.3928170204162598
Epoch: 6, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.057 Vali Acc: 0.656 Test Loss: 1.057 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655545).  Saving model ...
Epoch: 7 cost time: 3.444178342819214
Epoch: 7, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.926 Vali Acc: 0.661 Test Loss: 0.926 Test Acc: 0.661
Validation loss decreased (-0.655545 --> -0.661102).  Saving model ...
Epoch: 8 cost time: 3.1283135414123535
Epoch: 8, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.854 Vali Acc: 0.706 Test Loss: 0.854 Test Acc: 0.706
Validation loss decreased (-0.661102 --> -0.705547).  Saving model ...
Epoch: 9 cost time: 3.0333399772644043
Epoch: 9, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.780 Vali Acc: 0.711 Test Loss: 0.780 Test Acc: 0.711
Validation loss decreased (-0.705547 --> -0.711103).  Saving model ...
Epoch: 10 cost time: 3.2805144786834717
Epoch: 10, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.737 Vali Acc: 0.722 Test Loss: 0.737 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722215).  Saving model ...
Epoch: 11 cost time: 3.4349827766418457
Epoch: 11, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.683 Vali Acc: 0.756 Test Loss: 0.683 Test Acc: 0.756
Validation loss decreased (-0.722215 --> -0.755549).  Saving model ...
Epoch: 12 cost time: 3.570890426635742
Epoch: 12, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.666 Vali Acc: 0.767 Test Loss: 0.666 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 13 cost time: 3.18097186088562
Epoch: 13, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.673 Vali Acc: 0.744 Test Loss: 0.673 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4478938579559326
Epoch: 14, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.636 Vali Acc: 0.767 Test Loss: 0.636 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 15 cost time: 3.034799575805664
Epoch: 15, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.666 Vali Acc: 0.772 Test Loss: 0.666 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 16 cost time: 3.5417494773864746
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.649 Vali Acc: 0.800 Test Loss: 0.649 Test Acc: 0.800
Validation loss decreased (-0.772216 --> -0.799994).  Saving model ...
Epoch: 17 cost time: 3.22782301902771
Epoch: 17, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.694 Vali Acc: 0.744 Test Loss: 0.694 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.510544776916504
Epoch: 18, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.685 Vali Acc: 0.794 Test Loss: 0.685 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0893349647521973
Epoch: 19, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.751 Vali Acc: 0.772 Test Loss: 0.751 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.1864163875579834
Epoch: 20, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.714 Vali Acc: 0.800 Test Loss: 0.714 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.0965793132781982
Epoch: 21, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.767 Vali Acc: 0.739 Test Loss: 0.767 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.244870185852051
Epoch: 22, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.712 Vali Acc: 0.778 Test Loss: 0.712 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.3962438106536865
Epoch: 23, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.779 Vali Acc: 0.767 Test Loss: 0.779 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.132200241088867
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.721 Vali Acc: 0.783 Test Loss: 0.721 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.2135894298553467
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.756 Vali Acc: 0.761 Test Loss: 0.756 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.0966544151306152
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.801 Vali Acc: 0.772 Test Loss: 0.801 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 5552079
model size : 22.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.892047882080078
Epoch: 1, Steps: 12 | Train Loss: 2.778 Vali Loss: 2.688 Vali Acc: 0.156 Test Loss: 2.688 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 3.8032588958740234
Epoch: 2, Steps: 12 | Train Loss: 2.520 Vali Loss: 2.367 Vali Acc: 0.356 Test Loss: 2.367 Test Acc: 0.356
Validation loss decreased (-0.155529 --> -0.355532).  Saving model ...
Epoch: 3 cost time: 4.28482985496521
Epoch: 3, Steps: 12 | Train Loss: 2.148 Vali Loss: 2.016 Vali Acc: 0.456 Test Loss: 2.016 Test Acc: 0.456
Validation loss decreased (-0.355532 --> -0.455535).  Saving model ...
Epoch: 4 cost time: 4.35743522644043
Epoch: 4, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.708 Vali Acc: 0.539 Test Loss: 1.708 Test Acc: 0.539
Validation loss decreased (-0.455535 --> -0.538872).  Saving model ...
Epoch: 5 cost time: 4.0182716846466064
Epoch: 5, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.437 Vali Acc: 0.567 Test Loss: 1.437 Test Acc: 0.567
Validation loss decreased (-0.538872 --> -0.566652).  Saving model ...
Epoch: 6 cost time: 4.307832717895508
Epoch: 6, Steps: 12 | Train Loss: 1.124 Vali Loss: 1.289 Vali Acc: 0.578 Test Loss: 1.289 Test Acc: 0.578
Validation loss decreased (-0.566652 --> -0.577765).  Saving model ...
Epoch: 7 cost time: 3.9558210372924805
Epoch: 7, Steps: 12 | Train Loss: 0.990 Vali Loss: 1.162 Vali Acc: 0.578 Test Loss: 1.162 Test Acc: 0.578
Validation loss decreased (-0.577765 --> -0.577766).  Saving model ...
Epoch: 8 cost time: 3.5322437286376953
Epoch: 8, Steps: 12 | Train Loss: 0.791 Vali Loss: 1.025 Vali Acc: 0.633 Test Loss: 1.025 Test Acc: 0.633
Validation loss decreased (-0.577766 --> -0.633323).  Saving model ...
Epoch: 9 cost time: 3.140336036682129
Epoch: 9, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.903 Vali Acc: 0.683 Test Loss: 0.903 Test Acc: 0.683
Validation loss decreased (-0.633323 --> -0.683324).  Saving model ...
Epoch: 10 cost time: 4.61445951461792
Epoch: 10, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.855 Vali Acc: 0.678 Test Loss: 0.855 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.855059862136841
Epoch: 11, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.891 Vali Acc: 0.678 Test Loss: 0.891 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.33971095085144
Epoch: 12, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.800 Vali Acc: 0.733 Test Loss: 0.800 Test Acc: 0.733
Validation loss decreased (-0.683324 --> -0.733325).  Saving model ...
Epoch: 13 cost time: 4.193164110183716
Epoch: 13, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.828 Vali Acc: 0.728 Test Loss: 0.828 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.365691184997559
Epoch: 14, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.839 Vali Acc: 0.728 Test Loss: 0.839 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9992263317108154
Epoch: 15, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.729 Vali Acc: 0.733 Test Loss: 0.729 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733326).  Saving model ...
Epoch: 16 cost time: 4.398701429367065
Epoch: 16, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.663 Vali Acc: 0.772 Test Loss: 0.663 Test Acc: 0.772
Validation loss decreased (-0.733326 --> -0.772216).  Saving model ...
Epoch: 17 cost time: 4.117380380630493
Epoch: 17, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.702 Vali Acc: 0.744 Test Loss: 0.702 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.746232748031616
Epoch: 18, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.688 Vali Acc: 0.783 Test Loss: 0.688 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783326).  Saving model ...
Epoch: 19 cost time: 4.450811147689819
Epoch: 19, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.574 Vali Acc: 0.828 Test Loss: 0.574 Test Acc: 0.828
Validation loss decreased (-0.783326 --> -0.827772).  Saving model ...
Epoch: 20 cost time: 3.959491014480591
Epoch: 20, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.646 Vali Acc: 0.811 Test Loss: 0.646 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.384909629821777
Epoch: 21, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.708 Vali Acc: 0.772 Test Loss: 0.708 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.327592372894287
Epoch: 22, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.648 Vali Acc: 0.794 Test Loss: 0.648 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.6022629737854
Epoch: 23, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 24 cost time: 4.0852415561676025
Epoch: 24, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.614 Vali Acc: 0.822 Test Loss: 0.614 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.696338176727295
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.594 Vali Acc: 0.778 Test Loss: 0.594 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.206644058227539
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.592 Vali Acc: 0.817 Test Loss: 0.592 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.470370769500732
Epoch: 27, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.689 Vali Acc: 0.772 Test Loss: 0.689 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.1440839767456055
Epoch: 28, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.643 Vali Acc: 0.822 Test Loss: 0.643 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.703752040863037
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.640 Vali Acc: 0.817 Test Loss: 0.640 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.084060430526733
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.619 Vali Acc: 0.839 Test Loss: 0.619 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838883).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 18791887
model size : 72.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.81628155708313
Epoch: 1, Steps: 12 | Train Loss: 2.691 Vali Loss: 2.559 Vali Acc: 0.200 Test Loss: 2.559 Test Acc: 0.200
Validation loss decreased (inf --> -0.199974).  Saving model ...
Epoch: 2 cost time: 2.5035250186920166
Epoch: 2, Steps: 12 | Train Loss: 2.456 Vali Loss: 2.243 Vali Acc: 0.456 Test Loss: 2.243 Test Acc: 0.456
Validation loss decreased (-0.199974 --> -0.455533).  Saving model ...
Epoch: 3 cost time: 2.478834390640259
Epoch: 3, Steps: 12 | Train Loss: 2.097 Vali Loss: 1.901 Vali Acc: 0.561 Test Loss: 1.901 Test Acc: 0.561
Validation loss decreased (-0.455533 --> -0.561092).  Saving model ...
Epoch: 4 cost time: 2.3553850650787354
Epoch: 4, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.651 Vali Acc: 0.567 Test Loss: 1.651 Test Acc: 0.567
Validation loss decreased (-0.561092 --> -0.566650).  Saving model ...
Epoch: 5 cost time: 2.5227012634277344
Epoch: 5, Steps: 12 | Train Loss: 1.374 Vali Loss: 1.416 Vali Acc: 0.606 Test Loss: 1.416 Test Acc: 0.606
Validation loss decreased (-0.566650 --> -0.605541).  Saving model ...
Epoch: 6 cost time: 2.4641153812408447
Epoch: 6, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.281 Vali Acc: 0.606 Test Loss: 1.281 Test Acc: 0.606
Validation loss decreased (-0.605541 --> -0.605543).  Saving model ...
Epoch: 7 cost time: 2.1650004386901855
Epoch: 7, Steps: 12 | Train Loss: 0.958 Vali Loss: 1.146 Vali Acc: 0.633 Test Loss: 1.146 Test Acc: 0.633
Validation loss decreased (-0.605543 --> -0.633322).  Saving model ...
Epoch: 8 cost time: 2.0297281742095947
Epoch: 8, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.063 Vali Acc: 0.656 Test Loss: 1.063 Test Acc: 0.656
Validation loss decreased (-0.633322 --> -0.655545).  Saving model ...
Epoch: 9 cost time: 2.6281192302703857
Epoch: 9, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.972 Vali Acc: 0.672 Test Loss: 0.972 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672213).  Saving model ...
Epoch: 10 cost time: 2.384763240814209
Epoch: 10, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.922 Vali Acc: 0.661 Test Loss: 0.922 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2571585178375244
Epoch: 11, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.842 Vali Acc: 0.728 Test Loss: 0.842 Test Acc: 0.728
Validation loss decreased (-0.672213 --> -0.727769).  Saving model ...
Epoch: 12 cost time: 2.4827802181243896
Epoch: 12, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.844 Vali Acc: 0.706 Test Loss: 0.844 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3496932983398438
Epoch: 13, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.780 Vali Acc: 0.728 Test Loss: 0.780 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727770).  Saving model ...
Epoch: 14 cost time: 2.4240880012512207
Epoch: 14, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.755 Vali Acc: 0.744 Test Loss: 0.755 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744437).  Saving model ...
Epoch: 15 cost time: 2.450317144393921
Epoch: 15, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.772 Vali Acc: 0.733 Test Loss: 0.772 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3652167320251465
Epoch: 16, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.749 Vali Acc: 0.783 Test Loss: 0.749 Test Acc: 0.783
Validation loss decreased (-0.744437 --> -0.783326).  Saving model ...
Epoch: 17 cost time: 2.3169660568237305
Epoch: 17, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.775 Vali Acc: 0.733 Test Loss: 0.775 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.624518871307373
Epoch: 18, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.734 Vali Acc: 0.767 Test Loss: 0.734 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5858891010284424
Epoch: 19, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.769 Vali Acc: 0.761 Test Loss: 0.769 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1866869926452637
Epoch: 20, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.722 Vali Acc: 0.783 Test Loss: 0.722 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 21 cost time: 2.4894442558288574
Epoch: 21, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.786 Vali Acc: 0.761 Test Loss: 0.786 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5432512760162354
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.721 Vali Acc: 0.778 Test Loss: 0.721 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3405206203460693
Epoch: 23, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.695 Vali Acc: 0.772 Test Loss: 0.695 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4828884601593018
Epoch: 24, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.710 Vali Acc: 0.817 Test Loss: 0.710 Test Acc: 0.817
Validation loss decreased (-0.783326 --> -0.816660).  Saving model ...
Epoch: 25 cost time: 2.5004427433013916
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.726 Vali Acc: 0.806 Test Loss: 0.726 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3753883838653564
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.728 Vali Acc: 0.794 Test Loss: 0.728 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1659533977508545
Epoch: 27, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.713 Vali Acc: 0.800 Test Loss: 0.713 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.611612558364868
Epoch: 28, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.702 Vali Acc: 0.800 Test Loss: 0.702 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.4553542137145996
Epoch: 29, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.654 Vali Acc: 0.817 Test Loss: 0.654 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 30 cost time: 2.2825231552124023
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.674 Vali Acc: 0.833 Test Loss: 0.674 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 5552079
model size : 22.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.355026006698608
Epoch: 1, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.589 Vali Acc: 0.200 Test Loss: 2.589 Test Acc: 0.200
Validation loss decreased (inf --> -0.199974).  Saving model ...
Epoch: 2 cost time: 6.287397384643555
Epoch: 2, Steps: 12 | Train Loss: 2.443 Vali Loss: 2.238 Vali Acc: 0.394 Test Loss: 2.238 Test Acc: 0.394
Validation loss decreased (-0.199974 --> -0.394422).  Saving model ...
Epoch: 3 cost time: 7.007493019104004
Epoch: 3, Steps: 12 | Train Loss: 1.977 Vali Loss: 1.851 Vali Acc: 0.494 Test Loss: 1.851 Test Acc: 0.494
Validation loss decreased (-0.394422 --> -0.494426).  Saving model ...
Epoch: 4 cost time: 6.094660043716431
Epoch: 4, Steps: 12 | Train Loss: 1.519 Vali Loss: 1.511 Vali Acc: 0.572 Test Loss: 1.511 Test Acc: 0.572
Validation loss decreased (-0.494426 --> -0.572207).  Saving model ...
Epoch: 5 cost time: 6.379942417144775
Epoch: 5, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.235 Vali Acc: 0.633 Test Loss: 1.235 Test Acc: 0.633
Validation loss decreased (-0.572207 --> -0.633321).  Saving model ...
Epoch: 6 cost time: 6.290395021438599
Epoch: 6, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.079 Vali Acc: 0.650 Test Loss: 1.079 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 6.608566999435425
Epoch: 7, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.933 Vali Acc: 0.672 Test Loss: 0.933 Test Acc: 0.672
Validation loss decreased (-0.649989 --> -0.672213).  Saving model ...
Epoch: 8 cost time: 5.804583311080933
Epoch: 8, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.795 Vali Acc: 0.728 Test Loss: 0.795 Test Acc: 0.728
Validation loss decreased (-0.672213 --> -0.727770).  Saving model ...
Epoch: 9 cost time: 6.09269380569458
Epoch: 9, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.772 Vali Acc: 0.700 Test Loss: 0.772 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.574065446853638
Epoch: 10, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.694 Vali Acc: 0.733 Test Loss: 0.694 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733326).  Saving model ...
Epoch: 11 cost time: 5.699306964874268
Epoch: 11, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.669 Vali Acc: 0.744 Test Loss: 0.669 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744438).  Saving model ...
Epoch: 12 cost time: 5.527822971343994
Epoch: 12, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.640 Vali Acc: 0.756 Test Loss: 0.640 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 13 cost time: 6.301112413406372
Epoch: 13, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.642 Vali Acc: 0.767 Test Loss: 0.642 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 14 cost time: 6.154811859130859
Epoch: 14, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.658 Vali Acc: 0.772 Test Loss: 0.658 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 15 cost time: 6.442388534545898
Epoch: 15, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783327).  Saving model ...
Epoch: 16 cost time: 5.784427165985107
Epoch: 16, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.655 Vali Acc: 0.778 Test Loss: 0.655 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.81553316116333
Epoch: 17, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.625 Vali Acc: 0.794 Test Loss: 0.625 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794438).  Saving model ...
Epoch: 18 cost time: 5.71380877494812
Epoch: 18, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.136986255645752
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.653 Vali Acc: 0.794 Test Loss: 0.653 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.063604116439819
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.023 Vali Acc: 0.717 Test Loss: 1.023 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.186002016067505
Epoch: 21, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 6.102820873260498
Epoch: 22, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.752 Vali Acc: 0.778 Test Loss: 0.752 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.539712190628052
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.387771368026733
Epoch: 24, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.714 Vali Acc: 0.772 Test Loss: 0.714 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.963178396224976
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.702 Vali Acc: 0.789 Test Loss: 0.702 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.087949275970459
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.722 Vali Acc: 0.817 Test Loss: 0.722 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816659).  Saving model ...
Epoch: 27 cost time: 5.718249320983887
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.676 Vali Acc: 0.811 Test Loss: 0.676 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 7.042675971984863
Epoch: 28, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.628 Vali Acc: 0.817 Test Loss: 0.628 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 29 cost time: 6.728963613510132
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.985233783721924
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.656 Vali Acc: 0.828 Test Loss: 0.656 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 9418703
model size : 37.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.4282166957855225
Epoch: 1, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.677 Vali Acc: 0.144 Test Loss: 2.677 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 3.7251288890838623
Epoch: 2, Steps: 12 | Train Loss: 2.468 Vali Loss: 2.317 Vali Acc: 0.394 Test Loss: 2.317 Test Acc: 0.394
Validation loss decreased (-0.144418 --> -0.394421).  Saving model ...
Epoch: 3 cost time: 3.599400043487549
Epoch: 3, Steps: 12 | Train Loss: 2.055 Vali Loss: 1.916 Vali Acc: 0.500 Test Loss: 1.916 Test Acc: 0.500
Validation loss decreased (-0.394421 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 3.3827803134918213
Epoch: 4, Steps: 12 | Train Loss: 1.569 Vali Loss: 1.575 Vali Acc: 0.567 Test Loss: 1.575 Test Acc: 0.567
Validation loss decreased (-0.499981 --> -0.566651).  Saving model ...
Epoch: 5 cost time: 3.7968056201934814
Epoch: 5, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.312 Vali Acc: 0.583 Test Loss: 1.312 Test Acc: 0.583
Validation loss decreased (-0.566651 --> -0.583320).  Saving model ...
Epoch: 6 cost time: 3.74055552482605
Epoch: 6, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.121 Vali Acc: 0.639 Test Loss: 1.121 Test Acc: 0.639
Validation loss decreased (-0.583320 --> -0.638878).  Saving model ...
Epoch: 7 cost time: 3.5750954151153564
Epoch: 7, Steps: 12 | Train Loss: 0.787 Vali Loss: 0.959 Vali Acc: 0.694 Test Loss: 0.959 Test Acc: 0.694
Validation loss decreased (-0.638878 --> -0.694435).  Saving model ...
Epoch: 8 cost time: 3.626694679260254
Epoch: 8, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.863 Vali Acc: 0.706 Test Loss: 0.863 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705547).  Saving model ...
Epoch: 9 cost time: 3.7394676208496094
Epoch: 9, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.774 Vali Acc: 0.717 Test Loss: 0.774 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716659).  Saving model ...
Epoch: 10 cost time: 3.7710177898406982
Epoch: 10, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.738 Vali Acc: 0.761 Test Loss: 0.738 Test Acc: 0.761
Validation loss decreased (-0.716659 --> -0.761104).  Saving model ...
Epoch: 11 cost time: 3.5769431591033936
Epoch: 11, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.687 Vali Acc: 0.767 Test Loss: 0.687 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 12 cost time: 3.6948130130767822
Epoch: 12, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.661 Vali Acc: 0.744 Test Loss: 0.661 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7250006198883057
Epoch: 13, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.658 Vali Acc: 0.761 Test Loss: 0.658 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.567042827606201
Epoch: 14, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.628 Vali Acc: 0.772 Test Loss: 0.628 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 15 cost time: 3.4760303497314453
Epoch: 15, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.624 Vali Acc: 0.817 Test Loss: 0.624 Test Acc: 0.817
Validation loss decreased (-0.772216 --> -0.816660).  Saving model ...
Epoch: 16 cost time: 3.7626333236694336
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.649 Vali Acc: 0.789 Test Loss: 0.649 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.738938808441162
Epoch: 17, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3518433570861816
Epoch: 18, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.638 Vali Acc: 0.794 Test Loss: 0.638 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.4403910636901855
Epoch: 19, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.666 Vali Acc: 0.783 Test Loss: 0.666 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.7461585998535156
Epoch: 20, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.690 Vali Acc: 0.794 Test Loss: 0.690 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.706664800643921
Epoch: 21, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.713 Vali Acc: 0.794 Test Loss: 0.713 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.563694715499878
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.718 Vali Acc: 0.794 Test Loss: 0.718 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.531703472137451
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.719 Vali Acc: 0.794 Test Loss: 0.719 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.796682596206665
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.710 Vali Acc: 0.794 Test Loss: 0.710 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.6870803833007812
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.730 Vali Acc: 0.783 Test Loss: 0.730 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 2798543
model size : 11.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.296631336212158
Epoch: 1, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.589 Vali Acc: 0.200 Test Loss: 2.589 Test Acc: 0.200
Validation loss decreased (inf --> -0.199974).  Saving model ...
Epoch: 2 cost time: 4.940437078475952
Epoch: 2, Steps: 12 | Train Loss: 2.443 Vali Loss: 2.236 Vali Acc: 0.394 Test Loss: 2.236 Test Acc: 0.394
Validation loss decreased (-0.199974 --> -0.394422).  Saving model ...
Epoch: 3 cost time: 5.198919296264648
Epoch: 3, Steps: 12 | Train Loss: 1.978 Vali Loss: 1.849 Vali Acc: 0.494 Test Loss: 1.849 Test Acc: 0.494
Validation loss decreased (-0.394422 --> -0.494426).  Saving model ...
Epoch: 4 cost time: 5.574935674667358
Epoch: 4, Steps: 12 | Train Loss: 1.524 Vali Loss: 1.509 Vali Acc: 0.572 Test Loss: 1.509 Test Acc: 0.572
Validation loss decreased (-0.494426 --> -0.572207).  Saving model ...
Epoch: 5 cost time: 5.111559152603149
Epoch: 5, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.234 Vali Acc: 0.633 Test Loss: 1.234 Test Acc: 0.633
Validation loss decreased (-0.572207 --> -0.633321).  Saving model ...
Epoch: 6 cost time: 5.491140127182007
Epoch: 6, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.081 Vali Acc: 0.656 Test Loss: 1.081 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655545).  Saving model ...
Epoch: 7 cost time: 5.318222522735596
Epoch: 7, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.938 Vali Acc: 0.672 Test Loss: 0.938 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672213).  Saving model ...
Epoch: 8 cost time: 5.198088645935059
Epoch: 8, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.797 Vali Acc: 0.733 Test Loss: 0.797 Test Acc: 0.733
Validation loss decreased (-0.672213 --> -0.733325).  Saving model ...
Epoch: 9 cost time: 5.590413331985474
Epoch: 9, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.778 Vali Acc: 0.700 Test Loss: 0.778 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.337871789932251
Epoch: 10, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.712 Vali Acc: 0.728 Test Loss: 0.712 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.852102041244507
Epoch: 11, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.687 Vali Acc: 0.706 Test Loss: 0.687 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.583378791809082
Epoch: 12, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.662 Vali Acc: 0.750 Test Loss: 0.662 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 4.89905309677124
Epoch: 13, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.652 Vali Acc: 0.744 Test Loss: 0.652 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.2374279499053955
Epoch: 14, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.666 Vali Acc: 0.778 Test Loss: 0.666 Test Acc: 0.778
Validation loss decreased (-0.749993 --> -0.777771).  Saving model ...
Epoch: 15 cost time: 5.536322593688965
Epoch: 15, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.657 Vali Acc: 0.783 Test Loss: 0.657 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 16 cost time: 4.8797149658203125
Epoch: 16, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
Validation loss decreased (-0.783327 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 5.084618806838989
Epoch: 17, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.639 Vali Acc: 0.806 Test Loss: 0.639 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 18 cost time: 5.294733285903931
Epoch: 18, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.652 Vali Acc: 0.800 Test Loss: 0.652 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.710217475891113
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.665 Vali Acc: 0.806 Test Loss: 0.665 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.033125638961792
Epoch: 20, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.697 Vali Acc: 0.789 Test Loss: 0.697 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.771239519119263
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.654 Vali Acc: 0.811 Test Loss: 0.654 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 22 cost time: 5.059483766555786
Epoch: 22, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.751 Vali Acc: 0.772 Test Loss: 0.751 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.0088231563568115
Epoch: 23, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.754 Vali Acc: 0.789 Test Loss: 0.754 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.781153678894043
Epoch: 24, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.713 Vali Acc: 0.789 Test Loss: 0.713 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.038968086242676
Epoch: 25, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.107578754425049
Epoch: 26, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.698 Vali Acc: 0.772 Test Loss: 0.698 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.1193530559539795
Epoch: 27, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.806 Vali Acc: 0.778 Test Loss: 0.806 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.944212436676025
Epoch: 28, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.757 Vali Acc: 0.789 Test Loss: 0.757 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.244181871414185
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.724 Vali Acc: 0.806 Test Loss: 0.724 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.588872909545898
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.694 Vali Acc: 0.806 Test Loss: 0.694 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 9418703
model size : 37.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.497771739959717
Epoch: 1, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.677 Vali Acc: 0.144 Test Loss: 2.677 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 2.810142993927002
Epoch: 2, Steps: 12 | Train Loss: 2.468 Vali Loss: 2.316 Vali Acc: 0.394 Test Loss: 2.316 Test Acc: 0.394
Validation loss decreased (-0.144418 --> -0.394421).  Saving model ...
Epoch: 3 cost time: 2.8286774158477783
Epoch: 3, Steps: 12 | Train Loss: 2.055 Vali Loss: 1.914 Vali Acc: 0.500 Test Loss: 1.914 Test Acc: 0.500
Validation loss decreased (-0.394421 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 2.930013656616211
Epoch: 4, Steps: 12 | Train Loss: 1.569 Vali Loss: 1.573 Vali Acc: 0.567 Test Loss: 1.573 Test Acc: 0.567
Validation loss decreased (-0.499981 --> -0.566651).  Saving model ...
Epoch: 5 cost time: 2.8696985244750977
Epoch: 5, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.310 Vali Acc: 0.583 Test Loss: 1.310 Test Acc: 0.583
Validation loss decreased (-0.566651 --> -0.583320).  Saving model ...
Epoch: 6 cost time: 2.961583375930786
Epoch: 6, Steps: 12 | Train Loss: 1.010 Vali Loss: 1.119 Vali Acc: 0.633 Test Loss: 1.119 Test Acc: 0.633
Validation loss decreased (-0.583320 --> -0.633322).  Saving model ...
Epoch: 7 cost time: 2.819866418838501
Epoch: 7, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.962 Vali Acc: 0.689 Test Loss: 0.962 Test Acc: 0.689
Validation loss decreased (-0.633322 --> -0.688879).  Saving model ...
Epoch: 8 cost time: 2.8328568935394287
Epoch: 8, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.872 Vali Acc: 0.694 Test Loss: 0.872 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694436).  Saving model ...
Epoch: 9 cost time: 2.954392194747925
Epoch: 9, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.800 Vali Acc: 0.717 Test Loss: 0.800 Test Acc: 0.717
Validation loss decreased (-0.694436 --> -0.716659).  Saving model ...
Epoch: 10 cost time: 2.9949095249176025
Epoch: 10, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.773 Vali Acc: 0.739 Test Loss: 0.773 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738881).  Saving model ...
Epoch: 11 cost time: 2.850816249847412
Epoch: 11, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.719 Vali Acc: 0.733 Test Loss: 0.719 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.768030881881714
Epoch: 12, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.675 Vali Acc: 0.739 Test Loss: 0.675 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 3.073223352432251
Epoch: 13, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.687 Vali Acc: 0.761 Test Loss: 0.687 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761104).  Saving model ...
Epoch: 14 cost time: 2.7845678329467773
Epoch: 14, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.636 Vali Acc: 0.772 Test Loss: 0.636 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772216).  Saving model ...
Epoch: 15 cost time: 2.7343156337738037
Epoch: 15, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.644 Vali Acc: 0.794 Test Loss: 0.644 Test Acc: 0.794
Validation loss decreased (-0.772216 --> -0.794438).  Saving model ...
Epoch: 16 cost time: 2.9664461612701416
Epoch: 16, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.678 Vali Acc: 0.772 Test Loss: 0.678 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0956408977508545
Epoch: 17, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.636 Vali Acc: 0.789 Test Loss: 0.636 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9143359661102295
Epoch: 18, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.653 Vali Acc: 0.778 Test Loss: 0.653 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.8463518619537354
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.671 Vali Acc: 0.778 Test Loss: 0.671 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9466090202331543
Epoch: 20, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.696 Vali Acc: 0.794 Test Loss: 0.696 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.762312889099121
Epoch: 21, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.701 Vali Acc: 0.789 Test Loss: 0.701 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.002923011779785
Epoch: 22, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.704 Vali Acc: 0.806 Test Loss: 0.704 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805549).  Saving model ...
Epoch: 23 cost time: 2.9530410766601562
Epoch: 23, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.709 Vali Acc: 0.800 Test Loss: 0.709 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.8713619709014893
Epoch: 24, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.716 Vali Acc: 0.800 Test Loss: 0.716 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.868332862854004
Epoch: 25, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.706 Vali Acc: 0.778 Test Loss: 0.706 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.0598247051239014
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.705 Vali Acc: 0.794 Test Loss: 0.705 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.915170431137085
Epoch: 27, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.758 Vali Acc: 0.778 Test Loss: 0.758 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.858478307723999
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.686 Vali Acc: 0.806 Test Loss: 0.686 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 29 cost time: 2.8857831954956055
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.758 Vali Acc: 0.811 Test Loss: 0.758 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811104).  Saving model ...
Epoch: 30 cost time: 3.0532515048980713
Epoch: 30, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.735 Vali Acc: 0.800 Test Loss: 0.735 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 2798543
model size : 11.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.803955793380737
Epoch: 1, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.613 Vali Acc: 0.189 Test Loss: 2.613 Test Acc: 0.189
Validation loss decreased (inf --> -0.188863).  Saving model ...
Epoch: 2 cost time: 3.306540012359619
Epoch: 2, Steps: 12 | Train Loss: 2.501 Vali Loss: 2.331 Vali Acc: 0.322 Test Loss: 2.331 Test Acc: 0.322
Validation loss decreased (-0.188863 --> -0.322199).  Saving model ...
Epoch: 3 cost time: 3.31577467918396
Epoch: 3, Steps: 12 | Train Loss: 2.106 Vali Loss: 2.015 Vali Acc: 0.494 Test Loss: 2.015 Test Acc: 0.494
Validation loss decreased (-0.322199 --> -0.494424).  Saving model ...
Epoch: 4 cost time: 3.2371480464935303
Epoch: 4, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.724 Vali Acc: 0.578 Test Loss: 1.724 Test Acc: 0.578
Validation loss decreased (-0.494424 --> -0.577761).  Saving model ...
Epoch: 5 cost time: 3.3628363609313965
Epoch: 5, Steps: 12 | Train Loss: 1.405 Vali Loss: 1.476 Vali Acc: 0.600 Test Loss: 1.476 Test Acc: 0.600
Validation loss decreased (-0.577761 --> -0.599985).  Saving model ...
Epoch: 6 cost time: 3.2240967750549316
Epoch: 6, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.311 Vali Acc: 0.600 Test Loss: 1.311 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 3.319718599319458
Epoch: 7, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.155 Vali Acc: 0.617 Test Loss: 1.155 Test Acc: 0.617
Validation loss decreased (-0.599987 --> -0.616655).  Saving model ...
Epoch: 8 cost time: 3.3416121006011963
Epoch: 8, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.997 Vali Acc: 0.678 Test Loss: 0.997 Test Acc: 0.678
Validation loss decreased (-0.616655 --> -0.677768).  Saving model ...
Epoch: 9 cost time: 3.198364019393921
Epoch: 9, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.934 Vali Acc: 0.678 Test Loss: 0.934 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677768).  Saving model ...
Epoch: 10 cost time: 3.0561351776123047
Epoch: 10, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.827 Vali Acc: 0.689 Test Loss: 0.827 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688881).  Saving model ...
Epoch: 11 cost time: 3.2897391319274902
Epoch: 11, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.790 Vali Acc: 0.717 Test Loss: 0.790 Test Acc: 0.717
Validation loss decreased (-0.688881 --> -0.716659).  Saving model ...
Epoch: 12 cost time: 2.7499706745147705
Epoch: 12, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.751 Vali Acc: 0.722 Test Loss: 0.751 Test Acc: 0.722
Validation loss decreased (-0.716659 --> -0.722215).  Saving model ...
Epoch: 13 cost time: 3.168619394302368
Epoch: 13, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 3.01051664352417
Epoch: 14, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.710 Vali Acc: 0.783 Test Loss: 0.710 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783326).  Saving model ...
Epoch: 15 cost time: 3.204054594039917
Epoch: 15, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.662 Vali Acc: 0.789 Test Loss: 0.662 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 2.8295087814331055
Epoch: 16, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 3.1393237113952637
Epoch: 17, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.681 Vali Acc: 0.800 Test Loss: 0.681 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.786583662033081
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.718 Vali Acc: 0.772 Test Loss: 0.718 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.897212028503418
Epoch: 19, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.4499926567077637
Epoch: 20, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 3.5307581424713135
Epoch: 21, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.644 Vali Acc: 0.817 Test Loss: 0.644 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 22 cost time: 3.5546727180480957
Epoch: 22, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.586 Vali Acc: 0.811 Test Loss: 0.586 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2588236331939697
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 3.282869577407837
Epoch: 24, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.655 Vali Acc: 0.806 Test Loss: 0.655 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.279052972793579
Epoch: 25, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.583 Vali Acc: 0.839 Test Loss: 0.583 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 26 cost time: 3.3580470085144043
Epoch: 26, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.622 Vali Acc: 0.811 Test Loss: 0.622 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4870314598083496
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.649 Vali Acc: 0.794 Test Loss: 0.649 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.5569088459014893
Epoch: 28, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.653 Vali Acc: 0.800 Test Loss: 0.653 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.545250654220581
Epoch: 29, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.3940117359161377
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 9418703
model size : 37.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6491618156433105
Epoch: 1, Steps: 12 | Train Loss: 2.753 Vali Loss: 2.705 Vali Acc: 0.072 Test Loss: 2.705 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 2.110651731491089
Epoch: 2, Steps: 12 | Train Loss: 2.538 Vali Loss: 2.395 Vali Acc: 0.367 Test Loss: 2.395 Test Acc: 0.367
Validation loss decreased (-0.072195 --> -0.366643).  Saving model ...
Epoch: 3 cost time: 2.363924980163574
Epoch: 3, Steps: 12 | Train Loss: 2.187 Vali Loss: 2.053 Vali Acc: 0.500 Test Loss: 2.053 Test Acc: 0.500
Validation loss decreased (-0.366643 --> -0.499979).  Saving model ...
Epoch: 4 cost time: 2.193455934524536
Epoch: 4, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.765 Vali Acc: 0.544 Test Loss: 1.765 Test Acc: 0.544
Validation loss decreased (-0.499979 --> -0.544427).  Saving model ...
Epoch: 5 cost time: 2.3581619262695312
Epoch: 5, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.531 Vali Acc: 0.533 Test Loss: 1.531 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.276071071624756
Epoch: 6, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.360 Vali Acc: 0.583 Test Loss: 1.360 Test Acc: 0.583
Validation loss decreased (-0.544427 --> -0.583320).  Saving model ...
Epoch: 7 cost time: 2.056729555130005
Epoch: 7, Steps: 12 | Train Loss: 1.028 Vali Loss: 1.209 Vali Acc: 0.633 Test Loss: 1.209 Test Acc: 0.633
Validation loss decreased (-0.583320 --> -0.633321).  Saving model ...
Epoch: 8 cost time: 2.2153589725494385
Epoch: 8, Steps: 12 | Train Loss: 0.867 Vali Loss: 1.095 Vali Acc: 0.639 Test Loss: 1.095 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638878).  Saving model ...
Epoch: 9 cost time: 2.0055370330810547
Epoch: 9, Steps: 12 | Train Loss: 0.808 Vali Loss: 1.003 Vali Acc: 0.667 Test Loss: 1.003 Test Acc: 0.667
Validation loss decreased (-0.638878 --> -0.666657).  Saving model ...
Epoch: 10 cost time: 2.0703017711639404
Epoch: 10, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.949 Vali Acc: 0.689 Test Loss: 0.949 Test Acc: 0.689
Validation loss decreased (-0.666657 --> -0.688879).  Saving model ...
Epoch: 11 cost time: 2.1421313285827637
Epoch: 11, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.880 Vali Acc: 0.700 Test Loss: 0.880 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 2.198939561843872
Epoch: 12, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.799 Vali Acc: 0.733 Test Loss: 0.799 Test Acc: 0.733
Validation loss decreased (-0.699991 --> -0.733325).  Saving model ...
Epoch: 13 cost time: 2.342717170715332
Epoch: 13, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.788 Vali Acc: 0.744 Test Loss: 0.788 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744437).  Saving model ...
Epoch: 14 cost time: 2.2205865383148193
Epoch: 14, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.736 Vali Acc: 0.761 Test Loss: 0.736 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 2.188835859298706
Epoch: 15, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.735 Vali Acc: 0.783 Test Loss: 0.735 Test Acc: 0.783
Validation loss decreased (-0.761104 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 2.3231279850006104
Epoch: 16, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.718 Vali Acc: 0.789 Test Loss: 0.718 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 17 cost time: 2.1666789054870605
Epoch: 17, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.690 Vali Acc: 0.806 Test Loss: 0.690 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 18 cost time: 2.2094874382019043
Epoch: 18, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.687 Vali Acc: 0.800 Test Loss: 0.687 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.186878204345703
Epoch: 19, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.750 Vali Acc: 0.794 Test Loss: 0.750 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0685412883758545
Epoch: 20, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.729 Vali Acc: 0.783 Test Loss: 0.729 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2090704441070557
Epoch: 21, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.746 Vali Acc: 0.778 Test Loss: 0.746 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.190201997756958
Epoch: 22, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.740 Vali Acc: 0.794 Test Loss: 0.740 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3724498748779297
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.717 Vali Acc: 0.800 Test Loss: 0.717 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.2298331260681152
Epoch: 24, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.708 Vali Acc: 0.794 Test Loss: 0.708 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.2278225421905518
Epoch: 25, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.701 Vali Acc: 0.800 Test Loss: 0.701 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.227774143218994
Epoch: 26, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.717 Vali Acc: 0.817 Test Loss: 0.717 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816659).  Saving model ...
Epoch: 27 cost time: 2.0866236686706543
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.742 Vali Acc: 0.794 Test Loss: 0.742 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9963204860687256
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.650 Vali Acc: 0.822 Test Loss: 0.650 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822216).  Saving model ...
Epoch: 29 cost time: 2.108083963394165
Epoch: 29, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.744 Vali Acc: 0.822 Test Loss: 0.744 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.109866142272949
Epoch: 30, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 2798543
model size : 11.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.676503896713257
Epoch: 1, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.548 Vali Acc: 0.206 Test Loss: 2.548 Test Acc: 0.206
Validation loss decreased (inf --> -0.205530).  Saving model ...
Epoch: 2 cost time: 6.285145044326782
Epoch: 2, Steps: 12 | Train Loss: 2.486 Vali Loss: 2.288 Vali Acc: 0.417 Test Loss: 2.288 Test Acc: 0.417
Validation loss decreased (-0.205530 --> -0.416644).  Saving model ...
Epoch: 3 cost time: 6.0487284660339355
Epoch: 3, Steps: 12 | Train Loss: 2.171 Vali Loss: 1.991 Vali Acc: 0.533 Test Loss: 1.991 Test Acc: 0.533
Validation loss decreased (-0.416644 --> -0.533313).  Saving model ...
Epoch: 4 cost time: 6.202361345291138
Epoch: 4, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.726 Vali Acc: 0.561 Test Loss: 1.726 Test Acc: 0.561
Validation loss decreased (-0.533313 --> -0.561094).  Saving model ...
Epoch: 5 cost time: 6.5544304847717285
Epoch: 5, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.492 Vali Acc: 0.594 Test Loss: 1.492 Test Acc: 0.594
Validation loss decreased (-0.561094 --> -0.594430).  Saving model ...
Epoch: 6 cost time: 6.7416887283325195
Epoch: 6, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.291 Vali Acc: 0.650 Test Loss: 1.291 Test Acc: 0.650
Validation loss decreased (-0.594430 --> -0.649987).  Saving model ...
Epoch: 7 cost time: 6.377382040023804
Epoch: 7, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.148 Vali Acc: 0.672 Test Loss: 1.148 Test Acc: 0.672
Validation loss decreased (-0.649987 --> -0.672211).  Saving model ...
Epoch: 8 cost time: 6.490811824798584
Epoch: 8, Steps: 12 | Train Loss: 0.929 Vali Loss: 1.028 Vali Acc: 0.667 Test Loss: 1.028 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.700305223464966
Epoch: 9, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.937 Vali Acc: 0.683 Test Loss: 0.937 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683324).  Saving model ...
Epoch: 10 cost time: 6.201702356338501
Epoch: 10, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.858 Vali Acc: 0.706 Test Loss: 0.858 Test Acc: 0.706
Validation loss decreased (-0.683324 --> -0.705547).  Saving model ...
Epoch: 11 cost time: 6.827162265777588
Epoch: 11, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.834 Vali Acc: 0.706 Test Loss: 0.834 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 12 cost time: 6.758223533630371
Epoch: 12, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.746 Vali Acc: 0.756 Test Loss: 0.746 Test Acc: 0.756
Validation loss decreased (-0.705547 --> -0.755548).  Saving model ...
Epoch: 13 cost time: 7.025689363479614
Epoch: 13, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.718 Vali Acc: 0.739 Test Loss: 0.718 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.45087194442749
Epoch: 14, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.694 Vali Acc: 0.756 Test Loss: 0.694 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755549).  Saving model ...
Epoch: 15 cost time: 6.953640699386597
Epoch: 15, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.675 Vali Acc: 0.767 Test Loss: 0.675 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 16 cost time: 6.931949615478516
Epoch: 16, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.744 Vali Acc: 0.733 Test Loss: 0.744 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.71144962310791
Epoch: 17, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.689 Vali Acc: 0.733 Test Loss: 0.689 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.3022379875183105
Epoch: 18, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.721 Vali Acc: 0.750 Test Loss: 0.721 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.144875764846802
Epoch: 19, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.678 Vali Acc: 0.772 Test Loss: 0.678 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772215).  Saving model ...
Epoch: 20 cost time: 6.67400336265564
Epoch: 20, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.681 Vali Acc: 0.756 Test Loss: 0.681 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.702138900756836
Epoch: 21, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.710 Vali Acc: 0.761 Test Loss: 0.710 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.770681619644165
Epoch: 22, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.689 Vali Acc: 0.783 Test Loss: 0.689 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 23 cost time: 7.583354473114014
Epoch: 23, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.718 Vali Acc: 0.772 Test Loss: 0.718 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.846397876739502
Epoch: 24, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.618 Vali Acc: 0.761 Test Loss: 0.618 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.913272380828857
Epoch: 25, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.659 Vali Acc: 0.778 Test Loss: 0.659 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.548311233520508
Epoch: 26, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.612 Vali Acc: 0.794 Test Loss: 0.612 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 27 cost time: 7.199660301208496
Epoch: 27, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.657 Vali Acc: 0.783 Test Loss: 0.657 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 7.2145912647247314
Epoch: 28, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.676 Vali Acc: 0.772 Test Loss: 0.676 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.65959095954895
Epoch: 29, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.681 Vali Acc: 0.789 Test Loss: 0.681 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.863247632980347
Epoch: 30, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.703 Vali Acc: 0.767 Test Loss: 0.703 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 9397487
model size : 36.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.796558141708374
Epoch: 1, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.595 Vali Acc: 0.078 Test Loss: 2.595 Test Acc: 0.078
Validation loss decreased (inf --> -0.077752).  Saving model ...
Epoch: 2 cost time: 3.857701063156128
Epoch: 2, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.379 Vali Acc: 0.256 Test Loss: 2.379 Test Acc: 0.256
Validation loss decreased (-0.077752 --> -0.255532).  Saving model ...
Epoch: 3 cost time: 3.6553354263305664
Epoch: 3, Steps: 12 | Train Loss: 2.221 Vali Loss: 2.136 Vali Acc: 0.461 Test Loss: 2.136 Test Acc: 0.461
Validation loss decreased (-0.255532 --> -0.461090).  Saving model ...
Epoch: 4 cost time: 3.7744057178497314
Epoch: 4, Steps: 12 | Train Loss: 1.932 Vali Loss: 1.869 Vali Acc: 0.517 Test Loss: 1.869 Test Acc: 0.517
Validation loss decreased (-0.461090 --> -0.516648).  Saving model ...
Epoch: 5 cost time: 3.590759038925171
Epoch: 5, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.627 Vali Acc: 0.578 Test Loss: 1.627 Test Acc: 0.578
Validation loss decreased (-0.516648 --> -0.577762).  Saving model ...
Epoch: 6 cost time: 3.798731565475464
Epoch: 6, Steps: 12 | Train Loss: 1.409 Vali Loss: 1.429 Vali Acc: 0.617 Test Loss: 1.429 Test Acc: 0.617
Validation loss decreased (-0.577762 --> -0.616652).  Saving model ...
Epoch: 7 cost time: 3.8411107063293457
Epoch: 7, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.277 Vali Acc: 0.644 Test Loss: 1.277 Test Acc: 0.644
Validation loss decreased (-0.616652 --> -0.644432).  Saving model ...
Epoch: 8 cost time: 3.8586807250976562
Epoch: 8, Steps: 12 | Train Loss: 1.037 Vali Loss: 1.139 Vali Acc: 0.672 Test Loss: 1.139 Test Acc: 0.672
Validation loss decreased (-0.644432 --> -0.672211).  Saving model ...
Epoch: 9 cost time: 4.008830547332764
Epoch: 9, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.043 Vali Acc: 0.667 Test Loss: 1.043 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.707366704940796
Epoch: 10, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.950 Vali Acc: 0.711 Test Loss: 0.950 Test Acc: 0.711
Validation loss decreased (-0.672211 --> -0.711102).  Saving model ...
Epoch: 11 cost time: 3.5299410820007324
Epoch: 11, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.861 Vali Acc: 0.711 Test Loss: 0.861 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711103).  Saving model ...
Epoch: 12 cost time: 3.707273244857788
Epoch: 12, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.808 Vali Acc: 0.728 Test Loss: 0.808 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 13 cost time: 3.5791499614715576
Epoch: 13, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.747 Vali Acc: 0.706 Test Loss: 0.747 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8086140155792236
Epoch: 14, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.710 Vali Acc: 0.750 Test Loss: 0.710 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 4.015320301055908
Epoch: 15, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.695 Vali Acc: 0.744 Test Loss: 0.695 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6456503868103027
Epoch: 16, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.680 Vali Acc: 0.756 Test Loss: 0.680 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 17 cost time: 3.542889356613159
Epoch: 17, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.647 Vali Acc: 0.767 Test Loss: 0.647 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 18 cost time: 3.602745771408081
Epoch: 18, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.660 Vali Acc: 0.733 Test Loss: 0.660 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.350466012954712
Epoch: 19, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.615 Vali Acc: 0.778 Test Loss: 0.615 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777772).  Saving model ...
Epoch: 20 cost time: 3.2949414253234863
Epoch: 20, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.650 Vali Acc: 0.767 Test Loss: 0.650 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.698011875152588
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783327).  Saving model ...
Epoch: 22 cost time: 3.654308319091797
Epoch: 22, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.628 Vali Acc: 0.772 Test Loss: 0.628 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6567306518554688
Epoch: 23, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.631 Vali Acc: 0.778 Test Loss: 0.631 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.764162063598633
Epoch: 24, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.366734027862549
Epoch: 25, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788882).  Saving model ...
Epoch: 26 cost time: 3.644498348236084
Epoch: 26, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.635 Vali Acc: 0.817 Test Loss: 0.635 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 27 cost time: 3.448890447616577
Epoch: 27, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.633 Vali Acc: 0.794 Test Loss: 0.633 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.43843936920166
Epoch: 28, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.645 Vali Acc: 0.794 Test Loss: 0.645 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.860435962677002
Epoch: 29, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.653 Vali Acc: 0.811 Test Loss: 0.653 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.7537291049957275
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.692 Vali Acc: 0.778 Test Loss: 0.692 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 2777071
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.922717571258545
Epoch: 1, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.548 Vali Acc: 0.206 Test Loss: 2.548 Test Acc: 0.206
Validation loss decreased (inf --> -0.205530).  Saving model ...
Epoch: 2 cost time: 5.124276638031006
Epoch: 2, Steps: 12 | Train Loss: 2.486 Vali Loss: 2.287 Vali Acc: 0.417 Test Loss: 2.287 Test Acc: 0.417
Validation loss decreased (-0.205530 --> -0.416644).  Saving model ...
Epoch: 3 cost time: 5.355945110321045
Epoch: 3, Steps: 12 | Train Loss: 2.172 Vali Loss: 1.989 Vali Acc: 0.533 Test Loss: 1.989 Test Acc: 0.533
Validation loss decreased (-0.416644 --> -0.533313).  Saving model ...
Epoch: 4 cost time: 5.467947959899902
Epoch: 4, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.724 Vali Acc: 0.556 Test Loss: 1.724 Test Acc: 0.556
Validation loss decreased (-0.533313 --> -0.555538).  Saving model ...
Epoch: 5 cost time: 5.476610422134399
Epoch: 5, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.488 Vali Acc: 0.600 Test Loss: 1.488 Test Acc: 0.600
Validation loss decreased (-0.555538 --> -0.599985).  Saving model ...
Epoch: 6 cost time: 5.067925453186035
Epoch: 6, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.285 Vali Acc: 0.650 Test Loss: 1.285 Test Acc: 0.650
Validation loss decreased (-0.599985 --> -0.649987).  Saving model ...
Epoch: 7 cost time: 5.104660511016846
Epoch: 7, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.140 Vali Acc: 0.672 Test Loss: 1.140 Test Acc: 0.672
Validation loss decreased (-0.649987 --> -0.672211).  Saving model ...
Epoch: 8 cost time: 5.091579437255859
Epoch: 8, Steps: 12 | Train Loss: 0.945 Vali Loss: 1.023 Vali Acc: 0.667 Test Loss: 1.023 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.620635271072388
Epoch: 9, Steps: 12 | Train Loss: 0.886 Vali Loss: 0.949 Vali Acc: 0.683 Test Loss: 0.949 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683324).  Saving model ...
Epoch: 10 cost time: 5.513031482696533
Epoch: 10, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.868 Vali Acc: 0.683 Test Loss: 0.868 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683325).  Saving model ...
Epoch: 11 cost time: 5.346118450164795
Epoch: 11, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.861 Vali Acc: 0.667 Test Loss: 0.861 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.953834056854248
Epoch: 12, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.775 Vali Acc: 0.717 Test Loss: 0.775 Test Acc: 0.717
Validation loss decreased (-0.683325 --> -0.716659).  Saving model ...
Epoch: 13 cost time: 5.109017848968506
Epoch: 13, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.737 Vali Acc: 0.717 Test Loss: 0.737 Test Acc: 0.717
Validation loss decreased (-0.716659 --> -0.716659).  Saving model ...
Epoch: 14 cost time: 5.200333833694458
Epoch: 14, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.703 Vali Acc: 0.750 Test Loss: 0.703 Test Acc: 0.750
Validation loss decreased (-0.716659 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 5.231610298156738
Epoch: 15, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.681 Vali Acc: 0.728 Test Loss: 0.681 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.378116130828857
Epoch: 16, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.731 Vali Acc: 0.728 Test Loss: 0.731 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.60258150100708
Epoch: 17, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.675 Vali Acc: 0.761 Test Loss: 0.675 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761104).  Saving model ...
Epoch: 18 cost time: 4.7096545696258545
Epoch: 18, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.707 Vali Acc: 0.744 Test Loss: 0.707 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.045428037643433
Epoch: 19, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.694 Vali Acc: 0.756 Test Loss: 0.694 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.186171293258667
Epoch: 20, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.693 Vali Acc: 0.756 Test Loss: 0.693 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.026562929153442
Epoch: 21, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.662 Vali Acc: 0.772 Test Loss: 0.662 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772216).  Saving model ...
Epoch: 22 cost time: 4.6150712966918945
Epoch: 22, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.626 Vali Acc: 0.772 Test Loss: 0.626 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772216).  Saving model ...
Epoch: 23 cost time: 4.588833570480347
Epoch: 23, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.642 Vali Acc: 0.778 Test Loss: 0.642 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777771).  Saving model ...
Epoch: 24 cost time: 4.6660544872283936
Epoch: 24, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.592 Vali Acc: 0.778 Test Loss: 0.592 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777772).  Saving model ...
Epoch: 25 cost time: 4.96255898475647
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.629 Vali Acc: 0.767 Test Loss: 0.629 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.193640470504761
Epoch: 26, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.605 Vali Acc: 0.811 Test Loss: 0.605 Test Acc: 0.811
Validation loss decreased (-0.777772 --> -0.811105).  Saving model ...
Epoch: 27 cost time: 4.903850793838501
Epoch: 27, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.655 Vali Acc: 0.789 Test Loss: 0.655 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.7049241065979
Epoch: 28, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.659 Vali Acc: 0.800 Test Loss: 0.659 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.697213172912598
Epoch: 29, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.644 Vali Acc: 0.817 Test Loss: 0.644 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 30 cost time: 4.671846628189087
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.653 Vali Acc: 0.789 Test Loss: 0.653 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 9397487
model size : 36.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.646034002304077
Epoch: 1, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.595 Vali Acc: 0.078 Test Loss: 2.595 Test Acc: 0.078
Validation loss decreased (inf --> -0.077752).  Saving model ...
Epoch: 2 cost time: 2.85123872756958
Epoch: 2, Steps: 12 | Train Loss: 2.503 Vali Loss: 2.378 Vali Acc: 0.267 Test Loss: 2.378 Test Acc: 0.267
Validation loss decreased (-0.077752 --> -0.266643).  Saving model ...
Epoch: 3 cost time: 2.832165479660034
Epoch: 3, Steps: 12 | Train Loss: 2.221 Vali Loss: 2.133 Vali Acc: 0.461 Test Loss: 2.133 Test Acc: 0.461
Validation loss decreased (-0.266643 --> -0.461090).  Saving model ...
Epoch: 4 cost time: 2.5862843990325928
Epoch: 4, Steps: 12 | Train Loss: 1.931 Vali Loss: 1.866 Vali Acc: 0.517 Test Loss: 1.866 Test Acc: 0.517
Validation loss decreased (-0.461090 --> -0.516648).  Saving model ...
Epoch: 5 cost time: 2.6700541973114014
Epoch: 5, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.625 Vali Acc: 0.572 Test Loss: 1.625 Test Acc: 0.572
Validation loss decreased (-0.516648 --> -0.572206).  Saving model ...
Epoch: 6 cost time: 2.8189852237701416
Epoch: 6, Steps: 12 | Train Loss: 1.413 Vali Loss: 1.428 Vali Acc: 0.611 Test Loss: 1.428 Test Acc: 0.611
Validation loss decreased (-0.572206 --> -0.611097).  Saving model ...
Epoch: 7 cost time: 2.823395013809204
Epoch: 7, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.279 Vali Acc: 0.644 Test Loss: 1.279 Test Acc: 0.644
Validation loss decreased (-0.611097 --> -0.644432).  Saving model ...
Epoch: 8 cost time: 2.8351004123687744
Epoch: 8, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.144 Vali Acc: 0.667 Test Loss: 1.144 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666655).  Saving model ...
Epoch: 9 cost time: 2.569617748260498
Epoch: 9, Steps: 12 | Train Loss: 0.898 Vali Loss: 1.052 Vali Acc: 0.661 Test Loss: 1.052 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.662954092025757
Epoch: 10, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.968 Vali Acc: 0.689 Test Loss: 0.968 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688879).  Saving model ...
Epoch: 11 cost time: 2.8063578605651855
Epoch: 11, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.887 Vali Acc: 0.711 Test Loss: 0.887 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711102).  Saving model ...
Epoch: 12 cost time: 2.819814682006836
Epoch: 12, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.835 Vali Acc: 0.728 Test Loss: 0.835 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 13 cost time: 2.9100735187530518
Epoch: 13, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.775 Vali Acc: 0.722 Test Loss: 0.775 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.646583318710327
Epoch: 14, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.730 Vali Acc: 0.739 Test Loss: 0.730 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738882).  Saving model ...
Epoch: 15 cost time: 2.691885471343994
Epoch: 15, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.692 Vali Acc: 0.767 Test Loss: 0.692 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766660).  Saving model ...
Epoch: 16 cost time: 2.661186456680298
Epoch: 16, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.699 Vali Acc: 0.744 Test Loss: 0.699 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8610641956329346
Epoch: 17, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.659 Vali Acc: 0.728 Test Loss: 0.659 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.013842821121216
Epoch: 18, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.677 Vali Acc: 0.711 Test Loss: 0.677 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.568725347518921
Epoch: 19, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.638 Vali Acc: 0.733 Test Loss: 0.638 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.6913344860076904
Epoch: 20, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.673 Vali Acc: 0.756 Test Loss: 0.673 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.6475021839141846
Epoch: 21, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.601 Vali Acc: 0.767 Test Loss: 0.601 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766661).  Saving model ...
Epoch: 22 cost time: 2.9198691844940186
Epoch: 22, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.657 Vali Acc: 0.739 Test Loss: 0.657 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.979856491088867
Epoch: 23, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.652 Vali Acc: 0.772 Test Loss: 0.652 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772216).  Saving model ...
Epoch: 24 cost time: 2.59580135345459
Epoch: 24, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.619 Vali Acc: 0.767 Test Loss: 0.619 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.748161554336548
Epoch: 25, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.636 Vali Acc: 0.783 Test Loss: 0.636 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783327).  Saving model ...
Epoch: 26 cost time: 2.6550018787384033
Epoch: 26, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.645 Vali Acc: 0.789 Test Loss: 0.645 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788882).  Saving model ...
Epoch: 27 cost time: 2.8805668354034424
Epoch: 27, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.652 Vali Acc: 0.778 Test Loss: 0.652 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8743977546691895
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.663 Vali Acc: 0.767 Test Loss: 0.663 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.463043212890625
Epoch: 29, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.656 Vali Acc: 0.778 Test Loss: 0.656 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.143409490585327
Epoch: 30, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.672 Vali Acc: 0.772 Test Loss: 0.672 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 2777071
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.957013130187988
Epoch: 1, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.581 Vali Acc: 0.172 Test Loss: 2.581 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 3.0733706951141357
Epoch: 2, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.401 Vali Acc: 0.317 Test Loss: 2.401 Test Acc: 0.317
Validation loss decreased (-0.172196 --> -0.316643).  Saving model ...
Epoch: 3 cost time: 2.932055950164795
Epoch: 3, Steps: 12 | Train Loss: 2.312 Vali Loss: 2.141 Vali Acc: 0.506 Test Loss: 2.141 Test Acc: 0.506
Validation loss decreased (-0.316643 --> -0.505534).  Saving model ...
Epoch: 4 cost time: 3.1648638248443604
Epoch: 4, Steps: 12 | Train Loss: 2.061 Vali Loss: 1.923 Vali Acc: 0.539 Test Loss: 1.923 Test Acc: 0.539
Validation loss decreased (-0.505534 --> -0.538870).  Saving model ...
Epoch: 5 cost time: 3.0782299041748047
Epoch: 5, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.716 Vali Acc: 0.567 Test Loss: 1.716 Test Acc: 0.567
Validation loss decreased (-0.538870 --> -0.566650).  Saving model ...
Epoch: 6 cost time: 3.2926430702209473
Epoch: 6, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.540 Vali Acc: 0.583 Test Loss: 1.540 Test Acc: 0.583
Validation loss decreased (-0.566650 --> -0.583318).  Saving model ...
Epoch: 7 cost time: 3.118305206298828
Epoch: 7, Steps: 12 | Train Loss: 1.430 Vali Loss: 1.400 Vali Acc: 0.589 Test Loss: 1.400 Test Acc: 0.589
Validation loss decreased (-0.583318 --> -0.588875).  Saving model ...
Epoch: 8 cost time: 3.021599769592285
Epoch: 8, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.271 Vali Acc: 0.611 Test Loss: 1.271 Test Acc: 0.611
Validation loss decreased (-0.588875 --> -0.611098).  Saving model ...
Epoch: 9 cost time: 3.0830297470092773
Epoch: 9, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.220 Vali Acc: 0.600 Test Loss: 1.220 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.025904655456543
Epoch: 10, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.119 Vali Acc: 0.611 Test Loss: 1.119 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611100).  Saving model ...
Epoch: 11 cost time: 3.4983267784118652
Epoch: 11, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.044 Vali Acc: 0.639 Test Loss: 1.044 Test Acc: 0.639
Validation loss decreased (-0.611100 --> -0.638878).  Saving model ...
Epoch: 12 cost time: 3.18070125579834
Epoch: 12, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.963 Vali Acc: 0.672 Test Loss: 0.963 Test Acc: 0.672
Validation loss decreased (-0.638878 --> -0.672213).  Saving model ...
Epoch: 13 cost time: 3.0941574573516846
Epoch: 13, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.935 Vali Acc: 0.689 Test Loss: 0.935 Test Acc: 0.689
Validation loss decreased (-0.672213 --> -0.688880).  Saving model ...
Epoch: 14 cost time: 2.9770748615264893
Epoch: 14, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.877 Vali Acc: 0.683 Test Loss: 0.877 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9948484897613525
Epoch: 15, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.839 Vali Acc: 0.722 Test Loss: 0.839 Test Acc: 0.722
Validation loss decreased (-0.688880 --> -0.722214).  Saving model ...
Epoch: 16 cost time: 3.4489259719848633
Epoch: 16, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.868 Vali Acc: 0.678 Test Loss: 0.868 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.129457950592041
Epoch: 17, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.771 Vali Acc: 0.744 Test Loss: 0.771 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744437).  Saving model ...
Epoch: 18 cost time: 3.05466628074646
Epoch: 18, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.814 Vali Acc: 0.733 Test Loss: 0.814 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.82283091545105
Epoch: 19, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.751 Vali Acc: 0.767 Test Loss: 0.751 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766659).  Saving model ...
Epoch: 20 cost time: 2.950169563293457
Epoch: 20, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.743 Vali Acc: 0.756 Test Loss: 0.743 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2738139629364014
Epoch: 21, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.737 Vali Acc: 0.772 Test Loss: 0.737 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 22 cost time: 3.1736271381378174
Epoch: 22, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.713 Vali Acc: 0.772 Test Loss: 0.713 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772215).  Saving model ...
Epoch: 23 cost time: 3.1705968379974365
Epoch: 23, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.808 Vali Acc: 0.733 Test Loss: 0.808 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9175970554351807
Epoch: 24, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.746 Vali Acc: 0.761 Test Loss: 0.746 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.00966477394104
Epoch: 25, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.735 Vali Acc: 0.744 Test Loss: 0.735 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.3212156295776367
Epoch: 26, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.709 Vali Acc: 0.772 Test Loss: 0.709 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772215).  Saving model ...
Epoch: 27 cost time: 3.175482749938965
Epoch: 27, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.162767171859741
Epoch: 28, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.818 Vali Acc: 0.733 Test Loss: 0.818 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8074755668640137
Epoch: 29, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.809 Vali Acc: 0.722 Test Loss: 0.809 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.0740368366241455
Epoch: 30, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.998 Vali Acc: 0.678 Test Loss: 0.998 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 9397487
model size : 36.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7455594539642334
Epoch: 1, Steps: 12 | Train Loss: 2.675 Vali Loss: 2.621 Vali Acc: 0.072 Test Loss: 2.621 Test Acc: 0.072
Validation loss decreased (inf --> -0.072196).  Saving model ...
Epoch: 2 cost time: 1.9966561794281006
Epoch: 2, Steps: 12 | Train Loss: 2.558 Vali Loss: 2.470 Vali Acc: 0.156 Test Loss: 2.470 Test Acc: 0.156
Validation loss decreased (-0.072196 --> -0.155531).  Saving model ...
Epoch: 3 cost time: 1.9951834678649902
Epoch: 3, Steps: 12 | Train Loss: 2.370 Vali Loss: 2.298 Vali Acc: 0.394 Test Loss: 2.298 Test Acc: 0.394
Validation loss decreased (-0.155531 --> -0.394421).  Saving model ...
Epoch: 4 cost time: 2.027538299560547
Epoch: 4, Steps: 12 | Train Loss: 2.169 Vali Loss: 2.094 Vali Acc: 0.494 Test Loss: 2.094 Test Acc: 0.494
Validation loss decreased (-0.394421 --> -0.494424).  Saving model ...
Epoch: 5 cost time: 2.1514058113098145
Epoch: 5, Steps: 12 | Train Loss: 1.900 Vali Loss: 1.885 Vali Acc: 0.556 Test Loss: 1.885 Test Acc: 0.556
Validation loss decreased (-0.494424 --> -0.555537).  Saving model ...
Epoch: 6 cost time: 2.3464643955230713
Epoch: 6, Steps: 12 | Train Loss: 1.696 Vali Loss: 1.693 Vali Acc: 0.567 Test Loss: 1.693 Test Acc: 0.567
Validation loss decreased (-0.555537 --> -0.566650).  Saving model ...
Epoch: 7 cost time: 2.0266153812408447
Epoch: 7, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.538 Vali Acc: 0.589 Test Loss: 1.538 Test Acc: 0.589
Validation loss decreased (-0.566650 --> -0.588874).  Saving model ...
Epoch: 8 cost time: 2.1715404987335205
Epoch: 8, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.396 Vali Acc: 0.578 Test Loss: 1.396 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9625048637390137
Epoch: 9, Steps: 12 | Train Loss: 1.120 Vali Loss: 1.292 Vali Acc: 0.606 Test Loss: 1.292 Test Acc: 0.606
Validation loss decreased (-0.588874 --> -0.605543).  Saving model ...
Epoch: 10 cost time: 2.225569486618042
Epoch: 10, Steps: 12 | Train Loss: 1.016 Vali Loss: 1.208 Vali Acc: 0.656 Test Loss: 1.208 Test Acc: 0.656
Validation loss decreased (-0.605543 --> -0.655543).  Saving model ...
Epoch: 11 cost time: 2.176140069961548
Epoch: 11, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.128 Vali Acc: 0.633 Test Loss: 1.128 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3640940189361572
Epoch: 12, Steps: 12 | Train Loss: 0.766 Vali Loss: 1.049 Vali Acc: 0.678 Test Loss: 1.049 Test Acc: 0.678
Validation loss decreased (-0.655543 --> -0.677767).  Saving model ...
Epoch: 13 cost time: 2.241743564605713
Epoch: 13, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.977 Vali Acc: 0.717 Test Loss: 0.977 Test Acc: 0.717
Validation loss decreased (-0.677767 --> -0.716657).  Saving model ...
Epoch: 14 cost time: 2.087204933166504
Epoch: 14, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.883 Vali Acc: 0.694 Test Loss: 0.883 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.064776659011841
Epoch: 15, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.885 Vali Acc: 0.700 Test Loss: 0.885 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0324456691741943
Epoch: 16, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.887 Vali Acc: 0.694 Test Loss: 0.887 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1692774295806885
Epoch: 17, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.841 Vali Acc: 0.700 Test Loss: 0.841 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2550787925720215
Epoch: 18, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.836 Vali Acc: 0.700 Test Loss: 0.836 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.476402997970581
Epoch: 19, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.748 Vali Acc: 0.750 Test Loss: 0.748 Test Acc: 0.750
Validation loss decreased (-0.716657 --> -0.749993).  Saving model ...
Epoch: 20 cost time: 2.006878137588501
Epoch: 20, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.744 Vali Acc: 0.761 Test Loss: 0.744 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761104).  Saving model ...
Epoch: 21 cost time: 2.009319543838501
Epoch: 21, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.688 Vali Acc: 0.783 Test Loss: 0.688 Test Acc: 0.783
Validation loss decreased (-0.761104 --> -0.783326).  Saving model ...
Epoch: 22 cost time: 1.8214318752288818
Epoch: 22, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.711 Vali Acc: 0.761 Test Loss: 0.711 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8380775451660156
Epoch: 23, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.799 Vali Acc: 0.722 Test Loss: 0.799 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.119356155395508
Epoch: 24, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.766 Vali Acc: 0.767 Test Loss: 0.766 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1386220455169678
Epoch: 25, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.757 Vali Acc: 0.744 Test Loss: 0.757 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0844597816467285
Epoch: 26, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.683 Vali Acc: 0.789 Test Loss: 0.683 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 27 cost time: 2.079383373260498
Epoch: 27, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.695 Vali Acc: 0.756 Test Loss: 0.695 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.043365478515625
Epoch: 28, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.747 Vali Acc: 0.756 Test Loss: 0.747 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.929049015045166
Epoch: 29, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.657 Vali Acc: 0.806 Test Loss: 0.657 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 30 cost time: 2.2257184982299805
Epoch: 30, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 2777071
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.753481864929199
Epoch: 1, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.662 Vali Acc: 0.172 Test Loss: 2.662 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 4.171305179595947
Epoch: 2, Steps: 12 | Train Loss: 2.583 Vali Loss: 2.466 Vali Acc: 0.317 Test Loss: 2.466 Test Acc: 0.317
Validation loss decreased (-0.172196 --> -0.316642).  Saving model ...
Epoch: 3 cost time: 4.603692054748535
Epoch: 3, Steps: 12 | Train Loss: 2.322 Vali Loss: 2.222 Vali Acc: 0.422 Test Loss: 2.222 Test Acc: 0.422
Validation loss decreased (-0.316642 --> -0.422200).  Saving model ...
Epoch: 4 cost time: 4.180546760559082
Epoch: 4, Steps: 12 | Train Loss: 2.019 Vali Loss: 1.948 Vali Acc: 0.522 Test Loss: 1.948 Test Acc: 0.522
Validation loss decreased (-0.422200 --> -0.522203).  Saving model ...
Epoch: 5 cost time: 4.302138090133667
Epoch: 5, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.693 Vali Acc: 0.539 Test Loss: 1.693 Test Acc: 0.539
Validation loss decreased (-0.522203 --> -0.538872).  Saving model ...
Epoch: 6 cost time: 4.742833137512207
Epoch: 6, Steps: 12 | Train Loss: 1.438 Vali Loss: 1.473 Vali Acc: 0.589 Test Loss: 1.473 Test Acc: 0.589
Validation loss decreased (-0.538872 --> -0.588874).  Saving model ...
Epoch: 7 cost time: 4.755673885345459
Epoch: 7, Steps: 12 | Train Loss: 1.227 Vali Loss: 1.298 Vali Acc: 0.622 Test Loss: 1.298 Test Acc: 0.622
Validation loss decreased (-0.588874 --> -0.622209).  Saving model ...
Epoch: 8 cost time: 4.27165150642395
Epoch: 8, Steps: 12 | Train Loss: 1.034 Vali Loss: 1.169 Vali Acc: 0.628 Test Loss: 1.169 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627766).  Saving model ...
Epoch: 9 cost time: 4.188632488250732
Epoch: 9, Steps: 12 | Train Loss: 0.876 Vali Loss: 1.068 Vali Acc: 0.656 Test Loss: 1.068 Test Acc: 0.656
Validation loss decreased (-0.627766 --> -0.655545).  Saving model ...
Epoch: 10 cost time: 4.527466535568237
Epoch: 10, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.964 Vali Acc: 0.683 Test Loss: 0.964 Test Acc: 0.683
Validation loss decreased (-0.655545 --> -0.683324).  Saving model ...
Epoch: 11 cost time: 4.345975399017334
Epoch: 11, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.895 Vali Acc: 0.672 Test Loss: 0.895 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.163770914077759
Epoch: 12, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.819 Vali Acc: 0.711 Test Loss: 0.819 Test Acc: 0.711
Validation loss decreased (-0.683324 --> -0.711103).  Saving model ...
Epoch: 13 cost time: 4.283258438110352
Epoch: 13, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.766 Vali Acc: 0.728 Test Loss: 0.766 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 14 cost time: 4.0568671226501465
Epoch: 14, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.713 Vali Acc: 0.717 Test Loss: 0.713 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.310757875442505
Epoch: 15, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.682 Vali Acc: 0.756 Test Loss: 0.682 Test Acc: 0.756
Validation loss decreased (-0.727770 --> -0.755549).  Saving model ...
Epoch: 16 cost time: 4.8711113929748535
Epoch: 16, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.676 Vali Acc: 0.761 Test Loss: 0.676 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 17 cost time: 4.3794331550598145
Epoch: 17, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.647 Vali Acc: 0.744 Test Loss: 0.647 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.3063788414001465
Epoch: 18, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.668 Vali Acc: 0.767 Test Loss: 0.668 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 19 cost time: 4.814435243606567
Epoch: 19, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.643 Vali Acc: 0.756 Test Loss: 0.643 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.201730012893677
Epoch: 20, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.598 Vali Acc: 0.789 Test Loss: 0.598 Test Acc: 0.789
Validation loss decreased (-0.766660 --> -0.788883).  Saving model ...
Epoch: 21 cost time: 5.373631954193115
Epoch: 21, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.706778526306152
Epoch: 22, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.614 Vali Acc: 0.794 Test Loss: 0.614 Test Acc: 0.794
Validation loss decreased (-0.788883 --> -0.794438).  Saving model ...
Epoch: 23 cost time: 4.980719804763794
Epoch: 23, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.594 Vali Acc: 0.789 Test Loss: 0.594 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.1807801723480225
Epoch: 24, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.587 Vali Acc: 0.800 Test Loss: 0.587 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 25 cost time: 5.172103404998779
Epoch: 25, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.595 Vali Acc: 0.767 Test Loss: 0.595 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.835415840148926
Epoch: 26, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.573 Vali Acc: 0.800 Test Loss: 0.573 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 27 cost time: 4.619845390319824
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.113079071044922
Epoch: 28, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.601 Vali Acc: 0.778 Test Loss: 0.601 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.999810695648193
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.580 Vali Acc: 0.800 Test Loss: 0.580 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.9173583984375
Epoch: 30, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.582 Vali Acc: 0.800 Test Loss: 0.582 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 4710127
model size : 18.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.033875226974487
Epoch: 1, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.675 Vali Acc: 0.117 Test Loss: 2.675 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 3.252202033996582
Epoch: 2, Steps: 12 | Train Loss: 2.538 Vali Loss: 2.468 Vali Acc: 0.222 Test Loss: 2.468 Test Acc: 0.222
Validation loss decreased (-0.116640 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 3.147726058959961
Epoch: 3, Steps: 12 | Train Loss: 2.296 Vali Loss: 2.235 Vali Acc: 0.456 Test Loss: 2.235 Test Acc: 0.456
Validation loss decreased (-0.222198 --> -0.455533).  Saving model ...
Epoch: 4 cost time: 2.8512041568756104
Epoch: 4, Steps: 12 | Train Loss: 2.013 Vali Loss: 1.971 Vali Acc: 0.528 Test Loss: 1.971 Test Acc: 0.528
Validation loss decreased (-0.455533 --> -0.527758).  Saving model ...
Epoch: 5 cost time: 3.0038862228393555
Epoch: 5, Steps: 12 | Train Loss: 1.707 Vali Loss: 1.730 Vali Acc: 0.567 Test Loss: 1.730 Test Acc: 0.567
Validation loss decreased (-0.527758 --> -0.566649).  Saving model ...
Epoch: 6 cost time: 2.846925973892212
Epoch: 6, Steps: 12 | Train Loss: 1.435 Vali Loss: 1.513 Vali Acc: 0.600 Test Loss: 1.513 Test Acc: 0.600
Validation loss decreased (-0.566649 --> -0.599985).  Saving model ...
Epoch: 7 cost time: 3.1612496376037598
Epoch: 7, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.355 Vali Acc: 0.567 Test Loss: 1.355 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4711623191833496
Epoch: 8, Steps: 12 | Train Loss: 1.030 Vali Loss: 1.211 Vali Acc: 0.606 Test Loss: 1.211 Test Acc: 0.606
Validation loss decreased (-0.599985 --> -0.605543).  Saving model ...
Epoch: 9 cost time: 3.308753490447998
Epoch: 9, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.082 Vali Acc: 0.633 Test Loss: 1.082 Test Acc: 0.633
Validation loss decreased (-0.605543 --> -0.633323).  Saving model ...
Epoch: 10 cost time: 2.9770638942718506
Epoch: 10, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.998 Vali Acc: 0.678 Test Loss: 0.998 Test Acc: 0.678
Validation loss decreased (-0.633323 --> -0.677768).  Saving model ...
Epoch: 11 cost time: 2.9140515327453613
Epoch: 11, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.935 Vali Acc: 0.700 Test Loss: 0.935 Test Acc: 0.700
Validation loss decreased (-0.677768 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 3.132187604904175
Epoch: 12, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.876 Vali Acc: 0.694 Test Loss: 0.876 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2555365562438965
Epoch: 13, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.838 Vali Acc: 0.683 Test Loss: 0.838 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4435369968414307
Epoch: 14, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.805 Vali Acc: 0.733 Test Loss: 0.805 Test Acc: 0.733
Validation loss decreased (-0.699991 --> -0.733325).  Saving model ...
Epoch: 15 cost time: 3.236818790435791
Epoch: 15, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.766 Vali Acc: 0.733 Test Loss: 0.766 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733326).  Saving model ...
Epoch: 16 cost time: 3.0666866302490234
Epoch: 16, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.753 Vali Acc: 0.706 Test Loss: 0.753 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.124424934387207
Epoch: 17, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.730 Vali Acc: 0.767 Test Loss: 0.730 Test Acc: 0.767
Validation loss decreased (-0.733326 --> -0.766659).  Saving model ...
Epoch: 18 cost time: 3.179737091064453
Epoch: 18, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.730 Vali Acc: 0.733 Test Loss: 0.730 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.341324806213379
Epoch: 19, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.709 Vali Acc: 0.733 Test Loss: 0.709 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4889276027679443
Epoch: 20, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.686 Vali Acc: 0.778 Test Loss: 0.686 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777771).  Saving model ...
Epoch: 21 cost time: 3.150412082672119
Epoch: 21, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.695 Vali Acc: 0.756 Test Loss: 0.695 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.047964096069336
Epoch: 22, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.709 Vali Acc: 0.756 Test Loss: 0.709 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.092817544937134
Epoch: 23, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.684 Vali Acc: 0.789 Test Loss: 0.684 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 24 cost time: 3.0642056465148926
Epoch: 24, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.675 Vali Acc: 0.778 Test Loss: 0.675 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.142087459564209
Epoch: 25, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.729 Vali Acc: 0.761 Test Loss: 0.729 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.2952139377593994
Epoch: 26, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.710 Vali Acc: 0.772 Test Loss: 0.710 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.265519142150879
Epoch: 27, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.707 Vali Acc: 0.783 Test Loss: 0.707 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.130470037460327
Epoch: 28, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.724 Vali Acc: 0.783 Test Loss: 0.724 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.0711896419525146
Epoch: 29, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.742 Vali Acc: 0.772 Test Loss: 0.742 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.702730417251587
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.754 Vali Acc: 0.772 Test Loss: 0.754 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 1399791
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.904115200042725
Epoch: 1, Steps: 12 | Train Loss: 2.740 Vali Loss: 2.662 Vali Acc: 0.172 Test Loss: 2.662 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 4.026919841766357
Epoch: 2, Steps: 12 | Train Loss: 2.583 Vali Loss: 2.465 Vali Acc: 0.317 Test Loss: 2.465 Test Acc: 0.317
Validation loss decreased (-0.172196 --> -0.316642).  Saving model ...
Epoch: 3 cost time: 3.892583131790161
Epoch: 3, Steps: 12 | Train Loss: 2.322 Vali Loss: 2.220 Vali Acc: 0.422 Test Loss: 2.220 Test Acc: 0.422
Validation loss decreased (-0.316642 --> -0.422200).  Saving model ...
Epoch: 4 cost time: 4.516204118728638
Epoch: 4, Steps: 12 | Train Loss: 2.020 Vali Loss: 1.946 Vali Acc: 0.522 Test Loss: 1.946 Test Acc: 0.522
Validation loss decreased (-0.422200 --> -0.522203).  Saving model ...
Epoch: 5 cost time: 4.188233375549316
Epoch: 5, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.691 Vali Acc: 0.539 Test Loss: 1.691 Test Acc: 0.539
Validation loss decreased (-0.522203 --> -0.538872).  Saving model ...
Epoch: 6 cost time: 4.237344741821289
Epoch: 6, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.473 Vali Acc: 0.594 Test Loss: 1.473 Test Acc: 0.594
Validation loss decreased (-0.538872 --> -0.594430).  Saving model ...
Epoch: 7 cost time: 4.1268227100372314
Epoch: 7, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.301 Vali Acc: 0.622 Test Loss: 1.301 Test Acc: 0.622
Validation loss decreased (-0.594430 --> -0.622209).  Saving model ...
Epoch: 8 cost time: 3.93046236038208
Epoch: 8, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.165 Vali Acc: 0.628 Test Loss: 1.165 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627766).  Saving model ...
Epoch: 9 cost time: 4.068949937820435
Epoch: 9, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.068 Vali Acc: 0.656 Test Loss: 1.068 Test Acc: 0.656
Validation loss decreased (-0.627766 --> -0.655545).  Saving model ...
Epoch: 10 cost time: 4.447155714035034
Epoch: 10, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.967 Vali Acc: 0.672 Test Loss: 0.967 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672213).  Saving model ...
Epoch: 11 cost time: 4.2116827964782715
Epoch: 11, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.899 Vali Acc: 0.683 Test Loss: 0.899 Test Acc: 0.683
Validation loss decreased (-0.672213 --> -0.683324).  Saving model ...
Epoch: 12 cost time: 3.88253116607666
Epoch: 12, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.821 Vali Acc: 0.700 Test Loss: 0.821 Test Acc: 0.700
Validation loss decreased (-0.683324 --> -0.699992).  Saving model ...
Epoch: 13 cost time: 4.027610540390015
Epoch: 13, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.771 Vali Acc: 0.728 Test Loss: 0.771 Test Acc: 0.728
Validation loss decreased (-0.699992 --> -0.727770).  Saving model ...
Epoch: 14 cost time: 3.886220693588257
Epoch: 14, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.719 Vali Acc: 0.722 Test Loss: 0.719 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.2036919593811035
Epoch: 15, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.677 Vali Acc: 0.750 Test Loss: 0.677 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 4.316948652267456
Epoch: 16, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.664 Vali Acc: 0.756 Test Loss: 0.664 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 17 cost time: 4.011860370635986
Epoch: 17, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.646 Vali Acc: 0.733 Test Loss: 0.646 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.099909782409668
Epoch: 18, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.643 Vali Acc: 0.772 Test Loss: 0.643 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772216).  Saving model ...
Epoch: 19 cost time: 3.931150436401367
Epoch: 19, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.616 Vali Acc: 0.772 Test Loss: 0.616 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772216).  Saving model ...
Epoch: 20 cost time: 4.3055784702301025
Epoch: 20, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.592 Vali Acc: 0.783 Test Loss: 0.592 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783327).  Saving model ...
Epoch: 21 cost time: 4.442544221878052
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.984574317932129
Epoch: 22, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.611 Vali Acc: 0.778 Test Loss: 0.611 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.989614725112915
Epoch: 23, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.597 Vali Acc: 0.783 Test Loss: 0.597 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.203013896942139
Epoch: 24, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.569 Vali Acc: 0.794 Test Loss: 0.569 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794439).  Saving model ...
Epoch: 25 cost time: 4.292882919311523
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.139169931411743
Epoch: 26, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.622 Vali Acc: 0.789 Test Loss: 0.622 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.085909128189087
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.8724772930145264
Epoch: 28, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.617 Vali Acc: 0.778 Test Loss: 0.617 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.101717472076416
Epoch: 29, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.552 Vali Acc: 0.811 Test Loss: 0.552 Test Acc: 0.811
Validation loss decreased (-0.794439 --> -0.811106).  Saving model ...
Epoch: 30 cost time: 4.3245909214019775
Epoch: 30, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.580 Vali Acc: 0.806 Test Loss: 0.580 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 4710127
model size : 18.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.701671361923218
Epoch: 1, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.675 Vali Acc: 0.117 Test Loss: 2.675 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 2.7906970977783203
Epoch: 2, Steps: 12 | Train Loss: 2.537 Vali Loss: 2.467 Vali Acc: 0.222 Test Loss: 2.467 Test Acc: 0.222
Validation loss decreased (-0.116640 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 2.8723809719085693
Epoch: 3, Steps: 12 | Train Loss: 2.295 Vali Loss: 2.233 Vali Acc: 0.456 Test Loss: 2.233 Test Acc: 0.456
Validation loss decreased (-0.222198 --> -0.455533).  Saving model ...
Epoch: 4 cost time: 3.1234066486358643
Epoch: 4, Steps: 12 | Train Loss: 2.011 Vali Loss: 1.968 Vali Acc: 0.522 Test Loss: 1.968 Test Acc: 0.522
Validation loss decreased (-0.455533 --> -0.522203).  Saving model ...
Epoch: 5 cost time: 3.042489528656006
Epoch: 5, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.727 Vali Acc: 0.556 Test Loss: 1.727 Test Acc: 0.556
Validation loss decreased (-0.522203 --> -0.555538).  Saving model ...
Epoch: 6 cost time: 2.9610862731933594
Epoch: 6, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.509 Vali Acc: 0.600 Test Loss: 1.509 Test Acc: 0.600
Validation loss decreased (-0.555538 --> -0.599985).  Saving model ...
Epoch: 7 cost time: 2.754462480545044
Epoch: 7, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.350 Vali Acc: 0.567 Test Loss: 1.350 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.874560832977295
Epoch: 8, Steps: 12 | Train Loss: 1.034 Vali Loss: 1.207 Vali Acc: 0.606 Test Loss: 1.207 Test Acc: 0.606
Validation loss decreased (-0.599985 --> -0.605543).  Saving model ...
Epoch: 9 cost time: 2.8046953678131104
Epoch: 9, Steps: 12 | Train Loss: 0.929 Vali Loss: 1.078 Vali Acc: 0.639 Test Loss: 1.078 Test Acc: 0.639
Validation loss decreased (-0.605543 --> -0.638878).  Saving model ...
Epoch: 10 cost time: 3.0989363193511963
Epoch: 10, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.994 Vali Acc: 0.689 Test Loss: 0.994 Test Acc: 0.689
Validation loss decreased (-0.638878 --> -0.688879).  Saving model ...
Epoch: 11 cost time: 3.0664048194885254
Epoch: 11, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.931 Vali Acc: 0.694 Test Loss: 0.931 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 12 cost time: 2.605294704437256
Epoch: 12, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.875 Vali Acc: 0.706 Test Loss: 0.875 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705547).  Saving model ...
Epoch: 13 cost time: 2.3958826065063477
Epoch: 13, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.835 Vali Acc: 0.717 Test Loss: 0.835 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716658).  Saving model ...
Epoch: 14 cost time: 2.7485601902008057
Epoch: 14, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.801 Vali Acc: 0.728 Test Loss: 0.801 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727770).  Saving model ...
Epoch: 15 cost time: 2.6112709045410156
Epoch: 15, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.761 Vali Acc: 0.744 Test Loss: 0.761 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744437).  Saving model ...
Epoch: 16 cost time: 2.5989325046539307
Epoch: 16, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.748 Vali Acc: 0.722 Test Loss: 0.748 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.823014736175537
Epoch: 17, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.738 Vali Acc: 0.767 Test Loss: 0.738 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766659).  Saving model ...
Epoch: 18 cost time: 2.905306339263916
Epoch: 18, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.743 Vali Acc: 0.722 Test Loss: 0.743 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8065109252929688
Epoch: 19, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.713 Vali Acc: 0.728 Test Loss: 0.713 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5653164386749268
Epoch: 20, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.698 Vali Acc: 0.767 Test Loss: 0.698 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766660).  Saving model ...
Epoch: 21 cost time: 2.51839280128479
Epoch: 21, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.682 Vali Acc: 0.761 Test Loss: 0.682 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.657097101211548
Epoch: 22, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.700 Vali Acc: 0.772 Test Loss: 0.700 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772215).  Saving model ...
Epoch: 23 cost time: 2.5514907836914062
Epoch: 23, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.673 Vali Acc: 0.772 Test Loss: 0.673 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772215).  Saving model ...
Epoch: 24 cost time: 2.3927805423736572
Epoch: 24, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.655 Vali Acc: 0.778 Test Loss: 0.655 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 25 cost time: 2.33689284324646
Epoch: 25, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.734 Vali Acc: 0.756 Test Loss: 0.734 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.476102113723755
Epoch: 26, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.666 Vali Acc: 0.767 Test Loss: 0.666 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.7095212936401367
Epoch: 27, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.706 Vali Acc: 0.772 Test Loss: 0.706 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.435478925704956
Epoch: 28, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.696 Vali Acc: 0.783 Test Loss: 0.696 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783326).  Saving model ...
Epoch: 29 cost time: 2.3777153491973877
Epoch: 29, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.708 Vali Acc: 0.761 Test Loss: 0.708 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.444300889968872
Epoch: 30, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.717 Vali Acc: 0.767 Test Loss: 0.717 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 1399791
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.109258413314819
Epoch: 1, Steps: 12 | Train Loss: 2.744 Vali Loss: 2.677 Vali Acc: 0.161 Test Loss: 2.677 Test Acc: 0.161
Validation loss decreased (inf --> -0.161084).  Saving model ...
Epoch: 2 cost time: 2.5353918075561523
Epoch: 2, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.522 Vali Acc: 0.261 Test Loss: 2.522 Test Acc: 0.261
Validation loss decreased (-0.161084 --> -0.261086).  Saving model ...
Epoch: 3 cost time: 2.846938133239746
Epoch: 3, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.331 Vali Acc: 0.367 Test Loss: 2.331 Test Acc: 0.367
Validation loss decreased (-0.261086 --> -0.366643).  Saving model ...
Epoch: 4 cost time: 2.741931200027466
Epoch: 4, Steps: 12 | Train Loss: 2.174 Vali Loss: 2.123 Vali Acc: 0.456 Test Loss: 2.123 Test Acc: 0.456
Validation loss decreased (-0.366643 --> -0.455534).  Saving model ...
Epoch: 5 cost time: 2.7013120651245117
Epoch: 5, Steps: 12 | Train Loss: 1.959 Vali Loss: 1.919 Vali Acc: 0.478 Test Loss: 1.919 Test Acc: 0.478
Validation loss decreased (-0.455534 --> -0.477759).  Saving model ...
Epoch: 6 cost time: 2.5937094688415527
Epoch: 6, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.730 Vali Acc: 0.539 Test Loss: 1.730 Test Acc: 0.539
Validation loss decreased (-0.477759 --> -0.538872).  Saving model ...
Epoch: 7 cost time: 2.7292845249176025
Epoch: 7, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.565 Vali Acc: 0.544 Test Loss: 1.565 Test Acc: 0.544
Validation loss decreased (-0.538872 --> -0.544429).  Saving model ...
Epoch: 8 cost time: 2.862111806869507
Epoch: 8, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.432 Vali Acc: 0.578 Test Loss: 1.432 Test Acc: 0.578
Validation loss decreased (-0.544429 --> -0.577763).  Saving model ...
Epoch: 9 cost time: 2.8481874465942383
Epoch: 9, Steps: 12 | Train Loss: 1.148 Vali Loss: 1.298 Vali Acc: 0.594 Test Loss: 1.298 Test Acc: 0.594
Validation loss decreased (-0.577763 --> -0.594431).  Saving model ...
Epoch: 10 cost time: 2.568070650100708
Epoch: 10, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.176 Vali Acc: 0.644 Test Loss: 1.176 Test Acc: 0.644
Validation loss decreased (-0.594431 --> -0.644433).  Saving model ...
Epoch: 11 cost time: 2.5477685928344727
Epoch: 11, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.112 Vali Acc: 0.650 Test Loss: 1.112 Test Acc: 0.650
Validation loss decreased (-0.644433 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 2.689697742462158
Epoch: 12, Steps: 12 | Train Loss: 0.804 Vali Loss: 1.023 Vali Acc: 0.694 Test Loss: 1.023 Test Acc: 0.694
Validation loss decreased (-0.649989 --> -0.694434).  Saving model ...
Epoch: 13 cost time: 2.778503179550171
Epoch: 13, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.979 Vali Acc: 0.644 Test Loss: 0.979 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5782053470611572
Epoch: 14, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.923 Vali Acc: 0.683 Test Loss: 0.923 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.573179244995117
Epoch: 15, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.882 Vali Acc: 0.672 Test Loss: 0.882 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4730889797210693
Epoch: 16, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.843 Vali Acc: 0.683 Test Loss: 0.843 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.777048110961914
Epoch: 17, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.796 Vali Acc: 0.683 Test Loss: 0.796 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.7230498790740967
Epoch: 18, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.776 Vali Acc: 0.722 Test Loss: 0.776 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722214).  Saving model ...
Epoch: 19 cost time: 2.550117254257202
Epoch: 19, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.744 Vali Acc: 0.717 Test Loss: 0.744 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4979326725006104
Epoch: 20, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.693 Vali Acc: 0.761 Test Loss: 0.693 Test Acc: 0.761
Validation loss decreased (-0.722214 --> -0.761104).  Saving model ...
Epoch: 21 cost time: 2.641030788421631
Epoch: 21, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.725 Vali Acc: 0.722 Test Loss: 0.725 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.797104835510254
Epoch: 22, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.725 Vali Acc: 0.722 Test Loss: 0.725 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.732290267944336
Epoch: 23, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.741 Vali Acc: 0.717 Test Loss: 0.741 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.6042768955230713
Epoch: 24, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.720 Vali Acc: 0.733 Test Loss: 0.720 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.520251750946045
Epoch: 25, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.769 Vali Acc: 0.722 Test Loss: 0.769 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.885723352432251
Epoch: 26, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.713 Vali Acc: 0.722 Test Loss: 0.713 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.7020137310028076
Epoch: 27, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.650 Vali Acc: 0.767 Test Loss: 0.650 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 28 cost time: 2.785634994506836
Epoch: 28, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.714 Vali Acc: 0.728 Test Loss: 0.714 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.524092674255371
Epoch: 29, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.671 Vali Acc: 0.756 Test Loss: 0.671 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.7505862712860107
Epoch: 30, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.682 Vali Acc: 0.767 Test Loss: 0.682 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 4710127
model size : 18.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5378568172454834
Epoch: 1, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.687 Vali Acc: 0.111 Test Loss: 2.687 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 1.9193058013916016
Epoch: 2, Steps: 12 | Train Loss: 2.560 Vali Loss: 2.518 Vali Acc: 0.189 Test Loss: 2.518 Test Acc: 0.189
Validation loss decreased (-0.111084 --> -0.188864).  Saving model ...
Epoch: 3 cost time: 1.9602441787719727
Epoch: 3, Steps: 12 | Train Loss: 2.377 Vali Loss: 2.327 Vali Acc: 0.383 Test Loss: 2.327 Test Acc: 0.383
Validation loss decreased (-0.188864 --> -0.383310).  Saving model ...
Epoch: 4 cost time: 2.083130121231079
Epoch: 4, Steps: 12 | Train Loss: 2.142 Vali Loss: 2.105 Vali Acc: 0.528 Test Loss: 2.105 Test Acc: 0.528
Validation loss decreased (-0.383310 --> -0.527757).  Saving model ...
Epoch: 5 cost time: 2.174854040145874
Epoch: 5, Steps: 12 | Train Loss: 1.888 Vali Loss: 1.894 Vali Acc: 0.572 Test Loss: 1.894 Test Acc: 0.572
Validation loss decreased (-0.527757 --> -0.572203).  Saving model ...
Epoch: 6 cost time: 1.9781558513641357
Epoch: 6, Steps: 12 | Train Loss: 1.647 Vali Loss: 1.697 Vali Acc: 0.594 Test Loss: 1.697 Test Acc: 0.594
Validation loss decreased (-0.572203 --> -0.594427).  Saving model ...
Epoch: 7 cost time: 2.0409438610076904
Epoch: 7, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.552 Vali Acc: 0.578 Test Loss: 1.552 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8722264766693115
Epoch: 8, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.423 Vali Acc: 0.583 Test Loss: 1.423 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8719878196716309
Epoch: 9, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.308 Vali Acc: 0.600 Test Loss: 1.308 Test Acc: 0.600
Validation loss decreased (-0.594427 --> -0.599987).  Saving model ...
Epoch: 10 cost time: 1.9808881282806396
Epoch: 10, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.217 Vali Acc: 0.600 Test Loss: 1.217 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 1.9445996284484863
Epoch: 11, Steps: 12 | Train Loss: 0.857 Vali Loss: 1.157 Vali Acc: 0.622 Test Loss: 1.157 Test Acc: 0.622
Validation loss decreased (-0.599988 --> -0.622211).  Saving model ...
Epoch: 12 cost time: 2.1512391567230225
Epoch: 12, Steps: 12 | Train Loss: 0.796 Vali Loss: 1.091 Vali Acc: 0.606 Test Loss: 1.091 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.040172815322876
Epoch: 13, Steps: 12 | Train Loss: 0.723 Vali Loss: 1.011 Vali Acc: 0.661 Test Loss: 1.011 Test Acc: 0.661
Validation loss decreased (-0.622211 --> -0.661101).  Saving model ...
Epoch: 14 cost time: 2.0098023414611816
Epoch: 14, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.952 Vali Acc: 0.706 Test Loss: 0.952 Test Acc: 0.706
Validation loss decreased (-0.661101 --> -0.705546).  Saving model ...
Epoch: 15 cost time: 2.3107550144195557
Epoch: 15, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.912 Vali Acc: 0.733 Test Loss: 0.912 Test Acc: 0.733
Validation loss decreased (-0.705546 --> -0.733324).  Saving model ...
Epoch: 16 cost time: 2.1978445053100586
Epoch: 16, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.890 Vali Acc: 0.694 Test Loss: 0.890 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.050790309906006
Epoch: 17, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.878 Vali Acc: 0.711 Test Loss: 0.878 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.109668254852295
Epoch: 18, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.864 Vali Acc: 0.678 Test Loss: 0.864 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0380396842956543
Epoch: 19, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.821 Vali Acc: 0.728 Test Loss: 0.821 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9657790660858154
Epoch: 20, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.829 Vali Acc: 0.717 Test Loss: 0.829 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.147259473800659
Epoch: 21, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.777 Vali Acc: 0.767 Test Loss: 0.777 Test Acc: 0.767
Validation loss decreased (-0.733324 --> -0.766659).  Saving model ...
Epoch: 22 cost time: 2.219306707382202
Epoch: 22, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.806 Vali Acc: 0.728 Test Loss: 0.806 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9397554397583008
Epoch: 23, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.787 Vali Acc: 0.767 Test Loss: 0.787 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.97127103805542
Epoch: 24, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.786 Vali Acc: 0.761 Test Loss: 0.786 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1344711780548096
Epoch: 25, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.816 Vali Acc: 0.711 Test Loss: 0.816 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.210702419281006
Epoch: 26, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.778 Vali Acc: 0.750 Test Loss: 0.778 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.230046510696411
Epoch: 27, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.762 Vali Acc: 0.761 Test Loss: 0.762 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.3196051120758057
Epoch: 28, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.769 Vali Acc: 0.767 Test Loss: 0.769 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 29 cost time: 2.0357584953308105
Epoch: 29, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.749 Vali Acc: 0.767 Test Loss: 0.749 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 30 cost time: 2.015803098678589
Epoch: 30, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.765 Vali Acc: 0.783 Test Loss: 0.765 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 1399791
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.904712915420532
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.673 Vali Acc: 0.094 Test Loss: 2.673 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 3.8372392654418945
Epoch: 2, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.503 Vali Acc: 0.194 Test Loss: 2.503 Test Acc: 0.194
Validation loss decreased (-0.094418 --> -0.194419).  Saving model ...
Epoch: 3 cost time: 3.8884401321411133
Epoch: 3, Steps: 12 | Train Loss: 2.410 Vali Loss: 2.289 Vali Acc: 0.378 Test Loss: 2.289 Test Acc: 0.378
Validation loss decreased (-0.194419 --> -0.377755).  Saving model ...
Epoch: 4 cost time: 4.127541780471802
Epoch: 4, Steps: 12 | Train Loss: 2.132 Vali Loss: 2.060 Vali Acc: 0.472 Test Loss: 2.060 Test Acc: 0.472
Validation loss decreased (-0.377755 --> -0.472202).  Saving model ...
Epoch: 5 cost time: 4.060718297958374
Epoch: 5, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.823 Vali Acc: 0.511 Test Loss: 1.823 Test Acc: 0.511
Validation loss decreased (-0.472202 --> -0.511093).  Saving model ...
Epoch: 6 cost time: 3.797356128692627
Epoch: 6, Steps: 12 | Train Loss: 1.591 Vali Loss: 1.608 Vali Acc: 0.511 Test Loss: 1.608 Test Acc: 0.511
Validation loss decreased (-0.511093 --> -0.511095).  Saving model ...
Epoch: 7 cost time: 3.9118692874908447
Epoch: 7, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.429 Vali Acc: 0.533 Test Loss: 1.429 Test Acc: 0.533
Validation loss decreased (-0.511095 --> -0.533319).  Saving model ...
Epoch: 8 cost time: 4.2333807945251465
Epoch: 8, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.279 Vali Acc: 0.583 Test Loss: 1.279 Test Acc: 0.583
Validation loss decreased (-0.533319 --> -0.583321).  Saving model ...
Epoch: 9 cost time: 3.8819079399108887
Epoch: 9, Steps: 12 | Train Loss: 0.983 Vali Loss: 1.174 Vali Acc: 0.600 Test Loss: 1.174 Test Acc: 0.600
Validation loss decreased (-0.583321 --> -0.599988).  Saving model ...
Epoch: 10 cost time: 3.775489091873169
Epoch: 10, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.081 Vali Acc: 0.639 Test Loss: 1.081 Test Acc: 0.639
Validation loss decreased (-0.599988 --> -0.638878).  Saving model ...
Epoch: 11 cost time: 4.134798765182495
Epoch: 11, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.997 Vali Acc: 0.633 Test Loss: 0.997 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.246375322341919
Epoch: 12, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.916 Vali Acc: 0.661 Test Loss: 0.916 Test Acc: 0.661
Validation loss decreased (-0.638878 --> -0.661102).  Saving model ...
Epoch: 13 cost time: 3.9993467330932617
Epoch: 13, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.867 Vali Acc: 0.694 Test Loss: 0.867 Test Acc: 0.694
Validation loss decreased (-0.661102 --> -0.694436).  Saving model ...
Epoch: 14 cost time: 3.9210352897644043
Epoch: 14, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.850 Vali Acc: 0.689 Test Loss: 0.850 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.354461908340454
Epoch: 15, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.832 Vali Acc: 0.694 Test Loss: 0.832 Test Acc: 0.694
Validation loss decreased (-0.694436 --> -0.694436).  Saving model ...
Epoch: 16 cost time: 4.096402883529663
Epoch: 16, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.780 Vali Acc: 0.717 Test Loss: 0.780 Test Acc: 0.717
Validation loss decreased (-0.694436 --> -0.716659).  Saving model ...
Epoch: 17 cost time: 3.8738203048706055
Epoch: 17, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.743 Vali Acc: 0.733 Test Loss: 0.743 Test Acc: 0.733
Validation loss decreased (-0.716659 --> -0.733326).  Saving model ...
Epoch: 18 cost time: 4.260005474090576
Epoch: 18, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.744 Vali Acc: 0.728 Test Loss: 0.744 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.106569290161133
Epoch: 19, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.705 Vali Acc: 0.761 Test Loss: 0.705 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761104).  Saving model ...
Epoch: 20 cost time: 4.798184156417847
Epoch: 20, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.712 Vali Acc: 0.739 Test Loss: 0.712 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.651710271835327
Epoch: 21, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.685 Vali Acc: 0.733 Test Loss: 0.685 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.730257511138916
Epoch: 22, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.665 Vali Acc: 0.739 Test Loss: 0.665 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.868088006973267
Epoch: 23, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.714 Vali Acc: 0.717 Test Loss: 0.714 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.600486993789673
Epoch: 24, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.724 Vali Acc: 0.744 Test Loss: 0.724 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.649388313293457
Epoch: 25, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.692 Vali Acc: 0.767 Test Loss: 0.692 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 26 cost time: 4.588202238082886
Epoch: 26, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.725 Vali Acc: 0.744 Test Loss: 0.725 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.388602256774902
Epoch: 27, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.802 Vali Acc: 0.722 Test Loss: 0.802 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.82886528968811
Epoch: 28, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.708 Vali Acc: 0.750 Test Loss: 0.708 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.999882221221924
Epoch: 29, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.693 Vali Acc: 0.756 Test Loss: 0.693 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.831878185272217
Epoch: 30, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.721 Vali Acc: 0.739 Test Loss: 0.721 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 2366447
model size : 9.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.3494486808776855
Epoch: 1, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.684 Vali Acc: 0.050 Test Loss: 2.684 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 3.6049325466156006
Epoch: 2, Steps: 12 | Train Loss: 2.592 Vali Loss: 2.504 Vali Acc: 0.178 Test Loss: 2.504 Test Acc: 0.178
Validation loss decreased (-0.049973 --> -0.177753).  Saving model ...
Epoch: 3 cost time: 3.59026837348938
Epoch: 3, Steps: 12 | Train Loss: 2.329 Vali Loss: 2.290 Vali Acc: 0.350 Test Loss: 2.290 Test Acc: 0.350
Validation loss decreased (-0.177753 --> -0.349977).  Saving model ...
Epoch: 4 cost time: 3.383314847946167
Epoch: 4, Steps: 12 | Train Loss: 2.052 Vali Loss: 2.057 Vali Acc: 0.472 Test Loss: 2.057 Test Acc: 0.472
Validation loss decreased (-0.349977 --> -0.472202).  Saving model ...
Epoch: 5 cost time: 3.5790743827819824
Epoch: 5, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.830 Vali Acc: 0.522 Test Loss: 1.830 Test Acc: 0.522
Validation loss decreased (-0.472202 --> -0.522204).  Saving model ...
Epoch: 6 cost time: 3.703418016433716
Epoch: 6, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.614 Vali Acc: 0.550 Test Loss: 1.614 Test Acc: 0.550
Validation loss decreased (-0.522204 --> -0.549984).  Saving model ...
Epoch: 7 cost time: 3.409485340118408
Epoch: 7, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.433 Vali Acc: 0.578 Test Loss: 1.433 Test Acc: 0.578
Validation loss decreased (-0.549984 --> -0.577763).  Saving model ...
Epoch: 8 cost time: 3.6189632415771484
Epoch: 8, Steps: 12 | Train Loss: 1.116 Vali Loss: 1.292 Vali Acc: 0.622 Test Loss: 1.292 Test Acc: 0.622
Validation loss decreased (-0.577763 --> -0.622209).  Saving model ...
Epoch: 9 cost time: 3.3391146659851074
Epoch: 9, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.162 Vali Acc: 0.622 Test Loss: 1.162 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622211).  Saving model ...
Epoch: 10 cost time: 3.8368935585021973
Epoch: 10, Steps: 12 | Train Loss: 0.862 Vali Loss: 1.047 Vali Acc: 0.667 Test Loss: 1.047 Test Acc: 0.667
Validation loss decreased (-0.622211 --> -0.666656).  Saving model ...
Epoch: 11 cost time: 3.657249927520752
Epoch: 11, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.958 Vali Acc: 0.661 Test Loss: 0.958 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4937713146209717
Epoch: 12, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.868 Vali Acc: 0.706 Test Loss: 0.868 Test Acc: 0.706
Validation loss decreased (-0.666656 --> -0.705547).  Saving model ...
Epoch: 13 cost time: 3.59665584564209
Epoch: 13, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.837 Vali Acc: 0.694 Test Loss: 0.837 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4032320976257324
Epoch: 14, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.775 Vali Acc: 0.739 Test Loss: 0.775 Test Acc: 0.739
Validation loss decreased (-0.705547 --> -0.738881).  Saving model ...
Epoch: 15 cost time: 3.812856912612915
Epoch: 15, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.751 Vali Acc: 0.750 Test Loss: 0.751 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 3.6079494953155518
Epoch: 16, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.714 Vali Acc: 0.744 Test Loss: 0.714 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.473811388015747
Epoch: 17, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.705 Vali Acc: 0.756 Test Loss: 0.705 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755549).  Saving model ...
Epoch: 18 cost time: 3.5662841796875
Epoch: 18, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.685 Vali Acc: 0.750 Test Loss: 0.685 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5946602821350098
Epoch: 19, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.677 Vali Acc: 0.756 Test Loss: 0.677 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 20 cost time: 3.5221006870269775
Epoch: 20, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.678 Vali Acc: 0.739 Test Loss: 0.678 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0974998474121094
Epoch: 21, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.661 Vali Acc: 0.756 Test Loss: 0.661 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 22 cost time: 2.987929105758667
Epoch: 22, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.667 Vali Acc: 0.739 Test Loss: 0.667 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2445755004882812
Epoch: 23, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.659 Vali Acc: 0.767 Test Loss: 0.659 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 24 cost time: 3.5984737873077393
Epoch: 24, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.667 Vali Acc: 0.750 Test Loss: 0.667 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.42543888092041
Epoch: 25, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.693 Vali Acc: 0.733 Test Loss: 0.693 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.3467705249786377
Epoch: 26, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.683 Vali Acc: 0.756 Test Loss: 0.683 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.1523730754852295
Epoch: 27, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.693 Vali Acc: 0.728 Test Loss: 0.693 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.270451545715332
Epoch: 28, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.667 Vali Acc: 0.767 Test Loss: 0.667 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.6101789474487305
Epoch: 29, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.708 Vali Acc: 0.767 Test Loss: 0.708 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.335524559020996
Epoch: 30, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.708 Vali Acc: 0.733 Test Loss: 0.708 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 711151
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.643181562423706
Epoch: 1, Steps: 12 | Train Loss: 2.751 Vali Loss: 2.673 Vali Acc: 0.094 Test Loss: 2.673 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 3.9628829956054688
Epoch: 2, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.502 Vali Acc: 0.194 Test Loss: 2.502 Test Acc: 0.194
Validation loss decreased (-0.094418 --> -0.194419).  Saving model ...
Epoch: 3 cost time: 3.565609931945801
Epoch: 3, Steps: 12 | Train Loss: 2.411 Vali Loss: 2.288 Vali Acc: 0.378 Test Loss: 2.288 Test Acc: 0.378
Validation loss decreased (-0.194419 --> -0.377755).  Saving model ...
Epoch: 4 cost time: 3.5947959423065186
Epoch: 4, Steps: 12 | Train Loss: 2.131 Vali Loss: 2.058 Vali Acc: 0.472 Test Loss: 2.058 Test Acc: 0.472
Validation loss decreased (-0.377755 --> -0.472202).  Saving model ...
Epoch: 5 cost time: 3.7822721004486084
Epoch: 5, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.819 Vali Acc: 0.517 Test Loss: 1.819 Test Acc: 0.517
Validation loss decreased (-0.472202 --> -0.516648).  Saving model ...
Epoch: 6 cost time: 3.7493746280670166
Epoch: 6, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.603 Vali Acc: 0.500 Test Loss: 1.603 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.853163242340088
Epoch: 7, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.425 Vali Acc: 0.533 Test Loss: 1.425 Test Acc: 0.533
Validation loss decreased (-0.516648 --> -0.533319).  Saving model ...
Epoch: 8 cost time: 3.686816453933716
Epoch: 8, Steps: 12 | Train Loss: 1.120 Vali Loss: 1.276 Vali Acc: 0.578 Test Loss: 1.276 Test Acc: 0.578
Validation loss decreased (-0.533319 --> -0.577765).  Saving model ...
Epoch: 9 cost time: 3.5215721130371094
Epoch: 9, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.172 Vali Acc: 0.600 Test Loss: 1.172 Test Acc: 0.600
Validation loss decreased (-0.577765 --> -0.599988).  Saving model ...
Epoch: 10 cost time: 3.8865444660186768
Epoch: 10, Steps: 12 | Train Loss: 0.829 Vali Loss: 1.082 Vali Acc: 0.639 Test Loss: 1.082 Test Acc: 0.639
Validation loss decreased (-0.599988 --> -0.638878).  Saving model ...
Epoch: 11 cost time: 3.8303730487823486
Epoch: 11, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.999 Vali Acc: 0.633 Test Loss: 0.999 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.546663522720337
Epoch: 12, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.921 Vali Acc: 0.650 Test Loss: 0.921 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649991).  Saving model ...
Epoch: 13 cost time: 3.6908223628997803
Epoch: 13, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.878 Vali Acc: 0.683 Test Loss: 0.878 Test Acc: 0.683
Validation loss decreased (-0.649991 --> -0.683325).  Saving model ...
Epoch: 14 cost time: 3.634204387664795
Epoch: 14, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.855 Vali Acc: 0.667 Test Loss: 0.855 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8103160858154297
Epoch: 15, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.836 Vali Acc: 0.694 Test Loss: 0.836 Test Acc: 0.694
Validation loss decreased (-0.683325 --> -0.694436).  Saving model ...
Epoch: 16 cost time: 3.5334596633911133
Epoch: 16, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.781 Vali Acc: 0.711 Test Loss: 0.781 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711103).  Saving model ...
Epoch: 17 cost time: 3.539663553237915
Epoch: 17, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.755 Vali Acc: 0.722 Test Loss: 0.755 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722215).  Saving model ...
Epoch: 18 cost time: 3.4073851108551025
Epoch: 18, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.763 Vali Acc: 0.689 Test Loss: 0.763 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7723629474639893
Epoch: 19, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.707 Vali Acc: 0.739 Test Loss: 0.707 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738882).  Saving model ...
Epoch: 20 cost time: 3.632014513015747
Epoch: 20, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.726 Vali Acc: 0.722 Test Loss: 0.726 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4426732063293457
Epoch: 21, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.698 Vali Acc: 0.722 Test Loss: 0.698 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.4994964599609375
Epoch: 22, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.678 Vali Acc: 0.744 Test Loss: 0.678 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 23 cost time: 3.6397602558135986
Epoch: 23, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.709 Vali Acc: 0.728 Test Loss: 0.709 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.6814937591552734
Epoch: 24, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.691 Vali Acc: 0.761 Test Loss: 0.691 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761104).  Saving model ...
Epoch: 25 cost time: 3.367794990539551
Epoch: 25, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.744 Vali Acc: 0.733 Test Loss: 0.744 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3573944568634033
Epoch: 26, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.746 Vali Acc: 0.733 Test Loss: 0.746 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.669163703918457
Epoch: 27, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.746 Vali Acc: 0.744 Test Loss: 0.746 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.6420695781707764
Epoch: 28, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.723 Vali Acc: 0.744 Test Loss: 0.723 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.5814783573150635
Epoch: 29, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.742 Vali Acc: 0.739 Test Loss: 0.742 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.6910836696624756
Epoch: 30, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.724 Vali Acc: 0.733 Test Loss: 0.724 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 2366447
model size : 9.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.788390398025513
Epoch: 1, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.684 Vali Acc: 0.050 Test Loss: 2.684 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 3.0461320877075195
Epoch: 2, Steps: 12 | Train Loss: 2.592 Vali Loss: 2.503 Vali Acc: 0.178 Test Loss: 2.503 Test Acc: 0.178
Validation loss decreased (-0.049973 --> -0.177753).  Saving model ...
Epoch: 3 cost time: 2.874725818634033
Epoch: 3, Steps: 12 | Train Loss: 2.329 Vali Loss: 2.289 Vali Acc: 0.339 Test Loss: 2.289 Test Acc: 0.339
Validation loss decreased (-0.177753 --> -0.338866).  Saving model ...
Epoch: 4 cost time: 3.0746006965637207
Epoch: 4, Steps: 12 | Train Loss: 2.052 Vali Loss: 2.055 Vali Acc: 0.467 Test Loss: 2.055 Test Acc: 0.467
Validation loss decreased (-0.338866 --> -0.466646).  Saving model ...
Epoch: 5 cost time: 3.2278056144714355
Epoch: 5, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.828 Vali Acc: 0.522 Test Loss: 1.828 Test Acc: 0.522
Validation loss decreased (-0.466646 --> -0.522204).  Saving model ...
Epoch: 6 cost time: 3.3180007934570312
Epoch: 6, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.612 Vali Acc: 0.550 Test Loss: 1.612 Test Acc: 0.550
Validation loss decreased (-0.522204 --> -0.549984).  Saving model ...
Epoch: 7 cost time: 3.35133695602417
Epoch: 7, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.431 Vali Acc: 0.589 Test Loss: 1.431 Test Acc: 0.589
Validation loss decreased (-0.549984 --> -0.588875).  Saving model ...
Epoch: 8 cost time: 3.1548523902893066
Epoch: 8, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.290 Vali Acc: 0.622 Test Loss: 1.290 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622209).  Saving model ...
Epoch: 9 cost time: 3.196112871170044
Epoch: 9, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.162 Vali Acc: 0.617 Test Loss: 1.162 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2740085124969482
Epoch: 10, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.048 Vali Acc: 0.667 Test Loss: 1.048 Test Acc: 0.667
Validation loss decreased (-0.622209 --> -0.666656).  Saving model ...
Epoch: 11 cost time: 3.309755802154541
Epoch: 11, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.961 Vali Acc: 0.661 Test Loss: 0.961 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3070406913757324
Epoch: 12, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.873 Vali Acc: 0.700 Test Loss: 0.873 Test Acc: 0.700
Validation loss decreased (-0.666656 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 3.093449115753174
Epoch: 13, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.840 Vali Acc: 0.700 Test Loss: 0.840 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 14 cost time: 3.386423110961914
Epoch: 14, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.780 Vali Acc: 0.722 Test Loss: 0.780 Test Acc: 0.722
Validation loss decreased (-0.699992 --> -0.722214).  Saving model ...
Epoch: 15 cost time: 3.2526051998138428
Epoch: 15, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.758 Vali Acc: 0.739 Test Loss: 0.758 Test Acc: 0.739
Validation loss decreased (-0.722214 --> -0.738881).  Saving model ...
Epoch: 16 cost time: 3.136495590209961
Epoch: 16, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.712 Vali Acc: 0.728 Test Loss: 0.712 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3016233444213867
Epoch: 17, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.707 Vali Acc: 0.750 Test Loss: 0.707 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749993).  Saving model ...
Epoch: 18 cost time: 3.0702197551727295
Epoch: 18, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.689 Vali Acc: 0.761 Test Loss: 0.689 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761104).  Saving model ...
Epoch: 19 cost time: 3.2301063537597656
Epoch: 19, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.681 Vali Acc: 0.761 Test Loss: 0.681 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761104).  Saving model ...
Epoch: 20 cost time: 2.876749277114868
Epoch: 20, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.680 Vali Acc: 0.728 Test Loss: 0.680 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8364086151123047
Epoch: 21, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.657 Vali Acc: 0.750 Test Loss: 0.657 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.165362596511841
Epoch: 22, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.653 Vali Acc: 0.739 Test Loss: 0.653 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.9518673419952393
Epoch: 23, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.653 Vali Acc: 0.767 Test Loss: 0.653 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 24 cost time: 3.104628562927246
Epoch: 24, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.655 Vali Acc: 0.761 Test Loss: 0.655 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.903663396835327
Epoch: 25, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.669 Vali Acc: 0.761 Test Loss: 0.669 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.0947699546813965
Epoch: 26, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.666 Vali Acc: 0.783 Test Loss: 0.666 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783327).  Saving model ...
Epoch: 27 cost time: 2.8406221866607666
Epoch: 27, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.667 Vali Acc: 0.756 Test Loss: 0.667 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8814713954925537
Epoch: 28, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.656 Vali Acc: 0.772 Test Loss: 0.656 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0269408226013184
Epoch: 29, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.719 Vali Acc: 0.744 Test Loss: 0.719 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.0348877906799316
Epoch: 30, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.687 Vali Acc: 0.744 Test Loss: 0.687 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 711151
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.315483808517456
Epoch: 1, Steps: 12 | Train Loss: 2.753 Vali Loss: 2.681 Vali Acc: 0.094 Test Loss: 2.681 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 2.6832430362701416
Epoch: 2, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.537 Vali Acc: 0.178 Test Loss: 2.537 Test Acc: 0.178
Validation loss decreased (-0.094418 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 2.7350704669952393
Epoch: 3, Steps: 12 | Train Loss: 2.462 Vali Loss: 2.358 Vali Acc: 0.322 Test Loss: 2.358 Test Acc: 0.322
Validation loss decreased (-0.177752 --> -0.322199).  Saving model ...
Epoch: 4 cost time: 2.58056902885437
Epoch: 4, Steps: 12 | Train Loss: 2.224 Vali Loss: 2.172 Vali Acc: 0.444 Test Loss: 2.172 Test Acc: 0.444
Validation loss decreased (-0.322199 --> -0.444423).  Saving model ...
Epoch: 5 cost time: 2.591738224029541
Epoch: 5, Steps: 12 | Train Loss: 2.021 Vali Loss: 1.981 Vali Acc: 0.467 Test Loss: 1.981 Test Acc: 0.467
Validation loss decreased (-0.444423 --> -0.466647).  Saving model ...
Epoch: 6 cost time: 2.7600669860839844
Epoch: 6, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.803 Vali Acc: 0.500 Test Loss: 1.803 Test Acc: 0.500
Validation loss decreased (-0.466647 --> -0.499982).  Saving model ...
Epoch: 7 cost time: 2.6848833560943604
Epoch: 7, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.644 Vali Acc: 0.489 Test Loss: 1.644 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.775667667388916
Epoch: 8, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.487 Vali Acc: 0.544 Test Loss: 1.487 Test Acc: 0.544
Validation loss decreased (-0.499982 --> -0.544430).  Saving model ...
Epoch: 9 cost time: 2.6392736434936523
Epoch: 9, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.380 Vali Acc: 0.550 Test Loss: 1.380 Test Acc: 0.550
Validation loss decreased (-0.544430 --> -0.549986).  Saving model ...
Epoch: 10 cost time: 2.667811632156372
Epoch: 10, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.256 Vali Acc: 0.583 Test Loss: 1.256 Test Acc: 0.583
Validation loss decreased (-0.549986 --> -0.583321).  Saving model ...
Epoch: 11 cost time: 2.731358766555786
Epoch: 11, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.150 Vali Acc: 0.611 Test Loss: 1.150 Test Acc: 0.611
Validation loss decreased (-0.583321 --> -0.611100).  Saving model ...
Epoch: 12 cost time: 2.6991500854492188
Epoch: 12, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.038 Vali Acc: 0.633 Test Loss: 1.038 Test Acc: 0.633
Validation loss decreased (-0.611100 --> -0.633323).  Saving model ...
Epoch: 13 cost time: 2.687288761138916
Epoch: 13, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.978 Vali Acc: 0.661 Test Loss: 0.978 Test Acc: 0.661
Validation loss decreased (-0.633323 --> -0.661101).  Saving model ...
Epoch: 14 cost time: 2.715890407562256
Epoch: 14, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.920 Vali Acc: 0.678 Test Loss: 0.920 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677769).  Saving model ...
Epoch: 15 cost time: 2.779136896133423
Epoch: 15, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.876 Vali Acc: 0.728 Test Loss: 0.876 Test Acc: 0.728
Validation loss decreased (-0.677769 --> -0.727769).  Saving model ...
Epoch: 16 cost time: 2.9282283782958984
Epoch: 16, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.823 Vali Acc: 0.739 Test Loss: 0.823 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738881).  Saving model ...
Epoch: 17 cost time: 2.6248672008514404
Epoch: 17, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.808 Vali Acc: 0.722 Test Loss: 0.808 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7771387100219727
Epoch: 18, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.797 Vali Acc: 0.739 Test Loss: 0.797 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738881).  Saving model ...
Epoch: 19 cost time: 2.690922498703003
Epoch: 19, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.754 Vali Acc: 0.739 Test Loss: 0.754 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738881).  Saving model ...
Epoch: 20 cost time: 2.812865734100342
Epoch: 20, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.764 Vali Acc: 0.739 Test Loss: 0.764 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5180037021636963
Epoch: 21, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749993).  Saving model ...
Epoch: 22 cost time: 2.8778626918792725
Epoch: 22, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.722 Vali Acc: 0.733 Test Loss: 0.722 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.501124858856201
Epoch: 23, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.734 Vali Acc: 0.744 Test Loss: 0.734 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6381711959838867
Epoch: 24, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.855 Vali Acc: 0.722 Test Loss: 0.855 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.413275718688965
Epoch: 25, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.763 Vali Acc: 0.733 Test Loss: 0.763 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.430711269378662
Epoch: 26, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.768 Vali Acc: 0.761 Test Loss: 0.768 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761103).  Saving model ...
Epoch: 27 cost time: 2.347456932067871
Epoch: 27, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.695 Vali Acc: 0.778 Test Loss: 0.695 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777771).  Saving model ...
Epoch: 28 cost time: 2.5725502967834473
Epoch: 28, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.753 Vali Acc: 0.756 Test Loss: 0.753 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.5263783931732178
Epoch: 29, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.756 Vali Acc: 0.783 Test Loss: 0.756 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783326).  Saving model ...
Epoch: 30 cost time: 2.5732858180999756
Epoch: 30, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.657 Vali Acc: 0.789 Test Loss: 0.657 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 2366447
model size : 9.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.78078031539917
Epoch: 1, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.689 Vali Acc: 0.039 Test Loss: 2.689 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 2.029168128967285
Epoch: 2, Steps: 12 | Train Loss: 2.604 Vali Loss: 2.537 Vali Acc: 0.139 Test Loss: 2.537 Test Acc: 0.139
Validation loss decreased (-0.038862 --> -0.138864).  Saving model ...
Epoch: 3 cost time: 2.071035623550415
Epoch: 3, Steps: 12 | Train Loss: 2.374 Vali Loss: 2.355 Vali Acc: 0.267 Test Loss: 2.355 Test Acc: 0.267
Validation loss decreased (-0.138864 --> -0.266643).  Saving model ...
Epoch: 4 cost time: 2.1390256881713867
Epoch: 4, Steps: 12 | Train Loss: 2.147 Vali Loss: 2.154 Vali Acc: 0.433 Test Loss: 2.154 Test Acc: 0.433
Validation loss decreased (-0.266643 --> -0.433312).  Saving model ...
Epoch: 5 cost time: 2.1969170570373535
Epoch: 5, Steps: 12 | Train Loss: 1.940 Vali Loss: 1.964 Vali Acc: 0.500 Test Loss: 1.964 Test Acc: 0.500
Validation loss decreased (-0.433312 --> -0.499980).  Saving model ...
Epoch: 6 cost time: 2.223613977432251
Epoch: 6, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.779 Vali Acc: 0.533 Test Loss: 1.779 Test Acc: 0.533
Validation loss decreased (-0.499980 --> -0.533316).  Saving model ...
Epoch: 7 cost time: 2.058121681213379
Epoch: 7, Steps: 12 | Train Loss: 1.518 Vali Loss: 1.622 Vali Acc: 0.583 Test Loss: 1.622 Test Acc: 0.583
Validation loss decreased (-0.533316 --> -0.583317).  Saving model ...
Epoch: 8 cost time: 2.1367101669311523
Epoch: 8, Steps: 12 | Train Loss: 1.335 Vali Loss: 1.497 Vali Acc: 0.600 Test Loss: 1.497 Test Acc: 0.600
Validation loss decreased (-0.583317 --> -0.599985).  Saving model ...
Epoch: 9 cost time: 2.1699066162109375
Epoch: 9, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.371 Vali Acc: 0.594 Test Loss: 1.371 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.189971923828125
Epoch: 10, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.250 Vali Acc: 0.633 Test Loss: 1.250 Test Acc: 0.633
Validation loss decreased (-0.599985 --> -0.633321).  Saving model ...
Epoch: 11 cost time: 2.397585868835449
Epoch: 11, Steps: 12 | Train Loss: 0.967 Vali Loss: 1.153 Vali Acc: 0.639 Test Loss: 1.153 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 12 cost time: 1.9936811923980713
Epoch: 12, Steps: 12 | Train Loss: 0.854 Vali Loss: 1.044 Vali Acc: 0.667 Test Loss: 1.044 Test Acc: 0.667
Validation loss decreased (-0.638877 --> -0.666656).  Saving model ...
Epoch: 13 cost time: 2.0686278343200684
Epoch: 13, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.990 Vali Acc: 0.689 Test Loss: 0.990 Test Acc: 0.689
Validation loss decreased (-0.666656 --> -0.688879).  Saving model ...
Epoch: 14 cost time: 2.0136992931365967
Epoch: 14, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.919 Vali Acc: 0.700 Test Loss: 0.919 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 2.1241886615753174
Epoch: 15, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.886 Vali Acc: 0.706 Test Loss: 0.886 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705547).  Saving model ...
Epoch: 16 cost time: 2.1572508811950684
Epoch: 16, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.850 Vali Acc: 0.711 Test Loss: 0.850 Test Acc: 0.711
Validation loss decreased (-0.705547 --> -0.711103).  Saving model ...
Epoch: 17 cost time: 2.0697779655456543
Epoch: 17, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.821 Vali Acc: 0.722 Test Loss: 0.821 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722214).  Saving model ...
Epoch: 18 cost time: 2.0672829151153564
Epoch: 18, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
Validation loss decreased (-0.722214 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 2.4159035682678223
Epoch: 19, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 2.1486427783966064
Epoch: 20, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.809 Vali Acc: 0.711 Test Loss: 0.809 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.156221628189087
Epoch: 21, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.787 Vali Acc: 0.722 Test Loss: 0.787 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0488219261169434
Epoch: 22, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.787 Vali Acc: 0.711 Test Loss: 0.787 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.013345718383789
Epoch: 23, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.767 Vali Acc: 0.733 Test Loss: 0.767 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.222987413406372
Epoch: 24, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.755 Vali Acc: 0.733 Test Loss: 0.755 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2534594535827637
Epoch: 25, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.756 Vali Acc: 0.733 Test Loss: 0.756 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.1602725982666016
Epoch: 26, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.744 Vali Acc: 0.756 Test Loss: 0.744 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 27 cost time: 2.2242379188537598
Epoch: 27, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.720 Vali Acc: 0.756 Test Loss: 0.720 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 28 cost time: 2.207017660140991
Epoch: 28, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.768 Vali Acc: 0.728 Test Loss: 0.768 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.329874038696289
Epoch: 29, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.786 Vali Acc: 0.756 Test Loss: 0.786 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.1081955432891846
Epoch: 30, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.745 Vali Acc: 0.756 Test Loss: 0.745 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 711151
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.657814264297485
Epoch: 1, Steps: 12 | Train Loss: 2.812 Vali Loss: 2.784 Vali Acc: 0.100 Test Loss: 2.784 Test Acc: 0.100
Validation loss decreased (inf --> -0.099972).  Saving model ...
Epoch: 2 cost time: 4.281665086746216
Epoch: 2, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.645 Vali Acc: 0.139 Test Loss: 2.645 Test Acc: 0.139
Validation loss decreased (-0.099972 --> -0.138862).  Saving model ...
Epoch: 3 cost time: 4.914464473724365
Epoch: 3, Steps: 12 | Train Loss: 2.531 Vali Loss: 2.463 Vali Acc: 0.267 Test Loss: 2.463 Test Acc: 0.267
Validation loss decreased (-0.138862 --> -0.266642).  Saving model ...
Epoch: 4 cost time: 5.007313251495361
Epoch: 4, Steps: 12 | Train Loss: 2.350 Vali Loss: 2.258 Vali Acc: 0.428 Test Loss: 2.258 Test Acc: 0.428
Validation loss decreased (-0.266642 --> -0.427755).  Saving model ...
Epoch: 5 cost time: 4.582281827926636
Epoch: 5, Steps: 12 | Train Loss: 2.116 Vali Loss: 2.040 Vali Acc: 0.500 Test Loss: 2.040 Test Acc: 0.500
Validation loss decreased (-0.427755 --> -0.499980).  Saving model ...
Epoch: 6 cost time: 4.701262712478638
Epoch: 6, Steps: 12 | Train Loss: 1.887 Vali Loss: 1.836 Vali Acc: 0.522 Test Loss: 1.836 Test Acc: 0.522
Validation loss decreased (-0.499980 --> -0.522204).  Saving model ...
Epoch: 7 cost time: 4.946555852890015
Epoch: 7, Steps: 12 | Train Loss: 1.699 Vali Loss: 1.652 Vali Acc: 0.567 Test Loss: 1.652 Test Acc: 0.567
Validation loss decreased (-0.522204 --> -0.566650).  Saving model ...
Epoch: 8 cost time: 4.889183759689331
Epoch: 8, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.496 Vali Acc: 0.611 Test Loss: 1.496 Test Acc: 0.611
Validation loss decreased (-0.566650 --> -0.611096).  Saving model ...
Epoch: 9 cost time: 4.6154773235321045
Epoch: 9, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.378 Vali Acc: 0.628 Test Loss: 1.378 Test Acc: 0.628
Validation loss decreased (-0.611096 --> -0.627764).  Saving model ...
Epoch: 10 cost time: 5.022336483001709
Epoch: 10, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.278 Vali Acc: 0.639 Test Loss: 1.278 Test Acc: 0.639
Validation loss decreased (-0.627764 --> -0.638876).  Saving model ...
Epoch: 11 cost time: 4.675806999206543
Epoch: 11, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.186 Vali Acc: 0.656 Test Loss: 1.186 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655544).  Saving model ...
Epoch: 12 cost time: 4.687913656234741
Epoch: 12, Steps: 12 | Train Loss: 0.958 Vali Loss: 1.103 Vali Acc: 0.644 Test Loss: 1.103 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.0050880908966064
Epoch: 13, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.028 Vali Acc: 0.644 Test Loss: 1.028 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.71274733543396
Epoch: 14, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.974 Vali Acc: 0.656 Test Loss: 0.974 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655546).  Saving model ...
Epoch: 15 cost time: 4.815985918045044
Epoch: 15, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.910 Vali Acc: 0.683 Test Loss: 0.910 Test Acc: 0.683
Validation loss decreased (-0.655546 --> -0.683324).  Saving model ...
Epoch: 16 cost time: 4.983435869216919
Epoch: 16, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.880 Vali Acc: 0.672 Test Loss: 0.880 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.701092481613159
Epoch: 17, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.861 Vali Acc: 0.694 Test Loss: 0.861 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694436).  Saving model ...
Epoch: 18 cost time: 4.669311761856079
Epoch: 18, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.820 Vali Acc: 0.717 Test Loss: 0.820 Test Acc: 0.717
Validation loss decreased (-0.694436 --> -0.716658).  Saving model ...
Epoch: 19 cost time: 5.054322004318237
Epoch: 19, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.808 Vali Acc: 0.706 Test Loss: 0.808 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.903872489929199
Epoch: 20, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.750 Vali Acc: 0.761 Test Loss: 0.750 Test Acc: 0.761
Validation loss decreased (-0.716658 --> -0.761104).  Saving model ...
Epoch: 21 cost time: 4.636647701263428
Epoch: 21, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.749 Vali Acc: 0.744 Test Loss: 0.749 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.75843358039856
Epoch: 22, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.735 Vali Acc: 0.744 Test Loss: 0.735 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.555211544036865
Epoch: 23, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.729 Vali Acc: 0.744 Test Loss: 0.729 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.227943181991577
Epoch: 24, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.715 Vali Acc: 0.756 Test Loss: 0.715 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.382660388946533
Epoch: 25, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.730 Vali Acc: 0.756 Test Loss: 0.730 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.054295539855957
Epoch: 26, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.693 Vali Acc: 0.772 Test Loss: 0.693 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772215).  Saving model ...
Epoch: 27 cost time: 5.137563943862915
Epoch: 27, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.695 Vali Acc: 0.761 Test Loss: 0.695 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.932859659194946
Epoch: 28, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.715 Vali Acc: 0.772 Test Loss: 0.715 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.188246488571167
Epoch: 29, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.692 Vali Acc: 0.756 Test Loss: 0.692 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.2796406745910645
Epoch: 30, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 2355839
model size : 9.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.253157377243042
Epoch: 1, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.669 Vali Acc: 0.161 Test Loss: 2.669 Test Acc: 0.161
Validation loss decreased (inf --> -0.161084).  Saving model ...
Epoch: 2 cost time: 3.521049976348877
Epoch: 2, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.551 Vali Acc: 0.217 Test Loss: 2.551 Test Acc: 0.217
Validation loss decreased (-0.161084 --> -0.216641).  Saving model ...
Epoch: 3 cost time: 3.6956279277801514
Epoch: 3, Steps: 12 | Train Loss: 2.498 Vali Loss: 2.394 Vali Acc: 0.322 Test Loss: 2.394 Test Acc: 0.322
Validation loss decreased (-0.216641 --> -0.322198).  Saving model ...
Epoch: 4 cost time: 3.5878043174743652
Epoch: 4, Steps: 12 | Train Loss: 2.315 Vali Loss: 2.226 Vali Acc: 0.417 Test Loss: 2.226 Test Acc: 0.417
Validation loss decreased (-0.322198 --> -0.416644).  Saving model ...
Epoch: 5 cost time: 3.6048061847686768
Epoch: 5, Steps: 12 | Train Loss: 2.130 Vali Loss: 2.047 Vali Acc: 0.578 Test Loss: 2.047 Test Acc: 0.578
Validation loss decreased (-0.416644 --> -0.577757).  Saving model ...
Epoch: 6 cost time: 3.5835134983062744
Epoch: 6, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.868 Vali Acc: 0.611 Test Loss: 1.868 Test Acc: 0.611
Validation loss decreased (-0.577757 --> -0.611092).  Saving model ...
Epoch: 7 cost time: 3.4686713218688965
Epoch: 7, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.696 Vali Acc: 0.611 Test Loss: 1.696 Test Acc: 0.611
Validation loss decreased (-0.611092 --> -0.611094).  Saving model ...
Epoch: 8 cost time: 3.4851388931274414
Epoch: 8, Steps: 12 | Train Loss: 1.516 Vali Loss: 1.547 Vali Acc: 0.628 Test Loss: 1.547 Test Acc: 0.628
Validation loss decreased (-0.611094 --> -0.627762).  Saving model ...
Epoch: 9 cost time: 3.7021939754486084
Epoch: 9, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.420 Vali Acc: 0.633 Test Loss: 1.420 Test Acc: 0.633
Validation loss decreased (-0.627762 --> -0.633319).  Saving model ...
Epoch: 10 cost time: 3.5905439853668213
Epoch: 10, Steps: 12 | Train Loss: 1.216 Vali Loss: 1.306 Vali Acc: 0.639 Test Loss: 1.306 Test Acc: 0.639
Validation loss decreased (-0.633319 --> -0.638876).  Saving model ...
Epoch: 11 cost time: 3.640225648880005
Epoch: 11, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.220 Vali Acc: 0.667 Test Loss: 1.220 Test Acc: 0.667
Validation loss decreased (-0.638876 --> -0.666654).  Saving model ...
Epoch: 12 cost time: 3.4944705963134766
Epoch: 12, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.138 Vali Acc: 0.661 Test Loss: 1.138 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.429717540740967
Epoch: 13, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.066 Vali Acc: 0.667 Test Loss: 1.066 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666656).  Saving model ...
Epoch: 14 cost time: 3.4401893615722656
Epoch: 14, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.013 Vali Acc: 0.672 Test Loss: 1.013 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672212).  Saving model ...
Epoch: 15 cost time: 3.71962833404541
Epoch: 15, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.957 Vali Acc: 0.683 Test Loss: 0.957 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683324).  Saving model ...
Epoch: 16 cost time: 3.5717742443084717
Epoch: 16, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.905 Vali Acc: 0.672 Test Loss: 0.905 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5792057514190674
Epoch: 17, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.863 Vali Acc: 0.683 Test Loss: 0.863 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683325).  Saving model ...
Epoch: 18 cost time: 3.655160665512085
Epoch: 18, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.816 Vali Acc: 0.739 Test Loss: 0.816 Test Acc: 0.739
Validation loss decreased (-0.683325 --> -0.738881).  Saving model ...
Epoch: 19 cost time: 3.4826881885528564
Epoch: 19, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.796 Vali Acc: 0.717 Test Loss: 0.796 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4999420642852783
Epoch: 20, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.768 Vali Acc: 0.739 Test Loss: 0.768 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738881).  Saving model ...
Epoch: 21 cost time: 3.749413251876831
Epoch: 21, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.742 Vali Acc: 0.733 Test Loss: 0.742 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7229833602905273
Epoch: 22, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.717 Vali Acc: 0.744 Test Loss: 0.717 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 23 cost time: 3.567312240600586
Epoch: 23, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.720 Vali Acc: 0.744 Test Loss: 0.720 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.610471487045288
Epoch: 24, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.704 Vali Acc: 0.772 Test Loss: 0.704 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772215).  Saving model ...
Epoch: 25 cost time: 3.525115966796875
Epoch: 25, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.671 Vali Acc: 0.772 Test Loss: 0.671 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772216).  Saving model ...
Epoch: 26 cost time: 3.4410784244537354
Epoch: 26, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.663 Vali Acc: 0.772 Test Loss: 0.663 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772216).  Saving model ...
Epoch: 27 cost time: 3.6087636947631836
Epoch: 27, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.666 Vali Acc: 0.756 Test Loss: 0.666 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.618265151977539
Epoch: 28, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.662 Vali Acc: 0.772 Test Loss: 0.662 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772216).  Saving model ...
Epoch: 29 cost time: 3.5528476238250732
Epoch: 29, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.653 Vali Acc: 0.767 Test Loss: 0.653 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.3578972816467285
Epoch: 30, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.634 Vali Acc: 0.778 Test Loss: 0.634 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777771).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 700415
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.633164167404175
Epoch: 1, Steps: 12 | Train Loss: 2.811 Vali Loss: 2.783 Vali Acc: 0.094 Test Loss: 2.783 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 3.8101987838745117
Epoch: 2, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.644 Vali Acc: 0.133 Test Loss: 2.644 Test Acc: 0.133
Validation loss decreased (-0.094417 --> -0.133307).  Saving model ...
Epoch: 3 cost time: 3.9230685234069824
Epoch: 3, Steps: 12 | Train Loss: 2.530 Vali Loss: 2.463 Vali Acc: 0.267 Test Loss: 2.463 Test Acc: 0.267
Validation loss decreased (-0.133307 --> -0.266642).  Saving model ...
Epoch: 4 cost time: 3.6797659397125244
Epoch: 4, Steps: 12 | Train Loss: 2.351 Vali Loss: 2.259 Vali Acc: 0.422 Test Loss: 2.259 Test Acc: 0.422
Validation loss decreased (-0.266642 --> -0.422200).  Saving model ...
Epoch: 5 cost time: 3.5085060596466064
Epoch: 5, Steps: 12 | Train Loss: 2.117 Vali Loss: 2.043 Vali Acc: 0.494 Test Loss: 2.043 Test Acc: 0.494
Validation loss decreased (-0.422200 --> -0.494424).  Saving model ...
Epoch: 6 cost time: 3.5436244010925293
Epoch: 6, Steps: 12 | Train Loss: 1.889 Vali Loss: 1.842 Vali Acc: 0.517 Test Loss: 1.842 Test Acc: 0.517
Validation loss decreased (-0.494424 --> -0.516648).  Saving model ...
Epoch: 7 cost time: 3.732282876968384
Epoch: 7, Steps: 12 | Train Loss: 1.705 Vali Loss: 1.660 Vali Acc: 0.561 Test Loss: 1.660 Test Acc: 0.561
Validation loss decreased (-0.516648 --> -0.561095).  Saving model ...
Epoch: 8 cost time: 3.789464235305786
Epoch: 8, Steps: 12 | Train Loss: 1.459 Vali Loss: 1.508 Vali Acc: 0.594 Test Loss: 1.508 Test Acc: 0.594
Validation loss decreased (-0.561095 --> -0.594429).  Saving model ...
Epoch: 9 cost time: 3.8533272743225098
Epoch: 9, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.391 Vali Acc: 0.622 Test Loss: 1.391 Test Acc: 0.622
Validation loss decreased (-0.594429 --> -0.622208).  Saving model ...
Epoch: 10 cost time: 3.622648000717163
Epoch: 10, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.289 Vali Acc: 0.622 Test Loss: 1.289 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622209).  Saving model ...
Epoch: 11 cost time: 3.427009344100952
Epoch: 11, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.200 Vali Acc: 0.650 Test Loss: 1.200 Test Acc: 0.650
Validation loss decreased (-0.622209 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 3.852278709411621
Epoch: 12, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.106 Vali Acc: 0.650 Test Loss: 1.106 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 3.7020108699798584
Epoch: 13, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 3.9125044345855713
Epoch: 14, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.977 Vali Acc: 0.661 Test Loss: 0.977 Test Acc: 0.661
Validation loss decreased (-0.649990 --> -0.661101).  Saving model ...
Epoch: 15 cost time: 4.013152360916138
Epoch: 15, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.910 Vali Acc: 0.672 Test Loss: 0.910 Test Acc: 0.672
Validation loss decreased (-0.661101 --> -0.672213).  Saving model ...
Epoch: 16 cost time: 3.722090005874634
Epoch: 16, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.877 Vali Acc: 0.672 Test Loss: 0.877 Test Acc: 0.672
Validation loss decreased (-0.672213 --> -0.672213).  Saving model ...
Epoch: 17 cost time: 3.4098775386810303
Epoch: 17, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.826 Vali Acc: 0.689 Test Loss: 0.826 Test Acc: 0.689
Validation loss decreased (-0.672213 --> -0.688881).  Saving model ...
Epoch: 18 cost time: 3.846580982208252
Epoch: 18, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.793 Vali Acc: 0.706 Test Loss: 0.793 Test Acc: 0.706
Validation loss decreased (-0.688881 --> -0.705548).  Saving model ...
Epoch: 19 cost time: 3.5812416076660156
Epoch: 19, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.752 Vali Acc: 0.711 Test Loss: 0.752 Test Acc: 0.711
Validation loss decreased (-0.705548 --> -0.711104).  Saving model ...
Epoch: 20 cost time: 4.018578052520752
Epoch: 20, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.718 Vali Acc: 0.739 Test Loss: 0.718 Test Acc: 0.739
Validation loss decreased (-0.711104 --> -0.738882).  Saving model ...
Epoch: 21 cost time: 3.837357997894287
Epoch: 21, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.713 Vali Acc: 0.728 Test Loss: 0.713 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.877657890319824
Epoch: 22, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.694 Vali Acc: 0.744 Test Loss: 0.694 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 23 cost time: 3.6549174785614014
Epoch: 23, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.681 Vali Acc: 0.733 Test Loss: 0.681 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.782545566558838
Epoch: 24, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.671 Vali Acc: 0.728 Test Loss: 0.671 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.890489339828491
Epoch: 25, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.658 Vali Acc: 0.750 Test Loss: 0.658 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749993).  Saving model ...
Epoch: 26 cost time: 3.967400550842285
Epoch: 26, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.645 Vali Acc: 0.778 Test Loss: 0.645 Test Acc: 0.778
Validation loss decreased (-0.749993 --> -0.777771).  Saving model ...
Epoch: 27 cost time: 3.877486228942871
Epoch: 27, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.655 Vali Acc: 0.739 Test Loss: 0.655 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.661588430404663
Epoch: 28, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.683 Vali Acc: 0.761 Test Loss: 0.683 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.589484930038452
Epoch: 29, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.661 Vali Acc: 0.761 Test Loss: 0.661 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.625349998474121
Epoch: 30, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.669 Vali Acc: 0.750 Test Loss: 0.669 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 2355839
model size : 9.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.980677127838135
Epoch: 1, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.669 Vali Acc: 0.161 Test Loss: 2.669 Test Acc: 0.161
Validation loss decreased (inf --> -0.161084).  Saving model ...
Epoch: 2 cost time: 3.061744213104248
Epoch: 2, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.550 Vali Acc: 0.217 Test Loss: 2.550 Test Acc: 0.217
Validation loss decreased (-0.161084 --> -0.216641).  Saving model ...
Epoch: 3 cost time: 2.9645960330963135
Epoch: 3, Steps: 12 | Train Loss: 2.498 Vali Loss: 2.394 Vali Acc: 0.317 Test Loss: 2.394 Test Acc: 0.317
Validation loss decreased (-0.216641 --> -0.316643).  Saving model ...
Epoch: 4 cost time: 3.151029348373413
Epoch: 4, Steps: 12 | Train Loss: 2.315 Vali Loss: 2.227 Vali Acc: 0.422 Test Loss: 2.227 Test Acc: 0.422
Validation loss decreased (-0.316643 --> -0.422200).  Saving model ...
Epoch: 5 cost time: 2.972062826156616
Epoch: 5, Steps: 12 | Train Loss: 2.133 Vali Loss: 2.047 Vali Acc: 0.583 Test Loss: 2.047 Test Acc: 0.583
Validation loss decreased (-0.422200 --> -0.583313).  Saving model ...
Epoch: 6 cost time: 3.2997281551361084
Epoch: 6, Steps: 12 | Train Loss: 1.937 Vali Loss: 1.869 Vali Acc: 0.611 Test Loss: 1.869 Test Acc: 0.611
Validation loss decreased (-0.583313 --> -0.611092).  Saving model ...
Epoch: 7 cost time: 3.128502368927002
Epoch: 7, Steps: 12 | Train Loss: 1.721 Vali Loss: 1.698 Vali Acc: 0.617 Test Loss: 1.698 Test Acc: 0.617
Validation loss decreased (-0.611092 --> -0.616650).  Saving model ...
Epoch: 8 cost time: 3.2608745098114014
Epoch: 8, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.550 Vali Acc: 0.617 Test Loss: 1.550 Test Acc: 0.617
Validation loss decreased (-0.616650 --> -0.616651).  Saving model ...
Epoch: 9 cost time: 3.008012294769287
Epoch: 9, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.424 Vali Acc: 0.633 Test Loss: 1.424 Test Acc: 0.633
Validation loss decreased (-0.616651 --> -0.633319).  Saving model ...
Epoch: 10 cost time: 3.042234182357788
Epoch: 10, Steps: 12 | Train Loss: 1.234 Vali Loss: 1.313 Vali Acc: 0.644 Test Loss: 1.313 Test Acc: 0.644
Validation loss decreased (-0.633319 --> -0.644431).  Saving model ...
Epoch: 11 cost time: 2.9386706352233887
Epoch: 11, Steps: 12 | Train Loss: 1.121 Vali Loss: 1.230 Vali Acc: 0.661 Test Loss: 1.230 Test Acc: 0.661
Validation loss decreased (-0.644431 --> -0.661099).  Saving model ...
Epoch: 12 cost time: 3.1264827251434326
Epoch: 12, Steps: 12 | Train Loss: 0.983 Vali Loss: 1.150 Vali Acc: 0.644 Test Loss: 1.150 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1778979301452637
Epoch: 13, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.082 Vali Acc: 0.661 Test Loss: 1.082 Test Acc: 0.661
Validation loss decreased (-0.661099 --> -0.661100).  Saving model ...
Epoch: 14 cost time: 3.1215262413024902
Epoch: 14, Steps: 12 | Train Loss: 0.832 Vali Loss: 1.034 Vali Acc: 0.661 Test Loss: 1.034 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661101).  Saving model ...
Epoch: 15 cost time: 2.984541893005371
Epoch: 15, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.979 Vali Acc: 0.683 Test Loss: 0.979 Test Acc: 0.683
Validation loss decreased (-0.661101 --> -0.683324).  Saving model ...
Epoch: 16 cost time: 2.9915552139282227
Epoch: 16, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.937 Vali Acc: 0.672 Test Loss: 0.937 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0554280281066895
Epoch: 17, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.895 Vali Acc: 0.672 Test Loss: 0.895 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.090630054473877
Epoch: 18, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.850 Vali Acc: 0.711 Test Loss: 0.850 Test Acc: 0.711
Validation loss decreased (-0.683324 --> -0.711103).  Saving model ...
Epoch: 19 cost time: 3.205012559890747
Epoch: 19, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.829 Vali Acc: 0.706 Test Loss: 0.829 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1070449352264404
Epoch: 20, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.804 Vali Acc: 0.706 Test Loss: 0.804 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.4126975536346436
Epoch: 21, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.769 Vali Acc: 0.722 Test Loss: 0.769 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722215).  Saving model ...
Epoch: 22 cost time: 2.9413695335388184
Epoch: 22, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.742 Vali Acc: 0.722 Test Loss: 0.742 Test Acc: 0.722
Validation loss decreased (-0.722215 --> -0.722215).  Saving model ...
Epoch: 23 cost time: 3.0575449466705322
Epoch: 23, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.735 Vali Acc: 0.728 Test Loss: 0.735 Test Acc: 0.728
Validation loss decreased (-0.722215 --> -0.727770).  Saving model ...
Epoch: 24 cost time: 2.9453577995300293
Epoch: 24, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.698 Vali Acc: 0.756 Test Loss: 0.698 Test Acc: 0.756
Validation loss decreased (-0.727770 --> -0.755549).  Saving model ...
Epoch: 25 cost time: 3.266547441482544
Epoch: 25, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.673 Vali Acc: 0.756 Test Loss: 0.673 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 26 cost time: 3.164745330810547
Epoch: 26, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.674 Vali Acc: 0.772 Test Loss: 0.674 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772215).  Saving model ...
Epoch: 27 cost time: 3.2724485397338867
Epoch: 27, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.670 Vali Acc: 0.767 Test Loss: 0.670 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.987255811691284
Epoch: 28, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.680 Vali Acc: 0.761 Test Loss: 0.680 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.969252824783325
Epoch: 29, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.663 Vali Acc: 0.756 Test Loss: 0.663 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.999826192855835
Epoch: 30, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.625 Vali Acc: 0.767 Test Loss: 0.625 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 700415
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.5756142139434814
Epoch: 1, Steps: 12 | Train Loss: 2.818 Vali Loss: 2.798 Vali Acc: 0.094 Test Loss: 2.798 Test Acc: 0.094
Validation loss decreased (inf --> -0.094416).  Saving model ...
Epoch: 2 cost time: 2.9249308109283447
Epoch: 2, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.699 Vali Acc: 0.117 Test Loss: 2.699 Test Acc: 0.117
Validation loss decreased (-0.094416 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 2.7834548950195312
Epoch: 3, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.557 Vali Acc: 0.178 Test Loss: 2.557 Test Acc: 0.178
Validation loss decreased (-0.116640 --> -0.177752).  Saving model ...
Epoch: 4 cost time: 2.725041389465332
Epoch: 4, Steps: 12 | Train Loss: 2.479 Vali Loss: 2.397 Vali Acc: 0.361 Test Loss: 2.397 Test Acc: 0.361
Validation loss decreased (-0.177752 --> -0.361087).  Saving model ...
Epoch: 5 cost time: 2.651486873626709
Epoch: 5, Steps: 12 | Train Loss: 2.318 Vali Loss: 2.240 Vali Acc: 0.456 Test Loss: 2.240 Test Acc: 0.456
Validation loss decreased (-0.361087 --> -0.455533).  Saving model ...
Epoch: 6 cost time: 2.6774518489837646
Epoch: 6, Steps: 12 | Train Loss: 2.148 Vali Loss: 2.102 Vali Acc: 0.494 Test Loss: 2.102 Test Acc: 0.494
Validation loss decreased (-0.455533 --> -0.494423).  Saving model ...
Epoch: 7 cost time: 2.9883480072021484
Epoch: 7, Steps: 12 | Train Loss: 2.006 Vali Loss: 1.968 Vali Acc: 0.511 Test Loss: 1.968 Test Acc: 0.511
Validation loss decreased (-0.494423 --> -0.511091).  Saving model ...
Epoch: 8 cost time: 3.0062084197998047
Epoch: 8, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.834 Vali Acc: 0.550 Test Loss: 1.834 Test Acc: 0.550
Validation loss decreased (-0.511091 --> -0.549982).  Saving model ...
Epoch: 9 cost time: 2.9846246242523193
Epoch: 9, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.698 Vali Acc: 0.583 Test Loss: 1.698 Test Acc: 0.583
Validation loss decreased (-0.549982 --> -0.583316).  Saving model ...
Epoch: 10 cost time: 2.724189519882202
Epoch: 10, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.570 Vali Acc: 0.583 Test Loss: 1.570 Test Acc: 0.583
Validation loss decreased (-0.583316 --> -0.583318).  Saving model ...
Epoch: 11 cost time: 2.7336761951446533
Epoch: 11, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.452 Vali Acc: 0.628 Test Loss: 1.452 Test Acc: 0.628
Validation loss decreased (-0.583318 --> -0.627763).  Saving model ...
Epoch: 12 cost time: 2.7729134559631348
Epoch: 12, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.347 Vali Acc: 0.622 Test Loss: 1.347 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.67411208152771
Epoch: 13, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.263 Vali Acc: 0.633 Test Loss: 1.263 Test Acc: 0.633
Validation loss decreased (-0.627763 --> -0.633321).  Saving model ...
Epoch: 14 cost time: 2.9065799713134766
Epoch: 14, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.197 Vali Acc: 0.639 Test Loss: 1.197 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 15 cost time: 2.7741265296936035
Epoch: 15, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.126 Vali Acc: 0.639 Test Loss: 1.126 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638878).  Saving model ...
Epoch: 16 cost time: 2.826301097869873
Epoch: 16, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.085 Vali Acc: 0.650 Test Loss: 1.085 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649989).  Saving model ...
Epoch: 17 cost time: 2.589935779571533
Epoch: 17, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.034 Vali Acc: 0.656 Test Loss: 1.034 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655545).  Saving model ...
Epoch: 18 cost time: 2.4564576148986816
Epoch: 18, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.997 Vali Acc: 0.706 Test Loss: 0.997 Test Acc: 0.706
Validation loss decreased (-0.655545 --> -0.705546).  Saving model ...
Epoch: 19 cost time: 2.8103883266448975
Epoch: 19, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.948 Vali Acc: 0.739 Test Loss: 0.948 Test Acc: 0.739
Validation loss decreased (-0.705546 --> -0.738879).  Saving model ...
Epoch: 20 cost time: 2.8253512382507324
Epoch: 20, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.913 Vali Acc: 0.711 Test Loss: 0.913 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8189444541931152
Epoch: 21, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.915 Vali Acc: 0.694 Test Loss: 0.915 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.8637728691101074
Epoch: 22, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.895 Vali Acc: 0.683 Test Loss: 0.895 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5533668994903564
Epoch: 23, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.882 Vali Acc: 0.689 Test Loss: 0.882 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.4641754627227783
Epoch: 24, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.848 Vali Acc: 0.689 Test Loss: 0.848 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.9023520946502686
Epoch: 25, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.834 Vali Acc: 0.706 Test Loss: 0.834 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.753931760787964
Epoch: 26, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.828 Vali Acc: 0.750 Test Loss: 0.828 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749992).  Saving model ...
Epoch: 27 cost time: 2.5479512214660645
Epoch: 27, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.797 Vali Acc: 0.717 Test Loss: 0.797 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8240973949432373
Epoch: 28, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.809 Vali Acc: 0.744 Test Loss: 0.809 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.7130725383758545
Epoch: 29, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.781 Vali Acc: 0.761 Test Loss: 0.781 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 30 cost time: 2.5853631496429443
Epoch: 30, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.803 Vali Acc: 0.711 Test Loss: 0.803 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 2355839
model size : 9.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.263623476028442
Epoch: 1, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.674 Vali Acc: 0.139 Test Loss: 2.674 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 2.3309547901153564
Epoch: 2, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.579 Vali Acc: 0.178 Test Loss: 2.579 Test Acc: 0.178
Validation loss decreased (-0.138862 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 2.355336904525757
Epoch: 3, Steps: 12 | Train Loss: 2.554 Vali Loss: 2.453 Vali Acc: 0.261 Test Loss: 2.453 Test Acc: 0.261
Validation loss decreased (-0.177752 --> -0.261087).  Saving model ...
Epoch: 4 cost time: 2.5269553661346436
Epoch: 4, Steps: 12 | Train Loss: 2.396 Vali Loss: 2.309 Vali Acc: 0.383 Test Loss: 2.309 Test Acc: 0.383
Validation loss decreased (-0.261087 --> -0.383310).  Saving model ...
Epoch: 5 cost time: 2.3596091270446777
Epoch: 5, Steps: 12 | Train Loss: 2.241 Vali Loss: 2.160 Vali Acc: 0.511 Test Loss: 2.160 Test Acc: 0.511
Validation loss decreased (-0.383310 --> -0.511090).  Saving model ...
Epoch: 6 cost time: 2.3393948078155518
Epoch: 6, Steps: 12 | Train Loss: 2.079 Vali Loss: 2.015 Vali Acc: 0.567 Test Loss: 2.015 Test Acc: 0.567
Validation loss decreased (-0.511090 --> -0.566647).  Saving model ...
Epoch: 7 cost time: 2.3890976905822754
Epoch: 7, Steps: 12 | Train Loss: 1.929 Vali Loss: 1.877 Vali Acc: 0.550 Test Loss: 1.877 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3867413997650146
Epoch: 8, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.760 Vali Acc: 0.567 Test Loss: 1.760 Test Acc: 0.567
Validation loss decreased (-0.566647 --> -0.566649).  Saving model ...
Epoch: 9 cost time: 2.375933885574341
Epoch: 9, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.656 Vali Acc: 0.583 Test Loss: 1.656 Test Acc: 0.583
Validation loss decreased (-0.566649 --> -0.583317).  Saving model ...
Epoch: 10 cost time: 2.557783842086792
Epoch: 10, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.544 Vali Acc: 0.594 Test Loss: 1.544 Test Acc: 0.594
Validation loss decreased (-0.583317 --> -0.594429).  Saving model ...
Epoch: 11 cost time: 2.5005719661712646
Epoch: 11, Steps: 12 | Train Loss: 1.390 Vali Loss: 1.456 Vali Acc: 0.617 Test Loss: 1.456 Test Acc: 0.617
Validation loss decreased (-0.594429 --> -0.616652).  Saving model ...
Epoch: 12 cost time: 2.3866138458251953
Epoch: 12, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.373 Vali Acc: 0.600 Test Loss: 1.373 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.462876796722412
Epoch: 13, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.291 Vali Acc: 0.606 Test Loss: 1.291 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.343749523162842
Epoch: 14, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.224 Vali Acc: 0.611 Test Loss: 1.224 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.410977602005005
Epoch: 15, Steps: 12 | Train Loss: 1.019 Vali Loss: 1.152 Vali Acc: 0.611 Test Loss: 1.152 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2778420448303223
Epoch: 16, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.085 Vali Acc: 0.633 Test Loss: 1.085 Test Acc: 0.633
Validation loss decreased (-0.616652 --> -0.633322).  Saving model ...
Epoch: 17 cost time: 2.660337209701538
Epoch: 17, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.025 Vali Acc: 0.639 Test Loss: 1.025 Test Acc: 0.639
Validation loss decreased (-0.633322 --> -0.638879).  Saving model ...
Epoch: 18 cost time: 2.474005937576294
Epoch: 18, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.970 Vali Acc: 0.678 Test Loss: 0.970 Test Acc: 0.678
Validation loss decreased (-0.638879 --> -0.677768).  Saving model ...
Epoch: 19 cost time: 2.505786895751953
Epoch: 19, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.940 Vali Acc: 0.694 Test Loss: 0.940 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694435).  Saving model ...
Epoch: 20 cost time: 2.448166608810425
Epoch: 20, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.908 Vali Acc: 0.694 Test Loss: 0.908 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 21 cost time: 2.5208234786987305
Epoch: 21, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.869 Vali Acc: 0.706 Test Loss: 0.869 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705547).  Saving model ...
Epoch: 22 cost time: 2.6864426136016846
Epoch: 22, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.876 Vali Acc: 0.706 Test Loss: 0.876 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6135313510894775
Epoch: 23, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.837 Vali Acc: 0.728 Test Loss: 0.837 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727769).  Saving model ...
Epoch: 24 cost time: 2.49745512008667
Epoch: 24, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.823 Vali Acc: 0.750 Test Loss: 0.823 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 25 cost time: 2.5793278217315674
Epoch: 25, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.811 Vali Acc: 0.711 Test Loss: 0.811 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.474896192550659
Epoch: 26, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.779 Vali Acc: 0.744 Test Loss: 0.779 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.5244345664978027
Epoch: 27, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.741 Vali Acc: 0.739 Test Loss: 0.741 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.669020891189575
Epoch: 28, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.784 Vali Acc: 0.756 Test Loss: 0.784 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 29 cost time: 2.6200644969940186
Epoch: 29, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.738 Vali Acc: 0.744 Test Loss: 0.738 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.492915391921997
Epoch: 30, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.747 Vali Acc: 0.756 Test Loss: 0.747 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 700415
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.34868049621582
Epoch: 1, Steps: 12 | Train Loss: 2.761 Vali Loss: 2.756 Vali Acc: 0.083 Test Loss: 2.756 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 4.3624303340911865
Epoch: 2, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.652 Vali Acc: 0.144 Test Loss: 2.652 Test Acc: 0.144
Validation loss decreased (-0.083306 --> -0.144418).  Saving model ...
Epoch: 3 cost time: 4.233898878097534
Epoch: 3, Steps: 12 | Train Loss: 2.596 Vali Loss: 2.522 Vali Acc: 0.222 Test Loss: 2.522 Test Acc: 0.222
Validation loss decreased (-0.144418 --> -0.222197).  Saving model ...
Epoch: 4 cost time: 4.307003736495972
Epoch: 4, Steps: 12 | Train Loss: 2.420 Vali Loss: 2.367 Vali Acc: 0.333 Test Loss: 2.367 Test Acc: 0.333
Validation loss decreased (-0.222197 --> -0.333310).  Saving model ...
Epoch: 5 cost time: 4.702520370483398
Epoch: 5, Steps: 12 | Train Loss: 2.244 Vali Loss: 2.195 Vali Acc: 0.433 Test Loss: 2.195 Test Acc: 0.433
Validation loss decreased (-0.333310 --> -0.433311).  Saving model ...
Epoch: 6 cost time: 4.62154746055603
Epoch: 6, Steps: 12 | Train Loss: 2.050 Vali Loss: 2.001 Vali Acc: 0.528 Test Loss: 2.001 Test Acc: 0.528
Validation loss decreased (-0.433311 --> -0.527758).  Saving model ...
Epoch: 7 cost time: 4.242904901504517
Epoch: 7, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.816 Vali Acc: 0.533 Test Loss: 1.816 Test Acc: 0.533
Validation loss decreased (-0.527758 --> -0.533315).  Saving model ...
Epoch: 8 cost time: 4.167882442474365
Epoch: 8, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.634 Vali Acc: 0.572 Test Loss: 1.634 Test Acc: 0.572
Validation loss decreased (-0.533315 --> -0.572206).  Saving model ...
Epoch: 9 cost time: 4.4241414070129395
Epoch: 9, Steps: 12 | Train Loss: 1.434 Vali Loss: 1.476 Vali Acc: 0.589 Test Loss: 1.476 Test Acc: 0.589
Validation loss decreased (-0.572206 --> -0.588874).  Saving model ...
Epoch: 10 cost time: 4.5035340785980225
Epoch: 10, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.350 Vali Acc: 0.617 Test Loss: 1.350 Test Acc: 0.617
Validation loss decreased (-0.588874 --> -0.616653).  Saving model ...
Epoch: 11 cost time: 4.249168395996094
Epoch: 11, Steps: 12 | Train Loss: 1.105 Vali Loss: 1.236 Vali Acc: 0.639 Test Loss: 1.236 Test Acc: 0.639
Validation loss decreased (-0.616653 --> -0.638877).  Saving model ...
Epoch: 12 cost time: 4.32110595703125
Epoch: 12, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.145 Vali Acc: 0.656 Test Loss: 1.145 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655544).  Saving model ...
Epoch: 13 cost time: 4.317694664001465
Epoch: 13, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.063 Vali Acc: 0.667 Test Loss: 1.063 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 14 cost time: 4.689142465591431
Epoch: 14, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.999 Vali Acc: 0.667 Test Loss: 0.999 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 15 cost time: 4.281226873397827
Epoch: 15, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.942 Vali Acc: 0.694 Test Loss: 0.942 Test Acc: 0.694
Validation loss decreased (-0.666657 --> -0.694435).  Saving model ...
Epoch: 16 cost time: 4.44793176651001
Epoch: 16, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.893 Vali Acc: 0.711 Test Loss: 0.893 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 17 cost time: 4.363799333572388
Epoch: 17, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.853 Vali Acc: 0.744 Test Loss: 0.853 Test Acc: 0.744
Validation loss decreased (-0.711102 --> -0.744436).  Saving model ...
Epoch: 18 cost time: 4.586759567260742
Epoch: 18, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.812 Vali Acc: 0.717 Test Loss: 0.812 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.279285430908203
Epoch: 19, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.776 Vali Acc: 0.739 Test Loss: 0.776 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.49206280708313
Epoch: 20, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.755 Vali Acc: 0.739 Test Loss: 0.755 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.279110908508301
Epoch: 21, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.734 Vali Acc: 0.706 Test Loss: 0.734 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.6511921882629395
Epoch: 22, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.715 Vali Acc: 0.750 Test Loss: 0.715 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749993).  Saving model ...
Epoch: 23 cost time: 4.442372560501099
Epoch: 23, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.695 Vali Acc: 0.728 Test Loss: 0.695 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.4989399909973145
Epoch: 24, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.688 Vali Acc: 0.750 Test Loss: 0.688 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 25 cost time: 4.241538763046265
Epoch: 25, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.679 Vali Acc: 0.750 Test Loss: 0.679 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 26 cost time: 4.801843643188477
Epoch: 26, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.684 Vali Acc: 0.750 Test Loss: 0.684 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.595853328704834
Epoch: 27, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.664 Vali Acc: 0.750 Test Loss: 0.664 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 28 cost time: 4.443519830703735
Epoch: 28, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.657 Vali Acc: 0.767 Test Loss: 0.657 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
Epoch: 29 cost time: 3.89790415763855
Epoch: 29, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.478768825531006
Epoch: 30, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.627 Vali Acc: 0.778 Test Loss: 0.627 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777772).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 1183615
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.078442573547363
Epoch: 1, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.731 Vali Acc: 0.061 Test Loss: 2.731 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 3.1027235984802246
Epoch: 2, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.635 Vali Acc: 0.083 Test Loss: 2.635 Test Acc: 0.083
Validation loss decreased (-0.061084 --> -0.083307).  Saving model ...
Epoch: 3 cost time: 3.4632389545440674
Epoch: 3, Steps: 12 | Train Loss: 2.536 Vali Loss: 2.511 Vali Acc: 0.250 Test Loss: 2.511 Test Acc: 0.250
Validation loss decreased (-0.083307 --> -0.249975).  Saving model ...
Epoch: 4 cost time: 3.34725022315979
Epoch: 4, Steps: 12 | Train Loss: 2.388 Vali Loss: 2.370 Vali Acc: 0.406 Test Loss: 2.370 Test Acc: 0.406
Validation loss decreased (-0.249975 --> -0.405532).  Saving model ...
Epoch: 5 cost time: 3.233985185623169
Epoch: 5, Steps: 12 | Train Loss: 2.243 Vali Loss: 2.221 Vali Acc: 0.456 Test Loss: 2.221 Test Acc: 0.456
Validation loss decreased (-0.405532 --> -0.455533).  Saving model ...
Epoch: 6 cost time: 3.113832473754883
Epoch: 6, Steps: 12 | Train Loss: 2.082 Vali Loss: 2.061 Vali Acc: 0.506 Test Loss: 2.061 Test Acc: 0.506
Validation loss decreased (-0.455533 --> -0.505535).  Saving model ...
Epoch: 7 cost time: 3.1942877769470215
Epoch: 7, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.889 Vali Acc: 0.561 Test Loss: 1.889 Test Acc: 0.561
Validation loss decreased (-0.505535 --> -0.561092).  Saving model ...
Epoch: 8 cost time: 3.5039491653442383
Epoch: 8, Steps: 12 | Train Loss: 1.680 Vali Loss: 1.725 Vali Acc: 0.561 Test Loss: 1.725 Test Acc: 0.561
Validation loss decreased (-0.561092 --> -0.561094).  Saving model ...
Epoch: 9 cost time: 3.290187358856201
Epoch: 9, Steps: 12 | Train Loss: 1.515 Vali Loss: 1.580 Vali Acc: 0.567 Test Loss: 1.580 Test Acc: 0.567
Validation loss decreased (-0.561094 --> -0.566651).  Saving model ...
Epoch: 10 cost time: 3.145254135131836
Epoch: 10, Steps: 12 | Train Loss: 1.369 Vali Loss: 1.447 Vali Acc: 0.600 Test Loss: 1.447 Test Acc: 0.600
Validation loss decreased (-0.566651 --> -0.599986).  Saving model ...
Epoch: 11 cost time: 3.1798975467681885
Epoch: 11, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.335 Vali Acc: 0.600 Test Loss: 1.335 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 3.2839415073394775
Epoch: 12, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.242 Vali Acc: 0.617 Test Loss: 1.242 Test Acc: 0.617
Validation loss decreased (-0.599987 --> -0.616654).  Saving model ...
Epoch: 13 cost time: 3.438765048980713
Epoch: 13, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.153 Vali Acc: 0.650 Test Loss: 1.153 Test Acc: 0.650
Validation loss decreased (-0.616654 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 3.189880847930908
Epoch: 14, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.089 Vali Acc: 0.661 Test Loss: 1.089 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661100).  Saving model ...
Epoch: 15 cost time: 3.292484760284424
Epoch: 15, Steps: 12 | Train Loss: 0.832 Vali Loss: 1.038 Vali Acc: 0.667 Test Loss: 1.038 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666656).  Saving model ...
Epoch: 16 cost time: 3.126715898513794
Epoch: 16, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.977 Vali Acc: 0.672 Test Loss: 0.977 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672212).  Saving model ...
Epoch: 17 cost time: 3.1947968006134033
Epoch: 17, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.952 Vali Acc: 0.661 Test Loss: 0.952 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.229517936706543
Epoch: 18, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.907 Vali Acc: 0.667 Test Loss: 0.907 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.040015697479248
Epoch: 19, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.874 Vali Acc: 0.700 Test Loss: 0.874 Test Acc: 0.700
Validation loss decreased (-0.672212 --> -0.699991).  Saving model ...
Epoch: 20 cost time: 3.1166961193084717
Epoch: 20, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.854 Vali Acc: 0.706 Test Loss: 0.854 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705547).  Saving model ...
Epoch: 21 cost time: 2.889148473739624
Epoch: 21, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.824 Vali Acc: 0.706 Test Loss: 0.824 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 22 cost time: 3.1987457275390625
Epoch: 22, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.798 Vali Acc: 0.717 Test Loss: 0.798 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716659).  Saving model ...
Epoch: 23 cost time: 3.103261947631836
Epoch: 23, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.800 Vali Acc: 0.706 Test Loss: 0.800 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.871818780899048
Epoch: 24, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.775 Vali Acc: 0.733 Test Loss: 0.775 Test Acc: 0.733
Validation loss decreased (-0.716659 --> -0.733326).  Saving model ...
Epoch: 25 cost time: 2.8838508129119873
Epoch: 25, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.740 Vali Acc: 0.739 Test Loss: 0.740 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738881).  Saving model ...
Epoch: 26 cost time: 2.958141565322876
Epoch: 26, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.748 Vali Acc: 0.733 Test Loss: 0.748 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.290390729904175
Epoch: 27, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.732 Vali Acc: 0.733 Test Loss: 0.732 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.955334424972534
Epoch: 28, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.724 Vali Acc: 0.739 Test Loss: 0.724 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738882).  Saving model ...
Epoch: 29 cost time: 3.04164981842041
Epoch: 29, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.713 Vali Acc: 0.744 Test Loss: 0.713 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744437).  Saving model ...
Epoch: 30 cost time: 2.913722038269043
Epoch: 30, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.706 Vali Acc: 0.750 Test Loss: 0.706 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 355839
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.926326036453247
Epoch: 1, Steps: 12 | Train Loss: 2.761 Vali Loss: 2.756 Vali Acc: 0.083 Test Loss: 2.756 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 3.1478652954101562
Epoch: 2, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.651 Vali Acc: 0.144 Test Loss: 2.651 Test Acc: 0.144
Validation loss decreased (-0.083306 --> -0.144418).  Saving model ...
Epoch: 3 cost time: 3.0987420082092285
Epoch: 3, Steps: 12 | Train Loss: 2.595 Vali Loss: 2.521 Vali Acc: 0.217 Test Loss: 2.521 Test Acc: 0.217
Validation loss decreased (-0.144418 --> -0.216641).  Saving model ...
Epoch: 4 cost time: 3.442492961883545
Epoch: 4, Steps: 12 | Train Loss: 2.420 Vali Loss: 2.366 Vali Acc: 0.333 Test Loss: 2.366 Test Acc: 0.333
Validation loss decreased (-0.216641 --> -0.333310).  Saving model ...
Epoch: 5 cost time: 3.4925341606140137
Epoch: 5, Steps: 12 | Train Loss: 2.243 Vali Loss: 2.194 Vali Acc: 0.433 Test Loss: 2.194 Test Acc: 0.433
Validation loss decreased (-0.333310 --> -0.433311).  Saving model ...
Epoch: 6 cost time: 3.3228507041931152
Epoch: 6, Steps: 12 | Train Loss: 2.051 Vali Loss: 2.000 Vali Acc: 0.528 Test Loss: 2.000 Test Acc: 0.528
Validation loss decreased (-0.433311 --> -0.527758).  Saving model ...
Epoch: 7 cost time: 3.3609566688537598
Epoch: 7, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.817 Vali Acc: 0.533 Test Loss: 1.817 Test Acc: 0.533
Validation loss decreased (-0.527758 --> -0.533315).  Saving model ...
Epoch: 8 cost time: 3.198451280593872
Epoch: 8, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.638 Vali Acc: 0.572 Test Loss: 1.638 Test Acc: 0.572
Validation loss decreased (-0.533315 --> -0.572206).  Saving model ...
Epoch: 9 cost time: 3.5104453563690186
Epoch: 9, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.484 Vali Acc: 0.594 Test Loss: 1.484 Test Acc: 0.594
Validation loss decreased (-0.572206 --> -0.594430).  Saving model ...
Epoch: 10 cost time: 3.3445959091186523
Epoch: 10, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.362 Vali Acc: 0.606 Test Loss: 1.362 Test Acc: 0.606
Validation loss decreased (-0.594430 --> -0.605542).  Saving model ...
Epoch: 11 cost time: 3.2216429710388184
Epoch: 11, Steps: 12 | Train Loss: 1.127 Vali Loss: 1.252 Vali Acc: 0.633 Test Loss: 1.252 Test Acc: 0.633
Validation loss decreased (-0.605542 --> -0.633321).  Saving model ...
Epoch: 12 cost time: 3.067668914794922
Epoch: 12, Steps: 12 | Train Loss: 1.069 Vali Loss: 1.161 Vali Acc: 0.656 Test Loss: 1.161 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655544).  Saving model ...
Epoch: 13 cost time: 3.531029462814331
Epoch: 13, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.083 Vali Acc: 0.667 Test Loss: 1.083 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 14 cost time: 3.667778491973877
Epoch: 14, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.017 Vali Acc: 0.678 Test Loss: 1.017 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677768).  Saving model ...
Epoch: 15 cost time: 3.4265358448028564
Epoch: 15, Steps: 12 | Train Loss: 0.856 Vali Loss: 0.959 Vali Acc: 0.683 Test Loss: 0.959 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683324).  Saving model ...
Epoch: 16 cost time: 3.4963018894195557
Epoch: 16, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.907 Vali Acc: 0.700 Test Loss: 0.907 Test Acc: 0.700
Validation loss decreased (-0.683324 --> -0.699991).  Saving model ...
Epoch: 17 cost time: 3.347445249557495
Epoch: 17, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.877 Vali Acc: 0.728 Test Loss: 0.877 Test Acc: 0.728
Validation loss decreased (-0.699991 --> -0.727769).  Saving model ...
Epoch: 18 cost time: 3.487973690032959
Epoch: 18, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.832 Vali Acc: 0.700 Test Loss: 0.832 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1952064037323
Epoch: 19, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.793 Vali Acc: 0.711 Test Loss: 0.793 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.363396167755127
Epoch: 20, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.782 Vali Acc: 0.706 Test Loss: 0.782 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.6146352291107178
Epoch: 21, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.757 Vali Acc: 0.706 Test Loss: 0.757 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.6602134704589844
Epoch: 22, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.742 Vali Acc: 0.722 Test Loss: 0.742 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.40556263923645
Epoch: 23, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.4722607135772705
Epoch: 24, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.702 Vali Acc: 0.717 Test Loss: 0.702 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.4767916202545166
Epoch: 25, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.699 Vali Acc: 0.722 Test Loss: 0.699 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.6683452129364014
Epoch: 26, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.687 Vali Acc: 0.744 Test Loss: 0.687 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744438).  Saving model ...
Epoch: 27 cost time: 3.807929515838623
Epoch: 27, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.666 Vali Acc: 0.750 Test Loss: 0.666 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749993).  Saving model ...
Epoch: 28 cost time: 3.4942476749420166
Epoch: 28, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.655 Vali Acc: 0.750 Test Loss: 0.655 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 29 cost time: 3.4747848510742188
Epoch: 29, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.647 Vali Acc: 0.761 Test Loss: 0.647 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761105).  Saving model ...
Epoch: 30 cost time: 3.4362170696258545
Epoch: 30, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
Validation loss decreased (-0.761105 --> -0.783327).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 1183615
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.790292739868164
Epoch: 1, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.731 Vali Acc: 0.061 Test Loss: 2.731 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 3.023730516433716
Epoch: 2, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.635 Vali Acc: 0.083 Test Loss: 2.635 Test Acc: 0.083
Validation loss decreased (-0.061084 --> -0.083307).  Saving model ...
Epoch: 3 cost time: 3.002537488937378
Epoch: 3, Steps: 12 | Train Loss: 2.537 Vali Loss: 2.511 Vali Acc: 0.250 Test Loss: 2.511 Test Acc: 0.250
Validation loss decreased (-0.083307 --> -0.249975).  Saving model ...
Epoch: 4 cost time: 3.1495394706726074
Epoch: 4, Steps: 12 | Train Loss: 2.388 Vali Loss: 2.370 Vali Acc: 0.400 Test Loss: 2.370 Test Acc: 0.400
Validation loss decreased (-0.249975 --> -0.399976).  Saving model ...
Epoch: 5 cost time: 3.3068156242370605
Epoch: 5, Steps: 12 | Train Loss: 2.243 Vali Loss: 2.221 Vali Acc: 0.456 Test Loss: 2.221 Test Acc: 0.456
Validation loss decreased (-0.399976 --> -0.455533).  Saving model ...
Epoch: 6 cost time: 3.034878969192505
Epoch: 6, Steps: 12 | Train Loss: 2.082 Vali Loss: 2.060 Vali Acc: 0.500 Test Loss: 2.060 Test Acc: 0.500
Validation loss decreased (-0.455533 --> -0.499979).  Saving model ...
Epoch: 7 cost time: 3.1055126190185547
Epoch: 7, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.888 Vali Acc: 0.561 Test Loss: 1.888 Test Acc: 0.561
Validation loss decreased (-0.499979 --> -0.561092).  Saving model ...
Epoch: 8 cost time: 3.11562180519104
Epoch: 8, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.725 Vali Acc: 0.567 Test Loss: 1.725 Test Acc: 0.567
Validation loss decreased (-0.561092 --> -0.566649).  Saving model ...
Epoch: 9 cost time: 3.210433006286621
Epoch: 9, Steps: 12 | Train Loss: 1.516 Vali Loss: 1.580 Vali Acc: 0.567 Test Loss: 1.580 Test Acc: 0.567
Validation loss decreased (-0.566649 --> -0.566651).  Saving model ...
Epoch: 10 cost time: 3.308901309967041
Epoch: 10, Steps: 12 | Train Loss: 1.369 Vali Loss: 1.446 Vali Acc: 0.600 Test Loss: 1.446 Test Acc: 0.600
Validation loss decreased (-0.566651 --> -0.599986).  Saving model ...
Epoch: 11 cost time: 3.1496474742889404
Epoch: 11, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.334 Vali Acc: 0.606 Test Loss: 1.334 Test Acc: 0.606
Validation loss decreased (-0.599986 --> -0.605542).  Saving model ...
Epoch: 12 cost time: 3.1657397747039795
Epoch: 12, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.241 Vali Acc: 0.628 Test Loss: 1.241 Test Acc: 0.628
Validation loss decreased (-0.605542 --> -0.627765).  Saving model ...
Epoch: 13 cost time: 3.0996503829956055
Epoch: 13, Steps: 12 | Train Loss: 1.063 Vali Loss: 1.153 Vali Acc: 0.656 Test Loss: 1.153 Test Acc: 0.656
Validation loss decreased (-0.627765 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 3.2409322261810303
Epoch: 14, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.089 Vali Acc: 0.656 Test Loss: 1.089 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655545).  Saving model ...
Epoch: 15 cost time: 3.305473804473877
Epoch: 15, Steps: 12 | Train Loss: 0.835 Vali Loss: 1.037 Vali Acc: 0.672 Test Loss: 1.037 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672212).  Saving model ...
Epoch: 16 cost time: 3.342496395111084
Epoch: 16, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.975 Vali Acc: 0.667 Test Loss: 0.975 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.115100622177124
Epoch: 17, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.950 Vali Acc: 0.667 Test Loss: 0.950 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.1181535720825195
Epoch: 18, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.906 Vali Acc: 0.667 Test Loss: 0.906 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.1303772926330566
Epoch: 19, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.875 Vali Acc: 0.706 Test Loss: 0.875 Test Acc: 0.706
Validation loss decreased (-0.672212 --> -0.705547).  Saving model ...
Epoch: 20 cost time: 3.215009927749634
Epoch: 20, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.852 Vali Acc: 0.700 Test Loss: 0.852 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2516024112701416
Epoch: 21, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.825 Vali Acc: 0.706 Test Loss: 0.825 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 22 cost time: 3.098865509033203
Epoch: 22, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.799 Vali Acc: 0.722 Test Loss: 0.799 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722214).  Saving model ...
Epoch: 23 cost time: 3.071781873703003
Epoch: 23, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.798 Vali Acc: 0.711 Test Loss: 0.798 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1082513332366943
Epoch: 24, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.778 Vali Acc: 0.728 Test Loss: 0.778 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727770).  Saving model ...
Epoch: 25 cost time: 3.3519248962402344
Epoch: 25, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.739 Vali Acc: 0.739 Test Loss: 0.739 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738881).  Saving model ...
Epoch: 26 cost time: 3.136914014816284
Epoch: 26, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.748 Vali Acc: 0.728 Test Loss: 0.748 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0979995727539062
Epoch: 27, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.737 Vali Acc: 0.733 Test Loss: 0.737 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.0806446075439453
Epoch: 28, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.728 Vali Acc: 0.722 Test Loss: 0.728 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.0700974464416504
Epoch: 29, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.719 Vali Acc: 0.722 Test Loss: 0.719 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.0632576942443848
Epoch: 30, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.712 Vali Acc: 0.733 Test Loss: 0.712 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 355839
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.477807283401489
Epoch: 1, Steps: 12 | Train Loss: 2.763 Vali Loss: 2.758 Vali Acc: 0.078 Test Loss: 2.758 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 2.6344218254089355
Epoch: 2, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.666 Vali Acc: 0.122 Test Loss: 2.666 Test Acc: 0.122
Validation loss decreased (-0.077750 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 2.5924830436706543
Epoch: 3, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.550 Vali Acc: 0.206 Test Loss: 2.550 Test Acc: 0.206
Validation loss decreased (-0.122196 --> -0.205530).  Saving model ...
Epoch: 4 cost time: 2.8249032497406006
Epoch: 4, Steps: 12 | Train Loss: 2.472 Vali Loss: 2.410 Vali Acc: 0.283 Test Loss: 2.410 Test Acc: 0.283
Validation loss decreased (-0.205530 --> -0.283309).  Saving model ...
Epoch: 5 cost time: 2.6345973014831543
Epoch: 5, Steps: 12 | Train Loss: 2.329 Vali Loss: 2.261 Vali Acc: 0.406 Test Loss: 2.261 Test Acc: 0.406
Validation loss decreased (-0.283309 --> -0.405533).  Saving model ...
Epoch: 6 cost time: 2.881988763809204
Epoch: 6, Steps: 12 | Train Loss: 2.161 Vali Loss: 2.100 Vali Acc: 0.461 Test Loss: 2.100 Test Acc: 0.461
Validation loss decreased (-0.405533 --> -0.461090).  Saving model ...
Epoch: 7 cost time: 2.6752352714538574
Epoch: 7, Steps: 12 | Train Loss: 1.965 Vali Loss: 1.955 Vali Acc: 0.517 Test Loss: 1.955 Test Acc: 0.517
Validation loss decreased (-0.461090 --> -0.516647).  Saving model ...
Epoch: 8 cost time: 2.5074009895324707
Epoch: 8, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.809 Vali Acc: 0.544 Test Loss: 1.809 Test Acc: 0.544
Validation loss decreased (-0.516647 --> -0.544426).  Saving model ...
Epoch: 9 cost time: 2.41249418258667
Epoch: 9, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.675 Vali Acc: 0.572 Test Loss: 1.675 Test Acc: 0.572
Validation loss decreased (-0.544426 --> -0.572205).  Saving model ...
Epoch: 10 cost time: 2.5712904930114746
Epoch: 10, Steps: 12 | Train Loss: 1.494 Vali Loss: 1.563 Vali Acc: 0.589 Test Loss: 1.563 Test Acc: 0.589
Validation loss decreased (-0.572205 --> -0.588873).  Saving model ...
Epoch: 11 cost time: 2.543891668319702
Epoch: 11, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.459 Vali Acc: 0.611 Test Loss: 1.459 Test Acc: 0.611
Validation loss decreased (-0.588873 --> -0.611097).  Saving model ...
Epoch: 12 cost time: 2.6437695026397705
Epoch: 12, Steps: 12 | Train Loss: 1.272 Vali Loss: 1.371 Vali Acc: 0.600 Test Loss: 1.371 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.523749828338623
Epoch: 13, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.295 Vali Acc: 0.617 Test Loss: 1.295 Test Acc: 0.617
Validation loss decreased (-0.611097 --> -0.616654).  Saving model ...
Epoch: 14 cost time: 2.5181782245635986
Epoch: 14, Steps: 12 | Train Loss: 1.018 Vali Loss: 1.229 Vali Acc: 0.622 Test Loss: 1.229 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 15 cost time: 2.504896640777588
Epoch: 15, Steps: 12 | Train Loss: 1.009 Vali Loss: 1.174 Vali Acc: 0.639 Test Loss: 1.174 Test Acc: 0.639
Validation loss decreased (-0.622210 --> -0.638877).  Saving model ...
Epoch: 16 cost time: 2.7014875411987305
Epoch: 16, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.123 Vali Acc: 0.656 Test Loss: 1.123 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655544).  Saving model ...
Epoch: 17 cost time: 2.597615957260132
Epoch: 17, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.075 Vali Acc: 0.683 Test Loss: 1.075 Test Acc: 0.683
Validation loss decreased (-0.655544 --> -0.683323).  Saving model ...
Epoch: 18 cost time: 2.555137872695923
Epoch: 18, Steps: 12 | Train Loss: 0.718 Vali Loss: 1.036 Vali Acc: 0.667 Test Loss: 1.036 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4880363941192627
Epoch: 19, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.993 Vali Acc: 0.672 Test Loss: 0.993 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.499190330505371
Epoch: 20, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.969 Vali Acc: 0.678 Test Loss: 0.969 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.405846357345581
Epoch: 21, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.946 Vali Acc: 0.667 Test Loss: 0.946 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5257999897003174
Epoch: 22, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.895 Vali Acc: 0.672 Test Loss: 0.895 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6848554611206055
Epoch: 23, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.882 Vali Acc: 0.672 Test Loss: 0.882 Test Acc: 0.672
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.575827121734619
Epoch: 24, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.847 Vali Acc: 0.700 Test Loss: 0.847 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699992).  Saving model ...
Epoch: 25 cost time: 2.422619581222534
Epoch: 25, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.829 Vali Acc: 0.722 Test Loss: 0.829 Test Acc: 0.722
Validation loss decreased (-0.699992 --> -0.722214).  Saving model ...
Epoch: 26 cost time: 2.7296621799468994
Epoch: 26, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.825 Vali Acc: 0.722 Test Loss: 0.825 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 27 cost time: 2.5864012241363525
Epoch: 27, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.771 Vali Acc: 0.722 Test Loss: 0.771 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722215).  Saving model ...
Epoch: 28 cost time: 2.746441602706909
Epoch: 28, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.766 Vali Acc: 0.733 Test Loss: 0.766 Test Acc: 0.733
Validation loss decreased (-0.722215 --> -0.733326).  Saving model ...
Epoch: 29 cost time: 2.629612445831299
Epoch: 29, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.769 Vali Acc: 0.706 Test Loss: 0.769 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.7934892177581787
Epoch: 30, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.743 Vali Acc: 0.744 Test Loss: 0.743 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744437).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 1183615
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3935492038726807
Epoch: 1, Steps: 12 | Train Loss: 2.733 Vali Loss: 2.741 Vali Acc: 0.056 Test Loss: 2.741 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 2.5230743885040283
Epoch: 2, Steps: 12 | Train Loss: 2.673 Vali Loss: 2.659 Vali Acc: 0.061 Test Loss: 2.659 Test Acc: 0.061
Validation loss decreased (-0.055528 --> -0.061085).  Saving model ...
Epoch: 3 cost time: 2.3122520446777344
Epoch: 3, Steps: 12 | Train Loss: 2.582 Vali Loss: 2.552 Vali Acc: 0.183 Test Loss: 2.552 Test Acc: 0.183
Validation loss decreased (-0.061085 --> -0.183308).  Saving model ...
Epoch: 4 cost time: 2.5212185382843018
Epoch: 4, Steps: 12 | Train Loss: 2.448 Vali Loss: 2.434 Vali Acc: 0.317 Test Loss: 2.434 Test Acc: 0.317
Validation loss decreased (-0.183308 --> -0.316642).  Saving model ...
Epoch: 5 cost time: 2.491266965866089
Epoch: 5, Steps: 12 | Train Loss: 2.340 Vali Loss: 2.308 Vali Acc: 0.400 Test Loss: 2.308 Test Acc: 0.400
Validation loss decreased (-0.316642 --> -0.399977).  Saving model ...
Epoch: 6 cost time: 2.332280158996582
Epoch: 6, Steps: 12 | Train Loss: 2.196 Vali Loss: 2.177 Vali Acc: 0.478 Test Loss: 2.177 Test Acc: 0.478
Validation loss decreased (-0.399977 --> -0.477756).  Saving model ...
Epoch: 7 cost time: 2.3068597316741943
Epoch: 7, Steps: 12 | Train Loss: 1.996 Vali Loss: 2.035 Vali Acc: 0.528 Test Loss: 2.035 Test Acc: 0.528
Validation loss decreased (-0.477756 --> -0.527757).  Saving model ...
Epoch: 8 cost time: 2.270184278488159
Epoch: 8, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.897 Vali Acc: 0.544 Test Loss: 1.897 Test Acc: 0.544
Validation loss decreased (-0.527757 --> -0.544425).  Saving model ...
Epoch: 9 cost time: 2.337221384048462
Epoch: 9, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.770 Vali Acc: 0.561 Test Loss: 1.770 Test Acc: 0.561
Validation loss decreased (-0.544425 --> -0.561093).  Saving model ...
Epoch: 10 cost time: 2.209620952606201
Epoch: 10, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.652 Vali Acc: 0.567 Test Loss: 1.652 Test Acc: 0.567
Validation loss decreased (-0.561093 --> -0.566650).  Saving model ...
Epoch: 11 cost time: 2.1480329036712646
Epoch: 11, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.555 Vali Acc: 0.550 Test Loss: 1.555 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3644979000091553
Epoch: 12, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.460 Vali Acc: 0.594 Test Loss: 1.460 Test Acc: 0.594
Validation loss decreased (-0.566650 --> -0.594430).  Saving model ...
Epoch: 13 cost time: 2.3994646072387695
Epoch: 13, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.375 Vali Acc: 0.600 Test Loss: 1.375 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599986).  Saving model ...
Epoch: 14 cost time: 2.398432970046997
Epoch: 14, Steps: 12 | Train Loss: 1.119 Vali Loss: 1.310 Vali Acc: 0.628 Test Loss: 1.310 Test Acc: 0.628
Validation loss decreased (-0.599986 --> -0.627765).  Saving model ...
Epoch: 15 cost time: 2.3485379219055176
Epoch: 15, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.242 Vali Acc: 0.628 Test Loss: 1.242 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627765).  Saving model ...
Epoch: 16 cost time: 2.2963507175445557
Epoch: 16, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.182 Vali Acc: 0.650 Test Loss: 1.182 Test Acc: 0.650
Validation loss decreased (-0.627765 --> -0.649988).  Saving model ...
Epoch: 17 cost time: 2.3380227088928223
Epoch: 17, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.150 Vali Acc: 0.617 Test Loss: 1.150 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2928624153137207
Epoch: 18, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.100 Vali Acc: 0.633 Test Loss: 1.100 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1861488819122314
Epoch: 19, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.066 Vali Acc: 0.650 Test Loss: 1.066 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 2.2109851837158203
Epoch: 20, Steps: 12 | Train Loss: 0.747 Vali Loss: 1.035 Vali Acc: 0.644 Test Loss: 1.035 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.218339443206787
Epoch: 21, Steps: 12 | Train Loss: 0.697 Vali Loss: 1.014 Vali Acc: 0.672 Test Loss: 1.014 Test Acc: 0.672
Validation loss decreased (-0.649989 --> -0.672212).  Saving model ...
Epoch: 22 cost time: 2.136533737182617
Epoch: 22, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.999 Vali Acc: 0.661 Test Loss: 0.999 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.172985792160034
Epoch: 23, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.989 Vali Acc: 0.667 Test Loss: 0.989 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.4903388023376465
Epoch: 24, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.952 Vali Acc: 0.689 Test Loss: 0.952 Test Acc: 0.689
Validation loss decreased (-0.672212 --> -0.688879).  Saving model ...
Epoch: 25 cost time: 2.406165838241577
Epoch: 25, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.934 Vali Acc: 0.700 Test Loss: 0.934 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699991).  Saving model ...
Epoch: 26 cost time: 2.2586023807525635
Epoch: 26, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.926 Vali Acc: 0.711 Test Loss: 0.926 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711102).  Saving model ...
Epoch: 27 cost time: 2.400813102722168
Epoch: 27, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.900 Vali Acc: 0.717 Test Loss: 0.900 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 28 cost time: 2.4965219497680664
Epoch: 28, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.907 Vali Acc: 0.706 Test Loss: 0.907 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.350084066390991
Epoch: 29, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.910 Vali Acc: 0.728 Test Loss: 0.910 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727769).  Saving model ...
Epoch: 30 cost time: 2.3855369091033936
Epoch: 30, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.895 Vali Acc: 0.739 Test Loss: 0.895 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738880).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 355839
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.9940924644470215
Epoch: 1, Steps: 12 | Train Loss: 2.814 Vali Loss: 2.786 Vali Acc: 0.033 Test Loss: 2.786 Test Acc: 0.033
Validation loss decreased (inf --> -0.033305).  Saving model ...
Epoch: 2 cost time: 3.8776838779449463
Epoch: 2, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.697 Vali Acc: 0.061 Test Loss: 2.697 Test Acc: 0.061
Validation loss decreased (-0.033305 --> -0.061084).  Saving model ...
Epoch: 3 cost time: 3.8610708713531494
Epoch: 3, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.580 Vali Acc: 0.128 Test Loss: 2.580 Test Acc: 0.128
Validation loss decreased (-0.061084 --> -0.127752).  Saving model ...
Epoch: 4 cost time: 3.907869577407837
Epoch: 4, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.450 Vali Acc: 0.228 Test Loss: 2.450 Test Acc: 0.228
Validation loss decreased (-0.127752 --> -0.227753).  Saving model ...
Epoch: 5 cost time: 4.098744630813599
Epoch: 5, Steps: 12 | Train Loss: 2.343 Vali Loss: 2.308 Vali Acc: 0.344 Test Loss: 2.308 Test Acc: 0.344
Validation loss decreased (-0.227753 --> -0.344421).  Saving model ...
Epoch: 6 cost time: 3.892545700073242
Epoch: 6, Steps: 12 | Train Loss: 2.160 Vali Loss: 2.147 Vali Acc: 0.428 Test Loss: 2.147 Test Acc: 0.428
Validation loss decreased (-0.344421 --> -0.427756).  Saving model ...
Epoch: 7 cost time: 3.7182042598724365
Epoch: 7, Steps: 12 | Train Loss: 1.998 Vali Loss: 1.986 Vali Acc: 0.472 Test Loss: 1.986 Test Acc: 0.472
Validation loss decreased (-0.427756 --> -0.472202).  Saving model ...
Epoch: 8 cost time: 3.9797260761260986
Epoch: 8, Steps: 12 | Train Loss: 1.779 Vali Loss: 1.822 Vali Acc: 0.533 Test Loss: 1.822 Test Acc: 0.533
Validation loss decreased (-0.472202 --> -0.533315).  Saving model ...
Epoch: 9 cost time: 3.9422566890716553
Epoch: 9, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.663 Vali Acc: 0.561 Test Loss: 1.663 Test Acc: 0.561
Validation loss decreased (-0.533315 --> -0.561094).  Saving model ...
Epoch: 10 cost time: 3.779047966003418
Epoch: 10, Steps: 12 | Train Loss: 1.461 Vali Loss: 1.512 Vali Acc: 0.556 Test Loss: 1.512 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6673226356506348
Epoch: 11, Steps: 12 | Train Loss: 1.244 Vali Loss: 1.388 Vali Acc: 0.600 Test Loss: 1.388 Test Acc: 0.600
Validation loss decreased (-0.561094 --> -0.599986).  Saving model ...
Epoch: 12 cost time: 3.8382222652435303
Epoch: 12, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.296 Vali Acc: 0.617 Test Loss: 1.296 Test Acc: 0.617
Validation loss decreased (-0.599986 --> -0.616654).  Saving model ...
Epoch: 13 cost time: 4.073034286499023
Epoch: 13, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.218 Vali Acc: 0.622 Test Loss: 1.218 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 14 cost time: 3.6630682945251465
Epoch: 14, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.145 Vali Acc: 0.617 Test Loss: 1.145 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9830455780029297
Epoch: 15, Steps: 12 | Train Loss: 0.870 Vali Loss: 1.077 Vali Acc: 0.639 Test Loss: 1.077 Test Acc: 0.639
Validation loss decreased (-0.622210 --> -0.638878).  Saving model ...
Epoch: 16 cost time: 3.916982412338257
Epoch: 16, Steps: 12 | Train Loss: 0.796 Vali Loss: 1.018 Vali Acc: 0.650 Test Loss: 1.018 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649990).  Saving model ...
Epoch: 17 cost time: 3.924259662628174
Epoch: 17, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.977 Vali Acc: 0.656 Test Loss: 0.977 Test Acc: 0.656
Validation loss decreased (-0.649990 --> -0.655546).  Saving model ...
Epoch: 18 cost time: 3.8556408882141113
Epoch: 18, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.939 Vali Acc: 0.694 Test Loss: 0.939 Test Acc: 0.694
Validation loss decreased (-0.655546 --> -0.694435).  Saving model ...
Epoch: 19 cost time: 3.9094057083129883
Epoch: 19, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.898 Vali Acc: 0.694 Test Loss: 0.898 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 20 cost time: 4.199399471282959
Epoch: 20, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.859 Vali Acc: 0.700 Test Loss: 0.859 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 21 cost time: 3.936642646789551
Epoch: 21, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.828 Vali Acc: 0.717 Test Loss: 0.828 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716658).  Saving model ...
Epoch: 22 cost time: 3.8722429275512695
Epoch: 22, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.803 Vali Acc: 0.722 Test Loss: 0.803 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722214).  Saving model ...
Epoch: 23 cost time: 3.828907012939453
Epoch: 23, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.770 Vali Acc: 0.739 Test Loss: 0.770 Test Acc: 0.739
Validation loss decreased (-0.722214 --> -0.738881).  Saving model ...
Epoch: 24 cost time: 3.9510934352874756
Epoch: 24, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.747 Vali Acc: 0.722 Test Loss: 0.747 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.106122016906738
Epoch: 25, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.737 Vali Acc: 0.739 Test Loss: 0.737 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738882).  Saving model ...
Epoch: 26 cost time: 3.831125497817993
Epoch: 26, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.709 Vali Acc: 0.744 Test Loss: 0.709 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744437).  Saving model ...
Epoch: 27 cost time: 4.045102119445801
Epoch: 27, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.700 Vali Acc: 0.756 Test Loss: 0.700 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755549).  Saving model ...
Epoch: 28 cost time: 4.0257673263549805
Epoch: 28, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.679 Vali Acc: 0.772 Test Loss: 0.679 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772215).  Saving model ...
Epoch: 29 cost time: 4.02829909324646
Epoch: 29, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.685 Vali Acc: 0.756 Test Loss: 0.685 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.862157106399536
Epoch: 30, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.662 Vali Acc: 0.767 Test Loss: 0.662 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 597503
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.057790756225586
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.792 Vali Acc: 0.072 Test Loss: 2.792 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 3.0562891960144043
Epoch: 2, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.697 Vali Acc: 0.144 Test Loss: 2.697 Test Acc: 0.144
Validation loss decreased (-0.072194 --> -0.144417).  Saving model ...
Epoch: 3 cost time: 3.15093994140625
Epoch: 3, Steps: 12 | Train Loss: 2.549 Vali Loss: 2.573 Vali Acc: 0.156 Test Loss: 2.573 Test Acc: 0.156
Validation loss decreased (-0.144417 --> -0.155530).  Saving model ...
Epoch: 4 cost time: 3.1018526554107666
Epoch: 4, Steps: 12 | Train Loss: 2.456 Vali Loss: 2.437 Vali Acc: 0.233 Test Loss: 2.437 Test Acc: 0.233
Validation loss decreased (-0.155530 --> -0.233309).  Saving model ...
Epoch: 5 cost time: 3.236719846725464
Epoch: 5, Steps: 12 | Train Loss: 2.298 Vali Loss: 2.292 Vali Acc: 0.361 Test Loss: 2.292 Test Acc: 0.361
Validation loss decreased (-0.233309 --> -0.361088).  Saving model ...
Epoch: 6 cost time: 3.0296034812927246
Epoch: 6, Steps: 12 | Train Loss: 2.132 Vali Loss: 2.142 Vali Acc: 0.489 Test Loss: 2.142 Test Acc: 0.489
Validation loss decreased (-0.361088 --> -0.488867).  Saving model ...
Epoch: 7 cost time: 3.0020737648010254
Epoch: 7, Steps: 12 | Train Loss: 1.935 Vali Loss: 1.995 Vali Acc: 0.494 Test Loss: 1.995 Test Acc: 0.494
Validation loss decreased (-0.488867 --> -0.494424).  Saving model ...
Epoch: 8 cost time: 3.0745744705200195
Epoch: 8, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.850 Vali Acc: 0.528 Test Loss: 1.850 Test Acc: 0.528
Validation loss decreased (-0.494424 --> -0.527759).  Saving model ...
Epoch: 9 cost time: 3.090181827545166
Epoch: 9, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.723 Vali Acc: 0.539 Test Loss: 1.723 Test Acc: 0.539
Validation loss decreased (-0.527759 --> -0.538872).  Saving model ...
Epoch: 10 cost time: 3.064053773880005
Epoch: 10, Steps: 12 | Train Loss: 1.488 Vali Loss: 1.596 Vali Acc: 0.567 Test Loss: 1.596 Test Acc: 0.567
Validation loss decreased (-0.538872 --> -0.566651).  Saving model ...
Epoch: 11 cost time: 3.0525379180908203
Epoch: 11, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.490 Vali Acc: 0.572 Test Loss: 1.490 Test Acc: 0.572
Validation loss decreased (-0.566651 --> -0.572207).  Saving model ...
Epoch: 12 cost time: 2.887908458709717
Epoch: 12, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.403 Vali Acc: 0.572 Test Loss: 1.403 Test Acc: 0.572
Validation loss decreased (-0.572207 --> -0.572208).  Saving model ...
Epoch: 13 cost time: 3.0129032135009766
Epoch: 13, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.318 Vali Acc: 0.600 Test Loss: 1.318 Test Acc: 0.600
Validation loss decreased (-0.572208 --> -0.599987).  Saving model ...
Epoch: 14 cost time: 3.087707757949829
Epoch: 14, Steps: 12 | Train Loss: 1.047 Vali Loss: 1.241 Vali Acc: 0.611 Test Loss: 1.241 Test Acc: 0.611
Validation loss decreased (-0.599987 --> -0.611099).  Saving model ...
Epoch: 15 cost time: 2.956637144088745
Epoch: 15, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.167 Vali Acc: 0.628 Test Loss: 1.167 Test Acc: 0.628
Validation loss decreased (-0.611099 --> -0.627766).  Saving model ...
Epoch: 16 cost time: 3.0114474296569824
Epoch: 16, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.112 Vali Acc: 0.628 Test Loss: 1.112 Test Acc: 0.628
Validation loss decreased (-0.627766 --> -0.627767).  Saving model ...
Epoch: 17 cost time: 2.966886043548584
Epoch: 17, Steps: 12 | Train Loss: 0.809 Vali Loss: 1.067 Vali Acc: 0.633 Test Loss: 1.067 Test Acc: 0.633
Validation loss decreased (-0.627767 --> -0.633323).  Saving model ...
Epoch: 18 cost time: 3.0349326133728027
Epoch: 18, Steps: 12 | Train Loss: 0.709 Vali Loss: 1.004 Vali Acc: 0.667 Test Loss: 1.004 Test Acc: 0.667
Validation loss decreased (-0.633323 --> -0.666657).  Saving model ...
Epoch: 19 cost time: 3.1809096336364746
Epoch: 19, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.955 Vali Acc: 0.672 Test Loss: 0.955 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672213).  Saving model ...
Epoch: 20 cost time: 2.9129788875579834
Epoch: 20, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.908 Vali Acc: 0.694 Test Loss: 0.908 Test Acc: 0.694
Validation loss decreased (-0.672213 --> -0.694435).  Saving model ...
Epoch: 21 cost time: 3.0685479640960693
Epoch: 21, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.875 Vali Acc: 0.700 Test Loss: 0.875 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 22 cost time: 3.025200366973877
Epoch: 22, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.845 Vali Acc: 0.717 Test Loss: 0.845 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716658).  Saving model ...
Epoch: 23 cost time: 3.1091561317443848
Epoch: 23, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.813 Vali Acc: 0.717 Test Loss: 0.813 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716659).  Saving model ...
Epoch: 24 cost time: 3.0368385314941406
Epoch: 24, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.793 Vali Acc: 0.717 Test Loss: 0.793 Test Acc: 0.717
Validation loss decreased (-0.716659 --> -0.716659).  Saving model ...
Epoch: 25 cost time: 2.936289072036743
Epoch: 25, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.774 Vali Acc: 0.717 Test Loss: 0.774 Test Acc: 0.717
Validation loss decreased (-0.716659 --> -0.716659).  Saving model ...
Epoch: 26 cost time: 2.935910224914551
Epoch: 26, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.755 Vali Acc: 0.717 Test Loss: 0.755 Test Acc: 0.717
Validation loss decreased (-0.716659 --> -0.716659).  Saving model ...
Epoch: 27 cost time: 3.2797834873199463
Epoch: 27, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.731 Vali Acc: 0.728 Test Loss: 0.731 Test Acc: 0.728
Validation loss decreased (-0.716659 --> -0.727770).  Saving model ...
Epoch: 28 cost time: 3.116304874420166
Epoch: 28, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.712 Vali Acc: 0.750 Test Loss: 0.712 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749993).  Saving model ...
Epoch: 29 cost time: 3.2419700622558594
Epoch: 29, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.704 Vali Acc: 0.767 Test Loss: 0.704 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
Epoch: 30 cost time: 3.0770387649536133
Epoch: 30, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.690 Vali Acc: 0.750 Test Loss: 0.690 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 183551
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.811525106430054
Epoch: 1, Steps: 12 | Train Loss: 2.814 Vali Loss: 2.785 Vali Acc: 0.033 Test Loss: 2.785 Test Acc: 0.033
Validation loss decreased (inf --> -0.033305).  Saving model ...
Epoch: 2 cost time: 3.1534805297851562
Epoch: 2, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.696 Vali Acc: 0.061 Test Loss: 2.696 Test Acc: 0.061
Validation loss decreased (-0.033305 --> -0.061084).  Saving model ...
Epoch: 3 cost time: 3.142719030380249
Epoch: 3, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.580 Vali Acc: 0.128 Test Loss: 2.580 Test Acc: 0.128
Validation loss decreased (-0.061084 --> -0.127752).  Saving model ...
Epoch: 4 cost time: 3.3807828426361084
Epoch: 4, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.450 Vali Acc: 0.222 Test Loss: 2.450 Test Acc: 0.222
Validation loss decreased (-0.127752 --> -0.222198).  Saving model ...
Epoch: 5 cost time: 3.218341112136841
Epoch: 5, Steps: 12 | Train Loss: 2.343 Vali Loss: 2.309 Vali Acc: 0.344 Test Loss: 2.309 Test Acc: 0.344
Validation loss decreased (-0.222198 --> -0.344421).  Saving model ...
Epoch: 6 cost time: 3.258922815322876
Epoch: 6, Steps: 12 | Train Loss: 2.160 Vali Loss: 2.148 Vali Acc: 0.422 Test Loss: 2.148 Test Acc: 0.422
Validation loss decreased (-0.344421 --> -0.422201).  Saving model ...
Epoch: 7 cost time: 3.1649467945098877
Epoch: 7, Steps: 12 | Train Loss: 1.998 Vali Loss: 1.989 Vali Acc: 0.472 Test Loss: 1.989 Test Acc: 0.472
Validation loss decreased (-0.422201 --> -0.472202).  Saving model ...
Epoch: 8 cost time: 3.4678077697753906
Epoch: 8, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.825 Vali Acc: 0.539 Test Loss: 1.825 Test Acc: 0.539
Validation loss decreased (-0.472202 --> -0.538871).  Saving model ...
Epoch: 9 cost time: 3.202723503112793
Epoch: 9, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.667 Vali Acc: 0.561 Test Loss: 1.667 Test Acc: 0.561
Validation loss decreased (-0.538871 --> -0.561094).  Saving model ...
Epoch: 10 cost time: 3.2125234603881836
Epoch: 10, Steps: 12 | Train Loss: 1.466 Vali Loss: 1.517 Vali Acc: 0.561 Test Loss: 1.517 Test Acc: 0.561
Validation loss decreased (-0.561094 --> -0.561096).  Saving model ...
Epoch: 11 cost time: 3.0563416481018066
Epoch: 11, Steps: 12 | Train Loss: 1.244 Vali Loss: 1.394 Vali Acc: 0.600 Test Loss: 1.394 Test Acc: 0.600
Validation loss decreased (-0.561096 --> -0.599986).  Saving model ...
Epoch: 12 cost time: 3.3302741050720215
Epoch: 12, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.302 Vali Acc: 0.600 Test Loss: 1.302 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 13 cost time: 3.268284797668457
Epoch: 13, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.224 Vali Acc: 0.611 Test Loss: 1.224 Test Acc: 0.611
Validation loss decreased (-0.599987 --> -0.611099).  Saving model ...
Epoch: 14 cost time: 3.1324470043182373
Epoch: 14, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.153 Vali Acc: 0.617 Test Loss: 1.153 Test Acc: 0.617
Validation loss decreased (-0.611099 --> -0.616655).  Saving model ...
Epoch: 15 cost time: 3.0848288536071777
Epoch: 15, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.085 Vali Acc: 0.639 Test Loss: 1.085 Test Acc: 0.639
Validation loss decreased (-0.616655 --> -0.638878).  Saving model ...
Epoch: 16 cost time: 3.1662139892578125
Epoch: 16, Steps: 12 | Train Loss: 0.799 Vali Loss: 1.026 Vali Acc: 0.650 Test Loss: 1.026 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649990).  Saving model ...
Epoch: 17 cost time: 3.206068277359009
Epoch: 17, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.984 Vali Acc: 0.656 Test Loss: 0.984 Test Acc: 0.656
Validation loss decreased (-0.649990 --> -0.655546).  Saving model ...
Epoch: 18 cost time: 3.130054473876953
Epoch: 18, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.933 Vali Acc: 0.683 Test Loss: 0.933 Test Acc: 0.683
Validation loss decreased (-0.655546 --> -0.683324).  Saving model ...
Epoch: 19 cost time: 3.22733473777771
Epoch: 19, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.891 Vali Acc: 0.683 Test Loss: 0.891 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683324).  Saving model ...
Epoch: 20 cost time: 3.2412285804748535
Epoch: 20, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.852 Vali Acc: 0.700 Test Loss: 0.852 Test Acc: 0.700
Validation loss decreased (-0.683324 --> -0.699991).  Saving model ...
Epoch: 21 cost time: 3.4126975536346436
Epoch: 21, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.827 Vali Acc: 0.717 Test Loss: 0.827 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716658).  Saving model ...
Epoch: 22 cost time: 3.0121264457702637
Epoch: 22, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.797 Vali Acc: 0.722 Test Loss: 0.797 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722214).  Saving model ...
Epoch: 23 cost time: 3.190931558609009
Epoch: 23, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.761 Vali Acc: 0.739 Test Loss: 0.761 Test Acc: 0.739
Validation loss decreased (-0.722214 --> -0.738881).  Saving model ...
Epoch: 24 cost time: 3.1133642196655273
Epoch: 24, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.741 Vali Acc: 0.717 Test Loss: 0.741 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.143615245819092
Epoch: 25, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.727 Vali Acc: 0.728 Test Loss: 0.727 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.0158894062042236
Epoch: 26, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.704 Vali Acc: 0.722 Test Loss: 0.704 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.244750738143921
Epoch: 27, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.696 Vali Acc: 0.722 Test Loss: 0.696 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.2991747856140137
Epoch: 28, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.676 Vali Acc: 0.756 Test Loss: 0.676 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755549).  Saving model ...
Epoch: 29 cost time: 3.115239143371582
Epoch: 29, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.678 Vali Acc: 0.744 Test Loss: 0.678 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.2432074546813965
Epoch: 30, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.649 Vali Acc: 0.767 Test Loss: 0.649 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 597503
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.20883584022522
Epoch: 1, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.791 Vali Acc: 0.072 Test Loss: 2.791 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 2.7087044715881348
Epoch: 2, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.696 Vali Acc: 0.144 Test Loss: 2.696 Test Acc: 0.144
Validation loss decreased (-0.072194 --> -0.144417).  Saving model ...
Epoch: 3 cost time: 2.7125601768493652
Epoch: 3, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.571 Vali Acc: 0.161 Test Loss: 2.571 Test Acc: 0.161
Validation loss decreased (-0.144417 --> -0.161085).  Saving model ...
Epoch: 4 cost time: 2.9113941192626953
Epoch: 4, Steps: 12 | Train Loss: 2.456 Vali Loss: 2.435 Vali Acc: 0.233 Test Loss: 2.435 Test Acc: 0.233
Validation loss decreased (-0.161085 --> -0.233309).  Saving model ...
Epoch: 5 cost time: 2.7365145683288574
Epoch: 5, Steps: 12 | Train Loss: 2.297 Vali Loss: 2.290 Vali Acc: 0.372 Test Loss: 2.290 Test Acc: 0.372
Validation loss decreased (-0.233309 --> -0.372199).  Saving model ...
Epoch: 6 cost time: 2.8303308486938477
Epoch: 6, Steps: 12 | Train Loss: 2.132 Vali Loss: 2.140 Vali Acc: 0.489 Test Loss: 2.140 Test Acc: 0.489
Validation loss decreased (-0.372199 --> -0.488867).  Saving model ...
Epoch: 7 cost time: 2.6938281059265137
Epoch: 7, Steps: 12 | Train Loss: 1.933 Vali Loss: 1.992 Vali Acc: 0.494 Test Loss: 1.992 Test Acc: 0.494
Validation loss decreased (-0.488867 --> -0.494425).  Saving model ...
Epoch: 8 cost time: 2.8759191036224365
Epoch: 8, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.847 Vali Acc: 0.528 Test Loss: 1.847 Test Acc: 0.528
Validation loss decreased (-0.494425 --> -0.527759).  Saving model ...
Epoch: 9 cost time: 2.6499905586242676
Epoch: 9, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.720 Vali Acc: 0.539 Test Loss: 1.720 Test Acc: 0.539
Validation loss decreased (-0.527759 --> -0.538872).  Saving model ...
Epoch: 10 cost time: 2.735506296157837
Epoch: 10, Steps: 12 | Train Loss: 1.488 Vali Loss: 1.593 Vali Acc: 0.572 Test Loss: 1.593 Test Acc: 0.572
Validation loss decreased (-0.538872 --> -0.572206).  Saving model ...
Epoch: 11 cost time: 2.7975847721099854
Epoch: 11, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.488 Vali Acc: 0.578 Test Loss: 1.488 Test Acc: 0.578
Validation loss decreased (-0.572206 --> -0.577763).  Saving model ...
Epoch: 12 cost time: 2.8483569622039795
Epoch: 12, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.401 Vali Acc: 0.572 Test Loss: 1.401 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.654418468475342
Epoch: 13, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.315 Vali Acc: 0.606 Test Loss: 1.315 Test Acc: 0.606
Validation loss decreased (-0.577763 --> -0.605542).  Saving model ...
Epoch: 14 cost time: 2.73931622505188
Epoch: 14, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.237 Vali Acc: 0.617 Test Loss: 1.237 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616654).  Saving model ...
Epoch: 15 cost time: 2.7427830696105957
Epoch: 15, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.164 Vali Acc: 0.633 Test Loss: 1.164 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633322).  Saving model ...
Epoch: 16 cost time: 2.9452712535858154
Epoch: 16, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.109 Vali Acc: 0.633 Test Loss: 1.109 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 17 cost time: 2.6028199195861816
Epoch: 17, Steps: 12 | Train Loss: 0.812 Vali Loss: 1.066 Vali Acc: 0.639 Test Loss: 1.066 Test Acc: 0.639
Validation loss decreased (-0.633322 --> -0.638878).  Saving model ...
Epoch: 18 cost time: 2.6877260208129883
Epoch: 18, Steps: 12 | Train Loss: 0.712 Vali Loss: 1.002 Vali Acc: 0.672 Test Loss: 1.002 Test Acc: 0.672
Validation loss decreased (-0.638878 --> -0.672212).  Saving model ...
Epoch: 19 cost time: 2.782230854034424
Epoch: 19, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.955 Vali Acc: 0.672 Test Loss: 0.955 Test Acc: 0.672
Validation loss decreased (-0.672212 --> -0.672213).  Saving model ...
Epoch: 20 cost time: 2.902925729751587
Epoch: 20, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.910 Vali Acc: 0.689 Test Loss: 0.910 Test Acc: 0.689
Validation loss decreased (-0.672213 --> -0.688880).  Saving model ...
Epoch: 21 cost time: 2.674269437789917
Epoch: 21, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.879 Vali Acc: 0.694 Test Loss: 0.879 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694436).  Saving model ...
Epoch: 22 cost time: 2.755934715270996
Epoch: 22, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.848 Vali Acc: 0.706 Test Loss: 0.848 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705547).  Saving model ...
Epoch: 23 cost time: 2.7858474254608154
Epoch: 23, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.817 Vali Acc: 0.706 Test Loss: 0.817 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 24 cost time: 2.875213146209717
Epoch: 24, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.797 Vali Acc: 0.722 Test Loss: 0.797 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722214).  Saving model ...
Epoch: 25 cost time: 2.715223550796509
Epoch: 25, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.772 Vali Acc: 0.706 Test Loss: 0.772 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.766679525375366
Epoch: 26, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.750 Vali Acc: 0.722 Test Loss: 0.750 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722215).  Saving model ...
Epoch: 27 cost time: 2.714956521987915
Epoch: 27, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.732 Vali Acc: 0.711 Test Loss: 0.732 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.6347274780273438
Epoch: 28, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.716 Vali Acc: 0.733 Test Loss: 0.716 Test Acc: 0.733
Validation loss decreased (-0.722215 --> -0.733326).  Saving model ...
Epoch: 29 cost time: 2.4949233531951904
Epoch: 29, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.705 Vali Acc: 0.761 Test Loss: 0.705 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761104).  Saving model ...
Epoch: 30 cost time: 2.857980728149414
Epoch: 30, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.688 Vali Acc: 0.739 Test Loss: 0.688 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 183551
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.10857367515564
Epoch: 1, Steps: 12 | Train Loss: 2.817 Vali Loss: 2.791 Vali Acc: 0.033 Test Loss: 2.791 Test Acc: 0.033
Validation loss decreased (inf --> -0.033305).  Saving model ...
Epoch: 2 cost time: 2.44720721244812
Epoch: 2, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.712 Vali Acc: 0.061 Test Loss: 2.712 Test Acc: 0.061
Validation loss decreased (-0.033305 --> -0.061084).  Saving model ...
Epoch: 3 cost time: 2.3814868927001953
Epoch: 3, Steps: 12 | Train Loss: 2.675 Vali Loss: 2.613 Vali Acc: 0.106 Test Loss: 2.613 Test Acc: 0.106
Validation loss decreased (-0.061084 --> -0.105529).  Saving model ...
Epoch: 4 cost time: 2.5851194858551025
Epoch: 4, Steps: 12 | Train Loss: 2.545 Vali Loss: 2.505 Vali Acc: 0.178 Test Loss: 2.505 Test Acc: 0.178
Validation loss decreased (-0.105529 --> -0.177753).  Saving model ...
Epoch: 5 cost time: 2.611924171447754
Epoch: 5, Steps: 12 | Train Loss: 2.423 Vali Loss: 2.389 Vali Acc: 0.272 Test Loss: 2.389 Test Acc: 0.272
Validation loss decreased (-0.177753 --> -0.272198).  Saving model ...
Epoch: 6 cost time: 2.350822925567627
Epoch: 6, Steps: 12 | Train Loss: 2.288 Vali Loss: 2.266 Vali Acc: 0.367 Test Loss: 2.266 Test Acc: 0.367
Validation loss decreased (-0.272198 --> -0.366644).  Saving model ...
Epoch: 7 cost time: 2.249706268310547
Epoch: 7, Steps: 12 | Train Loss: 2.149 Vali Loss: 2.152 Vali Acc: 0.417 Test Loss: 2.152 Test Acc: 0.417
Validation loss decreased (-0.366644 --> -0.416645).  Saving model ...
Epoch: 8 cost time: 2.3816137313842773
Epoch: 8, Steps: 12 | Train Loss: 1.993 Vali Loss: 2.036 Vali Acc: 0.439 Test Loss: 2.036 Test Acc: 0.439
Validation loss decreased (-0.416645 --> -0.438869).  Saving model ...
Epoch: 9 cost time: 2.3951902389526367
Epoch: 9, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.922 Vali Acc: 0.483 Test Loss: 1.922 Test Acc: 0.483
Validation loss decreased (-0.438869 --> -0.483314).  Saving model ...
Epoch: 10 cost time: 2.259324550628662
Epoch: 10, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.800 Vali Acc: 0.494 Test Loss: 1.800 Test Acc: 0.494
Validation loss decreased (-0.483314 --> -0.494426).  Saving model ...
Epoch: 11 cost time: 2.3832759857177734
Epoch: 11, Steps: 12 | Train Loss: 1.551 Vali Loss: 1.690 Vali Acc: 0.511 Test Loss: 1.690 Test Acc: 0.511
Validation loss decreased (-0.494426 --> -0.511094).  Saving model ...
Epoch: 12 cost time: 2.3424978256225586
Epoch: 12, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.599 Vali Acc: 0.517 Test Loss: 1.599 Test Acc: 0.517
Validation loss decreased (-0.511094 --> -0.516651).  Saving model ...
Epoch: 13 cost time: 2.37387752532959
Epoch: 13, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.517 Vali Acc: 0.539 Test Loss: 1.517 Test Acc: 0.539
Validation loss decreased (-0.516651 --> -0.538874).  Saving model ...
Epoch: 14 cost time: 2.514195442199707
Epoch: 14, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.430 Vali Acc: 0.533 Test Loss: 1.430 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3084752559661865
Epoch: 15, Steps: 12 | Train Loss: 1.121 Vali Loss: 1.343 Vali Acc: 0.550 Test Loss: 1.343 Test Acc: 0.550
Validation loss decreased (-0.538874 --> -0.549987).  Saving model ...
Epoch: 16 cost time: 2.3179357051849365
Epoch: 16, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.266 Vali Acc: 0.600 Test Loss: 1.266 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599987).  Saving model ...
Epoch: 17 cost time: 2.3692331314086914
Epoch: 17, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.212 Vali Acc: 0.594 Test Loss: 1.212 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4591619968414307
Epoch: 18, Steps: 12 | Train Loss: 0.862 Vali Loss: 1.164 Vali Acc: 0.589 Test Loss: 1.164 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.466325044631958
Epoch: 19, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.125 Vali Acc: 0.622 Test Loss: 1.125 Test Acc: 0.622
Validation loss decreased (-0.599987 --> -0.622211).  Saving model ...
Epoch: 20 cost time: 2.246696710586548
Epoch: 20, Steps: 12 | Train Loss: 0.796 Vali Loss: 1.074 Vali Acc: 0.628 Test Loss: 1.074 Test Acc: 0.628
Validation loss decreased (-0.622211 --> -0.627767).  Saving model ...
Epoch: 21 cost time: 2.365067958831787
Epoch: 21, Steps: 12 | Train Loss: 0.718 Vali Loss: 1.045 Vali Acc: 0.644 Test Loss: 1.045 Test Acc: 0.644
Validation loss decreased (-0.627767 --> -0.644434).  Saving model ...
Epoch: 22 cost time: 2.5018017292022705
Epoch: 22, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.998 Vali Acc: 0.656 Test Loss: 0.998 Test Acc: 0.656
Validation loss decreased (-0.644434 --> -0.655546).  Saving model ...
Epoch: 23 cost time: 2.4874236583709717
Epoch: 23, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.960 Vali Acc: 0.683 Test Loss: 0.960 Test Acc: 0.683
Validation loss decreased (-0.655546 --> -0.683324).  Saving model ...
Epoch: 24 cost time: 2.5754518508911133
Epoch: 24, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.934 Vali Acc: 0.694 Test Loss: 0.934 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694435).  Saving model ...
Epoch: 25 cost time: 2.5227344036102295
Epoch: 25, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.887 Vali Acc: 0.728 Test Loss: 0.887 Test Acc: 0.728
Validation loss decreased (-0.694435 --> -0.727769).  Saving model ...
Epoch: 26 cost time: 2.4282171726226807
Epoch: 26, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.859 Vali Acc: 0.733 Test Loss: 0.859 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 27 cost time: 2.5324745178222656
Epoch: 27, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.866 Vali Acc: 0.706 Test Loss: 0.866 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4534056186676025
Epoch: 28, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.837 Vali Acc: 0.733 Test Loss: 0.837 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 29 cost time: 2.3966634273529053
Epoch: 29, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.827 Vali Acc: 0.733 Test Loss: 0.827 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 30 cost time: 2.4147326946258545
Epoch: 30, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.795 Vali Acc: 0.756 Test Loss: 0.795 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755548).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 597503
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.0069580078125
Epoch: 1, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.797 Vali Acc: 0.072 Test Loss: 2.797 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 2.1614232063293457
Epoch: 2, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.714 Vali Acc: 0.144 Test Loss: 2.714 Test Acc: 0.144
Validation loss decreased (-0.072194 --> -0.144417).  Saving model ...
Epoch: 3 cost time: 2.225816488265991
Epoch: 3, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.607 Vali Acc: 0.150 Test Loss: 2.607 Test Acc: 0.150
Validation loss decreased (-0.144417 --> -0.149974).  Saving model ...
Epoch: 4 cost time: 2.382885456085205
Epoch: 4, Steps: 12 | Train Loss: 2.500 Vali Loss: 2.490 Vali Acc: 0.206 Test Loss: 2.490 Test Acc: 0.206
Validation loss decreased (-0.149974 --> -0.205531).  Saving model ...
Epoch: 5 cost time: 2.291490316390991
Epoch: 5, Steps: 12 | Train Loss: 2.362 Vali Loss: 2.369 Vali Acc: 0.294 Test Loss: 2.369 Test Acc: 0.294
Validation loss decreased (-0.205531 --> -0.294421).  Saving model ...
Epoch: 6 cost time: 2.3407468795776367
Epoch: 6, Steps: 12 | Train Loss: 2.217 Vali Loss: 2.247 Vali Acc: 0.400 Test Loss: 2.247 Test Acc: 0.400
Validation loss decreased (-0.294421 --> -0.399978).  Saving model ...
Epoch: 7 cost time: 2.2276265621185303
Epoch: 7, Steps: 12 | Train Loss: 2.054 Vali Loss: 2.126 Vali Acc: 0.417 Test Loss: 2.126 Test Acc: 0.417
Validation loss decreased (-0.399978 --> -0.416645).  Saving model ...
Epoch: 8 cost time: 2.1723451614379883
Epoch: 8, Steps: 12 | Train Loss: 1.991 Vali Loss: 2.005 Vali Acc: 0.467 Test Loss: 2.005 Test Acc: 0.467
Validation loss decreased (-0.416645 --> -0.466647).  Saving model ...
Epoch: 9 cost time: 2.2039122581481934
Epoch: 9, Steps: 12 | Train Loss: 1.852 Vali Loss: 1.897 Vali Acc: 0.478 Test Loss: 1.897 Test Acc: 0.478
Validation loss decreased (-0.466647 --> -0.477759).  Saving model ...
Epoch: 10 cost time: 2.22299861907959
Epoch: 10, Steps: 12 | Train Loss: 1.697 Vali Loss: 1.787 Vali Acc: 0.517 Test Loss: 1.787 Test Acc: 0.517
Validation loss decreased (-0.477759 --> -0.516649).  Saving model ...
Epoch: 11 cost time: 2.318037748336792
Epoch: 11, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.686 Vali Acc: 0.528 Test Loss: 1.686 Test Acc: 0.528
Validation loss decreased (-0.516649 --> -0.527761).  Saving model ...
Epoch: 12 cost time: 2.167846441268921
Epoch: 12, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.601 Vali Acc: 0.539 Test Loss: 1.601 Test Acc: 0.539
Validation loss decreased (-0.527761 --> -0.538873).  Saving model ...
Epoch: 13 cost time: 2.2788257598876953
Epoch: 13, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.511 Vali Acc: 0.578 Test Loss: 1.511 Test Acc: 0.578
Validation loss decreased (-0.538873 --> -0.577763).  Saving model ...
Epoch: 14 cost time: 2.2783498764038086
Epoch: 14, Steps: 12 | Train Loss: 1.249 Vali Loss: 1.435 Vali Acc: 0.567 Test Loss: 1.435 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2322652339935303
Epoch: 15, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.357 Vali Acc: 0.594 Test Loss: 1.357 Test Acc: 0.594
Validation loss decreased (-0.577763 --> -0.594431).  Saving model ...
Epoch: 16 cost time: 2.2359423637390137
Epoch: 16, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.283 Vali Acc: 0.600 Test Loss: 1.283 Test Acc: 0.600
Validation loss decreased (-0.594431 --> -0.599987).  Saving model ...
Epoch: 17 cost time: 2.3899569511413574
Epoch: 17, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.231 Vali Acc: 0.611 Test Loss: 1.231 Test Acc: 0.611
Validation loss decreased (-0.599987 --> -0.611099).  Saving model ...
Epoch: 18 cost time: 2.2141575813293457
Epoch: 18, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.173 Vali Acc: 0.611 Test Loss: 1.173 Test Acc: 0.611
Validation loss decreased (-0.611099 --> -0.611099).  Saving model ...
Epoch: 19 cost time: 2.123713970184326
Epoch: 19, Steps: 12 | Train Loss: 0.857 Vali Loss: 1.125 Vali Acc: 0.611 Test Loss: 1.125 Test Acc: 0.611
Validation loss decreased (-0.611099 --> -0.611100).  Saving model ...
Epoch: 20 cost time: 2.1314237117767334
Epoch: 20, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.083 Vali Acc: 0.644 Test Loss: 1.083 Test Acc: 0.644
Validation loss decreased (-0.611100 --> -0.644434).  Saving model ...
Epoch: 21 cost time: 2.1554691791534424
Epoch: 21, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.050 Vali Acc: 0.656 Test Loss: 1.050 Test Acc: 0.656
Validation loss decreased (-0.644434 --> -0.655545).  Saving model ...
Epoch: 22 cost time: 2.313142776489258
Epoch: 22, Steps: 12 | Train Loss: 0.719 Vali Loss: 1.016 Vali Acc: 0.661 Test Loss: 1.016 Test Acc: 0.661
Validation loss decreased (-0.655545 --> -0.661101).  Saving model ...
Epoch: 23 cost time: 2.1658456325531006
Epoch: 23, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.988 Vali Acc: 0.667 Test Loss: 0.988 Test Acc: 0.667
Validation loss decreased (-0.661101 --> -0.666657).  Saving model ...
Epoch: 24 cost time: 2.073516607284546
Epoch: 24, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.969 Vali Acc: 0.683 Test Loss: 0.969 Test Acc: 0.683
Validation loss decreased (-0.666657 --> -0.683324).  Saving model ...
Epoch: 25 cost time: 2.1754050254821777
Epoch: 25, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.943 Vali Acc: 0.678 Test Loss: 0.943 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.171987295150757
Epoch: 26, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.923 Vali Acc: 0.689 Test Loss: 0.923 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688880).  Saving model ...
Epoch: 27 cost time: 2.273310661315918
Epoch: 27, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.897 Vali Acc: 0.711 Test Loss: 0.897 Test Acc: 0.711
Validation loss decreased (-0.688880 --> -0.711102).  Saving model ...
Epoch: 28 cost time: 2.248307704925537
Epoch: 28, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.887 Vali Acc: 0.694 Test Loss: 0.887 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.169767141342163
Epoch: 29, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.871 Vali Acc: 0.706 Test Loss: 0.871 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.1922731399536133
Epoch: 30, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.865 Vali Acc: 0.678 Test Loss: 0.865 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7111111111111111
model parameter : 183551
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.258241415023804
Epoch: 1, Steps: 12 | Train Loss: 2.742 Vali Loss: 2.732 Vali Acc: 0.033 Test Loss: 2.732 Test Acc: 0.033
Validation loss decreased (inf --> -0.033306).  Saving model ...
Epoch: 2 cost time: 4.394819021224976
Epoch: 2, Steps: 12 | Train Loss: 2.712 Vali Loss: 2.666 Vali Acc: 0.078 Test Loss: 2.666 Test Acc: 0.078
Validation loss decreased (-0.033306 --> -0.077751).  Saving model ...
Epoch: 3 cost time: 4.247162818908691
Epoch: 3, Steps: 12 | Train Loss: 2.614 Vali Loss: 2.580 Vali Acc: 0.156 Test Loss: 2.580 Test Acc: 0.156
Validation loss decreased (-0.077751 --> -0.155530).  Saving model ...
Epoch: 4 cost time: 4.358320951461792
Epoch: 4, Steps: 12 | Train Loss: 2.544 Vali Loss: 2.474 Vali Acc: 0.261 Test Loss: 2.474 Test Acc: 0.261
Validation loss decreased (-0.155530 --> -0.261086).  Saving model ...
Epoch: 5 cost time: 4.369748592376709
Epoch: 5, Steps: 12 | Train Loss: 2.375 Vali Loss: 2.354 Vali Acc: 0.361 Test Loss: 2.354 Test Acc: 0.361
Validation loss decreased (-0.261086 --> -0.361088).  Saving model ...
Epoch: 6 cost time: 4.400030851364136
Epoch: 6, Steps: 12 | Train Loss: 2.267 Vali Loss: 2.228 Vali Acc: 0.433 Test Loss: 2.228 Test Acc: 0.433
Validation loss decreased (-0.361088 --> -0.433311).  Saving model ...
Epoch: 7 cost time: 4.254552841186523
Epoch: 7, Steps: 12 | Train Loss: 2.111 Vali Loss: 2.097 Vali Acc: 0.472 Test Loss: 2.097 Test Acc: 0.472
Validation loss decreased (-0.433311 --> -0.472201).  Saving model ...
Epoch: 8 cost time: 4.440760850906372
Epoch: 8, Steps: 12 | Train Loss: 1.967 Vali Loss: 1.962 Vali Acc: 0.517 Test Loss: 1.962 Test Acc: 0.517
Validation loss decreased (-0.472201 --> -0.516647).  Saving model ...
Epoch: 9 cost time: 4.190954923629761
Epoch: 9, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.842 Vali Acc: 0.528 Test Loss: 1.842 Test Acc: 0.528
Validation loss decreased (-0.516647 --> -0.527759).  Saving model ...
Epoch: 10 cost time: 3.987161159515381
Epoch: 10, Steps: 12 | Train Loss: 1.694 Vali Loss: 1.727 Vali Acc: 0.544 Test Loss: 1.727 Test Acc: 0.544
Validation loss decreased (-0.527759 --> -0.544427).  Saving model ...
Epoch: 11 cost time: 3.9509456157684326
Epoch: 11, Steps: 12 | Train Loss: 1.536 Vali Loss: 1.607 Vali Acc: 0.567 Test Loss: 1.607 Test Acc: 0.567
Validation loss decreased (-0.544427 --> -0.566651).  Saving model ...
Epoch: 12 cost time: 3.9785678386688232
Epoch: 12, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.520 Vali Acc: 0.578 Test Loss: 1.520 Test Acc: 0.578
Validation loss decreased (-0.566651 --> -0.577763).  Saving model ...
Epoch: 13 cost time: 4.2531774044036865
Epoch: 13, Steps: 12 | Train Loss: 1.331 Vali Loss: 1.422 Vali Acc: 0.606 Test Loss: 1.422 Test Acc: 0.606
Validation loss decreased (-0.577763 --> -0.605541).  Saving model ...
Epoch: 14 cost time: 4.162306070327759
Epoch: 14, Steps: 12 | Train Loss: 1.272 Vali Loss: 1.367 Vali Acc: 0.622 Test Loss: 1.367 Test Acc: 0.622
Validation loss decreased (-0.605541 --> -0.622209).  Saving model ...
Epoch: 15 cost time: 4.157439708709717
Epoch: 15, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.296 Vali Acc: 0.628 Test Loss: 1.296 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 16 cost time: 4.187638282775879
Epoch: 16, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.223 Vali Acc: 0.644 Test Loss: 1.223 Test Acc: 0.644
Validation loss decreased (-0.627765 --> -0.644432).  Saving model ...
Epoch: 17 cost time: 4.101943492889404
Epoch: 17, Steps: 12 | Train Loss: 1.010 Vali Loss: 1.164 Vali Acc: 0.678 Test Loss: 1.164 Test Acc: 0.678
Validation loss decreased (-0.644432 --> -0.677766).  Saving model ...
Epoch: 18 cost time: 4.13964581489563
Epoch: 18, Steps: 12 | Train Loss: 1.000 Vali Loss: 1.105 Vali Acc: 0.667 Test Loss: 1.105 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.384626150131226
Epoch: 19, Steps: 12 | Train Loss: 0.930 Vali Loss: 1.063 Vali Acc: 0.694 Test Loss: 1.063 Test Acc: 0.694
Validation loss decreased (-0.677766 --> -0.694434).  Saving model ...
Epoch: 20 cost time: 4.137612819671631
Epoch: 20, Steps: 12 | Train Loss: 0.819 Vali Loss: 1.037 Vali Acc: 0.694 Test Loss: 1.037 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694434).  Saving model ...
Epoch: 21 cost time: 4.142816781997681
Epoch: 21, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.987 Vali Acc: 0.706 Test Loss: 0.987 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705546).  Saving model ...
Epoch: 22 cost time: 4.169168710708618
Epoch: 22, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.987 Vali Acc: 0.717 Test Loss: 0.987 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 23 cost time: 4.113408327102661
Epoch: 23, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.951 Vali Acc: 0.722 Test Loss: 0.951 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 24 cost time: 4.06503438949585
Epoch: 24, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.889 Vali Acc: 0.711 Test Loss: 0.889 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.9280290603637695
Epoch: 25, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.892 Vali Acc: 0.728 Test Loss: 0.892 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 26 cost time: 3.839294195175171
Epoch: 26, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749991).  Saving model ...
Epoch: 27 cost time: 3.9625401496887207
Epoch: 27, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.833 Vali Acc: 0.733 Test Loss: 0.833 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.9491825103759766
Epoch: 28, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.823 Vali Acc: 0.744 Test Loss: 0.823 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.7652506828308105
Epoch: 29, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 30 cost time: 4.055143117904663
Epoch: 30, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.789 Vali Acc: 0.750 Test Loss: 0.789 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 1178695
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.168038368225098
Epoch: 1, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.711 Vali Acc: 0.078 Test Loss: 2.711 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 3.1752703189849854
Epoch: 2, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.653 Vali Acc: 0.128 Test Loss: 2.653 Test Acc: 0.128
Validation loss decreased (-0.077751 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 3.249542236328125
Epoch: 3, Steps: 12 | Train Loss: 2.643 Vali Loss: 2.575 Vali Acc: 0.178 Test Loss: 2.575 Test Acc: 0.178
Validation loss decreased (-0.127751 --> -0.177752).  Saving model ...
Epoch: 4 cost time: 3.4556005001068115
Epoch: 4, Steps: 12 | Train Loss: 2.533 Vali Loss: 2.486 Vali Acc: 0.283 Test Loss: 2.486 Test Acc: 0.283
Validation loss decreased (-0.177752 --> -0.283308).  Saving model ...
Epoch: 5 cost time: 3.1540393829345703
Epoch: 5, Steps: 12 | Train Loss: 2.455 Vali Loss: 2.385 Vali Acc: 0.378 Test Loss: 2.385 Test Acc: 0.378
Validation loss decreased (-0.283308 --> -0.377754).  Saving model ...
Epoch: 6 cost time: 3.156226873397827
Epoch: 6, Steps: 12 | Train Loss: 2.380 Vali Loss: 2.286 Vali Acc: 0.456 Test Loss: 2.286 Test Acc: 0.456
Validation loss decreased (-0.377754 --> -0.455533).  Saving model ...
Epoch: 7 cost time: 3.2839324474334717
Epoch: 7, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.182 Vali Acc: 0.478 Test Loss: 2.182 Test Acc: 0.478
Validation loss decreased (-0.455533 --> -0.477756).  Saving model ...
Epoch: 8 cost time: 3.1730234622955322
Epoch: 8, Steps: 12 | Train Loss: 2.141 Vali Loss: 2.066 Vali Acc: 0.517 Test Loss: 2.066 Test Acc: 0.517
Validation loss decreased (-0.477756 --> -0.516646).  Saving model ...
Epoch: 9 cost time: 3.3480467796325684
Epoch: 9, Steps: 12 | Train Loss: 2.032 Vali Loss: 1.948 Vali Acc: 0.539 Test Loss: 1.948 Test Acc: 0.539
Validation loss decreased (-0.516646 --> -0.538869).  Saving model ...
Epoch: 10 cost time: 3.444261074066162
Epoch: 10, Steps: 12 | Train Loss: 1.921 Vali Loss: 1.829 Vali Acc: 0.567 Test Loss: 1.829 Test Acc: 0.567
Validation loss decreased (-0.538869 --> -0.566648).  Saving model ...
Epoch: 11 cost time: 3.4298195838928223
Epoch: 11, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.715 Vali Acc: 0.572 Test Loss: 1.715 Test Acc: 0.572
Validation loss decreased (-0.566648 --> -0.572205).  Saving model ...
Epoch: 12 cost time: 3.4044291973114014
Epoch: 12, Steps: 12 | Train Loss: 1.625 Vali Loss: 1.601 Vali Acc: 0.606 Test Loss: 1.601 Test Acc: 0.606
Validation loss decreased (-0.572205 --> -0.605540).  Saving model ...
Epoch: 13 cost time: 3.3814616203308105
Epoch: 13, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.499 Vali Acc: 0.611 Test Loss: 1.499 Test Acc: 0.611
Validation loss decreased (-0.605540 --> -0.611096).  Saving model ...
Epoch: 14 cost time: 3.3765313625335693
Epoch: 14, Steps: 12 | Train Loss: 1.374 Vali Loss: 1.406 Vali Acc: 0.644 Test Loss: 1.406 Test Acc: 0.644
Validation loss decreased (-0.611096 --> -0.644430).  Saving model ...
Epoch: 15 cost time: 3.8494772911071777
Epoch: 15, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.324 Vali Acc: 0.661 Test Loss: 1.324 Test Acc: 0.661
Validation loss decreased (-0.644430 --> -0.661098).  Saving model ...
Epoch: 16 cost time: 3.797452449798584
Epoch: 16, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.259 Vali Acc: 0.678 Test Loss: 1.259 Test Acc: 0.678
Validation loss decreased (-0.661098 --> -0.677765).  Saving model ...
Epoch: 17 cost time: 3.736018657684326
Epoch: 17, Steps: 12 | Train Loss: 1.105 Vali Loss: 1.180 Vali Acc: 0.656 Test Loss: 1.180 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5578887462615967
Epoch: 18, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.132 Vali Acc: 0.650 Test Loss: 1.132 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.5980336666107178
Epoch: 19, Steps: 12 | Train Loss: 1.012 Vali Loss: 1.082 Vali Acc: 0.672 Test Loss: 1.082 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.5225026607513428
Epoch: 20, Steps: 12 | Train Loss: 0.898 Vali Loss: 1.022 Vali Acc: 0.694 Test Loss: 1.022 Test Acc: 0.694
Validation loss decreased (-0.677765 --> -0.694434).  Saving model ...
Epoch: 21 cost time: 3.8902571201324463
Epoch: 21, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.985 Vali Acc: 0.717 Test Loss: 0.985 Test Acc: 0.717
Validation loss decreased (-0.694434 --> -0.716657).  Saving model ...
Epoch: 22 cost time: 3.868342638015747
Epoch: 22, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.948 Vali Acc: 0.694 Test Loss: 0.948 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.606304883956909
Epoch: 23, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.914 Vali Acc: 0.717 Test Loss: 0.914 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716658).  Saving model ...
Epoch: 24 cost time: 3.716564416885376
Epoch: 24, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.906 Vali Acc: 0.689 Test Loss: 0.906 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.699312686920166
Epoch: 25, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.866 Vali Acc: 0.711 Test Loss: 0.866 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8630707263946533
Epoch: 26, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.840 Vali Acc: 0.728 Test Loss: 0.840 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727769).  Saving model ...
Epoch: 27 cost time: 3.856682300567627
Epoch: 27, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.863 Vali Acc: 0.694 Test Loss: 0.863 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.741183042526245
Epoch: 28, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.855 Vali Acc: 0.728 Test Loss: 0.855 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6076369285583496
Epoch: 29, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.819 Vali Acc: 0.706 Test Loss: 0.819 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.662320375442505
Epoch: 30, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.780 Vali Acc: 0.700 Test Loss: 0.780 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7277777777777777
model parameter : 350727
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.953756332397461
Epoch: 1, Steps: 12 | Train Loss: 2.742 Vali Loss: 2.733 Vali Acc: 0.033 Test Loss: 2.733 Test Acc: 0.033
Validation loss decreased (inf --> -0.033306).  Saving model ...
Epoch: 2 cost time: 3.6700968742370605
Epoch: 2, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.668 Vali Acc: 0.072 Test Loss: 2.668 Test Acc: 0.072
Validation loss decreased (-0.033306 --> -0.072196).  Saving model ...
Epoch: 3 cost time: 3.6437864303588867
Epoch: 3, Steps: 12 | Train Loss: 2.623 Vali Loss: 2.586 Vali Acc: 0.111 Test Loss: 2.586 Test Acc: 0.111
Validation loss decreased (-0.072196 --> -0.111085).  Saving model ...
Epoch: 4 cost time: 3.6935293674468994
Epoch: 4, Steps: 12 | Train Loss: 2.559 Vali Loss: 2.491 Vali Acc: 0.228 Test Loss: 2.491 Test Acc: 0.228
Validation loss decreased (-0.111085 --> -0.227753).  Saving model ...
Epoch: 5 cost time: 3.8505539894104004
Epoch: 5, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.391 Vali Acc: 0.344 Test Loss: 2.391 Test Acc: 0.344
Validation loss decreased (-0.227753 --> -0.344421).  Saving model ...
Epoch: 6 cost time: 3.883018970489502
Epoch: 6, Steps: 12 | Train Loss: 2.322 Vali Loss: 2.286 Vali Acc: 0.422 Test Loss: 2.286 Test Acc: 0.422
Validation loss decreased (-0.344421 --> -0.422199).  Saving model ...
Epoch: 7 cost time: 3.7502431869506836
Epoch: 7, Steps: 12 | Train Loss: 2.204 Vali Loss: 2.176 Vali Acc: 0.456 Test Loss: 2.176 Test Acc: 0.456
Validation loss decreased (-0.422199 --> -0.455534).  Saving model ...
Epoch: 8 cost time: 3.6459689140319824
Epoch: 8, Steps: 12 | Train Loss: 2.070 Vali Loss: 2.061 Vali Acc: 0.461 Test Loss: 2.061 Test Acc: 0.461
Validation loss decreased (-0.455534 --> -0.461091).  Saving model ...
Epoch: 9 cost time: 3.6739017963409424
Epoch: 9, Steps: 12 | Train Loss: 1.937 Vali Loss: 1.953 Vali Acc: 0.478 Test Loss: 1.953 Test Acc: 0.478
Validation loss decreased (-0.461091 --> -0.477758).  Saving model ...
Epoch: 10 cost time: 3.7877769470214844
Epoch: 10, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.843 Vali Acc: 0.506 Test Loss: 1.843 Test Acc: 0.506
Validation loss decreased (-0.477758 --> -0.505537).  Saving model ...
Epoch: 11 cost time: 3.8737664222717285
Epoch: 11, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.747 Vali Acc: 0.522 Test Loss: 1.747 Test Acc: 0.522
Validation loss decreased (-0.505537 --> -0.522205).  Saving model ...
Epoch: 12 cost time: 3.882093906402588
Epoch: 12, Steps: 12 | Train Loss: 1.628 Vali Loss: 1.671 Vali Acc: 0.533 Test Loss: 1.671 Test Acc: 0.533
Validation loss decreased (-0.522205 --> -0.533317).  Saving model ...
Epoch: 13 cost time: 3.7984187602996826
Epoch: 13, Steps: 12 | Train Loss: 1.494 Vali Loss: 1.602 Vali Acc: 0.533 Test Loss: 1.602 Test Acc: 0.533
Validation loss decreased (-0.533317 --> -0.533317).  Saving model ...
Epoch: 14 cost time: 3.6327714920043945
Epoch: 14, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.538 Vali Acc: 0.533 Test Loss: 1.538 Test Acc: 0.533
Validation loss decreased (-0.533317 --> -0.533318).  Saving model ...
Epoch: 15 cost time: 3.639096975326538
Epoch: 15, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.467 Vali Acc: 0.539 Test Loss: 1.467 Test Acc: 0.539
Validation loss decreased (-0.533318 --> -0.538874).  Saving model ...
Epoch: 16 cost time: 3.990338087081909
Epoch: 16, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.381 Vali Acc: 0.583 Test Loss: 1.381 Test Acc: 0.583
Validation loss decreased (-0.538874 --> -0.583320).  Saving model ...
Epoch: 17 cost time: 3.854990243911743
Epoch: 17, Steps: 12 | Train Loss: 1.195 Vali Loss: 1.325 Vali Acc: 0.633 Test Loss: 1.325 Test Acc: 0.633
Validation loss decreased (-0.583320 --> -0.633320).  Saving model ...
Epoch: 18 cost time: 3.806746006011963
Epoch: 18, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.284 Vali Acc: 0.611 Test Loss: 1.284 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.6349005699157715
Epoch: 19, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.223 Vali Acc: 0.617 Test Loss: 1.223 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.5351734161376953
Epoch: 20, Steps: 12 | Train Loss: 1.022 Vali Loss: 1.176 Vali Acc: 0.644 Test Loss: 1.176 Test Acc: 0.644
Validation loss decreased (-0.633320 --> -0.644433).  Saving model ...
Epoch: 21 cost time: 3.6141064167022705
Epoch: 21, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.138 Vali Acc: 0.667 Test Loss: 1.138 Test Acc: 0.667
Validation loss decreased (-0.644433 --> -0.666655).  Saving model ...
Epoch: 22 cost time: 3.9599971771240234
Epoch: 22, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.097 Vali Acc: 0.689 Test Loss: 1.097 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688878).  Saving model ...
Epoch: 23 cost time: 3.896385908126831
Epoch: 23, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.061 Vali Acc: 0.661 Test Loss: 1.061 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.798419952392578
Epoch: 24, Steps: 12 | Train Loss: 0.807 Vali Loss: 1.024 Vali Acc: 0.672 Test Loss: 1.024 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.8082385063171387
Epoch: 25, Steps: 12 | Train Loss: 0.834 Vali Loss: 0.997 Vali Acc: 0.678 Test Loss: 0.997 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.709615707397461
Epoch: 26, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.953 Vali Acc: 0.694 Test Loss: 0.953 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694435).  Saving model ...
Epoch: 27 cost time: 3.792823314666748
Epoch: 27, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.928 Vali Acc: 0.711 Test Loss: 0.928 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 28 cost time: 3.9727065563201904
Epoch: 28, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.904 Vali Acc: 0.722 Test Loss: 0.904 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722213).  Saving model ...
Epoch: 29 cost time: 3.882985830307007
Epoch: 29, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.886 Vali Acc: 0.711 Test Loss: 0.886 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.8455774784088135
Epoch: 30, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.817 Vali Acc: 0.733 Test Loss: 0.817 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7333333333333333
model parameter : 1178695
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.105272531509399
Epoch: 1, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.712 Vali Acc: 0.078 Test Loss: 2.712 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 3.2653026580810547
Epoch: 2, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.658 Vali Acc: 0.128 Test Loss: 2.658 Test Acc: 0.128
Validation loss decreased (-0.077751 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 3.2449324131011963
Epoch: 3, Steps: 12 | Train Loss: 2.654 Vali Loss: 2.586 Vali Acc: 0.167 Test Loss: 2.586 Test Acc: 0.167
Validation loss decreased (-0.127751 --> -0.166641).  Saving model ...
Epoch: 4 cost time: 2.912795305252075
Epoch: 4, Steps: 12 | Train Loss: 2.551 Vali Loss: 2.508 Vali Acc: 0.250 Test Loss: 2.508 Test Acc: 0.250
Validation loss decreased (-0.166641 --> -0.249975).  Saving model ...
Epoch: 5 cost time: 2.915858507156372
Epoch: 5, Steps: 12 | Train Loss: 2.492 Vali Loss: 2.418 Vali Acc: 0.344 Test Loss: 2.418 Test Acc: 0.344
Validation loss decreased (-0.249975 --> -0.344420).  Saving model ...
Epoch: 6 cost time: 2.921576499938965
Epoch: 6, Steps: 12 | Train Loss: 2.427 Vali Loss: 2.324 Vali Acc: 0.439 Test Loss: 2.324 Test Acc: 0.439
Validation loss decreased (-0.344420 --> -0.438866).  Saving model ...
Epoch: 7 cost time: 2.810468912124634
Epoch: 7, Steps: 12 | Train Loss: 2.320 Vali Loss: 2.226 Vali Acc: 0.467 Test Loss: 2.226 Test Acc: 0.467
Validation loss decreased (-0.438866 --> -0.466644).  Saving model ...
Epoch: 8 cost time: 3.082378387451172
Epoch: 8, Steps: 12 | Train Loss: 2.211 Vali Loss: 2.121 Vali Acc: 0.494 Test Loss: 2.121 Test Acc: 0.494
Validation loss decreased (-0.466644 --> -0.494423).  Saving model ...
Epoch: 9 cost time: 3.1129679679870605
Epoch: 9, Steps: 12 | Train Loss: 2.139 Vali Loss: 2.021 Vali Acc: 0.500 Test Loss: 2.021 Test Acc: 0.500
Validation loss decreased (-0.494423 --> -0.499980).  Saving model ...
Epoch: 10 cost time: 2.9743382930755615
Epoch: 10, Steps: 12 | Train Loss: 2.035 Vali Loss: 1.922 Vali Acc: 0.567 Test Loss: 1.922 Test Acc: 0.567
Validation loss decreased (-0.499980 --> -0.566647).  Saving model ...
Epoch: 11 cost time: 2.937669038772583
Epoch: 11, Steps: 12 | Train Loss: 1.895 Vali Loss: 1.822 Vali Acc: 0.567 Test Loss: 1.822 Test Acc: 0.567
Validation loss decreased (-0.566647 --> -0.566648).  Saving model ...
Epoch: 12 cost time: 2.9139392375946045
Epoch: 12, Steps: 12 | Train Loss: 1.772 Vali Loss: 1.721 Vali Acc: 0.583 Test Loss: 1.721 Test Acc: 0.583
Validation loss decreased (-0.566648 --> -0.583316).  Saving model ...
Epoch: 13 cost time: 2.937069892883301
Epoch: 13, Steps: 12 | Train Loss: 1.680 Vali Loss: 1.631 Vali Acc: 0.606 Test Loss: 1.631 Test Acc: 0.606
Validation loss decreased (-0.583316 --> -0.605539).  Saving model ...
Epoch: 14 cost time: 3.074023962020874
Epoch: 14, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.538 Vali Acc: 0.622 Test Loss: 1.538 Test Acc: 0.622
Validation loss decreased (-0.605539 --> -0.622207).  Saving model ...
Epoch: 15 cost time: 3.0456833839416504
Epoch: 15, Steps: 12 | Train Loss: 1.473 Vali Loss: 1.444 Vali Acc: 0.633 Test Loss: 1.444 Test Acc: 0.633
Validation loss decreased (-0.622207 --> -0.633319).  Saving model ...
Epoch: 16 cost time: 2.9399776458740234
Epoch: 16, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.367 Vali Acc: 0.667 Test Loss: 1.367 Test Acc: 0.667
Validation loss decreased (-0.633319 --> -0.666653).  Saving model ...
Epoch: 17 cost time: 2.948554754257202
Epoch: 17, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.300 Vali Acc: 0.661 Test Loss: 1.300 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9879310131073
Epoch: 18, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.243 Vali Acc: 0.667 Test Loss: 1.243 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666654).  Saving model ...
Epoch: 19 cost time: 2.911933422088623
Epoch: 19, Steps: 12 | Train Loss: 1.174 Vali Loss: 1.168 Vali Acc: 0.694 Test Loss: 1.168 Test Acc: 0.694
Validation loss decreased (-0.666654 --> -0.694433).  Saving model ...
Epoch: 20 cost time: 3.07062029838562
Epoch: 20, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.113 Vali Acc: 0.683 Test Loss: 1.113 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0764904022216797
Epoch: 21, Steps: 12 | Train Loss: 1.057 Vali Loss: 1.068 Vali Acc: 0.683 Test Loss: 1.068 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.995068073272705
Epoch: 22, Steps: 12 | Train Loss: 0.954 Vali Loss: 1.040 Vali Acc: 0.694 Test Loss: 1.040 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694434).  Saving model ...
Epoch: 23 cost time: 2.8768036365509033
Epoch: 23, Steps: 12 | Train Loss: 0.920 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722212).  Saving model ...
Epoch: 24 cost time: 2.886904716491699
Epoch: 24, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.981 Vali Acc: 0.689 Test Loss: 0.981 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9270594120025635
Epoch: 25, Steps: 12 | Train Loss: 0.902 Vali Loss: 0.935 Vali Acc: 0.728 Test Loss: 0.935 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 26 cost time: 3.261094808578491
Epoch: 26, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.922 Vali Acc: 0.717 Test Loss: 0.922 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2256851196289062
Epoch: 27, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.909 Vali Acc: 0.711 Test Loss: 0.909 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.222001552581787
Epoch: 28, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.887 Vali Acc: 0.722 Test Loss: 0.887 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.819955587387085
Epoch: 29, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.865 Vali Acc: 0.700 Test Loss: 0.865 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.163740634918213
Epoch: 30, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.833 Vali Acc: 0.728 Test Loss: 0.833 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727769).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7277777777777777
model parameter : 350727
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.766921281814575
Epoch: 1, Steps: 12 | Train Loss: 2.744 Vali Loss: 2.739 Vali Acc: 0.028 Test Loss: 2.739 Test Acc: 0.028
Validation loss decreased (inf --> -0.027750).  Saving model ...
Epoch: 2 cost time: 2.881645441055298
Epoch: 2, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.692 Vali Acc: 0.050 Test Loss: 2.692 Test Acc: 0.050
Validation loss decreased (-0.027750 --> -0.049973).  Saving model ...
Epoch: 3 cost time: 2.725911855697632
Epoch: 3, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.632 Vali Acc: 0.067 Test Loss: 2.632 Test Acc: 0.067
Validation loss decreased (-0.049973 --> -0.066640).  Saving model ...
Epoch: 4 cost time: 2.8021693229675293
Epoch: 4, Steps: 12 | Train Loss: 2.616 Vali Loss: 2.561 Vali Acc: 0.178 Test Loss: 2.561 Test Acc: 0.178
Validation loss decreased (-0.066640 --> -0.177752).  Saving model ...
Epoch: 5 cost time: 2.7620668411254883
Epoch: 5, Steps: 12 | Train Loss: 2.511 Vali Loss: 2.486 Vali Acc: 0.233 Test Loss: 2.486 Test Acc: 0.233
Validation loss decreased (-0.177752 --> -0.233308).  Saving model ...
Epoch: 6 cost time: 2.7916221618652344
Epoch: 6, Steps: 12 | Train Loss: 2.427 Vali Loss: 2.409 Vali Acc: 0.261 Test Loss: 2.409 Test Acc: 0.261
Validation loss decreased (-0.233308 --> -0.261087).  Saving model ...
Epoch: 7 cost time: 2.944122791290283
Epoch: 7, Steps: 12 | Train Loss: 2.347 Vali Loss: 2.330 Vali Acc: 0.300 Test Loss: 2.330 Test Acc: 0.300
Validation loss decreased (-0.261087 --> -0.299977).  Saving model ...
Epoch: 8 cost time: 2.8449747562408447
Epoch: 8, Steps: 12 | Train Loss: 2.228 Vali Loss: 2.245 Vali Acc: 0.333 Test Loss: 2.245 Test Acc: 0.333
Validation loss decreased (-0.299977 --> -0.333311).  Saving model ...
Epoch: 9 cost time: 2.925999641418457
Epoch: 9, Steps: 12 | Train Loss: 2.145 Vali Loss: 2.166 Vali Acc: 0.367 Test Loss: 2.166 Test Acc: 0.367
Validation loss decreased (-0.333311 --> -0.366645).  Saving model ...
Epoch: 10 cost time: 2.795640707015991
Epoch: 10, Steps: 12 | Train Loss: 2.075 Vali Loss: 2.085 Vali Acc: 0.389 Test Loss: 2.085 Test Acc: 0.389
Validation loss decreased (-0.366645 --> -0.388868).  Saving model ...
Epoch: 11 cost time: 2.8431572914123535
Epoch: 11, Steps: 12 | Train Loss: 1.961 Vali Loss: 2.004 Vali Acc: 0.428 Test Loss: 2.004 Test Acc: 0.428
Validation loss decreased (-0.388868 --> -0.427758).  Saving model ...
Epoch: 12 cost time: 2.8765523433685303
Epoch: 12, Steps: 12 | Train Loss: 1.895 Vali Loss: 1.929 Vali Acc: 0.478 Test Loss: 1.929 Test Acc: 0.478
Validation loss decreased (-0.427758 --> -0.477758).  Saving model ...
Epoch: 13 cost time: 2.849043607711792
Epoch: 13, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.857 Vali Acc: 0.494 Test Loss: 1.857 Test Acc: 0.494
Validation loss decreased (-0.477758 --> -0.494426).  Saving model ...
Epoch: 14 cost time: 2.9250924587249756
Epoch: 14, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.793 Vali Acc: 0.494 Test Loss: 1.793 Test Acc: 0.494
Validation loss decreased (-0.494426 --> -0.494427).  Saving model ...
Epoch: 15 cost time: 2.9389445781707764
Epoch: 15, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.727 Vali Acc: 0.522 Test Loss: 1.727 Test Acc: 0.522
Validation loss decreased (-0.494427 --> -0.522205).  Saving model ...
Epoch: 16 cost time: 3.0709011554718018
Epoch: 16, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.663 Vali Acc: 0.544 Test Loss: 1.663 Test Acc: 0.544
Validation loss decreased (-0.522205 --> -0.544428).  Saving model ...
Epoch: 17 cost time: 2.788090705871582
Epoch: 17, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.610 Vali Acc: 0.533 Test Loss: 1.610 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.770585060119629
Epoch: 18, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.550 Vali Acc: 0.539 Test Loss: 1.550 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7708001136779785
Epoch: 19, Steps: 12 | Train Loss: 1.431 Vali Loss: 1.489 Vali Acc: 0.589 Test Loss: 1.489 Test Acc: 0.589
Validation loss decreased (-0.544428 --> -0.588874).  Saving model ...
Epoch: 20 cost time: 2.941002130508423
Epoch: 20, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.436 Vali Acc: 0.594 Test Loss: 1.436 Test Acc: 0.594
Validation loss decreased (-0.588874 --> -0.594430).  Saving model ...
Epoch: 21 cost time: 2.9028820991516113
Epoch: 21, Steps: 12 | Train Loss: 1.219 Vali Loss: 1.385 Vali Acc: 0.583 Test Loss: 1.385 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.939624309539795
Epoch: 22, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.327 Vali Acc: 0.600 Test Loss: 1.327 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599987).  Saving model ...
Epoch: 23 cost time: 3.0565946102142334
Epoch: 23, Steps: 12 | Train Loss: 1.073 Vali Loss: 1.273 Vali Acc: 0.617 Test Loss: 1.273 Test Acc: 0.617
Validation loss decreased (-0.599987 --> -0.616654).  Saving model ...
Epoch: 24 cost time: 2.956543207168579
Epoch: 24, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.226 Vali Acc: 0.628 Test Loss: 1.226 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627766).  Saving model ...
Epoch: 25 cost time: 2.7981116771698
Epoch: 25, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.187 Vali Acc: 0.617 Test Loss: 1.187 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.7176878452301025
Epoch: 26, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.135 Vali Acc: 0.656 Test Loss: 1.135 Test Acc: 0.656
Validation loss decreased (-0.627766 --> -0.655544).  Saving model ...
Epoch: 27 cost time: 2.8442206382751465
Epoch: 27, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.094 Vali Acc: 0.656 Test Loss: 1.094 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655545).  Saving model ...
Epoch: 28 cost time: 2.958411693572998
Epoch: 28, Steps: 12 | Train Loss: 0.819 Vali Loss: 1.054 Vali Acc: 0.672 Test Loss: 1.054 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672212).  Saving model ...
Epoch: 29 cost time: 3.020817995071411
Epoch: 29, Steps: 12 | Train Loss: 0.817 Vali Loss: 1.019 Vali Acc: 0.672 Test Loss: 1.019 Test Acc: 0.672
Validation loss decreased (-0.672212 --> -0.672212).  Saving model ...
Epoch: 30 cost time: 2.9329679012298584
Epoch: 30, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.965 Vali Acc: 0.700 Test Loss: 0.965 Test Acc: 0.700
Validation loss decreased (-0.672212 --> -0.699990).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7
model parameter : 1178695
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.188262224197388
Epoch: 1, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.719 Vali Acc: 0.078 Test Loss: 2.719 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 2.4043517112731934
Epoch: 2, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.675 Vali Acc: 0.100 Test Loss: 2.675 Test Acc: 0.100
Validation loss decreased (-0.077751 --> -0.099973).  Saving model ...
Epoch: 3 cost time: 2.520456314086914
Epoch: 3, Steps: 12 | Train Loss: 2.671 Vali Loss: 2.617 Vali Acc: 0.139 Test Loss: 2.617 Test Acc: 0.139
Validation loss decreased (-0.099973 --> -0.138863).  Saving model ...
Epoch: 4 cost time: 2.634455919265747
Epoch: 4, Steps: 12 | Train Loss: 2.582 Vali Loss: 2.555 Vali Acc: 0.211 Test Loss: 2.555 Test Acc: 0.211
Validation loss decreased (-0.138863 --> -0.211086).  Saving model ...
Epoch: 5 cost time: 2.570803642272949
Epoch: 5, Steps: 12 | Train Loss: 2.543 Vali Loss: 2.485 Vali Acc: 0.256 Test Loss: 2.485 Test Acc: 0.256
Validation loss decreased (-0.211086 --> -0.255531).  Saving model ...
Epoch: 6 cost time: 2.561066150665283
Epoch: 6, Steps: 12 | Train Loss: 2.495 Vali Loss: 2.416 Vali Acc: 0.328 Test Loss: 2.416 Test Acc: 0.328
Validation loss decreased (-0.255531 --> -0.327754).  Saving model ...
Epoch: 7 cost time: 2.625119924545288
Epoch: 7, Steps: 12 | Train Loss: 2.418 Vali Loss: 2.345 Vali Acc: 0.383 Test Loss: 2.345 Test Acc: 0.383
Validation loss decreased (-0.327754 --> -0.383310).  Saving model ...
Epoch: 8 cost time: 2.5270087718963623
Epoch: 8, Steps: 12 | Train Loss: 2.322 Vali Loss: 2.269 Vali Acc: 0.444 Test Loss: 2.269 Test Acc: 0.444
Validation loss decreased (-0.383310 --> -0.444422).  Saving model ...
Epoch: 9 cost time: 2.435129165649414
Epoch: 9, Steps: 12 | Train Loss: 2.270 Vali Loss: 2.195 Vali Acc: 0.456 Test Loss: 2.195 Test Acc: 0.456
Validation loss decreased (-0.444422 --> -0.455534).  Saving model ...
Epoch: 10 cost time: 2.437124490737915
Epoch: 10, Steps: 12 | Train Loss: 2.189 Vali Loss: 2.122 Vali Acc: 0.494 Test Loss: 2.122 Test Acc: 0.494
Validation loss decreased (-0.455534 --> -0.494423).  Saving model ...
Epoch: 11 cost time: 2.7496492862701416
Epoch: 11, Steps: 12 | Train Loss: 2.083 Vali Loss: 2.051 Vali Acc: 0.528 Test Loss: 2.051 Test Acc: 0.528
Validation loss decreased (-0.494423 --> -0.527757).  Saving model ...
Epoch: 12 cost time: 2.637253999710083
Epoch: 12, Steps: 12 | Train Loss: 1.979 Vali Loss: 1.981 Vali Acc: 0.561 Test Loss: 1.981 Test Acc: 0.561
Validation loss decreased (-0.527757 --> -0.561091).  Saving model ...
Epoch: 13 cost time: 2.5905659198760986
Epoch: 13, Steps: 12 | Train Loss: 1.900 Vali Loss: 1.914 Vali Acc: 0.539 Test Loss: 1.914 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.431047201156616
Epoch: 14, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.841 Vali Acc: 0.522 Test Loss: 1.841 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5162949562072754
Epoch: 15, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.767 Vali Acc: 0.522 Test Loss: 1.767 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4737725257873535
Epoch: 16, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.697 Vali Acc: 0.567 Test Loss: 1.697 Test Acc: 0.567
Validation loss decreased (-0.561091 --> -0.566650).  Saving model ...
Epoch: 17 cost time: 2.4101052284240723
Epoch: 17, Steps: 12 | Train Loss: 1.582 Vali Loss: 1.638 Vali Acc: 0.567 Test Loss: 1.638 Test Acc: 0.567
Validation loss decreased (-0.566650 --> -0.566650).  Saving model ...
Epoch: 18 cost time: 2.465128183364868
Epoch: 18, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.589 Vali Acc: 0.572 Test Loss: 1.589 Test Acc: 0.572
Validation loss decreased (-0.566650 --> -0.572206).  Saving model ...
Epoch: 19 cost time: 2.662135362625122
Epoch: 19, Steps: 12 | Train Loss: 1.443 Vali Loss: 1.532 Vali Acc: 0.556 Test Loss: 1.532 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.6364734172821045
Epoch: 20, Steps: 12 | Train Loss: 1.317 Vali Loss: 1.461 Vali Acc: 0.578 Test Loss: 1.461 Test Acc: 0.578
Validation loss decreased (-0.572206 --> -0.577763).  Saving model ...
Epoch: 21 cost time: 2.6187102794647217
Epoch: 21, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.405 Vali Acc: 0.594 Test Loss: 1.405 Test Acc: 0.594
Validation loss decreased (-0.577763 --> -0.594430).  Saving model ...
Epoch: 22 cost time: 2.48502254486084
Epoch: 22, Steps: 12 | Train Loss: 1.234 Vali Loss: 1.366 Vali Acc: 0.583 Test Loss: 1.366 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6274735927581787
Epoch: 23, Steps: 12 | Train Loss: 1.156 Vali Loss: 1.368 Vali Acc: 0.600 Test Loss: 1.368 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599986).  Saving model ...
Epoch: 24 cost time: 2.5829710960388184
Epoch: 24, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.357 Vali Acc: 0.600 Test Loss: 1.357 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 25 cost time: 2.5375561714172363
Epoch: 25, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.313 Vali Acc: 0.606 Test Loss: 1.313 Test Acc: 0.606
Validation loss decreased (-0.599986 --> -0.605542).  Saving model ...
Epoch: 26 cost time: 2.488197088241577
Epoch: 26, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.267 Vali Acc: 0.589 Test Loss: 1.267 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.531101703643799
Epoch: 27, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.193 Vali Acc: 0.628 Test Loss: 1.193 Test Acc: 0.628
Validation loss decreased (-0.605542 --> -0.627766).  Saving model ...
Epoch: 28 cost time: 2.4966726303100586
Epoch: 28, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.163 Vali Acc: 0.628 Test Loss: 1.163 Test Acc: 0.628
Validation loss decreased (-0.627766 --> -0.627766).  Saving model ...
Epoch: 29 cost time: 2.577859401702881
Epoch: 29, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.122 Vali Acc: 0.644 Test Loss: 1.122 Test Acc: 0.644
Validation loss decreased (-0.627766 --> -0.644433).  Saving model ...
Epoch: 30 cost time: 2.592777967453003
Epoch: 30, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.082 Vali Acc: 0.644 Test Loss: 1.082 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644434).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6444444444444445
model parameter : 350727
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.035907030105591
Epoch: 1, Steps: 12 | Train Loss: 2.856 Vali Loss: 2.768 Vali Acc: 0.083 Test Loss: 2.768 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 4.52596378326416
Epoch: 2, Steps: 12 | Train Loss: 2.830 Vali Loss: 2.712 Vali Acc: 0.094 Test Loss: 2.712 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 4.329288005828857
Epoch: 3, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.640 Vali Acc: 0.128 Test Loss: 2.640 Test Acc: 0.128
Validation loss decreased (-0.094417 --> -0.127751).  Saving model ...
Epoch: 4 cost time: 4.123143911361694
Epoch: 4, Steps: 12 | Train Loss: 2.676 Vali Loss: 2.551 Vali Acc: 0.217 Test Loss: 2.551 Test Acc: 0.217
Validation loss decreased (-0.127751 --> -0.216641).  Saving model ...
Epoch: 5 cost time: 4.085958957672119
Epoch: 5, Steps: 12 | Train Loss: 2.575 Vali Loss: 2.450 Vali Acc: 0.306 Test Loss: 2.450 Test Acc: 0.306
Validation loss decreased (-0.216641 --> -0.305531).  Saving model ...
Epoch: 6 cost time: 4.165714740753174
Epoch: 6, Steps: 12 | Train Loss: 2.471 Vali Loss: 2.351 Vali Acc: 0.389 Test Loss: 2.351 Test Acc: 0.389
Validation loss decreased (-0.305531 --> -0.388865).  Saving model ...
Epoch: 7 cost time: 4.001531600952148
Epoch: 7, Steps: 12 | Train Loss: 2.311 Vali Loss: 2.250 Vali Acc: 0.411 Test Loss: 2.250 Test Acc: 0.411
Validation loss decreased (-0.388865 --> -0.411089).  Saving model ...
Epoch: 8 cost time: 4.010587930679321
Epoch: 8, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.144 Vali Acc: 0.461 Test Loss: 2.144 Test Acc: 0.461
Validation loss decreased (-0.411089 --> -0.461090).  Saving model ...
Epoch: 9 cost time: 4.166539907455444
Epoch: 9, Steps: 12 | Train Loss: 2.108 Vali Loss: 2.036 Vali Acc: 0.506 Test Loss: 2.036 Test Acc: 0.506
Validation loss decreased (-0.461090 --> -0.505535).  Saving model ...
Epoch: 10 cost time: 4.168898820877075
Epoch: 10, Steps: 12 | Train Loss: 1.971 Vali Loss: 1.938 Vali Acc: 0.567 Test Loss: 1.938 Test Acc: 0.567
Validation loss decreased (-0.505535 --> -0.566647).  Saving model ...
Epoch: 11 cost time: 4.0748679637908936
Epoch: 11, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.854 Vali Acc: 0.539 Test Loss: 1.854 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.998673915863037
Epoch: 12, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.770 Vali Acc: 0.567 Test Loss: 1.770 Test Acc: 0.567
Validation loss decreased (-0.566647 --> -0.566649).  Saving model ...
Epoch: 13 cost time: 4.222400665283203
Epoch: 13, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.679 Vali Acc: 0.600 Test Loss: 1.679 Test Acc: 0.600
Validation loss decreased (-0.566649 --> -0.599983).  Saving model ...
Epoch: 14 cost time: 3.958542585372925
Epoch: 14, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.599 Vali Acc: 0.617 Test Loss: 1.599 Test Acc: 0.617
Validation loss decreased (-0.599983 --> -0.616651).  Saving model ...
Epoch: 15 cost time: 3.9202120304107666
Epoch: 15, Steps: 12 | Train Loss: 1.434 Vali Loss: 1.530 Vali Acc: 0.606 Test Loss: 1.530 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.270191431045532
Epoch: 16, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.462 Vali Acc: 0.622 Test Loss: 1.462 Test Acc: 0.622
Validation loss decreased (-0.616651 --> -0.622208).  Saving model ...
Epoch: 17 cost time: 4.135223150253296
Epoch: 17, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.398 Vali Acc: 0.633 Test Loss: 1.398 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633319).  Saving model ...
Epoch: 18 cost time: 3.9867095947265625
Epoch: 18, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.343 Vali Acc: 0.639 Test Loss: 1.343 Test Acc: 0.639
Validation loss decreased (-0.633319 --> -0.638875).  Saving model ...
Epoch: 19 cost time: 3.921992778778076
Epoch: 19, Steps: 12 | Train Loss: 1.177 Vali Loss: 1.279 Vali Acc: 0.661 Test Loss: 1.279 Test Acc: 0.661
Validation loss decreased (-0.638875 --> -0.661098).  Saving model ...
Epoch: 20 cost time: 4.231735944747925
Epoch: 20, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.237 Vali Acc: 0.628 Test Loss: 1.237 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.120096683502197
Epoch: 21, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.212 Vali Acc: 0.639 Test Loss: 1.212 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.145766019821167
Epoch: 22, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.177 Vali Acc: 0.661 Test Loss: 1.177 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661099).  Saving model ...
Epoch: 23 cost time: 4.186917543411255
Epoch: 23, Steps: 12 | Train Loss: 0.938 Vali Loss: 1.135 Vali Acc: 0.656 Test Loss: 1.135 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.5303308963775635
Epoch: 24, Steps: 12 | Train Loss: 0.835 Vali Loss: 1.113 Vali Acc: 0.683 Test Loss: 1.113 Test Acc: 0.683
Validation loss decreased (-0.661099 --> -0.683322).  Saving model ...
Epoch: 25 cost time: 4.142415523529053
Epoch: 25, Steps: 12 | Train Loss: 0.810 Vali Loss: 1.089 Vali Acc: 0.656 Test Loss: 1.089 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.129117727279663
Epoch: 26, Steps: 12 | Train Loss: 0.820 Vali Loss: 1.065 Vali Acc: 0.650 Test Loss: 1.065 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.501539468765259
Epoch: 27, Steps: 12 | Train Loss: 0.814 Vali Loss: 1.048 Vali Acc: 0.689 Test Loss: 1.048 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 28 cost time: 4.367585182189941
Epoch: 28, Steps: 12 | Train Loss: 0.697 Vali Loss: 1.020 Vali Acc: 0.678 Test Loss: 1.020 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.270457983016968
Epoch: 29, Steps: 12 | Train Loss: 0.697 Vali Loss: 1.003 Vali Acc: 0.667 Test Loss: 1.003 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.1585798263549805
Epoch: 30, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.993 Vali Acc: 0.678 Test Loss: 0.993 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6888888888888889
model parameter : 592199
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.752716541290283
Epoch: 1, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.654 Vali Acc: 0.100 Test Loss: 2.654 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 3.4273109436035156
Epoch: 2, Steps: 12 | Train Loss: 2.651 Vali Loss: 2.607 Vali Acc: 0.111 Test Loss: 2.607 Test Acc: 0.111
Validation loss decreased (-0.099973 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 3.750020980834961
Epoch: 3, Steps: 12 | Train Loss: 2.608 Vali Loss: 2.544 Vali Acc: 0.178 Test Loss: 2.544 Test Acc: 0.178
Validation loss decreased (-0.111085 --> -0.177752).  Saving model ...
Epoch: 4 cost time: 3.5435638427734375
Epoch: 4, Steps: 12 | Train Loss: 2.538 Vali Loss: 2.467 Vali Acc: 0.289 Test Loss: 2.467 Test Acc: 0.289
Validation loss decreased (-0.177752 --> -0.288864).  Saving model ...
Epoch: 5 cost time: 3.541412830352783
Epoch: 5, Steps: 12 | Train Loss: 2.406 Vali Loss: 2.384 Vali Acc: 0.361 Test Loss: 2.384 Test Acc: 0.361
Validation loss decreased (-0.288864 --> -0.361087).  Saving model ...
Epoch: 6 cost time: 3.7308335304260254
Epoch: 6, Steps: 12 | Train Loss: 2.331 Vali Loss: 2.286 Vali Acc: 0.400 Test Loss: 2.286 Test Acc: 0.400
Validation loss decreased (-0.361087 --> -0.399977).  Saving model ...
Epoch: 7 cost time: 3.8011391162872314
Epoch: 7, Steps: 12 | Train Loss: 2.232 Vali Loss: 2.188 Vali Acc: 0.406 Test Loss: 2.188 Test Acc: 0.406
Validation loss decreased (-0.399977 --> -0.405534).  Saving model ...
Epoch: 8 cost time: 3.7236528396606445
Epoch: 8, Steps: 12 | Train Loss: 2.118 Vali Loss: 2.084 Vali Acc: 0.461 Test Loss: 2.084 Test Acc: 0.461
Validation loss decreased (-0.405534 --> -0.461090).  Saving model ...
Epoch: 9 cost time: 3.684445381164551
Epoch: 9, Steps: 12 | Train Loss: 1.987 Vali Loss: 1.988 Vali Acc: 0.461 Test Loss: 1.988 Test Acc: 0.461
Validation loss decreased (-0.461090 --> -0.461091).  Saving model ...
Epoch: 10 cost time: 3.618894100189209
Epoch: 10, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.895 Vali Acc: 0.478 Test Loss: 1.895 Test Acc: 0.478
Validation loss decreased (-0.461091 --> -0.477759).  Saving model ...
Epoch: 11 cost time: 3.7585134506225586
Epoch: 11, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.804 Vali Acc: 0.494 Test Loss: 1.804 Test Acc: 0.494
Validation loss decreased (-0.477759 --> -0.494426).  Saving model ...
Epoch: 12 cost time: 3.714679479598999
Epoch: 12, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.718 Vali Acc: 0.506 Test Loss: 1.718 Test Acc: 0.506
Validation loss decreased (-0.494426 --> -0.505538).  Saving model ...
Epoch: 13 cost time: 3.5820789337158203
Epoch: 13, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.640 Vali Acc: 0.517 Test Loss: 1.640 Test Acc: 0.517
Validation loss decreased (-0.505538 --> -0.516650).  Saving model ...
Epoch: 14 cost time: 3.4980106353759766
Epoch: 14, Steps: 12 | Train Loss: 1.475 Vali Loss: 1.564 Vali Acc: 0.539 Test Loss: 1.564 Test Acc: 0.539
Validation loss decreased (-0.516650 --> -0.538873).  Saving model ...
Epoch: 15 cost time: 3.7398476600646973
Epoch: 15, Steps: 12 | Train Loss: 1.332 Vali Loss: 1.492 Vali Acc: 0.578 Test Loss: 1.492 Test Acc: 0.578
Validation loss decreased (-0.538873 --> -0.577763).  Saving model ...
Epoch: 16 cost time: 3.5707337856292725
Epoch: 16, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.424 Vali Acc: 0.600 Test Loss: 1.424 Test Acc: 0.600
Validation loss decreased (-0.577763 --> -0.599986).  Saving model ...
Epoch: 17 cost time: 3.5839381217956543
Epoch: 17, Steps: 12 | Train Loss: 1.186 Vali Loss: 1.359 Vali Acc: 0.611 Test Loss: 1.359 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611098).  Saving model ...
Epoch: 18 cost time: 3.7060632705688477
Epoch: 18, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.287 Vali Acc: 0.622 Test Loss: 1.287 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622209).  Saving model ...
Epoch: 19 cost time: 3.737041473388672
Epoch: 19, Steps: 12 | Train Loss: 1.031 Vali Loss: 1.233 Vali Acc: 0.639 Test Loss: 1.233 Test Acc: 0.639
Validation loss decreased (-0.622209 --> -0.638877).  Saving model ...
Epoch: 20 cost time: 3.5973927974700928
Epoch: 20, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.183 Vali Acc: 0.622 Test Loss: 1.183 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5908150672912598
Epoch: 21, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.136 Vali Acc: 0.661 Test Loss: 1.136 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661100).  Saving model ...
Epoch: 22 cost time: 3.7586090564727783
Epoch: 22, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.089 Vali Acc: 0.661 Test Loss: 1.089 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661100).  Saving model ...
Epoch: 23 cost time: 3.716811418533325
Epoch: 23, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.053 Vali Acc: 0.683 Test Loss: 1.053 Test Acc: 0.683
Validation loss decreased (-0.661100 --> -0.683323).  Saving model ...
Epoch: 24 cost time: 3.6359097957611084
Epoch: 24, Steps: 12 | Train Loss: 0.765 Vali Loss: 1.027 Vali Acc: 0.661 Test Loss: 1.027 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.5736045837402344
Epoch: 25, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.992 Vali Acc: 0.672 Test Loss: 0.992 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.726046323776245
Epoch: 26, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.975 Vali Acc: 0.683 Test Loss: 0.975 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683324).  Saving model ...
Epoch: 27 cost time: 3.680572986602783
Epoch: 27, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.949 Vali Acc: 0.706 Test Loss: 0.949 Test Acc: 0.706
Validation loss decreased (-0.683324 --> -0.705546).  Saving model ...
Epoch: 28 cost time: 3.553744316101074
Epoch: 28, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.911 Vali Acc: 0.700 Test Loss: 0.911 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.6120095252990723
Epoch: 29, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.889 Vali Acc: 0.683 Test Loss: 0.889 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.768730878829956
Epoch: 30, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.880 Vali Acc: 0.717 Test Loss: 0.880 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716658).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7166666666666667
model parameter : 178183
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.241347789764404
Epoch: 1, Steps: 12 | Train Loss: 2.856 Vali Loss: 2.769 Vali Acc: 0.083 Test Loss: 2.769 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 3.5249292850494385
Epoch: 2, Steps: 12 | Train Loss: 2.832 Vali Loss: 2.715 Vali Acc: 0.094 Test Loss: 2.715 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 3.5051584243774414
Epoch: 3, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.645 Vali Acc: 0.128 Test Loss: 2.645 Test Acc: 0.128
Validation loss decreased (-0.094417 --> -0.127751).  Saving model ...
Epoch: 4 cost time: 3.379082441329956
Epoch: 4, Steps: 12 | Train Loss: 2.687 Vali Loss: 2.567 Vali Acc: 0.217 Test Loss: 2.567 Test Acc: 0.217
Validation loss decreased (-0.127751 --> -0.216641).  Saving model ...
Epoch: 5 cost time: 3.421943426132202
Epoch: 5, Steps: 12 | Train Loss: 2.600 Vali Loss: 2.480 Vali Acc: 0.283 Test Loss: 2.480 Test Acc: 0.283
Validation loss decreased (-0.216641 --> -0.283309).  Saving model ...
Epoch: 6 cost time: 3.529557704925537
Epoch: 6, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.394 Vali Acc: 0.333 Test Loss: 2.394 Test Acc: 0.333
Validation loss decreased (-0.283309 --> -0.333309).  Saving model ...
Epoch: 7 cost time: 3.5819618701934814
Epoch: 7, Steps: 12 | Train Loss: 2.379 Vali Loss: 2.309 Vali Acc: 0.367 Test Loss: 2.309 Test Acc: 0.367
Validation loss decreased (-0.333309 --> -0.366644).  Saving model ...
Epoch: 8 cost time: 3.431861639022827
Epoch: 8, Steps: 12 | Train Loss: 2.290 Vali Loss: 2.225 Vali Acc: 0.389 Test Loss: 2.225 Test Acc: 0.389
Validation loss decreased (-0.366644 --> -0.388867).  Saving model ...
Epoch: 9 cost time: 3.476710319519043
Epoch: 9, Steps: 12 | Train Loss: 2.193 Vali Loss: 2.135 Vali Acc: 0.444 Test Loss: 2.135 Test Acc: 0.444
Validation loss decreased (-0.388867 --> -0.444423).  Saving model ...
Epoch: 10 cost time: 3.419132709503174
Epoch: 10, Steps: 12 | Train Loss: 2.065 Vali Loss: 2.046 Vali Acc: 0.494 Test Loss: 2.046 Test Acc: 0.494
Validation loss decreased (-0.444423 --> -0.494424).  Saving model ...
Epoch: 11 cost time: 3.667368173599243
Epoch: 11, Steps: 12 | Train Loss: 1.941 Vali Loss: 1.962 Vali Acc: 0.522 Test Loss: 1.962 Test Acc: 0.522
Validation loss decreased (-0.494424 --> -0.522203).  Saving model ...
Epoch: 12 cost time: 3.481748342514038
Epoch: 12, Steps: 12 | Train Loss: 1.831 Vali Loss: 1.873 Vali Acc: 0.539 Test Loss: 1.873 Test Acc: 0.539
Validation loss decreased (-0.522203 --> -0.538870).  Saving model ...
Epoch: 13 cost time: 3.428213119506836
Epoch: 13, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.777 Vali Acc: 0.556 Test Loss: 1.777 Test Acc: 0.556
Validation loss decreased (-0.538870 --> -0.555538).  Saving model ...
Epoch: 14 cost time: 3.4432249069213867
Epoch: 14, Steps: 12 | Train Loss: 1.630 Vali Loss: 1.697 Vali Acc: 0.539 Test Loss: 1.697 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4712791442871094
Epoch: 15, Steps: 12 | Train Loss: 1.537 Vali Loss: 1.622 Vali Acc: 0.544 Test Loss: 1.622 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3060574531555176
Epoch: 16, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.557 Vali Acc: 0.544 Test Loss: 1.557 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.310985565185547
Epoch: 17, Steps: 12 | Train Loss: 1.362 Vali Loss: 1.501 Vali Acc: 0.556 Test Loss: 1.501 Test Acc: 0.556
Validation loss decreased (-0.555538 --> -0.555541).  Saving model ...
Epoch: 18 cost time: 3.2913544178009033
Epoch: 18, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.445 Vali Acc: 0.567 Test Loss: 1.445 Test Acc: 0.567
Validation loss decreased (-0.555541 --> -0.566652).  Saving model ...
Epoch: 19 cost time: 3.4492149353027344
Epoch: 19, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.383 Vali Acc: 0.589 Test Loss: 1.383 Test Acc: 0.589
Validation loss decreased (-0.566652 --> -0.588875).  Saving model ...
Epoch: 20 cost time: 3.3415143489837646
Epoch: 20, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.346 Vali Acc: 0.567 Test Loss: 1.346 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3104968070983887
Epoch: 21, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.312 Vali Acc: 0.572 Test Loss: 1.312 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3386223316192627
Epoch: 22, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.263 Vali Acc: 0.628 Test Loss: 1.263 Test Acc: 0.628
Validation loss decreased (-0.588875 --> -0.627765).  Saving model ...
Epoch: 23 cost time: 3.534275531768799
Epoch: 23, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.233 Vali Acc: 0.639 Test Loss: 1.233 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 24 cost time: 3.3019754886627197
Epoch: 24, Steps: 12 | Train Loss: 0.949 Vali Loss: 1.205 Vali Acc: 0.644 Test Loss: 1.205 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644432).  Saving model ...
Epoch: 25 cost time: 3.335688591003418
Epoch: 25, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.163 Vali Acc: 0.628 Test Loss: 1.163 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.299031972885132
Epoch: 26, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.152 Vali Acc: 0.656 Test Loss: 1.152 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 27 cost time: 3.4605910778045654
Epoch: 27, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.156 Vali Acc: 0.639 Test Loss: 1.156 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.444708824157715
Epoch: 28, Steps: 12 | Train Loss: 0.820 Vali Loss: 1.088 Vali Acc: 0.639 Test Loss: 1.088 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2782387733459473
Epoch: 29, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.082 Vali Acc: 0.617 Test Loss: 1.082 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.226292371749878
Epoch: 30, Steps: 12 | Train Loss: 0.764 Vali Loss: 1.069 Vali Acc: 0.639 Test Loss: 1.069 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6555555555555556
model parameter : 592199
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.386126279830933
Epoch: 1, Steps: 12 | Train Loss: 2.676 Vali Loss: 2.655 Vali Acc: 0.100 Test Loss: 2.655 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 2.7888054847717285
Epoch: 2, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.611 Vali Acc: 0.111 Test Loss: 2.611 Test Acc: 0.111
Validation loss decreased (-0.099973 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 2.7753710746765137
Epoch: 3, Steps: 12 | Train Loss: 2.621 Vali Loss: 2.554 Vali Acc: 0.172 Test Loss: 2.554 Test Acc: 0.172
Validation loss decreased (-0.111085 --> -0.172197).  Saving model ...
Epoch: 4 cost time: 3.1407203674316406
Epoch: 4, Steps: 12 | Train Loss: 2.560 Vali Loss: 2.493 Vali Acc: 0.250 Test Loss: 2.493 Test Acc: 0.250
Validation loss decreased (-0.172197 --> -0.249975).  Saving model ...
Epoch: 5 cost time: 2.856743335723877
Epoch: 5, Steps: 12 | Train Loss: 2.449 Vali Loss: 2.427 Vali Acc: 0.300 Test Loss: 2.427 Test Acc: 0.300
Validation loss decreased (-0.249975 --> -0.299976).  Saving model ...
Epoch: 6 cost time: 2.798302173614502
Epoch: 6, Steps: 12 | Train Loss: 2.380 Vali Loss: 2.344 Vali Acc: 0.356 Test Loss: 2.344 Test Acc: 0.356
Validation loss decreased (-0.299976 --> -0.355532).  Saving model ...
Epoch: 7 cost time: 2.799586296081543
Epoch: 7, Steps: 12 | Train Loss: 2.297 Vali Loss: 2.252 Vali Acc: 0.411 Test Loss: 2.252 Test Acc: 0.411
Validation loss decreased (-0.355532 --> -0.411089).  Saving model ...
Epoch: 8 cost time: 2.9790241718292236
Epoch: 8, Steps: 12 | Train Loss: 2.205 Vali Loss: 2.155 Vali Acc: 0.472 Test Loss: 2.155 Test Acc: 0.472
Validation loss decreased (-0.411089 --> -0.472201).  Saving model ...
Epoch: 9 cost time: 2.9984941482543945
Epoch: 9, Steps: 12 | Train Loss: 2.098 Vali Loss: 2.064 Vali Acc: 0.472 Test Loss: 2.064 Test Acc: 0.472
Validation loss decreased (-0.472201 --> -0.472202).  Saving model ...
Epoch: 10 cost time: 2.845566987991333
Epoch: 10, Steps: 12 | Train Loss: 1.993 Vali Loss: 1.975 Vali Acc: 0.494 Test Loss: 1.975 Test Acc: 0.494
Validation loss decreased (-0.472202 --> -0.494425).  Saving model ...
Epoch: 11 cost time: 2.799490451812744
Epoch: 11, Steps: 12 | Train Loss: 1.897 Vali Loss: 1.887 Vali Acc: 0.511 Test Loss: 1.887 Test Acc: 0.511
Validation loss decreased (-0.494425 --> -0.511092).  Saving model ...
Epoch: 12 cost time: 2.8040013313293457
Epoch: 12, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.806 Vali Acc: 0.517 Test Loss: 1.806 Test Acc: 0.517
Validation loss decreased (-0.511092 --> -0.516649).  Saving model ...
Epoch: 13 cost time: 3.0137112140655518
Epoch: 13, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.727 Vali Acc: 0.522 Test Loss: 1.727 Test Acc: 0.522
Validation loss decreased (-0.516649 --> -0.522205).  Saving model ...
Epoch: 14 cost time: 2.904716968536377
Epoch: 14, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.651 Vali Acc: 0.522 Test Loss: 1.651 Test Acc: 0.522
Validation loss decreased (-0.522205 --> -0.522206).  Saving model ...
Epoch: 15 cost time: 2.89813494682312
Epoch: 15, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.579 Vali Acc: 0.544 Test Loss: 1.579 Test Acc: 0.544
Validation loss decreased (-0.522206 --> -0.544429).  Saving model ...
Epoch: 16 cost time: 2.857614755630493
Epoch: 16, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.506 Vali Acc: 0.561 Test Loss: 1.506 Test Acc: 0.561
Validation loss decreased (-0.544429 --> -0.561096).  Saving model ...
Epoch: 17 cost time: 3.0018162727355957
Epoch: 17, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.429 Vali Acc: 0.594 Test Loss: 1.429 Test Acc: 0.594
Validation loss decreased (-0.561096 --> -0.594430).  Saving model ...
Epoch: 18 cost time: 2.987556219100952
Epoch: 18, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.362 Vali Acc: 0.600 Test Loss: 1.362 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599986).  Saving model ...
Epoch: 19 cost time: 2.831789493560791
Epoch: 19, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.313 Vali Acc: 0.600 Test Loss: 1.313 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 20 cost time: 2.8067736625671387
Epoch: 20, Steps: 12 | Train Loss: 1.121 Vali Loss: 1.263 Vali Acc: 0.606 Test Loss: 1.263 Test Acc: 0.606
Validation loss decreased (-0.599987 --> -0.605543).  Saving model ...
Epoch: 21 cost time: 2.849161386489868
Epoch: 21, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.216 Vali Acc: 0.622 Test Loss: 1.216 Test Acc: 0.622
Validation loss decreased (-0.605543 --> -0.622210).  Saving model ...
Epoch: 22 cost time: 2.8535852432250977
Epoch: 22, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.169 Vali Acc: 0.644 Test Loss: 1.169 Test Acc: 0.644
Validation loss decreased (-0.622210 --> -0.644433).  Saving model ...
Epoch: 23 cost time: 2.677325963973999
Epoch: 23, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.121 Vali Acc: 0.633 Test Loss: 1.121 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.719127655029297
Epoch: 24, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.070 Vali Acc: 0.661 Test Loss: 1.070 Test Acc: 0.661
Validation loss decreased (-0.644433 --> -0.661100).  Saving model ...
Epoch: 25 cost time: 3.1010801792144775
Epoch: 25, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.035 Vali Acc: 0.672 Test Loss: 1.035 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672212).  Saving model ...
Epoch: 26 cost time: 3.0548369884490967
Epoch: 26, Steps: 12 | Train Loss: 0.812 Vali Loss: 1.005 Vali Acc: 0.667 Test Loss: 1.005 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.951798915863037
Epoch: 27, Steps: 12 | Train Loss: 0.778 Vali Loss: 0.989 Vali Acc: 0.678 Test Loss: 0.989 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 28 cost time: 2.863548517227173
Epoch: 28, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.956 Vali Acc: 0.678 Test Loss: 0.956 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677768).  Saving model ...
Epoch: 29 cost time: 2.930636167526245
Epoch: 29, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.923 Vali Acc: 0.683 Test Loss: 0.923 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683324).  Saving model ...
Epoch: 30 cost time: 3.117901563644409
Epoch: 30, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.904 Vali Acc: 0.683 Test Loss: 0.904 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683324).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6833333333333333
model parameter : 178183
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.471089839935303
Epoch: 1, Steps: 12 | Train Loss: 2.852 Vali Loss: 2.771 Vali Acc: 0.083 Test Loss: 2.771 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 2.5176002979278564
Epoch: 2, Steps: 12 | Train Loss: 2.833 Vali Loss: 2.724 Vali Acc: 0.089 Test Loss: 2.724 Test Acc: 0.089
Validation loss decreased (-0.083306 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 2.7081356048583984
Epoch: 3, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.666 Vali Acc: 0.117 Test Loss: 2.666 Test Acc: 0.117
Validation loss decreased (-0.088862 --> -0.116640).  Saving model ...
Epoch: 4 cost time: 2.8300514221191406
Epoch: 4, Steps: 12 | Train Loss: 2.712 Vali Loss: 2.599 Vali Acc: 0.217 Test Loss: 2.599 Test Acc: 0.217
Validation loss decreased (-0.116640 --> -0.216641).  Saving model ...
Epoch: 5 cost time: 2.576242208480835
Epoch: 5, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.525 Vali Acc: 0.272 Test Loss: 2.525 Test Acc: 0.272
Validation loss decreased (-0.216641 --> -0.272197).  Saving model ...
Epoch: 6 cost time: 2.5997354984283447
Epoch: 6, Steps: 12 | Train Loss: 2.577 Vali Loss: 2.457 Vali Acc: 0.311 Test Loss: 2.457 Test Acc: 0.311
Validation loss decreased (-0.272197 --> -0.311087).  Saving model ...
Epoch: 7 cost time: 2.7269418239593506
Epoch: 7, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.391 Vali Acc: 0.328 Test Loss: 2.391 Test Acc: 0.328
Validation loss decreased (-0.311087 --> -0.327754).  Saving model ...
Epoch: 8 cost time: 2.5956106185913086
Epoch: 8, Steps: 12 | Train Loss: 2.376 Vali Loss: 2.323 Vali Acc: 0.344 Test Loss: 2.323 Test Acc: 0.344
Validation loss decreased (-0.327754 --> -0.344421).  Saving model ...
Epoch: 9 cost time: 2.786214828491211
Epoch: 9, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.258 Vali Acc: 0.394 Test Loss: 2.258 Test Acc: 0.394
Validation loss decreased (-0.344421 --> -0.394422).  Saving model ...
Epoch: 10 cost time: 2.796315908432007
Epoch: 10, Steps: 12 | Train Loss: 2.219 Vali Loss: 2.192 Vali Acc: 0.433 Test Loss: 2.192 Test Acc: 0.433
Validation loss decreased (-0.394422 --> -0.433311).  Saving model ...
Epoch: 11 cost time: 2.6755802631378174
Epoch: 11, Steps: 12 | Train Loss: 2.116 Vali Loss: 2.130 Vali Acc: 0.467 Test Loss: 2.130 Test Acc: 0.467
Validation loss decreased (-0.433311 --> -0.466645).  Saving model ...
Epoch: 12 cost time: 2.5969183444976807
Epoch: 12, Steps: 12 | Train Loss: 2.040 Vali Loss: 2.064 Vali Acc: 0.478 Test Loss: 2.064 Test Acc: 0.478
Validation loss decreased (-0.466645 --> -0.477757).  Saving model ...
Epoch: 13 cost time: 2.7003095149993896
Epoch: 13, Steps: 12 | Train Loss: 1.932 Vali Loss: 1.995 Vali Acc: 0.494 Test Loss: 1.995 Test Acc: 0.494
Validation loss decreased (-0.477757 --> -0.494424).  Saving model ...
Epoch: 14 cost time: 2.6248254776000977
Epoch: 14, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.930 Vali Acc: 0.500 Test Loss: 1.930 Test Acc: 0.500
Validation loss decreased (-0.494424 --> -0.499981).  Saving model ...
Epoch: 15 cost time: 2.7600951194763184
Epoch: 15, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.865 Vali Acc: 0.517 Test Loss: 1.865 Test Acc: 0.517
Validation loss decreased (-0.499981 --> -0.516648).  Saving model ...
Epoch: 16 cost time: 2.792815685272217
Epoch: 16, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.802 Vali Acc: 0.539 Test Loss: 1.802 Test Acc: 0.539
Validation loss decreased (-0.516648 --> -0.538871).  Saving model ...
Epoch: 17 cost time: 2.6763668060302734
Epoch: 17, Steps: 12 | Train Loss: 1.616 Vali Loss: 1.748 Vali Acc: 0.522 Test Loss: 1.748 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6425671577453613
Epoch: 18, Steps: 12 | Train Loss: 1.573 Vali Loss: 1.687 Vali Acc: 0.533 Test Loss: 1.687 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6927943229675293
Epoch: 19, Steps: 12 | Train Loss: 1.593 Vali Loss: 1.630 Vali Acc: 0.528 Test Loss: 1.630 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.610260248184204
Epoch: 20, Steps: 12 | Train Loss: 1.406 Vali Loss: 1.601 Vali Acc: 0.528 Test Loss: 1.601 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.7479772567749023
Epoch: 21, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.546 Vali Acc: 0.539 Test Loss: 1.546 Test Acc: 0.539
Validation loss decreased (-0.538871 --> -0.538873).  Saving model ...
Epoch: 22 cost time: 2.812260150909424
Epoch: 22, Steps: 12 | Train Loss: 1.322 Vali Loss: 1.484 Vali Acc: 0.556 Test Loss: 1.484 Test Acc: 0.556
Validation loss decreased (-0.538873 --> -0.555541).  Saving model ...
Epoch: 23 cost time: 2.6660428047180176
Epoch: 23, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.445 Vali Acc: 0.561 Test Loss: 1.445 Test Acc: 0.561
Validation loss decreased (-0.555541 --> -0.561097).  Saving model ...
Epoch: 24 cost time: 2.6311662197113037
Epoch: 24, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.415 Vali Acc: 0.578 Test Loss: 1.415 Test Acc: 0.578
Validation loss decreased (-0.561097 --> -0.577764).  Saving model ...
Epoch: 25 cost time: 2.676187038421631
Epoch: 25, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.367 Vali Acc: 0.561 Test Loss: 1.367 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6312310695648193
Epoch: 26, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.347 Vali Acc: 0.550 Test Loss: 1.347 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.743100166320801
Epoch: 27, Steps: 12 | Train Loss: 1.087 Vali Loss: 1.330 Vali Acc: 0.561 Test Loss: 1.330 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.772831439971924
Epoch: 28, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.251 Vali Acc: 0.589 Test Loss: 1.251 Test Acc: 0.589
Validation loss decreased (-0.577764 --> -0.588876).  Saving model ...
Epoch: 29 cost time: 2.5857365131378174
Epoch: 29, Steps: 12 | Train Loss: 1.012 Vali Loss: 1.241 Vali Acc: 0.572 Test Loss: 1.241 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.623899221420288
Epoch: 30, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.195 Vali Acc: 0.600 Test Loss: 1.195 Test Acc: 0.600
Validation loss decreased (-0.588876 --> -0.599988).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6
model parameter : 592199
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.280035018920898
Epoch: 1, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.669 Vali Acc: 0.083 Test Loss: 2.669 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 2.525618553161621
Epoch: 2, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.636 Vali Acc: 0.094 Test Loss: 2.636 Test Acc: 0.094
Validation loss decreased (-0.083307 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 2.373366594314575
Epoch: 3, Steps: 12 | Train Loss: 2.640 Vali Loss: 2.590 Vali Acc: 0.144 Test Loss: 2.590 Test Acc: 0.144
Validation loss decreased (-0.094418 --> -0.144419).  Saving model ...
Epoch: 4 cost time: 2.3475725650787354
Epoch: 4, Steps: 12 | Train Loss: 2.588 Vali Loss: 2.542 Vali Acc: 0.200 Test Loss: 2.542 Test Acc: 0.200
Validation loss decreased (-0.144419 --> -0.199975).  Saving model ...
Epoch: 5 cost time: 2.400900363922119
Epoch: 5, Steps: 12 | Train Loss: 2.496 Vali Loss: 2.494 Vali Acc: 0.239 Test Loss: 2.494 Test Acc: 0.239
Validation loss decreased (-0.199975 --> -0.238864).  Saving model ...
Epoch: 6 cost time: 2.4947869777679443
Epoch: 6, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.438 Vali Acc: 0.272 Test Loss: 2.438 Test Acc: 0.272
Validation loss decreased (-0.238864 --> -0.272198).  Saving model ...
Epoch: 7 cost time: 2.4618849754333496
Epoch: 7, Steps: 12 | Train Loss: 2.389 Vali Loss: 2.383 Vali Acc: 0.289 Test Loss: 2.383 Test Acc: 0.289
Validation loss decreased (-0.272198 --> -0.288865).  Saving model ...
Epoch: 8 cost time: 2.5105762481689453
Epoch: 8, Steps: 12 | Train Loss: 2.310 Vali Loss: 2.322 Vali Acc: 0.344 Test Loss: 2.322 Test Acc: 0.344
Validation loss decreased (-0.288865 --> -0.344421).  Saving model ...
Epoch: 9 cost time: 2.3418781757354736
Epoch: 9, Steps: 12 | Train Loss: 2.228 Vali Loss: 2.262 Vali Acc: 0.378 Test Loss: 2.262 Test Acc: 0.378
Validation loss decreased (-0.344421 --> -0.377755).  Saving model ...
Epoch: 10 cost time: 2.3573758602142334
Epoch: 10, Steps: 12 | Train Loss: 2.134 Vali Loss: 2.194 Vali Acc: 0.406 Test Loss: 2.194 Test Acc: 0.406
Validation loss decreased (-0.377755 --> -0.405534).  Saving model ...
Epoch: 11 cost time: 2.341529369354248
Epoch: 11, Steps: 12 | Train Loss: 2.056 Vali Loss: 2.121 Vali Acc: 0.456 Test Loss: 2.121 Test Acc: 0.456
Validation loss decreased (-0.405534 --> -0.455534).  Saving model ...
Epoch: 12 cost time: 2.4202017784118652
Epoch: 12, Steps: 12 | Train Loss: 1.960 Vali Loss: 2.049 Vali Acc: 0.472 Test Loss: 2.049 Test Acc: 0.472
Validation loss decreased (-0.455534 --> -0.472202).  Saving model ...
Epoch: 13 cost time: 2.365354299545288
Epoch: 13, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.976 Vali Acc: 0.483 Test Loss: 1.976 Test Acc: 0.483
Validation loss decreased (-0.472202 --> -0.483314).  Saving model ...
Epoch: 14 cost time: 2.5010290145874023
Epoch: 14, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.904 Vali Acc: 0.506 Test Loss: 1.904 Test Acc: 0.506
Validation loss decreased (-0.483314 --> -0.505537).  Saving model ...
Epoch: 15 cost time: 2.2509546279907227
Epoch: 15, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.833 Vali Acc: 0.506 Test Loss: 1.833 Test Acc: 0.506
Validation loss decreased (-0.505537 --> -0.505537).  Saving model ...
Epoch: 16 cost time: 2.2175941467285156
Epoch: 16, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.758 Vali Acc: 0.528 Test Loss: 1.758 Test Acc: 0.528
Validation loss decreased (-0.505537 --> -0.527760).  Saving model ...
Epoch: 17 cost time: 2.341744899749756
Epoch: 17, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.689 Vali Acc: 0.539 Test Loss: 1.689 Test Acc: 0.539
Validation loss decreased (-0.527760 --> -0.538872).  Saving model ...
Epoch: 18 cost time: 2.451688528060913
Epoch: 18, Steps: 12 | Train Loss: 1.443 Vali Loss: 1.625 Vali Acc: 0.550 Test Loss: 1.625 Test Acc: 0.550
Validation loss decreased (-0.538872 --> -0.549984).  Saving model ...
Epoch: 19 cost time: 2.3712873458862305
Epoch: 19, Steps: 12 | Train Loss: 1.335 Vali Loss: 1.569 Vali Acc: 0.533 Test Loss: 1.569 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.396296501159668
Epoch: 20, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.519 Vali Acc: 0.528 Test Loss: 1.519 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3819007873535156
Epoch: 21, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.474 Vali Acc: 0.539 Test Loss: 1.474 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.27506160736084
Epoch: 22, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.433 Vali Acc: 0.544 Test Loss: 1.433 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.186436653137207
Epoch: 23, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.398 Vali Acc: 0.544 Test Loss: 1.398 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.4578359127044678
Epoch: 24, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.353 Vali Acc: 0.556 Test Loss: 1.353 Test Acc: 0.556
Validation loss decreased (-0.549984 --> -0.555542).  Saving model ...
Epoch: 25 cost time: 2.4298532009124756
Epoch: 25, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.318 Vali Acc: 0.550 Test Loss: 1.318 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3239173889160156
Epoch: 26, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.288 Vali Acc: 0.544 Test Loss: 1.288 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.301208257675171
Epoch: 27, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.257 Vali Acc: 0.539 Test Loss: 1.257 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.285067081451416
Epoch: 28, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.229 Vali Acc: 0.567 Test Loss: 1.229 Test Acc: 0.567
Validation loss decreased (-0.555542 --> -0.566654).  Saving model ...
Epoch: 29 cost time: 2.268925189971924
Epoch: 29, Steps: 12 | Train Loss: 0.853 Vali Loss: 1.202 Vali Acc: 0.567 Test Loss: 1.202 Test Acc: 0.567
Validation loss decreased (-0.566654 --> -0.566655).  Saving model ...
Epoch: 30 cost time: 2.444065809249878
Epoch: 30, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.178 Vali Acc: 0.572 Test Loss: 1.178 Test Acc: 0.572
Validation loss decreased (-0.566655 --> -0.572210).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 178183
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.805294036865234
Epoch: 1, Steps: 12 | Train Loss: 2.778 Vali Loss: 2.752 Vali Acc: 0.050 Test Loss: 2.752 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 3.8295300006866455
Epoch: 2, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.705 Vali Acc: 0.056 Test Loss: 2.705 Test Acc: 0.056
Validation loss decreased (-0.049972 --> -0.055529).  Saving model ...
Epoch: 3 cost time: 4.255306720733643
Epoch: 3, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.644 Vali Acc: 0.094 Test Loss: 2.644 Test Acc: 0.094
Validation loss decreased (-0.055529 --> -0.094418).  Saving model ...
Epoch: 4 cost time: 4.198234796524048
Epoch: 4, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.573 Vali Acc: 0.156 Test Loss: 2.573 Test Acc: 0.156
Validation loss decreased (-0.094418 --> -0.155530).  Saving model ...
Epoch: 5 cost time: 4.101086854934692
Epoch: 5, Steps: 12 | Train Loss: 2.558 Vali Loss: 2.491 Vali Acc: 0.228 Test Loss: 2.491 Test Acc: 0.228
Validation loss decreased (-0.155530 --> -0.227753).  Saving model ...
Epoch: 6 cost time: 4.076949119567871
Epoch: 6, Steps: 12 | Train Loss: 2.429 Vali Loss: 2.406 Vali Acc: 0.300 Test Loss: 2.406 Test Acc: 0.300
Validation loss decreased (-0.227753 --> -0.299976).  Saving model ...
Epoch: 7 cost time: 4.234961748123169
Epoch: 7, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.314 Vali Acc: 0.356 Test Loss: 2.314 Test Acc: 0.356
Validation loss decreased (-0.299976 --> -0.355532).  Saving model ...
Epoch: 8 cost time: 4.239983320236206
Epoch: 8, Steps: 12 | Train Loss: 2.264 Vali Loss: 2.216 Vali Acc: 0.383 Test Loss: 2.216 Test Acc: 0.383
Validation loss decreased (-0.355532 --> -0.383311).  Saving model ...
Epoch: 9 cost time: 3.9113550186157227
Epoch: 9, Steps: 12 | Train Loss: 2.136 Vali Loss: 2.107 Vali Acc: 0.428 Test Loss: 2.107 Test Acc: 0.428
Validation loss decreased (-0.383311 --> -0.427757).  Saving model ...
Epoch: 10 cost time: 3.7961301803588867
Epoch: 10, Steps: 12 | Train Loss: 2.011 Vali Loss: 1.995 Vali Acc: 0.483 Test Loss: 1.995 Test Acc: 0.483
Validation loss decreased (-0.427757 --> -0.483313).  Saving model ...
Epoch: 11 cost time: 4.071270704269409
Epoch: 11, Steps: 12 | Train Loss: 1.864 Vali Loss: 1.870 Vali Acc: 0.522 Test Loss: 1.870 Test Acc: 0.522
Validation loss decreased (-0.483313 --> -0.522204).  Saving model ...
Epoch: 12 cost time: 4.0460045337677
Epoch: 12, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.752 Vali Acc: 0.556 Test Loss: 1.752 Test Acc: 0.556
Validation loss decreased (-0.522204 --> -0.555538).  Saving model ...
Epoch: 13 cost time: 3.8039915561676025
Epoch: 13, Steps: 12 | Train Loss: 1.610 Vali Loss: 1.642 Vali Acc: 0.572 Test Loss: 1.642 Test Acc: 0.572
Validation loss decreased (-0.555538 --> -0.572206).  Saving model ...
Epoch: 14 cost time: 3.8650190830230713
Epoch: 14, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.544 Vali Acc: 0.578 Test Loss: 1.544 Test Acc: 0.578
Validation loss decreased (-0.572206 --> -0.577762).  Saving model ...
Epoch: 15 cost time: 3.8835835456848145
Epoch: 15, Steps: 12 | Train Loss: 1.406 Vali Loss: 1.454 Vali Acc: 0.578 Test Loss: 1.454 Test Acc: 0.578
Validation loss decreased (-0.577762 --> -0.577763).  Saving model ...
Epoch: 16 cost time: 3.5270893573760986
Epoch: 16, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.374 Vali Acc: 0.606 Test Loss: 1.374 Test Acc: 0.606
Validation loss decreased (-0.577763 --> -0.605542).  Saving model ...
Epoch: 17 cost time: 3.93424391746521
Epoch: 17, Steps: 12 | Train Loss: 1.208 Vali Loss: 1.307 Vali Acc: 0.600 Test Loss: 1.307 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.995620012283325
Epoch: 18, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.240 Vali Acc: 0.617 Test Loss: 1.240 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616654).  Saving model ...
Epoch: 19 cost time: 3.843757390975952
Epoch: 19, Steps: 12 | Train Loss: 1.046 Vali Loss: 1.191 Vali Acc: 0.622 Test Loss: 1.191 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 20 cost time: 3.7552762031555176
Epoch: 20, Steps: 12 | Train Loss: 0.953 Vali Loss: 1.143 Vali Acc: 0.639 Test Loss: 1.143 Test Acc: 0.639
Validation loss decreased (-0.622210 --> -0.638877).  Saving model ...
Epoch: 21 cost time: 3.8722681999206543
Epoch: 21, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.100 Vali Acc: 0.639 Test Loss: 1.100 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638878).  Saving model ...
Epoch: 22 cost time: 3.723626136779785
Epoch: 22, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.051 Vali Acc: 0.689 Test Loss: 1.051 Test Acc: 0.689
Validation loss decreased (-0.638878 --> -0.688878).  Saving model ...
Epoch: 23 cost time: 3.757693290710449
Epoch: 23, Steps: 12 | Train Loss: 0.815 Vali Loss: 1.030 Vali Acc: 0.678 Test Loss: 1.030 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.894040107727051
Epoch: 24, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.004 Vali Acc: 0.667 Test Loss: 1.004 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.718744993209839
Epoch: 25, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.967 Vali Acc: 0.683 Test Loss: 0.967 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.5202293395996094
Epoch: 26, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.941 Vali Acc: 0.689 Test Loss: 0.941 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688879).  Saving model ...
Epoch: 27 cost time: 3.8240530490875244
Epoch: 27, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.928 Vali Acc: 0.700 Test Loss: 0.928 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699991).  Saving model ...
Epoch: 28 cost time: 3.8946285247802734
Epoch: 28, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.899 Vali Acc: 0.700 Test Loss: 0.899 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 29 cost time: 3.70231032371521
Epoch: 29, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.877 Vali Acc: 0.717 Test Loss: 0.877 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716658).  Saving model ...
Epoch: 30 cost time: 3.7226316928863525
Epoch: 30, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.864 Vali Acc: 0.706 Test Loss: 0.864 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7166666666666667
model parameter : 298951
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.851262807846069
Epoch: 1, Steps: 12 | Train Loss: 2.785 Vali Loss: 2.773 Vali Acc: 0.106 Test Loss: 2.773 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 3.0641162395477295
Epoch: 2, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.725 Vali Acc: 0.133 Test Loss: 2.725 Test Acc: 0.133
Validation loss decreased (-0.105528 --> -0.133306).  Saving model ...
Epoch: 3 cost time: 3.1506998538970947
Epoch: 3, Steps: 12 | Train Loss: 2.695 Vali Loss: 2.661 Vali Acc: 0.144 Test Loss: 2.661 Test Acc: 0.144
Validation loss decreased (-0.133306 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 3.029998540878296
Epoch: 4, Steps: 12 | Train Loss: 2.573 Vali Loss: 2.585 Vali Acc: 0.178 Test Loss: 2.585 Test Acc: 0.178
Validation loss decreased (-0.144418 --> -0.177752).  Saving model ...
Epoch: 5 cost time: 3.032522201538086
Epoch: 5, Steps: 12 | Train Loss: 2.480 Vali Loss: 2.501 Vali Acc: 0.211 Test Loss: 2.501 Test Acc: 0.211
Validation loss decreased (-0.177752 --> -0.211086).  Saving model ...
Epoch: 6 cost time: 3.120410919189453
Epoch: 6, Steps: 12 | Train Loss: 2.386 Vali Loss: 2.415 Vali Acc: 0.267 Test Loss: 2.415 Test Acc: 0.267
Validation loss decreased (-0.211086 --> -0.266643).  Saving model ...
Epoch: 7 cost time: 3.1811652183532715
Epoch: 7, Steps: 12 | Train Loss: 2.295 Vali Loss: 2.325 Vali Acc: 0.294 Test Loss: 2.325 Test Acc: 0.294
Validation loss decreased (-0.266643 --> -0.294421).  Saving model ...
Epoch: 8 cost time: 2.953261375427246
Epoch: 8, Steps: 12 | Train Loss: 2.215 Vali Loss: 2.234 Vali Acc: 0.344 Test Loss: 2.234 Test Acc: 0.344
Validation loss decreased (-0.294421 --> -0.344422).  Saving model ...
Epoch: 9 cost time: 3.123473882675171
Epoch: 9, Steps: 12 | Train Loss: 2.123 Vali Loss: 2.141 Vali Acc: 0.394 Test Loss: 2.141 Test Acc: 0.394
Validation loss decreased (-0.344422 --> -0.394423).  Saving model ...
Epoch: 10 cost time: 3.2062203884124756
Epoch: 10, Steps: 12 | Train Loss: 1.998 Vali Loss: 2.051 Vali Acc: 0.439 Test Loss: 2.051 Test Acc: 0.439
Validation loss decreased (-0.394423 --> -0.438868).  Saving model ...
Epoch: 11 cost time: 3.1609702110290527
Epoch: 11, Steps: 12 | Train Loss: 1.858 Vali Loss: 1.956 Vali Acc: 0.456 Test Loss: 1.956 Test Acc: 0.456
Validation loss decreased (-0.438868 --> -0.455536).  Saving model ...
Epoch: 12 cost time: 3.094060182571411
Epoch: 12, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.863 Vali Acc: 0.483 Test Loss: 1.863 Test Acc: 0.483
Validation loss decreased (-0.455536 --> -0.483315).  Saving model ...
Epoch: 13 cost time: 2.958310604095459
Epoch: 13, Steps: 12 | Train Loss: 1.674 Vali Loss: 1.773 Vali Acc: 0.489 Test Loss: 1.773 Test Acc: 0.489
Validation loss decreased (-0.483315 --> -0.488871).  Saving model ...
Epoch: 14 cost time: 3.3869876861572266
Epoch: 14, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.689 Vali Acc: 0.511 Test Loss: 1.689 Test Acc: 0.511
Validation loss decreased (-0.488871 --> -0.511094).  Saving model ...
Epoch: 15 cost time: 3.171308994293213
Epoch: 15, Steps: 12 | Train Loss: 1.447 Vali Loss: 1.606 Vali Acc: 0.561 Test Loss: 1.606 Test Acc: 0.561
Validation loss decreased (-0.511094 --> -0.561095).  Saving model ...
Epoch: 16 cost time: 3.1782567501068115
Epoch: 16, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.528 Vali Acc: 0.544 Test Loss: 1.528 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.280341625213623
Epoch: 17, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.454 Vali Acc: 0.561 Test Loss: 1.454 Test Acc: 0.561
Validation loss decreased (-0.561095 --> -0.561097).  Saving model ...
Epoch: 18 cost time: 3.165221691131592
Epoch: 18, Steps: 12 | Train Loss: 1.346 Vali Loss: 1.389 Vali Acc: 0.589 Test Loss: 1.389 Test Acc: 0.589
Validation loss decreased (-0.561097 --> -0.588875).  Saving model ...
Epoch: 19 cost time: 3.111720085144043
Epoch: 19, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.327 Vali Acc: 0.600 Test Loss: 1.327 Test Acc: 0.600
Validation loss decreased (-0.588875 --> -0.599987).  Saving model ...
Epoch: 20 cost time: 3.0219366550445557
Epoch: 20, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.260 Vali Acc: 0.617 Test Loss: 1.260 Test Acc: 0.617
Validation loss decreased (-0.599987 --> -0.616654).  Saving model ...
Epoch: 21 cost time: 3.195279121398926
Epoch: 21, Steps: 12 | Train Loss: 1.019 Vali Loss: 1.209 Vali Acc: 0.633 Test Loss: 1.209 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633321).  Saving model ...
Epoch: 22 cost time: 3.2061235904693604
Epoch: 22, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.156 Vali Acc: 0.639 Test Loss: 1.156 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 23 cost time: 3.1506764888763428
Epoch: 23, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.111 Vali Acc: 0.683 Test Loss: 1.111 Test Acc: 0.683
Validation loss decreased (-0.638877 --> -0.683322).  Saving model ...
Epoch: 24 cost time: 3.2893922328948975
Epoch: 24, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.075 Vali Acc: 0.678 Test Loss: 1.075 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3584554195404053
Epoch: 25, Steps: 12 | Train Loss: 0.820 Vali Loss: 1.038 Vali Acc: 0.689 Test Loss: 1.038 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688879).  Saving model ...
Epoch: 26 cost time: 3.009160280227661
Epoch: 26, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.008 Vali Acc: 0.683 Test Loss: 1.008 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0281848907470703
Epoch: 27, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.983 Vali Acc: 0.689 Test Loss: 0.983 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 28 cost time: 3.194890022277832
Epoch: 28, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.962 Vali Acc: 0.689 Test Loss: 0.962 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 29 cost time: 3.1886532306671143
Epoch: 29, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.934 Vali Acc: 0.683 Test Loss: 0.934 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.07983660697937
Epoch: 30, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.911 Vali Acc: 0.700 Test Loss: 0.911 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699991).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7
model parameter : 91911
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.895280122756958
Epoch: 1, Steps: 12 | Train Loss: 2.777 Vali Loss: 2.752 Vali Acc: 0.050 Test Loss: 2.752 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 2.9375710487365723
Epoch: 2, Steps: 12 | Train Loss: 2.782 Vali Loss: 2.709 Vali Acc: 0.056 Test Loss: 2.709 Test Acc: 0.056
Validation loss decreased (-0.049972 --> -0.055528).  Saving model ...
Epoch: 3 cost time: 2.8465442657470703
Epoch: 3, Steps: 12 | Train Loss: 2.700 Vali Loss: 2.651 Vali Acc: 0.100 Test Loss: 2.651 Test Acc: 0.100
Validation loss decreased (-0.055528 --> -0.099973).  Saving model ...
Epoch: 4 cost time: 3.1039743423461914
Epoch: 4, Steps: 12 | Train Loss: 2.638 Vali Loss: 2.584 Vali Acc: 0.161 Test Loss: 2.584 Test Acc: 0.161
Validation loss decreased (-0.099973 --> -0.161085).  Saving model ...
Epoch: 5 cost time: 3.0500648021698
Epoch: 5, Steps: 12 | Train Loss: 2.580 Vali Loss: 2.510 Vali Acc: 0.211 Test Loss: 2.510 Test Acc: 0.211
Validation loss decreased (-0.161085 --> -0.211086).  Saving model ...
Epoch: 6 cost time: 2.9356906414031982
Epoch: 6, Steps: 12 | Train Loss: 2.473 Vali Loss: 2.432 Vali Acc: 0.283 Test Loss: 2.432 Test Acc: 0.283
Validation loss decreased (-0.211086 --> -0.283309).  Saving model ...
Epoch: 7 cost time: 2.9188332557678223
Epoch: 7, Steps: 12 | Train Loss: 2.396 Vali Loss: 2.350 Vali Acc: 0.333 Test Loss: 2.350 Test Acc: 0.333
Validation loss decreased (-0.283309 --> -0.333310).  Saving model ...
Epoch: 8 cost time: 3.1142990589141846
Epoch: 8, Steps: 12 | Train Loss: 2.339 Vali Loss: 2.258 Vali Acc: 0.361 Test Loss: 2.258 Test Acc: 0.361
Validation loss decreased (-0.333310 --> -0.361089).  Saving model ...
Epoch: 9 cost time: 2.9076454639434814
Epoch: 9, Steps: 12 | Train Loss: 2.201 Vali Loss: 2.156 Vali Acc: 0.433 Test Loss: 2.156 Test Acc: 0.433
Validation loss decreased (-0.361089 --> -0.433312).  Saving model ...
Epoch: 10 cost time: 2.9906222820281982
Epoch: 10, Steps: 12 | Train Loss: 2.086 Vali Loss: 2.052 Vali Acc: 0.450 Test Loss: 2.052 Test Acc: 0.450
Validation loss decreased (-0.433312 --> -0.449979).  Saving model ...
Epoch: 11 cost time: 2.943105459213257
Epoch: 11, Steps: 12 | Train Loss: 1.943 Vali Loss: 1.943 Vali Acc: 0.500 Test Loss: 1.943 Test Acc: 0.500
Validation loss decreased (-0.449979 --> -0.499981).  Saving model ...
Epoch: 12 cost time: 3.090817451477051
Epoch: 12, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.837 Vali Acc: 0.522 Test Loss: 1.837 Test Acc: 0.522
Validation loss decreased (-0.499981 --> -0.522204).  Saving model ...
Epoch: 13 cost time: 3.1020560264587402
Epoch: 13, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.737 Vali Acc: 0.533 Test Loss: 1.737 Test Acc: 0.533
Validation loss decreased (-0.522204 --> -0.533316).  Saving model ...
Epoch: 14 cost time: 3.078674793243408
Epoch: 14, Steps: 12 | Train Loss: 1.647 Vali Loss: 1.638 Vali Acc: 0.544 Test Loss: 1.638 Test Acc: 0.544
Validation loss decreased (-0.533316 --> -0.544428).  Saving model ...
Epoch: 15 cost time: 3.135481119155884
Epoch: 15, Steps: 12 | Train Loss: 1.506 Vali Loss: 1.558 Vali Acc: 0.528 Test Loss: 1.558 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.21341872215271
Epoch: 16, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.486 Vali Acc: 0.539 Test Loss: 1.486 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0608084201812744
Epoch: 17, Steps: 12 | Train Loss: 1.321 Vali Loss: 1.419 Vali Acc: 0.561 Test Loss: 1.419 Test Acc: 0.561
Validation loss decreased (-0.544428 --> -0.561097).  Saving model ...
Epoch: 18 cost time: 3.112314224243164
Epoch: 18, Steps: 12 | Train Loss: 1.263 Vali Loss: 1.341 Vali Acc: 0.606 Test Loss: 1.341 Test Acc: 0.606
Validation loss decreased (-0.561097 --> -0.605542).  Saving model ...
Epoch: 19 cost time: 3.0523085594177246
Epoch: 19, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.296 Vali Acc: 0.589 Test Loss: 1.296 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3224411010742188
Epoch: 20, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.254 Vali Acc: 0.617 Test Loss: 1.254 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616654).  Saving model ...
Epoch: 21 cost time: 3.108041524887085
Epoch: 21, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.208 Vali Acc: 0.628 Test Loss: 1.208 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627766).  Saving model ...
Epoch: 22 cost time: 3.049288272857666
Epoch: 22, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.167 Vali Acc: 0.661 Test Loss: 1.167 Test Acc: 0.661
Validation loss decreased (-0.627766 --> -0.661099).  Saving model ...
Epoch: 23 cost time: 3.089843273162842
Epoch: 23, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.144 Vali Acc: 0.628 Test Loss: 1.144 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.270048141479492
Epoch: 24, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.121 Vali Acc: 0.622 Test Loss: 1.121 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.1311817169189453
Epoch: 25, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.081 Vali Acc: 0.661 Test Loss: 1.081 Test Acc: 0.661
Validation loss decreased (-0.661099 --> -0.661100).  Saving model ...
Epoch: 26 cost time: 3.070826768875122
Epoch: 26, Steps: 12 | Train Loss: 0.793 Vali Loss: 1.057 Vali Acc: 0.667 Test Loss: 1.057 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666656).  Saving model ...
Epoch: 27 cost time: 3.0998542308807373
Epoch: 27, Steps: 12 | Train Loss: 0.787 Vali Loss: 1.042 Vali Acc: 0.656 Test Loss: 1.042 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2676682472229004
Epoch: 28, Steps: 12 | Train Loss: 0.786 Vali Loss: 1.004 Vali Acc: 0.672 Test Loss: 1.004 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672212).  Saving model ...
Epoch: 29 cost time: 3.0704495906829834
Epoch: 29, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.994 Vali Acc: 0.667 Test Loss: 0.994 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.109110116958618
Epoch: 30, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.974 Vali Acc: 0.661 Test Loss: 0.974 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6722222222222223
model parameter : 298951
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.482819557189941
Epoch: 1, Steps: 12 | Train Loss: 2.783 Vali Loss: 2.773 Vali Acc: 0.106 Test Loss: 2.773 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 2.675201892852783
Epoch: 2, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.725 Vali Acc: 0.133 Test Loss: 2.725 Test Acc: 0.133
Validation loss decreased (-0.105528 --> -0.133306).  Saving model ...
Epoch: 3 cost time: 2.786355972290039
Epoch: 3, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.662 Vali Acc: 0.144 Test Loss: 2.662 Test Acc: 0.144
Validation loss decreased (-0.133306 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 2.92505145072937
Epoch: 4, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.587 Vali Acc: 0.178 Test Loss: 2.587 Test Acc: 0.178
Validation loss decreased (-0.144418 --> -0.177752).  Saving model ...
Epoch: 5 cost time: 2.728591203689575
Epoch: 5, Steps: 12 | Train Loss: 2.482 Vali Loss: 2.503 Vali Acc: 0.217 Test Loss: 2.503 Test Acc: 0.217
Validation loss decreased (-0.177752 --> -0.216642).  Saving model ...
Epoch: 6 cost time: 2.668687105178833
Epoch: 6, Steps: 12 | Train Loss: 2.388 Vali Loss: 2.418 Vali Acc: 0.250 Test Loss: 2.418 Test Acc: 0.250
Validation loss decreased (-0.216642 --> -0.249976).  Saving model ...
Epoch: 7 cost time: 2.6420657634735107
Epoch: 7, Steps: 12 | Train Loss: 2.298 Vali Loss: 2.329 Vali Acc: 0.272 Test Loss: 2.329 Test Acc: 0.272
Validation loss decreased (-0.249976 --> -0.272199).  Saving model ...
Epoch: 8 cost time: 2.6093497276306152
Epoch: 8, Steps: 12 | Train Loss: 2.218 Vali Loss: 2.239 Vali Acc: 0.322 Test Loss: 2.239 Test Acc: 0.322
Validation loss decreased (-0.272199 --> -0.322200).  Saving model ...
Epoch: 9 cost time: 2.511361837387085
Epoch: 9, Steps: 12 | Train Loss: 2.132 Vali Loss: 2.149 Vali Acc: 0.372 Test Loss: 2.149 Test Acc: 0.372
Validation loss decreased (-0.322200 --> -0.372201).  Saving model ...
Epoch: 10 cost time: 2.4805259704589844
Epoch: 10, Steps: 12 | Train Loss: 2.007 Vali Loss: 2.062 Vali Acc: 0.417 Test Loss: 2.062 Test Acc: 0.417
Validation loss decreased (-0.372201 --> -0.416646).  Saving model ...
Epoch: 11 cost time: 2.7459607124328613
Epoch: 11, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.972 Vali Acc: 0.444 Test Loss: 1.972 Test Acc: 0.444
Validation loss decreased (-0.416646 --> -0.444425).  Saving model ...
Epoch: 12 cost time: 2.7304012775421143
Epoch: 12, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.885 Vali Acc: 0.472 Test Loss: 1.885 Test Acc: 0.472
Validation loss decreased (-0.444425 --> -0.472203).  Saving model ...
Epoch: 13 cost time: 2.6009676456451416
Epoch: 13, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.801 Vali Acc: 0.494 Test Loss: 1.801 Test Acc: 0.494
Validation loss decreased (-0.472203 --> -0.494426).  Saving model ...
Epoch: 14 cost time: 2.6533095836639404
Epoch: 14, Steps: 12 | Train Loss: 1.605 Vali Loss: 1.724 Vali Acc: 0.506 Test Loss: 1.724 Test Acc: 0.506
Validation loss decreased (-0.494426 --> -0.505538).  Saving model ...
Epoch: 15 cost time: 2.753845453262329
Epoch: 15, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.647 Vali Acc: 0.544 Test Loss: 1.647 Test Acc: 0.544
Validation loss decreased (-0.505538 --> -0.544428).  Saving model ...
Epoch: 16 cost time: 2.6768341064453125
Epoch: 16, Steps: 12 | Train Loss: 1.405 Vali Loss: 1.574 Vali Acc: 0.544 Test Loss: 1.574 Test Acc: 0.544
Validation loss decreased (-0.544428 --> -0.544429).  Saving model ...
Epoch: 17 cost time: 2.5981109142303467
Epoch: 17, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.506 Vali Acc: 0.561 Test Loss: 1.506 Test Acc: 0.561
Validation loss decreased (-0.544429 --> -0.561096).  Saving model ...
Epoch: 18 cost time: 2.653218984603882
Epoch: 18, Steps: 12 | Train Loss: 1.357 Vali Loss: 1.445 Vali Acc: 0.572 Test Loss: 1.445 Test Acc: 0.572
Validation loss decreased (-0.561096 --> -0.572208).  Saving model ...
Epoch: 19 cost time: 2.7654552459716797
Epoch: 19, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.385 Vali Acc: 0.578 Test Loss: 1.385 Test Acc: 0.578
Validation loss decreased (-0.572208 --> -0.577764).  Saving model ...
Epoch: 20 cost time: 2.700314521789551
Epoch: 20, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.324 Vali Acc: 0.600 Test Loss: 1.324 Test Acc: 0.600
Validation loss decreased (-0.577764 --> -0.599987).  Saving model ...
Epoch: 21 cost time: 2.6264164447784424
Epoch: 21, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.275 Vali Acc: 0.600 Test Loss: 1.275 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 22 cost time: 2.759296178817749
Epoch: 22, Steps: 12 | Train Loss: 1.037 Vali Loss: 1.231 Vali Acc: 0.572 Test Loss: 1.231 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.805515766143799
Epoch: 23, Steps: 12 | Train Loss: 1.016 Vali Loss: 1.189 Vali Acc: 0.628 Test Loss: 1.189 Test Acc: 0.628
Validation loss decreased (-0.599987 --> -0.627766).  Saving model ...
Epoch: 24 cost time: 2.7800700664520264
Epoch: 24, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.152 Vali Acc: 0.633 Test Loss: 1.152 Test Acc: 0.633
Validation loss decreased (-0.627766 --> -0.633322).  Saving model ...
Epoch: 25 cost time: 2.646955728530884
Epoch: 25, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.121 Vali Acc: 0.656 Test Loss: 1.121 Test Acc: 0.656
Validation loss decreased (-0.633322 --> -0.655544).  Saving model ...
Epoch: 26 cost time: 2.6746561527252197
Epoch: 26, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.098 Vali Acc: 0.650 Test Loss: 1.098 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7686750888824463
Epoch: 27, Steps: 12 | Train Loss: 0.765 Vali Loss: 1.072 Vali Acc: 0.656 Test Loss: 1.072 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655545).  Saving model ...
Epoch: 28 cost time: 2.653578281402588
Epoch: 28, Steps: 12 | Train Loss: 0.781 Vali Loss: 1.046 Vali Acc: 0.650 Test Loss: 1.046 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.651177406311035
Epoch: 29, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.994 Vali Acc: 0.667 Test Loss: 0.994 Test Acc: 0.667
Validation loss decreased (-0.655545 --> -0.666657).  Saving model ...
Epoch: 30 cost time: 2.8247697353363037
Epoch: 30, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.970 Vali Acc: 0.661 Test Loss: 0.970 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6666666666666666
model parameter : 91911
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.919834613800049
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.752 Vali Acc: 0.044 Test Loss: 2.752 Test Acc: 0.044
Validation loss decreased (inf --> -0.044417).  Saving model ...
Epoch: 2 cost time: 2.3167643547058105
Epoch: 2, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.714 Vali Acc: 0.056 Test Loss: 2.714 Test Acc: 0.056
Validation loss decreased (-0.044417 --> -0.055528).  Saving model ...
Epoch: 3 cost time: 2.363677501678467
Epoch: 3, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.665 Vali Acc: 0.094 Test Loss: 2.665 Test Acc: 0.094
Validation loss decreased (-0.055528 --> -0.094418).  Saving model ...
Epoch: 4 cost time: 2.2429380416870117
Epoch: 4, Steps: 12 | Train Loss: 2.653 Vali Loss: 2.606 Vali Acc: 0.139 Test Loss: 2.606 Test Acc: 0.139
Validation loss decreased (-0.094418 --> -0.138863).  Saving model ...
Epoch: 5 cost time: 2.2678871154785156
Epoch: 5, Steps: 12 | Train Loss: 2.607 Vali Loss: 2.541 Vali Acc: 0.183 Test Loss: 2.541 Test Acc: 0.183
Validation loss decreased (-0.138863 --> -0.183308).  Saving model ...
Epoch: 6 cost time: 2.3058910369873047
Epoch: 6, Steps: 12 | Train Loss: 2.509 Vali Loss: 2.471 Vali Acc: 0.228 Test Loss: 2.471 Test Acc: 0.228
Validation loss decreased (-0.183308 --> -0.227753).  Saving model ...
Epoch: 7 cost time: 2.3418426513671875
Epoch: 7, Steps: 12 | Train Loss: 2.451 Vali Loss: 2.401 Vali Acc: 0.272 Test Loss: 2.401 Test Acc: 0.272
Validation loss decreased (-0.227753 --> -0.272198).  Saving model ...
Epoch: 8 cost time: 2.202369213104248
Epoch: 8, Steps: 12 | Train Loss: 2.402 Vali Loss: 2.329 Vali Acc: 0.289 Test Loss: 2.329 Test Acc: 0.289
Validation loss decreased (-0.272198 --> -0.288866).  Saving model ...
Epoch: 9 cost time: 2.268967390060425
Epoch: 9, Steps: 12 | Train Loss: 2.286 Vali Loss: 2.253 Vali Acc: 0.339 Test Loss: 2.253 Test Acc: 0.339
Validation loss decreased (-0.288866 --> -0.338866).  Saving model ...
Epoch: 10 cost time: 2.276599884033203
Epoch: 10, Steps: 12 | Train Loss: 2.196 Vali Loss: 2.181 Vali Acc: 0.361 Test Loss: 2.181 Test Acc: 0.361
Validation loss decreased (-0.338866 --> -0.361089).  Saving model ...
Epoch: 11 cost time: 2.3201675415039062
Epoch: 11, Steps: 12 | Train Loss: 2.081 Vali Loss: 2.102 Vali Acc: 0.389 Test Loss: 2.102 Test Acc: 0.389
Validation loss decreased (-0.361089 --> -0.388868).  Saving model ...
Epoch: 12 cost time: 2.369659185409546
Epoch: 12, Steps: 12 | Train Loss: 2.022 Vali Loss: 2.028 Vali Acc: 0.428 Test Loss: 2.028 Test Acc: 0.428
Validation loss decreased (-0.388868 --> -0.427758).  Saving model ...
Epoch: 13 cost time: 2.2696595191955566
Epoch: 13, Steps: 12 | Train Loss: 1.927 Vali Loss: 1.957 Vali Acc: 0.433 Test Loss: 1.957 Test Acc: 0.433
Validation loss decreased (-0.427758 --> -0.433314).  Saving model ...
Epoch: 14 cost time: 2.2829854488372803
Epoch: 14, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.884 Vali Acc: 0.478 Test Loss: 1.884 Test Acc: 0.478
Validation loss decreased (-0.433314 --> -0.477759).  Saving model ...
Epoch: 15 cost time: 2.29677414894104
Epoch: 15, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.819 Vali Acc: 0.494 Test Loss: 1.819 Test Acc: 0.494
Validation loss decreased (-0.477759 --> -0.494426).  Saving model ...
Epoch: 16 cost time: 2.2407097816467285
Epoch: 16, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.757 Vali Acc: 0.506 Test Loss: 1.757 Test Acc: 0.506
Validation loss decreased (-0.494426 --> -0.505538).  Saving model ...
Epoch: 17 cost time: 2.1315252780914307
Epoch: 17, Steps: 12 | Train Loss: 1.605 Vali Loss: 1.703 Vali Acc: 0.506 Test Loss: 1.703 Test Acc: 0.506
Validation loss decreased (-0.505538 --> -0.505539).  Saving model ...
Epoch: 18 cost time: 2.1536543369293213
Epoch: 18, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.640 Vali Acc: 0.522 Test Loss: 1.640 Test Acc: 0.522
Validation loss decreased (-0.505539 --> -0.522206).  Saving model ...
Epoch: 19 cost time: 2.036025047302246
Epoch: 19, Steps: 12 | Train Loss: 1.438 Vali Loss: 1.600 Vali Acc: 0.533 Test Loss: 1.600 Test Acc: 0.533
Validation loss decreased (-0.522206 --> -0.533317).  Saving model ...
Epoch: 20 cost time: 2.282837390899658
Epoch: 20, Steps: 12 | Train Loss: 1.321 Vali Loss: 1.541 Vali Acc: 0.556 Test Loss: 1.541 Test Acc: 0.556
Validation loss decreased (-0.533317 --> -0.555540).  Saving model ...
Epoch: 21 cost time: 2.3136239051818848
Epoch: 21, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.490 Vali Acc: 0.572 Test Loss: 1.490 Test Acc: 0.572
Validation loss decreased (-0.555540 --> -0.572207).  Saving model ...
Epoch: 22 cost time: 2.2005317211151123
Epoch: 22, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.436 Vali Acc: 0.589 Test Loss: 1.436 Test Acc: 0.589
Validation loss decreased (-0.572207 --> -0.588875).  Saving model ...
Epoch: 23 cost time: 2.2040605545043945
Epoch: 23, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.423 Vali Acc: 0.556 Test Loss: 1.423 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3036305904388428
Epoch: 24, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.375 Vali Acc: 0.567 Test Loss: 1.375 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.3137564659118652
Epoch: 25, Steps: 12 | Train Loss: 1.019 Vali Loss: 1.327 Vali Acc: 0.583 Test Loss: 1.327 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2227444648742676
Epoch: 26, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.295 Vali Acc: 0.578 Test Loss: 1.295 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.184278726577759
Epoch: 27, Steps: 12 | Train Loss: 0.923 Vali Loss: 1.272 Vali Acc: 0.594 Test Loss: 1.272 Test Acc: 0.594
Validation loss decreased (-0.588875 --> -0.594432).  Saving model ...
Epoch: 28 cost time: 2.2091331481933594
Epoch: 28, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.217 Vali Acc: 0.600 Test Loss: 1.217 Test Acc: 0.600
Validation loss decreased (-0.594432 --> -0.599988).  Saving model ...
Epoch: 29 cost time: 2.604045867919922
Epoch: 29, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.192 Vali Acc: 0.611 Test Loss: 1.192 Test Acc: 0.611
Validation loss decreased (-0.599988 --> -0.611099).  Saving model ...
Epoch: 30 cost time: 2.385763645172119
Epoch: 30, Steps: 12 | Train Loss: 0.749 Vali Loss: 1.158 Vali Acc: 0.594 Test Loss: 1.158 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6111111111111112
model parameter : 298951
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9967527389526367
Epoch: 1, Steps: 12 | Train Loss: 2.785 Vali Loss: 2.775 Vali Acc: 0.106 Test Loss: 2.775 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 2.3881990909576416
Epoch: 2, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.733 Vali Acc: 0.122 Test Loss: 2.733 Test Acc: 0.122
Validation loss decreased (-0.105528 --> -0.122195).  Saving model ...
Epoch: 3 cost time: 2.1072328090667725
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.678 Vali Acc: 0.139 Test Loss: 2.678 Test Acc: 0.139
Validation loss decreased (-0.122195 --> -0.138862).  Saving model ...
Epoch: 4 cost time: 2.3082315921783447
Epoch: 4, Steps: 12 | Train Loss: 2.600 Vali Loss: 2.614 Vali Acc: 0.150 Test Loss: 2.614 Test Acc: 0.150
Validation loss decreased (-0.138862 --> -0.149974).  Saving model ...
Epoch: 5 cost time: 2.2476344108581543
Epoch: 5, Steps: 12 | Train Loss: 2.517 Vali Loss: 2.542 Vali Acc: 0.178 Test Loss: 2.542 Test Acc: 0.178
Validation loss decreased (-0.149974 --> -0.177752).  Saving model ...
Epoch: 6 cost time: 2.27014422416687
Epoch: 6, Steps: 12 | Train Loss: 2.439 Vali Loss: 2.469 Vali Acc: 0.194 Test Loss: 2.469 Test Acc: 0.194
Validation loss decreased (-0.177752 --> -0.194420).  Saving model ...
Epoch: 7 cost time: 2.270838975906372
Epoch: 7, Steps: 12 | Train Loss: 2.354 Vali Loss: 2.391 Vali Acc: 0.244 Test Loss: 2.391 Test Acc: 0.244
Validation loss decreased (-0.194420 --> -0.244421).  Saving model ...
Epoch: 8 cost time: 2.3429510593414307
Epoch: 8, Steps: 12 | Train Loss: 2.287 Vali Loss: 2.311 Vali Acc: 0.306 Test Loss: 2.311 Test Acc: 0.306
Validation loss decreased (-0.244421 --> -0.305532).  Saving model ...
Epoch: 9 cost time: 2.3913581371307373
Epoch: 9, Steps: 12 | Train Loss: 2.212 Vali Loss: 2.232 Vali Acc: 0.361 Test Loss: 2.232 Test Acc: 0.361
Validation loss decreased (-0.305532 --> -0.361089).  Saving model ...
Epoch: 10 cost time: 2.4046919345855713
Epoch: 10, Steps: 12 | Train Loss: 2.126 Vali Loss: 2.156 Vali Acc: 0.417 Test Loss: 2.156 Test Acc: 0.417
Validation loss decreased (-0.361089 --> -0.416645).  Saving model ...
Epoch: 11 cost time: 2.3790407180786133
Epoch: 11, Steps: 12 | Train Loss: 1.994 Vali Loss: 2.077 Vali Acc: 0.444 Test Loss: 2.077 Test Acc: 0.444
Validation loss decreased (-0.416645 --> -0.444424).  Saving model ...
Epoch: 12 cost time: 2.3881452083587646
Epoch: 12, Steps: 12 | Train Loss: 1.918 Vali Loss: 2.000 Vali Acc: 0.456 Test Loss: 2.000 Test Acc: 0.456
Validation loss decreased (-0.444424 --> -0.455536).  Saving model ...
Epoch: 13 cost time: 2.2527358531951904
Epoch: 13, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.923 Vali Acc: 0.489 Test Loss: 1.923 Test Acc: 0.489
Validation loss decreased (-0.455536 --> -0.488870).  Saving model ...
Epoch: 14 cost time: 2.443682909011841
Epoch: 14, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.855 Vali Acc: 0.489 Test Loss: 1.855 Test Acc: 0.489
Validation loss decreased (-0.488870 --> -0.488870).  Saving model ...
Epoch: 15 cost time: 2.3763656616210938
Epoch: 15, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.788 Vali Acc: 0.522 Test Loss: 1.788 Test Acc: 0.522
Validation loss decreased (-0.488870 --> -0.522204).  Saving model ...
Epoch: 16 cost time: 2.3786652088165283
Epoch: 16, Steps: 12 | Train Loss: 1.593 Vali Loss: 1.721 Vali Acc: 0.550 Test Loss: 1.721 Test Acc: 0.550
Validation loss decreased (-0.522204 --> -0.549983).  Saving model ...
Epoch: 17 cost time: 2.3270740509033203
Epoch: 17, Steps: 12 | Train Loss: 1.530 Vali Loss: 1.659 Vali Acc: 0.556 Test Loss: 1.659 Test Acc: 0.556
Validation loss decreased (-0.549983 --> -0.555539).  Saving model ...
Epoch: 18 cost time: 2.2806529998779297
Epoch: 18, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.604 Vali Acc: 0.567 Test Loss: 1.604 Test Acc: 0.567
Validation loss decreased (-0.555539 --> -0.566651).  Saving model ...
Epoch: 19 cost time: 2.4041149616241455
Epoch: 19, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.544 Vali Acc: 0.578 Test Loss: 1.544 Test Acc: 0.578
Validation loss decreased (-0.566651 --> -0.577762).  Saving model ...
Epoch: 20 cost time: 2.4440791606903076
Epoch: 20, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.484 Vali Acc: 0.578 Test Loss: 1.484 Test Acc: 0.578
Validation loss decreased (-0.577762 --> -0.577763).  Saving model ...
Epoch: 21 cost time: 2.3028299808502197
Epoch: 21, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.439 Vali Acc: 0.572 Test Loss: 1.439 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.421276807785034
Epoch: 22, Steps: 12 | Train Loss: 1.217 Vali Loss: 1.395 Vali Acc: 0.578 Test Loss: 1.395 Test Acc: 0.578
Validation loss decreased (-0.577763 --> -0.577764).  Saving model ...
Epoch: 23 cost time: 2.255265235900879
Epoch: 23, Steps: 12 | Train Loss: 1.189 Vali Loss: 1.352 Vali Acc: 0.589 Test Loss: 1.352 Test Acc: 0.589
Validation loss decreased (-0.577764 --> -0.588875).  Saving model ...
Epoch: 24 cost time: 2.4932827949523926
Epoch: 24, Steps: 12 | Train Loss: 1.074 Vali Loss: 1.316 Vali Acc: 0.600 Test Loss: 1.316 Test Acc: 0.600
Validation loss decreased (-0.588875 --> -0.599987).  Saving model ...
Epoch: 25 cost time: 2.426905870437622
Epoch: 25, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.281 Vali Acc: 0.606 Test Loss: 1.281 Test Acc: 0.606
Validation loss decreased (-0.599987 --> -0.605543).  Saving model ...
Epoch: 26 cost time: 2.260253429412842
Epoch: 26, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.255 Vali Acc: 0.594 Test Loss: 1.255 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3421292304992676
Epoch: 27, Steps: 12 | Train Loss: 0.929 Vali Loss: 1.224 Vali Acc: 0.622 Test Loss: 1.224 Test Acc: 0.622
Validation loss decreased (-0.605543 --> -0.622210).  Saving model ...
Epoch: 28 cost time: 2.2773890495300293
Epoch: 28, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.203 Vali Acc: 0.611 Test Loss: 1.203 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.4588677883148193
Epoch: 29, Steps: 12 | Train Loss: 0.867 Vali Loss: 1.169 Vali Acc: 0.628 Test Loss: 1.169 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627766).  Saving model ...
Epoch: 30 cost time: 2.333029270172119
Epoch: 30, Steps: 12 | Train Loss: 0.848 Vali Loss: 1.150 Vali Acc: 0.633 Test Loss: 1.150 Test Acc: 0.633
Validation loss decreased (-0.627766 --> -0.633322).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6333333333333333
model parameter : 91911
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 22.00194025039673
Epoch: 1, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.452 Vali Acc: 0.278 Test Loss: 2.452 Test Acc: 0.278
Validation loss decreased (inf --> -0.277753).  Saving model ...
Epoch: 2 cost time: 20.654848337173462
Epoch: 2, Steps: 12 | Train Loss: 2.150 Vali Loss: 1.800 Vali Acc: 0.528 Test Loss: 1.800 Test Acc: 0.528
Validation loss decreased (-0.277753 --> -0.527760).  Saving model ...
Epoch: 3 cost time: 20.859575033187866
Epoch: 3, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.327 Vali Acc: 0.611 Test Loss: 1.327 Test Acc: 0.611
Validation loss decreased (-0.527760 --> -0.611098).  Saving model ...
Epoch: 4 cost time: 21.385194301605225
Epoch: 4, Steps: 12 | Train Loss: 1.005 Vali Loss: 1.096 Vali Acc: 0.606 Test Loss: 1.096 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.28064513206482
Epoch: 5, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.862 Vali Acc: 0.706 Test Loss: 0.862 Test Acc: 0.706
Validation loss decreased (-0.611098 --> -0.705547).  Saving model ...
Epoch: 6 cost time: 21.073116540908813
Epoch: 6, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.750 Vali Acc: 0.744 Test Loss: 0.750 Test Acc: 0.744
Validation loss decreased (-0.705547 --> -0.744437).  Saving model ...
Epoch: 7 cost time: 21.1632661819458
Epoch: 7, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.681 Vali Acc: 0.739 Test Loss: 0.681 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 19.954392433166504
Epoch: 8, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.706 Vali Acc: 0.756 Test Loss: 0.706 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 9 cost time: 20.24562907218933
Epoch: 9, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.697 Vali Acc: 0.728 Test Loss: 0.697 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.04371452331543
Epoch: 10, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.692 Vali Acc: 0.767 Test Loss: 0.692 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766660).  Saving model ...
Epoch: 11 cost time: 18.965641736984253
Epoch: 11, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.798 Vali Acc: 0.739 Test Loss: 0.798 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 18.70984148979187
Epoch: 12, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.648 Vali Acc: 0.772 Test Loss: 0.648 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 13 cost time: 19.093811988830566
Epoch: 13, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
Validation loss decreased (-0.772216 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 19.38705015182495
Epoch: 14, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.674 Vali Acc: 0.794 Test Loss: 0.674 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.943101167678833
Epoch: 15, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.644 Vali Acc: 0.817 Test Loss: 0.644 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 16 cost time: 20.338285207748413
Epoch: 16, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.673 Vali Acc: 0.822 Test Loss: 0.673 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822215).  Saving model ...
Epoch: 17 cost time: 20.593822240829468
Epoch: 17, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.714 Vali Acc: 0.789 Test Loss: 0.714 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 20.557676792144775
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
Validation loss decreased (-0.822215 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 20.56618642807007
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.793 Vali Acc: 0.772 Test Loss: 0.793 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 20.402979850769043
Epoch: 20, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.778 Vali Acc: 0.817 Test Loss: 0.778 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 20.18122673034668
Epoch: 21, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.620 Vali Acc: 0.839 Test Loss: 0.620 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 20.990776300430298
Epoch: 22, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 21.07236623764038
Epoch: 23, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.654 Vali Acc: 0.839 Test Loss: 0.654 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 20.971923828125
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.604 Vali Acc: 0.839 Test Loss: 0.604 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 19.99713444709778
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 26 cost time: 20.792202472686768
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.574 Vali Acc: 0.883 Test Loss: 0.574 Test Acc: 0.883
Validation loss decreased (-0.855550 --> -0.883328).  Saving model ...
Epoch: 27 cost time: 21.660791158676147
Epoch: 27, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 23.116235494613647
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.774 Vali Acc: 0.839 Test Loss: 0.774 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 21.679123878479004
Epoch: 29, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.776 Vali Acc: 0.839 Test Loss: 0.776 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 22.528329133987427
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.692 Vali Acc: 0.856 Test Loss: 0.692 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 56324751
model size : 217.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 9.348538398742676
Epoch: 1, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.428 Vali Acc: 0.361 Test Loss: 2.428 Test Acc: 0.361
Validation loss decreased (inf --> -0.361087).  Saving model ...
Epoch: 2 cost time: 7.437351226806641
Epoch: 2, Steps: 12 | Train Loss: 2.054 Vali Loss: 1.803 Vali Acc: 0.522 Test Loss: 1.803 Test Acc: 0.522
Validation loss decreased (-0.361087 --> -0.522204).  Saving model ...
Epoch: 3 cost time: 7.276801347732544
Epoch: 3, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.365 Vali Acc: 0.589 Test Loss: 1.365 Test Acc: 0.589
Validation loss decreased (-0.522204 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 7.802086114883423
Epoch: 4, Steps: 12 | Train Loss: 1.010 Vali Loss: 1.104 Vali Acc: 0.622 Test Loss: 1.104 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622211).  Saving model ...
Epoch: 5 cost time: 7.834070920944214
Epoch: 5, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.908 Vali Acc: 0.644 Test Loss: 0.908 Test Acc: 0.644
Validation loss decreased (-0.622211 --> -0.644435).  Saving model ...
Epoch: 6 cost time: 7.289501905441284
Epoch: 6, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.809 Vali Acc: 0.694 Test Loss: 0.809 Test Acc: 0.694
Validation loss decreased (-0.644435 --> -0.694436).  Saving model ...
Epoch: 7 cost time: 7.3120436668396
Epoch: 7, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.863 Vali Acc: 0.672 Test Loss: 0.863 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.405613422393799
Epoch: 8, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.798 Vali Acc: 0.711 Test Loss: 0.798 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711103).  Saving model ...
Epoch: 9 cost time: 7.602829456329346
Epoch: 9, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.709 Vali Acc: 0.706 Test Loss: 0.709 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.190819501876831
Epoch: 10, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.691 Vali Acc: 0.744 Test Loss: 0.691 Test Acc: 0.744
Validation loss decreased (-0.711103 --> -0.744438).  Saving model ...
Epoch: 11 cost time: 7.261421203613281
Epoch: 11, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.661 Vali Acc: 0.772 Test Loss: 0.661 Test Acc: 0.772
Validation loss decreased (-0.744438 --> -0.772216).  Saving model ...
Epoch: 12 cost time: 7.9947121143341064
Epoch: 12, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.660 Vali Acc: 0.772 Test Loss: 0.660 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772216).  Saving model ...
Epoch: 13 cost time: 7.964763164520264
Epoch: 13, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.748 Vali Acc: 0.767 Test Loss: 0.748 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.469935178756714
Epoch: 14, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.658 Vali Acc: 0.772 Test Loss: 0.658 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772216).  Saving model ...
Epoch: 15 cost time: 7.4062275886535645
Epoch: 15, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.708 Vali Acc: 0.761 Test Loss: 0.708 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.84595513343811
Epoch: 16, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.677 Vali Acc: 0.800 Test Loss: 0.677 Test Acc: 0.800
Validation loss decreased (-0.772216 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 7.739450216293335
Epoch: 17, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.720 Vali Acc: 0.800 Test Loss: 0.720 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.411179780960083
Epoch: 18, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.641936302185059
Epoch: 19, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.709 Vali Acc: 0.794 Test Loss: 0.709 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.935270547866821
Epoch: 20, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.707 Vali Acc: 0.800 Test Loss: 0.707 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.856523752212524
Epoch: 21, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.677 Vali Acc: 0.800 Test Loss: 0.677 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 7.77734637260437
Epoch: 22, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.709 Vali Acc: 0.822 Test Loss: 0.709 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822215).  Saving model ...
Epoch: 23 cost time: 8.125534534454346
Epoch: 23, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.674 Vali Acc: 0.822 Test Loss: 0.674 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 24 cost time: 8.294935464859009
Epoch: 24, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.666 Vali Acc: 0.811 Test Loss: 0.666 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.663835763931274
Epoch: 25, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.737 Vali Acc: 0.828 Test Loss: 0.737 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827770).  Saving model ...
Epoch: 26 cost time: 7.643492937088013
Epoch: 26, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.751 Vali Acc: 0.806 Test Loss: 0.751 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 8.14469051361084
Epoch: 27, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.808 Vali Acc: 0.794 Test Loss: 0.808 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 8.090166330337524
Epoch: 28, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.709 Vali Acc: 0.806 Test Loss: 0.709 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.708293914794922
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.707 Vali Acc: 0.822 Test Loss: 0.707 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.701653718948364
Epoch: 30, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.595 Vali Acc: 0.828 Test Loss: 0.595 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827772).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 16607631
model size : 65.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 17.764209032058716
Epoch: 1, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.450 Vali Acc: 0.272 Test Loss: 2.450 Test Acc: 0.272
Validation loss decreased (inf --> -0.272198).  Saving model ...
Epoch: 2 cost time: 15.724769115447998
Epoch: 2, Steps: 12 | Train Loss: 2.151 Vali Loss: 1.797 Vali Acc: 0.528 Test Loss: 1.797 Test Acc: 0.528
Validation loss decreased (-0.272198 --> -0.527760).  Saving model ...
Epoch: 3 cost time: 15.732641696929932
Epoch: 3, Steps: 12 | Train Loss: 1.397 Vali Loss: 1.325 Vali Acc: 0.606 Test Loss: 1.325 Test Acc: 0.606
Validation loss decreased (-0.527760 --> -0.605542).  Saving model ...
Epoch: 4 cost time: 16.00026273727417
Epoch: 4, Steps: 12 | Train Loss: 1.016 Vali Loss: 1.099 Vali Acc: 0.606 Test Loss: 1.099 Test Acc: 0.606
Validation loss decreased (-0.605542 --> -0.605545).  Saving model ...
Epoch: 5 cost time: 16.472127676010132
Epoch: 5, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.876 Vali Acc: 0.706 Test Loss: 0.876 Test Acc: 0.706
Validation loss decreased (-0.605545 --> -0.705547).  Saving model ...
Epoch: 6 cost time: 15.848513126373291
Epoch: 6, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.749 Vali Acc: 0.744 Test Loss: 0.749 Test Acc: 0.744
Validation loss decreased (-0.705547 --> -0.744437).  Saving model ...
Epoch: 7 cost time: 16.530550718307495
Epoch: 7, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.687 Vali Acc: 0.728 Test Loss: 0.687 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.657641649246216
Epoch: 8, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.740 Vali Acc: 0.739 Test Loss: 0.740 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.690632343292236
Epoch: 9, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.709 Vali Acc: 0.717 Test Loss: 0.709 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 15.723857402801514
Epoch: 10, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.697 Vali Acc: 0.767 Test Loss: 0.697 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766660).  Saving model ...
Epoch: 11 cost time: 15.953826427459717
Epoch: 11, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.810 Vali Acc: 0.722 Test Loss: 0.810 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.0569429397583
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.652 Vali Acc: 0.750 Test Loss: 0.652 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.852272033691406
Epoch: 13, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.698 Vali Acc: 0.750 Test Loss: 0.698 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 14.815592288970947
Epoch: 14, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.699 Vali Acc: 0.794 Test Loss: 0.699 Test Acc: 0.794
Validation loss decreased (-0.766660 --> -0.794437).  Saving model ...
Epoch: 15 cost time: 15.730298042297363
Epoch: 15, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.732 Vali Acc: 0.800 Test Loss: 0.732 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 14.833913803100586
Epoch: 16, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.701 Vali Acc: 0.822 Test Loss: 0.701 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822215).  Saving model ...
Epoch: 17 cost time: 15.337374687194824
Epoch: 17, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.686 Vali Acc: 0.811 Test Loss: 0.686 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 15.389845848083496
Epoch: 18, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.704 Vali Acc: 0.806 Test Loss: 0.704 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 15.557079553604126
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.762 Vali Acc: 0.817 Test Loss: 0.762 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 15.409601211547852
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.864 Vali Acc: 0.806 Test Loss: 0.864 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 15.294323205947876
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.755 Vali Acc: 0.811 Test Loss: 0.755 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 15.930416584014893
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
Validation loss decreased (-0.822215 --> -0.855550).  Saving model ...
Epoch: 23 cost time: 15.086825847625732
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.641 Vali Acc: 0.856 Test Loss: 0.641 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 15.954565525054932
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.676 Vali Acc: 0.844 Test Loss: 0.676 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 14.963905334472656
Epoch: 25, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.659 Vali Acc: 0.839 Test Loss: 0.659 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 15.957700490951538
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.629 Vali Acc: 0.872 Test Loss: 0.629 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 27 cost time: 14.765362739562988
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.621 Vali Acc: 0.872 Test Loss: 0.621 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 28 cost time: 16.041321992874146
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.867 Test Loss: 0.627 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 15.081048250198364
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.628 Vali Acc: 0.872 Test Loss: 0.628 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 15.948757886886597
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 56324751
model size : 217.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.4519758224487305
Epoch: 1, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.426 Vali Acc: 0.361 Test Loss: 2.426 Test Acc: 0.361
Validation loss decreased (inf --> -0.361087).  Saving model ...
Epoch: 2 cost time: 6.148701190948486
Epoch: 2, Steps: 12 | Train Loss: 2.055 Vali Loss: 1.798 Vali Acc: 0.528 Test Loss: 1.798 Test Acc: 0.528
Validation loss decreased (-0.361087 --> -0.527760).  Saving model ...
Epoch: 3 cost time: 6.088862419128418
Epoch: 3, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.361 Vali Acc: 0.594 Test Loss: 1.361 Test Acc: 0.594
Validation loss decreased (-0.527760 --> -0.594431).  Saving model ...
Epoch: 4 cost time: 5.895189523696899
Epoch: 4, Steps: 12 | Train Loss: 1.016 Vali Loss: 1.104 Vali Acc: 0.617 Test Loss: 1.104 Test Acc: 0.617
Validation loss decreased (-0.594431 --> -0.616656).  Saving model ...
Epoch: 5 cost time: 5.725231170654297
Epoch: 5, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.911 Vali Acc: 0.650 Test Loss: 0.911 Test Acc: 0.650
Validation loss decreased (-0.616656 --> -0.649991).  Saving model ...
Epoch: 6 cost time: 5.8274922370910645
Epoch: 6, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.810 Vali Acc: 0.694 Test Loss: 0.810 Test Acc: 0.694
Validation loss decreased (-0.649991 --> -0.694436).  Saving model ...
Epoch: 7 cost time: 4.998968124389648
Epoch: 7, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.862 Vali Acc: 0.672 Test Loss: 0.862 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.103765964508057
Epoch: 8, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.783 Vali Acc: 0.700 Test Loss: 0.783 Test Acc: 0.700
Validation loss decreased (-0.694436 --> -0.699992).  Saving model ...
Epoch: 9 cost time: 5.806120157241821
Epoch: 9, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.693 Vali Acc: 0.711 Test Loss: 0.693 Test Acc: 0.711
Validation loss decreased (-0.699992 --> -0.711104).  Saving model ...
Epoch: 10 cost time: 5.763710975646973
Epoch: 10, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.694 Vali Acc: 0.761 Test Loss: 0.694 Test Acc: 0.761
Validation loss decreased (-0.711104 --> -0.761104).  Saving model ...
Epoch: 11 cost time: 5.964247703552246
Epoch: 11, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.656 Vali Acc: 0.772 Test Loss: 0.656 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772216).  Saving model ...
Epoch: 12 cost time: 5.368344783782959
Epoch: 12, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.663 Vali Acc: 0.772 Test Loss: 0.663 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.923038959503174
Epoch: 13, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.717 Vali Acc: 0.772 Test Loss: 0.717 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.905680418014526
Epoch: 14, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.702 Vali Acc: 0.739 Test Loss: 0.702 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.551408767700195
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.782 Vali Acc: 0.767 Test Loss: 0.782 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.283659219741821
Epoch: 16, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.670 Vali Acc: 0.783 Test Loss: 0.670 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783327).  Saving model ...
Epoch: 17 cost time: 5.6441731452941895
Epoch: 17, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.793 Vali Acc: 0.800 Test Loss: 0.793 Test Acc: 0.800
Validation loss decreased (-0.783327 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 5.813150882720947
Epoch: 18, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.770 Vali Acc: 0.778 Test Loss: 0.770 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.287610292434692
Epoch: 19, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.769 Vali Acc: 0.772 Test Loss: 0.769 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.4359352588653564
Epoch: 20, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.704 Vali Acc: 0.783 Test Loss: 0.704 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.621356248855591
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.747 Vali Acc: 0.778 Test Loss: 0.747 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.5396177768707275
Epoch: 22, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.735 Vali Acc: 0.783 Test Loss: 0.735 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.367173433303833
Epoch: 23, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.704 Vali Acc: 0.789 Test Loss: 0.704 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.279575824737549
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.711 Vali Acc: 0.806 Test Loss: 0.711 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 25 cost time: 5.439769983291626
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.751 Vali Acc: 0.811 Test Loss: 0.751 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 26 cost time: 4.906169414520264
Epoch: 26, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.769 Vali Acc: 0.789 Test Loss: 0.769 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.002603769302368
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.738 Vali Acc: 0.789 Test Loss: 0.738 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.298997640609741
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.702 Vali Acc: 0.822 Test Loss: 0.702 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 29 cost time: 5.272089719772339
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.711 Vali Acc: 0.817 Test Loss: 0.711 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.984785318374634
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.729 Vali Acc: 0.811 Test Loss: 0.729 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 16607631
model size : 65.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 9.982825517654419
Epoch: 1, Steps: 12 | Train Loss: 2.778 Vali Loss: 2.548 Vali Acc: 0.194 Test Loss: 2.548 Test Acc: 0.194
Validation loss decreased (inf --> -0.194419).  Saving model ...
Epoch: 2 cost time: 7.898223876953125
Epoch: 2, Steps: 12 | Train Loss: 2.309 Vali Loss: 2.038 Vali Acc: 0.489 Test Loss: 2.038 Test Acc: 0.489
Validation loss decreased (-0.194419 --> -0.488869).  Saving model ...
Epoch: 3 cost time: 8.348385334014893
Epoch: 3, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.604 Vali Acc: 0.544 Test Loss: 1.604 Test Acc: 0.544
Validation loss decreased (-0.488869 --> -0.544428).  Saving model ...
Epoch: 4 cost time: 7.858656167984009
Epoch: 4, Steps: 12 | Train Loss: 1.299 Vali Loss: 1.295 Vali Acc: 0.561 Test Loss: 1.295 Test Acc: 0.561
Validation loss decreased (-0.544428 --> -0.561098).  Saving model ...
Epoch: 5 cost time: 8.119678735733032
Epoch: 5, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.054 Vali Acc: 0.622 Test Loss: 1.054 Test Acc: 0.622
Validation loss decreased (-0.561098 --> -0.622212).  Saving model ...
Epoch: 6 cost time: 8.682056188583374
Epoch: 6, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.953 Vali Acc: 0.650 Test Loss: 0.953 Test Acc: 0.650
Validation loss decreased (-0.622212 --> -0.649990).  Saving model ...
Epoch: 7 cost time: 8.234659910202026
Epoch: 7, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.853 Vali Acc: 0.678 Test Loss: 0.853 Test Acc: 0.678
Validation loss decreased (-0.649990 --> -0.677769).  Saving model ...
Epoch: 8 cost time: 8.77842903137207
Epoch: 8, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.907 Vali Acc: 0.678 Test Loss: 0.907 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.150086164474487
Epoch: 9, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.787 Vali Acc: 0.694 Test Loss: 0.787 Test Acc: 0.694
Validation loss decreased (-0.677769 --> -0.694437).  Saving model ...
Epoch: 10 cost time: 8.685423374176025
Epoch: 10, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.736 Vali Acc: 0.739 Test Loss: 0.736 Test Acc: 0.739
Validation loss decreased (-0.694437 --> -0.738882).  Saving model ...
Epoch: 11 cost time: 8.481855869293213
Epoch: 11, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.663 Vali Acc: 0.778 Test Loss: 0.663 Test Acc: 0.778
Validation loss decreased (-0.738882 --> -0.777771).  Saving model ...
Epoch: 12 cost time: 8.168643951416016
Epoch: 12, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.621 Vali Acc: 0.811 Test Loss: 0.621 Test Acc: 0.811
Validation loss decreased (-0.777771 --> -0.811105).  Saving model ...
Epoch: 13 cost time: 8.927440881729126
Epoch: 13, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.616 Vali Acc: 0.794 Test Loss: 0.616 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.195115089416504
Epoch: 14, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.760 Vali Acc: 0.761 Test Loss: 0.760 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.667366981506348
Epoch: 15, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.652120351791382
Epoch: 16, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.614 Vali Acc: 0.817 Test Loss: 0.614 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 17 cost time: 7.93415641784668
Epoch: 17, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.607 Vali Acc: 0.811 Test Loss: 0.607 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.464025974273682
Epoch: 18, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.646 Vali Acc: 0.800 Test Loss: 0.646 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.8295886516571045
Epoch: 19, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.26157546043396
Epoch: 20, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.865 Vali Acc: 0.767 Test Loss: 0.865 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 8.30712342262268
Epoch: 21, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.959 Vali Acc: 0.750 Test Loss: 0.959 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.749256134033203
Epoch: 22, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.666 Vali Acc: 0.822 Test Loss: 0.666 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822216).  Saving model ...
Epoch: 23 cost time: 8.437390089035034
Epoch: 23, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.834 Vali Acc: 0.772 Test Loss: 0.834 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.9145777225494385
Epoch: 24, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.873 Vali Acc: 0.817 Test Loss: 0.873 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.976109504699707
Epoch: 25, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.804 Vali Acc: 0.817 Test Loss: 0.804 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 8.353829622268677
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.832 Vali Acc: 0.806 Test Loss: 0.832 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 8.091917514801025
Epoch: 27, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.924 Vali Acc: 0.783 Test Loss: 0.924 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 8.634500741958618
Epoch: 28, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.868 Vali Acc: 0.767 Test Loss: 0.868 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 8.515894889831543
Epoch: 29, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.661 Vali Acc: 0.817 Test Loss: 0.661 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 8.121797800064087
Epoch: 30, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.683 Vali Acc: 0.833 Test Loss: 0.683 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 56324751
model size : 217.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.011265993118286
Epoch: 1, Steps: 12 | Train Loss: 2.700 Vali Loss: 2.510 Vali Acc: 0.306 Test Loss: 2.510 Test Acc: 0.306
Validation loss decreased (inf --> -0.305530).  Saving model ...
Epoch: 2 cost time: 3.373769998550415
Epoch: 2, Steps: 12 | Train Loss: 2.218 Vali Loss: 2.018 Vali Acc: 0.511 Test Loss: 2.018 Test Acc: 0.511
Validation loss decreased (-0.305530 --> -0.511091).  Saving model ...
Epoch: 3 cost time: 3.5132346153259277
Epoch: 3, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.634 Vali Acc: 0.567 Test Loss: 1.634 Test Acc: 0.567
Validation loss decreased (-0.511091 --> -0.566650).  Saving model ...
Epoch: 4 cost time: 3.651118040084839
Epoch: 4, Steps: 12 | Train Loss: 1.278 Vali Loss: 1.361 Vali Acc: 0.567 Test Loss: 1.361 Test Acc: 0.567
Validation loss decreased (-0.566650 --> -0.566653).  Saving model ...
Epoch: 5 cost time: 3.6760706901550293
Epoch: 5, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.127 Vali Acc: 0.617 Test Loss: 1.127 Test Acc: 0.617
Validation loss decreased (-0.566653 --> -0.616655).  Saving model ...
Epoch: 6 cost time: 3.490011215209961
Epoch: 6, Steps: 12 | Train Loss: 0.824 Vali Loss: 1.036 Vali Acc: 0.633 Test Loss: 1.036 Test Acc: 0.633
Validation loss decreased (-0.616655 --> -0.633323).  Saving model ...
Epoch: 7 cost time: 3.4878053665161133
Epoch: 7, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.977 Vali Acc: 0.622 Test Loss: 0.977 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5999836921691895
Epoch: 8, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.945 Vali Acc: 0.656 Test Loss: 0.945 Test Acc: 0.656
Validation loss decreased (-0.633323 --> -0.655546).  Saving model ...
Epoch: 9 cost time: 3.561772346496582
Epoch: 9, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.830 Vali Acc: 0.656 Test Loss: 0.830 Test Acc: 0.656
Validation loss decreased (-0.655546 --> -0.655547).  Saving model ...
Epoch: 10 cost time: 3.405014753341675
Epoch: 10, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.826 Vali Acc: 0.706 Test Loss: 0.826 Test Acc: 0.706
Validation loss decreased (-0.655547 --> -0.705547).  Saving model ...
Epoch: 11 cost time: 3.395094871520996
Epoch: 11, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.789 Vali Acc: 0.728 Test Loss: 0.789 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727770).  Saving model ...
Epoch: 12 cost time: 3.4174928665161133
Epoch: 12, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.787 Vali Acc: 0.722 Test Loss: 0.787 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.532482624053955
Epoch: 13, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.767 Vali Acc: 0.744 Test Loss: 0.767 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744437).  Saving model ...
Epoch: 14 cost time: 3.457406997680664
Epoch: 14, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.743 Vali Acc: 0.761 Test Loss: 0.743 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 3.2926602363586426
Epoch: 15, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.921 Vali Acc: 0.739 Test Loss: 0.921 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.208134174346924
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.881 Vali Acc: 0.750 Test Loss: 0.881 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4651951789855957
Epoch: 17, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.794 Vali Acc: 0.778 Test Loss: 0.794 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777770).  Saving model ...
Epoch: 18 cost time: 3.268401622772217
Epoch: 18, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.767 Vali Acc: 0.778 Test Loss: 0.767 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 19 cost time: 3.2979860305786133
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.823 Vali Acc: 0.761 Test Loss: 0.823 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2988200187683105
Epoch: 20, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.838 Vali Acc: 0.767 Test Loss: 0.838 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.304666042327881
Epoch: 21, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.917 Vali Acc: 0.778 Test Loss: 0.917 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.5556163787841797
Epoch: 22, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.012 Vali Acc: 0.733 Test Loss: 1.012 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.5221927165985107
Epoch: 23, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.234 Vali Acc: 0.717 Test Loss: 1.234 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.324101209640503
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.159 Vali Acc: 0.772 Test Loss: 1.159 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.263582468032837
Epoch: 25, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.222 Vali Acc: 0.733 Test Loss: 1.222 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.2631595134735107
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.100 Vali Acc: 0.767 Test Loss: 1.100 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.513002634048462
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.132 Vali Acc: 0.744 Test Loss: 1.132 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.840590715408325
Epoch: 28, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.003 Vali Acc: 0.756 Test Loss: 1.003 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 16607631
model size : 65.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 13.394582033157349
Epoch: 1, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.484 Vali Acc: 0.222 Test Loss: 2.484 Test Acc: 0.222
Validation loss decreased (inf --> -0.222197).  Saving model ...
Epoch: 2 cost time: 10.990966796875
Epoch: 2, Steps: 12 | Train Loss: 2.180 Vali Loss: 1.859 Vali Acc: 0.556 Test Loss: 1.859 Test Acc: 0.556
Validation loss decreased (-0.222197 --> -0.555537).  Saving model ...
Epoch: 3 cost time: 11.677985906600952
Epoch: 3, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.361 Vali Acc: 0.594 Test Loss: 1.361 Test Acc: 0.594
Validation loss decreased (-0.555537 --> -0.594431).  Saving model ...
Epoch: 4 cost time: 10.937887191772461
Epoch: 4, Steps: 12 | Train Loss: 1.047 Vali Loss: 1.100 Vali Acc: 0.639 Test Loss: 1.100 Test Acc: 0.639
Validation loss decreased (-0.594431 --> -0.638878).  Saving model ...
Epoch: 5 cost time: 11.793552160263062
Epoch: 5, Steps: 12 | Train Loss: 0.796 Vali Loss: 0.897 Vali Acc: 0.694 Test Loss: 0.897 Test Acc: 0.694
Validation loss decreased (-0.638878 --> -0.694435).  Saving model ...
Epoch: 6 cost time: 11.263354539871216
Epoch: 6, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.787 Vali Acc: 0.694 Test Loss: 0.787 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694437).  Saving model ...
Epoch: 7 cost time: 10.989295244216919
Epoch: 7, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.709 Vali Acc: 0.744 Test Loss: 0.709 Test Acc: 0.744
Validation loss decreased (-0.694437 --> -0.744437).  Saving model ...
Epoch: 8 cost time: 11.421207189559937
Epoch: 8, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.673 Vali Acc: 0.750 Test Loss: 0.673 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 9.520073175430298
Epoch: 9, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.816 Vali Acc: 0.678 Test Loss: 0.816 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.29810619354248
Epoch: 10, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.665 Vali Acc: 0.750 Test Loss: 0.665 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 11 cost time: 9.38939380645752
Epoch: 11, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.671 Vali Acc: 0.778 Test Loss: 0.671 Test Acc: 0.778
Validation loss decreased (-0.749993 --> -0.777771).  Saving model ...
Epoch: 12 cost time: 10.186695098876953
Epoch: 12, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.638 Vali Acc: 0.778 Test Loss: 0.638 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 13 cost time: 11.780441522598267
Epoch: 13, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.697 Vali Acc: 0.778 Test Loss: 0.697 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.927946329116821
Epoch: 14, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.690 Vali Acc: 0.772 Test Loss: 0.690 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.75543475151062
Epoch: 15, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.712 Vali Acc: 0.794 Test Loss: 0.712 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794437).  Saving model ...
Epoch: 16 cost time: 11.29762887954712
Epoch: 16, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.823 Vali Acc: 0.783 Test Loss: 0.823 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.11716103553772
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.769 Vali Acc: 0.778 Test Loss: 0.769 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.263214826583862
Epoch: 18, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.722 Vali Acc: 0.806 Test Loss: 0.722 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805548).  Saving model ...
Epoch: 19 cost time: 12.07908010482788
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.694 Vali Acc: 0.806 Test Loss: 0.694 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 20 cost time: 11.228010892868042
Epoch: 20, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.991735458374023
Epoch: 21, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.678 Vali Acc: 0.817 Test Loss: 0.678 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 22 cost time: 10.335150480270386
Epoch: 22, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.666 Vali Acc: 0.817 Test Loss: 0.666 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 11.076702117919922
Epoch: 23, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.750 Vali Acc: 0.794 Test Loss: 0.750 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.672499895095825
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.775 Vali Acc: 0.794 Test Loss: 0.775 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 11.500616312026978
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.802 Vali Acc: 0.794 Test Loss: 0.802 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 11.100306987762451
Epoch: 26, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.801 Vali Acc: 0.794 Test Loss: 0.801 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 11.305283546447754
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.926 Vali Acc: 0.783 Test Loss: 0.926 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 11.168118238449097
Epoch: 28, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.720 Vali Acc: 0.806 Test Loss: 0.720 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 11.172307968139648
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.924 Vali Acc: 0.783 Test Loss: 0.924 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 11.432947874069214
Epoch: 30, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
Validation loss decreased (-0.816660 --> -0.849994).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 28207503
model size : 110.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.8704833984375
Epoch: 1, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.423 Vali Acc: 0.339 Test Loss: 2.423 Test Acc: 0.339
Validation loss decreased (inf --> -0.338865).  Saving model ...
Epoch: 2 cost time: 4.809059143066406
Epoch: 2, Steps: 12 | Train Loss: 2.128 Vali Loss: 1.869 Vali Acc: 0.500 Test Loss: 1.869 Test Acc: 0.500
Validation loss decreased (-0.338865 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 4.992872476577759
Epoch: 3, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.435 Vali Acc: 0.578 Test Loss: 1.435 Test Acc: 0.578
Validation loss decreased (-0.499981 --> -0.577763).  Saving model ...
Epoch: 4 cost time: 4.8859946727752686
Epoch: 4, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.193 Vali Acc: 0.611 Test Loss: 1.193 Test Acc: 0.611
Validation loss decreased (-0.577763 --> -0.611099).  Saving model ...
Epoch: 5 cost time: 4.927165746688843
Epoch: 5, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.946 Vali Acc: 0.650 Test Loss: 0.946 Test Acc: 0.650
Validation loss decreased (-0.611099 --> -0.649991).  Saving model ...
Epoch: 6 cost time: 4.562190294265747
Epoch: 6, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.822 Vali Acc: 0.700 Test Loss: 0.822 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699992).  Saving model ...
Epoch: 7 cost time: 4.530053615570068
Epoch: 7, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.776 Vali Acc: 0.722 Test Loss: 0.776 Test Acc: 0.722
Validation loss decreased (-0.699992 --> -0.722214).  Saving model ...
Epoch: 8 cost time: 4.8161232471466064
Epoch: 8, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.689 Vali Acc: 0.750 Test Loss: 0.689 Test Acc: 0.750
Validation loss decreased (-0.722214 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 4.859900712966919
Epoch: 9, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.636 Vali Acc: 0.756 Test Loss: 0.636 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 10 cost time: 4.623004674911499
Epoch: 10, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.686 Vali Acc: 0.767 Test Loss: 0.686 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 11 cost time: 4.923223495483398
Epoch: 11, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.638 Vali Acc: 0.767 Test Loss: 0.638 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 12 cost time: 5.197490930557251
Epoch: 12, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.707 Vali Acc: 0.750 Test Loss: 0.707 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.195598363876343
Epoch: 13, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
Validation loss decreased (-0.766660 --> -0.788882).  Saving model ...
Epoch: 14 cost time: 4.989089250564575
Epoch: 14, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.716 Vali Acc: 0.772 Test Loss: 0.716 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.876909494400024
Epoch: 15, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.714 Vali Acc: 0.772 Test Loss: 0.714 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.142446756362915
Epoch: 16, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.828 Vali Acc: 0.756 Test Loss: 0.828 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.135720729827881
Epoch: 17, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.739 Vali Acc: 0.783 Test Loss: 0.739 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.961782693862915
Epoch: 18, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.728 Vali Acc: 0.789 Test Loss: 0.728 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.614169120788574
Epoch: 19, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.749 Vali Acc: 0.783 Test Loss: 0.749 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.6868367195129395
Epoch: 20, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.781 Vali Acc: 0.783 Test Loss: 0.781 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.982480525970459
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.766 Vali Acc: 0.789 Test Loss: 0.766 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.937685251235962
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.783 Vali Acc: 0.783 Test Loss: 0.783 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.692892789840698
Epoch: 23, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.787 Vali Acc: 0.794 Test Loss: 0.787 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794437).  Saving model ...
Epoch: 24 cost time: 4.67697811126709
Epoch: 24, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.707 Vali Acc: 0.800 Test Loss: 0.707 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 25 cost time: 4.990490198135376
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.769 Vali Acc: 0.783 Test Loss: 0.769 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.863303184509277
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.6956946849823
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.743 Vali Acc: 0.794 Test Loss: 0.743 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.52103066444397
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.765 Vali Acc: 0.800 Test Loss: 0.765 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.65909218788147
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.748 Vali Acc: 0.789 Test Loss: 0.748 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.6511170864105225
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.725 Vali Acc: 0.811 Test Loss: 0.725 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 8348559
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 9.89680290222168
Epoch: 1, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.483 Vali Acc: 0.222 Test Loss: 2.483 Test Acc: 0.222
Validation loss decreased (inf --> -0.222197).  Saving model ...
Epoch: 2 cost time: 7.991437196731567
Epoch: 2, Steps: 12 | Train Loss: 2.181 Vali Loss: 1.857 Vali Acc: 0.556 Test Loss: 1.857 Test Acc: 0.556
Validation loss decreased (-0.222197 --> -0.555537).  Saving model ...
Epoch: 3 cost time: 8.469733953475952
Epoch: 3, Steps: 12 | Train Loss: 1.562 Vali Loss: 1.357 Vali Acc: 0.589 Test Loss: 1.357 Test Acc: 0.589
Validation loss decreased (-0.555537 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 9.041751861572266
Epoch: 4, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.101 Vali Acc: 0.639 Test Loss: 1.101 Test Acc: 0.639
Validation loss decreased (-0.588875 --> -0.638878).  Saving model ...
Epoch: 5 cost time: 8.38647198677063
Epoch: 5, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.906 Vali Acc: 0.694 Test Loss: 0.906 Test Acc: 0.694
Validation loss decreased (-0.638878 --> -0.694435).  Saving model ...
Epoch: 6 cost time: 8.943702459335327
Epoch: 6, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.794 Vali Acc: 0.711 Test Loss: 0.794 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711103).  Saving model ...
Epoch: 7 cost time: 8.952358961105347
Epoch: 7, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.716 Vali Acc: 0.750 Test Loss: 0.716 Test Acc: 0.750
Validation loss decreased (-0.711103 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 8.40727424621582
Epoch: 8, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.682 Vali Acc: 0.728 Test Loss: 0.682 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.980010271072388
Epoch: 9, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.794 Vali Acc: 0.689 Test Loss: 0.794 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.553646564483643
Epoch: 10, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.689 Vali Acc: 0.739 Test Loss: 0.689 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.377436399459839
Epoch: 11, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.713 Vali Acc: 0.772 Test Loss: 0.713 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772215).  Saving model ...
Epoch: 12 cost time: 9.013785123825073
Epoch: 12, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.674 Vali Acc: 0.761 Test Loss: 0.674 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.126479625701904
Epoch: 13, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799994).  Saving model ...
Epoch: 14 cost time: 8.054243803024292
Epoch: 14, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.651 Vali Acc: 0.778 Test Loss: 0.651 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.894379377365112
Epoch: 15, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.703 Vali Acc: 0.783 Test Loss: 0.703 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.448999881744385
Epoch: 16, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.765 Vali Acc: 0.789 Test Loss: 0.765 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.037078857421875
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.713 Vali Acc: 0.800 Test Loss: 0.713 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.557756423950195
Epoch: 18, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.741 Vali Acc: 0.789 Test Loss: 0.741 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.933377027511597
Epoch: 19, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.617451429367065
Epoch: 20, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.796 Vali Acc: 0.794 Test Loss: 0.796 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.173163652420044
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.798 Vali Acc: 0.794 Test Loss: 0.798 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.291539192199707
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.743 Vali Acc: 0.817 Test Loss: 0.743 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816659).  Saving model ...
Epoch: 23 cost time: 9.107084035873413
Epoch: 23, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.734 Vali Acc: 0.811 Test Loss: 0.734 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.495197534561157
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.879 Vali Acc: 0.772 Test Loss: 0.879 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 8.99351978302002
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.850 Vali Acc: 0.794 Test Loss: 0.850 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 8.998303174972534
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.910 Vali Acc: 0.778 Test Loss: 0.910 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 8.480041265487671
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.820 Vali Acc: 0.822 Test Loss: 0.820 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822214).  Saving model ...
Epoch: 28 cost time: 8.480280876159668
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.773 Vali Acc: 0.822 Test Loss: 0.773 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822214).  Saving model ...
Epoch: 29 cost time: 8.747180223464966
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.783 Vali Acc: 0.828 Test Loss: 0.783 Test Acc: 0.828
Validation loss decreased (-0.822214 --> -0.827770).  Saving model ...
Epoch: 30 cost time: 8.387165069580078
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.790 Vali Acc: 0.822 Test Loss: 0.790 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 28207503
model size : 110.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.53530740737915
Epoch: 1, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.422 Vali Acc: 0.339 Test Loss: 2.422 Test Acc: 0.339
Validation loss decreased (inf --> -0.338865).  Saving model ...
Epoch: 2 cost time: 3.503382682800293
Epoch: 2, Steps: 12 | Train Loss: 2.128 Vali Loss: 1.864 Vali Acc: 0.506 Test Loss: 1.864 Test Acc: 0.506
Validation loss decreased (-0.338865 --> -0.505537).  Saving model ...
Epoch: 3 cost time: 3.5389645099639893
Epoch: 3, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.431 Vali Acc: 0.578 Test Loss: 1.431 Test Acc: 0.578
Validation loss decreased (-0.505537 --> -0.577763).  Saving model ...
Epoch: 4 cost time: 3.778168201446533
Epoch: 4, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.186 Vali Acc: 0.628 Test Loss: 1.186 Test Acc: 0.628
Validation loss decreased (-0.577763 --> -0.627766).  Saving model ...
Epoch: 5 cost time: 3.609407424926758
Epoch: 5, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.945 Vali Acc: 0.656 Test Loss: 0.945 Test Acc: 0.656
Validation loss decreased (-0.627766 --> -0.655546).  Saving model ...
Epoch: 6 cost time: 3.388929605484009
Epoch: 6, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.817 Vali Acc: 0.700 Test Loss: 0.817 Test Acc: 0.700
Validation loss decreased (-0.655546 --> -0.699992).  Saving model ...
Epoch: 7 cost time: 3.696249485015869
Epoch: 7, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.777 Vali Acc: 0.728 Test Loss: 0.777 Test Acc: 0.728
Validation loss decreased (-0.699992 --> -0.727770).  Saving model ...
Epoch: 8 cost time: 3.89365553855896
Epoch: 8, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.688 Vali Acc: 0.744 Test Loss: 0.688 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 3.9202380180358887
Epoch: 9, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.647 Vali Acc: 0.767 Test Loss: 0.647 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766660).  Saving model ...
Epoch: 10 cost time: 3.6965789794921875
Epoch: 10, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.708 Vali Acc: 0.761 Test Loss: 0.708 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6807727813720703
Epoch: 11, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.653 Vali Acc: 0.739 Test Loss: 0.653 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.995856761932373
Epoch: 12, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.712 Vali Acc: 0.744 Test Loss: 0.712 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.9046528339385986
Epoch: 13, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.667 Vali Acc: 0.772 Test Loss: 0.667 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 14 cost time: 3.670046329498291
Epoch: 14, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.712 Vali Acc: 0.783 Test Loss: 0.712 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783326).  Saving model ...
Epoch: 15 cost time: 3.6734817028045654
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.660 Vali Acc: 0.789 Test Loss: 0.660 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 3.9916398525238037
Epoch: 16, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.815 Vali Acc: 0.733 Test Loss: 0.815 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9245150089263916
Epoch: 17, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.738 Vali Acc: 0.778 Test Loss: 0.738 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.6995413303375244
Epoch: 18, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.787 Vali Acc: 0.761 Test Loss: 0.787 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.6792147159576416
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.785 Vali Acc: 0.767 Test Loss: 0.785 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.890713930130005
Epoch: 20, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.803 Vali Acc: 0.789 Test Loss: 0.803 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.828547239303589
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.782 Vali Acc: 0.778 Test Loss: 0.782 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.8096656799316406
Epoch: 22, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.795 Vali Acc: 0.772 Test Loss: 0.795 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.840780735015869
Epoch: 23, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.758 Vali Acc: 0.806 Test Loss: 0.758 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805548).  Saving model ...
Epoch: 24 cost time: 4.0994768142700195
Epoch: 24, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.774 Vali Acc: 0.800 Test Loss: 0.774 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.039921760559082
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.811 Vali Acc: 0.800 Test Loss: 0.811 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.7919960021972656
Epoch: 26, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.760 Vali Acc: 0.806 Test Loss: 0.760 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.703504800796509
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.769 Vali Acc: 0.800 Test Loss: 0.769 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.744817018508911
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.777 Vali Acc: 0.811 Test Loss: 0.777 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811103).  Saving model ...
Epoch: 29 cost time: 3.6908416748046875
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.790 Vali Acc: 0.811 Test Loss: 0.790 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5136208534240723
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.817 Vali Acc: 0.800 Test Loss: 0.817 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 8348559
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.267852544784546
Epoch: 1, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.541 Vali Acc: 0.183 Test Loss: 2.541 Test Acc: 0.183
Validation loss decreased (inf --> -0.183308).  Saving model ...
Epoch: 2 cost time: 4.4512529373168945
Epoch: 2, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.054 Vali Acc: 0.522 Test Loss: 2.054 Test Acc: 0.522
Validation loss decreased (-0.183308 --> -0.522202).  Saving model ...
Epoch: 3 cost time: 4.473198175430298
Epoch: 3, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.612 Vali Acc: 0.578 Test Loss: 1.612 Test Acc: 0.578
Validation loss decreased (-0.522202 --> -0.577762).  Saving model ...
Epoch: 4 cost time: 5.096199035644531
Epoch: 4, Steps: 12 | Train Loss: 1.308 Vali Loss: 1.351 Vali Acc: 0.600 Test Loss: 1.351 Test Acc: 0.600
Validation loss decreased (-0.577762 --> -0.599986).  Saving model ...
Epoch: 5 cost time: 4.808017730712891
Epoch: 5, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.112 Vali Acc: 0.656 Test Loss: 1.112 Test Acc: 0.656
Validation loss decreased (-0.599986 --> -0.655544).  Saving model ...
Epoch: 6 cost time: 4.8264689445495605
Epoch: 6, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.993 Vali Acc: 0.644 Test Loss: 0.993 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.095871686935425
Epoch: 7, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.996 Vali Acc: 0.672 Test Loss: 0.996 Test Acc: 0.672
Validation loss decreased (-0.655544 --> -0.672212).  Saving model ...
Epoch: 8 cost time: 4.932119846343994
Epoch: 8, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.857 Vali Acc: 0.656 Test Loss: 0.857 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.614363193511963
Epoch: 9, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.835 Vali Acc: 0.711 Test Loss: 0.835 Test Acc: 0.711
Validation loss decreased (-0.672212 --> -0.711103).  Saving model ...
Epoch: 10 cost time: 4.742345094680786
Epoch: 10, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.742 Vali Acc: 0.750 Test Loss: 0.742 Test Acc: 0.750
Validation loss decreased (-0.711103 --> -0.749993).  Saving model ...
Epoch: 11 cost time: 4.949630498886108
Epoch: 11, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.795 Vali Acc: 0.722 Test Loss: 0.795 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.599557161331177
Epoch: 12, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.688 Vali Acc: 0.767 Test Loss: 0.688 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
Epoch: 13 cost time: 4.602628469467163
Epoch: 13, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783326).  Saving model ...
Epoch: 14 cost time: 4.9678003787994385
Epoch: 14, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.695 Vali Acc: 0.783 Test Loss: 0.695 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 15 cost time: 4.693499565124512
Epoch: 15, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.677 Vali Acc: 0.817 Test Loss: 0.677 Test Acc: 0.817
Validation loss decreased (-0.783326 --> -0.816660).  Saving model ...
Epoch: 16 cost time: 4.650463104248047
Epoch: 16, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.918511152267456
Epoch: 17, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.686 Vali Acc: 0.756 Test Loss: 0.686 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.830225706100464
Epoch: 18, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.859 Vali Acc: 0.739 Test Loss: 0.859 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.567228078842163
Epoch: 19, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.780 Vali Acc: 0.767 Test Loss: 0.780 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.656103610992432
Epoch: 20, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.873 Vali Acc: 0.772 Test Loss: 0.873 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.600029230117798
Epoch: 21, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.830 Vali Acc: 0.767 Test Loss: 0.830 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.216583728790283
Epoch: 22, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.917 Vali Acc: 0.744 Test Loss: 0.917 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.220921993255615
Epoch: 23, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.743 Vali Acc: 0.767 Test Loss: 0.743 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.700990915298462
Epoch: 24, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.958 Vali Acc: 0.772 Test Loss: 0.958 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.656649589538574
Epoch: 25, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.735 Vali Acc: 0.800 Test Loss: 0.735 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 28207503
model size : 110.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.221363544464111
Epoch: 1, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.476 Vali Acc: 0.278 Test Loss: 2.476 Test Acc: 0.278
Validation loss decreased (inf --> -0.277753).  Saving model ...
Epoch: 2 cost time: 2.570021152496338
Epoch: 2, Steps: 12 | Train Loss: 2.240 Vali Loss: 2.009 Vali Acc: 0.461 Test Loss: 2.009 Test Acc: 0.461
Validation loss decreased (-0.277753 --> -0.461091).  Saving model ...
Epoch: 3 cost time: 2.6299989223480225
Epoch: 3, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.623 Vali Acc: 0.578 Test Loss: 1.623 Test Acc: 0.578
Validation loss decreased (-0.461091 --> -0.577762).  Saving model ...
Epoch: 4 cost time: 2.59680438041687
Epoch: 4, Steps: 12 | Train Loss: 1.305 Vali Loss: 1.367 Vali Acc: 0.572 Test Loss: 1.367 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5119993686676025
Epoch: 5, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.138 Vali Acc: 0.600 Test Loss: 1.138 Test Acc: 0.600
Validation loss decreased (-0.577762 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 2.7255399227142334
Epoch: 6, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.983 Vali Acc: 0.656 Test Loss: 0.983 Test Acc: 0.656
Validation loss decreased (-0.599989 --> -0.655546).  Saving model ...
Epoch: 7 cost time: 2.7795326709747314
Epoch: 7, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.910 Vali Acc: 0.672 Test Loss: 0.910 Test Acc: 0.672
Validation loss decreased (-0.655546 --> -0.672213).  Saving model ...
Epoch: 8 cost time: 2.6110894680023193
Epoch: 8, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.839 Vali Acc: 0.694 Test Loss: 0.839 Test Acc: 0.694
Validation loss decreased (-0.672213 --> -0.694436).  Saving model ...
Epoch: 9 cost time: 2.6395699977874756
Epoch: 9, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.828 Vali Acc: 0.706 Test Loss: 0.828 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705547).  Saving model ...
Epoch: 10 cost time: 2.613548755645752
Epoch: 10, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.920 Vali Acc: 0.700 Test Loss: 0.920 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7720911502838135
Epoch: 11, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.827 Vali Acc: 0.728 Test Loss: 0.827 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727770).  Saving model ...
Epoch: 12 cost time: 2.7619807720184326
Epoch: 12, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.884 Vali Acc: 0.733 Test Loss: 0.884 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733324).  Saving model ...
Epoch: 13 cost time: 2.6615686416625977
Epoch: 13, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.766 Vali Acc: 0.783 Test Loss: 0.766 Test Acc: 0.783
Validation loss decreased (-0.733324 --> -0.783326).  Saving model ...
Epoch: 14 cost time: 2.6051371097564697
Epoch: 14, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.840 Vali Acc: 0.761 Test Loss: 0.840 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6390960216522217
Epoch: 15, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.878 Vali Acc: 0.733 Test Loss: 0.878 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.801453113555908
Epoch: 16, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.868 Vali Acc: 0.772 Test Loss: 0.868 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8391029834747314
Epoch: 17, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.780 Vali Acc: 0.783 Test Loss: 0.780 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.697758197784424
Epoch: 18, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.902 Vali Acc: 0.761 Test Loss: 0.902 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.690695285797119
Epoch: 19, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.799 Vali Acc: 0.811 Test Loss: 0.799 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811103).  Saving model ...
Epoch: 20 cost time: 2.711820125579834
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.802 Vali Acc: 0.783 Test Loss: 0.802 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.623244524002075
Epoch: 21, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.807 Vali Acc: 0.800 Test Loss: 0.807 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.740865468978882
Epoch: 22, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.820 Vali Acc: 0.800 Test Loss: 0.820 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.6992783546447754
Epoch: 23, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.765 Vali Acc: 0.806 Test Loss: 0.765 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.5274627208709717
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.785 Vali Acc: 0.828 Test Loss: 0.785 Test Acc: 0.828
Validation loss decreased (-0.811103 --> -0.827770).  Saving model ...
Epoch: 25 cost time: 2.5368072986602783
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.836 Vali Acc: 0.794 Test Loss: 0.836 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5084104537963867
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.899 Vali Acc: 0.817 Test Loss: 0.899 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.6783483028411865
Epoch: 27, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.928 Vali Acc: 0.794 Test Loss: 0.928 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.803471803665161
Epoch: 28, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.937 Vali Acc: 0.783 Test Loss: 0.937 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.5578413009643555
Epoch: 29, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.967 Vali Acc: 0.811 Test Loss: 0.967 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.2965917587280273
Epoch: 30, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.901 Vali Acc: 0.811 Test Loss: 0.901 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 8348559
model size : 34.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 13.041747331619263
Epoch: 1, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.584 Vali Acc: 0.178 Test Loss: 2.584 Test Acc: 0.178
Validation loss decreased (inf --> -0.177752).  Saving model ...
Epoch: 2 cost time: 12.059861898422241
Epoch: 2, Steps: 12 | Train Loss: 2.314 Vali Loss: 2.123 Vali Acc: 0.439 Test Loss: 2.123 Test Acc: 0.439
Validation loss decreased (-0.177752 --> -0.438868).  Saving model ...
Epoch: 3 cost time: 12.305419206619263
Epoch: 3, Steps: 12 | Train Loss: 1.772 Vali Loss: 1.701 Vali Acc: 0.550 Test Loss: 1.701 Test Acc: 0.550
Validation loss decreased (-0.438868 --> -0.549983).  Saving model ...
Epoch: 4 cost time: 12.775548696517944
Epoch: 4, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.365 Vali Acc: 0.644 Test Loss: 1.365 Test Acc: 0.644
Validation loss decreased (-0.549983 --> -0.644431).  Saving model ...
Epoch: 5 cost time: 12.979413509368896
Epoch: 5, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.133 Vali Acc: 0.656 Test Loss: 1.133 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655544).  Saving model ...
Epoch: 6 cost time: 13.623866319656372
Epoch: 6, Steps: 12 | Train Loss: 0.913 Vali Loss: 1.009 Vali Acc: 0.678 Test Loss: 1.009 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677768).  Saving model ...
Epoch: 7 cost time: 13.251762628555298
Epoch: 7, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.874 Vali Acc: 0.672 Test Loss: 0.874 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.817537307739258
Epoch: 8, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.819 Vali Acc: 0.711 Test Loss: 0.819 Test Acc: 0.711
Validation loss decreased (-0.677768 --> -0.711103).  Saving model ...
Epoch: 9 cost time: 13.39974570274353
Epoch: 9, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.754 Vali Acc: 0.728 Test Loss: 0.754 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 10 cost time: 11.912683963775635
Epoch: 10, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.638 Vali Acc: 0.756 Test Loss: 0.638 Test Acc: 0.756
Validation loss decreased (-0.727770 --> -0.755549).  Saving model ...
Epoch: 11 cost time: 12.29704236984253
Epoch: 11, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.635 Vali Acc: 0.783 Test Loss: 0.635 Test Acc: 0.783
Validation loss decreased (-0.755549 --> -0.783327).  Saving model ...
Epoch: 12 cost time: 11.668482065200806
Epoch: 12, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.591 Vali Acc: 0.761 Test Loss: 0.591 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.773183822631836
Epoch: 13, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.605 Vali Acc: 0.778 Test Loss: 0.605 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.551540851593018
Epoch: 14, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.617 Vali Acc: 0.756 Test Loss: 0.617 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.990426063537598
Epoch: 15, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.656 Vali Acc: 0.767 Test Loss: 0.656 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.301453590393066
Epoch: 16, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.612 Vali Acc: 0.783 Test Loss: 0.612 Test Acc: 0.783
Validation loss decreased (-0.783327 --> -0.783327).  Saving model ...
Epoch: 17 cost time: 12.187373876571655
Epoch: 17, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.638 Vali Acc: 0.783 Test Loss: 0.638 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 13.171879053115845
Epoch: 18, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.643 Vali Acc: 0.761 Test Loss: 0.643 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 13.430410385131836
Epoch: 19, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.593 Vali Acc: 0.794 Test Loss: 0.593 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794439).  Saving model ...
Epoch: 20 cost time: 13.38843321800232
Epoch: 20, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.629 Vali Acc: 0.806 Test Loss: 0.629 Test Acc: 0.806
Validation loss decreased (-0.794439 --> -0.805549).  Saving model ...
Epoch: 21 cost time: 11.854150295257568
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.614 Vali Acc: 0.811 Test Loss: 0.614 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 22 cost time: 11.701361656188965
Epoch: 22, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 12.30806279182434
Epoch: 23, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.624 Vali Acc: 0.828 Test Loss: 0.624 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827772).  Saving model ...
Epoch: 24 cost time: 13.374561548233032
Epoch: 24, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.661 Vali Acc: 0.778 Test Loss: 0.661 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 12.252376794815063
Epoch: 25, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 12.342761278152466
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.594 Vali Acc: 0.806 Test Loss: 0.594 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 12.953383207321167
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827773).  Saving model ...
Epoch: 28 cost time: 12.929111242294312
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 12.129382848739624
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.511 Vali Acc: 0.839 Test Loss: 0.511 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838884).  Saving model ...
Epoch: 30 cost time: 11.836270570755005
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844439).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 28164687
model size : 108.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.369885683059692
Epoch: 1, Steps: 12 | Train Loss: 2.718 Vali Loss: 2.565 Vali Acc: 0.189 Test Loss: 2.565 Test Acc: 0.189
Validation loss decreased (inf --> -0.188863).  Saving model ...
Epoch: 2 cost time: 4.706289052963257
Epoch: 2, Steps: 12 | Train Loss: 2.300 Vali Loss: 2.149 Vali Acc: 0.411 Test Loss: 2.149 Test Acc: 0.411
Validation loss decreased (-0.188863 --> -0.411090).  Saving model ...
Epoch: 3 cost time: 4.303230285644531
Epoch: 3, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.775 Vali Acc: 0.461 Test Loss: 1.775 Test Acc: 0.461
Validation loss decreased (-0.411090 --> -0.461093).  Saving model ...
Epoch: 4 cost time: 4.585419654846191
Epoch: 4, Steps: 12 | Train Loss: 1.424 Vali Loss: 1.470 Vali Acc: 0.539 Test Loss: 1.470 Test Acc: 0.539
Validation loss decreased (-0.461093 --> -0.538874).  Saving model ...
Epoch: 5 cost time: 4.6687092781066895
Epoch: 5, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.248 Vali Acc: 0.578 Test Loss: 1.248 Test Acc: 0.578
Validation loss decreased (-0.538874 --> -0.577765).  Saving model ...
Epoch: 6 cost time: 4.423617124557495
Epoch: 6, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.079 Vali Acc: 0.633 Test Loss: 1.079 Test Acc: 0.633
Validation loss decreased (-0.577765 --> -0.633323).  Saving model ...
Epoch: 7 cost time: 4.984777450561523
Epoch: 7, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.955 Vali Acc: 0.639 Test Loss: 0.955 Test Acc: 0.639
Validation loss decreased (-0.633323 --> -0.638879).  Saving model ...
Epoch: 8 cost time: 5.060850381851196
Epoch: 8, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.829 Vali Acc: 0.700 Test Loss: 0.829 Test Acc: 0.700
Validation loss decreased (-0.638879 --> -0.699992).  Saving model ...
Epoch: 9 cost time: 4.842477798461914
Epoch: 9, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.725 Vali Acc: 0.717 Test Loss: 0.725 Test Acc: 0.717
Validation loss decreased (-0.699992 --> -0.716659).  Saving model ...
Epoch: 10 cost time: 5.199712753295898
Epoch: 10, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.672 Vali Acc: 0.744 Test Loss: 0.672 Test Acc: 0.744
Validation loss decreased (-0.716659 --> -0.744438).  Saving model ...
Epoch: 11 cost time: 5.084496974945068
Epoch: 11, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.685 Vali Acc: 0.739 Test Loss: 0.685 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.792890548706055
Epoch: 12, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.696 Vali Acc: 0.728 Test Loss: 0.696 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.137762546539307
Epoch: 13, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.693 Vali Acc: 0.706 Test Loss: 0.693 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.018849849700928
Epoch: 14, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.660 Vali Acc: 0.767 Test Loss: 0.660 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766660).  Saving model ...
Epoch: 15 cost time: 4.84185791015625
Epoch: 15, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.684 Vali Acc: 0.739 Test Loss: 0.684 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.755517244338989
Epoch: 16, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783327).  Saving model ...
Epoch: 17 cost time: 4.926530361175537
Epoch: 17, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.691 Vali Acc: 0.772 Test Loss: 0.691 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.576212644577026
Epoch: 18, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.668 Vali Acc: 0.778 Test Loss: 0.668 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.754550457000732
Epoch: 19, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.646 Vali Acc: 0.794 Test Loss: 0.646 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794438).  Saving model ...
Epoch: 20 cost time: 4.924676418304443
Epoch: 20, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.695 Vali Acc: 0.778 Test Loss: 0.695 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.583157539367676
Epoch: 21, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.656 Vali Acc: 0.761 Test Loss: 0.656 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.805163621902466
Epoch: 22, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.693 Vali Acc: 0.761 Test Loss: 0.693 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.801610469818115
Epoch: 23, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.654 Vali Acc: 0.794 Test Loss: 0.654 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.236863613128662
Epoch: 24, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.679 Vali Acc: 0.767 Test Loss: 0.679 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.29362678527832
Epoch: 25, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.656 Vali Acc: 0.767 Test Loss: 0.656 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.550987243652344
Epoch: 26, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.631 Vali Acc: 0.778 Test Loss: 0.631 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.214066505432129
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.648 Vali Acc: 0.783 Test Loss: 0.648 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.296870231628418
Epoch: 28, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.649 Vali Acc: 0.794 Test Loss: 0.649 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.49938702583313
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.671 Vali Acc: 0.789 Test Loss: 0.671 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 8305359
model size : 32.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 10.612324237823486
Epoch: 1, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.583 Vali Acc: 0.183 Test Loss: 2.583 Test Acc: 0.183
Validation loss decreased (inf --> -0.183308).  Saving model ...
Epoch: 2 cost time: 8.490410566329956
Epoch: 2, Steps: 12 | Train Loss: 2.316 Vali Loss: 2.118 Vali Acc: 0.444 Test Loss: 2.118 Test Acc: 0.444
Validation loss decreased (-0.183308 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 8.711592674255371
Epoch: 3, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.696 Vali Acc: 0.550 Test Loss: 1.696 Test Acc: 0.550
Validation loss decreased (-0.444423 --> -0.549983).  Saving model ...
Epoch: 4 cost time: 7.746248245239258
Epoch: 4, Steps: 12 | Train Loss: 1.406 Vali Loss: 1.362 Vali Acc: 0.656 Test Loss: 1.362 Test Acc: 0.656
Validation loss decreased (-0.549983 --> -0.655542).  Saving model ...
Epoch: 5 cost time: 8.095702409744263
Epoch: 5, Steps: 12 | Train Loss: 1.091 Vali Loss: 1.138 Vali Acc: 0.628 Test Loss: 1.138 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.527063846588135
Epoch: 6, Steps: 12 | Train Loss: 0.932 Vali Loss: 1.019 Vali Acc: 0.683 Test Loss: 1.019 Test Acc: 0.683
Validation loss decreased (-0.655542 --> -0.683323).  Saving model ...
Epoch: 7 cost time: 8.97884464263916
Epoch: 7, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.890 Vali Acc: 0.672 Test Loss: 0.890 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.649763345718384
Epoch: 8, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.813 Vali Acc: 0.694 Test Loss: 0.813 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694436).  Saving model ...
Epoch: 9 cost time: 9.207850933074951
Epoch: 9, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.738 Vali Acc: 0.700 Test Loss: 0.738 Test Acc: 0.700
Validation loss decreased (-0.694436 --> -0.699993).  Saving model ...
Epoch: 10 cost time: 8.753483057022095
Epoch: 10, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.663 Vali Acc: 0.761 Test Loss: 0.663 Test Acc: 0.761
Validation loss decreased (-0.699993 --> -0.761104).  Saving model ...
Epoch: 11 cost time: 8.10381007194519
Epoch: 11, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.667 Vali Acc: 0.733 Test Loss: 0.667 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.47593879699707
Epoch: 12, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.605 Vali Acc: 0.772 Test Loss: 0.605 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772216).  Saving model ...
Epoch: 13 cost time: 8.186996459960938
Epoch: 13, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.634 Vali Acc: 0.767 Test Loss: 0.634 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.192850112915039
Epoch: 14, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.589 Vali Acc: 0.789 Test Loss: 0.589 Test Acc: 0.789
Validation loss decreased (-0.772216 --> -0.788883).  Saving model ...
Epoch: 15 cost time: 9.096763849258423
Epoch: 15, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.657 Vali Acc: 0.750 Test Loss: 0.657 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.822522640228271
Epoch: 16, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.681 Vali Acc: 0.728 Test Loss: 0.681 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.187791347503662
Epoch: 17, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.640 Vali Acc: 0.744 Test Loss: 0.640 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.90505051612854
Epoch: 18, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.625 Vali Acc: 0.761 Test Loss: 0.625 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.16623854637146
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.545 Vali Acc: 0.811 Test Loss: 0.545 Test Acc: 0.811
Validation loss decreased (-0.788883 --> -0.811106).  Saving model ...
Epoch: 20 cost time: 8.848599195480347
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.581 Vali Acc: 0.794 Test Loss: 0.581 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.854450225830078
Epoch: 21, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.612 Vali Acc: 0.800 Test Loss: 0.612 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.198797702789307
Epoch: 22, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.617 Vali Acc: 0.806 Test Loss: 0.617 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 8.565950155258179
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 8.951976299285889
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.634 Vali Acc: 0.811 Test Loss: 0.634 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.760622501373291
Epoch: 25, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.653 Vali Acc: 0.789 Test Loss: 0.653 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.91919469833374
Epoch: 26, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.657 Vali Acc: 0.794 Test Loss: 0.657 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.894395589828491
Epoch: 27, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.738 Vali Acc: 0.778 Test Loss: 0.738 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.804618835449219
Epoch: 28, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.638 Vali Acc: 0.806 Test Loss: 0.638 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 8.274219512939453
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.661 Vali Acc: 0.794 Test Loss: 0.661 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 8.612569093704224
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.632 Vali Acc: 0.811 Test Loss: 0.632 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 28164687
model size : 108.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.86747932434082
Epoch: 1, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.564 Vali Acc: 0.194 Test Loss: 2.564 Test Acc: 0.194
Validation loss decreased (inf --> -0.194419).  Saving model ...
Epoch: 2 cost time: 3.945629119873047
Epoch: 2, Steps: 12 | Train Loss: 2.300 Vali Loss: 2.147 Vali Acc: 0.400 Test Loss: 2.147 Test Acc: 0.400
Validation loss decreased (-0.194419 --> -0.399979).  Saving model ...
Epoch: 3 cost time: 3.8696346282958984
Epoch: 3, Steps: 12 | Train Loss: 1.878 Vali Loss: 1.773 Vali Acc: 0.467 Test Loss: 1.773 Test Acc: 0.467
Validation loss decreased (-0.399979 --> -0.466649).  Saving model ...
Epoch: 4 cost time: 3.8624231815338135
Epoch: 4, Steps: 12 | Train Loss: 1.429 Vali Loss: 1.470 Vali Acc: 0.533 Test Loss: 1.470 Test Acc: 0.533
Validation loss decreased (-0.466649 --> -0.533319).  Saving model ...
Epoch: 5 cost time: 3.935229778289795
Epoch: 5, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.250 Vali Acc: 0.578 Test Loss: 1.250 Test Acc: 0.578
Validation loss decreased (-0.533319 --> -0.577765).  Saving model ...
Epoch: 6 cost time: 3.9770138263702393
Epoch: 6, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.086 Vali Acc: 0.644 Test Loss: 1.086 Test Acc: 0.644
Validation loss decreased (-0.577765 --> -0.644434).  Saving model ...
Epoch: 7 cost time: 3.5653021335601807
Epoch: 7, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.963 Vali Acc: 0.656 Test Loss: 0.963 Test Acc: 0.656
Validation loss decreased (-0.644434 --> -0.655546).  Saving model ...
Epoch: 8 cost time: 3.9123950004577637
Epoch: 8, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.852 Vali Acc: 0.689 Test Loss: 0.852 Test Acc: 0.689
Validation loss decreased (-0.655546 --> -0.688880).  Saving model ...
Epoch: 9 cost time: 4.099954843521118
Epoch: 9, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.755 Vali Acc: 0.689 Test Loss: 0.755 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688881).  Saving model ...
Epoch: 10 cost time: 3.8655834197998047
Epoch: 10, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.709 Vali Acc: 0.722 Test Loss: 0.709 Test Acc: 0.722
Validation loss decreased (-0.688881 --> -0.722215).  Saving model ...
Epoch: 11 cost time: 3.9041097164154053
Epoch: 11, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.700 Vali Acc: 0.728 Test Loss: 0.700 Test Acc: 0.728
Validation loss decreased (-0.722215 --> -0.727771).  Saving model ...
Epoch: 12 cost time: 4.115867853164673
Epoch: 12, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.681 Vali Acc: 0.728 Test Loss: 0.681 Test Acc: 0.728
Validation loss decreased (-0.727771 --> -0.727771).  Saving model ...
Epoch: 13 cost time: 3.8392155170440674
Epoch: 13, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.728 Vali Acc: 0.711 Test Loss: 0.728 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8534018993377686
Epoch: 14, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.649 Vali Acc: 0.744 Test Loss: 0.649 Test Acc: 0.744
Validation loss decreased (-0.727771 --> -0.744438).  Saving model ...
Epoch: 15 cost time: 3.8119120597839355
Epoch: 15, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.696 Vali Acc: 0.739 Test Loss: 0.696 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.602979898452759
Epoch: 16, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.670 Vali Acc: 0.761 Test Loss: 0.670 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761104).  Saving model ...
Epoch: 17 cost time: 3.5064644813537598
Epoch: 17, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.702 Vali Acc: 0.767 Test Loss: 0.702 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 18 cost time: 3.6426799297332764
Epoch: 18, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.695 Vali Acc: 0.767 Test Loss: 0.695 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 19 cost time: 3.6527504920959473
Epoch: 19, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.650 Vali Acc: 0.789 Test Loss: 0.650 Test Acc: 0.789
Validation loss decreased (-0.766660 --> -0.788882).  Saving model ...
Epoch: 20 cost time: 3.543955087661743
Epoch: 20, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.687 Vali Acc: 0.772 Test Loss: 0.687 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.530102252960205
Epoch: 21, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.708 Vali Acc: 0.744 Test Loss: 0.708 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.7375552654266357
Epoch: 22, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.720 Vali Acc: 0.761 Test Loss: 0.720 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5470893383026123
Epoch: 23, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.628 Vali Acc: 0.811 Test Loss: 0.628 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811105).  Saving model ...
Epoch: 24 cost time: 3.918487548828125
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.685 Vali Acc: 0.783 Test Loss: 0.685 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.061336994171143
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.645 Vali Acc: 0.767 Test Loss: 0.645 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8585851192474365
Epoch: 26, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.633 Vali Acc: 0.817 Test Loss: 0.633 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 27 cost time: 4.071705341339111
Epoch: 27, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.10676908493042
Epoch: 28, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.698 Vali Acc: 0.783 Test Loss: 0.698 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.915959358215332
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.630 Vali Acc: 0.794 Test Loss: 0.630 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.914612293243408
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.715 Vali Acc: 0.794 Test Loss: 0.715 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 8305359
model size : 32.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.682539701461792
Epoch: 1, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.645 Vali Acc: 0.133 Test Loss: 2.645 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 5.387206554412842
Epoch: 2, Steps: 12 | Train Loss: 2.449 Vali Loss: 2.301 Vali Acc: 0.372 Test Loss: 2.301 Test Acc: 0.372
Validation loss decreased (-0.133307 --> -0.372199).  Saving model ...
Epoch: 3 cost time: 5.167725324630737
Epoch: 3, Steps: 12 | Train Loss: 2.029 Vali Loss: 1.937 Vali Acc: 0.561 Test Loss: 1.937 Test Acc: 0.561
Validation loss decreased (-0.372199 --> -0.561092).  Saving model ...
Epoch: 4 cost time: 5.393286228179932
Epoch: 4, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.623 Vali Acc: 0.583 Test Loss: 1.623 Test Acc: 0.583
Validation loss decreased (-0.561092 --> -0.583317).  Saving model ...
Epoch: 5 cost time: 5.131802558898926
Epoch: 5, Steps: 12 | Train Loss: 1.398 Vali Loss: 1.400 Vali Acc: 0.583 Test Loss: 1.400 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583319).  Saving model ...
Epoch: 6 cost time: 5.143760919570923
Epoch: 6, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.265 Vali Acc: 0.600 Test Loss: 1.265 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 4.867189407348633
Epoch: 7, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.104 Vali Acc: 0.617 Test Loss: 1.104 Test Acc: 0.617
Validation loss decreased (-0.599987 --> -0.616656).  Saving model ...
Epoch: 8 cost time: 5.1653971672058105
Epoch: 8, Steps: 12 | Train Loss: 0.775 Vali Loss: 1.009 Vali Acc: 0.661 Test Loss: 1.009 Test Acc: 0.661
Validation loss decreased (-0.616656 --> -0.661101).  Saving model ...
Epoch: 9 cost time: 5.128579378128052
Epoch: 9, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.880 Vali Acc: 0.689 Test Loss: 0.880 Test Acc: 0.689
Validation loss decreased (-0.661101 --> -0.688880).  Saving model ...
Epoch: 10 cost time: 4.983638048171997
Epoch: 10, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.824 Vali Acc: 0.706 Test Loss: 0.824 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705547).  Saving model ...
Epoch: 11 cost time: 4.926021337509155
Epoch: 11, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.789 Vali Acc: 0.706 Test Loss: 0.789 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705548).  Saving model ...
Epoch: 12 cost time: 5.284847974777222
Epoch: 12, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.725 Vali Acc: 0.744 Test Loss: 0.725 Test Acc: 0.744
Validation loss decreased (-0.705548 --> -0.744437).  Saving model ...
Epoch: 13 cost time: 5.078613758087158
Epoch: 13, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.687 Vali Acc: 0.744 Test Loss: 0.687 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744438).  Saving model ...
Epoch: 14 cost time: 5.340167284011841
Epoch: 14, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.665 Vali Acc: 0.756 Test Loss: 0.665 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 15 cost time: 5.710344314575195
Epoch: 15, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.766 Vali Acc: 0.728 Test Loss: 0.766 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.5440778732299805
Epoch: 16, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.663 Vali Acc: 0.783 Test Loss: 0.663 Test Acc: 0.783
Validation loss decreased (-0.755549 --> -0.783327).  Saving model ...
Epoch: 17 cost time: 5.43181586265564
Epoch: 17, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.623 Vali Acc: 0.811 Test Loss: 0.623 Test Acc: 0.811
Validation loss decreased (-0.783327 --> -0.811105).  Saving model ...
Epoch: 18 cost time: 5.409627199172974
Epoch: 18, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.599 Vali Acc: 0.794 Test Loss: 0.599 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.572862386703491
Epoch: 19, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.927999019622803
Epoch: 20, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 21 cost time: 5.624579429626465
Epoch: 21, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.710 Vali Acc: 0.794 Test Loss: 0.710 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.662940740585327
Epoch: 22, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.921 Vali Acc: 0.694 Test Loss: 0.921 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.9276697635650635
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.652 Vali Acc: 0.794 Test Loss: 0.652 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.859847784042358
Epoch: 24, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.654 Vali Acc: 0.789 Test Loss: 0.654 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.644034385681152
Epoch: 25, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.744 Vali Acc: 0.783 Test Loss: 0.744 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.586647033691406
Epoch: 26, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.772 Vali Acc: 0.756 Test Loss: 0.772 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.107362747192383
Epoch: 27, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.901 Vali Acc: 0.794 Test Loss: 0.901 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.110381364822388
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.649 Vali Acc: 0.778 Test Loss: 0.649 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.765163421630859
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.757 Vali Acc: 0.772 Test Loss: 0.757 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.33369779586792
Epoch: 30, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 28164687
model size : 108.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.50016713142395
Epoch: 1, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.624 Vali Acc: 0.122 Test Loss: 2.624 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 2.6671221256256104
Epoch: 2, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.321 Vali Acc: 0.317 Test Loss: 2.321 Test Acc: 0.317
Validation loss decreased (-0.122196 --> -0.316643).  Saving model ...
Epoch: 3 cost time: 2.73007869720459
Epoch: 3, Steps: 12 | Train Loss: 2.125 Vali Loss: 1.980 Vali Acc: 0.444 Test Loss: 1.980 Test Acc: 0.444
Validation loss decreased (-0.316643 --> -0.444425).  Saving model ...
Epoch: 4 cost time: 2.7114312648773193
Epoch: 4, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.698 Vali Acc: 0.506 Test Loss: 1.698 Test Acc: 0.506
Validation loss decreased (-0.444425 --> -0.505539).  Saving model ...
Epoch: 5 cost time: 2.8650503158569336
Epoch: 5, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.483 Vali Acc: 0.533 Test Loss: 1.483 Test Acc: 0.533
Validation loss decreased (-0.505539 --> -0.533319).  Saving model ...
Epoch: 6 cost time: 2.9943768978118896
Epoch: 6, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.314 Vali Acc: 0.567 Test Loss: 1.314 Test Acc: 0.567
Validation loss decreased (-0.533319 --> -0.566654).  Saving model ...
Epoch: 7 cost time: 2.93538761138916
Epoch: 7, Steps: 12 | Train Loss: 0.973 Vali Loss: 1.168 Vali Acc: 0.594 Test Loss: 1.168 Test Acc: 0.594
Validation loss decreased (-0.566654 --> -0.594433).  Saving model ...
Epoch: 8 cost time: 2.9351577758789062
Epoch: 8, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.037 Vali Acc: 0.650 Test Loss: 1.037 Test Acc: 0.650
Validation loss decreased (-0.594433 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 2.896742343902588
Epoch: 9, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.928 Vali Acc: 0.656 Test Loss: 0.928 Test Acc: 0.656
Validation loss decreased (-0.649990 --> -0.655546).  Saving model ...
Epoch: 10 cost time: 2.95558762550354
Epoch: 10, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.839 Vali Acc: 0.694 Test Loss: 0.839 Test Acc: 0.694
Validation loss decreased (-0.655546 --> -0.694436).  Saving model ...
Epoch: 11 cost time: 3.101513147354126
Epoch: 11, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.825 Vali Acc: 0.706 Test Loss: 0.825 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705547).  Saving model ...
Epoch: 12 cost time: 3.115309238433838
Epoch: 12, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.771 Vali Acc: 0.711 Test Loss: 0.771 Test Acc: 0.711
Validation loss decreased (-0.705547 --> -0.711103).  Saving model ...
Epoch: 13 cost time: 3.1307525634765625
Epoch: 13, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.794 Vali Acc: 0.706 Test Loss: 0.794 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0637385845184326
Epoch: 14, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.801 Vali Acc: 0.728 Test Loss: 0.801 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 15 cost time: 3.031479597091675
Epoch: 15, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 2.9900267124176025
Epoch: 16, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.773 Vali Acc: 0.739 Test Loss: 0.773 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1773626804351807
Epoch: 17, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.761 Vali Acc: 0.756 Test Loss: 0.761 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 18 cost time: 3.1814355850219727
Epoch: 18, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.776 Vali Acc: 0.772 Test Loss: 0.776 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772214).  Saving model ...
Epoch: 19 cost time: 3.24125599861145
Epoch: 19, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.726 Vali Acc: 0.772 Test Loss: 0.726 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772215).  Saving model ...
Epoch: 20 cost time: 3.0700602531433105
Epoch: 20, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.746 Vali Acc: 0.767 Test Loss: 0.746 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.058112144470215
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.680 Vali Acc: 0.806 Test Loss: 0.680 Test Acc: 0.806
Validation loss decreased (-0.772215 --> -0.805549).  Saving model ...
Epoch: 22 cost time: 3.0644450187683105
Epoch: 22, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.743 Vali Acc: 0.794 Test Loss: 0.743 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0654382705688477
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.850 Vali Acc: 0.783 Test Loss: 0.850 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.216961145401001
Epoch: 24, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.815 Vali Acc: 0.761 Test Loss: 0.815 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.2533774375915527
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.821 Vali Acc: 0.761 Test Loss: 0.821 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.0791029930114746
Epoch: 26, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.821 Vali Acc: 0.739 Test Loss: 0.821 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.0553107261657715
Epoch: 27, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.738 Vali Acc: 0.783 Test Loss: 0.738 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.0071234703063965
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.733 Vali Acc: 0.811 Test Loss: 0.733 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811104).  Saving model ...
Epoch: 29 cost time: 3.095663070678711
Epoch: 29, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.682 Vali Acc: 0.794 Test Loss: 0.682 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.1925368309020996
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.871 Vali Acc: 0.794 Test Loss: 0.871 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 8305359
model size : 32.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 9.359870910644531
Epoch: 1, Steps: 12 | Train Loss: 2.712 Vali Loss: 2.547 Vali Acc: 0.150 Test Loss: 2.547 Test Acc: 0.150
Validation loss decreased (inf --> -0.149975).  Saving model ...
Epoch: 2 cost time: 7.782968997955322
Epoch: 2, Steps: 12 | Train Loss: 2.370 Vali Loss: 2.184 Vali Acc: 0.433 Test Loss: 2.184 Test Acc: 0.433
Validation loss decreased (-0.149975 --> -0.433311).  Saving model ...
Epoch: 3 cost time: 7.897061586380005
Epoch: 3, Steps: 12 | Train Loss: 1.951 Vali Loss: 1.806 Vali Acc: 0.506 Test Loss: 1.806 Test Acc: 0.506
Validation loss decreased (-0.433311 --> -0.505537).  Saving model ...
Epoch: 4 cost time: 7.271488666534424
Epoch: 4, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.476 Vali Acc: 0.583 Test Loss: 1.476 Test Acc: 0.583
Validation loss decreased (-0.505537 --> -0.583319).  Saving model ...
Epoch: 5 cost time: 7.820374250411987
Epoch: 5, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.207 Vali Acc: 0.656 Test Loss: 1.207 Test Acc: 0.656
Validation loss decreased (-0.583319 --> -0.655543).  Saving model ...
Epoch: 6 cost time: 8.220124244689941
Epoch: 6, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.042 Vali Acc: 0.644 Test Loss: 1.042 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.922544002532959
Epoch: 7, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.925 Vali Acc: 0.672 Test Loss: 0.925 Test Acc: 0.672
Validation loss decreased (-0.655543 --> -0.672213).  Saving model ...
Epoch: 8 cost time: 8.5079185962677
Epoch: 8, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.854 Vali Acc: 0.683 Test Loss: 0.854 Test Acc: 0.683
Validation loss decreased (-0.672213 --> -0.683325).  Saving model ...
Epoch: 9 cost time: 8.047664880752563
Epoch: 9, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.750 Vali Acc: 0.733 Test Loss: 0.750 Test Acc: 0.733
Validation loss decreased (-0.683325 --> -0.733326).  Saving model ...
Epoch: 10 cost time: 7.988782167434692
Epoch: 10, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.673 Vali Acc: 0.711 Test Loss: 0.673 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.474064588546753
Epoch: 11, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.659 Vali Acc: 0.750 Test Loss: 0.659 Test Acc: 0.750
Validation loss decreased (-0.733326 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 7.933014869689941
Epoch: 12, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.655 Vali Acc: 0.739 Test Loss: 0.655 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.13627815246582
Epoch: 13, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.700 Vali Acc: 0.756 Test Loss: 0.700 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 8.488497734069824
Epoch: 14, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.689 Vali Acc: 0.750 Test Loss: 0.689 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.965936660766602
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.667 Vali Acc: 0.789 Test Loss: 0.667 Test Acc: 0.789
Validation loss decreased (-0.755549 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 8.449623107910156
Epoch: 16, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.669 Vali Acc: 0.750 Test Loss: 0.669 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.878236770629883
Epoch: 17, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.674 Vali Acc: 0.772 Test Loss: 0.674 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.537825584411621
Epoch: 18, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.678 Vali Acc: 0.772 Test Loss: 0.678 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.083468914031982
Epoch: 19, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.633 Vali Acc: 0.778 Test Loss: 0.633 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.663448333740234
Epoch: 20, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.649 Vali Acc: 0.767 Test Loss: 0.649 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.507850408554077
Epoch: 21, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 8.641345262527466
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.642 Vali Acc: 0.794 Test Loss: 0.642 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.256900072097778
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.643 Vali Acc: 0.811 Test Loss: 0.643 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 24 cost time: 8.324660778045654
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.675 Vali Acc: 0.794 Test Loss: 0.675 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.694722890853882
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 8.133981704711914
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.661 Vali Acc: 0.789 Test Loss: 0.661 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 8.555074453353882
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.660 Vali Acc: 0.811 Test Loss: 0.660 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 8.641664505004883
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.690 Vali Acc: 0.800 Test Loss: 0.690 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 8.659966707229614
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.723 Vali Acc: 0.794 Test Loss: 0.723 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 9.135419130325317
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.718 Vali Acc: 0.794 Test Loss: 0.718 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 14104911
model size : 55.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.351778030395508
Epoch: 1, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.619 Vali Acc: 0.139 Test Loss: 2.619 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 3.6618099212646484
Epoch: 2, Steps: 12 | Train Loss: 2.466 Vali Loss: 2.221 Vali Acc: 0.344 Test Loss: 2.221 Test Acc: 0.344
Validation loss decreased (-0.138863 --> -0.344422).  Saving model ...
Epoch: 3 cost time: 3.801255226135254
Epoch: 3, Steps: 12 | Train Loss: 2.000 Vali Loss: 1.824 Vali Acc: 0.506 Test Loss: 1.824 Test Acc: 0.506
Validation loss decreased (-0.344422 --> -0.505537).  Saving model ...
Epoch: 4 cost time: 3.593210458755493
Epoch: 4, Steps: 12 | Train Loss: 1.549 Vali Loss: 1.501 Vali Acc: 0.544 Test Loss: 1.501 Test Acc: 0.544
Validation loss decreased (-0.505537 --> -0.544429).  Saving model ...
Epoch: 5 cost time: 3.4152591228485107
Epoch: 5, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.255 Vali Acc: 0.583 Test Loss: 1.255 Test Acc: 0.583
Validation loss decreased (-0.544429 --> -0.583321).  Saving model ...
Epoch: 6 cost time: 3.447354316711426
Epoch: 6, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.053 Vali Acc: 0.622 Test Loss: 1.053 Test Acc: 0.622
Validation loss decreased (-0.583321 --> -0.622212).  Saving model ...
Epoch: 7 cost time: 3.3910481929779053
Epoch: 7, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.912 Vali Acc: 0.689 Test Loss: 0.912 Test Acc: 0.689
Validation loss decreased (-0.622212 --> -0.688880).  Saving model ...
Epoch: 8 cost time: 3.6646060943603516
Epoch: 8, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.805 Vali Acc: 0.678 Test Loss: 0.805 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.572291612625122
Epoch: 9, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.723 Vali Acc: 0.750 Test Loss: 0.723 Test Acc: 0.750
Validation loss decreased (-0.688880 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 3.7610297203063965
Epoch: 10, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.707 Vali Acc: 0.722 Test Loss: 0.707 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.386852741241455
Epoch: 11, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.672 Vali Acc: 0.728 Test Loss: 0.672 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4921319484710693
Epoch: 12, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.682 Vali Acc: 0.711 Test Loss: 0.682 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.3950819969177246
Epoch: 13, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.652 Vali Acc: 0.767 Test Loss: 0.652 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
Epoch: 14 cost time: 3.929494619369507
Epoch: 14, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.657 Vali Acc: 0.750 Test Loss: 0.657 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8772928714752197
Epoch: 15, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.670 Vali Acc: 0.750 Test Loss: 0.670 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.9213154315948486
Epoch: 16, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.631 Vali Acc: 0.772 Test Loss: 0.631 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 17 cost time: 3.5718607902526855
Epoch: 17, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.635 Vali Acc: 0.794 Test Loss: 0.635 Test Acc: 0.794
Validation loss decreased (-0.772216 --> -0.794438).  Saving model ...
Epoch: 18 cost time: 3.6387650966644287
Epoch: 18, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.659 Vali Acc: 0.789 Test Loss: 0.659 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5562150478363037
Epoch: 19, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.678 Vali Acc: 0.778 Test Loss: 0.678 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8623483180999756
Epoch: 20, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.761 Vali Acc: 0.756 Test Loss: 0.761 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.744258403778076
Epoch: 21, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.719 Vali Acc: 0.761 Test Loss: 0.719 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.622366428375244
Epoch: 22, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.787 Vali Acc: 0.767 Test Loss: 0.787 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.6714906692504883
Epoch: 23, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.697 Vali Acc: 0.756 Test Loss: 0.697 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.6573779582977295
Epoch: 24, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.827 Vali Acc: 0.761 Test Loss: 0.827 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.9748077392578125
Epoch: 25, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.702 Vali Acc: 0.772 Test Loss: 0.702 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.7887167930603027
Epoch: 26, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.759 Vali Acc: 0.761 Test Loss: 0.759 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.9368398189544678
Epoch: 27, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 28 cost time: 3.5558786392211914
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.853 Vali Acc: 0.767 Test Loss: 0.853 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.5887675285339355
Epoch: 29, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.563819169998169
Epoch: 30, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.884 Vali Acc: 0.756 Test Loss: 0.884 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 4175055
model size : 17.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.428848266601562
Epoch: 1, Steps: 12 | Train Loss: 2.712 Vali Loss: 2.547 Vali Acc: 0.150 Test Loss: 2.547 Test Acc: 0.150
Validation loss decreased (inf --> -0.149975).  Saving model ...
Epoch: 2 cost time: 6.207440137863159
Epoch: 2, Steps: 12 | Train Loss: 2.371 Vali Loss: 2.182 Vali Acc: 0.433 Test Loss: 2.182 Test Acc: 0.433
Validation loss decreased (-0.149975 --> -0.433312).  Saving model ...
Epoch: 3 cost time: 6.268238067626953
Epoch: 3, Steps: 12 | Train Loss: 1.955 Vali Loss: 1.803 Vali Acc: 0.506 Test Loss: 1.803 Test Acc: 0.506
Validation loss decreased (-0.433312 --> -0.505538).  Saving model ...
Epoch: 4 cost time: 6.007849454879761
Epoch: 4, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.472 Vali Acc: 0.589 Test Loss: 1.472 Test Acc: 0.589
Validation loss decreased (-0.505538 --> -0.588874).  Saving model ...
Epoch: 5 cost time: 5.711139678955078
Epoch: 5, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.202 Vali Acc: 0.678 Test Loss: 1.202 Test Acc: 0.678
Validation loss decreased (-0.588874 --> -0.677766).  Saving model ...
Epoch: 6 cost time: 5.881541967391968
Epoch: 6, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.040 Vali Acc: 0.644 Test Loss: 1.040 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.861678838729858
Epoch: 7, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.924 Vali Acc: 0.672 Test Loss: 0.924 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.098687410354614
Epoch: 8, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.850 Vali Acc: 0.678 Test Loss: 0.850 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677769).  Saving model ...
Epoch: 9 cost time: 5.7847208976745605
Epoch: 9, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.762 Vali Acc: 0.706 Test Loss: 0.762 Test Acc: 0.706
Validation loss decreased (-0.677769 --> -0.705548).  Saving model ...
Epoch: 10 cost time: 5.799185514450073
Epoch: 10, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.689 Vali Acc: 0.711 Test Loss: 0.689 Test Acc: 0.711
Validation loss decreased (-0.705548 --> -0.711104).  Saving model ...
Epoch: 11 cost time: 6.021076202392578
Epoch: 11, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.672 Vali Acc: 0.728 Test Loss: 0.672 Test Acc: 0.728
Validation loss decreased (-0.711104 --> -0.727771).  Saving model ...
Epoch: 12 cost time: 6.380681037902832
Epoch: 12, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.638 Vali Acc: 0.761 Test Loss: 0.638 Test Acc: 0.761
Validation loss decreased (-0.727771 --> -0.761105).  Saving model ...
Epoch: 13 cost time: 6.038815498352051
Epoch: 13, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.702 Vali Acc: 0.772 Test Loss: 0.702 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772215).  Saving model ...
Epoch: 14 cost time: 6.3913116455078125
Epoch: 14, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.638 Vali Acc: 0.767 Test Loss: 0.638 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.207082509994507
Epoch: 15, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.640 Vali Acc: 0.778 Test Loss: 0.640 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 16 cost time: 6.019443988800049
Epoch: 16, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.641 Vali Acc: 0.778 Test Loss: 0.641 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.147385358810425
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.662 Vali Acc: 0.778 Test Loss: 0.662 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.956465005874634
Epoch: 18, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.673 Vali Acc: 0.767 Test Loss: 0.673 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.909862279891968
Epoch: 19, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.630 Vali Acc: 0.778 Test Loss: 0.630 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 20 cost time: 6.2975358963012695
Epoch: 20, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.632 Vali Acc: 0.794 Test Loss: 0.632 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794438).  Saving model ...
Epoch: 21 cost time: 6.185665130615234
Epoch: 21, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.749 Vali Acc: 0.778 Test Loss: 0.749 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.058407783508301
Epoch: 22, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.651 Vali Acc: 0.800 Test Loss: 0.651 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 6.255594730377197
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.678 Vali Acc: 0.789 Test Loss: 0.678 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.445013761520386
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.657 Vali Acc: 0.794 Test Loss: 0.657 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.497464656829834
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.696 Vali Acc: 0.811 Test Loss: 0.696 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 26 cost time: 5.737082242965698
Epoch: 26, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.658 Vali Acc: 0.822 Test Loss: 0.658 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 27 cost time: 5.585096120834351
Epoch: 27, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.752 Vali Acc: 0.811 Test Loss: 0.752 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.6076250076293945
Epoch: 28, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.690 Vali Acc: 0.794 Test Loss: 0.690 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.865397214889526
Epoch: 29, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.654 Vali Acc: 0.822 Test Loss: 0.654 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 30 cost time: 6.032341241836548
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.699 Vali Acc: 0.828 Test Loss: 0.699 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 14104911
model size : 55.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.639836072921753
Epoch: 1, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.618 Vali Acc: 0.139 Test Loss: 2.618 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 2.931156635284424
Epoch: 2, Steps: 12 | Train Loss: 2.466 Vali Loss: 2.219 Vali Acc: 0.339 Test Loss: 2.219 Test Acc: 0.339
Validation loss decreased (-0.138863 --> -0.338867).  Saving model ...
Epoch: 3 cost time: 2.9050235748291016
Epoch: 3, Steps: 12 | Train Loss: 2.001 Vali Loss: 1.820 Vali Acc: 0.511 Test Loss: 1.820 Test Acc: 0.511
Validation loss decreased (-0.338867 --> -0.511093).  Saving model ...
Epoch: 4 cost time: 2.9552574157714844
Epoch: 4, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.498 Vali Acc: 0.533 Test Loss: 1.498 Test Acc: 0.533
Validation loss decreased (-0.511093 --> -0.533318).  Saving model ...
Epoch: 5 cost time: 2.9280271530151367
Epoch: 5, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.253 Vali Acc: 0.589 Test Loss: 1.253 Test Acc: 0.589
Validation loss decreased (-0.533318 --> -0.588876).  Saving model ...
Epoch: 6 cost time: 3.049755334854126
Epoch: 6, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.055 Vali Acc: 0.622 Test Loss: 1.055 Test Acc: 0.622
Validation loss decreased (-0.588876 --> -0.622212).  Saving model ...
Epoch: 7 cost time: 2.8248918056488037
Epoch: 7, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.921 Vali Acc: 0.678 Test Loss: 0.921 Test Acc: 0.678
Validation loss decreased (-0.622212 --> -0.677769).  Saving model ...
Epoch: 8 cost time: 2.8622782230377197
Epoch: 8, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.810 Vali Acc: 0.678 Test Loss: 0.810 Test Acc: 0.678
Validation loss decreased (-0.677769 --> -0.677770).  Saving model ...
Epoch: 9 cost time: 2.8552942276000977
Epoch: 9, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.743 Vali Acc: 0.733 Test Loss: 0.743 Test Acc: 0.733
Validation loss decreased (-0.677770 --> -0.733326).  Saving model ...
Epoch: 10 cost time: 2.974196672439575
Epoch: 10, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.716 Vali Acc: 0.717 Test Loss: 0.716 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.941239833831787
Epoch: 11, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.673 Vali Acc: 0.717 Test Loss: 0.673 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9876534938812256
Epoch: 12, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.689 Vali Acc: 0.694 Test Loss: 0.689 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.830200433731079
Epoch: 13, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.649 Vali Acc: 0.767 Test Loss: 0.649 Test Acc: 0.767
Validation loss decreased (-0.733326 --> -0.766660).  Saving model ...
Epoch: 14 cost time: 2.8808469772338867
Epoch: 14, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8129324913024902
Epoch: 15, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.611 Vali Acc: 0.767 Test Loss: 0.611 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766661).  Saving model ...
Epoch: 16 cost time: 2.974576711654663
Epoch: 16, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.601 Vali Acc: 0.772 Test Loss: 0.601 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772216).  Saving model ...
Epoch: 17 cost time: 2.9848949909210205
Epoch: 17, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.630 Vali Acc: 0.772 Test Loss: 0.630 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7686119079589844
Epoch: 18, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.638 Vali Acc: 0.778 Test Loss: 0.638 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777771).  Saving model ...
Epoch: 19 cost time: 2.767484664916992
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.689 Vali Acc: 0.778 Test Loss: 0.689 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.783068895339966
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.723 Vali Acc: 0.756 Test Loss: 0.723 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.927778720855713
Epoch: 21, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.673 Vali Acc: 0.772 Test Loss: 0.673 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7734498977661133
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.816 Vali Acc: 0.733 Test Loss: 0.816 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.647211790084839
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.714 Vali Acc: 0.728 Test Loss: 0.714 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.53890323638916
Epoch: 24, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.798 Vali Acc: 0.761 Test Loss: 0.798 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.5879242420196533
Epoch: 25, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.737 Vali Acc: 0.772 Test Loss: 0.737 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.576714038848877
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.725 Vali Acc: 0.778 Test Loss: 0.725 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.583144426345825
Epoch: 27, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.729 Vali Acc: 0.778 Test Loss: 0.729 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.772634506225586
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.776 Vali Acc: 0.772 Test Loss: 0.776 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 4175055
model size : 17.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.160332441329956
Epoch: 1, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.583 Vali Acc: 0.122 Test Loss: 2.583 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 3.325941801071167
Epoch: 2, Steps: 12 | Train Loss: 2.463 Vali Loss: 2.307 Vali Acc: 0.394 Test Loss: 2.307 Test Acc: 0.394
Validation loss decreased (-0.122196 --> -0.394421).  Saving model ...
Epoch: 3 cost time: 3.2990384101867676
Epoch: 3, Steps: 12 | Train Loss: 2.145 Vali Loss: 2.003 Vali Acc: 0.478 Test Loss: 2.003 Test Acc: 0.478
Validation loss decreased (-0.394421 --> -0.477758).  Saving model ...
Epoch: 4 cost time: 3.5826869010925293
Epoch: 4, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.723 Vali Acc: 0.578 Test Loss: 1.723 Test Acc: 0.578
Validation loss decreased (-0.477758 --> -0.577761).  Saving model ...
Epoch: 5 cost time: 3.4720795154571533
Epoch: 5, Steps: 12 | Train Loss: 1.473 Vali Loss: 1.489 Vali Acc: 0.622 Test Loss: 1.489 Test Acc: 0.622
Validation loss decreased (-0.577761 --> -0.622207).  Saving model ...
Epoch: 6 cost time: 3.6655149459838867
Epoch: 6, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.305 Vali Acc: 0.600 Test Loss: 1.305 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.888218402862549
Epoch: 7, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.144 Vali Acc: 0.611 Test Loss: 1.144 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5535476207733154
Epoch: 8, Steps: 12 | Train Loss: 0.803 Vali Loss: 1.029 Vali Acc: 0.628 Test Loss: 1.029 Test Acc: 0.628
Validation loss decreased (-0.622207 --> -0.627767).  Saving model ...
Epoch: 9 cost time: 3.6654961109161377
Epoch: 9, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.890 Vali Acc: 0.689 Test Loss: 0.890 Test Acc: 0.689
Validation loss decreased (-0.627767 --> -0.688880).  Saving model ...
Epoch: 10 cost time: 3.825976610183716
Epoch: 10, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.795 Vali Acc: 0.706 Test Loss: 0.795 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705548).  Saving model ...
Epoch: 11 cost time: 3.754237174987793
Epoch: 11, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
Validation loss decreased (-0.705548 --> -0.716659).  Saving model ...
Epoch: 12 cost time: 3.692171335220337
Epoch: 12, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.726 Vali Acc: 0.739 Test Loss: 0.726 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 3.6013495922088623
Epoch: 13, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.814 Vali Acc: 0.678 Test Loss: 0.814 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.739595413208008
Epoch: 14, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.777 Vali Acc: 0.700 Test Loss: 0.777 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.914458751678467
Epoch: 15, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.629 Vali Acc: 0.756 Test Loss: 0.629 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 16 cost time: 3.6441702842712402
Epoch: 16, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.668 Vali Acc: 0.783 Test Loss: 0.668 Test Acc: 0.783
Validation loss decreased (-0.755549 --> -0.783327).  Saving model ...
Epoch: 17 cost time: 3.595118284225464
Epoch: 17, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.636 Vali Acc: 0.756 Test Loss: 0.636 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7007648944854736
Epoch: 18, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.651 Vali Acc: 0.772 Test Loss: 0.651 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.7106809616088867
Epoch: 19, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.884711265563965
Epoch: 20, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
Validation loss decreased (-0.783327 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 3.637528419494629
Epoch: 21, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.616 Vali Acc: 0.772 Test Loss: 0.616 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.643510341644287
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.593 Vali Acc: 0.806 Test Loss: 0.593 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805550).  Saving model ...
Epoch: 23 cost time: 3.847989559173584
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.584 Vali Acc: 0.828 Test Loss: 0.584 Test Acc: 0.828
Validation loss decreased (-0.805550 --> -0.827772).  Saving model ...
Epoch: 24 cost time: 3.9633023738861084
Epoch: 24, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.668 Vali Acc: 0.789 Test Loss: 0.668 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.420787811279297
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.684 Vali Acc: 0.772 Test Loss: 0.684 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.530305862426758
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.680 Vali Acc: 0.794 Test Loss: 0.680 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.642299175262451
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.630 Vali Acc: 0.800 Test Loss: 0.630 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.588658094406128
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.613 Vali Acc: 0.806 Test Loss: 0.613 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.510629892349243
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.642 Vali Acc: 0.800 Test Loss: 0.642 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.3981313705444336
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.578 Vali Acc: 0.828 Test Loss: 0.578 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 14104911
model size : 55.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5642993450164795
Epoch: 1, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.654 Vali Acc: 0.083 Test Loss: 2.654 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 1.9858486652374268
Epoch: 2, Steps: 12 | Train Loss: 2.543 Vali Loss: 2.348 Vali Acc: 0.328 Test Loss: 2.348 Test Acc: 0.328
Validation loss decreased (-0.083307 --> -0.327754).  Saving model ...
Epoch: 3 cost time: 1.9511184692382812
Epoch: 3, Steps: 12 | Train Loss: 2.154 Vali Loss: 2.020 Vali Acc: 0.528 Test Loss: 2.020 Test Acc: 0.528
Validation loss decreased (-0.327754 --> -0.527758).  Saving model ...
Epoch: 4 cost time: 1.9516661167144775
Epoch: 4, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.730 Vali Acc: 0.550 Test Loss: 1.730 Test Acc: 0.550
Validation loss decreased (-0.527758 --> -0.549983).  Saving model ...
Epoch: 5 cost time: 2.0805795192718506
Epoch: 5, Steps: 12 | Train Loss: 1.519 Vali Loss: 1.493 Vali Acc: 0.556 Test Loss: 1.493 Test Acc: 0.556
Validation loss decreased (-0.549983 --> -0.555541).  Saving model ...
Epoch: 6 cost time: 2.0978505611419678
Epoch: 6, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.264 Vali Acc: 0.583 Test Loss: 1.264 Test Acc: 0.583
Validation loss decreased (-0.555541 --> -0.583321).  Saving model ...
Epoch: 7 cost time: 2.2879929542541504
Epoch: 7, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.116 Vali Acc: 0.628 Test Loss: 1.116 Test Acc: 0.628
Validation loss decreased (-0.583321 --> -0.627767).  Saving model ...
Epoch: 8 cost time: 2.019906520843506
Epoch: 8, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.002 Vali Acc: 0.639 Test Loss: 1.002 Test Acc: 0.639
Validation loss decreased (-0.627767 --> -0.638879).  Saving model ...
Epoch: 9 cost time: 1.8626813888549805
Epoch: 9, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.917 Vali Acc: 0.678 Test Loss: 0.917 Test Acc: 0.678
Validation loss decreased (-0.638879 --> -0.677769).  Saving model ...
Epoch: 10 cost time: 1.7202129364013672
Epoch: 10, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.869 Vali Acc: 0.689 Test Loss: 0.869 Test Acc: 0.689
Validation loss decreased (-0.677769 --> -0.688880).  Saving model ...
Epoch: 11 cost time: 2.2400588989257812
Epoch: 11, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.803 Vali Acc: 0.700 Test Loss: 0.803 Test Acc: 0.700
Validation loss decreased (-0.688880 --> -0.699992).  Saving model ...
Epoch: 12 cost time: 2.4152517318725586
Epoch: 12, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.774 Vali Acc: 0.706 Test Loss: 0.774 Test Acc: 0.706
Validation loss decreased (-0.699992 --> -0.705548).  Saving model ...
Epoch: 13 cost time: 2.2958476543426514
Epoch: 13, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
Validation loss decreased (-0.705548 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 2.168175458908081
Epoch: 14, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.715 Vali Acc: 0.756 Test Loss: 0.715 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755548).  Saving model ...
Epoch: 15 cost time: 2.148804187774658
Epoch: 15, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.714 Vali Acc: 0.756 Test Loss: 0.714 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 16 cost time: 2.2336862087249756
Epoch: 16, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.685 Vali Acc: 0.772 Test Loss: 0.685 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 17 cost time: 2.203561305999756
Epoch: 17, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.696 Vali Acc: 0.789 Test Loss: 0.696 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 18 cost time: 2.33150577545166
Epoch: 18, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.290907382965088
Epoch: 19, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.748 Vali Acc: 0.756 Test Loss: 0.748 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.260157823562622
Epoch: 20, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.805 Vali Acc: 0.733 Test Loss: 0.805 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2246994972229004
Epoch: 21, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.832 Vali Acc: 0.744 Test Loss: 0.832 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1388609409332275
Epoch: 22, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.862 Vali Acc: 0.739 Test Loss: 0.862 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2235939502716064
Epoch: 23, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.812 Vali Acc: 0.750 Test Loss: 0.812 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.2801342010498047
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.850 Vali Acc: 0.739 Test Loss: 0.850 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.308486223220825
Epoch: 25, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.822 Vali Acc: 0.722 Test Loss: 0.822 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.1974759101867676
Epoch: 26, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.836 Vali Acc: 0.756 Test Loss: 0.836 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.207348346710205
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.869 Vali Acc: 0.750 Test Loss: 0.869 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 4175055
model size : 17.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.437026023864746
Epoch: 1, Steps: 12 | Train Loss: 2.812 Vali Loss: 2.685 Vali Acc: 0.100 Test Loss: 2.685 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 5.599687576293945
Epoch: 2, Steps: 12 | Train Loss: 2.493 Vali Loss: 2.336 Vali Acc: 0.400 Test Loss: 2.336 Test Acc: 0.400
Validation loss decreased (-0.099973 --> -0.399977).  Saving model ...
Epoch: 3 cost time: 5.50048565864563
Epoch: 3, Steps: 12 | Train Loss: 2.063 Vali Loss: 1.950 Vali Acc: 0.494 Test Loss: 1.950 Test Acc: 0.494
Validation loss decreased (-0.399977 --> -0.494425).  Saving model ...
Epoch: 4 cost time: 5.783751964569092
Epoch: 4, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.583 Vali Acc: 0.517 Test Loss: 1.583 Test Acc: 0.517
Validation loss decreased (-0.494425 --> -0.516651).  Saving model ...
Epoch: 5 cost time: 5.633623123168945
Epoch: 5, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.296 Vali Acc: 0.583 Test Loss: 1.296 Test Acc: 0.583
Validation loss decreased (-0.516651 --> -0.583320).  Saving model ...
Epoch: 6 cost time: 5.518930196762085
Epoch: 6, Steps: 12 | Train Loss: 0.997 Vali Loss: 1.153 Vali Acc: 0.583 Test Loss: 1.153 Test Acc: 0.583
Validation loss decreased (-0.583320 --> -0.583322).  Saving model ...
Epoch: 7 cost time: 5.762091875076294
Epoch: 7, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.969 Vali Acc: 0.678 Test Loss: 0.969 Test Acc: 0.678
Validation loss decreased (-0.583322 --> -0.677768).  Saving model ...
Epoch: 8 cost time: 5.693071603775024
Epoch: 8, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.857 Vali Acc: 0.683 Test Loss: 0.857 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683325).  Saving model ...
Epoch: 9 cost time: 5.603489875793457
Epoch: 9, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.763 Vali Acc: 0.728 Test Loss: 0.763 Test Acc: 0.728
Validation loss decreased (-0.683325 --> -0.727770).  Saving model ...
Epoch: 10 cost time: 5.783838510513306
Epoch: 10, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.727 Vali Acc: 0.728 Test Loss: 0.727 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727771).  Saving model ...
Epoch: 11 cost time: 5.825087308883667
Epoch: 11, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.680 Vali Acc: 0.761 Test Loss: 0.680 Test Acc: 0.761
Validation loss decreased (-0.727771 --> -0.761104).  Saving model ...
Epoch: 12 cost time: 5.695476770401001
Epoch: 12, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.687 Vali Acc: 0.772 Test Loss: 0.687 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772215).  Saving model ...
Epoch: 13 cost time: 5.436031103134155
Epoch: 13, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.664 Vali Acc: 0.789 Test Loss: 0.664 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 14 cost time: 5.1851630210876465
Epoch: 14, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.747588634490967
Epoch: 15, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 5.520488977432251
Epoch: 16, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.680 Vali Acc: 0.772 Test Loss: 0.680 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.247472047805786
Epoch: 17, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.785 Vali Acc: 0.739 Test Loss: 0.785 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.906998634338379
Epoch: 18, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.687 Vali Acc: 0.794 Test Loss: 0.687 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.8456480503082275
Epoch: 19, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.768 Vali Acc: 0.772 Test Loss: 0.768 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.539647340774536
Epoch: 20, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.5833048820495605
Epoch: 21, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.729 Vali Acc: 0.783 Test Loss: 0.729 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.633843660354614
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.745 Vali Acc: 0.767 Test Loss: 0.745 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.318866729736328
Epoch: 23, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.792 Vali Acc: 0.772 Test Loss: 0.792 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.265648126602173
Epoch: 24, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.724 Vali Acc: 0.794 Test Loss: 0.724 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.493472099304199
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.732 Vali Acc: 0.789 Test Loss: 0.732 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 7075023
model size : 28.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.554743051528931
Epoch: 1, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.589 Vali Acc: 0.167 Test Loss: 2.589 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 3.102210521697998
Epoch: 2, Steps: 12 | Train Loss: 2.456 Vali Loss: 2.284 Vali Acc: 0.383 Test Loss: 2.284 Test Acc: 0.383
Validation loss decreased (-0.166641 --> -0.383310).  Saving model ...
Epoch: 3 cost time: 3.066164255142212
Epoch: 3, Steps: 12 | Train Loss: 2.044 Vali Loss: 1.958 Vali Acc: 0.472 Test Loss: 1.958 Test Acc: 0.472
Validation loss decreased (-0.383310 --> -0.472203).  Saving model ...
Epoch: 4 cost time: 2.864851236343384
Epoch: 4, Steps: 12 | Train Loss: 1.644 Vali Loss: 1.662 Vali Acc: 0.506 Test Loss: 1.662 Test Acc: 0.506
Validation loss decreased (-0.472203 --> -0.505539).  Saving model ...
Epoch: 5 cost time: 2.8904247283935547
Epoch: 5, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.401 Vali Acc: 0.572 Test Loss: 1.401 Test Acc: 0.572
Validation loss decreased (-0.505539 --> -0.572208).  Saving model ...
Epoch: 6 cost time: 3.0242340564727783
Epoch: 6, Steps: 12 | Train Loss: 1.079 Vali Loss: 1.209 Vali Acc: 0.606 Test Loss: 1.209 Test Acc: 0.606
Validation loss decreased (-0.572208 --> -0.605543).  Saving model ...
Epoch: 7 cost time: 3.2058207988739014
Epoch: 7, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.070 Vali Acc: 0.611 Test Loss: 1.070 Test Acc: 0.611
Validation loss decreased (-0.605543 --> -0.611100).  Saving model ...
Epoch: 8 cost time: 3.2530789375305176
Epoch: 8, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.949 Vali Acc: 0.667 Test Loss: 0.949 Test Acc: 0.667
Validation loss decreased (-0.611100 --> -0.666657).  Saving model ...
Epoch: 9 cost time: 3.1427392959594727
Epoch: 9, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.865 Vali Acc: 0.694 Test Loss: 0.865 Test Acc: 0.694
Validation loss decreased (-0.666657 --> -0.694436).  Saving model ...
Epoch: 10 cost time: 3.1521072387695312
Epoch: 10, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.790 Vali Acc: 0.711 Test Loss: 0.790 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711103).  Saving model ...
Epoch: 11 cost time: 3.124159097671509
Epoch: 11, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.772 Vali Acc: 0.728 Test Loss: 0.772 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 12 cost time: 3.233701705932617
Epoch: 12, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.724 Vali Acc: 0.739 Test Loss: 0.724 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 3.3336262702941895
Epoch: 13, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.683 Vali Acc: 0.739 Test Loss: 0.683 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738882).  Saving model ...
Epoch: 14 cost time: 3.1336750984191895
Epoch: 14, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.679 Vali Acc: 0.750 Test Loss: 0.679 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 3.0787127017974854
Epoch: 15, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761105).  Saving model ...
Epoch: 16 cost time: 3.076272487640381
Epoch: 16, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.675 Vali Acc: 0.761 Test Loss: 0.675 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3382973670959473
Epoch: 17, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.641 Vali Acc: 0.767 Test Loss: 0.641 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 18 cost time: 3.2385342121124268
Epoch: 18, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.679 Vali Acc: 0.778 Test Loss: 0.679 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 19 cost time: 3.059260845184326
Epoch: 19, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.672 Vali Acc: 0.772 Test Loss: 0.672 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1264798641204834
Epoch: 20, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.659 Vali Acc: 0.772 Test Loss: 0.659 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.091975688934326
Epoch: 21, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.660 Vali Acc: 0.794 Test Loss: 0.660 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794438).  Saving model ...
Epoch: 22 cost time: 3.3211400508880615
Epoch: 22, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.664 Vali Acc: 0.778 Test Loss: 0.664 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.211564779281616
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.670 Vali Acc: 0.789 Test Loss: 0.670 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.279326915740967
Epoch: 24, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.692 Vali Acc: 0.794 Test Loss: 0.692 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0952200889587402
Epoch: 25, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.688 Vali Acc: 0.794 Test Loss: 0.688 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.053986072540283
Epoch: 26, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.676 Vali Acc: 0.800 Test Loss: 0.676 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 3.151780605316162
Epoch: 27, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.700 Vali Acc: 0.794 Test Loss: 0.700 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3202216625213623
Epoch: 28, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.652 Vali Acc: 0.811 Test Loss: 0.652 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 29 cost time: 3.294400930404663
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.767 Vali Acc: 0.800 Test Loss: 0.767 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.862995147705078
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 2109903
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.103047847747803
Epoch: 1, Steps: 12 | Train Loss: 2.812 Vali Loss: 2.685 Vali Acc: 0.100 Test Loss: 2.685 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 4.374737739562988
Epoch: 2, Steps: 12 | Train Loss: 2.492 Vali Loss: 2.335 Vali Acc: 0.400 Test Loss: 2.335 Test Acc: 0.400
Validation loss decreased (-0.099973 --> -0.399977).  Saving model ...
Epoch: 3 cost time: 4.167125225067139
Epoch: 3, Steps: 12 | Train Loss: 2.062 Vali Loss: 1.947 Vali Acc: 0.494 Test Loss: 1.947 Test Acc: 0.494
Validation loss decreased (-0.399977 --> -0.494425).  Saving model ...
Epoch: 4 cost time: 4.1726601123809814
Epoch: 4, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.580 Vali Acc: 0.517 Test Loss: 1.580 Test Acc: 0.517
Validation loss decreased (-0.494425 --> -0.516651).  Saving model ...
Epoch: 5 cost time: 4.476885795593262
Epoch: 5, Steps: 12 | Train Loss: 1.223 Vali Loss: 1.294 Vali Acc: 0.583 Test Loss: 1.294 Test Acc: 0.583
Validation loss decreased (-0.516651 --> -0.583320).  Saving model ...
Epoch: 6 cost time: 4.385598421096802
Epoch: 6, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.153 Vali Acc: 0.578 Test Loss: 1.153 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.2756428718566895
Epoch: 7, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.967 Vali Acc: 0.672 Test Loss: 0.967 Test Acc: 0.672
Validation loss decreased (-0.583320 --> -0.672213).  Saving model ...
Epoch: 8 cost time: 4.3458099365234375
Epoch: 8, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.857 Vali Acc: 0.689 Test Loss: 0.857 Test Acc: 0.689
Validation loss decreased (-0.672213 --> -0.688880).  Saving model ...
Epoch: 9 cost time: 4.3609278202056885
Epoch: 9, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.775 Vali Acc: 0.711 Test Loss: 0.775 Test Acc: 0.711
Validation loss decreased (-0.688880 --> -0.711103).  Saving model ...
Epoch: 10 cost time: 4.158936262130737
Epoch: 10, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.738 Vali Acc: 0.717 Test Loss: 0.738 Test Acc: 0.717
Validation loss decreased (-0.711103 --> -0.716659).  Saving model ...
Epoch: 11 cost time: 4.078982591629028
Epoch: 11, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.689 Vali Acc: 0.739 Test Loss: 0.689 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738882).  Saving model ...
Epoch: 12 cost time: 4.187195062637329
Epoch: 12, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.680 Vali Acc: 0.767 Test Loss: 0.680 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766660).  Saving model ...
Epoch: 13 cost time: 4.3489603996276855
Epoch: 13, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.646 Vali Acc: 0.783 Test Loss: 0.646 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783327).  Saving model ...
Epoch: 14 cost time: 4.190183639526367
Epoch: 14, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.656 Vali Acc: 0.783 Test Loss: 0.656 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.078080415725708
Epoch: 15, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.639 Vali Acc: 0.794 Test Loss: 0.639 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794438).  Saving model ...
Epoch: 16 cost time: 4.180286407470703
Epoch: 16, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.684 Vali Acc: 0.772 Test Loss: 0.684 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.383554220199585
Epoch: 17, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.767 Vali Acc: 0.733 Test Loss: 0.767 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.955275297164917
Epoch: 18, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.700 Vali Acc: 0.767 Test Loss: 0.700 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.914609909057617
Epoch: 19, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.738 Vali Acc: 0.761 Test Loss: 0.738 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.9577252864837646
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.705 Vali Acc: 0.767 Test Loss: 0.705 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.190217018127441
Epoch: 21, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.715 Vali Acc: 0.794 Test Loss: 0.715 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.027438163757324
Epoch: 22, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.706 Vali Acc: 0.794 Test Loss: 0.706 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.9289371967315674
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.754 Vali Acc: 0.778 Test Loss: 0.754 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.83123779296875
Epoch: 24, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.694 Vali Acc: 0.817 Test Loss: 0.694 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816660).  Saving model ...
Epoch: 25 cost time: 4.300064563751221
Epoch: 25, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.714 Vali Acc: 0.794 Test Loss: 0.714 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.062260150909424
Epoch: 26, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.672 Vali Acc: 0.806 Test Loss: 0.672 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.007344722747803
Epoch: 27, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.681 Vali Acc: 0.806 Test Loss: 0.681 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.005402326583862
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.199417591094971
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.706 Vali Acc: 0.806 Test Loss: 0.706 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.288921356201172
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.706 Vali Acc: 0.811 Test Loss: 0.706 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 7075023
model size : 28.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.327295541763306
Epoch: 1, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.589 Vali Acc: 0.167 Test Loss: 2.589 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 2.542398691177368
Epoch: 2, Steps: 12 | Train Loss: 2.456 Vali Loss: 2.282 Vali Acc: 0.383 Test Loss: 2.282 Test Acc: 0.383
Validation loss decreased (-0.166641 --> -0.383311).  Saving model ...
Epoch: 3 cost time: 2.564743757247925
Epoch: 3, Steps: 12 | Train Loss: 2.045 Vali Loss: 1.955 Vali Acc: 0.472 Test Loss: 1.955 Test Acc: 0.472
Validation loss decreased (-0.383311 --> -0.472203).  Saving model ...
Epoch: 4 cost time: 2.473937511444092
Epoch: 4, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.658 Vali Acc: 0.500 Test Loss: 1.658 Test Acc: 0.500
Validation loss decreased (-0.472203 --> -0.499983).  Saving model ...
Epoch: 5 cost time: 2.4469704627990723
Epoch: 5, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.396 Vali Acc: 0.567 Test Loss: 1.396 Test Acc: 0.567
Validation loss decreased (-0.499983 --> -0.566653).  Saving model ...
Epoch: 6 cost time: 2.3864197731018066
Epoch: 6, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.205 Vali Acc: 0.606 Test Loss: 1.205 Test Acc: 0.606
Validation loss decreased (-0.566653 --> -0.605544).  Saving model ...
Epoch: 7 cost time: 2.568939685821533
Epoch: 7, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.069 Vali Acc: 0.606 Test Loss: 1.069 Test Acc: 0.606
Validation loss decreased (-0.605544 --> -0.605545).  Saving model ...
Epoch: 8 cost time: 2.561652660369873
Epoch: 8, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.950 Vali Acc: 0.650 Test Loss: 0.950 Test Acc: 0.650
Validation loss decreased (-0.605545 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 2.5727322101593018
Epoch: 9, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.866 Vali Acc: 0.689 Test Loss: 0.866 Test Acc: 0.689
Validation loss decreased (-0.649990 --> -0.688880).  Saving model ...
Epoch: 10 cost time: 2.433685779571533
Epoch: 10, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.783 Vali Acc: 0.722 Test Loss: 0.783 Test Acc: 0.722
Validation loss decreased (-0.688880 --> -0.722214).  Saving model ...
Epoch: 11 cost time: 2.4315898418426514
Epoch: 11, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.763 Vali Acc: 0.739 Test Loss: 0.763 Test Acc: 0.739
Validation loss decreased (-0.722214 --> -0.738881).  Saving model ...
Epoch: 12 cost time: 2.446850538253784
Epoch: 12, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.717 Vali Acc: 0.744 Test Loss: 0.717 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 13 cost time: 2.5360829830169678
Epoch: 13, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.678 Vali Acc: 0.744 Test Loss: 0.678 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744438).  Saving model ...
Epoch: 14 cost time: 2.574848175048828
Epoch: 14, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.670 Vali Acc: 0.750 Test Loss: 0.670 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 2.5507256984710693
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.649 Vali Acc: 0.761 Test Loss: 0.649 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761105).  Saving model ...
Epoch: 16 cost time: 2.4034628868103027
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.675 Vali Acc: 0.767 Test Loss: 0.675 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 17 cost time: 2.3616573810577393
Epoch: 17, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.639 Vali Acc: 0.778 Test Loss: 0.639 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 18 cost time: 2.53586745262146
Epoch: 18, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.672 Vali Acc: 0.778 Test Loss: 0.672 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6291186809539795
Epoch: 19, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.653 Vali Acc: 0.767 Test Loss: 0.653 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.764906644821167
Epoch: 20, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.649 Vali Acc: 0.778 Test Loss: 0.649 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.626883029937744
Epoch: 21, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 22 cost time: 2.519493579864502
Epoch: 22, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.642 Vali Acc: 0.794 Test Loss: 0.642 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794438).  Saving model ...
Epoch: 23 cost time: 2.4504735469818115
Epoch: 23, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.662 Vali Acc: 0.789 Test Loss: 0.662 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5653281211853027
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 25 cost time: 2.7293360233306885
Epoch: 25, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.680 Vali Acc: 0.783 Test Loss: 0.680 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6369733810424805
Epoch: 26, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.673 Vali Acc: 0.794 Test Loss: 0.673 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.6933560371398926
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.695 Vali Acc: 0.800 Test Loss: 0.695 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.475649118423462
Epoch: 28, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.651 Vali Acc: 0.806 Test Loss: 0.651 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 29 cost time: 2.4700279235839844
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.774 Vali Acc: 0.794 Test Loss: 0.774 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.4975290298461914
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.688 Vali Acc: 0.789 Test Loss: 0.688 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 2109903
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.580113649368286
Epoch: 1, Steps: 12 | Train Loss: 2.816 Vali Loss: 2.704 Vali Acc: 0.100 Test Loss: 2.704 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 2.819317579269409
Epoch: 2, Steps: 12 | Train Loss: 2.536 Vali Loss: 2.408 Vali Acc: 0.361 Test Loss: 2.408 Test Acc: 0.361
Validation loss decreased (-0.099973 --> -0.361087).  Saving model ...
Epoch: 3 cost time: 2.75954270362854
Epoch: 3, Steps: 12 | Train Loss: 2.196 Vali Loss: 2.090 Vali Acc: 0.494 Test Loss: 2.090 Test Acc: 0.494
Validation loss decreased (-0.361087 --> -0.494424).  Saving model ...
Epoch: 4 cost time: 2.793719530105591
Epoch: 4, Steps: 12 | Train Loss: 1.855 Vali Loss: 1.768 Vali Acc: 0.517 Test Loss: 1.768 Test Acc: 0.517
Validation loss decreased (-0.494424 --> -0.516649).  Saving model ...
Epoch: 5 cost time: 2.841655731201172
Epoch: 5, Steps: 12 | Train Loss: 1.476 Vali Loss: 1.497 Vali Acc: 0.539 Test Loss: 1.497 Test Acc: 0.539
Validation loss decreased (-0.516649 --> -0.538874).  Saving model ...
Epoch: 6 cost time: 2.871788501739502
Epoch: 6, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.341 Vali Acc: 0.561 Test Loss: 1.341 Test Acc: 0.561
Validation loss decreased (-0.538874 --> -0.561098).  Saving model ...
Epoch: 7 cost time: 2.8641421794891357
Epoch: 7, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.147 Vali Acc: 0.594 Test Loss: 1.147 Test Acc: 0.594
Validation loss decreased (-0.561098 --> -0.594433).  Saving model ...
Epoch: 8 cost time: 2.7591888904571533
Epoch: 8, Steps: 12 | Train Loss: 0.805 Vali Loss: 1.026 Vali Acc: 0.650 Test Loss: 1.026 Test Acc: 0.650
Validation loss decreased (-0.594433 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 2.733381986618042
Epoch: 9, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.929 Vali Acc: 0.661 Test Loss: 0.929 Test Acc: 0.661
Validation loss decreased (-0.649990 --> -0.661102).  Saving model ...
Epoch: 10 cost time: 2.6596269607543945
Epoch: 10, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.872 Vali Acc: 0.683 Test Loss: 0.872 Test Acc: 0.683
Validation loss decreased (-0.661102 --> -0.683325).  Saving model ...
Epoch: 11 cost time: 2.96549129486084
Epoch: 11, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.808 Vali Acc: 0.733 Test Loss: 0.808 Test Acc: 0.733
Validation loss decreased (-0.683325 --> -0.733325).  Saving model ...
Epoch: 12 cost time: 2.800342082977295
Epoch: 12, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.783 Vali Acc: 0.728 Test Loss: 0.783 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7783968448638916
Epoch: 13, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.748 Vali Acc: 0.756 Test Loss: 0.748 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755548).  Saving model ...
Epoch: 14 cost time: 2.672250747680664
Epoch: 14, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.732 Vali Acc: 0.761 Test Loss: 0.732 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 2.724888324737549
Epoch: 15, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.728 Vali Acc: 0.761 Test Loss: 0.728 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761104).  Saving model ...
Epoch: 16 cost time: 2.736717462539673
Epoch: 16, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.716 Vali Acc: 0.789 Test Loss: 0.716 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788882).  Saving model ...
Epoch: 17 cost time: 2.7960076332092285
Epoch: 17, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.666 Vali Acc: 0.806 Test Loss: 0.666 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 18 cost time: 2.853156805038452
Epoch: 18, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.661 Vali Acc: 0.817 Test Loss: 0.661 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 19 cost time: 2.7056028842926025
Epoch: 19, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.719 Vali Acc: 0.761 Test Loss: 0.719 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.549511432647705
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.717 Vali Acc: 0.767 Test Loss: 0.717 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.52173113822937
Epoch: 21, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.643700361251831
Epoch: 22, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.716 Vali Acc: 0.783 Test Loss: 0.716 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4452826976776123
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.698 Vali Acc: 0.772 Test Loss: 0.698 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.5173518657684326
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.785 Vali Acc: 0.783 Test Loss: 0.785 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.495509147644043
Epoch: 25, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.700 Vali Acc: 0.806 Test Loss: 0.700 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.347536087036133
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.679 Vali Acc: 0.811 Test Loss: 0.679 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.5411832332611084
Epoch: 27, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.727 Vali Acc: 0.789 Test Loss: 0.727 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.3478283882141113
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.704 Vali Acc: 0.794 Test Loss: 0.704 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 7075023
model size : 28.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.363896131515503
Epoch: 1, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.605 Vali Acc: 0.139 Test Loss: 2.605 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 1.6644291877746582
Epoch: 2, Steps: 12 | Train Loss: 2.489 Vali Loss: 2.337 Vali Acc: 0.367 Test Loss: 2.337 Test Acc: 0.367
Validation loss decreased (-0.138863 --> -0.366643).  Saving model ...
Epoch: 3 cost time: 1.7923972606658936
Epoch: 3, Steps: 12 | Train Loss: 2.131 Vali Loss: 2.059 Vali Acc: 0.467 Test Loss: 2.059 Test Acc: 0.467
Validation loss decreased (-0.366643 --> -0.466646).  Saving model ...
Epoch: 4 cost time: 1.763291358947754
Epoch: 4, Steps: 12 | Train Loss: 1.805 Vali Loss: 1.812 Vali Acc: 0.489 Test Loss: 1.812 Test Acc: 0.489
Validation loss decreased (-0.466646 --> -0.488871).  Saving model ...
Epoch: 5 cost time: 1.760991096496582
Epoch: 5, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.589 Vali Acc: 0.544 Test Loss: 1.589 Test Acc: 0.544
Validation loss decreased (-0.488871 --> -0.544429).  Saving model ...
Epoch: 6 cost time: 1.8486011028289795
Epoch: 6, Steps: 12 | Train Loss: 1.298 Vali Loss: 1.408 Vali Acc: 0.572 Test Loss: 1.408 Test Acc: 0.572
Validation loss decreased (-0.544429 --> -0.572208).  Saving model ...
Epoch: 7 cost time: 1.805720329284668
Epoch: 7, Steps: 12 | Train Loss: 1.116 Vali Loss: 1.265 Vali Acc: 0.578 Test Loss: 1.265 Test Acc: 0.578
Validation loss decreased (-0.572208 --> -0.577765).  Saving model ...
Epoch: 8 cost time: 1.8400077819824219
Epoch: 8, Steps: 12 | Train Loss: 0.967 Vali Loss: 1.136 Vali Acc: 0.622 Test Loss: 1.136 Test Acc: 0.622
Validation loss decreased (-0.577765 --> -0.622211).  Saving model ...
Epoch: 9 cost time: 1.8983330726623535
Epoch: 9, Steps: 12 | Train Loss: 0.765 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
Validation loss decreased (-0.622211 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 1.8183989524841309
Epoch: 10, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.943 Vali Acc: 0.683 Test Loss: 0.943 Test Acc: 0.683
Validation loss decreased (-0.649990 --> -0.683324).  Saving model ...
Epoch: 11 cost time: 1.8517589569091797
Epoch: 11, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.895 Vali Acc: 0.700 Test Loss: 0.895 Test Acc: 0.700
Validation loss decreased (-0.683324 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 1.9559056758880615
Epoch: 12, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.817 Vali Acc: 0.700 Test Loss: 0.817 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 13 cost time: 1.9723763465881348
Epoch: 13, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.788 Vali Acc: 0.689 Test Loss: 0.788 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9765233993530273
Epoch: 14, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.773 Vali Acc: 0.722 Test Loss: 0.773 Test Acc: 0.722
Validation loss decreased (-0.699992 --> -0.722214).  Saving model ...
Epoch: 15 cost time: 1.8308584690093994
Epoch: 15, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.770 Vali Acc: 0.728 Test Loss: 0.770 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727770).  Saving model ...
Epoch: 16 cost time: 1.4329369068145752
Epoch: 16, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.807 Vali Acc: 0.733 Test Loss: 0.807 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733325).  Saving model ...
Epoch: 17 cost time: 2.0702850818634033
Epoch: 17, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.731 Vali Acc: 0.744 Test Loss: 0.731 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744437).  Saving model ...
Epoch: 18 cost time: 2.006380319595337
Epoch: 18, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.762 Vali Acc: 0.739 Test Loss: 0.762 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.123868465423584
Epoch: 19, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.777 Vali Acc: 0.728 Test Loss: 0.777 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.006964921951294
Epoch: 20, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.772 Vali Acc: 0.750 Test Loss: 0.772 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749992).  Saving model ...
Epoch: 21 cost time: 2.0066487789154053
Epoch: 21, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.805 Vali Acc: 0.722 Test Loss: 0.805 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.035254955291748
Epoch: 22, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 2.0600876808166504
Epoch: 23, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.785 Vali Acc: 0.761 Test Loss: 0.785 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.007242202758789
Epoch: 24, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.764 Vali Acc: 0.756 Test Loss: 0.764 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0121350288391113
Epoch: 25, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.802 Vali Acc: 0.733 Test Loss: 0.802 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9882516860961914
Epoch: 26, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.821 Vali Acc: 0.750 Test Loss: 0.821 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.996535062789917
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9233241081237793
Epoch: 28, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.834 Vali Acc: 0.750 Test Loss: 0.834 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.93084716796875
Epoch: 29, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.850 Vali Acc: 0.728 Test Loss: 0.850 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9566113948822021
Epoch: 30, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.798 Vali Acc: 0.767 Test Loss: 0.798 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 2109903
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.79756498336792
Epoch: 1, Steps: 12 | Train Loss: 2.818 Vali Loss: 2.740 Vali Acc: 0.106 Test Loss: 2.740 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 5.131654262542725
Epoch: 2, Steps: 12 | Train Loss: 2.623 Vali Loss: 2.490 Vali Acc: 0.317 Test Loss: 2.490 Test Acc: 0.317
Validation loss decreased (-0.105528 --> -0.316642).  Saving model ...
Epoch: 3 cost time: 4.974545955657959
Epoch: 3, Steps: 12 | Train Loss: 2.301 Vali Loss: 2.189 Vali Acc: 0.372 Test Loss: 2.189 Test Acc: 0.372
Validation loss decreased (-0.316642 --> -0.372200).  Saving model ...
Epoch: 4 cost time: 4.9850804805755615
Epoch: 4, Steps: 12 | Train Loss: 1.986 Vali Loss: 1.910 Vali Acc: 0.506 Test Loss: 1.910 Test Acc: 0.506
Validation loss decreased (-0.372200 --> -0.505536).  Saving model ...
Epoch: 5 cost time: 5.064882516860962
Epoch: 5, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.653 Vali Acc: 0.572 Test Loss: 1.653 Test Acc: 0.572
Validation loss decreased (-0.505536 --> -0.572206).  Saving model ...
Epoch: 6 cost time: 4.998607397079468
Epoch: 6, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.443 Vali Acc: 0.639 Test Loss: 1.443 Test Acc: 0.639
Validation loss decreased (-0.572206 --> -0.638874).  Saving model ...
Epoch: 7 cost time: 4.982359409332275
Epoch: 7, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.269 Vali Acc: 0.622 Test Loss: 1.269 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.104856491088867
Epoch: 8, Steps: 12 | Train Loss: 0.947 Vali Loss: 1.118 Vali Acc: 0.672 Test Loss: 1.118 Test Acc: 0.672
Validation loss decreased (-0.638874 --> -0.672211).  Saving model ...
Epoch: 9 cost time: 4.852571964263916
Epoch: 9, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.995 Vali Acc: 0.650 Test Loss: 0.995 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.951141119003296
Epoch: 10, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.878 Vali Acc: 0.689 Test Loss: 0.878 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688880).  Saving model ...
Epoch: 11 cost time: 5.106831312179565
Epoch: 11, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.828 Vali Acc: 0.678 Test Loss: 0.828 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.898459434509277
Epoch: 12, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.777 Vali Acc: 0.722 Test Loss: 0.777 Test Acc: 0.722
Validation loss decreased (-0.688880 --> -0.722214).  Saving model ...
Epoch: 13 cost time: 4.939610242843628
Epoch: 13, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.744 Vali Acc: 0.728 Test Loss: 0.744 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727770).  Saving model ...
Epoch: 14 cost time: 5.18373441696167
Epoch: 14, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.713 Vali Acc: 0.722 Test Loss: 0.713 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.918272256851196
Epoch: 15, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.679 Vali Acc: 0.750 Test Loss: 0.679 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 4.8368706703186035
Epoch: 16, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.697 Vali Acc: 0.756 Test Loss: 0.697 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 17 cost time: 5.201844215393066
Epoch: 17, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.691 Vali Acc: 0.739 Test Loss: 0.691 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.173892259597778
Epoch: 18, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.671 Vali Acc: 0.739 Test Loss: 0.671 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.004452705383301
Epoch: 19, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.697 Vali Acc: 0.744 Test Loss: 0.697 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.193407773971558
Epoch: 20, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.668 Vali Acc: 0.739 Test Loss: 0.668 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.863432168960571
Epoch: 21, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.677 Vali Acc: 0.744 Test Loss: 0.677 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.789986848831177
Epoch: 22, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.648 Vali Acc: 0.767 Test Loss: 0.648 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 23 cost time: 4.774249792098999
Epoch: 23, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.670 Vali Acc: 0.761 Test Loss: 0.670 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.650490760803223
Epoch: 24, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.661 Vali Acc: 0.767 Test Loss: 0.661 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.781514406204224
Epoch: 25, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.698 Vali Acc: 0.778 Test Loss: 0.698 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 26 cost time: 4.754173994064331
Epoch: 26, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.667 Vali Acc: 0.772 Test Loss: 0.667 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.59454870223999
Epoch: 27, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.703 Vali Acc: 0.778 Test Loss: 0.703 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.648389101028442
Epoch: 28, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.677 Vali Acc: 0.767 Test Loss: 0.677 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.95272421836853
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.686 Vali Acc: 0.761 Test Loss: 0.686 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.647071599960327
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.765 Vali Acc: 0.772 Test Loss: 0.765 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 7053615
model size : 27.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.682862997055054
Epoch: 1, Steps: 12 | Train Loss: 2.814 Vali Loss: 2.742 Vali Acc: 0.039 Test Loss: 2.742 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 2.837719202041626
Epoch: 2, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.518 Vali Acc: 0.211 Test Loss: 2.518 Test Acc: 0.211
Validation loss decreased (-0.038861 --> -0.211086).  Saving model ...
Epoch: 3 cost time: 2.8145463466644287
Epoch: 3, Steps: 12 | Train Loss: 2.381 Vali Loss: 2.255 Vali Acc: 0.433 Test Loss: 2.255 Test Acc: 0.433
Validation loss decreased (-0.211086 --> -0.433311).  Saving model ...
Epoch: 4 cost time: 2.788985013961792
Epoch: 4, Steps: 12 | Train Loss: 2.068 Vali Loss: 1.991 Vali Acc: 0.517 Test Loss: 1.991 Test Acc: 0.517
Validation loss decreased (-0.433311 --> -0.516647).  Saving model ...
Epoch: 5 cost time: 2.9823687076568604
Epoch: 5, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.756 Vali Acc: 0.528 Test Loss: 1.756 Test Acc: 0.528
Validation loss decreased (-0.516647 --> -0.527760).  Saving model ...
Epoch: 6 cost time: 2.8731231689453125
Epoch: 6, Steps: 12 | Train Loss: 1.497 Vali Loss: 1.533 Vali Acc: 0.622 Test Loss: 1.533 Test Acc: 0.622
Validation loss decreased (-0.527760 --> -0.622207).  Saving model ...
Epoch: 7 cost time: 2.872248411178589
Epoch: 7, Steps: 12 | Train Loss: 1.272 Vali Loss: 1.360 Vali Acc: 0.639 Test Loss: 1.360 Test Acc: 0.639
Validation loss decreased (-0.622207 --> -0.638875).  Saving model ...
Epoch: 8 cost time: 2.8192250728607178
Epoch: 8, Steps: 12 | Train Loss: 1.089 Vali Loss: 1.210 Vali Acc: 0.667 Test Loss: 1.210 Test Acc: 0.667
Validation loss decreased (-0.638875 --> -0.666655).  Saving model ...
Epoch: 9 cost time: 2.8711531162261963
Epoch: 9, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.097 Vali Acc: 0.656 Test Loss: 1.097 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.91923189163208
Epoch: 10, Steps: 12 | Train Loss: 0.810 Vali Loss: 1.012 Vali Acc: 0.683 Test Loss: 1.012 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683323).  Saving model ...
Epoch: 11 cost time: 3.0385491847991943
Epoch: 11, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.933 Vali Acc: 0.689 Test Loss: 0.933 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688880).  Saving model ...
Epoch: 12 cost time: 2.739079475402832
Epoch: 12, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.870 Vali Acc: 0.694 Test Loss: 0.870 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694436).  Saving model ...
Epoch: 13 cost time: 2.816549777984619
Epoch: 13, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.816 Vali Acc: 0.689 Test Loss: 0.816 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7702183723449707
Epoch: 14, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.786 Vali Acc: 0.694 Test Loss: 0.786 Test Acc: 0.694
Validation loss decreased (-0.694436 --> -0.694437).  Saving model ...
Epoch: 15 cost time: 2.7966461181640625
Epoch: 15, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.748 Vali Acc: 0.733 Test Loss: 0.748 Test Acc: 0.733
Validation loss decreased (-0.694437 --> -0.733326).  Saving model ...
Epoch: 16 cost time: 2.9459714889526367
Epoch: 16, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.750 Vali Acc: 0.711 Test Loss: 0.750 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8192107677459717
Epoch: 17, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.736 Vali Acc: 0.694 Test Loss: 0.736 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8872005939483643
Epoch: 18, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.691 Vali Acc: 0.728 Test Loss: 0.691 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9078028202056885
Epoch: 19, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.683 Vali Acc: 0.722 Test Loss: 0.683 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.956665277481079
Epoch: 20, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.696 Vali Acc: 0.728 Test Loss: 0.696 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.000081777572632
Epoch: 21, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.661 Vali Acc: 0.750 Test Loss: 0.661 Test Acc: 0.750
Validation loss decreased (-0.733326 --> -0.749993).  Saving model ...
Epoch: 22 cost time: 2.679426670074463
Epoch: 22, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.669 Vali Acc: 0.767 Test Loss: 0.669 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
Epoch: 23 cost time: 3.014641046524048
Epoch: 23, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.654 Vali Acc: 0.744 Test Loss: 0.654 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0305213928222656
Epoch: 24, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.654 Vali Acc: 0.756 Test Loss: 0.654 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.050095796585083
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.662 Vali Acc: 0.772 Test Loss: 0.662 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 26 cost time: 2.940380334854126
Epoch: 26, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.9045093059539795
Epoch: 27, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.634 Vali Acc: 0.778 Test Loss: 0.634 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777771).  Saving model ...
Epoch: 28 cost time: 2.947402000427246
Epoch: 28, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.654 Vali Acc: 0.778 Test Loss: 0.654 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0746471881866455
Epoch: 29, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.642 Vali Acc: 0.783 Test Loss: 0.642 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 30 cost time: 3.125063180923462
Epoch: 30, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.655 Vali Acc: 0.778 Test Loss: 0.655 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 2088303
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.895410776138306
Epoch: 1, Steps: 12 | Train Loss: 2.819 Vali Loss: 2.740 Vali Acc: 0.106 Test Loss: 2.740 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 4.234748840332031
Epoch: 2, Steps: 12 | Train Loss: 2.623 Vali Loss: 2.489 Vali Acc: 0.317 Test Loss: 2.489 Test Acc: 0.317
Validation loss decreased (-0.105528 --> -0.316642).  Saving model ...
Epoch: 3 cost time: 4.1757073402404785
Epoch: 3, Steps: 12 | Train Loss: 2.301 Vali Loss: 2.187 Vali Acc: 0.367 Test Loss: 2.187 Test Acc: 0.367
Validation loss decreased (-0.316642 --> -0.366645).  Saving model ...
Epoch: 4 cost time: 4.155532121658325
Epoch: 4, Steps: 12 | Train Loss: 1.988 Vali Loss: 1.908 Vali Acc: 0.506 Test Loss: 1.908 Test Acc: 0.506
Validation loss decreased (-0.366645 --> -0.505536).  Saving model ...
Epoch: 5 cost time: 4.218242406845093
Epoch: 5, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.650 Vali Acc: 0.556 Test Loss: 1.650 Test Acc: 0.556
Validation loss decreased (-0.505536 --> -0.555539).  Saving model ...
Epoch: 6 cost time: 4.250693321228027
Epoch: 6, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.443 Vali Acc: 0.633 Test Loss: 1.443 Test Acc: 0.633
Validation loss decreased (-0.555539 --> -0.633319).  Saving model ...
Epoch: 7 cost time: 4.238261461257935
Epoch: 7, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.269 Vali Acc: 0.617 Test Loss: 1.269 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.17456579208374
Epoch: 8, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.122 Vali Acc: 0.678 Test Loss: 1.122 Test Acc: 0.678
Validation loss decreased (-0.633319 --> -0.677767).  Saving model ...
Epoch: 9 cost time: 4.290762901306152
Epoch: 9, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.996 Vali Acc: 0.656 Test Loss: 0.996 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.155735015869141
Epoch: 10, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.898 Vali Acc: 0.667 Test Loss: 0.898 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.1527183055877686
Epoch: 11, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.841 Vali Acc: 0.672 Test Loss: 0.841 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.17533802986145
Epoch: 12, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.799 Vali Acc: 0.711 Test Loss: 0.799 Test Acc: 0.711
Validation loss decreased (-0.677767 --> -0.711103).  Saving model ...
Epoch: 13 cost time: 4.248956680297852
Epoch: 13, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.774 Vali Acc: 0.722 Test Loss: 0.774 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722214).  Saving model ...
Epoch: 14 cost time: 4.279271841049194
Epoch: 14, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.726 Vali Acc: 0.722 Test Loss: 0.726 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722215).  Saving model ...
Epoch: 15 cost time: 3.919297933578491
Epoch: 15, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.681 Vali Acc: 0.739 Test Loss: 0.681 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738882).  Saving model ...
Epoch: 16 cost time: 4.00842022895813
Epoch: 16, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.672 Vali Acc: 0.739 Test Loss: 0.672 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738882).  Saving model ...
Epoch: 17 cost time: 3.8899478912353516
Epoch: 17, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.659 Vali Acc: 0.750 Test Loss: 0.659 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749993).  Saving model ...
Epoch: 18 cost time: 4.001750707626343
Epoch: 18, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.636 Vali Acc: 0.761 Test Loss: 0.636 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761105).  Saving model ...
Epoch: 19 cost time: 3.92991042137146
Epoch: 19, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.660 Vali Acc: 0.761 Test Loss: 0.660 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.062577486038208
Epoch: 20, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.646 Vali Acc: 0.744 Test Loss: 0.646 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.908967971801758
Epoch: 21, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.653 Vali Acc: 0.756 Test Loss: 0.653 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.914114236831665
Epoch: 22, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.8712430000305176
Epoch: 23, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.638 Vali Acc: 0.767 Test Loss: 0.638 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 24 cost time: 3.8209214210510254
Epoch: 24, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.645 Vali Acc: 0.772 Test Loss: 0.645 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 25 cost time: 3.958657741546631
Epoch: 25, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.653 Vali Acc: 0.778 Test Loss: 0.653 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777771).  Saving model ...
Epoch: 26 cost time: 4.00224232673645
Epoch: 26, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.657 Vali Acc: 0.778 Test Loss: 0.657 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.8803722858428955
Epoch: 27, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.675 Vali Acc: 0.767 Test Loss: 0.675 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.215594291687012
Epoch: 28, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.605 Vali Acc: 0.800 Test Loss: 0.605 Test Acc: 0.800
Validation loss decreased (-0.777771 --> -0.799994).  Saving model ...
Epoch: 29 cost time: 4.112818002700806
Epoch: 29, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.656 Vali Acc: 0.783 Test Loss: 0.656 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.9370362758636475
Epoch: 30, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.708 Vali Acc: 0.778 Test Loss: 0.708 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 7053615
model size : 27.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.481960773468018
Epoch: 1, Steps: 12 | Train Loss: 2.815 Vali Loss: 2.742 Vali Acc: 0.039 Test Loss: 2.742 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 2.512131929397583
Epoch: 2, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.517 Vali Acc: 0.206 Test Loss: 2.517 Test Acc: 0.206
Validation loss decreased (-0.038861 --> -0.205530).  Saving model ...
Epoch: 3 cost time: 2.5705325603485107
Epoch: 3, Steps: 12 | Train Loss: 2.382 Vali Loss: 2.254 Vali Acc: 0.433 Test Loss: 2.254 Test Acc: 0.433
Validation loss decreased (-0.205530 --> -0.433311).  Saving model ...
Epoch: 4 cost time: 2.49881649017334
Epoch: 4, Steps: 12 | Train Loss: 2.069 Vali Loss: 1.989 Vali Acc: 0.522 Test Loss: 1.989 Test Acc: 0.522
Validation loss decreased (-0.433311 --> -0.522202).  Saving model ...
Epoch: 5 cost time: 2.578928232192993
Epoch: 5, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.755 Vali Acc: 0.528 Test Loss: 1.755 Test Acc: 0.528
Validation loss decreased (-0.522202 --> -0.527760).  Saving model ...
Epoch: 6 cost time: 2.5604653358459473
Epoch: 6, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.532 Vali Acc: 0.617 Test Loss: 1.532 Test Acc: 0.617
Validation loss decreased (-0.527760 --> -0.616651).  Saving model ...
Epoch: 7 cost time: 2.5074639320373535
Epoch: 7, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.361 Vali Acc: 0.639 Test Loss: 1.361 Test Acc: 0.639
Validation loss decreased (-0.616651 --> -0.638875).  Saving model ...
Epoch: 8 cost time: 2.4535279273986816
Epoch: 8, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.210 Vali Acc: 0.656 Test Loss: 1.210 Test Acc: 0.656
Validation loss decreased (-0.638875 --> -0.655543).  Saving model ...
Epoch: 9 cost time: 2.5007524490356445
Epoch: 9, Steps: 12 | Train Loss: 0.947 Vali Loss: 1.098 Vali Acc: 0.639 Test Loss: 1.098 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.597486734390259
Epoch: 10, Steps: 12 | Train Loss: 0.824 Vali Loss: 1.014 Vali Acc: 0.667 Test Loss: 1.014 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 2.5686347484588623
Epoch: 11, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.935 Vali Acc: 0.672 Test Loss: 0.935 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672213).  Saving model ...
Epoch: 12 cost time: 2.4805829524993896
Epoch: 12, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.865 Vali Acc: 0.678 Test Loss: 0.865 Test Acc: 0.678
Validation loss decreased (-0.672213 --> -0.677769).  Saving model ...
Epoch: 13 cost time: 2.476030111312866
Epoch: 13, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.809 Vali Acc: 0.700 Test Loss: 0.809 Test Acc: 0.700
Validation loss decreased (-0.677769 --> -0.699992).  Saving model ...
Epoch: 14 cost time: 2.583371162414551
Epoch: 14, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.780 Vali Acc: 0.717 Test Loss: 0.780 Test Acc: 0.717
Validation loss decreased (-0.699992 --> -0.716659).  Saving model ...
Epoch: 15 cost time: 2.554931879043579
Epoch: 15, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.747 Vali Acc: 0.739 Test Loss: 0.747 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738881).  Saving model ...
Epoch: 16 cost time: 2.5736780166625977
Epoch: 16, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.741 Vali Acc: 0.717 Test Loss: 0.741 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4970569610595703
Epoch: 17, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.734 Vali Acc: 0.700 Test Loss: 0.734 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.5367181301116943
Epoch: 18, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.688 Vali Acc: 0.728 Test Loss: 0.688 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.533681631088257
Epoch: 19, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.680 Vali Acc: 0.728 Test Loss: 0.680 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.6728742122650146
Epoch: 20, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.689 Vali Acc: 0.739 Test Loss: 0.689 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738882).  Saving model ...
Epoch: 21 cost time: 2.474241018295288
Epoch: 21, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.650 Vali Acc: 0.733 Test Loss: 0.650 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.521934747695923
Epoch: 22, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.667 Vali Acc: 0.761 Test Loss: 0.667 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761104).  Saving model ...
Epoch: 23 cost time: 2.490135908126831
Epoch: 23, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.656 Vali Acc: 0.756 Test Loss: 0.656 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.686192274093628
Epoch: 24, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.657 Vali Acc: 0.761 Test Loss: 0.657 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761105).  Saving model ...
Epoch: 25 cost time: 2.543173313140869
Epoch: 25, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.673 Vali Acc: 0.761 Test Loss: 0.673 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5393714904785156
Epoch: 26, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.667 Vali Acc: 0.739 Test Loss: 0.667 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4533822536468506
Epoch: 27, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.5083680152893066
Epoch: 28, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.675 Vali Acc: 0.744 Test Loss: 0.675 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.5859694480895996
Epoch: 29, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.669 Vali Acc: 0.756 Test Loss: 0.669 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.6223180294036865
Epoch: 30, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.680 Vali Acc: 0.761 Test Loss: 0.680 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 2088303
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.546915054321289
Epoch: 1, Steps: 12 | Train Loss: 2.822 Vali Loss: 2.758 Vali Acc: 0.106 Test Loss: 2.758 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 2.8413054943084717
Epoch: 2, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.556 Vali Acc: 0.200 Test Loss: 2.556 Test Acc: 0.200
Validation loss decreased (-0.105528 --> -0.199974).  Saving model ...
Epoch: 3 cost time: 2.8246753215789795
Epoch: 3, Steps: 12 | Train Loss: 2.426 Vali Loss: 2.311 Vali Acc: 0.322 Test Loss: 2.311 Test Acc: 0.322
Validation loss decreased (-0.199974 --> -0.322199).  Saving model ...
Epoch: 4 cost time: 2.7363460063934326
Epoch: 4, Steps: 12 | Train Loss: 2.184 Vali Loss: 2.090 Vali Acc: 0.483 Test Loss: 2.090 Test Acc: 0.483
Validation loss decreased (-0.322199 --> -0.483312).  Saving model ...
Epoch: 5 cost time: 2.9098150730133057
Epoch: 5, Steps: 12 | Train Loss: 1.919 Vali Loss: 1.882 Vali Acc: 0.561 Test Loss: 1.882 Test Acc: 0.561
Validation loss decreased (-0.483312 --> -0.561092).  Saving model ...
Epoch: 6 cost time: 2.9150094985961914
Epoch: 6, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.691 Vali Acc: 0.589 Test Loss: 1.691 Test Acc: 0.589
Validation loss decreased (-0.561092 --> -0.588872).  Saving model ...
Epoch: 7 cost time: 2.9123053550720215
Epoch: 7, Steps: 12 | Train Loss: 1.443 Vali Loss: 1.518 Vali Acc: 0.567 Test Loss: 1.518 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8797104358673096
Epoch: 8, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.346 Vali Acc: 0.594 Test Loss: 1.346 Test Acc: 0.594
Validation loss decreased (-0.588872 --> -0.594431).  Saving model ...
Epoch: 9 cost time: 2.785531520843506
Epoch: 9, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.222 Vali Acc: 0.606 Test Loss: 1.222 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605543).  Saving model ...
Epoch: 10 cost time: 2.8584606647491455
Epoch: 10, Steps: 12 | Train Loss: 0.958 Vali Loss: 1.105 Vali Acc: 0.611 Test Loss: 1.105 Test Acc: 0.611
Validation loss decreased (-0.605543 --> -0.611100).  Saving model ...
Epoch: 11 cost time: 2.852766513824463
Epoch: 11, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.024 Vali Acc: 0.611 Test Loss: 1.024 Test Acc: 0.611
Validation loss decreased (-0.611100 --> -0.611101).  Saving model ...
Epoch: 12 cost time: 2.7923171520233154
Epoch: 12, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.960 Vali Acc: 0.672 Test Loss: 0.960 Test Acc: 0.672
Validation loss decreased (-0.611101 --> -0.672213).  Saving model ...
Epoch: 13 cost time: 2.748687744140625
Epoch: 13, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.903 Vali Acc: 0.717 Test Loss: 0.903 Test Acc: 0.717
Validation loss decreased (-0.672213 --> -0.716658).  Saving model ...
Epoch: 14 cost time: 2.875200033187866
Epoch: 14, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.808 Vali Acc: 0.728 Test Loss: 0.808 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727770).  Saving model ...
Epoch: 15 cost time: 2.893186330795288
Epoch: 15, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.794 Vali Acc: 0.700 Test Loss: 0.794 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7017674446105957
Epoch: 16, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749993).  Saving model ...
Epoch: 17 cost time: 2.6337103843688965
Epoch: 17, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.753 Vali Acc: 0.722 Test Loss: 0.753 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.699744701385498
Epoch: 18, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.709 Vali Acc: 0.739 Test Loss: 0.709 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6985459327697754
Epoch: 19, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.724 Vali Acc: 0.756 Test Loss: 0.724 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755548).  Saving model ...
Epoch: 20 cost time: 2.709167003631592
Epoch: 20, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.719 Vali Acc: 0.733 Test Loss: 0.719 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5954132080078125
Epoch: 21, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.676 Vali Acc: 0.772 Test Loss: 0.676 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 22 cost time: 2.5641348361968994
Epoch: 22, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.642 Vali Acc: 0.756 Test Loss: 0.642 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.602482557296753
Epoch: 23, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.631 Vali Acc: 0.772 Test Loss: 0.631 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772216).  Saving model ...
Epoch: 24 cost time: 2.6732375621795654
Epoch: 24, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.579 Vali Acc: 0.806 Test Loss: 0.579 Test Acc: 0.806
Validation loss decreased (-0.772216 --> -0.805550).  Saving model ...
Epoch: 25 cost time: 2.569554567337036
Epoch: 25, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.661345958709717
Epoch: 26, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.565 Vali Acc: 0.811 Test Loss: 0.565 Test Acc: 0.811
Validation loss decreased (-0.805550 --> -0.811105).  Saving model ...
Epoch: 27 cost time: 2.6676440238952637
Epoch: 27, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.573 Vali Acc: 0.806 Test Loss: 0.573 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.75077223777771
Epoch: 28, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.768132448196411
Epoch: 29, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.6109814643859863
Epoch: 30, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.615 Vali Acc: 0.789 Test Loss: 0.615 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 7053615
model size : 27.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6107406616210938
Epoch: 1, Steps: 12 | Train Loss: 2.824 Vali Loss: 2.760 Vali Acc: 0.039 Test Loss: 2.760 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 2.0116660594940186
Epoch: 2, Steps: 12 | Train Loss: 2.700 Vali Loss: 2.585 Vali Acc: 0.128 Test Loss: 2.585 Test Acc: 0.128
Validation loss decreased (-0.038861 --> -0.127752).  Saving model ...
Epoch: 3 cost time: 2.025010824203491
Epoch: 3, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.375 Vali Acc: 0.356 Test Loss: 2.375 Test Acc: 0.356
Validation loss decreased (-0.127752 --> -0.355532).  Saving model ...
Epoch: 4 cost time: 1.988691806793213
Epoch: 4, Steps: 12 | Train Loss: 2.222 Vali Loss: 2.157 Vali Acc: 0.428 Test Loss: 2.157 Test Acc: 0.428
Validation loss decreased (-0.355532 --> -0.427756).  Saving model ...
Epoch: 5 cost time: 2.0475046634674072
Epoch: 5, Steps: 12 | Train Loss: 1.990 Vali Loss: 1.964 Vali Acc: 0.461 Test Loss: 1.964 Test Acc: 0.461
Validation loss decreased (-0.427756 --> -0.461091).  Saving model ...
Epoch: 6 cost time: 2.049933910369873
Epoch: 6, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.774 Vali Acc: 0.539 Test Loss: 1.774 Test Acc: 0.539
Validation loss decreased (-0.461091 --> -0.538871).  Saving model ...
Epoch: 7 cost time: 2.120709180831909
Epoch: 7, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.617 Vali Acc: 0.556 Test Loss: 1.617 Test Acc: 0.556
Validation loss decreased (-0.538871 --> -0.555539).  Saving model ...
Epoch: 8 cost time: 2.000025987625122
Epoch: 8, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.466 Vali Acc: 0.567 Test Loss: 1.466 Test Acc: 0.567
Validation loss decreased (-0.555539 --> -0.566652).  Saving model ...
Epoch: 9 cost time: 2.04803204536438
Epoch: 9, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.348 Vali Acc: 0.606 Test Loss: 1.348 Test Acc: 0.606
Validation loss decreased (-0.566652 --> -0.605542).  Saving model ...
Epoch: 10 cost time: 2.0479583740234375
Epoch: 10, Steps: 12 | Train Loss: 1.037 Vali Loss: 1.259 Vali Acc: 0.606 Test Loss: 1.259 Test Acc: 0.606
Validation loss decreased (-0.605542 --> -0.605543).  Saving model ...
Epoch: 11 cost time: 2.0601389408111572
Epoch: 11, Steps: 12 | Train Loss: 0.938 Vali Loss: 1.191 Vali Acc: 0.589 Test Loss: 1.191 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.097287178039551
Epoch: 12, Steps: 12 | Train Loss: 0.806 Vali Loss: 1.129 Vali Acc: 0.600 Test Loss: 1.129 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2269506454467773
Epoch: 13, Steps: 12 | Train Loss: 0.736 Vali Loss: 1.074 Vali Acc: 0.611 Test Loss: 1.074 Test Acc: 0.611
Validation loss decreased (-0.605543 --> -0.611100).  Saving model ...
Epoch: 14 cost time: 2.023313045501709
Epoch: 14, Steps: 12 | Train Loss: 0.684 Vali Loss: 1.026 Vali Acc: 0.650 Test Loss: 1.026 Test Acc: 0.650
Validation loss decreased (-0.611100 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 2.014159679412842
Epoch: 15, Steps: 12 | Train Loss: 0.562 Vali Loss: 1.004 Vali Acc: 0.656 Test Loss: 1.004 Test Acc: 0.656
Validation loss decreased (-0.649990 --> -0.655546).  Saving model ...
Epoch: 16 cost time: 2.0349297523498535
Epoch: 16, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.974 Vali Acc: 0.656 Test Loss: 0.974 Test Acc: 0.656
Validation loss decreased (-0.655546 --> -0.655546).  Saving model ...
Epoch: 17 cost time: 2.0698230266571045
Epoch: 17, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.935 Vali Acc: 0.644 Test Loss: 0.935 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0915310382843018
Epoch: 18, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.888 Vali Acc: 0.672 Test Loss: 0.888 Test Acc: 0.672
Validation loss decreased (-0.655546 --> -0.672213).  Saving model ...
Epoch: 19 cost time: 1.979407787322998
Epoch: 19, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.858 Vali Acc: 0.678 Test Loss: 0.858 Test Acc: 0.678
Validation loss decreased (-0.672213 --> -0.677769).  Saving model ...
Epoch: 20 cost time: 2.0083513259887695
Epoch: 20, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.836 Vali Acc: 0.678 Test Loss: 0.836 Test Acc: 0.678
Validation loss decreased (-0.677769 --> -0.677769).  Saving model ...
Epoch: 21 cost time: 2.0096516609191895
Epoch: 21, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.814 Vali Acc: 0.672 Test Loss: 0.814 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0748753547668457
Epoch: 22, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.804 Vali Acc: 0.700 Test Loss: 0.804 Test Acc: 0.700
Validation loss decreased (-0.677769 --> -0.699992).  Saving model ...
Epoch: 23 cost time: 1.9980332851409912
Epoch: 23, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.794 Vali Acc: 0.717 Test Loss: 0.794 Test Acc: 0.717
Validation loss decreased (-0.699992 --> -0.716659).  Saving model ...
Epoch: 24 cost time: 2.097336530685425
Epoch: 24, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.769 Vali Acc: 0.722 Test Loss: 0.769 Test Acc: 0.722
Validation loss decreased (-0.716659 --> -0.722215).  Saving model ...
Epoch: 25 cost time: 2.003481388092041
Epoch: 25, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.750 Vali Acc: 0.778 Test Loss: 0.750 Test Acc: 0.778
Validation loss decreased (-0.722215 --> -0.777770).  Saving model ...
Epoch: 26 cost time: 2.0918450355529785
Epoch: 26, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.786 Vali Acc: 0.728 Test Loss: 0.786 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9930846691131592
Epoch: 27, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.731 Vali Acc: 0.778 Test Loss: 0.731 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 28 cost time: 2.1328284740448
Epoch: 28, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.786 Vali Acc: 0.767 Test Loss: 0.786 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0504939556121826
Epoch: 29, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.770 Vali Acc: 0.761 Test Loss: 0.770 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9479649066925049
Epoch: 30, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.867 Vali Acc: 0.750 Test Loss: 0.867 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 2088303
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.069098472595215
Epoch: 1, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.653 Vali Acc: 0.083 Test Loss: 2.653 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 4.105959892272949
Epoch: 2, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.464 Vali Acc: 0.211 Test Loss: 2.464 Test Acc: 0.211
Validation loss decreased (-0.083307 --> -0.211086).  Saving model ...
Epoch: 3 cost time: 4.0139479637146
Epoch: 3, Steps: 12 | Train Loss: 2.349 Vali Loss: 2.224 Vali Acc: 0.433 Test Loss: 2.224 Test Acc: 0.433
Validation loss decreased (-0.211086 --> -0.433311).  Saving model ...
Epoch: 4 cost time: 4.36751127243042
Epoch: 4, Steps: 12 | Train Loss: 2.085 Vali Loss: 1.967 Vali Acc: 0.517 Test Loss: 1.967 Test Acc: 0.517
Validation loss decreased (-0.433311 --> -0.516647).  Saving model ...
Epoch: 5 cost time: 4.249526262283325
Epoch: 5, Steps: 12 | Train Loss: 1.779 Vali Loss: 1.723 Vali Acc: 0.556 Test Loss: 1.723 Test Acc: 0.556
Validation loss decreased (-0.516647 --> -0.555538).  Saving model ...
Epoch: 6 cost time: 4.18597936630249
Epoch: 6, Steps: 12 | Train Loss: 1.475 Vali Loss: 1.496 Vali Acc: 0.572 Test Loss: 1.496 Test Acc: 0.572
Validation loss decreased (-0.555538 --> -0.572207).  Saving model ...
Epoch: 7 cost time: 4.191950559616089
Epoch: 7, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.297 Vali Acc: 0.639 Test Loss: 1.297 Test Acc: 0.639
Validation loss decreased (-0.572207 --> -0.638876).  Saving model ...
Epoch: 8 cost time: 4.244988918304443
Epoch: 8, Steps: 12 | Train Loss: 1.030 Vali Loss: 1.120 Vali Acc: 0.694 Test Loss: 1.120 Test Acc: 0.694
Validation loss decreased (-0.638876 --> -0.694433).  Saving model ...
Epoch: 9 cost time: 4.0876383781433105
Epoch: 9, Steps: 12 | Train Loss: 0.861 Vali Loss: 0.987 Vali Acc: 0.711 Test Loss: 0.987 Test Acc: 0.711
Validation loss decreased (-0.694433 --> -0.711101).  Saving model ...
Epoch: 10 cost time: 3.999199151992798
Epoch: 10, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.886 Vali Acc: 0.728 Test Loss: 0.886 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727769).  Saving model ...
Epoch: 11 cost time: 4.259682655334473
Epoch: 11, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.821 Vali Acc: 0.728 Test Loss: 0.821 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727770).  Saving model ...
Epoch: 12 cost time: 4.102357864379883
Epoch: 12, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.757 Vali Acc: 0.750 Test Loss: 0.757 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 4.142153263092041
Epoch: 13, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.731 Vali Acc: 0.733 Test Loss: 0.731 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.294917106628418
Epoch: 14, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.690 Vali Acc: 0.750 Test Loss: 0.690 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 4.103280067443848
Epoch: 15, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.697 Vali Acc: 0.744 Test Loss: 0.697 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.0644824504852295
Epoch: 16, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.690 Vali Acc: 0.744 Test Loss: 0.690 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.239282846450806
Epoch: 17, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.685 Vali Acc: 0.750 Test Loss: 0.685 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 18 cost time: 4.060069799423218
Epoch: 18, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.700 Vali Acc: 0.772 Test Loss: 0.700 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772215).  Saving model ...
Epoch: 19 cost time: 3.9818639755249023
Epoch: 19, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.671 Vali Acc: 0.778 Test Loss: 0.671 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 20 cost time: 3.9141006469726562
Epoch: 20, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.994915246963501
Epoch: 21, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.722 Vali Acc: 0.761 Test Loss: 0.722 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.846198797225952
Epoch: 22, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.756 Vali Acc: 0.772 Test Loss: 0.756 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.0500171184539795
Epoch: 23, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.707 Vali Acc: 0.761 Test Loss: 0.707 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.9917492866516113
Epoch: 24, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.711 Vali Acc: 0.783 Test Loss: 0.711 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783326).  Saving model ...
Epoch: 25 cost time: 3.9032866954803467
Epoch: 25, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.691 Vali Acc: 0.794 Test Loss: 0.691 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 26 cost time: 3.882070302963257
Epoch: 26, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.726 Vali Acc: 0.800 Test Loss: 0.726 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 3.7316439151763916
Epoch: 27, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.688 Vali Acc: 0.783 Test Loss: 0.688 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.9760475158691406
Epoch: 28, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.701 Vali Acc: 0.783 Test Loss: 0.701 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.896850109100342
Epoch: 29, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.739 Vali Acc: 0.789 Test Loss: 0.739 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.8364169597625732
Epoch: 30, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.716 Vali Acc: 0.789 Test Loss: 0.716 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 3538095
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.388871908187866
Epoch: 1, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.726 Vali Acc: 0.117 Test Loss: 2.726 Test Acc: 0.117
Validation loss decreased (inf --> -0.116639).  Saving model ...
Epoch: 2 cost time: 2.596315383911133
Epoch: 2, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.527 Vali Acc: 0.200 Test Loss: 2.527 Test Acc: 0.200
Validation loss decreased (-0.116639 --> -0.199975).  Saving model ...
Epoch: 3 cost time: 2.681891679763794
Epoch: 3, Steps: 12 | Train Loss: 2.312 Vali Loss: 2.289 Vali Acc: 0.378 Test Loss: 2.289 Test Acc: 0.378
Validation loss decreased (-0.199975 --> -0.377755).  Saving model ...
Epoch: 4 cost time: 2.6456518173217773
Epoch: 4, Steps: 12 | Train Loss: 2.102 Vali Loss: 2.046 Vali Acc: 0.467 Test Loss: 2.046 Test Acc: 0.467
Validation loss decreased (-0.377755 --> -0.466646).  Saving model ...
Epoch: 5 cost time: 2.5871429443359375
Epoch: 5, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.818 Vali Acc: 0.478 Test Loss: 1.818 Test Acc: 0.478
Validation loss decreased (-0.466646 --> -0.477760).  Saving model ...
Epoch: 6 cost time: 2.6399598121643066
Epoch: 6, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.613 Vali Acc: 0.544 Test Loss: 1.613 Test Acc: 0.544
Validation loss decreased (-0.477760 --> -0.544428).  Saving model ...
Epoch: 7 cost time: 2.5894527435302734
Epoch: 7, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.419 Vali Acc: 0.594 Test Loss: 1.419 Test Acc: 0.594
Validation loss decreased (-0.544428 --> -0.594430).  Saving model ...
Epoch: 8 cost time: 2.644503116607666
Epoch: 8, Steps: 12 | Train Loss: 1.145 Vali Loss: 1.273 Vali Acc: 0.606 Test Loss: 1.273 Test Acc: 0.606
Validation loss decreased (-0.594430 --> -0.605543).  Saving model ...
Epoch: 9 cost time: 2.7294085025787354
Epoch: 9, Steps: 12 | Train Loss: 0.984 Vali Loss: 1.145 Vali Acc: 0.628 Test Loss: 1.145 Test Acc: 0.628
Validation loss decreased (-0.605543 --> -0.627766).  Saving model ...
Epoch: 10 cost time: 2.5843043327331543
Epoch: 10, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.055 Vali Acc: 0.672 Test Loss: 1.055 Test Acc: 0.672
Validation loss decreased (-0.627766 --> -0.672212).  Saving model ...
Epoch: 11 cost time: 2.5248444080352783
Epoch: 11, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.961 Vali Acc: 0.656 Test Loss: 0.961 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7115299701690674
Epoch: 12, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.890 Vali Acc: 0.644 Test Loss: 0.890 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.671581268310547
Epoch: 13, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.832 Vali Acc: 0.694 Test Loss: 0.832 Test Acc: 0.694
Validation loss decreased (-0.672212 --> -0.694436).  Saving model ...
Epoch: 14 cost time: 2.6063995361328125
Epoch: 14, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.779 Vali Acc: 0.717 Test Loss: 0.779 Test Acc: 0.717
Validation loss decreased (-0.694436 --> -0.716659).  Saving model ...
Epoch: 15 cost time: 2.711632251739502
Epoch: 15, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.757 Vali Acc: 0.728 Test Loss: 0.757 Test Acc: 0.728
Validation loss decreased (-0.716659 --> -0.727770).  Saving model ...
Epoch: 16 cost time: 2.6326253414154053
Epoch: 16, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.746 Vali Acc: 0.711 Test Loss: 0.746 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6653249263763428
Epoch: 17, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.712 Vali Acc: 0.733 Test Loss: 0.712 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733326).  Saving model ...
Epoch: 18 cost time: 2.7084381580352783
Epoch: 18, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.696 Vali Acc: 0.739 Test Loss: 0.696 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 19 cost time: 2.7045838832855225
Epoch: 19, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.662 Vali Acc: 0.744 Test Loss: 0.662 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 20 cost time: 2.7202529907226562
Epoch: 20, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.666 Vali Acc: 0.733 Test Loss: 0.666 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7787065505981445
Epoch: 21, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.658 Vali Acc: 0.733 Test Loss: 0.658 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7264389991760254
Epoch: 22, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.646 Vali Acc: 0.772 Test Loss: 0.646 Test Acc: 0.772
Validation loss decreased (-0.744438 --> -0.772216).  Saving model ...
Epoch: 23 cost time: 2.692621946334839
Epoch: 23, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.647 Vali Acc: 0.783 Test Loss: 0.647 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783327).  Saving model ...
Epoch: 24 cost time: 2.8289287090301514
Epoch: 24, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.654 Vali Acc: 0.756 Test Loss: 0.654 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7513365745544434
Epoch: 25, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.645 Vali Acc: 0.778 Test Loss: 0.645 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.789731502532959
Epoch: 26, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.645 Vali Acc: 0.767 Test Loss: 0.645 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.641385555267334
Epoch: 27, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.692 Vali Acc: 0.767 Test Loss: 0.692 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.7575950622558594
Epoch: 28, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.692 Vali Acc: 0.789 Test Loss: 0.692 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788882).  Saving model ...
Epoch: 29 cost time: 2.745598793029785
Epoch: 29, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.668 Vali Acc: 0.778 Test Loss: 0.668 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.7251107692718506
Epoch: 30, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.674 Vali Acc: 0.744 Test Loss: 0.674 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 1055343
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.896426439285278
Epoch: 1, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.653 Vali Acc: 0.083 Test Loss: 2.653 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 3.210106611251831
Epoch: 2, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.464 Vali Acc: 0.211 Test Loss: 2.464 Test Acc: 0.211
Validation loss decreased (-0.083307 --> -0.211086).  Saving model ...
Epoch: 3 cost time: 3.1876513957977295
Epoch: 3, Steps: 12 | Train Loss: 2.351 Vali Loss: 2.223 Vali Acc: 0.433 Test Loss: 2.223 Test Acc: 0.433
Validation loss decreased (-0.211086 --> -0.433311).  Saving model ...
Epoch: 4 cost time: 3.264784336090088
Epoch: 4, Steps: 12 | Train Loss: 2.086 Vali Loss: 1.966 Vali Acc: 0.511 Test Loss: 1.966 Test Acc: 0.511
Validation loss decreased (-0.433311 --> -0.511091).  Saving model ...
Epoch: 5 cost time: 3.167985677719116
Epoch: 5, Steps: 12 | Train Loss: 1.782 Vali Loss: 1.723 Vali Acc: 0.567 Test Loss: 1.723 Test Acc: 0.567
Validation loss decreased (-0.511091 --> -0.566649).  Saving model ...
Epoch: 6 cost time: 3.261043071746826
Epoch: 6, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.497 Vali Acc: 0.567 Test Loss: 1.497 Test Acc: 0.567
Validation loss decreased (-0.566649 --> -0.566652).  Saving model ...
Epoch: 7 cost time: 3.1193606853485107
Epoch: 7, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.305 Vali Acc: 0.639 Test Loss: 1.305 Test Acc: 0.639
Validation loss decreased (-0.566652 --> -0.638876).  Saving model ...
Epoch: 8 cost time: 3.3625998497009277
Epoch: 8, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.133 Vali Acc: 0.689 Test Loss: 1.133 Test Acc: 0.689
Validation loss decreased (-0.638876 --> -0.688878).  Saving model ...
Epoch: 9 cost time: 3.1958017349243164
Epoch: 9, Steps: 12 | Train Loss: 0.899 Vali Loss: 1.006 Vali Acc: 0.689 Test Loss: 1.006 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688879).  Saving model ...
Epoch: 10 cost time: 3.3006386756896973
Epoch: 10, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.903 Vali Acc: 0.717 Test Loss: 0.903 Test Acc: 0.717
Validation loss decreased (-0.688879 --> -0.716658).  Saving model ...
Epoch: 11 cost time: 3.2112839221954346
Epoch: 11, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.836 Vali Acc: 0.717 Test Loss: 0.836 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 12 cost time: 3.341867446899414
Epoch: 12, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.771 Vali Acc: 0.739 Test Loss: 0.771 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738881).  Saving model ...
Epoch: 13 cost time: 3.2490713596343994
Epoch: 13, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.748 Vali Acc: 0.722 Test Loss: 0.748 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2857894897460938
Epoch: 14, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.692 Vali Acc: 0.750 Test Loss: 0.692 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 3.219271421432495
Epoch: 15, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.686 Vali Acc: 0.733 Test Loss: 0.686 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.264174461364746
Epoch: 16, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.680 Vali Acc: 0.756 Test Loss: 0.680 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 17 cost time: 2.9841370582580566
Epoch: 17, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.669 Vali Acc: 0.761 Test Loss: 0.669 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 18 cost time: 3.039642572402954
Epoch: 18, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.672 Vali Acc: 0.756 Test Loss: 0.672 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9669036865234375
Epoch: 19, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.632 Vali Acc: 0.778 Test Loss: 0.632 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 20 cost time: 3.0910110473632812
Epoch: 20, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.639 Vali Acc: 0.767 Test Loss: 0.639 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0404398441314697
Epoch: 21, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.641 Vali Acc: 0.778 Test Loss: 0.641 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.9938623905181885
Epoch: 22, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 23 cost time: 3.199782371520996
Epoch: 23, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.657 Vali Acc: 0.789 Test Loss: 0.657 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788882).  Saving model ...
Epoch: 24 cost time: 3.003124237060547
Epoch: 24, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.657 Vali Acc: 0.783 Test Loss: 0.657 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.0925590991973877
Epoch: 25, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.0080173015594482
Epoch: 26, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.684 Vali Acc: 0.783 Test Loss: 0.684 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.1806421279907227
Epoch: 27, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.0559940338134766
Epoch: 28, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.675 Vali Acc: 0.806 Test Loss: 0.675 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 29 cost time: 3.2244389057159424
Epoch: 29, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.717 Vali Acc: 0.767 Test Loss: 0.717 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.009019136428833
Epoch: 30, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.707 Vali Acc: 0.767 Test Loss: 0.707 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 3538095
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.243959188461304
Epoch: 1, Steps: 12 | Train Loss: 2.747 Vali Loss: 2.725 Vali Acc: 0.117 Test Loss: 2.725 Test Acc: 0.117
Validation loss decreased (inf --> -0.116639).  Saving model ...
Epoch: 2 cost time: 2.35408091545105
Epoch: 2, Steps: 12 | Train Loss: 2.576 Vali Loss: 2.526 Vali Acc: 0.200 Test Loss: 2.526 Test Acc: 0.200
Validation loss decreased (-0.116639 --> -0.199975).  Saving model ...
Epoch: 3 cost time: 2.48651123046875
Epoch: 3, Steps: 12 | Train Loss: 2.313 Vali Loss: 2.287 Vali Acc: 0.378 Test Loss: 2.287 Test Acc: 0.378
Validation loss decreased (-0.199975 --> -0.377755).  Saving model ...
Epoch: 4 cost time: 2.356901168823242
Epoch: 4, Steps: 12 | Train Loss: 2.112 Vali Loss: 2.043 Vali Acc: 0.467 Test Loss: 2.043 Test Acc: 0.467
Validation loss decreased (-0.377755 --> -0.466646).  Saving model ...
Epoch: 5 cost time: 2.4008708000183105
Epoch: 5, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.813 Vali Acc: 0.472 Test Loss: 1.813 Test Acc: 0.472
Validation loss decreased (-0.466646 --> -0.472204).  Saving model ...
Epoch: 6 cost time: 2.3831770420074463
Epoch: 6, Steps: 12 | Train Loss: 1.555 Vali Loss: 1.607 Vali Acc: 0.533 Test Loss: 1.607 Test Acc: 0.533
Validation loss decreased (-0.472204 --> -0.533317).  Saving model ...
Epoch: 7 cost time: 2.380171298980713
Epoch: 7, Steps: 12 | Train Loss: 1.369 Vali Loss: 1.412 Vali Acc: 0.594 Test Loss: 1.412 Test Acc: 0.594
Validation loss decreased (-0.533317 --> -0.594430).  Saving model ...
Epoch: 8 cost time: 2.514019727706909
Epoch: 8, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.267 Vali Acc: 0.611 Test Loss: 1.267 Test Acc: 0.611
Validation loss decreased (-0.594430 --> -0.611098).  Saving model ...
Epoch: 9 cost time: 2.3587875366210938
Epoch: 9, Steps: 12 | Train Loss: 0.998 Vali Loss: 1.139 Vali Acc: 0.644 Test Loss: 1.139 Test Acc: 0.644
Validation loss decreased (-0.611098 --> -0.644433).  Saving model ...
Epoch: 10 cost time: 2.4195382595062256
Epoch: 10, Steps: 12 | Train Loss: 0.855 Vali Loss: 1.047 Vali Acc: 0.667 Test Loss: 1.047 Test Acc: 0.667
Validation loss decreased (-0.644433 --> -0.666656).  Saving model ...
Epoch: 11 cost time: 2.3596091270446777
Epoch: 11, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.956 Vali Acc: 0.667 Test Loss: 0.956 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 12 cost time: 2.4416990280151367
Epoch: 12, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.887 Vali Acc: 0.667 Test Loss: 0.887 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666658).  Saving model ...
Epoch: 13 cost time: 2.4036667346954346
Epoch: 13, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.831 Vali Acc: 0.700 Test Loss: 0.831 Test Acc: 0.700
Validation loss decreased (-0.666658 --> -0.699992).  Saving model ...
Epoch: 14 cost time: 2.3413097858428955
Epoch: 14, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.771 Vali Acc: 0.733 Test Loss: 0.771 Test Acc: 0.733
Validation loss decreased (-0.699992 --> -0.733326).  Saving model ...
Epoch: 15 cost time: 2.339205741882324
Epoch: 15, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.749 Vali Acc: 0.728 Test Loss: 0.749 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.412240743637085
Epoch: 16, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.743 Vali Acc: 0.711 Test Loss: 0.743 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.309718370437622
Epoch: 17, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.706 Vali Acc: 0.728 Test Loss: 0.706 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3237016201019287
Epoch: 18, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.691 Vali Acc: 0.739 Test Loss: 0.691 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 19 cost time: 2.3425471782684326
Epoch: 19, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.660 Vali Acc: 0.739 Test Loss: 0.660 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738882).  Saving model ...
Epoch: 20 cost time: 2.3752591609954834
Epoch: 20, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.666 Vali Acc: 0.728 Test Loss: 0.666 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.368748426437378
Epoch: 21, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.653 Vali Acc: 0.739 Test Loss: 0.653 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738882).  Saving model ...
Epoch: 22 cost time: 2.4635472297668457
Epoch: 22, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.638 Vali Acc: 0.761 Test Loss: 0.638 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761105).  Saving model ...
Epoch: 23 cost time: 2.2865049839019775
Epoch: 23, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.650 Vali Acc: 0.778 Test Loss: 0.650 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777771).  Saving model ...
Epoch: 24 cost time: 2.3768045902252197
Epoch: 24, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.649 Vali Acc: 0.761 Test Loss: 0.649 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3090322017669678
Epoch: 25, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.362644672393799
Epoch: 26, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.638 Vali Acc: 0.772 Test Loss: 0.638 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4010016918182373
Epoch: 27, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.684 Vali Acc: 0.767 Test Loss: 0.684 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.3351497650146484
Epoch: 28, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.646 Vali Acc: 0.783 Test Loss: 0.646 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 29 cost time: 2.3542850017547607
Epoch: 29, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788883).  Saving model ...
Epoch: 30 cost time: 2.363142251968384
Epoch: 30, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.695 Vali Acc: 0.761 Test Loss: 0.695 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 1055343
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.039658784866333
Epoch: 1, Steps: 12 | Train Loss: 2.767 Vali Loss: 2.665 Vali Acc: 0.083 Test Loss: 2.665 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 2.447376012802124
Epoch: 2, Steps: 12 | Train Loss: 2.620 Vali Loss: 2.511 Vali Acc: 0.183 Test Loss: 2.511 Test Acc: 0.183
Validation loss decreased (-0.083307 --> -0.183308).  Saving model ...
Epoch: 3 cost time: 2.463367223739624
Epoch: 3, Steps: 12 | Train Loss: 2.413 Vali Loss: 2.319 Vali Acc: 0.367 Test Loss: 2.319 Test Acc: 0.367
Validation loss decreased (-0.183308 --> -0.366643).  Saving model ...
Epoch: 4 cost time: 2.416348934173584
Epoch: 4, Steps: 12 | Train Loss: 2.219 Vali Loss: 2.118 Vali Acc: 0.444 Test Loss: 2.118 Test Acc: 0.444
Validation loss decreased (-0.366643 --> -0.444423).  Saving model ...
Epoch: 5 cost time: 2.416651964187622
Epoch: 5, Steps: 12 | Train Loss: 1.965 Vali Loss: 1.921 Vali Acc: 0.528 Test Loss: 1.921 Test Acc: 0.528
Validation loss decreased (-0.444423 --> -0.527759).  Saving model ...
Epoch: 6 cost time: 2.4432759284973145
Epoch: 6, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.731 Vali Acc: 0.572 Test Loss: 1.731 Test Acc: 0.572
Validation loss decreased (-0.527759 --> -0.572205).  Saving model ...
Epoch: 7 cost time: 2.490802764892578
Epoch: 7, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.560 Vali Acc: 0.556 Test Loss: 1.560 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.617217540740967
Epoch: 8, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.389 Vali Acc: 0.594 Test Loss: 1.389 Test Acc: 0.594
Validation loss decreased (-0.572205 --> -0.594431).  Saving model ...
Epoch: 9 cost time: 2.5066425800323486
Epoch: 9, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.253 Vali Acc: 0.633 Test Loss: 1.253 Test Acc: 0.633
Validation loss decreased (-0.594431 --> -0.633321).  Saving model ...
Epoch: 10 cost time: 2.4482297897338867
Epoch: 10, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.147 Vali Acc: 0.650 Test Loss: 1.147 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 2.4659204483032227
Epoch: 11, Steps: 12 | Train Loss: 0.856 Vali Loss: 1.057 Vali Acc: 0.633 Test Loss: 1.057 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5195066928863525
Epoch: 12, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.983 Vali Acc: 0.661 Test Loss: 0.983 Test Acc: 0.661
Validation loss decreased (-0.649989 --> -0.661101).  Saving model ...
Epoch: 13 cost time: 2.4589006900787354
Epoch: 13, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.927 Vali Acc: 0.661 Test Loss: 0.927 Test Acc: 0.661
Validation loss decreased (-0.661101 --> -0.661102).  Saving model ...
Epoch: 14 cost time: 2.4542272090911865
Epoch: 14, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.875 Vali Acc: 0.706 Test Loss: 0.875 Test Acc: 0.706
Validation loss decreased (-0.661102 --> -0.705547).  Saving model ...
Epoch: 15 cost time: 2.51245379447937
Epoch: 15, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.860 Vali Acc: 0.683 Test Loss: 0.860 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.431471109390259
Epoch: 16, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.803 Vali Acc: 0.744 Test Loss: 0.803 Test Acc: 0.744
Validation loss decreased (-0.705547 --> -0.744436).  Saving model ...
Epoch: 17 cost time: 2.4565939903259277
Epoch: 17, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.735 Vali Acc: 0.744 Test Loss: 0.735 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 18 cost time: 2.445228338241577
Epoch: 18, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.707 Vali Acc: 0.761 Test Loss: 0.707 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761104).  Saving model ...
Epoch: 19 cost time: 2.382455825805664
Epoch: 19, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.661 Vali Acc: 0.789 Test Loss: 0.661 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788882).  Saving model ...
Epoch: 20 cost time: 2.4071993827819824
Epoch: 20, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.661 Vali Acc: 0.778 Test Loss: 0.661 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.490393877029419
Epoch: 21, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.637 Vali Acc: 0.794 Test Loss: 0.637 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 22 cost time: 2.1190009117126465
Epoch: 22, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.631 Vali Acc: 0.800 Test Loss: 0.631 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 2.2852652072906494
Epoch: 23, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.621 Vali Acc: 0.794 Test Loss: 0.621 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2151503562927246
Epoch: 24, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.610 Vali Acc: 0.800 Test Loss: 0.610 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 25 cost time: 2.294984817504883
Epoch: 25, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.599 Vali Acc: 0.800 Test Loss: 0.599 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 26 cost time: 2.1706507205963135
Epoch: 26, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.822217).  Saving model ...
Epoch: 27 cost time: 2.2674155235290527
Epoch: 27, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.595 Vali Acc: 0.800 Test Loss: 0.595 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3537540435791016
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.554 Vali Acc: 0.811 Test Loss: 0.554 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.4637081623077393
Epoch: 29, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.663 Vali Acc: 0.778 Test Loss: 0.663 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.4185173511505127
Epoch: 30, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.580 Vali Acc: 0.806 Test Loss: 0.580 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 3538095
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.458081007003784
Epoch: 1, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.737 Vali Acc: 0.106 Test Loss: 2.737 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 1.8186852931976318
Epoch: 2, Steps: 12 | Train Loss: 2.597 Vali Loss: 2.571 Vali Acc: 0.172 Test Loss: 2.571 Test Acc: 0.172
Validation loss decreased (-0.105528 --> -0.172197).  Saving model ...
Epoch: 3 cost time: 1.835089921951294
Epoch: 3, Steps: 12 | Train Loss: 2.372 Vali Loss: 2.374 Vali Acc: 0.300 Test Loss: 2.374 Test Acc: 0.300
Validation loss decreased (-0.172197 --> -0.299976).  Saving model ...
Epoch: 4 cost time: 1.9244301319122314
Epoch: 4, Steps: 12 | Train Loss: 2.213 Vali Loss: 2.168 Vali Acc: 0.411 Test Loss: 2.168 Test Acc: 0.411
Validation loss decreased (-0.299976 --> -0.411089).  Saving model ...
Epoch: 5 cost time: 1.7878527641296387
Epoch: 5, Steps: 12 | Train Loss: 1.962 Vali Loss: 1.975 Vali Acc: 0.444 Test Loss: 1.975 Test Acc: 0.444
Validation loss decreased (-0.411089 --> -0.444425).  Saving model ...
Epoch: 6 cost time: 1.6713066101074219
Epoch: 6, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.802 Vali Acc: 0.472 Test Loss: 1.802 Test Acc: 0.472
Validation loss decreased (-0.444425 --> -0.472204).  Saving model ...
Epoch: 7 cost time: 1.758817434310913
Epoch: 7, Steps: 12 | Train Loss: 1.587 Vali Loss: 1.631 Vali Acc: 0.533 Test Loss: 1.631 Test Acc: 0.533
Validation loss decreased (-0.472204 --> -0.533317).  Saving model ...
Epoch: 8 cost time: 1.8696050643920898
Epoch: 8, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.494 Vali Acc: 0.556 Test Loss: 1.494 Test Acc: 0.556
Validation loss decreased (-0.533317 --> -0.555541).  Saving model ...
Epoch: 9 cost time: 1.8295965194702148
Epoch: 9, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.371 Vali Acc: 0.550 Test Loss: 1.371 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9569993019104004
Epoch: 10, Steps: 12 | Train Loss: 1.094 Vali Loss: 1.276 Vali Acc: 0.572 Test Loss: 1.276 Test Acc: 0.572
Validation loss decreased (-0.555541 --> -0.572209).  Saving model ...
Epoch: 11 cost time: 2.028114080429077
Epoch: 11, Steps: 12 | Train Loss: 0.958 Vali Loss: 1.181 Vali Acc: 0.611 Test Loss: 1.181 Test Acc: 0.611
Validation loss decreased (-0.572209 --> -0.611099).  Saving model ...
Epoch: 12 cost time: 1.9794280529022217
Epoch: 12, Steps: 12 | Train Loss: 0.869 Vali Loss: 1.106 Vali Acc: 0.606 Test Loss: 1.106 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.828674554824829
Epoch: 13, Steps: 12 | Train Loss: 0.789 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.849097490310669
Epoch: 14, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.976 Vali Acc: 0.650 Test Loss: 0.976 Test Acc: 0.650
Validation loss decreased (-0.611099 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 1.8684828281402588
Epoch: 15, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.919 Vali Acc: 0.650 Test Loss: 0.919 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 16 cost time: 1.9104413986206055
Epoch: 16, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.901 Vali Acc: 0.672 Test Loss: 0.901 Test Acc: 0.672
Validation loss decreased (-0.649991 --> -0.672213).  Saving model ...
Epoch: 17 cost time: 1.8365235328674316
Epoch: 17, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.861 Vali Acc: 0.683 Test Loss: 0.861 Test Acc: 0.683
Validation loss decreased (-0.672213 --> -0.683325).  Saving model ...
Epoch: 18 cost time: 1.9302141666412354
Epoch: 18, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.840 Vali Acc: 0.678 Test Loss: 0.840 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9659459590911865
Epoch: 19, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.803 Vali Acc: 0.722 Test Loss: 0.803 Test Acc: 0.722
Validation loss decreased (-0.683325 --> -0.722214).  Saving model ...
Epoch: 20 cost time: 2.0105855464935303
Epoch: 20, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.800 Vali Acc: 0.722 Test Loss: 0.800 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 21 cost time: 1.8761200904846191
Epoch: 21, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.755 Vali Acc: 0.733 Test Loss: 0.755 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733326).  Saving model ...
Epoch: 22 cost time: 1.852529764175415
Epoch: 22, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.747 Vali Acc: 0.744 Test Loss: 0.747 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744437).  Saving model ...
Epoch: 23 cost time: 1.8883306980133057
Epoch: 23, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.741 Vali Acc: 0.744 Test Loss: 0.741 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 24 cost time: 1.8293817043304443
Epoch: 24, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.772 Vali Acc: 0.717 Test Loss: 0.772 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9822425842285156
Epoch: 25, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.747 Vali Acc: 0.744 Test Loss: 0.747 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.08455491065979
Epoch: 26, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.752 Vali Acc: 0.733 Test Loss: 0.752 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.071787118911743
Epoch: 27, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.733 Vali Acc: 0.733 Test Loss: 0.733 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.017585039138794
Epoch: 28, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.738 Vali Acc: 0.756 Test Loss: 0.738 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 29 cost time: 1.901280164718628
Epoch: 29, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.756 Vali Acc: 0.728 Test Loss: 0.756 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9079992771148682
Epoch: 30, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.752 Vali Acc: 0.744 Test Loss: 0.752 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 1055343
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.349201917648315
Epoch: 1, Steps: 12 | Train Loss: 2.739 Vali Loss: 2.663 Vali Acc: 0.039 Test Loss: 2.663 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 3.540771722793579
Epoch: 2, Steps: 12 | Train Loss: 2.599 Vali Loss: 2.510 Vali Acc: 0.178 Test Loss: 2.510 Test Acc: 0.178
Validation loss decreased (-0.038862 --> -0.177753).  Saving model ...
Epoch: 3 cost time: 3.278822898864746
Epoch: 3, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.320 Vali Acc: 0.372 Test Loss: 2.320 Test Acc: 0.372
Validation loss decreased (-0.177753 --> -0.372199).  Saving model ...
Epoch: 4 cost time: 3.290696859359741
Epoch: 4, Steps: 12 | Train Loss: 2.167 Vali Loss: 2.098 Vali Acc: 0.467 Test Loss: 2.098 Test Acc: 0.467
Validation loss decreased (-0.372199 --> -0.466646).  Saving model ...
Epoch: 5 cost time: 3.281026601791382
Epoch: 5, Steps: 12 | Train Loss: 1.869 Vali Loss: 1.863 Vali Acc: 0.500 Test Loss: 1.863 Test Acc: 0.500
Validation loss decreased (-0.466646 --> -0.499981).  Saving model ...
Epoch: 6 cost time: 3.4668502807617188
Epoch: 6, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.637 Vali Acc: 0.528 Test Loss: 1.637 Test Acc: 0.528
Validation loss decreased (-0.499981 --> -0.527761).  Saving model ...
Epoch: 7 cost time: 3.5091781616210938
Epoch: 7, Steps: 12 | Train Loss: 1.363 Vali Loss: 1.446 Vali Acc: 0.572 Test Loss: 1.446 Test Acc: 0.572
Validation loss decreased (-0.527761 --> -0.572208).  Saving model ...
Epoch: 8 cost time: 3.3010289669036865
Epoch: 8, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.278 Vali Acc: 0.622 Test Loss: 1.278 Test Acc: 0.622
Validation loss decreased (-0.572208 --> -0.622209).  Saving model ...
Epoch: 9 cost time: 3.237004041671753
Epoch: 9, Steps: 12 | Train Loss: 0.990 Vali Loss: 1.149 Vali Acc: 0.639 Test Loss: 1.149 Test Acc: 0.639
Validation loss decreased (-0.622209 --> -0.638877).  Saving model ...
Epoch: 10 cost time: 3.37770414352417
Epoch: 10, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.035 Vali Acc: 0.656 Test Loss: 1.035 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655545).  Saving model ...
Epoch: 11 cost time: 3.3698275089263916
Epoch: 11, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.936 Vali Acc: 0.683 Test Loss: 0.936 Test Acc: 0.683
Validation loss decreased (-0.655545 --> -0.683324).  Saving model ...
Epoch: 12 cost time: 3.515481472015381
Epoch: 12, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.871 Vali Acc: 0.706 Test Loss: 0.871 Test Acc: 0.706
Validation loss decreased (-0.683324 --> -0.705547).  Saving model ...
Epoch: 13 cost time: 3.443779230117798
Epoch: 13, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.799 Vali Acc: 0.733 Test Loss: 0.799 Test Acc: 0.733
Validation loss decreased (-0.705547 --> -0.733325).  Saving model ...
Epoch: 14 cost time: 3.2466297149658203
Epoch: 14, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.736 Vali Acc: 0.756 Test Loss: 0.736 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755548).  Saving model ...
Epoch: 15 cost time: 3.3126301765441895
Epoch: 15, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.721 Vali Acc: 0.744 Test Loss: 0.721 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.307910442352295
Epoch: 16, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.676 Vali Acc: 0.750 Test Loss: 0.676 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.5271596908569336
Epoch: 17, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.646 Vali Acc: 0.772 Test Loss: 0.646 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772216).  Saving model ...
Epoch: 18 cost time: 3.4842190742492676
Epoch: 18, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.613 Vali Acc: 0.789 Test Loss: 0.613 Test Acc: 0.789
Validation loss decreased (-0.772216 --> -0.788883).  Saving model ...
Epoch: 19 cost time: 3.226405143737793
Epoch: 19, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.598 Vali Acc: 0.761 Test Loss: 0.598 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3239829540252686
Epoch: 20, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.621 Vali Acc: 0.761 Test Loss: 0.621 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.219423532485962
Epoch: 21, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.553 Vali Acc: 0.811 Test Loss: 0.553 Test Acc: 0.811
Validation loss decreased (-0.788883 --> -0.811106).  Saving model ...
Epoch: 22 cost time: 3.5254273414611816
Epoch: 22, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.566 Vali Acc: 0.806 Test Loss: 0.566 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4164414405822754
Epoch: 23, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.538 Vali Acc: 0.811 Test Loss: 0.538 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
Epoch: 24 cost time: 3.5228185653686523
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.528 Vali Acc: 0.811 Test Loss: 0.528 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
Epoch: 25 cost time: 3.246561050415039
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.537 Vali Acc: 0.806 Test Loss: 0.537 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2082583904266357
Epoch: 26, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.530 Vali Acc: 0.817 Test Loss: 0.530 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816661).  Saving model ...
Epoch: 27 cost time: 3.4188485145568848
Epoch: 27, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.519 Vali Acc: 0.817 Test Loss: 0.519 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816661).  Saving model ...
Epoch: 28 cost time: 3.2675721645355225
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 29 cost time: 3.2907464504241943
Epoch: 29, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.533 Vali Acc: 0.839 Test Loss: 0.533 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 30 cost time: 3.129922389984131
Epoch: 30, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.523 Vali Acc: 0.811 Test Loss: 0.523 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 1780335
model size : 7.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.233289003372192
Epoch: 1, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.785 Vali Acc: 0.050 Test Loss: 2.785 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 2.5654513835906982
Epoch: 2, Steps: 12 | Train Loss: 2.630 Vali Loss: 2.626 Vali Acc: 0.189 Test Loss: 2.626 Test Acc: 0.189
Validation loss decreased (-0.049972 --> -0.188863).  Saving model ...
Epoch: 3 cost time: 2.5314383506774902
Epoch: 3, Steps: 12 | Train Loss: 2.397 Vali Loss: 2.430 Vali Acc: 0.306 Test Loss: 2.430 Test Acc: 0.306
Validation loss decreased (-0.188863 --> -0.305531).  Saving model ...
Epoch: 4 cost time: 2.42679500579834
Epoch: 4, Steps: 12 | Train Loss: 2.229 Vali Loss: 2.215 Vali Acc: 0.417 Test Loss: 2.215 Test Acc: 0.417
Validation loss decreased (-0.305531 --> -0.416645).  Saving model ...
Epoch: 5 cost time: 2.3575599193573
Epoch: 5, Steps: 12 | Train Loss: 1.960 Vali Loss: 1.997 Vali Acc: 0.500 Test Loss: 1.997 Test Acc: 0.500
Validation loss decreased (-0.416645 --> -0.499980).  Saving model ...
Epoch: 6 cost time: 2.336268424987793
Epoch: 6, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.774 Vali Acc: 0.539 Test Loss: 1.774 Test Acc: 0.539
Validation loss decreased (-0.499980 --> -0.538871).  Saving model ...
Epoch: 7 cost time: 2.4993841648101807
Epoch: 7, Steps: 12 | Train Loss: 1.466 Vali Loss: 1.566 Vali Acc: 0.572 Test Loss: 1.566 Test Acc: 0.572
Validation loss decreased (-0.538871 --> -0.572207).  Saving model ...
Epoch: 8 cost time: 2.454148292541504
Epoch: 8, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.386 Vali Acc: 0.572 Test Loss: 1.386 Test Acc: 0.572
Validation loss decreased (-0.572207 --> -0.572208).  Saving model ...
Epoch: 9 cost time: 2.541609048843384
Epoch: 9, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.249 Vali Acc: 0.622 Test Loss: 1.249 Test Acc: 0.622
Validation loss decreased (-0.572208 --> -0.622210).  Saving model ...
Epoch: 10 cost time: 2.3074257373809814
Epoch: 10, Steps: 12 | Train Loss: 0.923 Vali Loss: 1.131 Vali Acc: 0.633 Test Loss: 1.131 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633322).  Saving model ...
Epoch: 11 cost time: 2.441197156906128
Epoch: 11, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.039 Vali Acc: 0.650 Test Loss: 1.039 Test Acc: 0.650
Validation loss decreased (-0.633322 --> -0.649990).  Saving model ...
Epoch: 12 cost time: 2.3311545848846436
Epoch: 12, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.961 Vali Acc: 0.661 Test Loss: 0.961 Test Acc: 0.661
Validation loss decreased (-0.649990 --> -0.661101).  Saving model ...
Epoch: 13 cost time: 2.638157606124878
Epoch: 13, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.905 Vali Acc: 0.700 Test Loss: 0.905 Test Acc: 0.700
Validation loss decreased (-0.661101 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 2.679744243621826
Epoch: 14, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.864 Vali Acc: 0.711 Test Loss: 0.864 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711102).  Saving model ...
Epoch: 15 cost time: 2.68465256690979
Epoch: 15, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.813 Vali Acc: 0.733 Test Loss: 0.813 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733325).  Saving model ...
Epoch: 16 cost time: 2.3770394325256348
Epoch: 16, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.784 Vali Acc: 0.722 Test Loss: 0.784 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3900837898254395
Epoch: 17, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.753 Vali Acc: 0.728 Test Loss: 0.753 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4323229789733887
Epoch: 18, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.715 Vali Acc: 0.733 Test Loss: 0.715 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733326).  Saving model ...
Epoch: 19 cost time: 2.433103561401367
Epoch: 19, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.693 Vali Acc: 0.744 Test Loss: 0.693 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744438).  Saving model ...
Epoch: 20 cost time: 2.5783121585845947
Epoch: 20, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.678 Vali Acc: 0.756 Test Loss: 0.678 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 21 cost time: 2.637681245803833
Epoch: 21, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.657 Vali Acc: 0.761 Test Loss: 0.657 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 22 cost time: 2.610182046890259
Epoch: 22, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.643 Vali Acc: 0.767 Test Loss: 0.643 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 23 cost time: 2.466522693634033
Epoch: 23, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.649 Vali Acc: 0.778 Test Loss: 0.649 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 24 cost time: 2.380683183670044
Epoch: 24, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.616 Vali Acc: 0.761 Test Loss: 0.616 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4883038997650146
Epoch: 25, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.628 Vali Acc: 0.778 Test Loss: 0.628 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 26 cost time: 2.5534446239471436
Epoch: 26, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.628 Vali Acc: 0.767 Test Loss: 0.628 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6455838680267334
Epoch: 27, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.613 Vali Acc: 0.800 Test Loss: 0.613 Test Acc: 0.800
Validation loss decreased (-0.777771 --> -0.799994).  Saving model ...
Epoch: 28 cost time: 2.594287633895874
Epoch: 28, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.608 Vali Acc: 0.794 Test Loss: 0.608 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.4566357135772705
Epoch: 29, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.5119078159332275
Epoch: 30, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 538863
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.688430547714233
Epoch: 1, Steps: 12 | Train Loss: 2.738 Vali Loss: 2.663 Vali Acc: 0.039 Test Loss: 2.663 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 2.823591709136963
Epoch: 2, Steps: 12 | Train Loss: 2.599 Vali Loss: 2.510 Vali Acc: 0.178 Test Loss: 2.510 Test Acc: 0.178
Validation loss decreased (-0.038862 --> -0.177753).  Saving model ...
Epoch: 3 cost time: 2.584237813949585
Epoch: 3, Steps: 12 | Train Loss: 2.404 Vali Loss: 2.319 Vali Acc: 0.372 Test Loss: 2.319 Test Acc: 0.372
Validation loss decreased (-0.177753 --> -0.372199).  Saving model ...
Epoch: 4 cost time: 2.6386733055114746
Epoch: 4, Steps: 12 | Train Loss: 2.169 Vali Loss: 2.097 Vali Acc: 0.461 Test Loss: 2.097 Test Acc: 0.461
Validation loss decreased (-0.372199 --> -0.461090).  Saving model ...
Epoch: 5 cost time: 2.6867222785949707
Epoch: 5, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.862 Vali Acc: 0.506 Test Loss: 1.862 Test Acc: 0.506
Validation loss decreased (-0.461090 --> -0.505537).  Saving model ...
Epoch: 6 cost time: 2.7147200107574463
Epoch: 6, Steps: 12 | Train Loss: 1.581 Vali Loss: 1.637 Vali Acc: 0.528 Test Loss: 1.637 Test Acc: 0.528
Validation loss decreased (-0.505537 --> -0.527761).  Saving model ...
Epoch: 7 cost time: 2.758178234100342
Epoch: 7, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.447 Vali Acc: 0.572 Test Loss: 1.447 Test Acc: 0.572
Validation loss decreased (-0.527761 --> -0.572208).  Saving model ...
Epoch: 8 cost time: 2.7977042198181152
Epoch: 8, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.282 Vali Acc: 0.628 Test Loss: 1.282 Test Acc: 0.628
Validation loss decreased (-0.572208 --> -0.627765).  Saving model ...
Epoch: 9 cost time: 2.8843040466308594
Epoch: 9, Steps: 12 | Train Loss: 0.998 Vali Loss: 1.156 Vali Acc: 0.644 Test Loss: 1.156 Test Acc: 0.644
Validation loss decreased (-0.627765 --> -0.644433).  Saving model ...
Epoch: 10 cost time: 2.643732786178589
Epoch: 10, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.043 Vali Acc: 0.661 Test Loss: 1.043 Test Acc: 0.661
Validation loss decreased (-0.644433 --> -0.661101).  Saving model ...
Epoch: 11 cost time: 2.7966861724853516
Epoch: 11, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.947 Vali Acc: 0.689 Test Loss: 0.947 Test Acc: 0.689
Validation loss decreased (-0.661101 --> -0.688879).  Saving model ...
Epoch: 12 cost time: 2.7187838554382324
Epoch: 12, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.884 Vali Acc: 0.678 Test Loss: 0.884 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.89190936088562
Epoch: 13, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.818 Vali Acc: 0.706 Test Loss: 0.818 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705547).  Saving model ...
Epoch: 14 cost time: 2.8385651111602783
Epoch: 14, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.755 Vali Acc: 0.728 Test Loss: 0.755 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727770).  Saving model ...
Epoch: 15 cost time: 2.9149580001831055
Epoch: 15, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.742 Vali Acc: 0.733 Test Loss: 0.742 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733326).  Saving model ...
Epoch: 16 cost time: 2.7541041374206543
Epoch: 16, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.699 Vali Acc: 0.744 Test Loss: 0.699 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744437).  Saving model ...
Epoch: 17 cost time: 2.687676429748535
Epoch: 17, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.665 Vali Acc: 0.756 Test Loss: 0.665 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755549).  Saving model ...
Epoch: 18 cost time: 2.814851999282837
Epoch: 18, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
Validation loss decreased (-0.755549 --> -0.783327).  Saving model ...
Epoch: 19 cost time: 2.7355527877807617
Epoch: 19, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.605 Vali Acc: 0.756 Test Loss: 0.605 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9953927993774414
Epoch: 20, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.635 Vali Acc: 0.772 Test Loss: 0.635 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.8495993614196777
Epoch: 21, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788883).  Saving model ...
Epoch: 22 cost time: 2.8537027835845947
Epoch: 22, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 2.7656891345977783
Epoch: 23, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.551 Vali Acc: 0.800 Test Loss: 0.551 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 24 cost time: 2.8456597328186035
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.532 Vali Acc: 0.800 Test Loss: 0.532 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 25 cost time: 2.7518551349639893
Epoch: 25, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.537 Vali Acc: 0.794 Test Loss: 0.537 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8699965476989746
Epoch: 26, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.532 Vali Acc: 0.811 Test Loss: 0.532 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811106).  Saving model ...
Epoch: 27 cost time: 3.0093350410461426
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.522 Vali Acc: 0.817 Test Loss: 0.522 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816661).  Saving model ...
Epoch: 28 cost time: 2.807753801345825
Epoch: 28, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.519 Vali Acc: 0.833 Test Loss: 0.519 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 29 cost time: 2.921814203262329
Epoch: 29, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.535 Vali Acc: 0.817 Test Loss: 0.535 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.748682975769043
Epoch: 30, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.528 Vali Acc: 0.800 Test Loss: 0.528 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 1780335
model size : 7.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8581011295318604
Epoch: 1, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.786 Vali Acc: 0.050 Test Loss: 2.786 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 2.1424574851989746
Epoch: 2, Steps: 12 | Train Loss: 2.630 Vali Loss: 2.626 Vali Acc: 0.189 Test Loss: 2.626 Test Acc: 0.189
Validation loss decreased (-0.049972 --> -0.188863).  Saving model ...
Epoch: 3 cost time: 2.119295358657837
Epoch: 3, Steps: 12 | Train Loss: 2.398 Vali Loss: 2.430 Vali Acc: 0.311 Test Loss: 2.430 Test Acc: 0.311
Validation loss decreased (-0.188863 --> -0.311087).  Saving model ...
Epoch: 4 cost time: 2.099252223968506
Epoch: 4, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.215 Vali Acc: 0.422 Test Loss: 2.215 Test Acc: 0.422
Validation loss decreased (-0.311087 --> -0.422200).  Saving model ...
Epoch: 5 cost time: 1.9915547370910645
Epoch: 5, Steps: 12 | Train Loss: 1.963 Vali Loss: 1.996 Vali Acc: 0.500 Test Loss: 1.996 Test Acc: 0.500
Validation loss decreased (-0.422200 --> -0.499980).  Saving model ...
Epoch: 6 cost time: 2.2429311275482178
Epoch: 6, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.772 Vali Acc: 0.539 Test Loss: 1.772 Test Acc: 0.539
Validation loss decreased (-0.499980 --> -0.538871).  Saving model ...
Epoch: 7 cost time: 2.27506422996521
Epoch: 7, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.565 Vali Acc: 0.572 Test Loss: 1.565 Test Acc: 0.572
Validation loss decreased (-0.538871 --> -0.572207).  Saving model ...
Epoch: 8 cost time: 2.239168882369995
Epoch: 8, Steps: 12 | Train Loss: 1.305 Vali Loss: 1.385 Vali Acc: 0.583 Test Loss: 1.385 Test Acc: 0.583
Validation loss decreased (-0.572207 --> -0.583319).  Saving model ...
Epoch: 9 cost time: 2.1017932891845703
Epoch: 9, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.248 Vali Acc: 0.617 Test Loss: 1.248 Test Acc: 0.617
Validation loss decreased (-0.583319 --> -0.616654).  Saving model ...
Epoch: 10 cost time: 2.097552537918091
Epoch: 10, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.132 Vali Acc: 0.633 Test Loss: 1.132 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633322).  Saving model ...
Epoch: 11 cost time: 2.182952880859375
Epoch: 11, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.041 Vali Acc: 0.661 Test Loss: 1.041 Test Acc: 0.661
Validation loss decreased (-0.633322 --> -0.661101).  Saving model ...
Epoch: 12 cost time: 2.2216861248016357
Epoch: 12, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.961 Vali Acc: 0.672 Test Loss: 0.961 Test Acc: 0.672
Validation loss decreased (-0.661101 --> -0.672213).  Saving model ...
Epoch: 13 cost time: 2.2575182914733887
Epoch: 13, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.907 Vali Acc: 0.694 Test Loss: 0.907 Test Acc: 0.694
Validation loss decreased (-0.672213 --> -0.694435).  Saving model ...
Epoch: 14 cost time: 2.2237296104431152
Epoch: 14, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.866 Vali Acc: 0.711 Test Loss: 0.866 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 15 cost time: 2.266364574432373
Epoch: 15, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.812 Vali Acc: 0.728 Test Loss: 0.812 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727770).  Saving model ...
Epoch: 16 cost time: 2.185392379760742
Epoch: 16, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.788 Vali Acc: 0.717 Test Loss: 0.788 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1002886295318604
Epoch: 17, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.758 Vali Acc: 0.739 Test Loss: 0.758 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738881).  Saving model ...
Epoch: 18 cost time: 2.1039986610412598
Epoch: 18, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.719 Vali Acc: 0.733 Test Loss: 0.719 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.441033124923706
Epoch: 19, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.696 Vali Acc: 0.750 Test Loss: 0.696 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749993).  Saving model ...
Epoch: 20 cost time: 2.323547840118408
Epoch: 20, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.681 Vali Acc: 0.744 Test Loss: 0.681 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4394733905792236
Epoch: 21, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.650 Vali Acc: 0.778 Test Loss: 0.650 Test Acc: 0.778
Validation loss decreased (-0.749993 --> -0.777771).  Saving model ...
Epoch: 22 cost time: 2.334554672241211
Epoch: 22, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.638 Vali Acc: 0.772 Test Loss: 0.638 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3322067260742188
Epoch: 23, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.643 Vali Acc: 0.789 Test Loss: 0.643 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 24 cost time: 2.3640620708465576
Epoch: 24, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.601 Vali Acc: 0.794 Test Loss: 0.601 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 25 cost time: 2.3155462741851807
Epoch: 25, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.467754364013672
Epoch: 26, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.622 Vali Acc: 0.783 Test Loss: 0.622 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.5017926692962646
Epoch: 27, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.599 Vali Acc: 0.811 Test Loss: 0.599 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 28 cost time: 2.4008431434631348
Epoch: 28, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.605 Vali Acc: 0.800 Test Loss: 0.605 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2724099159240723
Epoch: 29, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.617 Vali Acc: 0.783 Test Loss: 0.617 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.2830822467803955
Epoch: 30, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.592 Vali Acc: 0.817 Test Loss: 0.592 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 538863
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.022084712982178
Epoch: 1, Steps: 12 | Train Loss: 2.740 Vali Loss: 2.672 Vali Acc: 0.033 Test Loss: 2.672 Test Acc: 0.033
Validation loss decreased (inf --> -0.033307).  Saving model ...
Epoch: 2 cost time: 2.0682172775268555
Epoch: 2, Steps: 12 | Train Loss: 2.621 Vali Loss: 2.542 Vali Acc: 0.133 Test Loss: 2.542 Test Acc: 0.133
Validation loss decreased (-0.033307 --> -0.133308).  Saving model ...
Epoch: 3 cost time: 1.9650194644927979
Epoch: 3, Steps: 12 | Train Loss: 2.454 Vali Loss: 2.385 Vali Acc: 0.350 Test Loss: 2.385 Test Acc: 0.350
Validation loss decreased (-0.133308 --> -0.349976).  Saving model ...
Epoch: 4 cost time: 1.939809799194336
Epoch: 4, Steps: 12 | Train Loss: 2.251 Vali Loss: 2.209 Vali Acc: 0.439 Test Loss: 2.209 Test Acc: 0.439
Validation loss decreased (-0.349976 --> -0.438867).  Saving model ...
Epoch: 5 cost time: 2.0682590007781982
Epoch: 5, Steps: 12 | Train Loss: 2.005 Vali Loss: 2.024 Vali Acc: 0.472 Test Loss: 2.024 Test Acc: 0.472
Validation loss decreased (-0.438867 --> -0.472202).  Saving model ...
Epoch: 6 cost time: 2.0120460987091064
Epoch: 6, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.834 Vali Acc: 0.506 Test Loss: 1.834 Test Acc: 0.506
Validation loss decreased (-0.472202 --> -0.505537).  Saving model ...
Epoch: 7 cost time: 1.9205169677734375
Epoch: 7, Steps: 12 | Train Loss: 1.626 Vali Loss: 1.656 Vali Acc: 0.522 Test Loss: 1.656 Test Acc: 0.522
Validation loss decreased (-0.505537 --> -0.522206).  Saving model ...
Epoch: 8 cost time: 2.0367703437805176
Epoch: 8, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.499 Vali Acc: 0.572 Test Loss: 1.499 Test Acc: 0.572
Validation loss decreased (-0.522206 --> -0.572207).  Saving model ...
Epoch: 9 cost time: 2.051837205886841
Epoch: 9, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.370 Vali Acc: 0.567 Test Loss: 1.370 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.108628034591675
Epoch: 10, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.258 Vali Acc: 0.600 Test Loss: 1.258 Test Acc: 0.600
Validation loss decreased (-0.572207 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 1.9666557312011719
Epoch: 11, Steps: 12 | Train Loss: 0.952 Vali Loss: 1.158 Vali Acc: 0.628 Test Loss: 1.158 Test Acc: 0.628
Validation loss decreased (-0.599987 --> -0.627766).  Saving model ...
Epoch: 12 cost time: 2.0202386379241943
Epoch: 12, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.075 Vali Acc: 0.639 Test Loss: 1.075 Test Acc: 0.639
Validation loss decreased (-0.627766 --> -0.638878).  Saving model ...
Epoch: 13 cost time: 1.9517204761505127
Epoch: 13, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.993 Vali Acc: 0.639 Test Loss: 0.993 Test Acc: 0.639
Validation loss decreased (-0.638878 --> -0.638879).  Saving model ...
Epoch: 14 cost time: 1.9211394786834717
Epoch: 14, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.911 Vali Acc: 0.672 Test Loss: 0.911 Test Acc: 0.672
Validation loss decreased (-0.638879 --> -0.672213).  Saving model ...
Epoch: 15 cost time: 1.8846876621246338
Epoch: 15, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.864 Vali Acc: 0.694 Test Loss: 0.864 Test Acc: 0.694
Validation loss decreased (-0.672213 --> -0.694436).  Saving model ...
Epoch: 16 cost time: 2.046870231628418
Epoch: 16, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.818 Vali Acc: 0.728 Test Loss: 0.818 Test Acc: 0.728
Validation loss decreased (-0.694436 --> -0.727770).  Saving model ...
Epoch: 17 cost time: 1.8980138301849365
Epoch: 17, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.781 Vali Acc: 0.711 Test Loss: 0.781 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8607070446014404
Epoch: 18, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.744 Vali Acc: 0.722 Test Loss: 0.744 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.888061761856079
Epoch: 19, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.729 Vali Acc: 0.717 Test Loss: 0.729 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.112504482269287
Epoch: 20, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.707 Vali Acc: 0.761 Test Loss: 0.707 Test Acc: 0.761
Validation loss decreased (-0.727770 --> -0.761104).  Saving model ...
Epoch: 21 cost time: 2.004467010498047
Epoch: 21, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.671 Vali Acc: 0.739 Test Loss: 0.671 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0515453815460205
Epoch: 22, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.652 Vali Acc: 0.767 Test Loss: 0.652 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 23 cost time: 2.020357608795166
Epoch: 23, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783327).  Saving model ...
Epoch: 24 cost time: 2.1640419960021973
Epoch: 24, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.608 Vali Acc: 0.794 Test Loss: 0.608 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794438).  Saving model ...
Epoch: 25 cost time: 1.9934074878692627
Epoch: 25, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.606 Vali Acc: 0.800 Test Loss: 0.606 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 26 cost time: 2.05084490776062
Epoch: 26, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.613 Vali Acc: 0.806 Test Loss: 0.613 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805549).  Saving model ...
Epoch: 27 cost time: 2.097510814666748
Epoch: 27, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.636 Vali Acc: 0.783 Test Loss: 0.636 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.060795783996582
Epoch: 28, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.578 Vali Acc: 0.806 Test Loss: 0.578 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805550).  Saving model ...
Epoch: 29 cost time: 2.1265292167663574
Epoch: 29, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.600 Vali Acc: 0.789 Test Loss: 0.600 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0159950256347656
Epoch: 30, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.600 Vali Acc: 0.806 Test Loss: 0.600 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 1780335
model size : 7.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4863715171813965
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.793 Vali Acc: 0.050 Test Loss: 2.793 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 1.6926336288452148
Epoch: 2, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.657 Vali Acc: 0.161 Test Loss: 2.657 Test Acc: 0.161
Validation loss decreased (-0.049972 --> -0.161085).  Saving model ...
Epoch: 3 cost time: 1.7417898178100586
Epoch: 3, Steps: 12 | Train Loss: 2.437 Vali Loss: 2.489 Vali Acc: 0.261 Test Loss: 2.489 Test Acc: 0.261
Validation loss decreased (-0.161085 --> -0.261086).  Saving model ...
Epoch: 4 cost time: 1.6789467334747314
Epoch: 4, Steps: 12 | Train Loss: 2.311 Vali Loss: 2.311 Vali Acc: 0.350 Test Loss: 2.311 Test Acc: 0.350
Validation loss decreased (-0.261086 --> -0.349977).  Saving model ...
Epoch: 5 cost time: 1.8478569984436035
Epoch: 5, Steps: 12 | Train Loss: 2.071 Vali Loss: 2.138 Vali Acc: 0.456 Test Loss: 2.138 Test Acc: 0.456
Validation loss decreased (-0.349977 --> -0.455534).  Saving model ...
Epoch: 6 cost time: 1.8130114078521729
Epoch: 6, Steps: 12 | Train Loss: 1.885 Vali Loss: 1.958 Vali Acc: 0.489 Test Loss: 1.958 Test Acc: 0.489
Validation loss decreased (-0.455534 --> -0.488869).  Saving model ...
Epoch: 7 cost time: 1.7760896682739258
Epoch: 7, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.790 Vali Acc: 0.544 Test Loss: 1.790 Test Acc: 0.544
Validation loss decreased (-0.488869 --> -0.544427).  Saving model ...
Epoch: 8 cost time: 1.8086822032928467
Epoch: 8, Steps: 12 | Train Loss: 1.542 Vali Loss: 1.612 Vali Acc: 0.528 Test Loss: 1.612 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8736908435821533
Epoch: 9, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.464 Vali Acc: 0.556 Test Loss: 1.464 Test Acc: 0.556
Validation loss decreased (-0.544427 --> -0.555541).  Saving model ...
Epoch: 10 cost time: 1.7449066638946533
Epoch: 10, Steps: 12 | Train Loss: 1.175 Vali Loss: 1.342 Vali Acc: 0.578 Test Loss: 1.342 Test Acc: 0.578
Validation loss decreased (-0.555541 --> -0.577764).  Saving model ...
Epoch: 11 cost time: 1.6901915073394775
Epoch: 11, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.239 Vali Acc: 0.600 Test Loss: 1.239 Test Acc: 0.600
Validation loss decreased (-0.577764 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 1.904723882675171
Epoch: 12, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.149 Vali Acc: 0.617 Test Loss: 1.149 Test Acc: 0.617
Validation loss decreased (-0.599988 --> -0.616655).  Saving model ...
Epoch: 13 cost time: 1.912034273147583
Epoch: 13, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.083 Vali Acc: 0.644 Test Loss: 1.083 Test Acc: 0.644
Validation loss decreased (-0.616655 --> -0.644434).  Saving model ...
Epoch: 14 cost time: 1.8112096786499023
Epoch: 14, Steps: 12 | Train Loss: 0.788 Vali Loss: 1.025 Vali Acc: 0.672 Test Loss: 1.025 Test Acc: 0.672
Validation loss decreased (-0.644434 --> -0.672212).  Saving model ...
Epoch: 15 cost time: 1.7201151847839355
Epoch: 15, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.939 Vali Acc: 0.700 Test Loss: 0.939 Test Acc: 0.700
Validation loss decreased (-0.672212 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 1.7498540878295898
Epoch: 16, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.893 Vali Acc: 0.706 Test Loss: 0.893 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705547).  Saving model ...
Epoch: 17 cost time: 1.707890272140503
Epoch: 17, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.861 Vali Acc: 0.700 Test Loss: 0.861 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7903413772583008
Epoch: 18, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.815 Vali Acc: 0.706 Test Loss: 0.815 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 19 cost time: 1.835190773010254
Epoch: 19, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.787 Vali Acc: 0.717 Test Loss: 0.787 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716659).  Saving model ...
Epoch: 20 cost time: 1.71828293800354
Epoch: 20, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.769 Vali Acc: 0.717 Test Loss: 0.769 Test Acc: 0.717
Validation loss decreased (-0.716659 --> -0.716659).  Saving model ...
Epoch: 21 cost time: 1.7061944007873535
Epoch: 21, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.734 Vali Acc: 0.733 Test Loss: 0.734 Test Acc: 0.733
Validation loss decreased (-0.716659 --> -0.733326).  Saving model ...
Epoch: 22 cost time: 1.829993486404419
Epoch: 22, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.715 Vali Acc: 0.739 Test Loss: 0.715 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 23 cost time: 1.7156786918640137
Epoch: 23, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.713 Vali Acc: 0.778 Test Loss: 0.713 Test Acc: 0.778
Validation loss decreased (-0.738882 --> -0.777771).  Saving model ...
Epoch: 24 cost time: 1.8613049983978271
Epoch: 24, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.684 Vali Acc: 0.767 Test Loss: 0.684 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.882638931274414
Epoch: 25, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.689 Vali Acc: 0.767 Test Loss: 0.689 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8496713638305664
Epoch: 26, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.687 Vali Acc: 0.772 Test Loss: 0.687 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6917245388031006
Epoch: 27, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.663 Vali Acc: 0.794 Test Loss: 0.663 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794438).  Saving model ...
Epoch: 28 cost time: 1.7608513832092285
Epoch: 28, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.668 Vali Acc: 0.783 Test Loss: 0.668 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.691493272781372
Epoch: 29, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.687 Vali Acc: 0.789 Test Loss: 0.687 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.796415090560913
Epoch: 30, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.651 Vali Acc: 0.800 Test Loss: 0.651 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 538863
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.07342529296875
Epoch: 1, Steps: 12 | Train Loss: 2.774 Vali Loss: 2.678 Vali Acc: 0.061 Test Loss: 2.678 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 3.163647174835205
Epoch: 2, Steps: 12 | Train Loss: 2.674 Vali Loss: 2.564 Vali Acc: 0.128 Test Loss: 2.564 Test Acc: 0.128
Validation loss decreased (-0.061084 --> -0.127752).  Saving model ...
Epoch: 3 cost time: 3.4119389057159424
Epoch: 3, Steps: 12 | Train Loss: 2.542 Vali Loss: 2.421 Vali Acc: 0.261 Test Loss: 2.421 Test Acc: 0.261
Validation loss decreased (-0.127752 --> -0.261087).  Saving model ...
Epoch: 4 cost time: 3.4151451587677
Epoch: 4, Steps: 12 | Train Loss: 2.392 Vali Loss: 2.245 Vali Acc: 0.422 Test Loss: 2.245 Test Acc: 0.422
Validation loss decreased (-0.261087 --> -0.422200).  Saving model ...
Epoch: 5 cost time: 3.3394174575805664
Epoch: 5, Steps: 12 | Train Loss: 2.148 Vali Loss: 2.062 Vali Acc: 0.450 Test Loss: 2.062 Test Acc: 0.450
Validation loss decreased (-0.422200 --> -0.449979).  Saving model ...
Epoch: 6 cost time: 3.296353816986084
Epoch: 6, Steps: 12 | Train Loss: 1.966 Vali Loss: 1.870 Vali Acc: 0.461 Test Loss: 1.870 Test Acc: 0.461
Validation loss decreased (-0.449979 --> -0.461092).  Saving model ...
Epoch: 7 cost time: 3.3775296211242676
Epoch: 7, Steps: 12 | Train Loss: 1.728 Vali Loss: 1.701 Vali Acc: 0.494 Test Loss: 1.701 Test Acc: 0.494
Validation loss decreased (-0.461092 --> -0.494427).  Saving model ...
Epoch: 8 cost time: 3.4084572792053223
Epoch: 8, Steps: 12 | Train Loss: 1.540 Vali Loss: 1.544 Vali Acc: 0.550 Test Loss: 1.544 Test Acc: 0.550
Validation loss decreased (-0.494427 --> -0.549985).  Saving model ...
Epoch: 9 cost time: 3.296426296234131
Epoch: 9, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.400 Vali Acc: 0.589 Test Loss: 1.400 Test Acc: 0.589
Validation loss decreased (-0.549985 --> -0.588875).  Saving model ...
Epoch: 10 cost time: 3.311973810195923
Epoch: 10, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.287 Vali Acc: 0.639 Test Loss: 1.287 Test Acc: 0.639
Validation loss decreased (-0.588875 --> -0.638876).  Saving model ...
Epoch: 11 cost time: 3.356093168258667
Epoch: 11, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.200 Vali Acc: 0.628 Test Loss: 1.200 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.48116397857666
Epoch: 12, Steps: 12 | Train Loss: 0.969 Vali Loss: 1.111 Vali Acc: 0.656 Test Loss: 1.111 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655544).  Saving model ...
Epoch: 13 cost time: 3.416792869567871
Epoch: 13, Steps: 12 | Train Loss: 0.899 Vali Loss: 1.046 Vali Acc: 0.667 Test Loss: 1.046 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 14 cost time: 3.3030617237091064
Epoch: 14, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.996 Vali Acc: 0.628 Test Loss: 0.996 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2960801124572754
Epoch: 15, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.959 Vali Acc: 0.667 Test Loss: 0.959 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 16 cost time: 3.451273202896118
Epoch: 16, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.903 Vali Acc: 0.678 Test Loss: 0.903 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677769).  Saving model ...
Epoch: 17 cost time: 3.446367025375366
Epoch: 17, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.874 Vali Acc: 0.694 Test Loss: 0.874 Test Acc: 0.694
Validation loss decreased (-0.677769 --> -0.694436).  Saving model ...
Epoch: 18 cost time: 3.264766216278076
Epoch: 18, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.840 Vali Acc: 0.700 Test Loss: 0.840 Test Acc: 0.700
Validation loss decreased (-0.694436 --> -0.699992).  Saving model ...
Epoch: 19 cost time: 3.2438886165618896
Epoch: 19, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.795 Vali Acc: 0.733 Test Loss: 0.795 Test Acc: 0.733
Validation loss decreased (-0.699992 --> -0.733325).  Saving model ...
Epoch: 20 cost time: 3.9835307598114014
Epoch: 20, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.765 Vali Acc: 0.733 Test Loss: 0.765 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733326).  Saving model ...
Epoch: 21 cost time: 4.203834056854248
Epoch: 21, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.754 Vali Acc: 0.728 Test Loss: 0.754 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.1356401443481445
Epoch: 22, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.747 Vali Acc: 0.711 Test Loss: 0.747 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.967392683029175
Epoch: 23, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.699 Vali Acc: 0.744 Test Loss: 0.699 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744437).  Saving model ...
Epoch: 24 cost time: 3.796064853668213
Epoch: 24, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.716 Vali Acc: 0.739 Test Loss: 0.716 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.019556760787964
Epoch: 25, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.723 Vali Acc: 0.739 Test Loss: 0.723 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.006568670272827
Epoch: 26, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.706 Vali Acc: 0.744 Test Loss: 0.706 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.8514487743377686
Epoch: 27, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.684 Vali Acc: 0.739 Test Loss: 0.684 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.922541618347168
Epoch: 28, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.669 Vali Acc: 0.756 Test Loss: 0.669 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755549).  Saving model ...
Epoch: 29 cost time: 3.961533546447754
Epoch: 29, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.678 Vali Acc: 0.733 Test Loss: 0.678 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.101551055908203
Epoch: 30, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.674 Vali Acc: 0.750 Test Loss: 0.674 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 1769631
model size : 7.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.771639108657837
Epoch: 1, Steps: 12 | Train Loss: 2.728 Vali Loss: 2.611 Vali Acc: 0.133 Test Loss: 2.611 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 2.8540279865264893
Epoch: 2, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.515 Vali Acc: 0.244 Test Loss: 2.515 Test Acc: 0.244
Validation loss decreased (-0.133307 --> -0.244419).  Saving model ...
Epoch: 3 cost time: 2.925172805786133
Epoch: 3, Steps: 12 | Train Loss: 2.495 Vali Loss: 2.392 Vali Acc: 0.356 Test Loss: 2.392 Test Acc: 0.356
Validation loss decreased (-0.244419 --> -0.355532).  Saving model ...
Epoch: 4 cost time: 2.4218356609344482
Epoch: 4, Steps: 12 | Train Loss: 2.334 Vali Loss: 2.252 Vali Acc: 0.389 Test Loss: 2.252 Test Acc: 0.389
Validation loss decreased (-0.355532 --> -0.388866).  Saving model ...
Epoch: 5 cost time: 2.9210894107818604
Epoch: 5, Steps: 12 | Train Loss: 2.187 Vali Loss: 2.102 Vali Acc: 0.467 Test Loss: 2.102 Test Acc: 0.467
Validation loss decreased (-0.388866 --> -0.466646).  Saving model ...
Epoch: 6 cost time: 2.9166908264160156
Epoch: 6, Steps: 12 | Train Loss: 1.971 Vali Loss: 1.942 Vali Acc: 0.489 Test Loss: 1.942 Test Acc: 0.489
Validation loss decreased (-0.466646 --> -0.488869).  Saving model ...
Epoch: 7 cost time: 2.8807432651519775
Epoch: 7, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.783 Vali Acc: 0.522 Test Loss: 1.783 Test Acc: 0.522
Validation loss decreased (-0.488869 --> -0.522204).  Saving model ...
Epoch: 8 cost time: 2.9998135566711426
Epoch: 8, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.639 Vali Acc: 0.506 Test Loss: 1.639 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.912604331970215
Epoch: 9, Steps: 12 | Train Loss: 1.450 Vali Loss: 1.508 Vali Acc: 0.517 Test Loss: 1.508 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8922882080078125
Epoch: 10, Steps: 12 | Train Loss: 1.274 Vali Loss: 1.397 Vali Acc: 0.550 Test Loss: 1.397 Test Acc: 0.550
Validation loss decreased (-0.522204 --> -0.549986).  Saving model ...
Epoch: 11 cost time: 2.8345885276794434
Epoch: 11, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.305 Vali Acc: 0.583 Test Loss: 1.305 Test Acc: 0.583
Validation loss decreased (-0.549986 --> -0.583320).  Saving model ...
Epoch: 12 cost time: 2.9282214641571045
Epoch: 12, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.237 Vali Acc: 0.606 Test Loss: 1.237 Test Acc: 0.606
Validation loss decreased (-0.583320 --> -0.605543).  Saving model ...
Epoch: 13 cost time: 2.887301206588745
Epoch: 13, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.151 Vali Acc: 0.622 Test Loss: 1.151 Test Acc: 0.622
Validation loss decreased (-0.605543 --> -0.622211).  Saving model ...
Epoch: 14 cost time: 2.8091020584106445
Epoch: 14, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.090 Vali Acc: 0.628 Test Loss: 1.090 Test Acc: 0.628
Validation loss decreased (-0.622211 --> -0.627767).  Saving model ...
Epoch: 15 cost time: 3.0268921852111816
Epoch: 15, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.038 Vali Acc: 0.628 Test Loss: 1.038 Test Acc: 0.628
Validation loss decreased (-0.627767 --> -0.627767).  Saving model ...
Epoch: 16 cost time: 2.88891339302063
Epoch: 16, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.998 Vali Acc: 0.622 Test Loss: 0.998 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9887807369232178
Epoch: 17, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.954 Vali Acc: 0.683 Test Loss: 0.954 Test Acc: 0.683
Validation loss decreased (-0.627767 --> -0.683324).  Saving model ...
Epoch: 18 cost time: 2.885327100753784
Epoch: 18, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.918 Vali Acc: 0.661 Test Loss: 0.918 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.956913709640503
Epoch: 19, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.872 Vali Acc: 0.706 Test Loss: 0.872 Test Acc: 0.706
Validation loss decreased (-0.683324 --> -0.705547).  Saving model ...
Epoch: 20 cost time: 2.9930672645568848
Epoch: 20, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.824 Vali Acc: 0.689 Test Loss: 0.824 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9045350551605225
Epoch: 21, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.813 Vali Acc: 0.689 Test Loss: 0.813 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.692220687866211
Epoch: 22, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.768 Vali Acc: 0.722 Test Loss: 0.768 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722215).  Saving model ...
Epoch: 23 cost time: 2.583488702774048
Epoch: 23, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.766 Vali Acc: 0.711 Test Loss: 0.766 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7748947143554688
Epoch: 24, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.732 Vali Acc: 0.733 Test Loss: 0.732 Test Acc: 0.733
Validation loss decreased (-0.722215 --> -0.733326).  Saving model ...
Epoch: 25 cost time: 2.9159884452819824
Epoch: 25, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.695 Vali Acc: 0.739 Test Loss: 0.695 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 26 cost time: 2.88183331489563
Epoch: 26, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.703 Vali Acc: 0.744 Test Loss: 0.703 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744437).  Saving model ...
Epoch: 27 cost time: 2.7945635318756104
Epoch: 27, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.695 Vali Acc: 0.756 Test Loss: 0.695 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755549).  Saving model ...
Epoch: 28 cost time: 2.7147648334503174
Epoch: 28, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.682 Vali Acc: 0.767 Test Loss: 0.682 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 29 cost time: 2.6320066452026367
Epoch: 29, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.663 Vali Acc: 0.750 Test Loss: 0.663 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.787942409515381
Epoch: 30, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.658 Vali Acc: 0.767 Test Loss: 0.658 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 528063
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.054434061050415
Epoch: 1, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.678 Vali Acc: 0.061 Test Loss: 2.678 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 3.150390148162842
Epoch: 2, Steps: 12 | Train Loss: 2.674 Vali Loss: 2.564 Vali Acc: 0.128 Test Loss: 2.564 Test Acc: 0.128
Validation loss decreased (-0.061084 --> -0.127752).  Saving model ...
Epoch: 3 cost time: 3.247788190841675
Epoch: 3, Steps: 12 | Train Loss: 2.541 Vali Loss: 2.419 Vali Acc: 0.267 Test Loss: 2.419 Test Acc: 0.267
Validation loss decreased (-0.127752 --> -0.266642).  Saving model ...
Epoch: 4 cost time: 3.34424090385437
Epoch: 4, Steps: 12 | Train Loss: 2.392 Vali Loss: 2.242 Vali Acc: 0.422 Test Loss: 2.242 Test Acc: 0.422
Validation loss decreased (-0.266642 --> -0.422200).  Saving model ...
Epoch: 5 cost time: 3.2930796146392822
Epoch: 5, Steps: 12 | Train Loss: 2.146 Vali Loss: 2.056 Vali Acc: 0.444 Test Loss: 2.056 Test Acc: 0.444
Validation loss decreased (-0.422200 --> -0.444424).  Saving model ...
Epoch: 6 cost time: 3.140181541442871
Epoch: 6, Steps: 12 | Train Loss: 1.964 Vali Loss: 1.864 Vali Acc: 0.461 Test Loss: 1.864 Test Acc: 0.461
Validation loss decreased (-0.444424 --> -0.461092).  Saving model ...
Epoch: 7 cost time: 3.1468214988708496
Epoch: 7, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.695 Vali Acc: 0.489 Test Loss: 1.695 Test Acc: 0.489
Validation loss decreased (-0.461092 --> -0.488872).  Saving model ...
Epoch: 8 cost time: 3.2415337562561035
Epoch: 8, Steps: 12 | Train Loss: 1.542 Vali Loss: 1.537 Vali Acc: 0.539 Test Loss: 1.537 Test Acc: 0.539
Validation loss decreased (-0.488872 --> -0.538874).  Saving model ...
Epoch: 9 cost time: 3.4581382274627686
Epoch: 9, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.393 Vali Acc: 0.594 Test Loss: 1.393 Test Acc: 0.594
Validation loss decreased (-0.538874 --> -0.594431).  Saving model ...
Epoch: 10 cost time: 3.4433350563049316
Epoch: 10, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.282 Vali Acc: 0.628 Test Loss: 1.282 Test Acc: 0.628
Validation loss decreased (-0.594431 --> -0.627765).  Saving model ...
Epoch: 11 cost time: 3.490241527557373
Epoch: 11, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.193 Vali Acc: 0.611 Test Loss: 1.193 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4582619667053223
Epoch: 12, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.106 Vali Acc: 0.650 Test Loss: 1.106 Test Acc: 0.650
Validation loss decreased (-0.627765 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 3.44637131690979
Epoch: 13, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.038 Vali Acc: 0.661 Test Loss: 1.038 Test Acc: 0.661
Validation loss decreased (-0.649989 --> -0.661101).  Saving model ...
Epoch: 14 cost time: 3.5553696155548096
Epoch: 14, Steps: 12 | Train Loss: 0.820 Vali Loss: 0.988 Vali Acc: 0.633 Test Loss: 0.988 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5108799934387207
Epoch: 15, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.948 Vali Acc: 0.678 Test Loss: 0.948 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677768).  Saving model ...
Epoch: 16 cost time: 3.3293890953063965
Epoch: 16, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.897 Vali Acc: 0.672 Test Loss: 0.897 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4453885555267334
Epoch: 17, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.871 Vali Acc: 0.683 Test Loss: 0.871 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683325).  Saving model ...
Epoch: 18 cost time: 3.455127000808716
Epoch: 18, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.834 Vali Acc: 0.683 Test Loss: 0.834 Test Acc: 0.683
Validation loss decreased (-0.683325 --> -0.683325).  Saving model ...
Epoch: 19 cost time: 3.6330835819244385
Epoch: 19, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.793 Vali Acc: 0.728 Test Loss: 0.793 Test Acc: 0.728
Validation loss decreased (-0.683325 --> -0.727770).  Saving model ...
Epoch: 20 cost time: 3.6434249877929688
Epoch: 20, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.745 Vali Acc: 0.744 Test Loss: 0.745 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744437).  Saving model ...
Epoch: 21 cost time: 3.496713876724243
Epoch: 21, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.738 Vali Acc: 0.717 Test Loss: 0.738 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.497828722000122
Epoch: 22, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.728 Vali Acc: 0.717 Test Loss: 0.728 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.42331600189209
Epoch: 23, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.670 Vali Acc: 0.744 Test Loss: 0.670 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744438).  Saving model ...
Epoch: 24 cost time: 3.5778419971466064
Epoch: 24, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.707 Vali Acc: 0.728 Test Loss: 0.707 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4944348335266113
Epoch: 25, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.744 Vali Acc: 0.717 Test Loss: 0.744 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.343857765197754
Epoch: 26, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.703 Vali Acc: 0.739 Test Loss: 0.703 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.338995933532715
Epoch: 27, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.662 Vali Acc: 0.750 Test Loss: 0.662 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749993).  Saving model ...
Epoch: 28 cost time: 3.5664050579071045
Epoch: 28, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.657 Vali Acc: 0.733 Test Loss: 0.657 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.6100964546203613
Epoch: 29, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 30 cost time: 3.6310513019561768
Epoch: 30, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.639 Vali Acc: 0.767 Test Loss: 0.639 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 1769631
model size : 7.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.5291101932525635
Epoch: 1, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.612 Vali Acc: 0.133 Test Loss: 2.612 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 2.835571527481079
Epoch: 2, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.516 Vali Acc: 0.244 Test Loss: 2.516 Test Acc: 0.244
Validation loss decreased (-0.133307 --> -0.244419).  Saving model ...
Epoch: 3 cost time: 2.878941059112549
Epoch: 3, Steps: 12 | Train Loss: 2.495 Vali Loss: 2.392 Vali Acc: 0.356 Test Loss: 2.392 Test Acc: 0.356
Validation loss decreased (-0.244419 --> -0.355532).  Saving model ...
Epoch: 4 cost time: 2.7999520301818848
Epoch: 4, Steps: 12 | Train Loss: 2.334 Vali Loss: 2.252 Vali Acc: 0.394 Test Loss: 2.252 Test Acc: 0.394
Validation loss decreased (-0.355532 --> -0.394422).  Saving model ...
Epoch: 5 cost time: 2.79441499710083
Epoch: 5, Steps: 12 | Train Loss: 2.188 Vali Loss: 2.102 Vali Acc: 0.478 Test Loss: 2.102 Test Acc: 0.478
Validation loss decreased (-0.394422 --> -0.477757).  Saving model ...
Epoch: 6 cost time: 2.847949743270874
Epoch: 6, Steps: 12 | Train Loss: 1.975 Vali Loss: 1.943 Vali Acc: 0.494 Test Loss: 1.943 Test Acc: 0.494
Validation loss decreased (-0.477757 --> -0.494425).  Saving model ...
Epoch: 7 cost time: 2.8861608505249023
Epoch: 7, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.784 Vali Acc: 0.517 Test Loss: 1.784 Test Acc: 0.517
Validation loss decreased (-0.494425 --> -0.516649).  Saving model ...
Epoch: 8 cost time: 2.9955689907073975
Epoch: 8, Steps: 12 | Train Loss: 1.578 Vali Loss: 1.640 Vali Acc: 0.500 Test Loss: 1.640 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9466536045074463
Epoch: 9, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.507 Vali Acc: 0.517 Test Loss: 1.507 Test Acc: 0.517
Validation loss decreased (-0.516649 --> -0.516652).  Saving model ...
Epoch: 10 cost time: 2.8490238189697266
Epoch: 10, Steps: 12 | Train Loss: 1.278 Vali Loss: 1.394 Vali Acc: 0.550 Test Loss: 1.394 Test Acc: 0.550
Validation loss decreased (-0.516652 --> -0.549986).  Saving model ...
Epoch: 11 cost time: 2.8409738540649414
Epoch: 11, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.299 Vali Acc: 0.589 Test Loss: 1.299 Test Acc: 0.589
Validation loss decreased (-0.549986 --> -0.588876).  Saving model ...
Epoch: 12 cost time: 2.8381738662719727
Epoch: 12, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.229 Vali Acc: 0.611 Test Loss: 1.229 Test Acc: 0.611
Validation loss decreased (-0.588876 --> -0.611099).  Saving model ...
Epoch: 13 cost time: 2.8267412185668945
Epoch: 13, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.140 Vali Acc: 0.628 Test Loss: 1.140 Test Acc: 0.628
Validation loss decreased (-0.611099 --> -0.627766).  Saving model ...
Epoch: 14 cost time: 3.013244152069092
Epoch: 14, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.078 Vali Acc: 0.622 Test Loss: 1.078 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.025589942932129
Epoch: 15, Steps: 12 | Train Loss: 0.794 Vali Loss: 1.025 Vali Acc: 0.633 Test Loss: 1.025 Test Acc: 0.633
Validation loss decreased (-0.627766 --> -0.633323).  Saving model ...
Epoch: 16 cost time: 2.95758318901062
Epoch: 16, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.987 Vali Acc: 0.622 Test Loss: 0.987 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7380332946777344
Epoch: 17, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.944 Vali Acc: 0.689 Test Loss: 0.944 Test Acc: 0.689
Validation loss decreased (-0.633323 --> -0.688879).  Saving model ...
Epoch: 18 cost time: 2.6761398315429688
Epoch: 18, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.913 Vali Acc: 0.661 Test Loss: 0.913 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8065173625946045
Epoch: 19, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.877 Vali Acc: 0.689 Test Loss: 0.877 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688880).  Saving model ...
Epoch: 20 cost time: 2.6903908252716064
Epoch: 20, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.841 Vali Acc: 0.683 Test Loss: 0.841 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.682310104370117
Epoch: 21, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.840 Vali Acc: 0.683 Test Loss: 0.840 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.871520519256592
Epoch: 22, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.792 Vali Acc: 0.706 Test Loss: 0.792 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705548).  Saving model ...
Epoch: 23 cost time: 3.0404980182647705
Epoch: 23, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.797 Vali Acc: 0.722 Test Loss: 0.797 Test Acc: 0.722
Validation loss decreased (-0.705548 --> -0.722214).  Saving model ...
Epoch: 24 cost time: 3.0504584312438965
Epoch: 24, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.757 Vali Acc: 0.711 Test Loss: 0.757 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7695233821868896
Epoch: 25, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.724 Vali Acc: 0.728 Test Loss: 0.724 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727771).  Saving model ...
Epoch: 26 cost time: 2.750786304473877
Epoch: 26, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.724 Vali Acc: 0.728 Test Loss: 0.724 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.699162721633911
Epoch: 27, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.716 Vali Acc: 0.733 Test Loss: 0.716 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733326).  Saving model ...
Epoch: 28 cost time: 2.823047637939453
Epoch: 28, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.699 Vali Acc: 0.750 Test Loss: 0.699 Test Acc: 0.750
Validation loss decreased (-0.733326 --> -0.749993).  Saving model ...
Epoch: 29 cost time: 2.692958354949951
Epoch: 29, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.683 Vali Acc: 0.733 Test Loss: 0.683 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.81715989112854
Epoch: 30, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.655 Vali Acc: 0.767 Test Loss: 0.655 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 528063
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.254533767700195
Epoch: 1, Steps: 12 | Train Loss: 2.771 Vali Loss: 2.686 Vali Acc: 0.061 Test Loss: 2.686 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 2.4916365146636963
Epoch: 2, Steps: 12 | Train Loss: 2.684 Vali Loss: 2.595 Vali Acc: 0.111 Test Loss: 2.595 Test Acc: 0.111
Validation loss decreased (-0.061084 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 2.545837879180908
Epoch: 3, Steps: 12 | Train Loss: 2.587 Vali Loss: 2.476 Vali Acc: 0.250 Test Loss: 2.476 Test Acc: 0.250
Validation loss decreased (-0.111085 --> -0.249975).  Saving model ...
Epoch: 4 cost time: 2.5341413021087646
Epoch: 4, Steps: 12 | Train Loss: 2.474 Vali Loss: 2.335 Vali Acc: 0.344 Test Loss: 2.335 Test Acc: 0.344
Validation loss decreased (-0.249975 --> -0.344421).  Saving model ...
Epoch: 5 cost time: 2.344040632247925
Epoch: 5, Steps: 12 | Train Loss: 2.268 Vali Loss: 2.197 Vali Acc: 0.400 Test Loss: 2.197 Test Acc: 0.400
Validation loss decreased (-0.344421 --> -0.399978).  Saving model ...
Epoch: 6 cost time: 2.3483874797821045
Epoch: 6, Steps: 12 | Train Loss: 2.150 Vali Loss: 2.056 Vali Acc: 0.433 Test Loss: 2.056 Test Acc: 0.433
Validation loss decreased (-0.399978 --> -0.433313).  Saving model ...
Epoch: 7 cost time: 2.366004467010498
Epoch: 7, Steps: 12 | Train Loss: 1.965 Vali Loss: 1.927 Vali Acc: 0.517 Test Loss: 1.927 Test Acc: 0.517
Validation loss decreased (-0.433313 --> -0.516647).  Saving model ...
Epoch: 8 cost time: 2.390450954437256
Epoch: 8, Steps: 12 | Train Loss: 1.814 Vali Loss: 1.805 Vali Acc: 0.511 Test Loss: 1.805 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4249892234802246
Epoch: 9, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.689 Vali Acc: 0.544 Test Loss: 1.689 Test Acc: 0.544
Validation loss decreased (-0.516647 --> -0.544428).  Saving model ...
Epoch: 10 cost time: 2.5233113765716553
Epoch: 10, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.588 Vali Acc: 0.550 Test Loss: 1.588 Test Acc: 0.550
Validation loss decreased (-0.544428 --> -0.549984).  Saving model ...
Epoch: 11 cost time: 2.6088461875915527
Epoch: 11, Steps: 12 | Train Loss: 1.420 Vali Loss: 1.495 Vali Acc: 0.572 Test Loss: 1.495 Test Acc: 0.572
Validation loss decreased (-0.549984 --> -0.572207).  Saving model ...
Epoch: 12 cost time: 2.4276561737060547
Epoch: 12, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.393 Vali Acc: 0.594 Test Loss: 1.393 Test Acc: 0.594
Validation loss decreased (-0.572207 --> -0.594431).  Saving model ...
Epoch: 13 cost time: 2.4748289585113525
Epoch: 13, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.320 Vali Acc: 0.589 Test Loss: 1.320 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3985323905944824
Epoch: 14, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.261 Vali Acc: 0.594 Test Loss: 1.261 Test Acc: 0.594
Validation loss decreased (-0.594431 --> -0.594432).  Saving model ...
Epoch: 15 cost time: 2.345623254776001
Epoch: 15, Steps: 12 | Train Loss: 1.000 Vali Loss: 1.201 Vali Acc: 0.633 Test Loss: 1.201 Test Acc: 0.633
Validation loss decreased (-0.594432 --> -0.633321).  Saving model ...
Epoch: 16 cost time: 2.4912803173065186
Epoch: 16, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.166 Vali Acc: 0.628 Test Loss: 1.166 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.507887840270996
Epoch: 17, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.101 Vali Acc: 0.628 Test Loss: 1.101 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.5031895637512207
Epoch: 18, Steps: 12 | Train Loss: 0.798 Vali Loss: 1.058 Vali Acc: 0.622 Test Loss: 1.058 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3671631813049316
Epoch: 19, Steps: 12 | Train Loss: 0.735 Vali Loss: 1.006 Vali Acc: 0.661 Test Loss: 1.006 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661101).  Saving model ...
Epoch: 20 cost time: 2.3060083389282227
Epoch: 20, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.970 Vali Acc: 0.672 Test Loss: 0.970 Test Acc: 0.672
Validation loss decreased (-0.661101 --> -0.672213).  Saving model ...
Epoch: 21 cost time: 2.6046955585479736
Epoch: 21, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.936 Vali Acc: 0.678 Test Loss: 0.936 Test Acc: 0.678
Validation loss decreased (-0.672213 --> -0.677768).  Saving model ...
Epoch: 22 cost time: 2.5277633666992188
Epoch: 22, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.919 Vali Acc: 0.683 Test Loss: 0.919 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683324).  Saving model ...
Epoch: 23 cost time: 2.6185033321380615
Epoch: 23, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.870 Vali Acc: 0.711 Test Loss: 0.870 Test Acc: 0.711
Validation loss decreased (-0.683324 --> -0.711102).  Saving model ...
Epoch: 24 cost time: 2.619537830352783
Epoch: 24, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.854 Vali Acc: 0.722 Test Loss: 0.854 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722214).  Saving model ...
Epoch: 25 cost time: 2.5672688484191895
Epoch: 25, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.845 Vali Acc: 0.728 Test Loss: 0.845 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727769).  Saving model ...
Epoch: 26 cost time: 2.494643449783325
Epoch: 26, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.804 Vali Acc: 0.711 Test Loss: 0.804 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.453707456588745
Epoch: 27, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.828 Vali Acc: 0.722 Test Loss: 0.828 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.5282199382781982
Epoch: 28, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.781 Vali Acc: 0.711 Test Loss: 0.781 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.564694881439209
Epoch: 29, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.761 Vali Acc: 0.733 Test Loss: 0.761 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733326).  Saving model ...
Epoch: 30 cost time: 2.5832290649414062
Epoch: 30, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.752 Vali Acc: 0.756 Test Loss: 0.752 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755548).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 1769631
model size : 7.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.296265602111816
Epoch: 1, Steps: 12 | Train Loss: 2.731 Vali Loss: 2.619 Vali Acc: 0.133 Test Loss: 2.619 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 2.3497440814971924
Epoch: 2, Steps: 12 | Train Loss: 2.678 Vali Loss: 2.538 Vali Acc: 0.239 Test Loss: 2.538 Test Acc: 0.239
Validation loss decreased (-0.133307 --> -0.238864).  Saving model ...
Epoch: 3 cost time: 2.272152900695801
Epoch: 3, Steps: 12 | Train Loss: 2.530 Vali Loss: 2.436 Vali Acc: 0.294 Test Loss: 2.436 Test Acc: 0.294
Validation loss decreased (-0.238864 --> -0.294420).  Saving model ...
Epoch: 4 cost time: 2.3075950145721436
Epoch: 4, Steps: 12 | Train Loss: 2.398 Vali Loss: 2.325 Vali Acc: 0.328 Test Loss: 2.325 Test Acc: 0.328
Validation loss decreased (-0.294420 --> -0.327755).  Saving model ...
Epoch: 5 cost time: 2.2903966903686523
Epoch: 5, Steps: 12 | Train Loss: 2.292 Vali Loss: 2.209 Vali Acc: 0.394 Test Loss: 2.209 Test Acc: 0.394
Validation loss decreased (-0.327755 --> -0.394422).  Saving model ...
Epoch: 6 cost time: 2.3352630138397217
Epoch: 6, Steps: 12 | Train Loss: 2.118 Vali Loss: 2.085 Vali Acc: 0.450 Test Loss: 2.085 Test Acc: 0.450
Validation loss decreased (-0.394422 --> -0.449979).  Saving model ...
Epoch: 7 cost time: 2.2392077445983887
Epoch: 7, Steps: 12 | Train Loss: 2.012 Vali Loss: 1.959 Vali Acc: 0.489 Test Loss: 1.959 Test Acc: 0.489
Validation loss decreased (-0.449979 --> -0.488869).  Saving model ...
Epoch: 8 cost time: 2.2672345638275146
Epoch: 8, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.835 Vali Acc: 0.528 Test Loss: 1.835 Test Acc: 0.528
Validation loss decreased (-0.488869 --> -0.527759).  Saving model ...
Epoch: 9 cost time: 2.1646831035614014
Epoch: 9, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.718 Vali Acc: 0.550 Test Loss: 1.718 Test Acc: 0.550
Validation loss decreased (-0.527759 --> -0.549983).  Saving model ...
Epoch: 10 cost time: 2.3159446716308594
Epoch: 10, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.609 Vali Acc: 0.567 Test Loss: 1.609 Test Acc: 0.567
Validation loss decreased (-0.549983 --> -0.566651).  Saving model ...
Epoch: 11 cost time: 2.3944180011749268
Epoch: 11, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.510 Vali Acc: 0.578 Test Loss: 1.510 Test Acc: 0.578
Validation loss decreased (-0.566651 --> -0.577763).  Saving model ...
Epoch: 12 cost time: 2.375725030899048
Epoch: 12, Steps: 12 | Train Loss: 1.277 Vali Loss: 1.437 Vali Acc: 0.567 Test Loss: 1.437 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3971614837646484
Epoch: 13, Steps: 12 | Train Loss: 1.188 Vali Loss: 1.352 Vali Acc: 0.594 Test Loss: 1.352 Test Acc: 0.594
Validation loss decreased (-0.577763 --> -0.594431).  Saving model ...
Epoch: 14 cost time: 2.3193843364715576
Epoch: 14, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.284 Vali Acc: 0.606 Test Loss: 1.284 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605543).  Saving model ...
Epoch: 15 cost time: 2.226062774658203
Epoch: 15, Steps: 12 | Train Loss: 0.978 Vali Loss: 1.228 Vali Acc: 0.594 Test Loss: 1.228 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.240976095199585
Epoch: 16, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.182 Vali Acc: 0.606 Test Loss: 1.182 Test Acc: 0.606
Validation loss decreased (-0.605543 --> -0.605544).  Saving model ...
Epoch: 17 cost time: 2.250821352005005
Epoch: 17, Steps: 12 | Train Loss: 0.876 Vali Loss: 1.136 Vali Acc: 0.606 Test Loss: 1.136 Test Acc: 0.606
Validation loss decreased (-0.605544 --> -0.605544).  Saving model ...
Epoch: 18 cost time: 2.257986068725586
Epoch: 18, Steps: 12 | Train Loss: 0.826 Vali Loss: 1.107 Vali Acc: 0.611 Test Loss: 1.107 Test Acc: 0.611
Validation loss decreased (-0.605544 --> -0.611100).  Saving model ...
Epoch: 19 cost time: 2.3156676292419434
Epoch: 19, Steps: 12 | Train Loss: 0.786 Vali Loss: 1.073 Vali Acc: 0.606 Test Loss: 1.073 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3351242542266846
Epoch: 20, Steps: 12 | Train Loss: 0.710 Vali Loss: 1.037 Vali Acc: 0.622 Test Loss: 1.037 Test Acc: 0.622
Validation loss decreased (-0.611100 --> -0.622212).  Saving model ...
Epoch: 21 cost time: 2.3171584606170654
Epoch: 21, Steps: 12 | Train Loss: 0.691 Vali Loss: 1.024 Vali Acc: 0.628 Test Loss: 1.024 Test Acc: 0.628
Validation loss decreased (-0.622212 --> -0.627768).  Saving model ...
Epoch: 22 cost time: 2.2466745376586914
Epoch: 22, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.996 Vali Acc: 0.633 Test Loss: 0.996 Test Acc: 0.633
Validation loss decreased (-0.627768 --> -0.633323).  Saving model ...
Epoch: 23 cost time: 2.1805713176727295
Epoch: 23, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.967 Vali Acc: 0.644 Test Loss: 0.967 Test Acc: 0.644
Validation loss decreased (-0.633323 --> -0.644435).  Saving model ...
Epoch: 24 cost time: 1.893911361694336
Epoch: 24, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.916 Vali Acc: 0.667 Test Loss: 0.916 Test Acc: 0.667
Validation loss decreased (-0.644435 --> -0.666658).  Saving model ...
Epoch: 25 cost time: 1.8427019119262695
Epoch: 25, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.904 Vali Acc: 0.678 Test Loss: 0.904 Test Acc: 0.678
Validation loss decreased (-0.666658 --> -0.677769).  Saving model ...
Epoch: 26 cost time: 2.31463623046875
Epoch: 26, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.898 Vali Acc: 0.667 Test Loss: 0.898 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.302450656890869
Epoch: 27, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.888 Vali Acc: 0.706 Test Loss: 0.888 Test Acc: 0.706
Validation loss decreased (-0.677769 --> -0.705547).  Saving model ...
Epoch: 28 cost time: 2.195396900177002
Epoch: 28, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.857 Vali Acc: 0.694 Test Loss: 0.857 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0865981578826904
Epoch: 29, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.830 Vali Acc: 0.728 Test Loss: 0.830 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727769).  Saving model ...
Epoch: 30 cost time: 2.216460943222046
Epoch: 30, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.807 Vali Acc: 0.728 Test Loss: 0.807 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727770).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7277777777777777
model parameter : 528063
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.435460805892944
Epoch: 1, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.715 Vali Acc: 0.100 Test Loss: 2.715 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 3.631584405899048
Epoch: 2, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.627 Vali Acc: 0.111 Test Loss: 2.627 Test Acc: 0.111
Validation loss decreased (-0.099973 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 3.312551259994507
Epoch: 3, Steps: 12 | Train Loss: 2.559 Vali Loss: 2.508 Vali Acc: 0.206 Test Loss: 2.508 Test Acc: 0.206
Validation loss decreased (-0.111085 --> -0.205530).  Saving model ...
Epoch: 4 cost time: 3.281463146209717
Epoch: 4, Steps: 12 | Train Loss: 2.457 Vali Loss: 2.373 Vali Acc: 0.311 Test Loss: 2.373 Test Acc: 0.311
Validation loss decreased (-0.205530 --> -0.311087).  Saving model ...
Epoch: 5 cost time: 3.4325358867645264
Epoch: 5, Steps: 12 | Train Loss: 2.295 Vali Loss: 2.223 Vali Acc: 0.406 Test Loss: 2.223 Test Acc: 0.406
Validation loss decreased (-0.311087 --> -0.405533).  Saving model ...
Epoch: 6 cost time: 3.640336751937866
Epoch: 6, Steps: 12 | Train Loss: 2.122 Vali Loss: 2.053 Vali Acc: 0.500 Test Loss: 2.053 Test Acc: 0.500
Validation loss decreased (-0.405533 --> -0.499979).  Saving model ...
Epoch: 7 cost time: 3.4947500228881836
Epoch: 7, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.881 Vali Acc: 0.583 Test Loss: 1.881 Test Acc: 0.583
Validation loss decreased (-0.499979 --> -0.583315).  Saving model ...
Epoch: 8 cost time: 3.4806079864501953
Epoch: 8, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.714 Vali Acc: 0.589 Test Loss: 1.714 Test Acc: 0.589
Validation loss decreased (-0.583315 --> -0.588872).  Saving model ...
Epoch: 9 cost time: 3.5356814861297607
Epoch: 9, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.559 Vali Acc: 0.600 Test Loss: 1.559 Test Acc: 0.600
Validation loss decreased (-0.588872 --> -0.599984).  Saving model ...
Epoch: 10 cost time: 3.2949769496917725
Epoch: 10, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.420 Vali Acc: 0.617 Test Loss: 1.420 Test Acc: 0.617
Validation loss decreased (-0.599984 --> -0.616652).  Saving model ...
Epoch: 11 cost time: 3.4879751205444336
Epoch: 11, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.291 Vali Acc: 0.639 Test Loss: 1.291 Test Acc: 0.639
Validation loss decreased (-0.616652 --> -0.638876).  Saving model ...
Epoch: 12 cost time: 3.746091365814209
Epoch: 12, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.198 Vali Acc: 0.633 Test Loss: 1.198 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.378725290298462
Epoch: 13, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.108 Vali Acc: 0.622 Test Loss: 1.108 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.286693572998047
Epoch: 14, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.040 Vali Acc: 0.628 Test Loss: 1.040 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.5910322666168213
Epoch: 15, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.975 Vali Acc: 0.672 Test Loss: 0.975 Test Acc: 0.672
Validation loss decreased (-0.638876 --> -0.672212).  Saving model ...
Epoch: 16 cost time: 3.438971757888794
Epoch: 16, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.923 Vali Acc: 0.683 Test Loss: 0.923 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683324).  Saving model ...
Epoch: 17 cost time: 3.4501092433929443
Epoch: 17, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.881 Vali Acc: 0.683 Test Loss: 0.881 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683325).  Saving model ...
Epoch: 18 cost time: 3.456540822982788
Epoch: 18, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.851 Vali Acc: 0.689 Test Loss: 0.851 Test Acc: 0.689
Validation loss decreased (-0.683325 --> -0.688880).  Saving model ...
Epoch: 19 cost time: 3.1950221061706543
Epoch: 19, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.809 Vali Acc: 0.711 Test Loss: 0.809 Test Acc: 0.711
Validation loss decreased (-0.688880 --> -0.711103).  Saving model ...
Epoch: 20 cost time: 3.006751298904419
Epoch: 20, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.783 Vali Acc: 0.717 Test Loss: 0.783 Test Acc: 0.717
Validation loss decreased (-0.711103 --> -0.716659).  Saving model ...
Epoch: 21 cost time: 3.2530934810638428
Epoch: 21, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.752 Vali Acc: 0.744 Test Loss: 0.752 Test Acc: 0.744
Validation loss decreased (-0.716659 --> -0.744437).  Saving model ...
Epoch: 22 cost time: 3.466403007507324
Epoch: 22, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.734 Vali Acc: 0.739 Test Loss: 0.734 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.425175905227661
Epoch: 23, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.740 Vali Acc: 0.711 Test Loss: 0.740 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3260717391967773
Epoch: 24, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.692 Vali Acc: 0.739 Test Loss: 0.692 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.3079724311828613
Epoch: 25, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.669 Vali Acc: 0.772 Test Loss: 0.669 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772216).  Saving model ...
Epoch: 26 cost time: 3.0601725578308105
Epoch: 26, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.680 Vali Acc: 0.733 Test Loss: 0.680 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4843151569366455
Epoch: 27, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.658 Vali Acc: 0.733 Test Loss: 0.658 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.5693466663360596
Epoch: 28, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.657 Vali Acc: 0.744 Test Loss: 0.657 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.0434744358062744
Epoch: 29, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.646 Vali Acc: 0.750 Test Loss: 0.646 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.1491353511810303
Epoch: 30, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.649 Vali Acc: 0.767 Test Loss: 0.649 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 890463
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.456510782241821
Epoch: 1, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.683 Vali Acc: 0.100 Test Loss: 2.683 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 2.743316650390625
Epoch: 2, Steps: 12 | Train Loss: 2.649 Vali Loss: 2.602 Vali Acc: 0.194 Test Loss: 2.602 Test Acc: 0.194
Validation loss decreased (-0.099973 --> -0.194418).  Saving model ...
Epoch: 3 cost time: 2.6903786659240723
Epoch: 3, Steps: 12 | Train Loss: 2.595 Vali Loss: 2.498 Vali Acc: 0.256 Test Loss: 2.498 Test Acc: 0.256
Validation loss decreased (-0.194418 --> -0.255531).  Saving model ...
Epoch: 4 cost time: 2.673764705657959
Epoch: 4, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.378 Vali Acc: 0.272 Test Loss: 2.378 Test Acc: 0.272
Validation loss decreased (-0.255531 --> -0.272198).  Saving model ...
Epoch: 5 cost time: 2.816995620727539
Epoch: 5, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.248 Vali Acc: 0.389 Test Loss: 2.248 Test Acc: 0.389
Validation loss decreased (-0.272198 --> -0.388866).  Saving model ...
Epoch: 6 cost time: 2.807931423187256
Epoch: 6, Steps: 12 | Train Loss: 2.169 Vali Loss: 2.113 Vali Acc: 0.472 Test Loss: 2.113 Test Acc: 0.472
Validation loss decreased (-0.388866 --> -0.472201).  Saving model ...
Epoch: 7 cost time: 2.735506534576416
Epoch: 7, Steps: 12 | Train Loss: 2.012 Vali Loss: 1.975 Vali Acc: 0.522 Test Loss: 1.975 Test Acc: 0.522
Validation loss decreased (-0.472201 --> -0.522202).  Saving model ...
Epoch: 8 cost time: 2.4593591690063477
Epoch: 8, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.837 Vali Acc: 0.544 Test Loss: 1.837 Test Acc: 0.544
Validation loss decreased (-0.522202 --> -0.544426).  Saving model ...
Epoch: 9 cost time: 2.781172037124634
Epoch: 9, Steps: 12 | Train Loss: 1.703 Vali Loss: 1.704 Vali Acc: 0.572 Test Loss: 1.704 Test Acc: 0.572
Validation loss decreased (-0.544426 --> -0.572205).  Saving model ...
Epoch: 10 cost time: 2.6423141956329346
Epoch: 10, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.583 Vali Acc: 0.600 Test Loss: 1.583 Test Acc: 0.600
Validation loss decreased (-0.572205 --> -0.599984).  Saving model ...
Epoch: 11 cost time: 2.731943368911743
Epoch: 11, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.469 Vali Acc: 0.622 Test Loss: 1.469 Test Acc: 0.622
Validation loss decreased (-0.599984 --> -0.622208).  Saving model ...
Epoch: 12 cost time: 2.9026730060577393
Epoch: 12, Steps: 12 | Train Loss: 1.240 Vali Loss: 1.360 Vali Acc: 0.628 Test Loss: 1.360 Test Acc: 0.628
Validation loss decreased (-0.622208 --> -0.627764).  Saving model ...
Epoch: 13 cost time: 2.8069305419921875
Epoch: 13, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.266 Vali Acc: 0.628 Test Loss: 1.266 Test Acc: 0.628
Validation loss decreased (-0.627764 --> -0.627765).  Saving model ...
Epoch: 14 cost time: 2.6040384769439697
Epoch: 14, Steps: 12 | Train Loss: 0.998 Vali Loss: 1.185 Vali Acc: 0.678 Test Loss: 1.185 Test Acc: 0.678
Validation loss decreased (-0.627765 --> -0.677766).  Saving model ...
Epoch: 15 cost time: 2.483762264251709
Epoch: 15, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.103 Vali Acc: 0.706 Test Loss: 1.103 Test Acc: 0.706
Validation loss decreased (-0.677766 --> -0.705545).  Saving model ...
Epoch: 16 cost time: 2.8071773052215576
Epoch: 16, Steps: 12 | Train Loss: 0.848 Vali Loss: 1.039 Vali Acc: 0.711 Test Loss: 1.039 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711101).  Saving model ...
Epoch: 17 cost time: 2.6558279991149902
Epoch: 17, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.972 Vali Acc: 0.711 Test Loss: 0.972 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 18 cost time: 2.6615519523620605
Epoch: 18, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.922 Vali Acc: 0.683 Test Loss: 0.922 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.925337553024292
Epoch: 19, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.877 Vali Acc: 0.711 Test Loss: 0.877 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711102).  Saving model ...
Epoch: 20 cost time: 2.6985995769500732
Epoch: 20, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.849 Vali Acc: 0.728 Test Loss: 0.849 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 21 cost time: 2.653712034225464
Epoch: 21, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.814 Vali Acc: 0.733 Test Loss: 0.814 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 22 cost time: 2.881714344024658
Epoch: 22, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.796 Vali Acc: 0.733 Test Loss: 0.796 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 23 cost time: 2.9737629890441895
Epoch: 23, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.779 Vali Acc: 0.728 Test Loss: 0.779 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7931928634643555
Epoch: 24, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.759 Vali Acc: 0.733 Test Loss: 0.759 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733326).  Saving model ...
Epoch: 25 cost time: 2.831143856048584
Epoch: 25, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.755 Vali Acc: 0.744 Test Loss: 0.755 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744437).  Saving model ...
Epoch: 26 cost time: 2.813061475753784
Epoch: 26, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.745 Vali Acc: 0.739 Test Loss: 0.745 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6694605350494385
Epoch: 27, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.741 Vali Acc: 0.739 Test Loss: 0.741 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.7275421619415283
Epoch: 28, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.746 Vali Acc: 0.728 Test Loss: 0.746 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.8731086254119873
Epoch: 29, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.735 Vali Acc: 0.739 Test Loss: 0.735 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.0114052295684814
Epoch: 30, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.743 Vali Acc: 0.739 Test Loss: 0.743 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 269631
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.1002538204193115
Epoch: 1, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.714 Vali Acc: 0.106 Test Loss: 2.714 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 2.8491761684417725
Epoch: 2, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.627 Vali Acc: 0.111 Test Loss: 2.627 Test Acc: 0.111
Validation loss decreased (-0.105528 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 2.9826900959014893
Epoch: 3, Steps: 12 | Train Loss: 2.559 Vali Loss: 2.508 Vali Acc: 0.206 Test Loss: 2.508 Test Acc: 0.206
Validation loss decreased (-0.111085 --> -0.205530).  Saving model ...
Epoch: 4 cost time: 3.168463945388794
Epoch: 4, Steps: 12 | Train Loss: 2.457 Vali Loss: 2.373 Vali Acc: 0.306 Test Loss: 2.373 Test Acc: 0.306
Validation loss decreased (-0.205530 --> -0.305532).  Saving model ...
Epoch: 5 cost time: 3.0083582401275635
Epoch: 5, Steps: 12 | Train Loss: 2.295 Vali Loss: 2.223 Vali Acc: 0.406 Test Loss: 2.223 Test Acc: 0.406
Validation loss decreased (-0.305532 --> -0.405533).  Saving model ...
Epoch: 6 cost time: 2.9635112285614014
Epoch: 6, Steps: 12 | Train Loss: 2.122 Vali Loss: 2.051 Vali Acc: 0.500 Test Loss: 2.051 Test Acc: 0.500
Validation loss decreased (-0.405533 --> -0.499979).  Saving model ...
Epoch: 7 cost time: 3.239866018295288
Epoch: 7, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.877 Vali Acc: 0.578 Test Loss: 1.877 Test Acc: 0.578
Validation loss decreased (-0.499979 --> -0.577759).  Saving model ...
Epoch: 8 cost time: 3.1546947956085205
Epoch: 8, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.708 Vali Acc: 0.594 Test Loss: 1.708 Test Acc: 0.594
Validation loss decreased (-0.577759 --> -0.594427).  Saving model ...
Epoch: 9 cost time: 3.0286946296691895
Epoch: 9, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.552 Vali Acc: 0.606 Test Loss: 1.552 Test Acc: 0.606
Validation loss decreased (-0.594427 --> -0.605540).  Saving model ...
Epoch: 10 cost time: 3.0093576908111572
Epoch: 10, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.414 Vali Acc: 0.633 Test Loss: 1.414 Test Acc: 0.633
Validation loss decreased (-0.605540 --> -0.633319).  Saving model ...
Epoch: 11 cost time: 3.1706621646881104
Epoch: 11, Steps: 12 | Train Loss: 1.188 Vali Loss: 1.288 Vali Acc: 0.639 Test Loss: 1.288 Test Acc: 0.639
Validation loss decreased (-0.633319 --> -0.638876).  Saving model ...
Epoch: 12 cost time: 2.974487543106079
Epoch: 12, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.198 Vali Acc: 0.644 Test Loss: 1.198 Test Acc: 0.644
Validation loss decreased (-0.638876 --> -0.644432).  Saving model ...
Epoch: 13 cost time: 2.93915057182312
Epoch: 13, Steps: 12 | Train Loss: 0.949 Vali Loss: 1.111 Vali Acc: 0.639 Test Loss: 1.111 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2319133281707764
Epoch: 14, Steps: 12 | Train Loss: 0.849 Vali Loss: 1.043 Vali Acc: 0.650 Test Loss: 1.043 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 3.184035062789917
Epoch: 15, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 3.087836742401123
Epoch: 16, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.929 Vali Acc: 0.700 Test Loss: 0.929 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 17 cost time: 2.8839478492736816
Epoch: 17, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.886 Vali Acc: 0.689 Test Loss: 0.886 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.699711799621582
Epoch: 18, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.861 Vali Acc: 0.689 Test Loss: 0.861 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6383702754974365
Epoch: 19, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.816 Vali Acc: 0.706 Test Loss: 0.816 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705547).  Saving model ...
Epoch: 20 cost time: 3.250859498977661
Epoch: 20, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.796 Vali Acc: 0.717 Test Loss: 0.796 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716659).  Saving model ...
Epoch: 21 cost time: 3.2792234420776367
Epoch: 21, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.763 Vali Acc: 0.728 Test Loss: 0.763 Test Acc: 0.728
Validation loss decreased (-0.716659 --> -0.727770).  Saving model ...
Epoch: 22 cost time: 3.211930513381958
Epoch: 22, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.752 Vali Acc: 0.706 Test Loss: 0.752 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.203547239303589
Epoch: 23, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.759 Vali Acc: 0.706 Test Loss: 0.759 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.0626156330108643
Epoch: 24, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.718 Vali Acc: 0.700 Test Loss: 0.718 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.109609603881836
Epoch: 25, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.699 Vali Acc: 0.733 Test Loss: 0.699 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733326).  Saving model ...
Epoch: 26 cost time: 3.1960270404815674
Epoch: 26, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.716 Vali Acc: 0.711 Test Loss: 0.716 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.1722300052642822
Epoch: 27, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.700 Vali Acc: 0.694 Test Loss: 0.700 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.1717679500579834
Epoch: 28, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.685 Vali Acc: 0.728 Test Loss: 0.685 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.9801535606384277
Epoch: 29, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.665 Vali Acc: 0.739 Test Loss: 0.665 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 30 cost time: 2.8783795833587646
Epoch: 30, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.665 Vali Acc: 0.744 Test Loss: 0.665 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 890463
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.492715358734131
Epoch: 1, Steps: 12 | Train Loss: 2.728 Vali Loss: 2.682 Vali Acc: 0.100 Test Loss: 2.682 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 2.6057486534118652
Epoch: 2, Steps: 12 | Train Loss: 2.649 Vali Loss: 2.602 Vali Acc: 0.194 Test Loss: 2.602 Test Acc: 0.194
Validation loss decreased (-0.099973 --> -0.194418).  Saving model ...
Epoch: 3 cost time: 2.5183064937591553
Epoch: 3, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.498 Vali Acc: 0.256 Test Loss: 2.498 Test Acc: 0.256
Validation loss decreased (-0.194418 --> -0.255531).  Saving model ...
Epoch: 4 cost time: 2.5165984630584717
Epoch: 4, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.378 Vali Acc: 0.272 Test Loss: 2.378 Test Acc: 0.272
Validation loss decreased (-0.255531 --> -0.272198).  Saving model ...
Epoch: 5 cost time: 2.5789337158203125
Epoch: 5, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.248 Vali Acc: 0.389 Test Loss: 2.248 Test Acc: 0.389
Validation loss decreased (-0.272198 --> -0.388866).  Saving model ...
Epoch: 6 cost time: 2.392341136932373
Epoch: 6, Steps: 12 | Train Loss: 2.172 Vali Loss: 2.114 Vali Acc: 0.478 Test Loss: 2.114 Test Acc: 0.478
Validation loss decreased (-0.388866 --> -0.477757).  Saving model ...
Epoch: 7 cost time: 2.669031858444214
Epoch: 7, Steps: 12 | Train Loss: 2.012 Vali Loss: 1.978 Vali Acc: 0.522 Test Loss: 1.978 Test Acc: 0.522
Validation loss decreased (-0.477757 --> -0.522202).  Saving model ...
Epoch: 8 cost time: 2.567457914352417
Epoch: 8, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.840 Vali Acc: 0.544 Test Loss: 1.840 Test Acc: 0.544
Validation loss decreased (-0.522202 --> -0.544426).  Saving model ...
Epoch: 9 cost time: 2.579394578933716
Epoch: 9, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.709 Vali Acc: 0.572 Test Loss: 1.709 Test Acc: 0.572
Validation loss decreased (-0.544426 --> -0.572205).  Saving model ...
Epoch: 10 cost time: 2.546281099319458
Epoch: 10, Steps: 12 | Train Loss: 1.487 Vali Loss: 1.590 Vali Acc: 0.594 Test Loss: 1.590 Test Acc: 0.594
Validation loss decreased (-0.572205 --> -0.594429).  Saving model ...
Epoch: 11 cost time: 2.4151597023010254
Epoch: 11, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.479 Vali Acc: 0.617 Test Loss: 1.479 Test Acc: 0.617
Validation loss decreased (-0.594429 --> -0.616652).  Saving model ...
Epoch: 12 cost time: 2.51975679397583
Epoch: 12, Steps: 12 | Train Loss: 1.241 Vali Loss: 1.374 Vali Acc: 0.628 Test Loss: 1.374 Test Acc: 0.628
Validation loss decreased (-0.616652 --> -0.627764).  Saving model ...
Epoch: 13 cost time: 2.5865237712860107
Epoch: 13, Steps: 12 | Train Loss: 1.116 Vali Loss: 1.281 Vali Acc: 0.628 Test Loss: 1.281 Test Acc: 0.628
Validation loss decreased (-0.627764 --> -0.627765).  Saving model ...
Epoch: 14 cost time: 2.596298933029175
Epoch: 14, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.202 Vali Acc: 0.656 Test Loss: 1.202 Test Acc: 0.656
Validation loss decreased (-0.627765 --> -0.655544).  Saving model ...
Epoch: 15 cost time: 2.703425884246826
Epoch: 15, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.120 Vali Acc: 0.678 Test Loss: 1.120 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677767).  Saving model ...
Epoch: 16 cost time: 2.6710288524627686
Epoch: 16, Steps: 12 | Train Loss: 0.854 Vali Loss: 1.054 Vali Acc: 0.706 Test Loss: 1.054 Test Acc: 0.706
Validation loss decreased (-0.677767 --> -0.705545).  Saving model ...
Epoch: 17 cost time: 2.523172378540039
Epoch: 17, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.986 Vali Acc: 0.706 Test Loss: 0.986 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705546).  Saving model ...
Epoch: 18 cost time: 2.5149950981140137
Epoch: 18, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.936 Vali Acc: 0.678 Test Loss: 0.936 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.431655168533325
Epoch: 19, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.893 Vali Acc: 0.711 Test Loss: 0.893 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 20 cost time: 2.7061033248901367
Epoch: 20, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.866 Vali Acc: 0.728 Test Loss: 0.866 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 21 cost time: 2.721567392349243
Epoch: 21, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.833 Vali Acc: 0.722 Test Loss: 0.833 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6413497924804688
Epoch: 22, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.814 Vali Acc: 0.722 Test Loss: 0.814 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.55118989944458
Epoch: 23, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.803 Vali Acc: 0.717 Test Loss: 0.803 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4343912601470947
Epoch: 24, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.772 Vali Acc: 0.722 Test Loss: 0.772 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.530059814453125
Epoch: 25, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.764 Vali Acc: 0.717 Test Loss: 0.764 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.470229148864746
Epoch: 26, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.753 Vali Acc: 0.733 Test Loss: 0.753 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733326).  Saving model ...
Epoch: 27 cost time: 2.685213327407837
Epoch: 27, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.5943496227264404
Epoch: 28, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.745 Vali Acc: 0.717 Test Loss: 0.745 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.632082223892212
Epoch: 29, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.731 Vali Acc: 0.717 Test Loss: 0.731 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.5710015296936035
Epoch: 30, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.742 Vali Acc: 0.689 Test Loss: 0.742 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7333333333333333
model parameter : 269631
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.051581859588623
Epoch: 1, Steps: 12 | Train Loss: 2.765 Vali Loss: 2.717 Vali Acc: 0.094 Test Loss: 2.717 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 2.3867380619049072
Epoch: 2, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.641 Vali Acc: 0.094 Test Loss: 2.641 Test Acc: 0.094
Validation loss decreased (-0.094417 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 2.352221965789795
Epoch: 3, Steps: 12 | Train Loss: 2.584 Vali Loss: 2.540 Vali Acc: 0.178 Test Loss: 2.540 Test Acc: 0.178
Validation loss decreased (-0.094418 --> -0.177752).  Saving model ...
Epoch: 4 cost time: 2.383087396621704
Epoch: 4, Steps: 12 | Train Loss: 2.499 Vali Loss: 2.428 Vali Acc: 0.283 Test Loss: 2.428 Test Acc: 0.283
Validation loss decreased (-0.177752 --> -0.283309).  Saving model ...
Epoch: 5 cost time: 2.3328723907470703
Epoch: 5, Steps: 12 | Train Loss: 2.367 Vali Loss: 2.305 Vali Acc: 0.378 Test Loss: 2.305 Test Acc: 0.378
Validation loss decreased (-0.283309 --> -0.377755).  Saving model ...
Epoch: 6 cost time: 2.4005703926086426
Epoch: 6, Steps: 12 | Train Loss: 2.225 Vali Loss: 2.162 Vali Acc: 0.478 Test Loss: 2.162 Test Acc: 0.478
Validation loss decreased (-0.377755 --> -0.477756).  Saving model ...
Epoch: 7 cost time: 2.410128593444824
Epoch: 7, Steps: 12 | Train Loss: 2.022 Vali Loss: 2.019 Vali Acc: 0.578 Test Loss: 2.019 Test Acc: 0.578
Validation loss decreased (-0.477756 --> -0.577758).  Saving model ...
Epoch: 8 cost time: 2.18398380279541
Epoch: 8, Steps: 12 | Train Loss: 1.903 Vali Loss: 1.883 Vali Acc: 0.578 Test Loss: 1.883 Test Acc: 0.578
Validation loss decreased (-0.577758 --> -0.577759).  Saving model ...
Epoch: 9 cost time: 2.3523850440979004
Epoch: 9, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.759 Vali Acc: 0.594 Test Loss: 1.759 Test Acc: 0.594
Validation loss decreased (-0.577759 --> -0.594427).  Saving model ...
Epoch: 10 cost time: 2.428070545196533
Epoch: 10, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.639 Vali Acc: 0.600 Test Loss: 1.639 Test Acc: 0.600
Validation loss decreased (-0.594427 --> -0.599984).  Saving model ...
Epoch: 11 cost time: 2.4754583835601807
Epoch: 11, Steps: 12 | Train Loss: 1.478 Vali Loss: 1.527 Vali Acc: 0.594 Test Loss: 1.527 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3850176334381104
Epoch: 12, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.438 Vali Acc: 0.583 Test Loss: 1.438 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2429065704345703
Epoch: 13, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.348 Vali Acc: 0.578 Test Loss: 1.348 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.233311653137207
Epoch: 14, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.276 Vali Acc: 0.594 Test Loss: 1.276 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.26605486869812
Epoch: 15, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.204 Vali Acc: 0.606 Test Loss: 1.204 Test Acc: 0.606
Validation loss decreased (-0.599984 --> -0.605544).  Saving model ...
Epoch: 16 cost time: 2.5218617916107178
Epoch: 16, Steps: 12 | Train Loss: 0.974 Vali Loss: 1.126 Vali Acc: 0.650 Test Loss: 1.126 Test Acc: 0.650
Validation loss decreased (-0.605544 --> -0.649989).  Saving model ...
Epoch: 17 cost time: 2.3979568481445312
Epoch: 17, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.070 Vali Acc: 0.656 Test Loss: 1.070 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655545).  Saving model ...
Epoch: 18 cost time: 2.3974339962005615
Epoch: 18, Steps: 12 | Train Loss: 0.794 Vali Loss: 1.022 Vali Acc: 0.689 Test Loss: 1.022 Test Acc: 0.689
Validation loss decreased (-0.655545 --> -0.688879).  Saving model ...
Epoch: 19 cost time: 2.3174667358398438
Epoch: 19, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.976 Vali Acc: 0.694 Test Loss: 0.976 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 20 cost time: 2.339780330657959
Epoch: 20, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.951 Vali Acc: 0.678 Test Loss: 0.951 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.264597177505493
Epoch: 21, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.905 Vali Acc: 0.711 Test Loss: 0.905 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 22 cost time: 2.299081325531006
Epoch: 22, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.887 Vali Acc: 0.689 Test Loss: 0.887 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4821183681488037
Epoch: 23, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.875 Vali Acc: 0.694 Test Loss: 0.875 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3819878101348877
Epoch: 24, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.822 Vali Acc: 0.717 Test Loss: 0.822 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 25 cost time: 2.4133150577545166
Epoch: 25, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.804 Vali Acc: 0.728 Test Loss: 0.804 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727770).  Saving model ...
Epoch: 26 cost time: 2.3724539279937744
Epoch: 26, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.790 Vali Acc: 0.717 Test Loss: 0.790 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3339767456054688
Epoch: 27, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.762 Vali Acc: 0.733 Test Loss: 0.762 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733326).  Saving model ...
Epoch: 28 cost time: 2.3874948024749756
Epoch: 28, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.755 Vali Acc: 0.717 Test Loss: 0.755 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.366119146347046
Epoch: 29, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.748 Vali Acc: 0.750 Test Loss: 0.748 Test Acc: 0.750
Validation loss decreased (-0.733326 --> -0.749993).  Saving model ...
Epoch: 30 cost time: 2.3016464710235596
Epoch: 30, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.733 Vali Acc: 0.750 Test Loss: 0.733 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 890463
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.120879411697388
Epoch: 1, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.686 Vali Acc: 0.100 Test Loss: 2.686 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 2.2331430912017822
Epoch: 2, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.616 Vali Acc: 0.183 Test Loss: 2.616 Test Acc: 0.183
Validation loss decreased (-0.099973 --> -0.183307).  Saving model ...
Epoch: 3 cost time: 2.0951054096221924
Epoch: 3, Steps: 12 | Train Loss: 2.617 Vali Loss: 2.526 Vali Acc: 0.233 Test Loss: 2.526 Test Acc: 0.233
Validation loss decreased (-0.183307 --> -0.233308).  Saving model ...
Epoch: 4 cost time: 2.1036107540130615
Epoch: 4, Steps: 12 | Train Loss: 2.454 Vali Loss: 2.421 Vali Acc: 0.256 Test Loss: 2.421 Test Acc: 0.256
Validation loss decreased (-0.233308 --> -0.255531).  Saving model ...
Epoch: 5 cost time: 1.879962682723999
Epoch: 5, Steps: 12 | Train Loss: 2.342 Vali Loss: 2.312 Vali Acc: 0.350 Test Loss: 2.312 Test Acc: 0.350
Validation loss decreased (-0.255531 --> -0.349977).  Saving model ...
Epoch: 6 cost time: 2.1035351753234863
Epoch: 6, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.202 Vali Acc: 0.394 Test Loss: 2.202 Test Acc: 0.394
Validation loss decreased (-0.349977 --> -0.394422).  Saving model ...
Epoch: 7 cost time: 2.161086082458496
Epoch: 7, Steps: 12 | Train Loss: 2.111 Vali Loss: 2.087 Vali Acc: 0.456 Test Loss: 2.087 Test Acc: 0.456
Validation loss decreased (-0.394422 --> -0.455535).  Saving model ...
Epoch: 8 cost time: 2.0692074298858643
Epoch: 8, Steps: 12 | Train Loss: 1.931 Vali Loss: 1.976 Vali Acc: 0.511 Test Loss: 1.976 Test Acc: 0.511
Validation loss decreased (-0.455535 --> -0.511091).  Saving model ...
Epoch: 9 cost time: 2.037086248397827
Epoch: 9, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.872 Vali Acc: 0.533 Test Loss: 1.872 Test Acc: 0.533
Validation loss decreased (-0.511091 --> -0.533315).  Saving model ...
Epoch: 10 cost time: 2.1171703338623047
Epoch: 10, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.774 Vali Acc: 0.556 Test Loss: 1.774 Test Acc: 0.556
Validation loss decreased (-0.533315 --> -0.555538).  Saving model ...
Epoch: 11 cost time: 2.014185667037964
Epoch: 11, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.683 Vali Acc: 0.578 Test Loss: 1.683 Test Acc: 0.578
Validation loss decreased (-0.555538 --> -0.577761).  Saving model ...
Epoch: 12 cost time: 2.0400736331939697
Epoch: 12, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.590 Vali Acc: 0.556 Test Loss: 1.590 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.04811692237854
Epoch: 13, Steps: 12 | Train Loss: 1.331 Vali Loss: 1.507 Vali Acc: 0.589 Test Loss: 1.507 Test Acc: 0.589
Validation loss decreased (-0.577761 --> -0.588874).  Saving model ...
Epoch: 14 cost time: 2.1443278789520264
Epoch: 14, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.428 Vali Acc: 0.611 Test Loss: 1.428 Test Acc: 0.611
Validation loss decreased (-0.588874 --> -0.611097).  Saving model ...
Epoch: 15 cost time: 2.0485973358154297
Epoch: 15, Steps: 12 | Train Loss: 1.188 Vali Loss: 1.353 Vali Acc: 0.622 Test Loss: 1.353 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622209).  Saving model ...
Epoch: 16 cost time: 2.0203044414520264
Epoch: 16, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.298 Vali Acc: 0.628 Test Loss: 1.298 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 17 cost time: 1.909735918045044
Epoch: 17, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.238 Vali Acc: 0.628 Test Loss: 1.238 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627765).  Saving model ...
Epoch: 18 cost time: 1.8837347030639648
Epoch: 18, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.194 Vali Acc: 0.622 Test Loss: 1.194 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9827971458435059
Epoch: 19, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.140 Vali Acc: 0.622 Test Loss: 1.140 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7799968719482422
Epoch: 20, Steps: 12 | Train Loss: 0.867 Vali Loss: 1.101 Vali Acc: 0.622 Test Loss: 1.101 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0550107955932617
Epoch: 21, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.070 Vali Acc: 0.628 Test Loss: 1.070 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627767).  Saving model ...
Epoch: 22 cost time: 2.153083324432373
Epoch: 22, Steps: 12 | Train Loss: 0.674 Vali Loss: 1.029 Vali Acc: 0.650 Test Loss: 1.029 Test Acc: 0.650
Validation loss decreased (-0.627767 --> -0.649990).  Saving model ...
Epoch: 23 cost time: 1.8932266235351562
Epoch: 23, Steps: 12 | Train Loss: 0.674 Vali Loss: 1.000 Vali Acc: 0.672 Test Loss: 1.000 Test Acc: 0.672
Validation loss decreased (-0.649990 --> -0.672212).  Saving model ...
Epoch: 24 cost time: 1.972531795501709
Epoch: 24, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.981 Vali Acc: 0.683 Test Loss: 0.981 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683324).  Saving model ...
Epoch: 25 cost time: 1.9552876949310303
Epoch: 25, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.963 Vali Acc: 0.678 Test Loss: 0.963 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9517743587493896
Epoch: 26, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.944 Vali Acc: 0.711 Test Loss: 0.944 Test Acc: 0.711
Validation loss decreased (-0.683324 --> -0.711102).  Saving model ...
Epoch: 27 cost time: 1.9519436359405518
Epoch: 27, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.934 Vali Acc: 0.683 Test Loss: 0.934 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0282866954803467
Epoch: 28, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.904 Vali Acc: 0.711 Test Loss: 0.904 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 29 cost time: 1.993513822555542
Epoch: 29, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.893 Vali Acc: 0.728 Test Loss: 0.893 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 30 cost time: 2.0618605613708496
Epoch: 30, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.882 Vali Acc: 0.694 Test Loss: 0.882 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7277777777777777
model parameter : 269631
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.043718338012695
Epoch: 1, Steps: 12 | Train Loss: 2.812 Vali Loss: 2.746 Vali Acc: 0.039 Test Loss: 2.746 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 3.1216602325439453
Epoch: 2, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.659 Vali Acc: 0.067 Test Loss: 2.659 Test Acc: 0.067
Validation loss decreased (-0.038861 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 3.0800697803497314
Epoch: 3, Steps: 12 | Train Loss: 2.623 Vali Loss: 2.547 Vali Acc: 0.128 Test Loss: 2.547 Test Acc: 0.128
Validation loss decreased (-0.066640 --> -0.127752).  Saving model ...
Epoch: 4 cost time: 3.3215301036834717
Epoch: 4, Steps: 12 | Train Loss: 2.487 Vali Loss: 2.415 Vali Acc: 0.300 Test Loss: 2.415 Test Acc: 0.300
Validation loss decreased (-0.127752 --> -0.299976).  Saving model ...
Epoch: 5 cost time: 3.2461154460906982
Epoch: 5, Steps: 12 | Train Loss: 2.369 Vali Loss: 2.270 Vali Acc: 0.444 Test Loss: 2.270 Test Acc: 0.444
Validation loss decreased (-0.299976 --> -0.444422).  Saving model ...
Epoch: 6 cost time: 3.1139960289001465
Epoch: 6, Steps: 12 | Train Loss: 2.155 Vali Loss: 2.115 Vali Acc: 0.500 Test Loss: 2.115 Test Acc: 0.500
Validation loss decreased (-0.444422 --> -0.499979).  Saving model ...
Epoch: 7 cost time: 3.0876588821411133
Epoch: 7, Steps: 12 | Train Loss: 1.964 Vali Loss: 1.953 Vali Acc: 0.544 Test Loss: 1.953 Test Acc: 0.544
Validation loss decreased (-0.499979 --> -0.544425).  Saving model ...
Epoch: 8 cost time: 3.0983283519744873
Epoch: 8, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.795 Vali Acc: 0.561 Test Loss: 1.795 Test Acc: 0.561
Validation loss decreased (-0.544425 --> -0.561093).  Saving model ...
Epoch: 9 cost time: 2.7267234325408936
Epoch: 9, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.651 Vali Acc: 0.556 Test Loss: 1.651 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.714852809906006
Epoch: 10, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.518 Vali Acc: 0.578 Test Loss: 1.518 Test Acc: 0.578
Validation loss decreased (-0.561093 --> -0.577763).  Saving model ...
Epoch: 11 cost time: 3.31815242767334
Epoch: 11, Steps: 12 | Train Loss: 1.335 Vali Loss: 1.402 Vali Acc: 0.606 Test Loss: 1.402 Test Acc: 0.606
Validation loss decreased (-0.577763 --> -0.605542).  Saving model ...
Epoch: 12 cost time: 3.1044600009918213
Epoch: 12, Steps: 12 | Train Loss: 1.219 Vali Loss: 1.309 Vali Acc: 0.589 Test Loss: 1.309 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0853137969970703
Epoch: 13, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.228 Vali Acc: 0.594 Test Loss: 1.228 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.112330436706543
Epoch: 14, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.156 Vali Acc: 0.611 Test Loss: 1.156 Test Acc: 0.611
Validation loss decreased (-0.605542 --> -0.611100).  Saving model ...
Epoch: 15 cost time: 3.160013437271118
Epoch: 15, Steps: 12 | Train Loss: 0.969 Vali Loss: 1.083 Vali Acc: 0.639 Test Loss: 1.083 Test Acc: 0.639
Validation loss decreased (-0.611100 --> -0.638878).  Saving model ...
Epoch: 16 cost time: 3.1998162269592285
Epoch: 16, Steps: 12 | Train Loss: 0.914 Vali Loss: 1.037 Vali Acc: 0.644 Test Loss: 1.037 Test Acc: 0.644
Validation loss decreased (-0.638878 --> -0.644434).  Saving model ...
Epoch: 17 cost time: 2.9263460636138916
Epoch: 17, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.999 Vali Acc: 0.661 Test Loss: 0.999 Test Acc: 0.661
Validation loss decreased (-0.644434 --> -0.661101).  Saving model ...
Epoch: 18 cost time: 3.0075747966766357
Epoch: 18, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.936 Vali Acc: 0.672 Test Loss: 0.936 Test Acc: 0.672
Validation loss decreased (-0.661101 --> -0.672213).  Saving model ...
Epoch: 19 cost time: 3.1110196113586426
Epoch: 19, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.902 Vali Acc: 0.689 Test Loss: 0.902 Test Acc: 0.689
Validation loss decreased (-0.672213 --> -0.688880).  Saving model ...
Epoch: 20 cost time: 3.0063817501068115
Epoch: 20, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.879 Vali Acc: 0.722 Test Loss: 0.879 Test Acc: 0.722
Validation loss decreased (-0.688880 --> -0.722213).  Saving model ...
Epoch: 21 cost time: 3.212661027908325
Epoch: 21, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.846 Vali Acc: 0.717 Test Loss: 0.846 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.9572465419769287
Epoch: 22, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.818 Vali Acc: 0.711 Test Loss: 0.818 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.186110734939575
Epoch: 23, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.789 Vali Acc: 0.700 Test Loss: 0.789 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.110914468765259
Epoch: 24, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.776 Vali Acc: 0.717 Test Loss: 0.776 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.169149398803711
Epoch: 25, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.748 Vali Acc: 0.717 Test Loss: 0.748 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.2327113151550293
Epoch: 26, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.732 Vali Acc: 0.739 Test Loss: 0.732 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738882).  Saving model ...
Epoch: 27 cost time: 3.003831624984741
Epoch: 27, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.730 Vali Acc: 0.728 Test Loss: 0.730 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3751919269561768
Epoch: 28, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.716 Vali Acc: 0.739 Test Loss: 0.716 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738882).  Saving model ...
Epoch: 29 cost time: 3.1273889541625977
Epoch: 29, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749993).  Saving model ...
Epoch: 30 cost time: 3.21067214012146
Epoch: 30, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.678 Vali Acc: 0.767 Test Loss: 0.678 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 450879
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.063827276229858
Epoch: 1, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.704 Vali Acc: 0.100 Test Loss: 2.704 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 2.4012131690979004
Epoch: 2, Steps: 12 | Train Loss: 2.645 Vali Loss: 2.633 Vali Acc: 0.122 Test Loss: 2.633 Test Acc: 0.122
Validation loss decreased (-0.099973 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 2.6059296131134033
Epoch: 3, Steps: 12 | Train Loss: 2.547 Vali Loss: 2.537 Vali Acc: 0.256 Test Loss: 2.537 Test Acc: 0.256
Validation loss decreased (-0.122196 --> -0.255530).  Saving model ...
Epoch: 4 cost time: 2.4555301666259766
Epoch: 4, Steps: 12 | Train Loss: 2.433 Vali Loss: 2.434 Vali Acc: 0.322 Test Loss: 2.434 Test Acc: 0.322
Validation loss decreased (-0.255530 --> -0.322198).  Saving model ...
Epoch: 5 cost time: 2.6866490840911865
Epoch: 5, Steps: 12 | Train Loss: 2.345 Vali Loss: 2.323 Vali Acc: 0.417 Test Loss: 2.323 Test Acc: 0.417
Validation loss decreased (-0.322198 --> -0.416643).  Saving model ...
Epoch: 6 cost time: 2.53817081451416
Epoch: 6, Steps: 12 | Train Loss: 2.169 Vali Loss: 2.200 Vali Acc: 0.456 Test Loss: 2.200 Test Acc: 0.456
Validation loss decreased (-0.416643 --> -0.455534).  Saving model ...
Epoch: 7 cost time: 2.4530463218688965
Epoch: 7, Steps: 12 | Train Loss: 2.086 Vali Loss: 2.074 Vali Acc: 0.450 Test Loss: 2.074 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.611050844192505
Epoch: 8, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.936 Vali Acc: 0.461 Test Loss: 1.936 Test Acc: 0.461
Validation loss decreased (-0.455534 --> -0.461092).  Saving model ...
Epoch: 9 cost time: 2.3992114067077637
Epoch: 9, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.804 Vali Acc: 0.489 Test Loss: 1.804 Test Acc: 0.489
Validation loss decreased (-0.461092 --> -0.488871).  Saving model ...
Epoch: 10 cost time: 2.5115225315093994
Epoch: 10, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.680 Vali Acc: 0.528 Test Loss: 1.680 Test Acc: 0.528
Validation loss decreased (-0.488871 --> -0.527761).  Saving model ...
Epoch: 11 cost time: 2.6164870262145996
Epoch: 11, Steps: 12 | Train Loss: 1.421 Vali Loss: 1.563 Vali Acc: 0.533 Test Loss: 1.563 Test Acc: 0.533
Validation loss decreased (-0.527761 --> -0.533318).  Saving model ...
Epoch: 12 cost time: 2.489258050918579
Epoch: 12, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.450 Vali Acc: 0.539 Test Loss: 1.450 Test Acc: 0.539
Validation loss decreased (-0.533318 --> -0.538874).  Saving model ...
Epoch: 13 cost time: 2.710916519165039
Epoch: 13, Steps: 12 | Train Loss: 1.177 Vali Loss: 1.358 Vali Acc: 0.561 Test Loss: 1.358 Test Acc: 0.561
Validation loss decreased (-0.538874 --> -0.561098).  Saving model ...
Epoch: 14 cost time: 2.476266860961914
Epoch: 14, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.282 Vali Acc: 0.617 Test Loss: 1.282 Test Acc: 0.617
Validation loss decreased (-0.561098 --> -0.616654).  Saving model ...
Epoch: 15 cost time: 2.5295588970184326
Epoch: 15, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.214 Vali Acc: 0.617 Test Loss: 1.214 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616655).  Saving model ...
Epoch: 16 cost time: 2.6794207096099854
Epoch: 16, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.153 Vali Acc: 0.628 Test Loss: 1.153 Test Acc: 0.628
Validation loss decreased (-0.616655 --> -0.627766).  Saving model ...
Epoch: 17 cost time: 2.4709267616271973
Epoch: 17, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.094 Vali Acc: 0.628 Test Loss: 1.094 Test Acc: 0.628
Validation loss decreased (-0.627766 --> -0.627767).  Saving model ...
Epoch: 18 cost time: 2.611386775970459
Epoch: 18, Steps: 12 | Train Loss: 0.794 Vali Loss: 1.050 Vali Acc: 0.639 Test Loss: 1.050 Test Acc: 0.639
Validation loss decreased (-0.627767 --> -0.638878).  Saving model ...
Epoch: 19 cost time: 2.407865285873413
Epoch: 19, Steps: 12 | Train Loss: 0.778 Vali Loss: 1.013 Vali Acc: 0.644 Test Loss: 1.013 Test Acc: 0.644
Validation loss decreased (-0.638878 --> -0.644434).  Saving model ...
Epoch: 20 cost time: 2.322636365890503
Epoch: 20, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.974 Vali Acc: 0.650 Test Loss: 0.974 Test Acc: 0.650
Validation loss decreased (-0.644434 --> -0.649990).  Saving model ...
Epoch: 21 cost time: 2.7349584102630615
Epoch: 21, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.941 Vali Acc: 0.672 Test Loss: 0.941 Test Acc: 0.672
Validation loss decreased (-0.649990 --> -0.672213).  Saving model ...
Epoch: 22 cost time: 2.4873428344726562
Epoch: 22, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.912 Vali Acc: 0.694 Test Loss: 0.912 Test Acc: 0.694
Validation loss decreased (-0.672213 --> -0.694435).  Saving model ...
Epoch: 23 cost time: 2.6074674129486084
Epoch: 23, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.880 Vali Acc: 0.706 Test Loss: 0.880 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705547).  Saving model ...
Epoch: 24 cost time: 2.339484453201294
Epoch: 24, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.850 Vali Acc: 0.728 Test Loss: 0.850 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727769).  Saving model ...
Epoch: 25 cost time: 2.3042194843292236
Epoch: 25, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.836 Vali Acc: 0.733 Test Loss: 0.836 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 26 cost time: 2.630200147628784
Epoch: 26, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.834 Vali Acc: 0.711 Test Loss: 0.834 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.428842544555664
Epoch: 27, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.816 Vali Acc: 0.722 Test Loss: 0.816 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.632690668106079
Epoch: 28, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 29 cost time: 2.31487774848938
Epoch: 29, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.792 Vali Acc: 0.728 Test Loss: 0.792 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.3387463092803955
Epoch: 30, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.779 Vali Acc: 0.750 Test Loss: 0.779 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 140415
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.5540080070495605
Epoch: 1, Steps: 12 | Train Loss: 2.812 Vali Loss: 2.746 Vali Acc: 0.039 Test Loss: 2.746 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 2.449352741241455
Epoch: 2, Steps: 12 | Train Loss: 2.753 Vali Loss: 2.659 Vali Acc: 0.067 Test Loss: 2.659 Test Acc: 0.067
Validation loss decreased (-0.038861 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 2.5729408264160156
Epoch: 3, Steps: 12 | Train Loss: 2.624 Vali Loss: 2.548 Vali Acc: 0.128 Test Loss: 2.548 Test Acc: 0.128
Validation loss decreased (-0.066640 --> -0.127752).  Saving model ...
Epoch: 4 cost time: 2.7725400924682617
Epoch: 4, Steps: 12 | Train Loss: 2.487 Vali Loss: 2.416 Vali Acc: 0.300 Test Loss: 2.416 Test Acc: 0.300
Validation loss decreased (-0.127752 --> -0.299976).  Saving model ...
Epoch: 5 cost time: 2.4963014125823975
Epoch: 5, Steps: 12 | Train Loss: 2.371 Vali Loss: 2.270 Vali Acc: 0.444 Test Loss: 2.270 Test Acc: 0.444
Validation loss decreased (-0.299976 --> -0.444422).  Saving model ...
Epoch: 6 cost time: 2.4969589710235596
Epoch: 6, Steps: 12 | Train Loss: 2.155 Vali Loss: 2.115 Vali Acc: 0.500 Test Loss: 2.115 Test Acc: 0.500
Validation loss decreased (-0.444422 --> -0.499979).  Saving model ...
Epoch: 7 cost time: 2.18005633354187
Epoch: 7, Steps: 12 | Train Loss: 1.963 Vali Loss: 1.953 Vali Acc: 0.544 Test Loss: 1.953 Test Acc: 0.544
Validation loss decreased (-0.499979 --> -0.544425).  Saving model ...
Epoch: 8 cost time: 2.2612569332122803
Epoch: 8, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.795 Vali Acc: 0.561 Test Loss: 1.795 Test Acc: 0.561
Validation loss decreased (-0.544425 --> -0.561093).  Saving model ...
Epoch: 9 cost time: 2.846940279006958
Epoch: 9, Steps: 12 | Train Loss: 1.680 Vali Loss: 1.650 Vali Acc: 0.556 Test Loss: 1.650 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.859091281890869
Epoch: 10, Steps: 12 | Train Loss: 1.461 Vali Loss: 1.517 Vali Acc: 0.578 Test Loss: 1.517 Test Acc: 0.578
Validation loss decreased (-0.561093 --> -0.577763).  Saving model ...
Epoch: 11 cost time: 2.773822069168091
Epoch: 11, Steps: 12 | Train Loss: 1.335 Vali Loss: 1.401 Vali Acc: 0.606 Test Loss: 1.401 Test Acc: 0.606
Validation loss decreased (-0.577763 --> -0.605542).  Saving model ...
Epoch: 12 cost time: 2.6781227588653564
Epoch: 12, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.309 Vali Acc: 0.583 Test Loss: 1.309 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9811997413635254
Epoch: 13, Steps: 12 | Train Loss: 1.114 Vali Loss: 1.231 Vali Acc: 0.594 Test Loss: 1.231 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7179758548736572
Epoch: 14, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.157 Vali Acc: 0.617 Test Loss: 1.157 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616655).  Saving model ...
Epoch: 15 cost time: 2.7665443420410156
Epoch: 15, Steps: 12 | Train Loss: 0.974 Vali Loss: 1.084 Vali Acc: 0.633 Test Loss: 1.084 Test Acc: 0.633
Validation loss decreased (-0.616655 --> -0.633322).  Saving model ...
Epoch: 16 cost time: 2.3823084831237793
Epoch: 16, Steps: 12 | Train Loss: 0.913 Vali Loss: 1.038 Vali Acc: 0.644 Test Loss: 1.038 Test Acc: 0.644
Validation loss decreased (-0.633322 --> -0.644434).  Saving model ...
Epoch: 17 cost time: 2.9891865253448486
Epoch: 17, Steps: 12 | Train Loss: 0.809 Vali Loss: 1.000 Vali Acc: 0.661 Test Loss: 1.000 Test Acc: 0.661
Validation loss decreased (-0.644434 --> -0.661101).  Saving model ...
Epoch: 18 cost time: 2.898651361465454
Epoch: 18, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.938 Vali Acc: 0.678 Test Loss: 0.938 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677768).  Saving model ...
Epoch: 19 cost time: 2.6605608463287354
Epoch: 19, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.903 Vali Acc: 0.700 Test Loss: 0.903 Test Acc: 0.700
Validation loss decreased (-0.677768 --> -0.699991).  Saving model ...
Epoch: 20 cost time: 2.501413345336914
Epoch: 20, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.875 Vali Acc: 0.706 Test Loss: 0.875 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705547).  Saving model ...
Epoch: 21 cost time: 2.9140615463256836
Epoch: 21, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.841 Vali Acc: 0.733 Test Loss: 0.841 Test Acc: 0.733
Validation loss decreased (-0.705547 --> -0.733325).  Saving model ...
Epoch: 22 cost time: 3.058607339859009
Epoch: 22, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.812 Vali Acc: 0.717 Test Loss: 0.812 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5454726219177246
Epoch: 23, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.781 Vali Acc: 0.722 Test Loss: 0.781 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.8383092880249023
Epoch: 24, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.763 Vali Acc: 0.717 Test Loss: 0.763 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.9821629524230957
Epoch: 25, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.739 Vali Acc: 0.722 Test Loss: 0.739 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.901515483856201
Epoch: 26, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.725 Vali Acc: 0.756 Test Loss: 0.725 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755548).  Saving model ...
Epoch: 27 cost time: 2.842912197113037
Epoch: 27, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.721 Vali Acc: 0.739 Test Loss: 0.721 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9607114791870117
Epoch: 28, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.705 Vali Acc: 0.739 Test Loss: 0.705 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.9399678707122803
Epoch: 29, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.686 Vali Acc: 0.756 Test Loss: 0.686 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755549).  Saving model ...
Epoch: 30 cost time: 2.6233668327331543
Epoch: 30, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.680 Vali Acc: 0.778 Test Loss: 0.680 Test Acc: 0.778
Validation loss decreased (-0.755549 --> -0.777771).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 450879
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.494636058807373
Epoch: 1, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.702 Vali Acc: 0.100 Test Loss: 2.702 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 2.3106849193573
Epoch: 2, Steps: 12 | Train Loss: 2.645 Vali Loss: 2.632 Vali Acc: 0.122 Test Loss: 2.632 Test Acc: 0.122
Validation loss decreased (-0.099973 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 2.542005777359009
Epoch: 3, Steps: 12 | Train Loss: 2.548 Vali Loss: 2.536 Vali Acc: 0.256 Test Loss: 2.536 Test Acc: 0.256
Validation loss decreased (-0.122196 --> -0.255530).  Saving model ...
Epoch: 4 cost time: 2.6597769260406494
Epoch: 4, Steps: 12 | Train Loss: 2.434 Vali Loss: 2.433 Vali Acc: 0.322 Test Loss: 2.433 Test Acc: 0.322
Validation loss decreased (-0.255530 --> -0.322198).  Saving model ...
Epoch: 5 cost time: 2.4731087684631348
Epoch: 5, Steps: 12 | Train Loss: 2.345 Vali Loss: 2.321 Vali Acc: 0.417 Test Loss: 2.321 Test Acc: 0.417
Validation loss decreased (-0.322198 --> -0.416643).  Saving model ...
Epoch: 6 cost time: 2.4213781356811523
Epoch: 6, Steps: 12 | Train Loss: 2.170 Vali Loss: 2.199 Vali Acc: 0.456 Test Loss: 2.199 Test Acc: 0.456
Validation loss decreased (-0.416643 --> -0.455534).  Saving model ...
Epoch: 7 cost time: 2.5733370780944824
Epoch: 7, Steps: 12 | Train Loss: 2.087 Vali Loss: 2.073 Vali Acc: 0.450 Test Loss: 2.073 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.587311267852783
Epoch: 8, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.935 Vali Acc: 0.461 Test Loss: 1.935 Test Acc: 0.461
Validation loss decreased (-0.455534 --> -0.461092).  Saving model ...
Epoch: 9 cost time: 2.4933574199676514
Epoch: 9, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.804 Vali Acc: 0.489 Test Loss: 1.804 Test Acc: 0.489
Validation loss decreased (-0.461092 --> -0.488871).  Saving model ...
Epoch: 10 cost time: 2.4528555870056152
Epoch: 10, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.679 Vali Acc: 0.533 Test Loss: 1.679 Test Acc: 0.533
Validation loss decreased (-0.488871 --> -0.533317).  Saving model ...
Epoch: 11 cost time: 2.494241714477539
Epoch: 11, Steps: 12 | Train Loss: 1.421 Vali Loss: 1.563 Vali Acc: 0.539 Test Loss: 1.563 Test Acc: 0.539
Validation loss decreased (-0.533317 --> -0.538873).  Saving model ...
Epoch: 12 cost time: 2.5522732734680176
Epoch: 12, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.451 Vali Acc: 0.539 Test Loss: 1.451 Test Acc: 0.539
Validation loss decreased (-0.538873 --> -0.538874).  Saving model ...
Epoch: 13 cost time: 2.3900980949401855
Epoch: 13, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.360 Vali Acc: 0.561 Test Loss: 1.360 Test Acc: 0.561
Validation loss decreased (-0.538874 --> -0.561098).  Saving model ...
Epoch: 14 cost time: 2.4423327445983887
Epoch: 14, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.284 Vali Acc: 0.617 Test Loss: 1.284 Test Acc: 0.617
Validation loss decreased (-0.561098 --> -0.616654).  Saving model ...
Epoch: 15 cost time: 2.530938148498535
Epoch: 15, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.216 Vali Acc: 0.611 Test Loss: 1.216 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5806562900543213
Epoch: 16, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.155 Vali Acc: 0.628 Test Loss: 1.155 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627766).  Saving model ...
Epoch: 17 cost time: 2.282233238220215
Epoch: 17, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.093 Vali Acc: 0.633 Test Loss: 1.093 Test Acc: 0.633
Validation loss decreased (-0.627766 --> -0.633322).  Saving model ...
Epoch: 18 cost time: 2.402068853378296
Epoch: 18, Steps: 12 | Train Loss: 0.797 Vali Loss: 1.048 Vali Acc: 0.644 Test Loss: 1.048 Test Acc: 0.644
Validation loss decreased (-0.633322 --> -0.644434).  Saving model ...
Epoch: 19 cost time: 2.571643829345703
Epoch: 19, Steps: 12 | Train Loss: 0.783 Vali Loss: 1.011 Vali Acc: 0.650 Test Loss: 1.011 Test Acc: 0.650
Validation loss decreased (-0.644434 --> -0.649990).  Saving model ...
Epoch: 20 cost time: 2.462993860244751
Epoch: 20, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.970 Vali Acc: 0.661 Test Loss: 0.970 Test Acc: 0.661
Validation loss decreased (-0.649990 --> -0.661101).  Saving model ...
Epoch: 21 cost time: 2.321117639541626
Epoch: 21, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.935 Vali Acc: 0.667 Test Loss: 0.935 Test Acc: 0.667
Validation loss decreased (-0.661101 --> -0.666657).  Saving model ...
Epoch: 22 cost time: 2.4929795265197754
Epoch: 22, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.905 Vali Acc: 0.694 Test Loss: 0.905 Test Acc: 0.694
Validation loss decreased (-0.666657 --> -0.694435).  Saving model ...
Epoch: 23 cost time: 2.477273941040039
Epoch: 23, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.876 Vali Acc: 0.700 Test Loss: 0.876 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 24 cost time: 2.2975244522094727
Epoch: 24, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.843 Vali Acc: 0.744 Test Loss: 0.843 Test Acc: 0.744
Validation loss decreased (-0.699991 --> -0.744436).  Saving model ...
Epoch: 25 cost time: 2.4133293628692627
Epoch: 25, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.830 Vali Acc: 0.744 Test Loss: 0.830 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 26 cost time: 2.496584177017212
Epoch: 26, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.827 Vali Acc: 0.722 Test Loss: 0.827 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.565185070037842
Epoch: 27, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.803 Vali Acc: 0.722 Test Loss: 0.803 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2487618923187256
Epoch: 28, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.772 Vali Acc: 0.761 Test Loss: 0.772 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 29 cost time: 2.3798131942749023
Epoch: 29, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.780 Vali Acc: 0.733 Test Loss: 0.780 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.574467182159424
Epoch: 30, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.765 Vali Acc: 0.739 Test Loss: 0.765 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 140415
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.240653991699219
Epoch: 1, Steps: 12 | Train Loss: 2.811 Vali Loss: 2.747 Vali Acc: 0.039 Test Loss: 2.747 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 2.3201489448547363
Epoch: 2, Steps: 12 | Train Loss: 2.759 Vali Loss: 2.668 Vali Acc: 0.067 Test Loss: 2.668 Test Acc: 0.067
Validation loss decreased (-0.038861 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 1.9445850849151611
Epoch: 3, Steps: 12 | Train Loss: 2.638 Vali Loss: 2.569 Vali Acc: 0.117 Test Loss: 2.569 Test Acc: 0.117
Validation loss decreased (-0.066640 --> -0.116641).  Saving model ...
Epoch: 4 cost time: 2.111372709274292
Epoch: 4, Steps: 12 | Train Loss: 2.514 Vali Loss: 2.453 Vali Acc: 0.256 Test Loss: 2.453 Test Acc: 0.256
Validation loss decreased (-0.116641 --> -0.255531).  Saving model ...
Epoch: 5 cost time: 2.191800594329834
Epoch: 5, Steps: 12 | Train Loss: 2.426 Vali Loss: 2.328 Vali Acc: 0.378 Test Loss: 2.328 Test Acc: 0.378
Validation loss decreased (-0.255531 --> -0.377754).  Saving model ...
Epoch: 6 cost time: 2.0711960792541504
Epoch: 6, Steps: 12 | Train Loss: 2.226 Vali Loss: 2.200 Vali Acc: 0.439 Test Loss: 2.200 Test Acc: 0.439
Validation loss decreased (-0.377754 --> -0.438867).  Saving model ...
Epoch: 7 cost time: 1.979970932006836
Epoch: 7, Steps: 12 | Train Loss: 2.067 Vali Loss: 2.070 Vali Acc: 0.506 Test Loss: 2.070 Test Acc: 0.506
Validation loss decreased (-0.438867 --> -0.505535).  Saving model ...
Epoch: 8 cost time: 2.005511522293091
Epoch: 8, Steps: 12 | Train Loss: 1.935 Vali Loss: 1.941 Vali Acc: 0.528 Test Loss: 1.941 Test Acc: 0.528
Validation loss decreased (-0.505535 --> -0.527758).  Saving model ...
Epoch: 9 cost time: 2.2530031204223633
Epoch: 9, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.816 Vali Acc: 0.528 Test Loss: 1.816 Test Acc: 0.528
Validation loss decreased (-0.527758 --> -0.527760).  Saving model ...
Epoch: 10 cost time: 2.171119451522827
Epoch: 10, Steps: 12 | Train Loss: 1.636 Vali Loss: 1.703 Vali Acc: 0.533 Test Loss: 1.703 Test Acc: 0.533
Validation loss decreased (-0.527760 --> -0.533316).  Saving model ...
Epoch: 11 cost time: 2.107675790786743
Epoch: 11, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.600 Vali Acc: 0.578 Test Loss: 1.600 Test Acc: 0.578
Validation loss decreased (-0.533316 --> -0.577762).  Saving model ...
Epoch: 12 cost time: 2.0614712238311768
Epoch: 12, Steps: 12 | Train Loss: 1.430 Vali Loss: 1.510 Vali Acc: 0.600 Test Loss: 1.510 Test Acc: 0.600
Validation loss decreased (-0.577762 --> -0.599985).  Saving model ...
Epoch: 13 cost time: 2.2244670391082764
Epoch: 13, Steps: 12 | Train Loss: 1.331 Vali Loss: 1.425 Vali Acc: 0.594 Test Loss: 1.425 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1694304943084717
Epoch: 14, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.347 Vali Acc: 0.589 Test Loss: 1.347 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.019317150115967
Epoch: 15, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.267 Vali Acc: 0.622 Test Loss: 1.267 Test Acc: 0.622
Validation loss decreased (-0.599985 --> -0.622210).  Saving model ...
Epoch: 16 cost time: 1.9529390335083008
Epoch: 16, Steps: 12 | Train Loss: 1.104 Vali Loss: 1.212 Vali Acc: 0.633 Test Loss: 1.212 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633321).  Saving model ...
Epoch: 17 cost time: 1.9473764896392822
Epoch: 17, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.163 Vali Acc: 0.661 Test Loss: 1.163 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661099).  Saving model ...
Epoch: 18 cost time: 1.7496490478515625
Epoch: 18, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.087 Vali Acc: 0.678 Test Loss: 1.087 Test Acc: 0.678
Validation loss decreased (-0.661099 --> -0.677767).  Saving model ...
Epoch: 19 cost time: 1.745192527770996
Epoch: 19, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.043 Vali Acc: 0.689 Test Loss: 1.043 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688878).  Saving model ...
Epoch: 20 cost time: 1.7371361255645752
Epoch: 20, Steps: 12 | Train Loss: 0.777 Vali Loss: 1.016 Vali Acc: 0.700 Test Loss: 1.016 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 21 cost time: 1.9592626094818115
Epoch: 21, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.976 Vali Acc: 0.694 Test Loss: 0.976 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.638744592666626
Epoch: 22, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.927 Vali Acc: 0.717 Test Loss: 0.927 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716657).  Saving model ...
Epoch: 23 cost time: 2.0912792682647705
Epoch: 23, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.888 Vali Acc: 0.711 Test Loss: 0.888 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0431723594665527
Epoch: 24, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.865 Vali Acc: 0.706 Test Loss: 0.865 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.470348596572876
Epoch: 25, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.843 Vali Acc: 0.706 Test Loss: 0.843 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2288458347320557
Epoch: 26, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.814 Vali Acc: 0.728 Test Loss: 0.814 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727770).  Saving model ...
Epoch: 27 cost time: 2.086252450942993
Epoch: 27, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.801 Vali Acc: 0.739 Test Loss: 0.801 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738881).  Saving model ...
Epoch: 28 cost time: 2.076798439025879
Epoch: 28, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.785 Vali Acc: 0.756 Test Loss: 0.785 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755548).  Saving model ...
Epoch: 29 cost time: 2.1785411834716797
Epoch: 29, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.767 Vali Acc: 0.739 Test Loss: 0.767 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.2515275478363037
Epoch: 30, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.751 Vali Acc: 0.756 Test Loss: 0.751 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 450879
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.391791820526123
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.702 Vali Acc: 0.100 Test Loss: 2.702 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 2.0064563751220703
Epoch: 2, Steps: 12 | Train Loss: 2.645 Vali Loss: 2.638 Vali Acc: 0.128 Test Loss: 2.638 Test Acc: 0.128
Validation loss decreased (-0.099973 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 1.7992827892303467
Epoch: 3, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.551 Vali Acc: 0.228 Test Loss: 2.551 Test Acc: 0.228
Validation loss decreased (-0.127751 --> -0.227752).  Saving model ...
Epoch: 4 cost time: 2.025578022003174
Epoch: 4, Steps: 12 | Train Loss: 2.451 Vali Loss: 2.457 Vali Acc: 0.300 Test Loss: 2.457 Test Acc: 0.300
Validation loss decreased (-0.227752 --> -0.299975).  Saving model ...
Epoch: 5 cost time: 1.8550572395324707
Epoch: 5, Steps: 12 | Train Loss: 2.372 Vali Loss: 2.357 Vali Acc: 0.356 Test Loss: 2.357 Test Acc: 0.356
Validation loss decreased (-0.299975 --> -0.355532).  Saving model ...
Epoch: 6 cost time: 1.7257318496704102
Epoch: 6, Steps: 12 | Train Loss: 2.214 Vali Loss: 2.249 Vali Acc: 0.406 Test Loss: 2.249 Test Acc: 0.406
Validation loss decreased (-0.355532 --> -0.405533).  Saving model ...
Epoch: 7 cost time: 1.9716413021087646
Epoch: 7, Steps: 12 | Train Loss: 2.154 Vali Loss: 2.144 Vali Acc: 0.406 Test Loss: 2.144 Test Acc: 0.406
Validation loss decreased (-0.405533 --> -0.405534).  Saving model ...
Epoch: 8 cost time: 1.8681905269622803
Epoch: 8, Steps: 12 | Train Loss: 1.982 Vali Loss: 2.028 Vali Acc: 0.444 Test Loss: 2.028 Test Acc: 0.444
Validation loss decreased (-0.405534 --> -0.444424).  Saving model ...
Epoch: 9 cost time: 2.061553478240967
Epoch: 9, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.918 Vali Acc: 0.472 Test Loss: 1.918 Test Acc: 0.472
Validation loss decreased (-0.444424 --> -0.472203).  Saving model ...
Epoch: 10 cost time: 1.7214076519012451
Epoch: 10, Steps: 12 | Train Loss: 1.739 Vali Loss: 1.814 Vali Acc: 0.506 Test Loss: 1.814 Test Acc: 0.506
Validation loss decreased (-0.472203 --> -0.505537).  Saving model ...
Epoch: 11 cost time: 1.9089694023132324
Epoch: 11, Steps: 12 | Train Loss: 1.565 Vali Loss: 1.713 Vali Acc: 0.517 Test Loss: 1.713 Test Acc: 0.517
Validation loss decreased (-0.505537 --> -0.516650).  Saving model ...
Epoch: 12 cost time: 1.7558307647705078
Epoch: 12, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.614 Vali Acc: 0.517 Test Loss: 1.614 Test Acc: 0.517
Validation loss decreased (-0.516650 --> -0.516651).  Saving model ...
Epoch: 13 cost time: 1.9305126667022705
Epoch: 13, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.530 Vali Acc: 0.528 Test Loss: 1.530 Test Acc: 0.528
Validation loss decreased (-0.516651 --> -0.527762).  Saving model ...
Epoch: 14 cost time: 1.9496073722839355
Epoch: 14, Steps: 12 | Train Loss: 1.209 Vali Loss: 1.456 Vali Acc: 0.561 Test Loss: 1.456 Test Acc: 0.561
Validation loss decreased (-0.527762 --> -0.561097).  Saving model ...
Epoch: 15 cost time: 1.7847285270690918
Epoch: 15, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.389 Vali Acc: 0.578 Test Loss: 1.389 Test Acc: 0.578
Validation loss decreased (-0.561097 --> -0.577764).  Saving model ...
Epoch: 16 cost time: 1.9296090602874756
Epoch: 16, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.332 Vali Acc: 0.594 Test Loss: 1.332 Test Acc: 0.594
Validation loss decreased (-0.577764 --> -0.594431).  Saving model ...
Epoch: 17 cost time: 1.7399404048919678
Epoch: 17, Steps: 12 | Train Loss: 1.042 Vali Loss: 1.274 Vali Acc: 0.606 Test Loss: 1.274 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605543).  Saving model ...
Epoch: 18 cost time: 2.0082361698150635
Epoch: 18, Steps: 12 | Train Loss: 0.958 Vali Loss: 1.229 Vali Acc: 0.617 Test Loss: 1.229 Test Acc: 0.617
Validation loss decreased (-0.605543 --> -0.616654).  Saving model ...
Epoch: 19 cost time: 1.7899632453918457
Epoch: 19, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.192 Vali Acc: 0.617 Test Loss: 1.192 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616655).  Saving model ...
Epoch: 20 cost time: 1.996624231338501
Epoch: 20, Steps: 12 | Train Loss: 0.894 Vali Loss: 1.150 Vali Acc: 0.622 Test Loss: 1.150 Test Acc: 0.622
Validation loss decreased (-0.616655 --> -0.622211).  Saving model ...
Epoch: 21 cost time: 1.8720901012420654
Epoch: 21, Steps: 12 | Train Loss: 0.806 Vali Loss: 1.104 Vali Acc: 0.622 Test Loss: 1.104 Test Acc: 0.622
Validation loss decreased (-0.622211 --> -0.622211).  Saving model ...
Epoch: 22 cost time: 1.724097490310669
Epoch: 22, Steps: 12 | Train Loss: 0.759 Vali Loss: 1.076 Vali Acc: 0.617 Test Loss: 1.076 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9494688510894775
Epoch: 23, Steps: 12 | Train Loss: 0.696 Vali Loss: 1.052 Vali Acc: 0.628 Test Loss: 1.052 Test Acc: 0.628
Validation loss decreased (-0.622211 --> -0.627767).  Saving model ...
Epoch: 24 cost time: 1.785027027130127
Epoch: 24, Steps: 12 | Train Loss: 0.675 Vali Loss: 1.023 Vali Acc: 0.644 Test Loss: 1.023 Test Acc: 0.644
Validation loss decreased (-0.627767 --> -0.644434).  Saving model ...
Epoch: 25 cost time: 2.129019021987915
Epoch: 25, Steps: 12 | Train Loss: 0.630 Vali Loss: 1.016 Vali Acc: 0.644 Test Loss: 1.016 Test Acc: 0.644
Validation loss decreased (-0.644434 --> -0.644434).  Saving model ...
Epoch: 26 cost time: 1.8359317779541016
Epoch: 26, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.995 Vali Acc: 0.667 Test Loss: 0.995 Test Acc: 0.667
Validation loss decreased (-0.644434 --> -0.666657).  Saving model ...
Epoch: 27 cost time: 2.06923508644104
Epoch: 27, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.976 Vali Acc: 0.656 Test Loss: 0.976 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7469465732574463
Epoch: 28, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.956 Vali Acc: 0.656 Test Loss: 0.956 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7710638046264648
Epoch: 29, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.944 Vali Acc: 0.656 Test Loss: 0.944 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9150447845458984
Epoch: 30, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.931 Vali Acc: 0.672 Test Loss: 0.931 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672213).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6722222222222223
model parameter : 140415
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.4161906242370605
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.724 Vali Acc: 0.100 Test Loss: 2.724 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 3.3298380374908447
Epoch: 2, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.653 Vali Acc: 0.128 Test Loss: 2.653 Test Acc: 0.128
Validation loss decreased (-0.099973 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 3.7220020294189453
Epoch: 3, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.560 Vali Acc: 0.189 Test Loss: 2.560 Test Acc: 0.189
Validation loss decreased (-0.127751 --> -0.188863).  Saving model ...
Epoch: 4 cost time: 3.55556058883667
Epoch: 4, Steps: 12 | Train Loss: 2.486 Vali Loss: 2.452 Vali Acc: 0.228 Test Loss: 2.452 Test Acc: 0.228
Validation loss decreased (-0.188863 --> -0.227753).  Saving model ...
Epoch: 5 cost time: 3.3130416870117188
Epoch: 5, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.333 Vali Acc: 0.317 Test Loss: 2.333 Test Acc: 0.317
Validation loss decreased (-0.227753 --> -0.316643).  Saving model ...
Epoch: 6 cost time: 3.6916263103485107
Epoch: 6, Steps: 12 | Train Loss: 2.239 Vali Loss: 2.208 Vali Acc: 0.389 Test Loss: 2.208 Test Acc: 0.389
Validation loss decreased (-0.316643 --> -0.388867).  Saving model ...
Epoch: 7 cost time: 3.58183217048645
Epoch: 7, Steps: 12 | Train Loss: 2.071 Vali Loss: 2.084 Vali Acc: 0.439 Test Loss: 2.084 Test Acc: 0.439
Validation loss decreased (-0.388867 --> -0.438868).  Saving model ...
Epoch: 8 cost time: 3.39394211769104
Epoch: 8, Steps: 12 | Train Loss: 2.005 Vali Loss: 1.964 Vali Acc: 0.483 Test Loss: 1.964 Test Acc: 0.483
Validation loss decreased (-0.438868 --> -0.483314).  Saving model ...
Epoch: 9 cost time: 3.6828367710113525
Epoch: 9, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.848 Vali Acc: 0.528 Test Loss: 1.848 Test Acc: 0.528
Validation loss decreased (-0.483314 --> -0.527759).  Saving model ...
Epoch: 10 cost time: 3.276740312576294
Epoch: 10, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.735 Vali Acc: 0.539 Test Loss: 1.735 Test Acc: 0.539
Validation loss decreased (-0.527759 --> -0.538872).  Saving model ...
Epoch: 11 cost time: 3.299990653991699
Epoch: 11, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.620 Vali Acc: 0.572 Test Loss: 1.620 Test Acc: 0.572
Validation loss decreased (-0.538872 --> -0.572206).  Saving model ...
Epoch: 12 cost time: 3.4140512943267822
Epoch: 12, Steps: 12 | Train Loss: 1.437 Vali Loss: 1.515 Vali Acc: 0.583 Test Loss: 1.515 Test Acc: 0.583
Validation loss decreased (-0.572206 --> -0.583318).  Saving model ...
Epoch: 13 cost time: 3.9606828689575195
Epoch: 13, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.438 Vali Acc: 0.600 Test Loss: 1.438 Test Acc: 0.600
Validation loss decreased (-0.583318 --> -0.599986).  Saving model ...
Epoch: 14 cost time: 3.9041013717651367
Epoch: 14, Steps: 12 | Train Loss: 1.214 Vali Loss: 1.362 Vali Acc: 0.600 Test Loss: 1.362 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 15 cost time: 3.9198813438415527
Epoch: 15, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.282 Vali Acc: 0.633 Test Loss: 1.282 Test Acc: 0.633
Validation loss decreased (-0.599986 --> -0.633321).  Saving model ...
Epoch: 16 cost time: 3.828376293182373
Epoch: 16, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.212 Vali Acc: 0.606 Test Loss: 1.212 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9489755630493164
Epoch: 17, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.160 Vali Acc: 0.606 Test Loss: 1.160 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4921529293060303
Epoch: 18, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.107 Vali Acc: 0.628 Test Loss: 1.107 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.837702512741089
Epoch: 19, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.044 Vali Acc: 0.650 Test Loss: 1.044 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649990).  Saving model ...
Epoch: 20 cost time: 3.6296603679656982
Epoch: 20, Steps: 12 | Train Loss: 0.832 Vali Loss: 1.011 Vali Acc: 0.667 Test Loss: 1.011 Test Acc: 0.667
Validation loss decreased (-0.649990 --> -0.666657).  Saving model ...
Epoch: 21 cost time: 3.1500229835510254
Epoch: 21, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.966 Vali Acc: 0.678 Test Loss: 0.966 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677768).  Saving model ...
Epoch: 22 cost time: 3.94083571434021
Epoch: 22, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.927 Vali Acc: 0.700 Test Loss: 0.927 Test Acc: 0.700
Validation loss decreased (-0.677768 --> -0.699991).  Saving model ...
Epoch: 23 cost time: 3.868892192840576
Epoch: 23, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.894 Vali Acc: 0.711 Test Loss: 0.894 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711102).  Saving model ...
Epoch: 24 cost time: 3.686221122741699
Epoch: 24, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.871 Vali Acc: 0.694 Test Loss: 0.871 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6295340061187744
Epoch: 25, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.835 Vali Acc: 0.700 Test Loss: 0.835 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.504391670227051
Epoch: 26, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.804 Vali Acc: 0.706 Test Loss: 0.804 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.9383668899536133
Epoch: 27, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.792 Vali Acc: 0.728 Test Loss: 0.792 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727770).  Saving model ...
Epoch: 28 cost time: 3.7243244647979736
Epoch: 28, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.771 Vali Acc: 0.722 Test Loss: 0.771 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.730048179626465
Epoch: 29, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.757 Vali Acc: 0.711 Test Loss: 0.757 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.8861937522888184
Epoch: 30, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.727 Vali Acc: 0.744 Test Loss: 0.727 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744437).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 885399
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.369034051895142
Epoch: 1, Steps: 12 | Train Loss: 2.762 Vali Loss: 2.751 Vali Acc: 0.067 Test Loss: 2.751 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 3.1327626705169678
Epoch: 2, Steps: 12 | Train Loss: 2.747 Vali Loss: 2.695 Vali Acc: 0.111 Test Loss: 2.695 Test Acc: 0.111
Validation loss decreased (-0.066639 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 3.0759525299072266
Epoch: 3, Steps: 12 | Train Loss: 2.645 Vali Loss: 2.619 Vali Acc: 0.128 Test Loss: 2.619 Test Acc: 0.128
Validation loss decreased (-0.111084 --> -0.127752).  Saving model ...
Epoch: 4 cost time: 3.1928305625915527
Epoch: 4, Steps: 12 | Train Loss: 2.567 Vali Loss: 2.531 Vali Acc: 0.178 Test Loss: 2.531 Test Acc: 0.178
Validation loss decreased (-0.127752 --> -0.177752).  Saving model ...
Epoch: 5 cost time: 3.2916834354400635
Epoch: 5, Steps: 12 | Train Loss: 2.440 Vali Loss: 2.429 Vali Acc: 0.267 Test Loss: 2.429 Test Acc: 0.267
Validation loss decreased (-0.177752 --> -0.266642).  Saving model ...
Epoch: 6 cost time: 3.2099831104278564
Epoch: 6, Steps: 12 | Train Loss: 2.336 Vali Loss: 2.325 Vali Acc: 0.361 Test Loss: 2.325 Test Acc: 0.361
Validation loss decreased (-0.266642 --> -0.361088).  Saving model ...
Epoch: 7 cost time: 3.064814805984497
Epoch: 7, Steps: 12 | Train Loss: 2.201 Vali Loss: 2.217 Vali Acc: 0.383 Test Loss: 2.217 Test Acc: 0.383
Validation loss decreased (-0.361088 --> -0.383311).  Saving model ...
Epoch: 8 cost time: 3.1703546047210693
Epoch: 8, Steps: 12 | Train Loss: 2.122 Vali Loss: 2.107 Vali Acc: 0.389 Test Loss: 2.107 Test Acc: 0.389
Validation loss decreased (-0.383311 --> -0.388868).  Saving model ...
Epoch: 9 cost time: 3.3090054988861084
Epoch: 9, Steps: 12 | Train Loss: 1.951 Vali Loss: 1.986 Vali Acc: 0.483 Test Loss: 1.986 Test Acc: 0.483
Validation loss decreased (-0.388868 --> -0.483313).  Saving model ...
Epoch: 10 cost time: 3.3263254165649414
Epoch: 10, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.868 Vali Acc: 0.517 Test Loss: 1.868 Test Acc: 0.517
Validation loss decreased (-0.483313 --> -0.516648).  Saving model ...
Epoch: 11 cost time: 3.2251784801483154
Epoch: 11, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.756 Vali Acc: 0.567 Test Loss: 1.756 Test Acc: 0.567
Validation loss decreased (-0.516648 --> -0.566649).  Saving model ...
Epoch: 12 cost time: 3.1780471801757812
Epoch: 12, Steps: 12 | Train Loss: 1.581 Vali Loss: 1.648 Vali Acc: 0.583 Test Loss: 1.648 Test Acc: 0.583
Validation loss decreased (-0.566649 --> -0.583317).  Saving model ...
Epoch: 13 cost time: 3.1418569087982178
Epoch: 13, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.532 Vali Acc: 0.589 Test Loss: 1.532 Test Acc: 0.589
Validation loss decreased (-0.583317 --> -0.588874).  Saving model ...
Epoch: 14 cost time: 3.319053888320923
Epoch: 14, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.431 Vali Acc: 0.617 Test Loss: 1.431 Test Acc: 0.617
Validation loss decreased (-0.588874 --> -0.616652).  Saving model ...
Epoch: 15 cost time: 3.220642328262329
Epoch: 15, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.343 Vali Acc: 0.628 Test Loss: 1.343 Test Acc: 0.628
Validation loss decreased (-0.616652 --> -0.627764).  Saving model ...
Epoch: 16 cost time: 3.1625821590423584
Epoch: 16, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.261 Vali Acc: 0.622 Test Loss: 1.261 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2163970470428467
Epoch: 17, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.195 Vali Acc: 0.656 Test Loss: 1.195 Test Acc: 0.656
Validation loss decreased (-0.627764 --> -0.655544).  Saving model ...
Epoch: 18 cost time: 3.1460700035095215
Epoch: 18, Steps: 12 | Train Loss: 0.944 Vali Loss: 1.130 Vali Acc: 0.639 Test Loss: 1.130 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.888903856277466
Epoch: 19, Steps: 12 | Train Loss: 0.969 Vali Loss: 1.075 Vali Acc: 0.694 Test Loss: 1.075 Test Acc: 0.694
Validation loss decreased (-0.655544 --> -0.694434).  Saving model ...
Epoch: 20 cost time: 3.29549503326416
Epoch: 20, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.028 Vali Acc: 0.711 Test Loss: 1.028 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711101).  Saving model ...
Epoch: 21 cost time: 3.299158811569214
Epoch: 21, Steps: 12 | Train Loss: 0.791 Vali Loss: 1.003 Vali Acc: 0.711 Test Loss: 1.003 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 22 cost time: 3.2170650959014893
Epoch: 22, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.937 Vali Acc: 0.728 Test Loss: 0.937 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727768).  Saving model ...
Epoch: 23 cost time: 3.1992716789245605
Epoch: 23, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.907 Vali Acc: 0.728 Test Loss: 0.907 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727769).  Saving model ...
Epoch: 24 cost time: 3.1852102279663086
Epoch: 24, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.873 Vali Acc: 0.733 Test Loss: 0.873 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 25 cost time: 3.2483878135681152
Epoch: 25, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.850 Vali Acc: 0.739 Test Loss: 0.850 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738880).  Saving model ...
Epoch: 26 cost time: 3.2838692665100098
Epoch: 26, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.827 Vali Acc: 0.722 Test Loss: 0.827 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.1923558712005615
Epoch: 27, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.804 Vali Acc: 0.728 Test Loss: 0.804 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.168632984161377
Epoch: 28, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.795 Vali Acc: 0.722 Test Loss: 0.795 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2220585346221924
Epoch: 29, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.768 Vali Acc: 0.722 Test Loss: 0.768 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.314532995223999
Epoch: 30, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.755 Vali Acc: 0.728 Test Loss: 0.755 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 264423
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.693364381790161
Epoch: 1, Steps: 12 | Train Loss: 2.766 Vali Loss: 2.725 Vali Acc: 0.100 Test Loss: 2.725 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 2.5251991748809814
Epoch: 2, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.661 Vali Acc: 0.122 Test Loss: 2.661 Test Acc: 0.122
Validation loss decreased (-0.099973 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 2.990053653717041
Epoch: 3, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.578 Vali Acc: 0.161 Test Loss: 2.578 Test Acc: 0.161
Validation loss decreased (-0.122196 --> -0.161085).  Saving model ...
Epoch: 4 cost time: 3.2165629863739014
Epoch: 4, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.487 Vali Acc: 0.206 Test Loss: 2.487 Test Acc: 0.206
Validation loss decreased (-0.161085 --> -0.205531).  Saving model ...
Epoch: 5 cost time: 3.195808172225952
Epoch: 5, Steps: 12 | Train Loss: 2.447 Vali Loss: 2.390 Vali Acc: 0.256 Test Loss: 2.390 Test Acc: 0.256
Validation loss decreased (-0.205531 --> -0.255532).  Saving model ...
Epoch: 6 cost time: 3.2877957820892334
Epoch: 6, Steps: 12 | Train Loss: 2.290 Vali Loss: 2.287 Vali Acc: 0.322 Test Loss: 2.287 Test Acc: 0.322
Validation loss decreased (-0.255532 --> -0.322199).  Saving model ...
Epoch: 7 cost time: 3.2279021739959717
Epoch: 7, Steps: 12 | Train Loss: 2.171 Vali Loss: 2.183 Vali Acc: 0.367 Test Loss: 2.183 Test Acc: 0.367
Validation loss decreased (-0.322199 --> -0.366645).  Saving model ...
Epoch: 8 cost time: 3.445084571838379
Epoch: 8, Steps: 12 | Train Loss: 2.096 Vali Loss: 2.082 Vali Acc: 0.383 Test Loss: 2.082 Test Acc: 0.383
Validation loss decreased (-0.366645 --> -0.383313).  Saving model ...
Epoch: 9 cost time: 3.282463312149048
Epoch: 9, Steps: 12 | Train Loss: 1.958 Vali Loss: 1.975 Vali Acc: 0.456 Test Loss: 1.975 Test Acc: 0.456
Validation loss decreased (-0.383313 --> -0.455536).  Saving model ...
Epoch: 10 cost time: 3.2031617164611816
Epoch: 10, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.868 Vali Acc: 0.522 Test Loss: 1.868 Test Acc: 0.522
Validation loss decreased (-0.455536 --> -0.522204).  Saving model ...
Epoch: 11 cost time: 3.277095079421997
Epoch: 11, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.764 Vali Acc: 0.517 Test Loss: 1.764 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.137204170227051
Epoch: 12, Steps: 12 | Train Loss: 1.582 Vali Loss: 1.661 Vali Acc: 0.561 Test Loss: 1.661 Test Acc: 0.561
Validation loss decreased (-0.522204 --> -0.561095).  Saving model ...
Epoch: 13 cost time: 3.2946956157684326
Epoch: 13, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.568 Vali Acc: 0.572 Test Loss: 1.568 Test Acc: 0.572
Validation loss decreased (-0.561095 --> -0.572207).  Saving model ...
Epoch: 14 cost time: 3.288423538208008
Epoch: 14, Steps: 12 | Train Loss: 1.362 Vali Loss: 1.476 Vali Acc: 0.583 Test Loss: 1.476 Test Acc: 0.583
Validation loss decreased (-0.572207 --> -0.583319).  Saving model ...
Epoch: 15 cost time: 3.2786788940429688
Epoch: 15, Steps: 12 | Train Loss: 1.297 Vali Loss: 1.398 Vali Acc: 0.567 Test Loss: 1.398 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.093296766281128
Epoch: 16, Steps: 12 | Train Loss: 1.204 Vali Loss: 1.336 Vali Acc: 0.594 Test Loss: 1.336 Test Acc: 0.594
Validation loss decreased (-0.583319 --> -0.594431).  Saving model ...
Epoch: 17 cost time: 3.2504632472991943
Epoch: 17, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.272 Vali Acc: 0.606 Test Loss: 1.272 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605543).  Saving model ...
Epoch: 18 cost time: 3.3196825981140137
Epoch: 18, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.206 Vali Acc: 0.611 Test Loss: 1.206 Test Acc: 0.611
Validation loss decreased (-0.605543 --> -0.611099).  Saving model ...
Epoch: 19 cost time: 3.3161306381225586
Epoch: 19, Steps: 12 | Train Loss: 0.965 Vali Loss: 1.150 Vali Acc: 0.644 Test Loss: 1.150 Test Acc: 0.644
Validation loss decreased (-0.611099 --> -0.644433).  Saving model ...
Epoch: 20 cost time: 3.127772808074951
Epoch: 20, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.116 Vali Acc: 0.633 Test Loss: 1.116 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0469181537628174
Epoch: 21, Steps: 12 | Train Loss: 0.853 Vali Loss: 1.070 Vali Acc: 0.661 Test Loss: 1.070 Test Acc: 0.661
Validation loss decreased (-0.644433 --> -0.661100).  Saving model ...
Epoch: 22 cost time: 3.0736424922943115
Epoch: 22, Steps: 12 | Train Loss: 0.812 Vali Loss: 1.050 Vali Acc: 0.639 Test Loss: 1.050 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.186936378479004
Epoch: 23, Steps: 12 | Train Loss: 0.798 Vali Loss: 1.011 Vali Acc: 0.633 Test Loss: 1.011 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1224775314331055
Epoch: 24, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.953 Vali Acc: 0.689 Test Loss: 0.953 Test Acc: 0.689
Validation loss decreased (-0.661100 --> -0.688879).  Saving model ...
Epoch: 25 cost time: 2.948477268218994
Epoch: 25, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.927 Vali Acc: 0.661 Test Loss: 0.927 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8975160121917725
Epoch: 26, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.922 Vali Acc: 0.667 Test Loss: 0.922 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.9736008644104004
Epoch: 27, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.892 Vali Acc: 0.683 Test Loss: 0.892 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.093855857849121
Epoch: 28, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.877 Vali Acc: 0.683 Test Loss: 0.877 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.027540683746338
Epoch: 29, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.861 Vali Acc: 0.667 Test Loss: 0.861 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.9702465534210205
Epoch: 30, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.847 Vali Acc: 0.683 Test Loss: 0.847 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6888888888888889
model parameter : 885399
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.391907691955566
Epoch: 1, Steps: 12 | Train Loss: 2.761 Vali Loss: 2.750 Vali Acc: 0.072 Test Loss: 2.750 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 2.533536434173584
Epoch: 2, Steps: 12 | Train Loss: 2.748 Vali Loss: 2.695 Vali Acc: 0.094 Test Loss: 2.695 Test Acc: 0.094
Validation loss decreased (-0.072195 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 2.4666366577148438
Epoch: 3, Steps: 12 | Train Loss: 2.651 Vali Loss: 2.622 Vali Acc: 0.111 Test Loss: 2.622 Test Acc: 0.111
Validation loss decreased (-0.094417 --> -0.111085).  Saving model ...
Epoch: 4 cost time: 2.433326244354248
Epoch: 4, Steps: 12 | Train Loss: 2.582 Vali Loss: 2.542 Vali Acc: 0.133 Test Loss: 2.542 Test Acc: 0.133
Validation loss decreased (-0.111085 --> -0.133308).  Saving model ...
Epoch: 5 cost time: 2.4969167709350586
Epoch: 5, Steps: 12 | Train Loss: 2.465 Vali Loss: 2.453 Vali Acc: 0.228 Test Loss: 2.453 Test Acc: 0.228
Validation loss decreased (-0.133308 --> -0.227753).  Saving model ...
Epoch: 6 cost time: 2.4433047771453857
Epoch: 6, Steps: 12 | Train Loss: 2.376 Vali Loss: 2.363 Vali Acc: 0.311 Test Loss: 2.363 Test Acc: 0.311
Validation loss decreased (-0.227753 --> -0.311087).  Saving model ...
Epoch: 7 cost time: 2.704552173614502
Epoch: 7, Steps: 12 | Train Loss: 2.254 Vali Loss: 2.269 Vali Acc: 0.350 Test Loss: 2.269 Test Acc: 0.350
Validation loss decreased (-0.311087 --> -0.349977).  Saving model ...
Epoch: 8 cost time: 2.6913750171661377
Epoch: 8, Steps: 12 | Train Loss: 2.196 Vali Loss: 2.171 Vali Acc: 0.406 Test Loss: 2.171 Test Acc: 0.406
Validation loss decreased (-0.349977 --> -0.405534).  Saving model ...
Epoch: 9 cost time: 2.611121416091919
Epoch: 9, Steps: 12 | Train Loss: 2.061 Vali Loss: 2.063 Vali Acc: 0.489 Test Loss: 2.063 Test Acc: 0.489
Validation loss decreased (-0.405534 --> -0.488868).  Saving model ...
Epoch: 10 cost time: 2.643355131149292
Epoch: 10, Steps: 12 | Train Loss: 1.926 Vali Loss: 1.953 Vali Acc: 0.517 Test Loss: 1.953 Test Acc: 0.517
Validation loss decreased (-0.488868 --> -0.516647).  Saving model ...
Epoch: 11 cost time: 2.7390899658203125
Epoch: 11, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.839 Vali Acc: 0.544 Test Loss: 1.839 Test Acc: 0.544
Validation loss decreased (-0.516647 --> -0.544426).  Saving model ...
Epoch: 12 cost time: 2.7730023860931396
Epoch: 12, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.733 Vali Acc: 0.556 Test Loss: 1.733 Test Acc: 0.556
Validation loss decreased (-0.544426 --> -0.555538).  Saving model ...
Epoch: 13 cost time: 2.7434628009796143
Epoch: 13, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.619 Vali Acc: 0.572 Test Loss: 1.619 Test Acc: 0.572
Validation loss decreased (-0.555538 --> -0.572206).  Saving model ...
Epoch: 14 cost time: 2.7470555305480957
Epoch: 14, Steps: 12 | Train Loss: 1.443 Vali Loss: 1.516 Vali Acc: 0.589 Test Loss: 1.516 Test Acc: 0.589
Validation loss decreased (-0.572206 --> -0.588874).  Saving model ...
Epoch: 15 cost time: 2.7330362796783447
Epoch: 15, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.420 Vali Acc: 0.600 Test Loss: 1.420 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599986).  Saving model ...
Epoch: 16 cost time: 2.8750131130218506
Epoch: 16, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.335 Vali Acc: 0.628 Test Loss: 1.335 Test Acc: 0.628
Validation loss decreased (-0.599986 --> -0.627764).  Saving model ...
Epoch: 17 cost time: 2.6277263164520264
Epoch: 17, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.265 Vali Acc: 0.611 Test Loss: 1.265 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.778256893157959
Epoch: 18, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.199 Vali Acc: 0.628 Test Loss: 1.199 Test Acc: 0.628
Validation loss decreased (-0.627764 --> -0.627766).  Saving model ...
Epoch: 19 cost time: 2.7998757362365723
Epoch: 19, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.146 Vali Acc: 0.667 Test Loss: 1.146 Test Acc: 0.667
Validation loss decreased (-0.627766 --> -0.666655).  Saving model ...
Epoch: 20 cost time: 2.7524032592773438
Epoch: 20, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.096 Vali Acc: 0.672 Test Loss: 1.096 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672211).  Saving model ...
Epoch: 21 cost time: 2.633430004119873
Epoch: 21, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.059 Vali Acc: 0.661 Test Loss: 1.059 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7328526973724365
Epoch: 22, Steps: 12 | Train Loss: 0.808 Vali Loss: 1.006 Vali Acc: 0.689 Test Loss: 1.006 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688879).  Saving model ...
Epoch: 23 cost time: 2.779172420501709
Epoch: 23, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.990 Vali Acc: 0.678 Test Loss: 0.990 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7838151454925537
Epoch: 24, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.949 Vali Acc: 0.711 Test Loss: 0.949 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711102).  Saving model ...
Epoch: 25 cost time: 2.7652790546417236
Epoch: 25, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.912 Vali Acc: 0.722 Test Loss: 0.912 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722213).  Saving model ...
Epoch: 26 cost time: 2.7541615962982178
Epoch: 26, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.900 Vali Acc: 0.706 Test Loss: 0.900 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7389419078826904
Epoch: 27, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.874 Vali Acc: 0.717 Test Loss: 0.874 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.575955390930176
Epoch: 28, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.858 Vali Acc: 0.739 Test Loss: 0.858 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738880).  Saving model ...
Epoch: 29 cost time: 2.7528085708618164
Epoch: 29, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.829 Vali Acc: 0.739 Test Loss: 0.829 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738881).  Saving model ...
Epoch: 30 cost time: 2.7991013526916504
Epoch: 30, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.810 Vali Acc: 0.744 Test Loss: 0.810 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744436).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 264423
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.08320164680481
Epoch: 1, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.728 Vali Acc: 0.100 Test Loss: 2.728 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 2.506448745727539
Epoch: 2, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.676 Vali Acc: 0.106 Test Loss: 2.676 Test Acc: 0.106
Validation loss decreased (-0.099973 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 2.3636906147003174
Epoch: 3, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.606 Vali Acc: 0.139 Test Loss: 2.606 Test Acc: 0.139
Validation loss decreased (-0.105529 --> -0.138863).  Saving model ...
Epoch: 4 cost time: 2.4309635162353516
Epoch: 4, Steps: 12 | Train Loss: 2.578 Vali Loss: 2.529 Vali Acc: 0.194 Test Loss: 2.529 Test Acc: 0.194
Validation loss decreased (-0.138863 --> -0.194419).  Saving model ...
Epoch: 5 cost time: 2.2540085315704346
Epoch: 5, Steps: 12 | Train Loss: 2.514 Vali Loss: 2.449 Vali Acc: 0.250 Test Loss: 2.449 Test Acc: 0.250
Validation loss decreased (-0.194419 --> -0.249976).  Saving model ...
Epoch: 6 cost time: 2.2926905155181885
Epoch: 6, Steps: 12 | Train Loss: 2.387 Vali Loss: 2.363 Vali Acc: 0.289 Test Loss: 2.363 Test Acc: 0.289
Validation loss decreased (-0.249976 --> -0.288865).  Saving model ...
Epoch: 7 cost time: 2.332338571548462
Epoch: 7, Steps: 12 | Train Loss: 2.288 Vali Loss: 2.279 Vali Acc: 0.333 Test Loss: 2.279 Test Acc: 0.333
Validation loss decreased (-0.288865 --> -0.333311).  Saving model ...
Epoch: 8 cost time: 2.202143430709839
Epoch: 8, Steps: 12 | Train Loss: 2.220 Vali Loss: 2.202 Vali Acc: 0.339 Test Loss: 2.202 Test Acc: 0.339
Validation loss decreased (-0.333311 --> -0.338867).  Saving model ...
Epoch: 9 cost time: 2.3624746799468994
Epoch: 9, Steps: 12 | Train Loss: 2.125 Vali Loss: 2.121 Vali Acc: 0.361 Test Loss: 2.121 Test Acc: 0.361
Validation loss decreased (-0.338867 --> -0.361090).  Saving model ...
Epoch: 10 cost time: 2.435255527496338
Epoch: 10, Steps: 12 | Train Loss: 1.995 Vali Loss: 2.037 Vali Acc: 0.406 Test Loss: 2.037 Test Acc: 0.406
Validation loss decreased (-0.361090 --> -0.405535).  Saving model ...
Epoch: 11 cost time: 2.309858798980713
Epoch: 11, Steps: 12 | Train Loss: 1.926 Vali Loss: 1.957 Vali Acc: 0.439 Test Loss: 1.957 Test Acc: 0.439
Validation loss decreased (-0.405535 --> -0.438869).  Saving model ...
Epoch: 12 cost time: 2.3123672008514404
Epoch: 12, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.877 Vali Acc: 0.461 Test Loss: 1.877 Test Acc: 0.461
Validation loss decreased (-0.438869 --> -0.461092).  Saving model ...
Epoch: 13 cost time: 2.301884651184082
Epoch: 13, Steps: 12 | Train Loss: 1.694 Vali Loss: 1.801 Vali Acc: 0.517 Test Loss: 1.801 Test Acc: 0.517
Validation loss decreased (-0.461092 --> -0.516649).  Saving model ...
Epoch: 14 cost time: 2.2654571533203125
Epoch: 14, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.724 Vali Acc: 0.544 Test Loss: 1.724 Test Acc: 0.544
Validation loss decreased (-0.516649 --> -0.544427).  Saving model ...
Epoch: 15 cost time: 2.335984945297241
Epoch: 15, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.656 Vali Acc: 0.539 Test Loss: 1.656 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.338590621948242
Epoch: 16, Steps: 12 | Train Loss: 1.447 Vali Loss: 1.596 Vali Acc: 0.578 Test Loss: 1.596 Test Acc: 0.578
Validation loss decreased (-0.544427 --> -0.577762).  Saving model ...
Epoch: 17 cost time: 2.3166544437408447
Epoch: 17, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.528 Vali Acc: 0.578 Test Loss: 1.528 Test Acc: 0.578
Validation loss decreased (-0.577762 --> -0.577763).  Saving model ...
Epoch: 18 cost time: 2.3057057857513428
Epoch: 18, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.467 Vali Acc: 0.583 Test Loss: 1.467 Test Acc: 0.583
Validation loss decreased (-0.577763 --> -0.583319).  Saving model ...
Epoch: 19 cost time: 2.261969804763794
Epoch: 19, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.410 Vali Acc: 0.600 Test Loss: 1.410 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599986).  Saving model ...
Epoch: 20 cost time: 2.259625196456909
Epoch: 20, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.363 Vali Acc: 0.594 Test Loss: 1.363 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.508211135864258
Epoch: 21, Steps: 12 | Train Loss: 1.108 Vali Loss: 1.308 Vali Acc: 0.622 Test Loss: 1.308 Test Acc: 0.622
Validation loss decreased (-0.599986 --> -0.622209).  Saving model ...
Epoch: 22 cost time: 2.439180374145508
Epoch: 22, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.289 Vali Acc: 0.611 Test Loss: 1.289 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.426584243774414
Epoch: 23, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.237 Vali Acc: 0.583 Test Loss: 1.237 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3857600688934326
Epoch: 24, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.196 Vali Acc: 0.611 Test Loss: 1.196 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2664778232574463
Epoch: 25, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.131 Vali Acc: 0.622 Test Loss: 1.131 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622211).  Saving model ...
Epoch: 26 cost time: 2.4073970317840576
Epoch: 26, Steps: 12 | Train Loss: 0.879 Vali Loss: 1.090 Vali Acc: 0.628 Test Loss: 1.090 Test Acc: 0.628
Validation loss decreased (-0.622211 --> -0.627767).  Saving model ...
Epoch: 27 cost time: 2.3096694946289062
Epoch: 27, Steps: 12 | Train Loss: 0.763 Vali Loss: 1.060 Vali Acc: 0.644 Test Loss: 1.060 Test Acc: 0.644
Validation loss decreased (-0.627767 --> -0.644434).  Saving model ...
Epoch: 28 cost time: 2.448969602584839
Epoch: 28, Steps: 12 | Train Loss: 0.713 Vali Loss: 1.031 Vali Acc: 0.650 Test Loss: 1.031 Test Acc: 0.650
Validation loss decreased (-0.644434 --> -0.649990).  Saving model ...
Epoch: 29 cost time: 2.4541518688201904
Epoch: 29, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.988 Vali Acc: 0.661 Test Loss: 0.988 Test Acc: 0.661
Validation loss decreased (-0.649990 --> -0.661101).  Saving model ...
Epoch: 30 cost time: 2.4193613529205322
Epoch: 30, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.967 Vali Acc: 0.672 Test Loss: 0.967 Test Acc: 0.672
Validation loss decreased (-0.661101 --> -0.672213).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6722222222222223
model parameter : 885399
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.007347106933594
Epoch: 1, Steps: 12 | Train Loss: 2.756 Vali Loss: 2.755 Vali Acc: 0.061 Test Loss: 2.755 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 2.0675227642059326
Epoch: 2, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.710 Vali Acc: 0.089 Test Loss: 2.710 Test Acc: 0.089
Validation loss decreased (-0.061084 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 2.0415399074554443
Epoch: 3, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.651 Vali Acc: 0.089 Test Loss: 2.651 Test Acc: 0.089
Validation loss decreased (-0.088862 --> -0.088862).  Saving model ...
Epoch: 4 cost time: 2.050524950027466
Epoch: 4, Steps: 12 | Train Loss: 2.612 Vali Loss: 2.587 Vali Acc: 0.106 Test Loss: 2.587 Test Acc: 0.106
Validation loss decreased (-0.088862 --> -0.105530).  Saving model ...
Epoch: 5 cost time: 2.0153861045837402
Epoch: 5, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.514 Vali Acc: 0.172 Test Loss: 2.514 Test Acc: 0.172
Validation loss decreased (-0.105530 --> -0.172197).  Saving model ...
Epoch: 6 cost time: 2.014533519744873
Epoch: 6, Steps: 12 | Train Loss: 2.441 Vali Loss: 2.441 Vali Acc: 0.244 Test Loss: 2.441 Test Acc: 0.244
Validation loss decreased (-0.172197 --> -0.244420).  Saving model ...
Epoch: 7 cost time: 2.018712043762207
Epoch: 7, Steps: 12 | Train Loss: 2.327 Vali Loss: 2.364 Vali Acc: 0.317 Test Loss: 2.364 Test Acc: 0.317
Validation loss decreased (-0.244420 --> -0.316643).  Saving model ...
Epoch: 8 cost time: 2.061880350112915
Epoch: 8, Steps: 12 | Train Loss: 2.291 Vali Loss: 2.284 Vali Acc: 0.339 Test Loss: 2.284 Test Acc: 0.339
Validation loss decreased (-0.316643 --> -0.338866).  Saving model ...
Epoch: 9 cost time: 2.0593008995056152
Epoch: 9, Steps: 12 | Train Loss: 2.188 Vali Loss: 2.195 Vali Acc: 0.417 Test Loss: 2.195 Test Acc: 0.417
Validation loss decreased (-0.338866 --> -0.416645).  Saving model ...
Epoch: 10 cost time: 2.0630979537963867
Epoch: 10, Steps: 12 | Train Loss: 2.065 Vali Loss: 2.108 Vali Acc: 0.456 Test Loss: 2.108 Test Acc: 0.456
Validation loss decreased (-0.416645 --> -0.455534).  Saving model ...
Epoch: 11 cost time: 2.0307207107543945
Epoch: 11, Steps: 12 | Train Loss: 2.003 Vali Loss: 2.021 Vali Acc: 0.489 Test Loss: 2.021 Test Acc: 0.489
Validation loss decreased (-0.455534 --> -0.488869).  Saving model ...
Epoch: 12 cost time: 1.9477763175964355
Epoch: 12, Steps: 12 | Train Loss: 1.872 Vali Loss: 1.942 Vali Acc: 0.489 Test Loss: 1.942 Test Acc: 0.489
Validation loss decreased (-0.488869 --> -0.488869).  Saving model ...
Epoch: 13 cost time: 1.953564167022705
Epoch: 13, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.848 Vali Acc: 0.517 Test Loss: 1.848 Test Acc: 0.517
Validation loss decreased (-0.488869 --> -0.516648).  Saving model ...
Epoch: 14 cost time: 1.9539201259613037
Epoch: 14, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.755 Vali Acc: 0.522 Test Loss: 1.755 Test Acc: 0.522
Validation loss decreased (-0.516648 --> -0.522205).  Saving model ...
Epoch: 15 cost time: 2.018634557723999
Epoch: 15, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.679 Vali Acc: 0.539 Test Loss: 1.679 Test Acc: 0.539
Validation loss decreased (-0.522205 --> -0.538872).  Saving model ...
Epoch: 16 cost time: 1.600719928741455
Epoch: 16, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.599 Vali Acc: 0.561 Test Loss: 1.599 Test Acc: 0.561
Validation loss decreased (-0.538872 --> -0.561095).  Saving model ...
Epoch: 17 cost time: 1.504469394683838
Epoch: 17, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.521 Vali Acc: 0.544 Test Loss: 1.521 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5815188884735107
Epoch: 18, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.451 Vali Acc: 0.544 Test Loss: 1.451 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9009287357330322
Epoch: 19, Steps: 12 | Train Loss: 1.295 Vali Loss: 1.403 Vali Acc: 0.561 Test Loss: 1.403 Test Acc: 0.561
Validation loss decreased (-0.561095 --> -0.561097).  Saving model ...
Epoch: 20 cost time: 1.751225471496582
Epoch: 20, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.352 Vali Acc: 0.550 Test Loss: 1.352 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8356635570526123
Epoch: 21, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.316 Vali Acc: 0.578 Test Loss: 1.316 Test Acc: 0.578
Validation loss decreased (-0.561097 --> -0.577765).  Saving model ...
Epoch: 22 cost time: 1.8912169933319092
Epoch: 22, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.253 Vali Acc: 0.606 Test Loss: 1.253 Test Acc: 0.606
Validation loss decreased (-0.577765 --> -0.605543).  Saving model ...
Epoch: 23 cost time: 1.7690989971160889
Epoch: 23, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.221 Vali Acc: 0.622 Test Loss: 1.221 Test Acc: 0.622
Validation loss decreased (-0.605543 --> -0.622210).  Saving model ...
Epoch: 24 cost time: 1.935441017150879
Epoch: 24, Steps: 12 | Train Loss: 0.962 Vali Loss: 1.180 Vali Acc: 0.633 Test Loss: 1.180 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633322).  Saving model ...
Epoch: 25 cost time: 1.999990463256836
Epoch: 25, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.138 Vali Acc: 0.628 Test Loss: 1.138 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9392523765563965
Epoch: 26, Steps: 12 | Train Loss: 0.822 Vali Loss: 1.101 Vali Acc: 0.667 Test Loss: 1.101 Test Acc: 0.667
Validation loss decreased (-0.633322 --> -0.666656).  Saving model ...
Epoch: 27 cost time: 1.9418082237243652
Epoch: 27, Steps: 12 | Train Loss: 0.778 Vali Loss: 1.078 Vali Acc: 0.633 Test Loss: 1.078 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0841925144195557
Epoch: 28, Steps: 12 | Train Loss: 0.775 Vali Loss: 1.068 Vali Acc: 0.650 Test Loss: 1.068 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.928800106048584
Epoch: 29, Steps: 12 | Train Loss: 0.755 Vali Loss: 1.041 Vali Acc: 0.672 Test Loss: 1.041 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672212).  Saving model ...
Epoch: 30 cost time: 1.988025426864624
Epoch: 30, Steps: 12 | Train Loss: 0.652 Vali Loss: 1.016 Vali Acc: 0.678 Test Loss: 1.016 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6777777777777778
model parameter : 264423
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.9684083461761475
Epoch: 1, Steps: 12 | Train Loss: 2.818 Vali Loss: 2.823 Vali Acc: 0.056 Test Loss: 2.823 Test Acc: 0.056
Validation loss decreased (inf --> -0.055527).  Saving model ...
Epoch: 2 cost time: 2.926480770111084
Epoch: 2, Steps: 12 | Train Loss: 2.787 Vali Loss: 2.773 Vali Acc: 0.067 Test Loss: 2.773 Test Acc: 0.067
Validation loss decreased (-0.055527 --> -0.066639).  Saving model ...
Epoch: 3 cost time: 3.17122745513916
Epoch: 3, Steps: 12 | Train Loss: 2.710 Vali Loss: 2.704 Vali Acc: 0.106 Test Loss: 2.704 Test Acc: 0.106
Validation loss decreased (-0.066639 --> -0.105529).  Saving model ...
Epoch: 4 cost time: 3.2128472328186035
Epoch: 4, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.622 Vali Acc: 0.161 Test Loss: 2.622 Test Acc: 0.161
Validation loss decreased (-0.105529 --> -0.161085).  Saving model ...
Epoch: 5 cost time: 3.1561527252197266
Epoch: 5, Steps: 12 | Train Loss: 2.510 Vali Loss: 2.522 Vali Acc: 0.261 Test Loss: 2.522 Test Acc: 0.261
Validation loss decreased (-0.161085 --> -0.261086).  Saving model ...
Epoch: 6 cost time: 3.2645137310028076
Epoch: 6, Steps: 12 | Train Loss: 2.458 Vali Loss: 2.408 Vali Acc: 0.344 Test Loss: 2.408 Test Acc: 0.344
Validation loss decreased (-0.261086 --> -0.344420).  Saving model ...
Epoch: 7 cost time: 3.2078635692596436
Epoch: 7, Steps: 12 | Train Loss: 2.276 Vali Loss: 2.289 Vali Acc: 0.406 Test Loss: 2.289 Test Acc: 0.406
Validation loss decreased (-0.344420 --> -0.405533).  Saving model ...
Epoch: 8 cost time: 3.385237455368042
Epoch: 8, Steps: 12 | Train Loss: 2.158 Vali Loss: 2.165 Vali Acc: 0.433 Test Loss: 2.165 Test Acc: 0.433
Validation loss decreased (-0.405533 --> -0.433312).  Saving model ...
Epoch: 9 cost time: 3.2979278564453125
Epoch: 9, Steps: 12 | Train Loss: 2.051 Vali Loss: 2.044 Vali Acc: 0.428 Test Loss: 2.044 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.309044361114502
Epoch: 10, Steps: 12 | Train Loss: 1.944 Vali Loss: 1.930 Vali Acc: 0.472 Test Loss: 1.930 Test Acc: 0.472
Validation loss decreased (-0.433312 --> -0.472203).  Saving model ...
Epoch: 11 cost time: 3.2254834175109863
Epoch: 11, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.818 Vali Acc: 0.506 Test Loss: 1.818 Test Acc: 0.506
Validation loss decreased (-0.472203 --> -0.505537).  Saving model ...
Epoch: 12 cost time: 3.472813367843628
Epoch: 12, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.714 Vali Acc: 0.539 Test Loss: 1.714 Test Acc: 0.539
Validation loss decreased (-0.505537 --> -0.538872).  Saving model ...
Epoch: 13 cost time: 3.186220645904541
Epoch: 13, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.613 Vali Acc: 0.544 Test Loss: 1.613 Test Acc: 0.544
Validation loss decreased (-0.538872 --> -0.544428).  Saving model ...
Epoch: 14 cost time: 3.4233717918395996
Epoch: 14, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.513 Vali Acc: 0.561 Test Loss: 1.513 Test Acc: 0.561
Validation loss decreased (-0.544428 --> -0.561096).  Saving model ...
Epoch: 15 cost time: 3.141643762588501
Epoch: 15, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.418 Vali Acc: 0.600 Test Loss: 1.418 Test Acc: 0.600
Validation loss decreased (-0.561096 --> -0.599986).  Saving model ...
Epoch: 16 cost time: 3.3823914527893066
Epoch: 16, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.337 Vali Acc: 0.606 Test Loss: 1.337 Test Acc: 0.606
Validation loss decreased (-0.599986 --> -0.605542).  Saving model ...
Epoch: 17 cost time: 3.1820127964019775
Epoch: 17, Steps: 12 | Train Loss: 1.136 Vali Loss: 1.233 Vali Acc: 0.617 Test Loss: 1.233 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616654).  Saving model ...
Epoch: 18 cost time: 3.4133107662200928
Epoch: 18, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.167 Vali Acc: 0.617 Test Loss: 1.167 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616655).  Saving model ...
Epoch: 19 cost time: 3.2699880599975586
Epoch: 19, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.092 Vali Acc: 0.661 Test Loss: 1.092 Test Acc: 0.661
Validation loss decreased (-0.616655 --> -0.661100).  Saving model ...
Epoch: 20 cost time: 3.1545050144195557
Epoch: 20, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.054 Vali Acc: 0.661 Test Loss: 1.054 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661101).  Saving model ...
Epoch: 21 cost time: 3.054807662963867
Epoch: 21, Steps: 12 | Train Loss: 0.853 Vali Loss: 1.002 Vali Acc: 0.678 Test Loss: 1.002 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677768).  Saving model ...
Epoch: 22 cost time: 3.1252148151397705
Epoch: 22, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.944 Vali Acc: 0.689 Test Loss: 0.944 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688879).  Saving model ...
Epoch: 23 cost time: 3.059569835662842
Epoch: 23, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.930 Vali Acc: 0.694 Test Loss: 0.930 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 24 cost time: 3.1108102798461914
Epoch: 24, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.895 Vali Acc: 0.706 Test Loss: 0.895 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705547).  Saving model ...
Epoch: 25 cost time: 3.0439059734344482
Epoch: 25, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.851 Vali Acc: 0.706 Test Loss: 0.851 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 26 cost time: 3.0777180194854736
Epoch: 26, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.818 Vali Acc: 0.700 Test Loss: 0.818 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2333905696868896
Epoch: 27, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.839 Vali Acc: 0.700 Test Loss: 0.839 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.1411924362182617
Epoch: 28, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.810 Vali Acc: 0.689 Test Loss: 0.810 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.184671640396118
Epoch: 29, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.771 Vali Acc: 0.717 Test Loss: 0.771 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716659).  Saving model ...
Epoch: 30 cost time: 3.179985523223877
Epoch: 30, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.762 Vali Acc: 0.728 Test Loss: 0.762 Test Acc: 0.728
Validation loss decreased (-0.716659 --> -0.727770).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7277777777777777
model parameter : 445527
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.645450115203857
Epoch: 1, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.715 Vali Acc: 0.078 Test Loss: 2.715 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 2.6207845211029053
Epoch: 2, Steps: 12 | Train Loss: 2.691 Vali Loss: 2.667 Vali Acc: 0.094 Test Loss: 2.667 Test Acc: 0.094
Validation loss decreased (-0.077751 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 2.879579782485962
Epoch: 3, Steps: 12 | Train Loss: 2.623 Vali Loss: 2.604 Vali Acc: 0.128 Test Loss: 2.604 Test Acc: 0.128
Validation loss decreased (-0.094418 --> -0.127752).  Saving model ...
Epoch: 4 cost time: 2.755934953689575
Epoch: 4, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.534 Vali Acc: 0.189 Test Loss: 2.534 Test Acc: 0.189
Validation loss decreased (-0.127752 --> -0.188864).  Saving model ...
Epoch: 5 cost time: 2.6290035247802734
Epoch: 5, Steps: 12 | Train Loss: 2.500 Vali Loss: 2.461 Vali Acc: 0.206 Test Loss: 2.461 Test Acc: 0.206
Validation loss decreased (-0.188864 --> -0.205531).  Saving model ...
Epoch: 6 cost time: 2.4515738487243652
Epoch: 6, Steps: 12 | Train Loss: 2.399 Vali Loss: 2.381 Vali Acc: 0.239 Test Loss: 2.381 Test Acc: 0.239
Validation loss decreased (-0.205531 --> -0.238865).  Saving model ...
Epoch: 7 cost time: 2.5507655143737793
Epoch: 7, Steps: 12 | Train Loss: 2.310 Vali Loss: 2.297 Vali Acc: 0.339 Test Loss: 2.297 Test Acc: 0.339
Validation loss decreased (-0.238865 --> -0.338866).  Saving model ...
Epoch: 8 cost time: 2.9339804649353027
Epoch: 8, Steps: 12 | Train Loss: 2.211 Vali Loss: 2.208 Vali Acc: 0.383 Test Loss: 2.208 Test Acc: 0.383
Validation loss decreased (-0.338866 --> -0.383311).  Saving model ...
Epoch: 9 cost time: 2.872298240661621
Epoch: 9, Steps: 12 | Train Loss: 2.102 Vali Loss: 2.109 Vali Acc: 0.406 Test Loss: 2.109 Test Acc: 0.406
Validation loss decreased (-0.383311 --> -0.405534).  Saving model ...
Epoch: 10 cost time: 2.643760919570923
Epoch: 10, Steps: 12 | Train Loss: 1.979 Vali Loss: 2.005 Vali Acc: 0.428 Test Loss: 2.005 Test Acc: 0.428
Validation loss decreased (-0.405534 --> -0.427758).  Saving model ...
Epoch: 11 cost time: 2.7313406467437744
Epoch: 11, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.898 Vali Acc: 0.461 Test Loss: 1.898 Test Acc: 0.461
Validation loss decreased (-0.427758 --> -0.461092).  Saving model ...
Epoch: 12 cost time: 2.8707900047302246
Epoch: 12, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.787 Vali Acc: 0.511 Test Loss: 1.787 Test Acc: 0.511
Validation loss decreased (-0.461092 --> -0.511093).  Saving model ...
Epoch: 13 cost time: 2.791893243789673
Epoch: 13, Steps: 12 | Train Loss: 1.599 Vali Loss: 1.676 Vali Acc: 0.561 Test Loss: 1.676 Test Acc: 0.561
Validation loss decreased (-0.511093 --> -0.561094).  Saving model ...
Epoch: 14 cost time: 2.7679214477539062
Epoch: 14, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.566 Vali Acc: 0.594 Test Loss: 1.566 Test Acc: 0.594
Validation loss decreased (-0.561094 --> -0.594429).  Saving model ...
Epoch: 15 cost time: 2.910521984100342
Epoch: 15, Steps: 12 | Train Loss: 1.367 Vali Loss: 1.477 Vali Acc: 0.572 Test Loss: 1.477 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8908612728118896
Epoch: 16, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.385 Vali Acc: 0.567 Test Loss: 1.385 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.65472149848938
Epoch: 17, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.316 Vali Acc: 0.578 Test Loss: 1.316 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.663623571395874
Epoch: 18, Steps: 12 | Train Loss: 1.098 Vali Loss: 1.241 Vali Acc: 0.583 Test Loss: 1.241 Test Acc: 0.583
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.9566879272460938
Epoch: 19, Steps: 12 | Train Loss: 1.012 Vali Loss: 1.173 Vali Acc: 0.594 Test Loss: 1.173 Test Acc: 0.594
Validation loss decreased (-0.594429 --> -0.594433).  Saving model ...
Epoch: 20 cost time: 2.8308420181274414
Epoch: 20, Steps: 12 | Train Loss: 0.902 Vali Loss: 1.113 Vali Acc: 0.600 Test Loss: 1.113 Test Acc: 0.600
Validation loss decreased (-0.594433 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 2.909041404724121
Epoch: 21, Steps: 12 | Train Loss: 0.809 Vali Loss: 1.063 Vali Acc: 0.617 Test Loss: 1.063 Test Acc: 0.617
Validation loss decreased (-0.599989 --> -0.616656).  Saving model ...
Epoch: 22 cost time: 2.972860336303711
Epoch: 22, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.040 Vali Acc: 0.606 Test Loss: 1.040 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.924612283706665
Epoch: 23, Steps: 12 | Train Loss: 0.726 Vali Loss: 1.003 Vali Acc: 0.628 Test Loss: 1.003 Test Acc: 0.628
Validation loss decreased (-0.616656 --> -0.627768).  Saving model ...
Epoch: 24 cost time: 2.7517175674438477
Epoch: 24, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.974 Vali Acc: 0.639 Test Loss: 0.974 Test Acc: 0.639
Validation loss decreased (-0.627768 --> -0.638879).  Saving model ...
Epoch: 25 cost time: 2.7888152599334717
Epoch: 25, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.956 Vali Acc: 0.644 Test Loss: 0.956 Test Acc: 0.644
Validation loss decreased (-0.638879 --> -0.644435).  Saving model ...
Epoch: 26 cost time: 2.9813990592956543
Epoch: 26, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.920 Vali Acc: 0.667 Test Loss: 0.920 Test Acc: 0.667
Validation loss decreased (-0.644435 --> -0.666657).  Saving model ...
Epoch: 27 cost time: 2.838092803955078
Epoch: 27, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.898 Vali Acc: 0.656 Test Loss: 0.898 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8629205226898193
Epoch: 28, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.885 Vali Acc: 0.672 Test Loss: 0.885 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672213).  Saving model ...
Epoch: 29 cost time: 2.60335111618042
Epoch: 29, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.873 Vali Acc: 0.656 Test Loss: 0.873 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.994910717010498
Epoch: 30, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.847 Vali Acc: 0.672 Test Loss: 0.847 Test Acc: 0.672
Validation loss decreased (-0.672213 --> -0.672214).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6722222222222223
model parameter : 135015
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.922709941864014
Epoch: 1, Steps: 12 | Train Loss: 2.818 Vali Loss: 2.824 Vali Acc: 0.056 Test Loss: 2.824 Test Acc: 0.056
Validation loss decreased (inf --> -0.055527).  Saving model ...
Epoch: 2 cost time: 2.8820602893829346
Epoch: 2, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.775 Vali Acc: 0.072 Test Loss: 2.775 Test Acc: 0.072
Validation loss decreased (-0.055527 --> -0.072194).  Saving model ...
Epoch: 3 cost time: 2.730024576187134
Epoch: 3, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.709 Vali Acc: 0.083 Test Loss: 2.709 Test Acc: 0.083
Validation loss decreased (-0.072194 --> -0.083306).  Saving model ...
Epoch: 4 cost time: 2.624243974685669
Epoch: 4, Steps: 12 | Train Loss: 2.654 Vali Loss: 2.631 Vali Acc: 0.139 Test Loss: 2.631 Test Acc: 0.139
Validation loss decreased (-0.083306 --> -0.138863).  Saving model ...
Epoch: 5 cost time: 2.926398277282715
Epoch: 5, Steps: 12 | Train Loss: 2.543 Vali Loss: 2.539 Vali Acc: 0.272 Test Loss: 2.539 Test Acc: 0.272
Validation loss decreased (-0.138863 --> -0.272197).  Saving model ...
Epoch: 6 cost time: 2.90804123878479
Epoch: 6, Steps: 12 | Train Loss: 2.496 Vali Loss: 2.440 Vali Acc: 0.356 Test Loss: 2.440 Test Acc: 0.356
Validation loss decreased (-0.272197 --> -0.355531).  Saving model ...
Epoch: 7 cost time: 2.73002290725708
Epoch: 7, Steps: 12 | Train Loss: 2.328 Vali Loss: 2.338 Vali Acc: 0.383 Test Loss: 2.338 Test Acc: 0.383
Validation loss decreased (-0.355531 --> -0.383310).  Saving model ...
Epoch: 8 cost time: 2.772594451904297
Epoch: 8, Steps: 12 | Train Loss: 2.213 Vali Loss: 2.234 Vali Acc: 0.411 Test Loss: 2.234 Test Acc: 0.411
Validation loss decreased (-0.383310 --> -0.411089).  Saving model ...
Epoch: 9 cost time: 2.960623264312744
Epoch: 9, Steps: 12 | Train Loss: 2.124 Vali Loss: 2.129 Vali Acc: 0.406 Test Loss: 2.129 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9240128993988037
Epoch: 10, Steps: 12 | Train Loss: 2.027 Vali Loss: 2.029 Vali Acc: 0.444 Test Loss: 2.029 Test Acc: 0.444
Validation loss decreased (-0.411089 --> -0.444424).  Saving model ...
Epoch: 11 cost time: 2.8984124660491943
Epoch: 11, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.927 Vali Acc: 0.472 Test Loss: 1.927 Test Acc: 0.472
Validation loss decreased (-0.444424 --> -0.472203).  Saving model ...
Epoch: 12 cost time: 3.1177427768707275
Epoch: 12, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.830 Vali Acc: 0.511 Test Loss: 1.830 Test Acc: 0.511
Validation loss decreased (-0.472203 --> -0.511093).  Saving model ...
Epoch: 13 cost time: 3.0417697429656982
Epoch: 13, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.730 Vali Acc: 0.522 Test Loss: 1.730 Test Acc: 0.522
Validation loss decreased (-0.511093 --> -0.522205).  Saving model ...
Epoch: 14 cost time: 2.875622510910034
Epoch: 14, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.633 Vali Acc: 0.533 Test Loss: 1.633 Test Acc: 0.533
Validation loss decreased (-0.522205 --> -0.533317).  Saving model ...
Epoch: 15 cost time: 2.9300689697265625
Epoch: 15, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.544 Vali Acc: 0.561 Test Loss: 1.544 Test Acc: 0.561
Validation loss decreased (-0.533317 --> -0.561096).  Saving model ...
Epoch: 16 cost time: 3.0462605953216553
Epoch: 16, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.473 Vali Acc: 0.561 Test Loss: 1.473 Test Acc: 0.561
Validation loss decreased (-0.561096 --> -0.561096).  Saving model ...
Epoch: 17 cost time: 3.0077178478240967
Epoch: 17, Steps: 12 | Train Loss: 1.277 Vali Loss: 1.380 Vali Acc: 0.583 Test Loss: 1.380 Test Acc: 0.583
Validation loss decreased (-0.561096 --> -0.583320).  Saving model ...
Epoch: 18 cost time: 2.8255202770233154
Epoch: 18, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.323 Vali Acc: 0.600 Test Loss: 1.323 Test Acc: 0.600
Validation loss decreased (-0.583320 --> -0.599987).  Saving model ...
Epoch: 19 cost time: 2.8726930618286133
Epoch: 19, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.258 Vali Acc: 0.617 Test Loss: 1.258 Test Acc: 0.617
Validation loss decreased (-0.599987 --> -0.616654).  Saving model ...
Epoch: 20 cost time: 3.0488827228546143
Epoch: 20, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.205 Vali Acc: 0.633 Test Loss: 1.205 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633321).  Saving model ...
Epoch: 21 cost time: 2.919541120529175
Epoch: 21, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.155 Vali Acc: 0.639 Test Loss: 1.155 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 22 cost time: 2.926356077194214
Epoch: 22, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.097 Vali Acc: 0.644 Test Loss: 1.097 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644433).  Saving model ...
Epoch: 23 cost time: 2.9765000343322754
Epoch: 23, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.072 Vali Acc: 0.633 Test Loss: 1.072 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.073446750640869
Epoch: 24, Steps: 12 | Train Loss: 0.834 Vali Loss: 1.029 Vali Acc: 0.683 Test Loss: 1.029 Test Acc: 0.683
Validation loss decreased (-0.644433 --> -0.683323).  Saving model ...
Epoch: 25 cost time: 2.95259690284729
Epoch: 25, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.996 Vali Acc: 0.678 Test Loss: 0.996 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9142086505889893
Epoch: 26, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.957 Vali Acc: 0.678 Test Loss: 0.957 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0487191677093506
Epoch: 27, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.954 Vali Acc: 0.661 Test Loss: 0.954 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.9888455867767334
Epoch: 28, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.920 Vali Acc: 0.706 Test Loss: 0.920 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705546).  Saving model ...
Epoch: 29 cost time: 2.9009664058685303
Epoch: 29, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.896 Vali Acc: 0.706 Test Loss: 0.896 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705547).  Saving model ...
Epoch: 30 cost time: 2.7806179523468018
Epoch: 30, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.868 Vali Acc: 0.706 Test Loss: 0.868 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7055555555555556
model parameter : 445527
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.309705972671509
Epoch: 1, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.715 Vali Acc: 0.078 Test Loss: 2.715 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 2.5380442142486572
Epoch: 2, Steps: 12 | Train Loss: 2.691 Vali Loss: 2.667 Vali Acc: 0.089 Test Loss: 2.667 Test Acc: 0.089
Validation loss decreased (-0.077751 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 2.58625864982605
Epoch: 3, Steps: 12 | Train Loss: 2.628 Vali Loss: 2.605 Vali Acc: 0.122 Test Loss: 2.605 Test Acc: 0.122
Validation loss decreased (-0.088862 --> -0.122196).  Saving model ...
Epoch: 4 cost time: 2.4738826751708984
Epoch: 4, Steps: 12 | Train Loss: 2.561 Vali Loss: 2.537 Vali Acc: 0.167 Test Loss: 2.537 Test Acc: 0.167
Validation loss decreased (-0.122196 --> -0.166641).  Saving model ...
Epoch: 5 cost time: 2.5039074420928955
Epoch: 5, Steps: 12 | Train Loss: 2.509 Vali Loss: 2.466 Vali Acc: 0.200 Test Loss: 2.466 Test Acc: 0.200
Validation loss decreased (-0.166641 --> -0.199975).  Saving model ...
Epoch: 6 cost time: 2.5455164909362793
Epoch: 6, Steps: 12 | Train Loss: 2.414 Vali Loss: 2.389 Vali Acc: 0.239 Test Loss: 2.389 Test Acc: 0.239
Validation loss decreased (-0.199975 --> -0.238865).  Saving model ...
Epoch: 7 cost time: 2.493213176727295
Epoch: 7, Steps: 12 | Train Loss: 2.331 Vali Loss: 2.310 Vali Acc: 0.322 Test Loss: 2.310 Test Acc: 0.322
Validation loss decreased (-0.238865 --> -0.322199).  Saving model ...
Epoch: 8 cost time: 2.3882107734680176
Epoch: 8, Steps: 12 | Train Loss: 2.225 Vali Loss: 2.229 Vali Acc: 0.378 Test Loss: 2.229 Test Acc: 0.378
Validation loss decreased (-0.322199 --> -0.377755).  Saving model ...
Epoch: 9 cost time: 2.4337360858917236
Epoch: 9, Steps: 12 | Train Loss: 2.128 Vali Loss: 2.140 Vali Acc: 0.383 Test Loss: 2.140 Test Acc: 0.383
Validation loss decreased (-0.377755 --> -0.383312).  Saving model ...
Epoch: 10 cost time: 2.5506465435028076
Epoch: 10, Steps: 12 | Train Loss: 2.007 Vali Loss: 2.050 Vali Acc: 0.439 Test Loss: 2.050 Test Acc: 0.439
Validation loss decreased (-0.383312 --> -0.438868).  Saving model ...
Epoch: 11 cost time: 2.4823837280273438
Epoch: 11, Steps: 12 | Train Loss: 1.896 Vali Loss: 1.957 Vali Acc: 0.444 Test Loss: 1.957 Test Acc: 0.444
Validation loss decreased (-0.438868 --> -0.444425).  Saving model ...
Epoch: 12 cost time: 2.4725100994110107
Epoch: 12, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.862 Vali Acc: 0.456 Test Loss: 1.862 Test Acc: 0.456
Validation loss decreased (-0.444425 --> -0.455537).  Saving model ...
Epoch: 13 cost time: 2.471803665161133
Epoch: 13, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.771 Vali Acc: 0.506 Test Loss: 1.771 Test Acc: 0.506
Validation loss decreased (-0.455537 --> -0.505538).  Saving model ...
Epoch: 14 cost time: 2.513930082321167
Epoch: 14, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.686 Vali Acc: 0.528 Test Loss: 1.686 Test Acc: 0.528
Validation loss decreased (-0.505538 --> -0.527761).  Saving model ...
Epoch: 15 cost time: 2.4458682537078857
Epoch: 15, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.611 Vali Acc: 0.528 Test Loss: 1.611 Test Acc: 0.528
Validation loss decreased (-0.527761 --> -0.527762).  Saving model ...
Epoch: 16 cost time: 2.353264570236206
Epoch: 16, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.536 Vali Acc: 0.550 Test Loss: 1.536 Test Acc: 0.550
Validation loss decreased (-0.527762 --> -0.549985).  Saving model ...
Epoch: 17 cost time: 2.5542867183685303
Epoch: 17, Steps: 12 | Train Loss: 1.235 Vali Loss: 1.471 Vali Acc: 0.550 Test Loss: 1.471 Test Acc: 0.550
Validation loss decreased (-0.549985 --> -0.549985).  Saving model ...
Epoch: 18 cost time: 2.5262327194213867
Epoch: 18, Steps: 12 | Train Loss: 1.217 Vali Loss: 1.415 Vali Acc: 0.544 Test Loss: 1.415 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.593733549118042
Epoch: 19, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.344 Vali Acc: 0.550 Test Loss: 1.344 Test Acc: 0.550
Validation loss decreased (-0.549985 --> -0.549987).  Saving model ...
Epoch: 20 cost time: 2.446707010269165
Epoch: 20, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.280 Vali Acc: 0.567 Test Loss: 1.280 Test Acc: 0.567
Validation loss decreased (-0.549987 --> -0.566654).  Saving model ...
Epoch: 21 cost time: 2.5319552421569824
Epoch: 21, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.228 Vali Acc: 0.600 Test Loss: 1.228 Test Acc: 0.600
Validation loss decreased (-0.566654 --> -0.599988).  Saving model ...
Epoch: 22 cost time: 2.535261392593384
Epoch: 22, Steps: 12 | Train Loss: 0.902 Vali Loss: 1.192 Vali Acc: 0.594 Test Loss: 1.192 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3265583515167236
Epoch: 23, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.151 Vali Acc: 0.594 Test Loss: 1.151 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.4231679439544678
Epoch: 24, Steps: 12 | Train Loss: 0.856 Vali Loss: 1.117 Vali Acc: 0.594 Test Loss: 1.117 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.558009624481201
Epoch: 25, Steps: 12 | Train Loss: 0.774 Vali Loss: 1.076 Vali Acc: 0.606 Test Loss: 1.076 Test Acc: 0.606
Validation loss decreased (-0.599988 --> -0.605545).  Saving model ...
Epoch: 26 cost time: 2.5042219161987305
Epoch: 26, Steps: 12 | Train Loss: 0.799 Vali Loss: 1.046 Vali Acc: 0.628 Test Loss: 1.046 Test Acc: 0.628
Validation loss decreased (-0.605545 --> -0.627767).  Saving model ...
Epoch: 27 cost time: 2.4240365028381348
Epoch: 27, Steps: 12 | Train Loss: 0.701 Vali Loss: 1.013 Vali Acc: 0.644 Test Loss: 1.013 Test Acc: 0.644
Validation loss decreased (-0.627767 --> -0.644434).  Saving model ...
Epoch: 28 cost time: 2.4305579662323
Epoch: 28, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.989 Vali Acc: 0.650 Test Loss: 0.989 Test Acc: 0.650
Validation loss decreased (-0.644434 --> -0.649990).  Saving model ...
Epoch: 29 cost time: 2.561392307281494
Epoch: 29, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.967 Vali Acc: 0.644 Test Loss: 0.967 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.515349864959717
Epoch: 30, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.922 Vali Acc: 0.661 Test Loss: 0.922 Test Acc: 0.661
Validation loss decreased (-0.649990 --> -0.661102).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6611111111111111
model parameter : 135015
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.142928123474121
Epoch: 1, Steps: 12 | Train Loss: 2.816 Vali Loss: 2.826 Vali Acc: 0.056 Test Loss: 2.826 Test Acc: 0.056
Validation loss decreased (inf --> -0.055527).  Saving model ...
Epoch: 2 cost time: 2.2991342544555664
Epoch: 2, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.785 Vali Acc: 0.067 Test Loss: 2.785 Test Acc: 0.067
Validation loss decreased (-0.055527 --> -0.066639).  Saving model ...
Epoch: 3 cost time: 2.1978442668914795
Epoch: 3, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.730 Vali Acc: 0.078 Test Loss: 2.730 Test Acc: 0.078
Validation loss decreased (-0.066639 --> -0.077750).  Saving model ...
Epoch: 4 cost time: 2.2665770053863525
Epoch: 4, Steps: 12 | Train Loss: 2.675 Vali Loss: 2.667 Vali Acc: 0.089 Test Loss: 2.667 Test Acc: 0.089
Validation loss decreased (-0.077750 --> -0.088862).  Saving model ...
Epoch: 5 cost time: 2.419563055038452
Epoch: 5, Steps: 12 | Train Loss: 2.577 Vali Loss: 2.591 Vali Acc: 0.194 Test Loss: 2.591 Test Acc: 0.194
Validation loss decreased (-0.088862 --> -0.194419).  Saving model ...
Epoch: 6 cost time: 2.377197027206421
Epoch: 6, Steps: 12 | Train Loss: 2.542 Vali Loss: 2.509 Vali Acc: 0.244 Test Loss: 2.509 Test Acc: 0.244
Validation loss decreased (-0.194419 --> -0.244419).  Saving model ...
Epoch: 7 cost time: 2.2987163066864014
Epoch: 7, Steps: 12 | Train Loss: 2.400 Vali Loss: 2.424 Vali Acc: 0.294 Test Loss: 2.424 Test Acc: 0.294
Validation loss decreased (-0.244419 --> -0.294420).  Saving model ...
Epoch: 8 cost time: 2.184880256652832
Epoch: 8, Steps: 12 | Train Loss: 2.311 Vali Loss: 2.337 Vali Acc: 0.317 Test Loss: 2.337 Test Acc: 0.317
Validation loss decreased (-0.294420 --> -0.316643).  Saving model ...
Epoch: 9 cost time: 2.3443470001220703
Epoch: 9, Steps: 12 | Train Loss: 2.239 Vali Loss: 2.245 Vali Acc: 0.344 Test Loss: 2.245 Test Acc: 0.344
Validation loss decreased (-0.316643 --> -0.344422).  Saving model ...
Epoch: 10 cost time: 2.2819857597351074
Epoch: 10, Steps: 12 | Train Loss: 2.136 Vali Loss: 2.161 Vali Acc: 0.394 Test Loss: 2.161 Test Acc: 0.394
Validation loss decreased (-0.344422 --> -0.394423).  Saving model ...
Epoch: 11 cost time: 2.2158000469207764
Epoch: 11, Steps: 12 | Train Loss: 2.023 Vali Loss: 2.075 Vali Acc: 0.417 Test Loss: 2.075 Test Acc: 0.417
Validation loss decreased (-0.394423 --> -0.416646).  Saving model ...
Epoch: 12 cost time: 2.2118916511535645
Epoch: 12, Steps: 12 | Train Loss: 1.976 Vali Loss: 1.993 Vali Acc: 0.439 Test Loss: 1.993 Test Acc: 0.439
Validation loss decreased (-0.416646 --> -0.438869).  Saving model ...
Epoch: 13 cost time: 2.12764835357666
Epoch: 13, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.913 Vali Acc: 0.472 Test Loss: 1.913 Test Acc: 0.472
Validation loss decreased (-0.438869 --> -0.472203).  Saving model ...
Epoch: 14 cost time: 2.2823238372802734
Epoch: 14, Steps: 12 | Train Loss: 1.750 Vali Loss: 1.833 Vali Acc: 0.506 Test Loss: 1.833 Test Acc: 0.506
Validation loss decreased (-0.472203 --> -0.505537).  Saving model ...
Epoch: 15 cost time: 2.248702049255371
Epoch: 15, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.759 Vali Acc: 0.528 Test Loss: 1.759 Test Acc: 0.528
Validation loss decreased (-0.505537 --> -0.527760).  Saving model ...
Epoch: 16 cost time: 2.1880667209625244
Epoch: 16, Steps: 12 | Train Loss: 1.577 Vali Loss: 1.691 Vali Acc: 0.528 Test Loss: 1.691 Test Acc: 0.528
Validation loss decreased (-0.527760 --> -0.527761).  Saving model ...
Epoch: 17 cost time: 2.3137574195861816
Epoch: 17, Steps: 12 | Train Loss: 1.487 Vali Loss: 1.605 Vali Acc: 0.539 Test Loss: 1.605 Test Acc: 0.539
Validation loss decreased (-0.527761 --> -0.538873).  Saving model ...
Epoch: 18 cost time: 2.297787666320801
Epoch: 18, Steps: 12 | Train Loss: 1.421 Vali Loss: 1.545 Vali Acc: 0.556 Test Loss: 1.545 Test Acc: 0.556
Validation loss decreased (-0.538873 --> -0.555540).  Saving model ...
Epoch: 19 cost time: 2.3680765628814697
Epoch: 19, Steps: 12 | Train Loss: 1.363 Vali Loss: 1.484 Vali Acc: 0.589 Test Loss: 1.484 Test Acc: 0.589
Validation loss decreased (-0.555540 --> -0.588874).  Saving model ...
Epoch: 20 cost time: 2.2147607803344727
Epoch: 20, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.430 Vali Acc: 0.589 Test Loss: 1.430 Test Acc: 0.589
Validation loss decreased (-0.588874 --> -0.588875).  Saving model ...
Epoch: 21 cost time: 2.270439624786377
Epoch: 21, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.373 Vali Acc: 0.606 Test Loss: 1.373 Test Acc: 0.606
Validation loss decreased (-0.588875 --> -0.605542).  Saving model ...
Epoch: 22 cost time: 2.2782065868377686
Epoch: 22, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.311 Vali Acc: 0.617 Test Loss: 1.311 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616654).  Saving model ...
Epoch: 23 cost time: 2.3578882217407227
Epoch: 23, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.277 Vali Acc: 0.622 Test Loss: 1.277 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622209).  Saving model ...
Epoch: 24 cost time: 2.256232261657715
Epoch: 24, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.224 Vali Acc: 0.667 Test Loss: 1.224 Test Acc: 0.667
Validation loss decreased (-0.622209 --> -0.666654).  Saving model ...
Epoch: 25 cost time: 2.1916396617889404
Epoch: 25, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.183 Vali Acc: 0.644 Test Loss: 1.183 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.017740249633789
Epoch: 26, Steps: 12 | Train Loss: 0.912 Vali Loss: 1.141 Vali Acc: 0.650 Test Loss: 1.141 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3077900409698486
Epoch: 27, Steps: 12 | Train Loss: 0.870 Vali Loss: 1.102 Vali Acc: 0.639 Test Loss: 1.102 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8827342987060547
Epoch: 28, Steps: 12 | Train Loss: 0.843 Vali Loss: 1.095 Vali Acc: 0.633 Test Loss: 1.095 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9007477760314941
Epoch: 29, Steps: 12 | Train Loss: 0.741 Vali Loss: 1.069 Vali Acc: 0.672 Test Loss: 1.069 Test Acc: 0.672
Validation loss decreased (-0.666654 --> -0.672212).  Saving model ...
Epoch: 30 cost time: 2.373734712600708
Epoch: 30, Steps: 12 | Train Loss: 0.799 Vali Loss: 1.043 Vali Acc: 0.683 Test Loss: 1.043 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683323).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6833333333333333
model parameter : 445527
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5119075775146484
Epoch: 1, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.720 Vali Acc: 0.072 Test Loss: 2.720 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 2.1086883544921875
Epoch: 2, Steps: 12 | Train Loss: 2.695 Vali Loss: 2.678 Vali Acc: 0.083 Test Loss: 2.678 Test Acc: 0.083
Validation loss decreased (-0.072195 --> -0.083307).  Saving model ...
Epoch: 3 cost time: 1.9307670593261719
Epoch: 3, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.624 Vali Acc: 0.106 Test Loss: 2.624 Test Acc: 0.106
Validation loss decreased (-0.083307 --> -0.105529).  Saving model ...
Epoch: 4 cost time: 1.9037773609161377
Epoch: 4, Steps: 12 | Train Loss: 2.578 Vali Loss: 2.564 Vali Acc: 0.150 Test Loss: 2.564 Test Acc: 0.150
Validation loss decreased (-0.105529 --> -0.149974).  Saving model ...
Epoch: 5 cost time: 1.947763442993164
Epoch: 5, Steps: 12 | Train Loss: 2.533 Vali Loss: 2.502 Vali Acc: 0.178 Test Loss: 2.502 Test Acc: 0.178
Validation loss decreased (-0.149974 --> -0.177753).  Saving model ...
Epoch: 6 cost time: 1.982313871383667
Epoch: 6, Steps: 12 | Train Loss: 2.452 Vali Loss: 2.435 Vali Acc: 0.200 Test Loss: 2.435 Test Acc: 0.200
Validation loss decreased (-0.177753 --> -0.199976).  Saving model ...
Epoch: 7 cost time: 2.084696054458618
Epoch: 7, Steps: 12 | Train Loss: 2.375 Vali Loss: 2.368 Vali Acc: 0.300 Test Loss: 2.368 Test Acc: 0.300
Validation loss decreased (-0.199976 --> -0.299976).  Saving model ...
Epoch: 8 cost time: 1.9226245880126953
Epoch: 8, Steps: 12 | Train Loss: 2.285 Vali Loss: 2.299 Vali Acc: 0.328 Test Loss: 2.299 Test Acc: 0.328
Validation loss decreased (-0.299976 --> -0.327755).  Saving model ...
Epoch: 9 cost time: 1.943237066268921
Epoch: 9, Steps: 12 | Train Loss: 2.196 Vali Loss: 2.224 Vali Acc: 0.339 Test Loss: 2.224 Test Acc: 0.339
Validation loss decreased (-0.327755 --> -0.338867).  Saving model ...
Epoch: 10 cost time: 1.9670038223266602
Epoch: 10, Steps: 12 | Train Loss: 2.096 Vali Loss: 2.150 Vali Acc: 0.356 Test Loss: 2.150 Test Acc: 0.356
Validation loss decreased (-0.338867 --> -0.355534).  Saving model ...
Epoch: 11 cost time: 1.9763081073760986
Epoch: 11, Steps: 12 | Train Loss: 1.997 Vali Loss: 2.075 Vali Acc: 0.361 Test Loss: 2.075 Test Acc: 0.361
Validation loss decreased (-0.355534 --> -0.361090).  Saving model ...
Epoch: 12 cost time: 2.1020281314849854
Epoch: 12, Steps: 12 | Train Loss: 1.913 Vali Loss: 1.996 Vali Acc: 0.406 Test Loss: 1.996 Test Acc: 0.406
Validation loss decreased (-0.361090 --> -0.405536).  Saving model ...
Epoch: 13 cost time: 1.9142541885375977
Epoch: 13, Steps: 12 | Train Loss: 1.817 Vali Loss: 1.922 Vali Acc: 0.417 Test Loss: 1.922 Test Acc: 0.417
Validation loss decreased (-0.405536 --> -0.416647).  Saving model ...
Epoch: 14 cost time: 2.0864672660827637
Epoch: 14, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.848 Vali Acc: 0.456 Test Loss: 1.848 Test Acc: 0.456
Validation loss decreased (-0.416647 --> -0.455537).  Saving model ...
Epoch: 15 cost time: 1.9325571060180664
Epoch: 15, Steps: 12 | Train Loss: 1.644 Vali Loss: 1.781 Vali Acc: 0.478 Test Loss: 1.781 Test Acc: 0.478
Validation loss decreased (-0.455537 --> -0.477760).  Saving model ...
Epoch: 16 cost time: 2.0836920738220215
Epoch: 16, Steps: 12 | Train Loss: 1.520 Vali Loss: 1.717 Vali Acc: 0.511 Test Loss: 1.717 Test Acc: 0.511
Validation loss decreased (-0.477760 --> -0.511094).  Saving model ...
Epoch: 17 cost time: 2.023313283920288
Epoch: 17, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.657 Vali Acc: 0.500 Test Loss: 1.657 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.921199083328247
Epoch: 18, Steps: 12 | Train Loss: 1.437 Vali Loss: 1.599 Vali Acc: 0.506 Test Loss: 1.599 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0858094692230225
Epoch: 19, Steps: 12 | Train Loss: 1.343 Vali Loss: 1.528 Vali Acc: 0.500 Test Loss: 1.528 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.991558313369751
Epoch: 20, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.472 Vali Acc: 0.511 Test Loss: 1.472 Test Acc: 0.511
Validation loss decreased (-0.511094 --> -0.511096).  Saving model ...
Epoch: 21 cost time: 1.966895580291748
Epoch: 21, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.415 Vali Acc: 0.544 Test Loss: 1.415 Test Acc: 0.544
Validation loss decreased (-0.511096 --> -0.544430).  Saving model ...
Epoch: 22 cost time: 1.8078148365020752
Epoch: 22, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.380 Vali Acc: 0.556 Test Loss: 1.380 Test Acc: 0.556
Validation loss decreased (-0.544430 --> -0.555542).  Saving model ...
Epoch: 23 cost time: 1.901733636856079
Epoch: 23, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.338 Vali Acc: 0.550 Test Loss: 1.338 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.849104881286621
Epoch: 24, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.293 Vali Acc: 0.572 Test Loss: 1.293 Test Acc: 0.572
Validation loss decreased (-0.555542 --> -0.572209).  Saving model ...
Epoch: 25 cost time: 1.8057310581207275
Epoch: 25, Steps: 12 | Train Loss: 0.962 Vali Loss: 1.254 Vali Acc: 0.572 Test Loss: 1.254 Test Acc: 0.572
Validation loss decreased (-0.572209 --> -0.572210).  Saving model ...
Epoch: 26 cost time: 1.9902172088623047
Epoch: 26, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.231 Vali Acc: 0.611 Test Loss: 1.231 Test Acc: 0.611
Validation loss decreased (-0.572210 --> -0.611099).  Saving model ...
Epoch: 27 cost time: 1.8468587398529053
Epoch: 27, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.184 Vali Acc: 0.622 Test Loss: 1.184 Test Acc: 0.622
Validation loss decreased (-0.611099 --> -0.622210).  Saving model ...
Epoch: 28 cost time: 1.77750825881958
Epoch: 28, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.163 Vali Acc: 0.617 Test Loss: 1.163 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7636351585388184
Epoch: 29, Steps: 12 | Train Loss: 0.808 Vali Loss: 1.124 Vali Acc: 0.617 Test Loss: 1.124 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8730628490447998
Epoch: 30, Steps: 12 | Train Loss: 0.778 Vali Loss: 1.116 Vali Acc: 0.622 Test Loss: 1.116 Test Acc: 0.622
Validation loss decreased (-0.622210 --> -0.622211).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6222222222222222
model parameter : 135015
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.562281370162964
Epoch: 1, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.735 Vali Acc: 0.067 Test Loss: 2.735 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 2.7511541843414307
Epoch: 2, Steps: 12 | Train Loss: 2.740 Vali Loss: 2.693 Vali Acc: 0.078 Test Loss: 2.693 Test Acc: 0.078
Validation loss decreased (-0.066639 --> -0.077751).  Saving model ...
Epoch: 3 cost time: 2.4848504066467285
Epoch: 3, Steps: 12 | Train Loss: 2.652 Vali Loss: 2.634 Vali Acc: 0.106 Test Loss: 2.634 Test Acc: 0.106
Validation loss decreased (-0.077751 --> -0.105529).  Saving model ...
Epoch: 4 cost time: 2.633936882019043
Epoch: 4, Steps: 12 | Train Loss: 2.577 Vali Loss: 2.566 Vali Acc: 0.117 Test Loss: 2.566 Test Acc: 0.117
Validation loss decreased (-0.105529 --> -0.116641).  Saving model ...
Epoch: 5 cost time: 2.780470371246338
Epoch: 5, Steps: 12 | Train Loss: 2.495 Vali Loss: 2.489 Vali Acc: 0.183 Test Loss: 2.489 Test Acc: 0.183
Validation loss decreased (-0.116641 --> -0.183308).  Saving model ...
Epoch: 6 cost time: 2.5570061206817627
Epoch: 6, Steps: 12 | Train Loss: 2.411 Vali Loss: 2.404 Vali Acc: 0.256 Test Loss: 2.404 Test Acc: 0.256
Validation loss decreased (-0.183308 --> -0.255532).  Saving model ...
Epoch: 7 cost time: 2.7515475749969482
Epoch: 7, Steps: 12 | Train Loss: 2.296 Vali Loss: 2.307 Vali Acc: 0.383 Test Loss: 2.307 Test Acc: 0.383
Validation loss decreased (-0.255532 --> -0.383310).  Saving model ...
Epoch: 8 cost time: 2.7015750408172607
Epoch: 8, Steps: 12 | Train Loss: 2.195 Vali Loss: 2.202 Vali Acc: 0.472 Test Loss: 2.202 Test Acc: 0.472
Validation loss decreased (-0.383310 --> -0.472200).  Saving model ...
Epoch: 9 cost time: 2.787290096282959
Epoch: 9, Steps: 12 | Train Loss: 2.085 Vali Loss: 2.087 Vali Acc: 0.506 Test Loss: 2.087 Test Acc: 0.506
Validation loss decreased (-0.472200 --> -0.505535).  Saving model ...
Epoch: 10 cost time: 2.9383349418640137
Epoch: 10, Steps: 12 | Train Loss: 1.921 Vali Loss: 1.973 Vali Acc: 0.500 Test Loss: 1.973 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.712735176086426
Epoch: 11, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.861 Vali Acc: 0.522 Test Loss: 1.861 Test Acc: 0.522
Validation loss decreased (-0.505535 --> -0.522204).  Saving model ...
Epoch: 12 cost time: 2.978742837905884
Epoch: 12, Steps: 12 | Train Loss: 1.692 Vali Loss: 1.734 Vali Acc: 0.556 Test Loss: 1.734 Test Acc: 0.556
Validation loss decreased (-0.522204 --> -0.555538).  Saving model ...
Epoch: 13 cost time: 2.8125011920928955
Epoch: 13, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.619 Vali Acc: 0.578 Test Loss: 1.619 Test Acc: 0.578
Validation loss decreased (-0.555538 --> -0.577762).  Saving model ...
Epoch: 14 cost time: 3.056187391281128
Epoch: 14, Steps: 12 | Train Loss: 1.414 Vali Loss: 1.504 Vali Acc: 0.600 Test Loss: 1.504 Test Acc: 0.600
Validation loss decreased (-0.577762 --> -0.599985).  Saving model ...
Epoch: 15 cost time: 3.2131412029266357
Epoch: 15, Steps: 12 | Train Loss: 1.328 Vali Loss: 1.407 Vali Acc: 0.611 Test Loss: 1.407 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611097).  Saving model ...
Epoch: 16 cost time: 3.0411550998687744
Epoch: 16, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.316 Vali Acc: 0.644 Test Loss: 1.316 Test Acc: 0.644
Validation loss decreased (-0.611097 --> -0.644431).  Saving model ...
Epoch: 17 cost time: 3.090097188949585
Epoch: 17, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.244 Vali Acc: 0.667 Test Loss: 1.244 Test Acc: 0.667
Validation loss decreased (-0.644431 --> -0.666654).  Saving model ...
Epoch: 18 cost time: 3.0497522354125977
Epoch: 18, Steps: 12 | Train Loss: 1.010 Vali Loss: 1.174 Vali Acc: 0.683 Test Loss: 1.174 Test Acc: 0.683
Validation loss decreased (-0.666654 --> -0.683322).  Saving model ...
Epoch: 19 cost time: 2.979296922683716
Epoch: 19, Steps: 12 | Train Loss: 1.012 Vali Loss: 1.114 Vali Acc: 0.672 Test Loss: 1.114 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2323567867279053
Epoch: 20, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.066 Vali Acc: 0.683 Test Loss: 1.066 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683323).  Saving model ...
Epoch: 21 cost time: 3.030865430831909
Epoch: 21, Steps: 12 | Train Loss: 0.844 Vali Loss: 1.032 Vali Acc: 0.689 Test Loss: 1.032 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 22 cost time: 3.049240827560425
Epoch: 22, Steps: 12 | Train Loss: 0.840 Vali Loss: 0.993 Vali Acc: 0.694 Test Loss: 0.993 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 23 cost time: 3.1292707920074463
Epoch: 23, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.947 Vali Acc: 0.717 Test Loss: 0.947 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716657).  Saving model ...
Epoch: 24 cost time: 2.9737486839294434
Epoch: 24, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.929 Vali Acc: 0.700 Test Loss: 0.929 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.867677927017212
Epoch: 25, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.898 Vali Acc: 0.717 Test Loss: 0.898 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716658).  Saving model ...
Epoch: 26 cost time: 2.6051950454711914
Epoch: 26, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.876 Vali Acc: 0.728 Test Loss: 0.876 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727769).  Saving model ...
Epoch: 27 cost time: 2.788041591644287
Epoch: 27, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.852 Vali Acc: 0.739 Test Loss: 0.852 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738880).  Saving model ...
Epoch: 28 cost time: 2.9725611209869385
Epoch: 28, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.818 Vali Acc: 0.744 Test Loss: 0.818 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 29 cost time: 3.1155617237091064
Epoch: 29, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.801 Vali Acc: 0.733 Test Loss: 0.801 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.988678455352783
Epoch: 30, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.786 Vali Acc: 0.733 Test Loss: 0.786 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 225591
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.2700207233428955
Epoch: 1, Steps: 12 | Train Loss: 2.836 Vali Loss: 2.745 Vali Acc: 0.106 Test Loss: 2.745 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 2.585202217102051
Epoch: 2, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.699 Vali Acc: 0.139 Test Loss: 2.699 Test Acc: 0.139
Validation loss decreased (-0.105528 --> -0.138862).  Saving model ...
Epoch: 3 cost time: 2.3759095668792725
Epoch: 3, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.638 Vali Acc: 0.150 Test Loss: 2.638 Test Acc: 0.150
Validation loss decreased (-0.138862 --> -0.149974).  Saving model ...
Epoch: 4 cost time: 2.7707161903381348
Epoch: 4, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.569 Vali Acc: 0.206 Test Loss: 2.569 Test Acc: 0.206
Validation loss decreased (-0.149974 --> -0.205530).  Saving model ...
Epoch: 5 cost time: 2.6057121753692627
Epoch: 5, Steps: 12 | Train Loss: 2.562 Vali Loss: 2.492 Vali Acc: 0.283 Test Loss: 2.492 Test Acc: 0.283
Validation loss decreased (-0.205530 --> -0.283308).  Saving model ...
Epoch: 6 cost time: 2.777806282043457
Epoch: 6, Steps: 12 | Train Loss: 2.486 Vali Loss: 2.409 Vali Acc: 0.333 Test Loss: 2.409 Test Acc: 0.333
Validation loss decreased (-0.283308 --> -0.333309).  Saving model ...
Epoch: 7 cost time: 2.527531862258911
Epoch: 7, Steps: 12 | Train Loss: 2.395 Vali Loss: 2.322 Vali Acc: 0.378 Test Loss: 2.322 Test Acc: 0.378
Validation loss decreased (-0.333309 --> -0.377755).  Saving model ...
Epoch: 8 cost time: 2.658277750015259
Epoch: 8, Steps: 12 | Train Loss: 2.279 Vali Loss: 2.237 Vali Acc: 0.417 Test Loss: 2.237 Test Acc: 0.417
Validation loss decreased (-0.377755 --> -0.416644).  Saving model ...
Epoch: 9 cost time: 2.4636666774749756
Epoch: 9, Steps: 12 | Train Loss: 2.183 Vali Loss: 2.143 Vali Acc: 0.461 Test Loss: 2.143 Test Acc: 0.461
Validation loss decreased (-0.416644 --> -0.461090).  Saving model ...
Epoch: 10 cost time: 2.9241654872894287
Epoch: 10, Steps: 12 | Train Loss: 2.102 Vali Loss: 2.054 Vali Acc: 0.500 Test Loss: 2.054 Test Acc: 0.500
Validation loss decreased (-0.461090 --> -0.499979).  Saving model ...
Epoch: 11 cost time: 2.7634124755859375
Epoch: 11, Steps: 12 | Train Loss: 2.026 Vali Loss: 1.965 Vali Acc: 0.539 Test Loss: 1.965 Test Acc: 0.539
Validation loss decreased (-0.499979 --> -0.538869).  Saving model ...
Epoch: 12 cost time: 2.840506076812744
Epoch: 12, Steps: 12 | Train Loss: 1.911 Vali Loss: 1.874 Vali Acc: 0.550 Test Loss: 1.874 Test Acc: 0.550
Validation loss decreased (-0.538869 --> -0.549981).  Saving model ...
Epoch: 13 cost time: 2.7355926036834717
Epoch: 13, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.786 Vali Acc: 0.578 Test Loss: 1.786 Test Acc: 0.578
Validation loss decreased (-0.549981 --> -0.577760).  Saving model ...
Epoch: 14 cost time: 2.326094150543213
Epoch: 14, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.699 Vali Acc: 0.583 Test Loss: 1.699 Test Acc: 0.583
Validation loss decreased (-0.577760 --> -0.583316).  Saving model ...
Epoch: 15 cost time: 2.731782913208008
Epoch: 15, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.612 Vali Acc: 0.578 Test Loss: 1.612 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.682889938354492
Epoch: 16, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.529 Vali Acc: 0.622 Test Loss: 1.529 Test Acc: 0.622
Validation loss decreased (-0.583316 --> -0.622207).  Saving model ...
Epoch: 17 cost time: 2.7332839965820312
Epoch: 17, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.451 Vali Acc: 0.622 Test Loss: 1.451 Test Acc: 0.622
Validation loss decreased (-0.622207 --> -0.622208).  Saving model ...
Epoch: 18 cost time: 2.582979917526245
Epoch: 18, Steps: 12 | Train Loss: 1.298 Vali Loss: 1.381 Vali Acc: 0.639 Test Loss: 1.381 Test Acc: 0.639
Validation loss decreased (-0.622208 --> -0.638875).  Saving model ...
Epoch: 19 cost time: 2.755124092102051
Epoch: 19, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.311 Vali Acc: 0.633 Test Loss: 1.311 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.640659809112549
Epoch: 20, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.247 Vali Acc: 0.667 Test Loss: 1.247 Test Acc: 0.667
Validation loss decreased (-0.638875 --> -0.666654).  Saving model ...
Epoch: 21 cost time: 2.746022939682007
Epoch: 21, Steps: 12 | Train Loss: 1.073 Vali Loss: 1.186 Vali Acc: 0.678 Test Loss: 1.186 Test Acc: 0.678
Validation loss decreased (-0.666654 --> -0.677766).  Saving model ...
Epoch: 22 cost time: 2.6706759929656982
Epoch: 22, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.131 Vali Acc: 0.683 Test Loss: 1.131 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683322).  Saving model ...
Epoch: 23 cost time: 2.74289608001709
Epoch: 23, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.084 Vali Acc: 0.694 Test Loss: 1.084 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694434).  Saving model ...
Epoch: 24 cost time: 2.5765841007232666
Epoch: 24, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.050 Vali Acc: 0.711 Test Loss: 1.050 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711101).  Saving model ...
Epoch: 25 cost time: 2.8611977100372314
Epoch: 25, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.015 Vali Acc: 0.733 Test Loss: 1.015 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733323).  Saving model ...
Epoch: 26 cost time: 2.6123762130737305
Epoch: 26, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.979 Vali Acc: 0.722 Test Loss: 0.979 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7751426696777344
Epoch: 27, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.945 Vali Acc: 0.711 Test Loss: 0.945 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.688626289367676
Epoch: 28, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.918 Vali Acc: 0.711 Test Loss: 0.918 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.364176034927368
Epoch: 29, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.891 Vali Acc: 0.733 Test Loss: 0.891 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733324).  Saving model ...
Epoch: 30 cost time: 2.39050555229187
Epoch: 30, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.873 Vali Acc: 0.728 Test Loss: 0.873 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7333333333333333
model parameter : 70311
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.124748945236206
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.735 Vali Acc: 0.067 Test Loss: 2.735 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 2.281122922897339
Epoch: 2, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.693 Vali Acc: 0.078 Test Loss: 2.693 Test Acc: 0.078
Validation loss decreased (-0.066639 --> -0.077751).  Saving model ...
Epoch: 3 cost time: 2.0379979610443115
Epoch: 3, Steps: 12 | Train Loss: 2.652 Vali Loss: 2.635 Vali Acc: 0.106 Test Loss: 2.635 Test Acc: 0.106
Validation loss decreased (-0.077751 --> -0.105529).  Saving model ...
Epoch: 4 cost time: 2.1258082389831543
Epoch: 4, Steps: 12 | Train Loss: 2.580 Vali Loss: 2.569 Vali Acc: 0.122 Test Loss: 2.569 Test Acc: 0.122
Validation loss decreased (-0.105529 --> -0.122197).  Saving model ...
Epoch: 5 cost time: 2.3572041988372803
Epoch: 5, Steps: 12 | Train Loss: 2.498 Vali Loss: 2.493 Vali Acc: 0.183 Test Loss: 2.493 Test Acc: 0.183
Validation loss decreased (-0.122197 --> -0.183308).  Saving model ...
Epoch: 6 cost time: 2.2787702083587646
Epoch: 6, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.409 Vali Acc: 0.250 Test Loss: 2.409 Test Acc: 0.250
Validation loss decreased (-0.183308 --> -0.249976).  Saving model ...
Epoch: 7 cost time: 2.1151115894317627
Epoch: 7, Steps: 12 | Train Loss: 2.304 Vali Loss: 2.315 Vali Acc: 0.367 Test Loss: 2.315 Test Acc: 0.367
Validation loss decreased (-0.249976 --> -0.366644).  Saving model ...
Epoch: 8 cost time: 2.358607769012451
Epoch: 8, Steps: 12 | Train Loss: 2.209 Vali Loss: 2.216 Vali Acc: 0.444 Test Loss: 2.216 Test Acc: 0.444
Validation loss decreased (-0.366644 --> -0.444422).  Saving model ...
Epoch: 9 cost time: 2.33482027053833
Epoch: 9, Steps: 12 | Train Loss: 2.106 Vali Loss: 2.111 Vali Acc: 0.483 Test Loss: 2.111 Test Acc: 0.483
Validation loss decreased (-0.444422 --> -0.483312).  Saving model ...
Epoch: 10 cost time: 2.2213943004608154
Epoch: 10, Steps: 12 | Train Loss: 1.974 Vali Loss: 2.010 Vali Acc: 0.500 Test Loss: 2.010 Test Acc: 0.500
Validation loss decreased (-0.483312 --> -0.499980).  Saving model ...
Epoch: 11 cost time: 2.2093024253845215
Epoch: 11, Steps: 12 | Train Loss: 1.882 Vali Loss: 1.910 Vali Acc: 0.494 Test Loss: 1.910 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3972833156585693
Epoch: 12, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.803 Vali Acc: 0.533 Test Loss: 1.803 Test Acc: 0.533
Validation loss decreased (-0.499980 --> -0.533315).  Saving model ...
Epoch: 13 cost time: 2.078129291534424
Epoch: 13, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.711 Vali Acc: 0.533 Test Loss: 1.711 Test Acc: 0.533
Validation loss decreased (-0.533315 --> -0.533316).  Saving model ...
Epoch: 14 cost time: 2.4056084156036377
Epoch: 14, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.615 Vali Acc: 0.567 Test Loss: 1.615 Test Acc: 0.567
Validation loss decreased (-0.533316 --> -0.566651).  Saving model ...
Epoch: 15 cost time: 2.5564475059509277
Epoch: 15, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.530 Vali Acc: 0.589 Test Loss: 1.530 Test Acc: 0.589
Validation loss decreased (-0.566651 --> -0.588874).  Saving model ...
Epoch: 16 cost time: 2.4493634700775146
Epoch: 16, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.443 Vali Acc: 0.594 Test Loss: 1.443 Test Acc: 0.594
Validation loss decreased (-0.588874 --> -0.594430).  Saving model ...
Epoch: 17 cost time: 2.369107961654663
Epoch: 17, Steps: 12 | Train Loss: 1.223 Vali Loss: 1.372 Vali Acc: 0.622 Test Loss: 1.372 Test Acc: 0.622
Validation loss decreased (-0.594430 --> -0.622209).  Saving model ...
Epoch: 18 cost time: 2.4581120014190674
Epoch: 18, Steps: 12 | Train Loss: 1.136 Vali Loss: 1.299 Vali Acc: 0.633 Test Loss: 1.299 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633320).  Saving model ...
Epoch: 19 cost time: 2.6397881507873535
Epoch: 19, Steps: 12 | Train Loss: 1.090 Vali Loss: 1.237 Vali Acc: 0.639 Test Loss: 1.237 Test Acc: 0.639
Validation loss decreased (-0.633320 --> -0.638877).  Saving model ...
Epoch: 20 cost time: 2.430849552154541
Epoch: 20, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.181 Vali Acc: 0.639 Test Loss: 1.181 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638877).  Saving model ...
Epoch: 21 cost time: 2.4712047576904297
Epoch: 21, Steps: 12 | Train Loss: 0.947 Vali Loss: 1.139 Vali Acc: 0.667 Test Loss: 1.139 Test Acc: 0.667
Validation loss decreased (-0.638877 --> -0.666655).  Saving model ...
Epoch: 22 cost time: 2.5611181259155273
Epoch: 22, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.095 Vali Acc: 0.667 Test Loss: 1.095 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666656).  Saving model ...
Epoch: 23 cost time: 2.5309524536132812
Epoch: 23, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.044 Vali Acc: 0.667 Test Loss: 1.044 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 24 cost time: 2.444791078567505
Epoch: 24, Steps: 12 | Train Loss: 0.806 Vali Loss: 1.014 Vali Acc: 0.667 Test Loss: 1.014 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 25 cost time: 2.534257411956787
Epoch: 25, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.974 Vali Acc: 0.678 Test Loss: 0.974 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677768).  Saving model ...
Epoch: 26 cost time: 2.3895864486694336
Epoch: 26, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.950 Vali Acc: 0.683 Test Loss: 0.950 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683324).  Saving model ...
Epoch: 27 cost time: 2.407193660736084
Epoch: 27, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.918 Vali Acc: 0.689 Test Loss: 0.918 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688880).  Saving model ...
Epoch: 28 cost time: 2.4524307250976562
Epoch: 28, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.893 Vali Acc: 0.689 Test Loss: 0.893 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 29 cost time: 2.4252192974090576
Epoch: 29, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.883 Vali Acc: 0.683 Test Loss: 0.883 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.461334466934204
Epoch: 30, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.855 Vali Acc: 0.689 Test Loss: 0.855 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6888888888888889
model parameter : 225591
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9838945865631104
Epoch: 1, Steps: 12 | Train Loss: 2.835 Vali Loss: 2.745 Vali Acc: 0.106 Test Loss: 2.745 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 2.0577783584594727
Epoch: 2, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.700 Vali Acc: 0.139 Test Loss: 2.700 Test Acc: 0.139
Validation loss decreased (-0.105528 --> -0.138862).  Saving model ...
Epoch: 3 cost time: 2.1818668842315674
Epoch: 3, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.638 Vali Acc: 0.150 Test Loss: 2.638 Test Acc: 0.150
Validation loss decreased (-0.138862 --> -0.149974).  Saving model ...
Epoch: 4 cost time: 2.1899044513702393
Epoch: 4, Steps: 12 | Train Loss: 2.641 Vali Loss: 2.570 Vali Acc: 0.206 Test Loss: 2.570 Test Acc: 0.206
Validation loss decreased (-0.149974 --> -0.205530).  Saving model ...
Epoch: 5 cost time: 2.1168735027313232
Epoch: 5, Steps: 12 | Train Loss: 2.560 Vali Loss: 2.493 Vali Acc: 0.278 Test Loss: 2.493 Test Acc: 0.278
Validation loss decreased (-0.205530 --> -0.277753).  Saving model ...
Epoch: 6 cost time: 2.2070438861846924
Epoch: 6, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.410 Vali Acc: 0.322 Test Loss: 2.410 Test Acc: 0.322
Validation loss decreased (-0.277753 --> -0.322198).  Saving model ...
Epoch: 7 cost time: 2.298166513442993
Epoch: 7, Steps: 12 | Train Loss: 2.393 Vali Loss: 2.325 Vali Acc: 0.367 Test Loss: 2.325 Test Acc: 0.367
Validation loss decreased (-0.322198 --> -0.366643).  Saving model ...
Epoch: 8 cost time: 2.1322436332702637
Epoch: 8, Steps: 12 | Train Loss: 2.278 Vali Loss: 2.240 Vali Acc: 0.422 Test Loss: 2.240 Test Acc: 0.422
Validation loss decreased (-0.366643 --> -0.422200).  Saving model ...
Epoch: 9 cost time: 2.0889298915863037
Epoch: 9, Steps: 12 | Train Loss: 2.184 Vali Loss: 2.148 Vali Acc: 0.456 Test Loss: 2.148 Test Acc: 0.456
Validation loss decreased (-0.422200 --> -0.455534).  Saving model ...
Epoch: 10 cost time: 2.252673625946045
Epoch: 10, Steps: 12 | Train Loss: 2.101 Vali Loss: 2.061 Vali Acc: 0.494 Test Loss: 2.061 Test Acc: 0.494
Validation loss decreased (-0.455534 --> -0.494424).  Saving model ...
Epoch: 11 cost time: 2.156856060028076
Epoch: 11, Steps: 12 | Train Loss: 2.031 Vali Loss: 1.975 Vali Acc: 0.517 Test Loss: 1.975 Test Acc: 0.517
Validation loss decreased (-0.494424 --> -0.516647).  Saving model ...
Epoch: 12 cost time: 2.070427656173706
Epoch: 12, Steps: 12 | Train Loss: 1.917 Vali Loss: 1.890 Vali Acc: 0.533 Test Loss: 1.890 Test Acc: 0.533
Validation loss decreased (-0.516647 --> -0.533314).  Saving model ...
Epoch: 13 cost time: 2.2514376640319824
Epoch: 13, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.809 Vali Acc: 0.550 Test Loss: 1.809 Test Acc: 0.550
Validation loss decreased (-0.533314 --> -0.549982).  Saving model ...
Epoch: 14 cost time: 2.1550354957580566
Epoch: 14, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.732 Vali Acc: 0.572 Test Loss: 1.732 Test Acc: 0.572
Validation loss decreased (-0.549982 --> -0.572205).  Saving model ...
Epoch: 15 cost time: 2.1447019577026367
Epoch: 15, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.658 Vali Acc: 0.567 Test Loss: 1.658 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0078201293945312
Epoch: 16, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.591 Vali Acc: 0.572 Test Loss: 1.591 Test Acc: 0.572
Validation loss decreased (-0.572205 --> -0.572206).  Saving model ...
Epoch: 17 cost time: 1.989250659942627
Epoch: 17, Steps: 12 | Train Loss: 1.426 Vali Loss: 1.526 Vali Acc: 0.572 Test Loss: 1.526 Test Acc: 0.572
Validation loss decreased (-0.572206 --> -0.572207).  Saving model ...
Epoch: 18 cost time: 2.0908405780792236
Epoch: 18, Steps: 12 | Train Loss: 1.357 Vali Loss: 1.467 Vali Acc: 0.611 Test Loss: 1.467 Test Acc: 0.611
Validation loss decreased (-0.572207 --> -0.611096).  Saving model ...
Epoch: 19 cost time: 2.5735228061676025
Epoch: 19, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.406 Vali Acc: 0.589 Test Loss: 1.406 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.603695869445801
Epoch: 20, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.343 Vali Acc: 0.611 Test Loss: 1.343 Test Acc: 0.611
Validation loss decreased (-0.611096 --> -0.611098).  Saving model ...
Epoch: 21 cost time: 2.6194000244140625
Epoch: 21, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.282 Vali Acc: 0.633 Test Loss: 1.282 Test Acc: 0.633
Validation loss decreased (-0.611098 --> -0.633321).  Saving model ...
Epoch: 22 cost time: 2.559018135070801
Epoch: 22, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.225 Vali Acc: 0.639 Test Loss: 1.225 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 23 cost time: 2.429767608642578
Epoch: 23, Steps: 12 | Train Loss: 1.123 Vali Loss: 1.176 Vali Acc: 0.644 Test Loss: 1.176 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644433).  Saving model ...
Epoch: 24 cost time: 2.5263566970825195
Epoch: 24, Steps: 12 | Train Loss: 1.012 Vali Loss: 1.132 Vali Acc: 0.650 Test Loss: 1.132 Test Acc: 0.650
Validation loss decreased (-0.644433 --> -0.649989).  Saving model ...
Epoch: 25 cost time: 2.3729164600372314
Epoch: 25, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.099 Vali Acc: 0.667 Test Loss: 1.099 Test Acc: 0.667
Validation loss decreased (-0.649989 --> -0.666656).  Saving model ...
Epoch: 26 cost time: 2.5746350288391113
Epoch: 26, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.061 Vali Acc: 0.672 Test Loss: 1.061 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672212).  Saving model ...
Epoch: 27 cost time: 2.623100519180298
Epoch: 27, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.022 Vali Acc: 0.672 Test Loss: 1.022 Test Acc: 0.672
Validation loss decreased (-0.672212 --> -0.672212).  Saving model ...
Epoch: 28 cost time: 2.5438122749328613
Epoch: 28, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.989 Vali Acc: 0.678 Test Loss: 0.989 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 29 cost time: 2.5265626907348633
Epoch: 29, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.958 Vali Acc: 0.683 Test Loss: 0.958 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683324).  Saving model ...
Epoch: 30 cost time: 2.5154988765716553
Epoch: 30, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.943 Vali Acc: 0.683 Test Loss: 0.943 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683324).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6833333333333333
model parameter : 70311
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9676504135131836
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.735 Vali Acc: 0.067 Test Loss: 2.735 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 2.199786424636841
Epoch: 2, Steps: 12 | Train Loss: 2.745 Vali Loss: 2.697 Vali Acc: 0.072 Test Loss: 2.697 Test Acc: 0.072
Validation loss decreased (-0.066639 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 2.1350955963134766
Epoch: 3, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.645 Vali Acc: 0.094 Test Loss: 2.645 Test Acc: 0.094
Validation loss decreased (-0.072195 --> -0.094418).  Saving model ...
Epoch: 4 cost time: 2.1306605339050293
Epoch: 4, Steps: 12 | Train Loss: 2.593 Vali Loss: 2.585 Vali Acc: 0.106 Test Loss: 2.585 Test Acc: 0.106
Validation loss decreased (-0.094418 --> -0.105530).  Saving model ...
Epoch: 5 cost time: 2.0326919555664062
Epoch: 5, Steps: 12 | Train Loss: 2.519 Vali Loss: 2.517 Vali Acc: 0.178 Test Loss: 2.517 Test Acc: 0.178
Validation loss decreased (-0.105530 --> -0.177753).  Saving model ...
Epoch: 6 cost time: 2.1049387454986572
Epoch: 6, Steps: 12 | Train Loss: 2.446 Vali Loss: 2.443 Vali Acc: 0.200 Test Loss: 2.443 Test Acc: 0.200
Validation loss decreased (-0.177753 --> -0.199976).  Saving model ...
Epoch: 7 cost time: 2.066023111343384
Epoch: 7, Steps: 12 | Train Loss: 2.349 Vali Loss: 2.362 Vali Acc: 0.306 Test Loss: 2.362 Test Acc: 0.306
Validation loss decreased (-0.199976 --> -0.305532).  Saving model ...
Epoch: 8 cost time: 2.2129194736480713
Epoch: 8, Steps: 12 | Train Loss: 2.261 Vali Loss: 2.278 Vali Acc: 0.378 Test Loss: 2.278 Test Acc: 0.378
Validation loss decreased (-0.305532 --> -0.377755).  Saving model ...
Epoch: 9 cost time: 2.1398727893829346
Epoch: 9, Steps: 12 | Train Loss: 2.173 Vali Loss: 2.190 Vali Acc: 0.406 Test Loss: 2.190 Test Acc: 0.406
Validation loss decreased (-0.377755 --> -0.405534).  Saving model ...
Epoch: 10 cost time: 2.1139509677886963
Epoch: 10, Steps: 12 | Train Loss: 2.060 Vali Loss: 2.107 Vali Acc: 0.450 Test Loss: 2.107 Test Acc: 0.450
Validation loss decreased (-0.405534 --> -0.449979).  Saving model ...
Epoch: 11 cost time: 1.9948430061340332
Epoch: 11, Steps: 12 | Train Loss: 1.988 Vali Loss: 2.028 Vali Acc: 0.450 Test Loss: 2.028 Test Acc: 0.450
Validation loss decreased (-0.449979 --> -0.449980).  Saving model ...
Epoch: 12 cost time: 1.9987385272979736
Epoch: 12, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.944 Vali Acc: 0.489 Test Loss: 1.944 Test Acc: 0.489
Validation loss decreased (-0.449980 --> -0.488869).  Saving model ...
Epoch: 13 cost time: 1.9160616397857666
Epoch: 13, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.874 Vali Acc: 0.517 Test Loss: 1.874 Test Acc: 0.517
Validation loss decreased (-0.488869 --> -0.516648).  Saving model ...
Epoch: 14 cost time: 2.0462183952331543
Epoch: 14, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.798 Vali Acc: 0.544 Test Loss: 1.798 Test Acc: 0.544
Validation loss decreased (-0.516648 --> -0.544426).  Saving model ...
Epoch: 15 cost time: 1.8984861373901367
Epoch: 15, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.733 Vali Acc: 0.544 Test Loss: 1.733 Test Acc: 0.544
Validation loss decreased (-0.544426 --> -0.544427).  Saving model ...
Epoch: 16 cost time: 2.089430093765259
Epoch: 16, Steps: 12 | Train Loss: 1.531 Vali Loss: 1.666 Vali Acc: 0.556 Test Loss: 1.666 Test Acc: 0.556
Validation loss decreased (-0.544427 --> -0.555539).  Saving model ...
Epoch: 17 cost time: 2.1080710887908936
Epoch: 17, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.608 Vali Acc: 0.583 Test Loss: 1.608 Test Acc: 0.583
Validation loss decreased (-0.555539 --> -0.583317).  Saving model ...
Epoch: 18 cost time: 2.0567963123321533
Epoch: 18, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.548 Vali Acc: 0.606 Test Loss: 1.548 Test Acc: 0.606
Validation loss decreased (-0.583317 --> -0.605540).  Saving model ...
Epoch: 19 cost time: 2.038135290145874
Epoch: 19, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.490 Vali Acc: 0.594 Test Loss: 1.490 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.000013828277588
Epoch: 20, Steps: 12 | Train Loss: 1.217 Vali Loss: 1.443 Vali Acc: 0.594 Test Loss: 1.443 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8922569751739502
Epoch: 21, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.397 Vali Acc: 0.606 Test Loss: 1.397 Test Acc: 0.606
Validation loss decreased (-0.605540 --> -0.605542).  Saving model ...
Epoch: 22 cost time: 2.0078017711639404
Epoch: 22, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.348 Vali Acc: 0.617 Test Loss: 1.348 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616653).  Saving model ...
Epoch: 23 cost time: 1.9703795909881592
Epoch: 23, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.292 Vali Acc: 0.600 Test Loss: 1.292 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1974103450775146
Epoch: 24, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.263 Vali Acc: 0.600 Test Loss: 1.263 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2082276344299316
Epoch: 25, Steps: 12 | Train Loss: 0.914 Vali Loss: 1.220 Vali Acc: 0.617 Test Loss: 1.220 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616654).  Saving model ...
Epoch: 26 cost time: 2.219662666320801
Epoch: 26, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.184 Vali Acc: 0.611 Test Loss: 1.184 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.127922773361206
Epoch: 27, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.136 Vali Acc: 0.628 Test Loss: 1.136 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627766).  Saving model ...
Epoch: 28 cost time: 2.064444065093994
Epoch: 28, Steps: 12 | Train Loss: 0.818 Vali Loss: 1.111 Vali Acc: 0.644 Test Loss: 1.111 Test Acc: 0.644
Validation loss decreased (-0.627766 --> -0.644433).  Saving model ...
Epoch: 29 cost time: 2.144035577774048
Epoch: 29, Steps: 12 | Train Loss: 0.777 Vali Loss: 1.091 Vali Acc: 0.644 Test Loss: 1.091 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644434).  Saving model ...
Epoch: 30 cost time: 2.1473422050476074
Epoch: 30, Steps: 12 | Train Loss: 0.731 Vali Loss: 1.053 Vali Acc: 0.644 Test Loss: 1.053 Test Acc: 0.644
Validation loss decreased (-0.644434 --> -0.644434).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6444444444444445
model parameter : 225591
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.70902943611145
Epoch: 1, Steps: 12 | Train Loss: 2.829 Vali Loss: 2.745 Vali Acc: 0.106 Test Loss: 2.745 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 2.1234958171844482
Epoch: 2, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.704 Vali Acc: 0.139 Test Loss: 2.704 Test Acc: 0.139
Validation loss decreased (-0.105528 --> -0.138862).  Saving model ...
Epoch: 3 cost time: 2.0585970878601074
Epoch: 3, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.648 Vali Acc: 0.150 Test Loss: 2.648 Test Acc: 0.150
Validation loss decreased (-0.138862 --> -0.149974).  Saving model ...
Epoch: 4 cost time: 2.045912981033325
Epoch: 4, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.585 Vali Acc: 0.167 Test Loss: 2.585 Test Acc: 0.167
Validation loss decreased (-0.149974 --> -0.166641).  Saving model ...
Epoch: 5 cost time: 2.0471580028533936
Epoch: 5, Steps: 12 | Train Loss: 2.570 Vali Loss: 2.514 Vali Acc: 0.244 Test Loss: 2.514 Test Acc: 0.244
Validation loss decreased (-0.166641 --> -0.244419).  Saving model ...
Epoch: 6 cost time: 2.1145248413085938
Epoch: 6, Steps: 12 | Train Loss: 2.514 Vali Loss: 2.437 Vali Acc: 0.289 Test Loss: 2.437 Test Acc: 0.289
Validation loss decreased (-0.244419 --> -0.288865).  Saving model ...
Epoch: 7 cost time: 2.114452600479126
Epoch: 7, Steps: 12 | Train Loss: 2.417 Vali Loss: 2.355 Vali Acc: 0.367 Test Loss: 2.355 Test Acc: 0.367
Validation loss decreased (-0.288865 --> -0.366643).  Saving model ...
Epoch: 8 cost time: 2.1459147930145264
Epoch: 8, Steps: 12 | Train Loss: 2.309 Vali Loss: 2.276 Vali Acc: 0.394 Test Loss: 2.276 Test Acc: 0.394
Validation loss decreased (-0.366643 --> -0.394422).  Saving model ...
Epoch: 9 cost time: 2.0991134643554688
Epoch: 9, Steps: 12 | Train Loss: 2.222 Vali Loss: 2.191 Vali Acc: 0.422 Test Loss: 2.191 Test Acc: 0.422
Validation loss decreased (-0.394422 --> -0.422200).  Saving model ...
Epoch: 10 cost time: 2.195324420928955
Epoch: 10, Steps: 12 | Train Loss: 2.145 Vali Loss: 2.112 Vali Acc: 0.433 Test Loss: 2.112 Test Acc: 0.433
Validation loss decreased (-0.422200 --> -0.433312).  Saving model ...
Epoch: 11 cost time: 2.046757936477661
Epoch: 11, Steps: 12 | Train Loss: 2.088 Vali Loss: 2.035 Vali Acc: 0.478 Test Loss: 2.035 Test Acc: 0.478
Validation loss decreased (-0.433312 --> -0.477757).  Saving model ...
Epoch: 12 cost time: 2.019008159637451
Epoch: 12, Steps: 12 | Train Loss: 1.979 Vali Loss: 1.960 Vali Acc: 0.522 Test Loss: 1.960 Test Acc: 0.522
Validation loss decreased (-0.477757 --> -0.522203).  Saving model ...
Epoch: 13 cost time: 2.048790216445923
Epoch: 13, Steps: 12 | Train Loss: 1.888 Vali Loss: 1.887 Vali Acc: 0.550 Test Loss: 1.887 Test Acc: 0.550
Validation loss decreased (-0.522203 --> -0.549981).  Saving model ...
Epoch: 14 cost time: 2.027203321456909
Epoch: 14, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.821 Vali Acc: 0.561 Test Loss: 1.821 Test Acc: 0.561
Validation loss decreased (-0.549981 --> -0.561093).  Saving model ...
Epoch: 15 cost time: 1.8582627773284912
Epoch: 15, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.758 Vali Acc: 0.561 Test Loss: 1.758 Test Acc: 0.561
Validation loss decreased (-0.561093 --> -0.561094).  Saving model ...
Epoch: 16 cost time: 2.2594716548919678
Epoch: 16, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.702 Vali Acc: 0.539 Test Loss: 1.702 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1984665393829346
Epoch: 17, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.649 Vali Acc: 0.544 Test Loss: 1.649 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.123354434967041
Epoch: 18, Steps: 12 | Train Loss: 1.488 Vali Loss: 1.599 Vali Acc: 0.572 Test Loss: 1.599 Test Acc: 0.572
Validation loss decreased (-0.561094 --> -0.572206).  Saving model ...
Epoch: 19 cost time: 2.109330892562866
Epoch: 19, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.549 Vali Acc: 0.578 Test Loss: 1.549 Test Acc: 0.578
Validation loss decreased (-0.572206 --> -0.577762).  Saving model ...
Epoch: 20 cost time: 2.153383493423462
Epoch: 20, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.494 Vali Acc: 0.572 Test Loss: 1.494 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.068220376968384
Epoch: 21, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.440 Vali Acc: 0.622 Test Loss: 1.440 Test Acc: 0.622
Validation loss decreased (-0.577762 --> -0.622208).  Saving model ...
Epoch: 22 cost time: 2.1093268394470215
Epoch: 22, Steps: 12 | Train Loss: 1.251 Vali Loss: 1.385 Vali Acc: 0.617 Test Loss: 1.385 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1099936962127686
Epoch: 23, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.338 Vali Acc: 0.628 Test Loss: 1.338 Test Acc: 0.628
Validation loss decreased (-0.622208 --> -0.627764).  Saving model ...
Epoch: 24 cost time: 2.073312520980835
Epoch: 24, Steps: 12 | Train Loss: 1.186 Vali Loss: 1.295 Vali Acc: 0.633 Test Loss: 1.295 Test Acc: 0.633
Validation loss decreased (-0.627764 --> -0.633320).  Saving model ...
Epoch: 25 cost time: 2.1446914672851562
Epoch: 25, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.260 Vali Acc: 0.628 Test Loss: 1.260 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.030442714691162
Epoch: 26, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.219 Vali Acc: 0.633 Test Loss: 1.219 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633321).  Saving model ...
Epoch: 27 cost time: 2.0495755672454834
Epoch: 27, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.179 Vali Acc: 0.639 Test Loss: 1.179 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 28 cost time: 2.006309986114502
Epoch: 28, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.145 Vali Acc: 0.633 Test Loss: 1.145 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.998528242111206
Epoch: 29, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.112 Vali Acc: 0.656 Test Loss: 1.112 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655544).  Saving model ...
Epoch: 30 cost time: 1.9920554161071777
Epoch: 30, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.094 Vali Acc: 0.628 Test Loss: 1.094 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6555555555555556
model parameter : 70311
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 15.99293065071106
Epoch: 1, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.527 Vali Acc: 0.211 Test Loss: 2.527 Test Acc: 0.211
Validation loss decreased (inf --> -0.211086).  Saving model ...
Epoch: 2 cost time: 13.8906991481781
Epoch: 2, Steps: 12 | Train Loss: 2.211 Vali Loss: 1.837 Vali Acc: 0.478 Test Loss: 1.837 Test Acc: 0.478
Validation loss decreased (-0.211086 --> -0.477759).  Saving model ...
Epoch: 3 cost time: 14.152677536010742
Epoch: 3, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.371 Vali Acc: 0.556 Test Loss: 1.371 Test Acc: 0.556
Validation loss decreased (-0.477759 --> -0.555542).  Saving model ...
Epoch: 4 cost time: 14.04386281967163
Epoch: 4, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.116 Vali Acc: 0.633 Test Loss: 1.116 Test Acc: 0.633
Validation loss decreased (-0.555542 --> -0.633322).  Saving model ...
Epoch: 5 cost time: 14.35715937614441
Epoch: 5, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.977 Vali Acc: 0.622 Test Loss: 0.977 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.999191999435425
Epoch: 6, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.807 Vali Acc: 0.706 Test Loss: 0.807 Test Acc: 0.706
Validation loss decreased (-0.633322 --> -0.705547).  Saving model ...
Epoch: 7 cost time: 12.041279315948486
Epoch: 7, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.764 Vali Acc: 0.694 Test Loss: 0.764 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.809682846069336
Epoch: 8, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.671 Vali Acc: 0.750 Test Loss: 0.671 Test Acc: 0.750
Validation loss decreased (-0.705547 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 13.463457345962524
Epoch: 9, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.673 Vali Acc: 0.772 Test Loss: 0.673 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772215).  Saving model ...
Epoch: 10 cost time: 13.941381692886353
Epoch: 10, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.661 Vali Acc: 0.789 Test Loss: 0.661 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 11 cost time: 12.748734474182129
Epoch: 11, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.636134624481201
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.763 Vali Acc: 0.794 Test Loss: 0.763 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794437).  Saving model ...
Epoch: 13 cost time: 12.602268695831299
Epoch: 13, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.753 Vali Acc: 0.783 Test Loss: 0.753 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.396117925643921
Epoch: 14, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.730 Vali Acc: 0.761 Test Loss: 0.730 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.009215116500854
Epoch: 15, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.733 Vali Acc: 0.806 Test Loss: 0.733 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805548).  Saving model ...
Epoch: 16 cost time: 13.83436918258667
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.726 Vali Acc: 0.794 Test Loss: 0.726 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.331140041351318
Epoch: 17, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.663 Vali Acc: 0.817 Test Loss: 0.663 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 13.454359292984009
Epoch: 18, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.604 Vali Acc: 0.817 Test Loss: 0.604 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816661).  Saving model ...
Epoch: 19 cost time: 13.571852445602417
Epoch: 19, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.819 Vali Acc: 0.783 Test Loss: 0.819 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 12.371021509170532
Epoch: 20, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822216).  Saving model ...
Epoch: 21 cost time: 11.675937414169312
Epoch: 21, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.690 Vali Acc: 0.822 Test Loss: 0.690 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 10.972495079040527
Epoch: 22, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.805 Vali Acc: 0.817 Test Loss: 0.805 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 12.11375117301941
Epoch: 23, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.745 Vali Acc: 0.811 Test Loss: 0.745 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 12.568161487579346
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.722 Vali Acc: 0.817 Test Loss: 0.722 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 12.390185356140137
Epoch: 25, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 12.226742267608643
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.780 Vali Acc: 0.789 Test Loss: 0.780 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 13.051385164260864
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.009 Vali Acc: 0.783 Test Loss: 1.009 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 13.333536386489868
Epoch: 28, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.839 Vali Acc: 0.817 Test Loss: 0.839 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 12.62218165397644
Epoch: 29, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.757 Vali Acc: 0.828 Test Loss: 0.757 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827770).  Saving model ...
Epoch: 30 cost time: 11.841733932495117
Epoch: 30, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.839 Vali Acc: 0.811 Test Loss: 0.839 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 37579151
model size : 145.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.065257787704468
Epoch: 1, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.579 Vali Acc: 0.183 Test Loss: 2.579 Test Acc: 0.183
Validation loss decreased (inf --> -0.183308).  Saving model ...
Epoch: 2 cost time: 4.557424068450928
Epoch: 2, Steps: 12 | Train Loss: 2.206 Vali Loss: 1.973 Vali Acc: 0.411 Test Loss: 1.973 Test Acc: 0.411
Validation loss decreased (-0.183308 --> -0.411091).  Saving model ...
Epoch: 3 cost time: 4.93123197555542
Epoch: 3, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.489 Vali Acc: 0.544 Test Loss: 1.489 Test Acc: 0.544
Validation loss decreased (-0.411091 --> -0.544430).  Saving model ...
Epoch: 4 cost time: 4.500349283218384
Epoch: 4, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.209 Vali Acc: 0.583 Test Loss: 1.209 Test Acc: 0.583
Validation loss decreased (-0.544430 --> -0.583321).  Saving model ...
Epoch: 5 cost time: 4.6552207469940186
Epoch: 5, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.970 Vali Acc: 0.644 Test Loss: 0.970 Test Acc: 0.644
Validation loss decreased (-0.583321 --> -0.644435).  Saving model ...
Epoch: 6 cost time: 4.491388559341431
Epoch: 6, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.842 Vali Acc: 0.672 Test Loss: 0.842 Test Acc: 0.672
Validation loss decreased (-0.644435 --> -0.672214).  Saving model ...
Epoch: 7 cost time: 4.074398756027222
Epoch: 7, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.772 Vali Acc: 0.711 Test Loss: 0.772 Test Acc: 0.711
Validation loss decreased (-0.672214 --> -0.711103).  Saving model ...
Epoch: 8 cost time: 4.590373754501343
Epoch: 8, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.721 Vali Acc: 0.744 Test Loss: 0.721 Test Acc: 0.744
Validation loss decreased (-0.711103 --> -0.744437).  Saving model ...
Epoch: 9 cost time: 4.906360387802124
Epoch: 9, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.752 Vali Acc: 0.733 Test Loss: 0.752 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.71967625617981
Epoch: 10, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.646 Vali Acc: 0.761 Test Loss: 0.646 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761105).  Saving model ...
Epoch: 11 cost time: 4.900530576705933
Epoch: 11, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.654 Vali Acc: 0.789 Test Loss: 0.654 Test Acc: 0.789
Validation loss decreased (-0.761105 --> -0.788882).  Saving model ...
Epoch: 12 cost time: 4.9560770988464355
Epoch: 12, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.599 Vali Acc: 0.800 Test Loss: 0.599 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 13 cost time: 4.746917724609375
Epoch: 13, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.648 Vali Acc: 0.789 Test Loss: 0.648 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.729161500930786
Epoch: 14, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.626 Vali Acc: 0.806 Test Loss: 0.626 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805549).  Saving model ...
Epoch: 15 cost time: 5.010685682296753
Epoch: 15, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.724 Vali Acc: 0.772 Test Loss: 0.724 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.4178466796875
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.778 Vali Acc: 0.778 Test Loss: 0.778 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.678312063217163
Epoch: 17, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.744 Vali Acc: 0.789 Test Loss: 0.744 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.808455228805542
Epoch: 18, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.852 Vali Acc: 0.767 Test Loss: 0.852 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.5915629863739014
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.716 Vali Acc: 0.806 Test Loss: 0.716 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.7979960441589355
Epoch: 20, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.725 Vali Acc: 0.817 Test Loss: 0.725 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816659).  Saving model ...
Epoch: 21 cost time: 3.778346061706543
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.817 Vali Acc: 0.778 Test Loss: 0.817 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.0159592628479
Epoch: 22, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.746 Vali Acc: 0.833 Test Loss: 0.746 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833326).  Saving model ...
Epoch: 23 cost time: 4.609665393829346
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.736 Vali Acc: 0.828 Test Loss: 0.736 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.044285297393799
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.684 Vali Acc: 0.833 Test Loss: 0.684 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833326).  Saving model ...
Epoch: 25 cost time: 4.975348711013794
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.736 Vali Acc: 0.833 Test Loss: 0.736 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.064780235290527
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.772 Vali Acc: 0.833 Test Loss: 0.772 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.060667037963867
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.743 Vali Acc: 0.833 Test Loss: 0.743 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.870733022689819
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.704 Vali Acc: 0.844 Test Loss: 0.704 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844437).  Saving model ...
Epoch: 29 cost time: 4.809171676635742
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.712 Vali Acc: 0.828 Test Loss: 0.712 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.875238418579102
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.737 Vali Acc: 0.839 Test Loss: 0.737 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 11101071
model size : 44.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 11.331196069717407
Epoch: 1, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.526 Vali Acc: 0.211 Test Loss: 2.526 Test Acc: 0.211
Validation loss decreased (inf --> -0.211086).  Saving model ...
Epoch: 2 cost time: 9.153664827346802
Epoch: 2, Steps: 12 | Train Loss: 2.211 Vali Loss: 1.834 Vali Acc: 0.478 Test Loss: 1.834 Test Acc: 0.478
Validation loss decreased (-0.211086 --> -0.477759).  Saving model ...
Epoch: 3 cost time: 8.766507625579834
Epoch: 3, Steps: 12 | Train Loss: 1.450 Vali Loss: 1.370 Vali Acc: 0.561 Test Loss: 1.370 Test Acc: 0.561
Validation loss decreased (-0.477759 --> -0.561097).  Saving model ...
Epoch: 4 cost time: 8.401305913925171
Epoch: 4, Steps: 12 | Train Loss: 0.998 Vali Loss: 1.118 Vali Acc: 0.639 Test Loss: 1.118 Test Acc: 0.639
Validation loss decreased (-0.561097 --> -0.638878).  Saving model ...
Epoch: 5 cost time: 8.373396158218384
Epoch: 5, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.977 Vali Acc: 0.622 Test Loss: 0.977 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.262794971466064
Epoch: 6, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.812 Vali Acc: 0.700 Test Loss: 0.812 Test Acc: 0.700
Validation loss decreased (-0.638878 --> -0.699992).  Saving model ...
Epoch: 7 cost time: 9.564327478408813
Epoch: 7, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.779 Vali Acc: 0.700 Test Loss: 0.779 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 8 cost time: 9.890840768814087
Epoch: 8, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.703 Vali Acc: 0.756 Test Loss: 0.703 Test Acc: 0.756
Validation loss decreased (-0.699992 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 9.821672677993774
Epoch: 9, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.709 Vali Acc: 0.750 Test Loss: 0.709 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.562326192855835
Epoch: 10, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.685 Vali Acc: 0.794 Test Loss: 0.685 Test Acc: 0.794
Validation loss decreased (-0.755549 --> -0.794438).  Saving model ...
Epoch: 11 cost time: 10.021337747573853
Epoch: 11, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.657 Vali Acc: 0.772 Test Loss: 0.657 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.549732685089111
Epoch: 12, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.784 Vali Acc: 0.772 Test Loss: 0.784 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.916231632232666
Epoch: 13, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.692 Vali Acc: 0.789 Test Loss: 0.692 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.194905042648315
Epoch: 14, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.754 Vali Acc: 0.772 Test Loss: 0.754 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.761322975158691
Epoch: 15, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.717 Vali Acc: 0.783 Test Loss: 0.717 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.571312665939331
Epoch: 16, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.741 Vali Acc: 0.789 Test Loss: 0.741 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.37187933921814
Epoch: 17, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.738 Vali Acc: 0.778 Test Loss: 0.738 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.74854040145874
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.710 Vali Acc: 0.806 Test Loss: 0.710 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805548).  Saving model ...
Epoch: 19 cost time: 9.090998649597168
Epoch: 19, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.860 Vali Acc: 0.778 Test Loss: 0.860 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.684708833694458
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.780 Vali Acc: 0.794 Test Loss: 0.780 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.654575109481812
Epoch: 21, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.999 Vali Acc: 0.761 Test Loss: 0.999 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 9.888699769973755
Epoch: 22, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.855 Vali Acc: 0.750 Test Loss: 0.855 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 9.703205108642578
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.809 Vali Acc: 0.811 Test Loss: 0.809 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811103).  Saving model ...
Epoch: 24 cost time: 9.52917766571045
Epoch: 24, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.793 Vali Acc: 0.800 Test Loss: 0.793 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 9.610541105270386
Epoch: 25, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.804 Vali Acc: 0.811 Test Loss: 0.804 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811103).  Saving model ...
Epoch: 26 cost time: 9.015998601913452
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.803 Vali Acc: 0.800 Test Loss: 0.803 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 8.958258628845215
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.810 Vali Acc: 0.800 Test Loss: 0.810 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 8.404701948165894
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.815 Vali Acc: 0.811 Test Loss: 0.815 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.945166826248169
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.817 Vali Acc: 0.811 Test Loss: 0.817 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.774480819702148
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.812 Vali Acc: 0.811 Test Loss: 0.812 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 37579151
model size : 145.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.885446310043335
Epoch: 1, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.579 Vali Acc: 0.183 Test Loss: 2.579 Test Acc: 0.183
Validation loss decreased (inf --> -0.183308).  Saving model ...
Epoch: 2 cost time: 3.5724074840545654
Epoch: 2, Steps: 12 | Train Loss: 2.208 Vali Loss: 1.970 Vali Acc: 0.411 Test Loss: 1.970 Test Acc: 0.411
Validation loss decreased (-0.183308 --> -0.411091).  Saving model ...
Epoch: 3 cost time: 3.3063852787017822
Epoch: 3, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.486 Vali Acc: 0.539 Test Loss: 1.486 Test Acc: 0.539
Validation loss decreased (-0.411091 --> -0.538874).  Saving model ...
Epoch: 4 cost time: 3.5077991485595703
Epoch: 4, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.208 Vali Acc: 0.578 Test Loss: 1.208 Test Acc: 0.578
Validation loss decreased (-0.538874 --> -0.577766).  Saving model ...
Epoch: 5 cost time: 3.305440664291382
Epoch: 5, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.972 Vali Acc: 0.650 Test Loss: 0.972 Test Acc: 0.650
Validation loss decreased (-0.577766 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 3.3020596504211426
Epoch: 6, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.845 Vali Acc: 0.683 Test Loss: 0.845 Test Acc: 0.683
Validation loss decreased (-0.649990 --> -0.683325).  Saving model ...
Epoch: 7 cost time: 3.4982833862304688
Epoch: 7, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.777 Vali Acc: 0.722 Test Loss: 0.777 Test Acc: 0.722
Validation loss decreased (-0.683325 --> -0.722214).  Saving model ...
Epoch: 8 cost time: 3.341383218765259
Epoch: 8, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.718 Vali Acc: 0.733 Test Loss: 0.718 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733326).  Saving model ...
Epoch: 9 cost time: 3.7800018787384033
Epoch: 9, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.727 Vali Acc: 0.728 Test Loss: 0.727 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.450167179107666
Epoch: 10, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.653 Vali Acc: 0.778 Test Loss: 0.653 Test Acc: 0.778
Validation loss decreased (-0.733326 --> -0.777771).  Saving model ...
Epoch: 11 cost time: 3.7247960567474365
Epoch: 11, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.696 Vali Acc: 0.756 Test Loss: 0.696 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.511852979660034
Epoch: 12, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.662 Vali Acc: 0.761 Test Loss: 0.662 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5979862213134766
Epoch: 13, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.626 Vali Acc: 0.794 Test Loss: 0.626 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794438).  Saving model ...
Epoch: 14 cost time: 3.609389066696167
Epoch: 14, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.622 Vali Acc: 0.811 Test Loss: 0.622 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 15 cost time: 3.4913501739501953
Epoch: 15, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.713 Vali Acc: 0.778 Test Loss: 0.713 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.711921453475952
Epoch: 16, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.728 Vali Acc: 0.811 Test Loss: 0.728 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1819093227386475
Epoch: 17, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.748 Vali Acc: 0.800 Test Loss: 0.748 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.451211452484131
Epoch: 18, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.844 Vali Acc: 0.750 Test Loss: 0.844 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.259539842605591
Epoch: 19, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.782 Vali Acc: 0.778 Test Loss: 0.782 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.387110710144043
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.861 Vali Acc: 0.767 Test Loss: 0.861 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.199413299560547
Epoch: 21, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.810 Vali Acc: 0.789 Test Loss: 0.810 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9481422901153564
Epoch: 22, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.837 Vali Acc: 0.783 Test Loss: 0.837 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.9092159271240234
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.791 Vali Acc: 0.806 Test Loss: 0.791 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.6140778064727783
Epoch: 24, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.752 Vali Acc: 0.806 Test Loss: 0.752 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 11101071
model size : 44.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.66853666305542
Epoch: 1, Steps: 12 | Train Loss: 2.808 Vali Loss: 2.586 Vali Acc: 0.183 Test Loss: 2.586 Test Acc: 0.183
Validation loss decreased (inf --> -0.183307).  Saving model ...
Epoch: 2 cost time: 5.118564128875732
Epoch: 2, Steps: 12 | Train Loss: 2.348 Vali Loss: 2.040 Vali Acc: 0.450 Test Loss: 2.040 Test Acc: 0.450
Validation loss decreased (-0.183307 --> -0.449980).  Saving model ...
Epoch: 3 cost time: 4.860137701034546
Epoch: 3, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.630 Vali Acc: 0.539 Test Loss: 1.630 Test Acc: 0.539
Validation loss decreased (-0.449980 --> -0.538873).  Saving model ...
Epoch: 4 cost time: 4.6585493087768555
Epoch: 4, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.344 Vali Acc: 0.583 Test Loss: 1.344 Test Acc: 0.583
Validation loss decreased (-0.538873 --> -0.583320).  Saving model ...
Epoch: 5 cost time: 5.073861837387085
Epoch: 5, Steps: 12 | Train Loss: 1.012 Vali Loss: 1.199 Vali Acc: 0.567 Test Loss: 1.199 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.310832738876343
Epoch: 6, Steps: 12 | Train Loss: 0.820 Vali Loss: 1.044 Vali Acc: 0.617 Test Loss: 1.044 Test Acc: 0.617
Validation loss decreased (-0.583320 --> -0.616656).  Saving model ...
Epoch: 7 cost time: 4.683476448059082
Epoch: 7, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.930 Vali Acc: 0.678 Test Loss: 0.930 Test Acc: 0.678
Validation loss decreased (-0.616656 --> -0.677768).  Saving model ...
Epoch: 8 cost time: 5.113695859909058
Epoch: 8, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.800 Vali Acc: 0.711 Test Loss: 0.800 Test Acc: 0.711
Validation loss decreased (-0.677768 --> -0.711103).  Saving model ...
Epoch: 9 cost time: 4.407861232757568
Epoch: 9, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.776 Vali Acc: 0.728 Test Loss: 0.776 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 10 cost time: 4.495391607284546
Epoch: 10, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.786 Vali Acc: 0.722 Test Loss: 0.786 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.1984217166900635
Epoch: 11, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.704 Vali Acc: 0.767 Test Loss: 0.704 Test Acc: 0.767
Validation loss decreased (-0.727770 --> -0.766660).  Saving model ...
Epoch: 12 cost time: 4.7375428676605225
Epoch: 12, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.749 Vali Acc: 0.739 Test Loss: 0.749 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.204519510269165
Epoch: 13, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.788 Vali Acc: 0.783 Test Loss: 0.788 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783325).  Saving model ...
Epoch: 14 cost time: 3.32519793510437
Epoch: 14, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.771 Vali Acc: 0.767 Test Loss: 0.771 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.97096586227417
Epoch: 15, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.830 Vali Acc: 0.706 Test Loss: 0.830 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.557121753692627
Epoch: 16, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.766 Vali Acc: 0.772 Test Loss: 0.766 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.953497648239136
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.956 Vali Acc: 0.756 Test Loss: 0.956 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.438251495361328
Epoch: 18, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.735 Vali Acc: 0.778 Test Loss: 0.735 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.048068284988403
Epoch: 19, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.891 Vali Acc: 0.783 Test Loss: 0.891 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.105192184448242
Epoch: 20, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.809 Vali Acc: 0.800 Test Loss: 0.809 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 5.437411069869995
Epoch: 21, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.678 Vali Acc: 0.828 Test Loss: 0.678 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.827771).  Saving model ...
Epoch: 22 cost time: 5.118313312530518
Epoch: 22, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.641 Vali Acc: 0.811 Test Loss: 0.641 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.041377067565918
Epoch: 23, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.713 Vali Acc: 0.822 Test Loss: 0.713 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.530802249908447
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.816 Vali Acc: 0.800 Test Loss: 0.816 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.949228525161743
Epoch: 25, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.818 Vali Acc: 0.783 Test Loss: 0.818 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.432065486907959
Epoch: 26, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.801 Vali Acc: 0.806 Test Loss: 0.801 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.985082387924194
Epoch: 27, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.909 Vali Acc: 0.772 Test Loss: 0.909 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.627756118774414
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.851 Vali Acc: 0.783 Test Loss: 0.851 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.950162649154663
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.791 Vali Acc: 0.789 Test Loss: 0.791 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.423578262329102
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.732 Vali Acc: 0.822 Test Loss: 0.732 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 37579151
model size : 145.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7673380374908447
Epoch: 1, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.638 Vali Acc: 0.111 Test Loss: 2.638 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 2.119018316268921
Epoch: 2, Steps: 12 | Train Loss: 2.308 Vali Loss: 2.154 Vali Acc: 0.411 Test Loss: 2.154 Test Acc: 0.411
Validation loss decreased (-0.111085 --> -0.411090).  Saving model ...
Epoch: 3 cost time: 2.1598379611968994
Epoch: 3, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.717 Vali Acc: 0.522 Test Loss: 1.717 Test Acc: 0.522
Validation loss decreased (-0.411090 --> -0.522205).  Saving model ...
Epoch: 4 cost time: 2.55074405670166
Epoch: 4, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.416 Vali Acc: 0.567 Test Loss: 1.416 Test Acc: 0.567
Validation loss decreased (-0.522205 --> -0.566653).  Saving model ...
Epoch: 5 cost time: 2.2009079456329346
Epoch: 5, Steps: 12 | Train Loss: 1.005 Vali Loss: 1.202 Vali Acc: 0.594 Test Loss: 1.202 Test Acc: 0.594
Validation loss decreased (-0.566653 --> -0.594432).  Saving model ...
Epoch: 6 cost time: 2.390183210372925
Epoch: 6, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.025 Vali Acc: 0.606 Test Loss: 1.025 Test Acc: 0.606
Validation loss decreased (-0.594432 --> -0.605545).  Saving model ...
Epoch: 7 cost time: 2.333186626434326
Epoch: 7, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.950 Vali Acc: 0.667 Test Loss: 0.950 Test Acc: 0.667
Validation loss decreased (-0.605545 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 2.300969362258911
Epoch: 8, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.897 Vali Acc: 0.667 Test Loss: 0.897 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666658).  Saving model ...
Epoch: 9 cost time: 2.5196876525878906
Epoch: 9, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.870 Vali Acc: 0.667 Test Loss: 0.870 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666658).  Saving model ...
Epoch: 10 cost time: 2.194326877593994
Epoch: 10, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.779 Vali Acc: 0.739 Test Loss: 0.779 Test Acc: 0.739
Validation loss decreased (-0.666658 --> -0.738881).  Saving model ...
Epoch: 11 cost time: 2.451608180999756
Epoch: 11, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.819 Vali Acc: 0.711 Test Loss: 0.819 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.334904909133911
Epoch: 12, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.726 Vali Acc: 0.772 Test Loss: 0.726 Test Acc: 0.772
Validation loss decreased (-0.738881 --> -0.772215).  Saving model ...
Epoch: 13 cost time: 2.257868528366089
Epoch: 13, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.729 Vali Acc: 0.772 Test Loss: 0.729 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4173192977905273
Epoch: 14, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.696 Vali Acc: 0.772 Test Loss: 0.696 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772215).  Saving model ...
Epoch: 15 cost time: 2.323518991470337
Epoch: 15, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.711 Vali Acc: 0.778 Test Loss: 0.711 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 16 cost time: 2.0804219245910645
Epoch: 16, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.799 Vali Acc: 0.794 Test Loss: 0.799 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794436).  Saving model ...
Epoch: 17 cost time: 2.4639949798583984
Epoch: 17, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.777 Vali Acc: 0.800 Test Loss: 0.777 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 2.273313522338867
Epoch: 18, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.761 Vali Acc: 0.778 Test Loss: 0.761 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.290512800216675
Epoch: 19, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.925 Vali Acc: 0.767 Test Loss: 0.925 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4116756916046143
Epoch: 20, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.734 Vali Acc: 0.794 Test Loss: 0.734 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.23573637008667
Epoch: 21, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.711 Vali Acc: 0.806 Test Loss: 0.711 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 22 cost time: 2.1890451908111572
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.781 Vali Acc: 0.783 Test Loss: 0.781 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9376654624938965
Epoch: 23, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.728 Vali Acc: 0.806 Test Loss: 0.728 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7538387775421143
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.744 Vali Acc: 0.833 Test Loss: 0.744 Test Acc: 0.833
Validation loss decreased (-0.805548 --> -0.833326).  Saving model ...
Epoch: 25 cost time: 2.1026413440704346
Epoch: 25, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.850 Vali Acc: 0.806 Test Loss: 0.850 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.013449192047119
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.865 Vali Acc: 0.794 Test Loss: 0.865 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8281629085540771
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.862 Vali Acc: 0.789 Test Loss: 0.862 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9172537326812744
Epoch: 28, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.799 Vali Acc: 0.794 Test Loss: 0.799 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9226348400115967
Epoch: 29, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.787 Vali Acc: 0.794 Test Loss: 0.787 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0233840942382812
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.771 Vali Acc: 0.811 Test Loss: 0.771 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 11101071
model size : 44.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.689383745193481
Epoch: 1, Steps: 12 | Train Loss: 2.710 Vali Loss: 2.521 Vali Acc: 0.267 Test Loss: 2.521 Test Acc: 0.267
Validation loss decreased (inf --> -0.266641).  Saving model ...
Epoch: 2 cost time: 6.651061296463013
Epoch: 2, Steps: 12 | Train Loss: 2.175 Vali Loss: 1.928 Vali Acc: 0.511 Test Loss: 1.928 Test Acc: 0.511
Validation loss decreased (-0.266641 --> -0.511092).  Saving model ...
Epoch: 3 cost time: 6.975032329559326
Epoch: 3, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.455 Vali Acc: 0.578 Test Loss: 1.455 Test Acc: 0.578
Validation loss decreased (-0.511092 --> -0.577763).  Saving model ...
Epoch: 4 cost time: 6.700796842575073
Epoch: 4, Steps: 12 | Train Loss: 1.114 Vali Loss: 1.138 Vali Acc: 0.617 Test Loss: 1.138 Test Acc: 0.617
Validation loss decreased (-0.577763 --> -0.616655).  Saving model ...
Epoch: 5 cost time: 6.980372905731201
Epoch: 5, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.945 Vali Acc: 0.650 Test Loss: 0.945 Test Acc: 0.650
Validation loss decreased (-0.616655 --> -0.649991).  Saving model ...
Epoch: 6 cost time: 6.940323829650879
Epoch: 6, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.848 Vali Acc: 0.694 Test Loss: 0.848 Test Acc: 0.694
Validation loss decreased (-0.649991 --> -0.694436).  Saving model ...
Epoch: 7 cost time: 6.808079242706299
Epoch: 7, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.813 Vali Acc: 0.683 Test Loss: 0.813 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.997714281082153
Epoch: 8, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.719 Vali Acc: 0.711 Test Loss: 0.719 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711104).  Saving model ...
Epoch: 9 cost time: 6.628921985626221
Epoch: 9, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.689 Vali Acc: 0.756 Test Loss: 0.689 Test Acc: 0.756
Validation loss decreased (-0.711104 --> -0.755549).  Saving model ...
Epoch: 10 cost time: 6.338106870651245
Epoch: 10, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.644 Vali Acc: 0.761 Test Loss: 0.644 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 11 cost time: 6.437813758850098
Epoch: 11, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.737 Vali Acc: 0.772 Test Loss: 0.737 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772215).  Saving model ...
Epoch: 12 cost time: 5.8938775062561035
Epoch: 12, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.730 Vali Acc: 0.772 Test Loss: 0.730 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772215).  Saving model ...
Epoch: 13 cost time: 7.413636922836304
Epoch: 13, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.717 Vali Acc: 0.778 Test Loss: 0.717 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 14 cost time: 8.035577535629272
Epoch: 14, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.658 Vali Acc: 0.794 Test Loss: 0.658 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794438).  Saving model ...
Epoch: 15 cost time: 7.867393970489502
Epoch: 15, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.686 Vali Acc: 0.772 Test Loss: 0.686 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.4095618724823
Epoch: 16, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.721 Vali Acc: 0.783 Test Loss: 0.721 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.963093996047974
Epoch: 17, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.728 Vali Acc: 0.783 Test Loss: 0.728 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.667363166809082
Epoch: 18, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.688 Vali Acc: 0.811 Test Loss: 0.688 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811104).  Saving model ...
Epoch: 19 cost time: 7.946147680282593
Epoch: 19, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.727 Vali Acc: 0.794 Test Loss: 0.727 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.987027645111084
Epoch: 20, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.725 Vali Acc: 0.794 Test Loss: 0.725 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.133097410202026
Epoch: 21, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.775 Vali Acc: 0.817 Test Loss: 0.775 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816659).  Saving model ...
Epoch: 22 cost time: 8.562101364135742
Epoch: 22, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.759 Vali Acc: 0.817 Test Loss: 0.759 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 23 cost time: 7.983336687088013
Epoch: 23, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.746 Vali Acc: 0.828 Test Loss: 0.746 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827770).  Saving model ...
Epoch: 24 cost time: 7.733720064163208
Epoch: 24, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.762 Vali Acc: 0.822 Test Loss: 0.762 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.529595851898193
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.717 Vali Acc: 0.828 Test Loss: 0.717 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827771).  Saving model ...
Epoch: 26 cost time: 7.611790418624878
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.749 Vali Acc: 0.822 Test Loss: 0.749 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.494651794433594
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.753 Vali Acc: 0.828 Test Loss: 0.753 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 8.200324535369873
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.764 Vali Acc: 0.822 Test Loss: 0.764 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 8.305476427078247
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.775 Vali Acc: 0.839 Test Loss: 0.775 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838881).  Saving model ...
Epoch: 30 cost time: 8.224658966064453
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.775 Vali Acc: 0.833 Test Loss: 0.775 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 18834319
model size : 74.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.953441619873047
Epoch: 1, Steps: 12 | Train Loss: 2.680 Vali Loss: 2.530 Vali Acc: 0.183 Test Loss: 2.530 Test Acc: 0.183
Validation loss decreased (inf --> -0.183308).  Saving model ...
Epoch: 2 cost time: 3.402869701385498
Epoch: 2, Steps: 12 | Train Loss: 2.173 Vali Loss: 1.966 Vali Acc: 0.450 Test Loss: 1.966 Test Acc: 0.450
Validation loss decreased (-0.183308 --> -0.449980).  Saving model ...
Epoch: 3 cost time: 3.6115944385528564
Epoch: 3, Steps: 12 | Train Loss: 1.566 Vali Loss: 1.518 Vali Acc: 0.550 Test Loss: 1.518 Test Acc: 0.550
Validation loss decreased (-0.449980 --> -0.549985).  Saving model ...
Epoch: 4 cost time: 3.4940640926361084
Epoch: 4, Steps: 12 | Train Loss: 1.108 Vali Loss: 1.203 Vali Acc: 0.572 Test Loss: 1.203 Test Acc: 0.572
Validation loss decreased (-0.549985 --> -0.572210).  Saving model ...
Epoch: 5 cost time: 3.3472115993499756
Epoch: 5, Steps: 12 | Train Loss: 0.903 Vali Loss: 0.988 Vali Acc: 0.650 Test Loss: 0.988 Test Acc: 0.650
Validation loss decreased (-0.572210 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 3.4895198345184326
Epoch: 6, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.856 Vali Acc: 0.694 Test Loss: 0.856 Test Acc: 0.694
Validation loss decreased (-0.649990 --> -0.694436).  Saving model ...
Epoch: 7 cost time: 3.3716070652008057
Epoch: 7, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.789 Vali Acc: 0.706 Test Loss: 0.789 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705548).  Saving model ...
Epoch: 8 cost time: 3.252854824066162
Epoch: 8, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.748 Vali Acc: 0.733 Test Loss: 0.748 Test Acc: 0.733
Validation loss decreased (-0.705548 --> -0.733326).  Saving model ...
Epoch: 9 cost time: 3.20084547996521
Epoch: 9, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.731 Vali Acc: 0.728 Test Loss: 0.731 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4654338359832764
Epoch: 10, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.738 Vali Acc: 0.744 Test Loss: 0.738 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744437).  Saving model ...
Epoch: 11 cost time: 3.023658514022827
Epoch: 11, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.761 Vali Acc: 0.739 Test Loss: 0.761 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0953867435455322
Epoch: 12, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.743 Vali Acc: 0.722 Test Loss: 0.743 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2385356426239014
Epoch: 13, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.769 Vali Acc: 0.756 Test Loss: 0.769 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 14 cost time: 3.103602647781372
Epoch: 14, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.726 Vali Acc: 0.778 Test Loss: 0.726 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777771).  Saving model ...
Epoch: 15 cost time: 2.744304895401001
Epoch: 15, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.125628709793091
Epoch: 16, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.774 Vali Acc: 0.783 Test Loss: 0.774 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783326).  Saving model ...
Epoch: 17 cost time: 3.2175633907318115
Epoch: 17, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.908 Vali Acc: 0.772 Test Loss: 0.908 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0550901889801025
Epoch: 18, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.796 Vali Acc: 0.772 Test Loss: 0.796 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1139187812805176
Epoch: 19, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.729 Vali Acc: 0.778 Test Loss: 0.729 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.379848003387451
Epoch: 20, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.050 Vali Acc: 0.739 Test Loss: 1.050 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.476947784423828
Epoch: 21, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.833 Vali Acc: 0.778 Test Loss: 0.833 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.3467726707458496
Epoch: 22, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.3907039165496826
Epoch: 23, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.898 Vali Acc: 0.789 Test Loss: 0.898 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788880).  Saving model ...
Epoch: 24 cost time: 3.484428644180298
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.894 Vali Acc: 0.761 Test Loss: 0.894 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4044268131256104
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.990 Vali Acc: 0.761 Test Loss: 0.990 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.4345955848693848
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.956 Vali Acc: 0.789 Test Loss: 0.956 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.372706174850464
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.979 Vali Acc: 0.761 Test Loss: 0.979 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.5680019855499268
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.883 Vali Acc: 0.800 Test Loss: 0.883 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799991).  Saving model ...
Epoch: 29 cost time: 3.502507209777832
Epoch: 29, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.956 Vali Acc: 0.789 Test Loss: 0.956 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4575695991516113
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.959 Vali Acc: 0.794 Test Loss: 0.959 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 5595023
model size : 23.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.594708442687988
Epoch: 1, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.520 Vali Acc: 0.267 Test Loss: 2.520 Test Acc: 0.267
Validation loss decreased (inf --> -0.266641).  Saving model ...
Epoch: 2 cost time: 6.058411121368408
Epoch: 2, Steps: 12 | Train Loss: 2.176 Vali Loss: 1.926 Vali Acc: 0.511 Test Loss: 1.926 Test Acc: 0.511
Validation loss decreased (-0.266641 --> -0.511092).  Saving model ...
Epoch: 3 cost time: 5.977070331573486
Epoch: 3, Steps: 12 | Train Loss: 1.528 Vali Loss: 1.453 Vali Acc: 0.572 Test Loss: 1.453 Test Acc: 0.572
Validation loss decreased (-0.511092 --> -0.572208).  Saving model ...
Epoch: 4 cost time: 6.095123052597046
Epoch: 4, Steps: 12 | Train Loss: 1.120 Vali Loss: 1.134 Vali Acc: 0.622 Test Loss: 1.134 Test Acc: 0.622
Validation loss decreased (-0.572208 --> -0.622211).  Saving model ...
Epoch: 5 cost time: 5.503752946853638
Epoch: 5, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.944 Vali Acc: 0.650 Test Loss: 0.944 Test Acc: 0.650
Validation loss decreased (-0.622211 --> -0.649991).  Saving model ...
Epoch: 6 cost time: 5.420042037963867
Epoch: 6, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.854 Vali Acc: 0.694 Test Loss: 0.854 Test Acc: 0.694
Validation loss decreased (-0.649991 --> -0.694436).  Saving model ...
Epoch: 7 cost time: 5.493378162384033
Epoch: 7, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.826 Vali Acc: 0.694 Test Loss: 0.826 Test Acc: 0.694
Validation loss decreased (-0.694436 --> -0.694436).  Saving model ...
Epoch: 8 cost time: 5.492034196853638
Epoch: 8, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.730 Vali Acc: 0.706 Test Loss: 0.730 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705548).  Saving model ...
Epoch: 9 cost time: 5.695101976394653
Epoch: 9, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.710 Vali Acc: 0.744 Test Loss: 0.710 Test Acc: 0.744
Validation loss decreased (-0.705548 --> -0.744437).  Saving model ...
Epoch: 10 cost time: 5.722439289093018
Epoch: 10, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.657 Vali Acc: 0.767 Test Loss: 0.657 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766660).  Saving model ...
Epoch: 11 cost time: 6.116349220275879
Epoch: 11, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.755 Vali Acc: 0.761 Test Loss: 0.755 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.935408115386963
Epoch: 12, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.719 Vali Acc: 0.783 Test Loss: 0.719 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783326).  Saving model ...
Epoch: 13 cost time: 5.8222973346710205
Epoch: 13, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.702 Vali Acc: 0.761 Test Loss: 0.702 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.681887149810791
Epoch: 14, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.690 Vali Acc: 0.794 Test Loss: 0.690 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 15 cost time: 5.710443496704102
Epoch: 15, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.673 Vali Acc: 0.783 Test Loss: 0.673 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.8226165771484375
Epoch: 16, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.738 Vali Acc: 0.772 Test Loss: 0.738 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.608426094055176
Epoch: 17, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.828 Vali Acc: 0.744 Test Loss: 0.828 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.9418044090271
Epoch: 18, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.754 Vali Acc: 0.789 Test Loss: 0.754 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.659904718399048
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 5.640435695648193
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.712 Vali Acc: 0.806 Test Loss: 0.712 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805548).  Saving model ...
Epoch: 21 cost time: 5.758004903793335
Epoch: 21, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.674 Vali Acc: 0.828 Test Loss: 0.674 Test Acc: 0.828
Validation loss decreased (-0.805548 --> -0.827771).  Saving model ...
Epoch: 22 cost time: 5.53533411026001
Epoch: 22, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.673 Vali Acc: 0.839 Test Loss: 0.673 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 23 cost time: 4.660329341888428
Epoch: 23, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.712 Vali Acc: 0.839 Test Loss: 0.712 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.257575273513794
Epoch: 24, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.739 Vali Acc: 0.828 Test Loss: 0.739 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.485541820526123
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.713 Vali Acc: 0.822 Test Loss: 0.713 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.295037269592285
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.756 Vali Acc: 0.822 Test Loss: 0.756 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.655134439468384
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.727 Vali Acc: 0.828 Test Loss: 0.727 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.129260540008545
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.722 Vali Acc: 0.833 Test Loss: 0.722 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.19649076461792
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.726 Vali Acc: 0.833 Test Loss: 0.726 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.083210468292236
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.744 Vali Acc: 0.833 Test Loss: 0.744 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 18834319
model size : 74.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.971082925796509
Epoch: 1, Steps: 12 | Train Loss: 2.681 Vali Loss: 2.530 Vali Acc: 0.183 Test Loss: 2.530 Test Acc: 0.183
Validation loss decreased (inf --> -0.183308).  Saving model ...
Epoch: 2 cost time: 2.4507153034210205
Epoch: 2, Steps: 12 | Train Loss: 2.173 Vali Loss: 1.964 Vali Acc: 0.456 Test Loss: 1.964 Test Acc: 0.456
Validation loss decreased (-0.183308 --> -0.455536).  Saving model ...
Epoch: 3 cost time: 2.456179618835449
Epoch: 3, Steps: 12 | Train Loss: 1.567 Vali Loss: 1.514 Vali Acc: 0.550 Test Loss: 1.514 Test Acc: 0.550
Validation loss decreased (-0.455536 --> -0.549985).  Saving model ...
Epoch: 4 cost time: 2.3855679035186768
Epoch: 4, Steps: 12 | Train Loss: 1.111 Vali Loss: 1.198 Vali Acc: 0.578 Test Loss: 1.198 Test Acc: 0.578
Validation loss decreased (-0.549985 --> -0.577766).  Saving model ...
Epoch: 5 cost time: 2.636636734008789
Epoch: 5, Steps: 12 | Train Loss: 0.914 Vali Loss: 0.987 Vali Acc: 0.644 Test Loss: 0.987 Test Acc: 0.644
Validation loss decreased (-0.577766 --> -0.644435).  Saving model ...
Epoch: 6 cost time: 2.421895742416382
Epoch: 6, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.854 Vali Acc: 0.706 Test Loss: 0.854 Test Acc: 0.706
Validation loss decreased (-0.644435 --> -0.705547).  Saving model ...
Epoch: 7 cost time: 2.517230272293091
Epoch: 7, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.788 Vali Acc: 0.711 Test Loss: 0.788 Test Acc: 0.711
Validation loss decreased (-0.705547 --> -0.711103).  Saving model ...
Epoch: 8 cost time: 2.4391632080078125
Epoch: 8, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.750 Vali Acc: 0.722 Test Loss: 0.750 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722215).  Saving model ...
Epoch: 9 cost time: 2.462700128555298
Epoch: 9, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.728 Vali Acc: 0.739 Test Loss: 0.728 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738882).  Saving model ...
Epoch: 10 cost time: 2.412093162536621
Epoch: 10, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.742 Vali Acc: 0.722 Test Loss: 0.742 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4077908992767334
Epoch: 11, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.753 Vali Acc: 0.728 Test Loss: 0.753 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3847804069519043
Epoch: 12, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.762 Vali Acc: 0.722 Test Loss: 0.762 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5066111087799072
Epoch: 13, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.778 Vali Acc: 0.739 Test Loss: 0.778 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.147538423538208
Epoch: 14, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.731 Vali Acc: 0.767 Test Loss: 0.731 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 2.2148423194885254
Epoch: 15, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.757 Vali Acc: 0.767 Test Loss: 0.757 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.048067092895508
Epoch: 16, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.779 Vali Acc: 0.783 Test Loss: 0.779 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 17 cost time: 2.195695161819458
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.870 Vali Acc: 0.767 Test Loss: 0.870 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1475167274475098
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.842 Vali Acc: 0.761 Test Loss: 0.842 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.110463857650757
Epoch: 19, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.771 Vali Acc: 0.772 Test Loss: 0.771 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2286903858184814
Epoch: 20, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.994 Vali Acc: 0.750 Test Loss: 0.994 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0283613204956055
Epoch: 21, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.810 Vali Acc: 0.783 Test Loss: 0.810 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.202061653137207
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.873 Vali Acc: 0.761 Test Loss: 0.873 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0755128860473633
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.860 Vali Acc: 0.783 Test Loss: 0.860 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.273597240447998
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.897 Vali Acc: 0.778 Test Loss: 0.897 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.130337953567505
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.878 Vali Acc: 0.783 Test Loss: 0.878 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.2936246395111084
Epoch: 26, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.883 Vali Acc: 0.778 Test Loss: 0.883 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 5595023
model size : 23.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.63943076133728
Epoch: 1, Steps: 12 | Train Loss: 2.718 Vali Loss: 2.550 Vali Acc: 0.222 Test Loss: 2.550 Test Acc: 0.222
Validation loss decreased (inf --> -0.222197).  Saving model ...
Epoch: 2 cost time: 3.2566545009613037
Epoch: 2, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.057 Vali Acc: 0.500 Test Loss: 2.057 Test Acc: 0.500
Validation loss decreased (-0.222197 --> -0.499979).  Saving model ...
Epoch: 3 cost time: 3.1570467948913574
Epoch: 3, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.643 Vali Acc: 0.544 Test Loss: 1.643 Test Acc: 0.544
Validation loss decreased (-0.499979 --> -0.544428).  Saving model ...
Epoch: 4 cost time: 3.0686450004577637
Epoch: 4, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.350 Vali Acc: 0.589 Test Loss: 1.350 Test Acc: 0.589
Validation loss decreased (-0.544428 --> -0.588875).  Saving model ...
Epoch: 5 cost time: 3.31318736076355
Epoch: 5, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.138 Vali Acc: 0.628 Test Loss: 1.138 Test Acc: 0.628
Validation loss decreased (-0.588875 --> -0.627766).  Saving model ...
Epoch: 6 cost time: 3.090970516204834
Epoch: 6, Steps: 12 | Train Loss: 0.799 Vali Loss: 1.019 Vali Acc: 0.656 Test Loss: 1.019 Test Acc: 0.656
Validation loss decreased (-0.627766 --> -0.655545).  Saving model ...
Epoch: 7 cost time: 3.1522738933563232
Epoch: 7, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.916 Vali Acc: 0.683 Test Loss: 0.916 Test Acc: 0.683
Validation loss decreased (-0.655545 --> -0.683324).  Saving model ...
Epoch: 8 cost time: 3.045260190963745
Epoch: 8, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.829 Vali Acc: 0.678 Test Loss: 0.829 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.926908016204834
Epoch: 9, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.768 Vali Acc: 0.728 Test Loss: 0.768 Test Acc: 0.728
Validation loss decreased (-0.683324 --> -0.727770).  Saving model ...
Epoch: 10 cost time: 2.988489866256714
Epoch: 10, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.690 Vali Acc: 0.744 Test Loss: 0.690 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744438).  Saving model ...
Epoch: 11 cost time: 3.427140712738037
Epoch: 11, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.729 Vali Acc: 0.756 Test Loss: 0.729 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755548).  Saving model ...
Epoch: 12 cost time: 3.4428694248199463
Epoch: 12, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.729 Vali Acc: 0.772 Test Loss: 0.729 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 13 cost time: 3.4946463108062744
Epoch: 13, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.794 Vali Acc: 0.767 Test Loss: 0.794 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.391507148742676
Epoch: 14, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.699 Vali Acc: 0.783 Test Loss: 0.699 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 15 cost time: 3.6362271308898926
Epoch: 15, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.672 Vali Acc: 0.800 Test Loss: 0.672 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 3.3786258697509766
Epoch: 16, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.760 Vali Acc: 0.756 Test Loss: 0.760 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2766010761260986
Epoch: 17, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.778 Vali Acc: 0.811 Test Loss: 0.778 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811103).  Saving model ...
Epoch: 18 cost time: 3.485807180404663
Epoch: 18, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.681 Vali Acc: 0.828 Test Loss: 0.681 Test Acc: 0.828
Validation loss decreased (-0.811103 --> -0.827771).  Saving model ...
Epoch: 19 cost time: 3.430203676223755
Epoch: 19, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.813 Vali Acc: 0.761 Test Loss: 0.813 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5815861225128174
Epoch: 20, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.722 Vali Acc: 0.828 Test Loss: 0.722 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.3626749515533447
Epoch: 21, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.695 Vali Acc: 0.794 Test Loss: 0.695 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2346813678741455
Epoch: 22, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.698 Vali Acc: 0.806 Test Loss: 0.698 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4643797874450684
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.662 Vali Acc: 0.806 Test Loss: 0.662 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.3184330463409424
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.732 Vali Acc: 0.833 Test Loss: 0.732 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833326).  Saving model ...
Epoch: 25 cost time: 3.6079351902008057
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.721 Vali Acc: 0.817 Test Loss: 0.721 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4273059368133545
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.752 Vali Acc: 0.806 Test Loss: 0.752 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0448496341705322
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.765 Vali Acc: 0.811 Test Loss: 0.765 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.1466047763824463
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.829 Vali Acc: 0.800 Test Loss: 0.829 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.9862279891967773
Epoch: 29, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.799 Vali Acc: 0.806 Test Loss: 0.799 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.30226731300354
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.741 Vali Acc: 0.811 Test Loss: 0.741 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 18834319
model size : 74.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2051374912261963
Epoch: 1, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.568 Vali Acc: 0.167 Test Loss: 2.568 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 1.6898524761199951
Epoch: 2, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.085 Vali Acc: 0.394 Test Loss: 2.085 Test Acc: 0.394
Validation loss decreased (-0.166641 --> -0.394424).  Saving model ...
Epoch: 3 cost time: 1.798624038696289
Epoch: 3, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.682 Vali Acc: 0.528 Test Loss: 1.682 Test Acc: 0.528
Validation loss decreased (-0.394424 --> -0.527761).  Saving model ...
Epoch: 4 cost time: 1.5719208717346191
Epoch: 4, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.398 Vali Acc: 0.544 Test Loss: 1.398 Test Acc: 0.544
Validation loss decreased (-0.527761 --> -0.544430).  Saving model ...
Epoch: 5 cost time: 1.7354435920715332
Epoch: 5, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.192 Vali Acc: 0.578 Test Loss: 1.192 Test Acc: 0.578
Validation loss decreased (-0.544430 --> -0.577766).  Saving model ...
Epoch: 6 cost time: 1.9956624507904053
Epoch: 6, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.036 Vali Acc: 0.650 Test Loss: 1.036 Test Acc: 0.650
Validation loss decreased (-0.577766 --> -0.649990).  Saving model ...
Epoch: 7 cost time: 1.8260371685028076
Epoch: 7, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.964 Vali Acc: 0.667 Test Loss: 0.964 Test Acc: 0.667
Validation loss decreased (-0.649990 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 1.7733759880065918
Epoch: 8, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.880 Vali Acc: 0.678 Test Loss: 0.880 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677769).  Saving model ...
Epoch: 9 cost time: 1.7942404747009277
Epoch: 9, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.834 Vali Acc: 0.694 Test Loss: 0.834 Test Acc: 0.694
Validation loss decreased (-0.677769 --> -0.694436).  Saving model ...
Epoch: 10 cost time: 1.9753892421722412
Epoch: 10, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.771 Vali Acc: 0.739 Test Loss: 0.771 Test Acc: 0.739
Validation loss decreased (-0.694436 --> -0.738881).  Saving model ...
Epoch: 11 cost time: 1.8519582748413086
Epoch: 11, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.837 Vali Acc: 0.733 Test Loss: 0.837 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.861393928527832
Epoch: 12, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.805 Vali Acc: 0.706 Test Loss: 0.805 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.032571792602539
Epoch: 13, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.848 Vali Acc: 0.744 Test Loss: 0.848 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744436).  Saving model ...
Epoch: 14 cost time: 1.7824292182922363
Epoch: 14, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.733 Vali Acc: 0.744 Test Loss: 0.733 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 15 cost time: 1.8501639366149902
Epoch: 15, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.806 Vali Acc: 0.756 Test Loss: 0.806 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755547).  Saving model ...
Epoch: 16 cost time: 2.003443479537964
Epoch: 16, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.764 Vali Acc: 0.789 Test Loss: 0.764 Test Acc: 0.789
Validation loss decreased (-0.755547 --> -0.788881).  Saving model ...
Epoch: 17 cost time: 1.9534611701965332
Epoch: 17, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.823 Vali Acc: 0.800 Test Loss: 0.823 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 1.7832286357879639
Epoch: 18, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.851 Vali Acc: 0.778 Test Loss: 0.851 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7526719570159912
Epoch: 19, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.777 Vali Acc: 0.800 Test Loss: 0.777 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 1.9553322792053223
Epoch: 20, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.007 Vali Acc: 0.722 Test Loss: 1.007 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8754463195800781
Epoch: 21, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.841 Vali Acc: 0.783 Test Loss: 0.841 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8736274242401123
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.886 Vali Acc: 0.756 Test Loss: 0.886 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9283738136291504
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.864 Vali Acc: 0.783 Test Loss: 0.864 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.84348726272583
Epoch: 24, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.900 Vali Acc: 0.789 Test Loss: 0.900 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.785290002822876
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.824 Vali Acc: 0.822 Test Loss: 0.824 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822214).  Saving model ...
Epoch: 26 cost time: 1.7048218250274658
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.973 Vali Acc: 0.744 Test Loss: 0.973 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0145483016967773
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.883 Vali Acc: 0.806 Test Loss: 0.883 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9382381439208984
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.909 Vali Acc: 0.789 Test Loss: 0.909 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9462721347808838
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.939 Vali Acc: 0.794 Test Loss: 0.939 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9163594245910645
Epoch: 30, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.848 Vali Acc: 0.822 Test Loss: 0.848 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 5595023
model size : 23.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 10.565881490707397
Epoch: 1, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.588 Vali Acc: 0.228 Test Loss: 2.588 Test Acc: 0.228
Validation loss decreased (inf --> -0.227752).  Saving model ...
Epoch: 2 cost time: 9.305072546005249
Epoch: 2, Steps: 12 | Train Loss: 2.380 Vali Loss: 2.193 Vali Acc: 0.456 Test Loss: 2.193 Test Acc: 0.456
Validation loss decreased (-0.227752 --> -0.455534).  Saving model ...
Epoch: 3 cost time: 9.472058773040771
Epoch: 3, Steps: 12 | Train Loss: 1.894 Vali Loss: 1.794 Vali Acc: 0.528 Test Loss: 1.794 Test Acc: 0.528
Validation loss decreased (-0.455534 --> -0.527760).  Saving model ...
Epoch: 4 cost time: 8.700549364089966
Epoch: 4, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.464 Vali Acc: 0.572 Test Loss: 1.464 Test Acc: 0.572
Validation loss decreased (-0.527760 --> -0.572208).  Saving model ...
Epoch: 5 cost time: 8.625536918640137
Epoch: 5, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.204 Vali Acc: 0.628 Test Loss: 1.204 Test Acc: 0.628
Validation loss decreased (-0.572208 --> -0.627766).  Saving model ...
Epoch: 6 cost time: 8.666495561599731
Epoch: 6, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.017 Vali Acc: 0.683 Test Loss: 1.017 Test Acc: 0.683
Validation loss decreased (-0.627766 --> -0.683323).  Saving model ...
Epoch: 7 cost time: 8.726903915405273
Epoch: 7, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.937 Vali Acc: 0.656 Test Loss: 0.937 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.230087757110596
Epoch: 8, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.821 Vali Acc: 0.700 Test Loss: 0.821 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699992).  Saving model ...
Epoch: 9 cost time: 9.047116041183472
Epoch: 9, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.739 Vali Acc: 0.711 Test Loss: 0.739 Test Acc: 0.711
Validation loss decreased (-0.699992 --> -0.711104).  Saving model ...
Epoch: 10 cost time: 8.628936290740967
Epoch: 10, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.739 Vali Acc: 0.733 Test Loss: 0.739 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733326).  Saving model ...
Epoch: 11 cost time: 8.022880554199219
Epoch: 11, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.652 Vali Acc: 0.761 Test Loss: 0.652 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761105).  Saving model ...
Epoch: 12 cost time: 8.204862833023071
Epoch: 12, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.624 Vali Acc: 0.794 Test Loss: 0.624 Test Acc: 0.794
Validation loss decreased (-0.761105 --> -0.794438).  Saving model ...
Epoch: 13 cost time: 8.155792236328125
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.657 Vali Acc: 0.778 Test Loss: 0.657 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.054236650466919
Epoch: 14, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.281949996948242
Epoch: 15, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.623 Vali Acc: 0.778 Test Loss: 0.623 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.076337337493896
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.684 Vali Acc: 0.778 Test Loss: 0.684 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.228898286819458
Epoch: 17, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.628 Vali Acc: 0.783 Test Loss: 0.628 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.58641767501831
Epoch: 18, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.641 Vali Acc: 0.789 Test Loss: 0.641 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.681818962097168
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.638699054718018
Epoch: 20, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.621 Vali Acc: 0.794 Test Loss: 0.621 Test Acc: 0.794
Validation loss decreased (-0.794438 --> -0.794438).  Saving model ...
Epoch: 21 cost time: 7.848588705062866
Epoch: 21, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.645 Vali Acc: 0.789 Test Loss: 0.645 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.91993522644043
Epoch: 22, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.626 Vali Acc: 0.811 Test Loss: 0.626 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 23 cost time: 7.728746652603149
Epoch: 23, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.888204574584961
Epoch: 24, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.658 Vali Acc: 0.828 Test Loss: 0.658 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827771).  Saving model ...
Epoch: 25 cost time: 8.20098066329956
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.632 Vali Acc: 0.811 Test Loss: 0.632 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 8.609162330627441
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.633 Vali Acc: 0.817 Test Loss: 0.633 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 8.441404581069946
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.613 Vali Acc: 0.811 Test Loss: 0.613 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 8.600919961929321
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.612 Vali Acc: 0.828 Test Loss: 0.612 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 29 cost time: 8.207665205001831
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.617 Vali Acc: 0.828 Test Loss: 0.617 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 8.260184049606323
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.618 Vali Acc: 0.833 Test Loss: 0.618 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 18791119
model size : 72.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.953509569168091
Epoch: 1, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.612 Vali Acc: 0.083 Test Loss: 2.612 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 3.4429357051849365
Epoch: 2, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.241 Vali Acc: 0.344 Test Loss: 2.241 Test Acc: 0.344
Validation loss decreased (-0.083307 --> -0.344422).  Saving model ...
Epoch: 3 cost time: 3.464595079421997
Epoch: 3, Steps: 12 | Train Loss: 2.001 Vali Loss: 1.863 Vali Acc: 0.489 Test Loss: 1.863 Test Acc: 0.489
Validation loss decreased (-0.344422 --> -0.488870).  Saving model ...
Epoch: 4 cost time: 3.5092105865478516
Epoch: 4, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.530 Vali Acc: 0.533 Test Loss: 1.530 Test Acc: 0.533
Validation loss decreased (-0.488870 --> -0.533318).  Saving model ...
Epoch: 5 cost time: 3.571960926055908
Epoch: 5, Steps: 12 | Train Loss: 1.216 Vali Loss: 1.304 Vali Acc: 0.550 Test Loss: 1.304 Test Acc: 0.550
Validation loss decreased (-0.533318 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 3.5757203102111816
Epoch: 6, Steps: 12 | Train Loss: 0.912 Vali Loss: 1.102 Vali Acc: 0.611 Test Loss: 1.102 Test Acc: 0.611
Validation loss decreased (-0.549987 --> -0.611100).  Saving model ...
Epoch: 7 cost time: 3.366626501083374
Epoch: 7, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.981 Vali Acc: 0.661 Test Loss: 0.981 Test Acc: 0.661
Validation loss decreased (-0.611100 --> -0.661101).  Saving model ...
Epoch: 8 cost time: 3.564863920211792
Epoch: 8, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.856 Vali Acc: 0.672 Test Loss: 0.856 Test Acc: 0.672
Validation loss decreased (-0.661101 --> -0.672214).  Saving model ...
Epoch: 9 cost time: 3.7361080646514893
Epoch: 9, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.811 Vali Acc: 0.706 Test Loss: 0.811 Test Acc: 0.706
Validation loss decreased (-0.672214 --> -0.705547).  Saving model ...
Epoch: 10 cost time: 3.459383010864258
Epoch: 10, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.746 Vali Acc: 0.711 Test Loss: 0.746 Test Acc: 0.711
Validation loss decreased (-0.705547 --> -0.711104).  Saving model ...
Epoch: 11 cost time: 3.4167726039886475
Epoch: 11, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.728 Vali Acc: 0.761 Test Loss: 0.728 Test Acc: 0.761
Validation loss decreased (-0.711104 --> -0.761104).  Saving model ...
Epoch: 12 cost time: 3.396193504333496
Epoch: 12, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.680 Vali Acc: 0.739 Test Loss: 0.680 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.197150468826294
Epoch: 13, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.716 Vali Acc: 0.761 Test Loss: 0.716 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761104).  Saving model ...
Epoch: 14 cost time: 3.2930777072906494
Epoch: 14, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.717 Vali Acc: 0.756 Test Loss: 0.717 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4999468326568604
Epoch: 15, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.664 Vali Acc: 0.756 Test Loss: 0.664 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.273724317550659
Epoch: 16, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.703 Vali Acc: 0.772 Test Loss: 0.703 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772215).  Saving model ...
Epoch: 17 cost time: 3.2311367988586426
Epoch: 17, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.681 Vali Acc: 0.772 Test Loss: 0.681 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772215).  Saving model ...
Epoch: 18 cost time: 3.4975714683532715
Epoch: 18, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.709 Vali Acc: 0.772 Test Loss: 0.709 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3307135105133057
Epoch: 19, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.670 Vali Acc: 0.778 Test Loss: 0.670 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 20 cost time: 3.263132333755493
Epoch: 20, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.723 Vali Acc: 0.789 Test Loss: 0.723 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 2.9349851608276367
Epoch: 21, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.678 Vali Acc: 0.778 Test Loss: 0.678 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4852046966552734
Epoch: 22, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.752 Vali Acc: 0.772 Test Loss: 0.752 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5569863319396973
Epoch: 23, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.698 Vali Acc: 0.778 Test Loss: 0.698 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.7583181858062744
Epoch: 24, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.688 Vali Acc: 0.772 Test Loss: 0.688 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.6675634384155273
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.668 Vali Acc: 0.789 Test Loss: 0.668 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 26 cost time: 3.574681520462036
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 3.654759168624878
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.701 Vali Acc: 0.800 Test Loss: 0.701 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 28 cost time: 3.739689826965332
Epoch: 28, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.674 Vali Acc: 0.817 Test Loss: 0.674 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 29 cost time: 3.6268763542175293
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.682 Vali Acc: 0.828 Test Loss: 0.682 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 30 cost time: 3.636820077896118
Epoch: 30, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 5551567
model size : 22.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.850780487060547
Epoch: 1, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.587 Vali Acc: 0.228 Test Loss: 2.587 Test Acc: 0.228
Validation loss decreased (inf --> -0.227752).  Saving model ...
Epoch: 2 cost time: 5.957380056381226
Epoch: 2, Steps: 12 | Train Loss: 2.380 Vali Loss: 2.190 Vali Acc: 0.461 Test Loss: 2.190 Test Acc: 0.461
Validation loss decreased (-0.227752 --> -0.461089).  Saving model ...
Epoch: 3 cost time: 5.9632086753845215
Epoch: 3, Steps: 12 | Train Loss: 1.897 Vali Loss: 1.790 Vali Acc: 0.528 Test Loss: 1.790 Test Acc: 0.528
Validation loss decreased (-0.461089 --> -0.527760).  Saving model ...
Epoch: 4 cost time: 5.505432605743408
Epoch: 4, Steps: 12 | Train Loss: 1.430 Vali Loss: 1.461 Vali Acc: 0.567 Test Loss: 1.461 Test Acc: 0.567
Validation loss decreased (-0.527760 --> -0.566652).  Saving model ...
Epoch: 5 cost time: 5.75371527671814
Epoch: 5, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.202 Vali Acc: 0.622 Test Loss: 1.202 Test Acc: 0.622
Validation loss decreased (-0.566652 --> -0.622210).  Saving model ...
Epoch: 6 cost time: 5.413748264312744
Epoch: 6, Steps: 12 | Train Loss: 0.912 Vali Loss: 1.013 Vali Acc: 0.678 Test Loss: 1.013 Test Acc: 0.678
Validation loss decreased (-0.622210 --> -0.677768).  Saving model ...
Epoch: 7 cost time: 5.341896295547485
Epoch: 7, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.933 Vali Acc: 0.656 Test Loss: 0.933 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.324157476425171
Epoch: 8, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.820 Vali Acc: 0.678 Test Loss: 0.820 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677770).  Saving model ...
Epoch: 9 cost time: 5.478959560394287
Epoch: 9, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.742 Vali Acc: 0.717 Test Loss: 0.742 Test Acc: 0.717
Validation loss decreased (-0.677770 --> -0.716659).  Saving model ...
Epoch: 10 cost time: 4.667879104614258
Epoch: 10, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.749 Vali Acc: 0.722 Test Loss: 0.749 Test Acc: 0.722
Validation loss decreased (-0.716659 --> -0.722215).  Saving model ...
Epoch: 11 cost time: 4.820280075073242
Epoch: 11, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.667 Vali Acc: 0.744 Test Loss: 0.667 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 12 cost time: 4.887814283370972
Epoch: 12, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.637 Vali Acc: 0.767 Test Loss: 0.637 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766660).  Saving model ...
Epoch: 13 cost time: 5.00843358039856
Epoch: 13, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.636 Vali Acc: 0.789 Test Loss: 0.636 Test Acc: 0.789
Validation loss decreased (-0.766660 --> -0.788883).  Saving model ...
Epoch: 14 cost time: 5.226958513259888
Epoch: 14, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.659 Vali Acc: 0.778 Test Loss: 0.659 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.607209920883179
Epoch: 15, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.610 Vali Acc: 0.789 Test Loss: 0.610 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 16 cost time: 5.654613494873047
Epoch: 16, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.681 Vali Acc: 0.800 Test Loss: 0.681 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 5.730118989944458
Epoch: 17, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.672 Vali Acc: 0.783 Test Loss: 0.672 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.656423330307007
Epoch: 18, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.617 Vali Acc: 0.811 Test Loss: 0.617 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 19 cost time: 5.6138646602630615
Epoch: 19, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.685 Vali Acc: 0.783 Test Loss: 0.685 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.481871128082275
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.645 Vali Acc: 0.806 Test Loss: 0.645 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.251359462738037
Epoch: 21, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.631 Vali Acc: 0.817 Test Loss: 0.631 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 22 cost time: 6.6143152713775635
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 23 cost time: 6.26392936706543
Epoch: 23, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.685 Vali Acc: 0.817 Test Loss: 0.685 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.1007304191589355
Epoch: 24, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.690 Vali Acc: 0.817 Test Loss: 0.690 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.036555051803589
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.669 Vali Acc: 0.822 Test Loss: 0.669 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.01063346862793
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.690 Vali Acc: 0.817 Test Loss: 0.690 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.295018434524536
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.678 Vali Acc: 0.817 Test Loss: 0.678 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.9596028327941895
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.696 Vali Acc: 0.811 Test Loss: 0.696 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.0130791664123535
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.674 Vali Acc: 0.828 Test Loss: 0.674 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 30 cost time: 6.01233696937561
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.679 Vali Acc: 0.822 Test Loss: 0.679 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 18791119
model size : 72.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.23550271987915
Epoch: 1, Steps: 12 | Train Loss: 2.691 Vali Loss: 2.610 Vali Acc: 0.083 Test Loss: 2.610 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 2.1408233642578125
Epoch: 2, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.237 Vali Acc: 0.350 Test Loss: 2.237 Test Acc: 0.350
Validation loss decreased (-0.083307 --> -0.349978).  Saving model ...
Epoch: 3 cost time: 2.4725985527038574
Epoch: 3, Steps: 12 | Train Loss: 2.003 Vali Loss: 1.857 Vali Acc: 0.489 Test Loss: 1.857 Test Acc: 0.489
Validation loss decreased (-0.349978 --> -0.488870).  Saving model ...
Epoch: 4 cost time: 2.390645742416382
Epoch: 4, Steps: 12 | Train Loss: 1.528 Vali Loss: 1.523 Vali Acc: 0.539 Test Loss: 1.523 Test Acc: 0.539
Validation loss decreased (-0.488870 --> -0.538874).  Saving model ...
Epoch: 5 cost time: 2.6087050437927246
Epoch: 5, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.296 Vali Acc: 0.556 Test Loss: 1.296 Test Acc: 0.556
Validation loss decreased (-0.538874 --> -0.555543).  Saving model ...
Epoch: 6 cost time: 2.6094295978546143
Epoch: 6, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.094 Vali Acc: 0.639 Test Loss: 1.094 Test Acc: 0.639
Validation loss decreased (-0.555543 --> -0.638878).  Saving model ...
Epoch: 7 cost time: 2.405864715576172
Epoch: 7, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.975 Vali Acc: 0.661 Test Loss: 0.975 Test Acc: 0.661
Validation loss decreased (-0.638878 --> -0.661101).  Saving model ...
Epoch: 8 cost time: 2.9215526580810547
Epoch: 8, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.846 Vali Acc: 0.678 Test Loss: 0.846 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677769).  Saving model ...
Epoch: 9 cost time: 2.846846103668213
Epoch: 9, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.799 Vali Acc: 0.700 Test Loss: 0.799 Test Acc: 0.700
Validation loss decreased (-0.677769 --> -0.699992).  Saving model ...
Epoch: 10 cost time: 2.856649875640869
Epoch: 10, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.741 Vali Acc: 0.728 Test Loss: 0.741 Test Acc: 0.728
Validation loss decreased (-0.699992 --> -0.727770).  Saving model ...
Epoch: 11 cost time: 2.9451193809509277
Epoch: 11, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.726 Vali Acc: 0.750 Test Loss: 0.726 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 2.846007823944092
Epoch: 12, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.676 Vali Acc: 0.756 Test Loss: 0.676 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 13 cost time: 2.8697400093078613
Epoch: 13, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.709 Vali Acc: 0.761 Test Loss: 0.709 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 14 cost time: 2.9038617610931396
Epoch: 14, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.700 Vali Acc: 0.761 Test Loss: 0.700 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 2.876859188079834
Epoch: 15, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.654 Vali Acc: 0.744 Test Loss: 0.654 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.796924591064453
Epoch: 16, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.685 Vali Acc: 0.778 Test Loss: 0.685 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 17 cost time: 2.958709716796875
Epoch: 17, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 18 cost time: 2.859110116958618
Epoch: 18, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.708 Vali Acc: 0.772 Test Loss: 0.708 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8509602546691895
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.675 Vali Acc: 0.778 Test Loss: 0.675 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9249227046966553
Epoch: 20, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.741 Vali Acc: 0.789 Test Loss: 0.741 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788881).  Saving model ...
Epoch: 21 cost time: 2.780707836151123
Epoch: 21, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.681 Vali Acc: 0.778 Test Loss: 0.681 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7536728382110596
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.761 Vali Acc: 0.772 Test Loss: 0.761 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9306228160858154
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.706 Vali Acc: 0.772 Test Loss: 0.706 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7853403091430664
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.730 Vali Acc: 0.772 Test Loss: 0.730 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.7728590965270996
Epoch: 25, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 26 cost time: 2.9332897663116455
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.720 Vali Acc: 0.794 Test Loss: 0.720 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.751093626022339
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.748 Vali Acc: 0.794 Test Loss: 0.748 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.7589261531829834
Epoch: 28, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.719 Vali Acc: 0.794 Test Loss: 0.719 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.6758644580841064
Epoch: 29, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.694 Vali Acc: 0.811 Test Loss: 0.694 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 30 cost time: 2.6038153171539307
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.716 Vali Acc: 0.806 Test Loss: 0.716 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 5551567
model size : 22.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.121696949005127
Epoch: 1, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.624 Vali Acc: 0.194 Test Loss: 2.624 Test Acc: 0.194
Validation loss decreased (inf --> -0.194418).  Saving model ...
Epoch: 2 cost time: 3.675994396209717
Epoch: 2, Steps: 12 | Train Loss: 2.462 Vali Loss: 2.313 Vali Acc: 0.439 Test Loss: 2.313 Test Acc: 0.439
Validation loss decreased (-0.194418 --> -0.438866).  Saving model ...
Epoch: 3 cost time: 3.553826332092285
Epoch: 3, Steps: 12 | Train Loss: 2.101 Vali Loss: 2.005 Vali Acc: 0.494 Test Loss: 2.005 Test Acc: 0.494
Validation loss decreased (-0.438866 --> -0.494424).  Saving model ...
Epoch: 4 cost time: 3.3398921489715576
Epoch: 4, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.733 Vali Acc: 0.522 Test Loss: 1.733 Test Acc: 0.522
Validation loss decreased (-0.494424 --> -0.522205).  Saving model ...
Epoch: 5 cost time: 3.285963296890259
Epoch: 5, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.496 Vali Acc: 0.544 Test Loss: 1.496 Test Acc: 0.544
Validation loss decreased (-0.522205 --> -0.544429).  Saving model ...
Epoch: 6 cost time: 3.226417303085327
Epoch: 6, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.298 Vali Acc: 0.594 Test Loss: 1.298 Test Acc: 0.594
Validation loss decreased (-0.544429 --> -0.594431).  Saving model ...
Epoch: 7 cost time: 3.2883403301239014
Epoch: 7, Steps: 12 | Train Loss: 0.947 Vali Loss: 1.163 Vali Acc: 0.578 Test Loss: 1.163 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3874781131744385
Epoch: 8, Steps: 12 | Train Loss: 0.832 Vali Loss: 1.031 Vali Acc: 0.639 Test Loss: 1.031 Test Acc: 0.639
Validation loss decreased (-0.594431 --> -0.638879).  Saving model ...
Epoch: 9 cost time: 3.357635259628296
Epoch: 9, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.947 Vali Acc: 0.689 Test Loss: 0.947 Test Acc: 0.689
Validation loss decreased (-0.638879 --> -0.688879).  Saving model ...
Epoch: 10 cost time: 3.3125009536743164
Epoch: 10, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.885 Vali Acc: 0.678 Test Loss: 0.885 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.39786696434021
Epoch: 11, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.772 Vali Acc: 0.706 Test Loss: 0.772 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705548).  Saving model ...
Epoch: 12 cost time: 3.0293188095092773
Epoch: 12, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.765 Vali Acc: 0.744 Test Loss: 0.765 Test Acc: 0.744
Validation loss decreased (-0.705548 --> -0.744437).  Saving model ...
Epoch: 13 cost time: 3.4048025608062744
Epoch: 13, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.681 Vali Acc: 0.778 Test Loss: 0.681 Test Acc: 0.778
Validation loss decreased (-0.744437 --> -0.777771).  Saving model ...
Epoch: 14 cost time: 3.5323333740234375
Epoch: 14, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.687 Vali Acc: 0.789 Test Loss: 0.687 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 15 cost time: 3.5024499893188477
Epoch: 15, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.624 Vali Acc: 0.800 Test Loss: 0.624 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 3.5312070846557617
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5668859481811523
Epoch: 17, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.598 Vali Acc: 0.806 Test Loss: 0.598 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805550).  Saving model ...
Epoch: 18 cost time: 3.738736867904663
Epoch: 18, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.550 Vali Acc: 0.800 Test Loss: 0.550 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.742357015609741
Epoch: 19, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.664 Vali Acc: 0.761 Test Loss: 0.664 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.897348642349243
Epoch: 20, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.622 Vali Acc: 0.783 Test Loss: 0.622 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.787369728088379
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.736 Vali Acc: 0.733 Test Loss: 0.736 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.7569267749786377
Epoch: 22, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.605 Vali Acc: 0.806 Test Loss: 0.605 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.853484869003296
Epoch: 23, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.716 Vali Acc: 0.789 Test Loss: 0.716 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.8412013053894043
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.711 Vali Acc: 0.794 Test Loss: 0.711 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.7197017669677734
Epoch: 25, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.623 Vali Acc: 0.828 Test Loss: 0.623 Test Acc: 0.828
Validation loss decreased (-0.805550 --> -0.827772).  Saving model ...
Epoch: 26 cost time: 3.743929386138916
Epoch: 26, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.589 Vali Acc: 0.833 Test Loss: 0.589 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 3.969625473022461
Epoch: 27, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.728621482849121
Epoch: 28, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.608 Vali Acc: 0.806 Test Loss: 0.608 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.725503444671631
Epoch: 29, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.646 Vali Acc: 0.828 Test Loss: 0.646 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.911111831665039
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.608 Vali Acc: 0.833 Test Loss: 0.608 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 18791119
model size : 72.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7209970951080322
Epoch: 1, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.637 Vali Acc: 0.061 Test Loss: 2.637 Test Acc: 0.061
Validation loss decreased (inf --> -0.061085).  Saving model ...
Epoch: 2 cost time: 1.9375534057617188
Epoch: 2, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.340 Vali Acc: 0.311 Test Loss: 2.340 Test Acc: 0.311
Validation loss decreased (-0.061085 --> -0.311088).  Saving model ...
Epoch: 3 cost time: 2.056077241897583
Epoch: 3, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.022 Vali Acc: 0.467 Test Loss: 2.022 Test Acc: 0.467
Validation loss decreased (-0.311088 --> -0.466646).  Saving model ...
Epoch: 4 cost time: 1.9134347438812256
Epoch: 4, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.734 Vali Acc: 0.517 Test Loss: 1.734 Test Acc: 0.517
Validation loss decreased (-0.466646 --> -0.516649).  Saving model ...
Epoch: 5 cost time: 2.00713849067688
Epoch: 5, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.531 Vali Acc: 0.533 Test Loss: 1.531 Test Acc: 0.533
Validation loss decreased (-0.516649 --> -0.533318).  Saving model ...
Epoch: 6 cost time: 1.7536358833312988
Epoch: 6, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.326 Vali Acc: 0.572 Test Loss: 1.326 Test Acc: 0.572
Validation loss decreased (-0.533318 --> -0.572209).  Saving model ...
Epoch: 7 cost time: 1.84403395652771
Epoch: 7, Steps: 12 | Train Loss: 0.998 Vali Loss: 1.193 Vali Acc: 0.622 Test Loss: 1.193 Test Acc: 0.622
Validation loss decreased (-0.572209 --> -0.622210).  Saving model ...
Epoch: 8 cost time: 1.7972512245178223
Epoch: 8, Steps: 12 | Train Loss: 0.768 Vali Loss: 1.055 Vali Acc: 0.606 Test Loss: 1.055 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8301265239715576
Epoch: 9, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.958 Vali Acc: 0.639 Test Loss: 0.958 Test Acc: 0.639
Validation loss decreased (-0.622210 --> -0.638879).  Saving model ...
Epoch: 10 cost time: 1.8020474910736084
Epoch: 10, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.900 Vali Acc: 0.683 Test Loss: 0.900 Test Acc: 0.683
Validation loss decreased (-0.638879 --> -0.683324).  Saving model ...
Epoch: 11 cost time: 1.7718639373779297
Epoch: 11, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.875 Vali Acc: 0.656 Test Loss: 0.875 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7720041275024414
Epoch: 12, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.831 Vali Acc: 0.672 Test Loss: 0.831 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.707451343536377
Epoch: 13, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.810 Vali Acc: 0.689 Test Loss: 0.810 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688881).  Saving model ...
Epoch: 14 cost time: 1.7862021923065186
Epoch: 14, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.793 Vali Acc: 0.717 Test Loss: 0.793 Test Acc: 0.717
Validation loss decreased (-0.688881 --> -0.716659).  Saving model ...
Epoch: 15 cost time: 1.8563013076782227
Epoch: 15, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.696 Vali Acc: 0.789 Test Loss: 0.696 Test Acc: 0.789
Validation loss decreased (-0.716659 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 1.835129737854004
Epoch: 16, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.773 Vali Acc: 0.733 Test Loss: 0.773 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7582201957702637
Epoch: 17, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.743 Vali Acc: 0.767 Test Loss: 0.743 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9095263481140137
Epoch: 18, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.732 Vali Acc: 0.739 Test Loss: 0.732 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8759145736694336
Epoch: 19, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.660 Vali Acc: 0.794 Test Loss: 0.660 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 20 cost time: 1.9125292301177979
Epoch: 20, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.753 Vali Acc: 0.744 Test Loss: 0.753 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9851114749908447
Epoch: 21, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.796 Vali Acc: 0.733 Test Loss: 0.796 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9933812618255615
Epoch: 22, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.840 Vali Acc: 0.733 Test Loss: 0.840 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8559050559997559
Epoch: 23, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.710 Vali Acc: 0.772 Test Loss: 0.710 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.106428623199463
Epoch: 24, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.688 Vali Acc: 0.783 Test Loss: 0.688 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9854435920715332
Epoch: 25, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.634 Vali Acc: 0.811 Test Loss: 0.634 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 26 cost time: 1.992720365524292
Epoch: 26, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.660 Vali Acc: 0.789 Test Loss: 0.660 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9032771587371826
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.703 Vali Acc: 0.794 Test Loss: 0.703 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8832778930664062
Epoch: 28, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.700 Vali Acc: 0.783 Test Loss: 0.700 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.0459392070770264
Epoch: 29, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.722 Vali Acc: 0.783 Test Loss: 0.722 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.118346929550171
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.787 Vali Acc: 0.783 Test Loss: 0.787 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 5551567
model size : 22.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.270642995834351
Epoch: 1, Steps: 12 | Train Loss: 2.745 Vali Loss: 2.599 Vali Acc: 0.150 Test Loss: 2.599 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 5.700886249542236
Epoch: 2, Steps: 12 | Train Loss: 2.467 Vali Loss: 2.271 Vali Acc: 0.394 Test Loss: 2.271 Test Acc: 0.394
Validation loss decreased (-0.149974 --> -0.394422).  Saving model ...
Epoch: 3 cost time: 5.6851441860198975
Epoch: 3, Steps: 12 | Train Loss: 2.063 Vali Loss: 1.871 Vali Acc: 0.528 Test Loss: 1.871 Test Acc: 0.528
Validation loss decreased (-0.394422 --> -0.527759).  Saving model ...
Epoch: 4 cost time: 5.576141357421875
Epoch: 4, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.520 Vali Acc: 0.572 Test Loss: 1.520 Test Acc: 0.572
Validation loss decreased (-0.527759 --> -0.572207).  Saving model ...
Epoch: 5 cost time: 5.468924283981323
Epoch: 5, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.284 Vali Acc: 0.600 Test Loss: 1.284 Test Acc: 0.600
Validation loss decreased (-0.572207 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 5.715557336807251
Epoch: 6, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.104 Vali Acc: 0.644 Test Loss: 1.104 Test Acc: 0.644
Validation loss decreased (-0.599987 --> -0.644433).  Saving model ...
Epoch: 7 cost time: 5.575567007064819
Epoch: 7, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.989 Vali Acc: 0.639 Test Loss: 0.989 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.477811098098755
Epoch: 8, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.911 Vali Acc: 0.661 Test Loss: 0.911 Test Acc: 0.661
Validation loss decreased (-0.644433 --> -0.661102).  Saving model ...
Epoch: 9 cost time: 5.545164108276367
Epoch: 9, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.799 Vali Acc: 0.717 Test Loss: 0.799 Test Acc: 0.717
Validation loss decreased (-0.661102 --> -0.716659).  Saving model ...
Epoch: 10 cost time: 5.745018482208252
Epoch: 10, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.760 Vali Acc: 0.733 Test Loss: 0.760 Test Acc: 0.733
Validation loss decreased (-0.716659 --> -0.733326).  Saving model ...
Epoch: 11 cost time: 5.444610595703125
Epoch: 11, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.687 Vali Acc: 0.756 Test Loss: 0.687 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755549).  Saving model ...
Epoch: 12 cost time: 4.820129871368408
Epoch: 12, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.675 Vali Acc: 0.733 Test Loss: 0.675 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.9024481773376465
Epoch: 13, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.633 Vali Acc: 0.761 Test Loss: 0.633 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 14 cost time: 4.997331619262695
Epoch: 14, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.680 Vali Acc: 0.750 Test Loss: 0.680 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.951422691345215
Epoch: 15, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
Validation loss decreased (-0.761105 --> -0.783327).  Saving model ...
Epoch: 16 cost time: 4.814113616943359
Epoch: 16, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.622 Vali Acc: 0.789 Test Loss: 0.622 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788883).  Saving model ...
Epoch: 17 cost time: 4.843912124633789
Epoch: 17, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.581 Vali Acc: 0.794 Test Loss: 0.581 Test Acc: 0.794
Validation loss decreased (-0.788883 --> -0.794439).  Saving model ...
Epoch: 18 cost time: 4.636749744415283
Epoch: 18, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.579 Vali Acc: 0.806 Test Loss: 0.579 Test Acc: 0.806
Validation loss decreased (-0.794439 --> -0.805550).  Saving model ...
Epoch: 19 cost time: 5.466961860656738
Epoch: 19, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.597 Vali Acc: 0.800 Test Loss: 0.597 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.263826608657837
Epoch: 20, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.601 Vali Acc: 0.800 Test Loss: 0.601 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.353418827056885
Epoch: 21, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.645 Vali Acc: 0.789 Test Loss: 0.645 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.570028305053711
Epoch: 22, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.611 Vali Acc: 0.794 Test Loss: 0.611 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.542531967163086
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
Validation loss decreased (-0.805550 --> -0.822217).  Saving model ...
Epoch: 24 cost time: 5.529269456863403
Epoch: 24, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.656 Vali Acc: 0.811 Test Loss: 0.656 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.6253578662872314
Epoch: 25, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.528 Vali Acc: 0.828 Test Loss: 0.528 Test Acc: 0.828
Validation loss decreased (-0.822217 --> -0.827772).  Saving model ...
Epoch: 26 cost time: 5.858279228210449
Epoch: 26, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.534 Vali Acc: 0.817 Test Loss: 0.534 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.478411912918091
Epoch: 27, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.571 Vali Acc: 0.828 Test Loss: 0.571 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.551252126693726
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.543 Vali Acc: 0.817 Test Loss: 0.543 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.6041529178619385
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 30 cost time: 5.524404764175415
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 9417935
model size : 37.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.392224073410034
Epoch: 1, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.562 Vali Acc: 0.156 Test Loss: 2.562 Test Acc: 0.156
Validation loss decreased (inf --> -0.155530).  Saving model ...
Epoch: 2 cost time: 2.4002525806427
Epoch: 2, Steps: 12 | Train Loss: 2.469 Vali Loss: 2.234 Vali Acc: 0.417 Test Loss: 2.234 Test Acc: 0.417
Validation loss decreased (-0.155530 --> -0.416644).  Saving model ...
Epoch: 3 cost time: 2.485306739807129
Epoch: 3, Steps: 12 | Train Loss: 2.058 Vali Loss: 1.868 Vali Acc: 0.511 Test Loss: 1.868 Test Acc: 0.511
Validation loss decreased (-0.416644 --> -0.511092).  Saving model ...
Epoch: 4 cost time: 2.4383277893066406
Epoch: 4, Steps: 12 | Train Loss: 1.652 Vali Loss: 1.554 Vali Acc: 0.539 Test Loss: 1.554 Test Acc: 0.539
Validation loss decreased (-0.511092 --> -0.538873).  Saving model ...
Epoch: 5 cost time: 2.4155499935150146
Epoch: 5, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.303 Vali Acc: 0.550 Test Loss: 1.303 Test Acc: 0.550
Validation loss decreased (-0.538873 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 2.534141778945923
Epoch: 6, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.120 Vali Acc: 0.578 Test Loss: 1.120 Test Acc: 0.578
Validation loss decreased (-0.549987 --> -0.577767).  Saving model ...
Epoch: 7 cost time: 2.50842547416687
Epoch: 7, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.975 Vali Acc: 0.656 Test Loss: 0.975 Test Acc: 0.656
Validation loss decreased (-0.577767 --> -0.655546).  Saving model ...
Epoch: 8 cost time: 2.4055140018463135
Epoch: 8, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.903 Vali Acc: 0.678 Test Loss: 0.903 Test Acc: 0.678
Validation loss decreased (-0.655546 --> -0.677769).  Saving model ...
Epoch: 9 cost time: 2.249828338623047
Epoch: 9, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.831 Vali Acc: 0.694 Test Loss: 0.831 Test Acc: 0.694
Validation loss decreased (-0.677769 --> -0.694436).  Saving model ...
Epoch: 10 cost time: 2.1357052326202393
Epoch: 10, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.770 Vali Acc: 0.694 Test Loss: 0.770 Test Acc: 0.694
Validation loss decreased (-0.694436 --> -0.694437).  Saving model ...
Epoch: 11 cost time: 2.2232296466827393
Epoch: 11, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.740 Vali Acc: 0.728 Test Loss: 0.740 Test Acc: 0.728
Validation loss decreased (-0.694437 --> -0.727770).  Saving model ...
Epoch: 12 cost time: 2.1165590286254883
Epoch: 12, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.700 Vali Acc: 0.750 Test Loss: 0.700 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 2.1599106788635254
Epoch: 13, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.713 Vali Acc: 0.744 Test Loss: 0.713 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.181652069091797
Epoch: 14, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.731 Vali Acc: 0.744 Test Loss: 0.731 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1064090728759766
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.727 Vali Acc: 0.750 Test Loss: 0.727 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1656699180603027
Epoch: 16, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.740 Vali Acc: 0.744 Test Loss: 0.740 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1051361560821533
Epoch: 17, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.707 Vali Acc: 0.772 Test Loss: 0.707 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772215).  Saving model ...
Epoch: 18 cost time: 2.140700101852417
Epoch: 18, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.765 Vali Acc: 0.778 Test Loss: 0.765 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 19 cost time: 2.246924638748169
Epoch: 19, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.730 Vali Acc: 0.761 Test Loss: 0.730 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.334752321243286
Epoch: 20, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.742 Vali Acc: 0.767 Test Loss: 0.742 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4483442306518555
Epoch: 21, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.776 Vali Acc: 0.772 Test Loss: 0.776 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.388436794281006
Epoch: 22, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.765 Vali Acc: 0.783 Test Loss: 0.765 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 23 cost time: 2.4103338718414307
Epoch: 23, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.748 Vali Acc: 0.778 Test Loss: 0.748 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.504936695098877
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.753 Vali Acc: 0.772 Test Loss: 0.753 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.399729013442993
Epoch: 25, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.855 Vali Acc: 0.761 Test Loss: 0.855 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2247185707092285
Epoch: 26, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.756 Vali Acc: 0.767 Test Loss: 0.756 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.2910337448120117
Epoch: 27, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.913 Vali Acc: 0.767 Test Loss: 0.913 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.195042610168457
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.827 Vali Acc: 0.767 Test Loss: 0.827 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.212000608444214
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.808 Vali Acc: 0.767 Test Loss: 0.808 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.2018659114837646
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.841 Vali Acc: 0.778 Test Loss: 0.841 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 2798031
model size : 11.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.273055791854858
Epoch: 1, Steps: 12 | Train Loss: 2.745 Vali Loss: 2.599 Vali Acc: 0.150 Test Loss: 2.599 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 3.7328243255615234
Epoch: 2, Steps: 12 | Train Loss: 2.467 Vali Loss: 2.269 Vali Acc: 0.394 Test Loss: 2.269 Test Acc: 0.394
Validation loss decreased (-0.149974 --> -0.394422).  Saving model ...
Epoch: 3 cost time: 3.7299814224243164
Epoch: 3, Steps: 12 | Train Loss: 2.066 Vali Loss: 1.867 Vali Acc: 0.533 Test Loss: 1.867 Test Acc: 0.533
Validation loss decreased (-0.394422 --> -0.533315).  Saving model ...
Epoch: 4 cost time: 3.704220771789551
Epoch: 4, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.517 Vali Acc: 0.572 Test Loss: 1.517 Test Acc: 0.572
Validation loss decreased (-0.533315 --> -0.572207).  Saving model ...
Epoch: 5 cost time: 3.6804263591766357
Epoch: 5, Steps: 12 | Train Loss: 1.209 Vali Loss: 1.284 Vali Acc: 0.600 Test Loss: 1.284 Test Acc: 0.600
Validation loss decreased (-0.572207 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 3.638552665710449
Epoch: 6, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.108 Vali Acc: 0.633 Test Loss: 1.108 Test Acc: 0.633
Validation loss decreased (-0.599987 --> -0.633322).  Saving model ...
Epoch: 7 cost time: 3.768850088119507
Epoch: 7, Steps: 12 | Train Loss: 0.837 Vali Loss: 1.004 Vali Acc: 0.633 Test Loss: 1.004 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633323).  Saving model ...
Epoch: 8 cost time: 3.6435387134552
Epoch: 8, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.926 Vali Acc: 0.656 Test Loss: 0.926 Test Acc: 0.656
Validation loss decreased (-0.633323 --> -0.655546).  Saving model ...
Epoch: 9 cost time: 3.6253628730773926
Epoch: 9, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.824 Vali Acc: 0.711 Test Loss: 0.824 Test Acc: 0.711
Validation loss decreased (-0.655546 --> -0.711103).  Saving model ...
Epoch: 10 cost time: 3.420247793197632
Epoch: 10, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.783 Vali Acc: 0.728 Test Loss: 0.783 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 11 cost time: 3.4741742610931396
Epoch: 11, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.697 Vali Acc: 0.761 Test Loss: 0.697 Test Acc: 0.761
Validation loss decreased (-0.727770 --> -0.761104).  Saving model ...
Epoch: 12 cost time: 3.6833982467651367
Epoch: 12, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.684 Vali Acc: 0.756 Test Loss: 0.684 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.302619457244873
Epoch: 13, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.667 Vali Acc: 0.744 Test Loss: 0.667 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.401904821395874
Epoch: 14, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.667 Vali Acc: 0.761 Test Loss: 0.667 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 3.314526319503784
Epoch: 15, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.673 Vali Acc: 0.778 Test Loss: 0.673 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 16 cost time: 3.207570791244507
Epoch: 16, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.635 Vali Acc: 0.767 Test Loss: 0.635 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.301933765411377
Epoch: 17, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.584 Vali Acc: 0.794 Test Loss: 0.584 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794439).  Saving model ...
Epoch: 18 cost time: 3.3165171146392822
Epoch: 18, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.589 Vali Acc: 0.789 Test Loss: 0.589 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2925398349761963
Epoch: 19, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.588 Vali Acc: 0.800 Test Loss: 0.588 Test Acc: 0.800
Validation loss decreased (-0.794439 --> -0.799994).  Saving model ...
Epoch: 20 cost time: 3.1625399589538574
Epoch: 20, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.630 Vali Acc: 0.789 Test Loss: 0.630 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.505582571029663
Epoch: 21, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.5015666484832764
Epoch: 22, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.601 Vali Acc: 0.811 Test Loss: 0.601 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811105).  Saving model ...
Epoch: 23 cost time: 3.4936704635620117
Epoch: 23, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.561 Vali Acc: 0.800 Test Loss: 0.561 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.680619478225708
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.566 Vali Acc: 0.806 Test Loss: 0.566 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.7280359268188477
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.576 Vali Acc: 0.811 Test Loss: 0.576 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 26 cost time: 3.663649320602417
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.557 Vali Acc: 0.811 Test Loss: 0.557 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811106).  Saving model ...
Epoch: 27 cost time: 3.476309061050415
Epoch: 27, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.579 Vali Acc: 0.806 Test Loss: 0.579 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5065367221832275
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.553 Vali Acc: 0.817 Test Loss: 0.553 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816661).  Saving model ...
Epoch: 29 cost time: 3.4835987091064453
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.569 Vali Acc: 0.811 Test Loss: 0.569 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5080201625823975
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.568 Vali Acc: 0.811 Test Loss: 0.568 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 9417935
model size : 37.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.585787534713745
Epoch: 1, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.561 Vali Acc: 0.156 Test Loss: 2.561 Test Acc: 0.156
Validation loss decreased (inf --> -0.155530).  Saving model ...
Epoch: 2 cost time: 1.9240217208862305
Epoch: 2, Steps: 12 | Train Loss: 2.469 Vali Loss: 2.233 Vali Acc: 0.411 Test Loss: 2.233 Test Acc: 0.411
Validation loss decreased (-0.155530 --> -0.411089).  Saving model ...
Epoch: 3 cost time: 1.915900707244873
Epoch: 3, Steps: 12 | Train Loss: 2.059 Vali Loss: 1.867 Vali Acc: 0.511 Test Loss: 1.867 Test Acc: 0.511
Validation loss decreased (-0.411089 --> -0.511092).  Saving model ...
Epoch: 4 cost time: 1.832106351852417
Epoch: 4, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.552 Vali Acc: 0.544 Test Loss: 1.552 Test Acc: 0.544
Validation loss decreased (-0.511092 --> -0.544429).  Saving model ...
Epoch: 5 cost time: 1.9202897548675537
Epoch: 5, Steps: 12 | Train Loss: 1.270 Vali Loss: 1.300 Vali Acc: 0.550 Test Loss: 1.300 Test Acc: 0.550
Validation loss decreased (-0.544429 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 1.933828353881836
Epoch: 6, Steps: 12 | Train Loss: 1.018 Vali Loss: 1.120 Vali Acc: 0.578 Test Loss: 1.120 Test Acc: 0.578
Validation loss decreased (-0.549987 --> -0.577767).  Saving model ...
Epoch: 7 cost time: 2.0777530670166016
Epoch: 7, Steps: 12 | Train Loss: 0.842 Vali Loss: 0.975 Vali Acc: 0.644 Test Loss: 0.975 Test Acc: 0.644
Validation loss decreased (-0.577767 --> -0.644435).  Saving model ...
Epoch: 8 cost time: 1.841597318649292
Epoch: 8, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.905 Vali Acc: 0.667 Test Loss: 0.905 Test Acc: 0.667
Validation loss decreased (-0.644435 --> -0.666658).  Saving model ...
Epoch: 9 cost time: 2.053408622741699
Epoch: 9, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.828 Vali Acc: 0.672 Test Loss: 0.828 Test Acc: 0.672
Validation loss decreased (-0.666658 --> -0.672214).  Saving model ...
Epoch: 10 cost time: 1.917639970779419
Epoch: 10, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.775 Vali Acc: 0.683 Test Loss: 0.775 Test Acc: 0.683
Validation loss decreased (-0.672214 --> -0.683326).  Saving model ...
Epoch: 11 cost time: 1.9717257022857666
Epoch: 11, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.758 Vali Acc: 0.711 Test Loss: 0.758 Test Acc: 0.711
Validation loss decreased (-0.683326 --> -0.711104).  Saving model ...
Epoch: 12 cost time: 1.931877613067627
Epoch: 12, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.713 Vali Acc: 0.744 Test Loss: 0.713 Test Acc: 0.744
Validation loss decreased (-0.711104 --> -0.744437).  Saving model ...
Epoch: 13 cost time: 1.8717477321624756
Epoch: 13, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.735 Vali Acc: 0.728 Test Loss: 0.735 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8183648586273193
Epoch: 14, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.740 Vali Acc: 0.744 Test Loss: 0.740 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8949120044708252
Epoch: 15, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.730 Vali Acc: 0.739 Test Loss: 0.730 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.95668363571167
Epoch: 16, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.762 Vali Acc: 0.756 Test Loss: 0.762 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 17 cost time: 1.7669932842254639
Epoch: 17, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.711 Vali Acc: 0.772 Test Loss: 0.711 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 18 cost time: 1.7902519702911377
Epoch: 18, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.761 Vali Acc: 0.761 Test Loss: 0.761 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7343690395355225
Epoch: 19, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.738 Vali Acc: 0.767 Test Loss: 0.738 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7570440769195557
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.730 Vali Acc: 0.744 Test Loss: 0.730 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7352893352508545
Epoch: 21, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.758 Vali Acc: 0.761 Test Loss: 0.758 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.743809461593628
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.759 Vali Acc: 0.778 Test Loss: 0.759 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 23 cost time: 1.8438136577606201
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.736 Vali Acc: 0.767 Test Loss: 0.736 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7060518264770508
Epoch: 24, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.741 Vali Acc: 0.772 Test Loss: 0.741 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6603593826293945
Epoch: 25, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.821 Vali Acc: 0.772 Test Loss: 0.821 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7449679374694824
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.729 Vali Acc: 0.761 Test Loss: 0.729 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.558335304260254
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.845 Vali Acc: 0.772 Test Loss: 0.845 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6598014831542969
Epoch: 28, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.793 Vali Acc: 0.761 Test Loss: 0.793 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9061815738677979
Epoch: 29, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.776 Vali Acc: 0.778 Test Loss: 0.776 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7970623970031738
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.803 Vali Acc: 0.772 Test Loss: 0.803 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 2798031
model size : 11.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.443481922149658
Epoch: 1, Steps: 12 | Train Loss: 2.747 Vali Loss: 2.615 Vali Acc: 0.111 Test Loss: 2.615 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 2.096569776535034
Epoch: 2, Steps: 12 | Train Loss: 2.527 Vali Loss: 2.345 Vali Acc: 0.344 Test Loss: 2.345 Test Acc: 0.344
Validation loss decreased (-0.111085 --> -0.344421).  Saving model ...
Epoch: 3 cost time: 2.2584333419799805
Epoch: 3, Steps: 12 | Train Loss: 2.190 Vali Loss: 2.029 Vali Acc: 0.489 Test Loss: 2.029 Test Acc: 0.489
Validation loss decreased (-0.344421 --> -0.488869).  Saving model ...
Epoch: 4 cost time: 2.147214889526367
Epoch: 4, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.740 Vali Acc: 0.567 Test Loss: 1.740 Test Acc: 0.567
Validation loss decreased (-0.488869 --> -0.566649).  Saving model ...
Epoch: 5 cost time: 2.1826679706573486
Epoch: 5, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.534 Vali Acc: 0.567 Test Loss: 1.534 Test Acc: 0.567
Validation loss decreased (-0.566649 --> -0.566651).  Saving model ...
Epoch: 6 cost time: 2.2177751064300537
Epoch: 6, Steps: 12 | Train Loss: 1.248 Vali Loss: 1.356 Vali Acc: 0.611 Test Loss: 1.356 Test Acc: 0.611
Validation loss decreased (-0.566651 --> -0.611098).  Saving model ...
Epoch: 7 cost time: 2.114169120788574
Epoch: 7, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.243 Vali Acc: 0.572 Test Loss: 1.243 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.176427125930786
Epoch: 8, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.126 Vali Acc: 0.617 Test Loss: 1.126 Test Acc: 0.617
Validation loss decreased (-0.611098 --> -0.616655).  Saving model ...
Epoch: 9 cost time: 2.2027552127838135
Epoch: 9, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.998 Vali Acc: 0.683 Test Loss: 0.998 Test Acc: 0.683
Validation loss decreased (-0.616655 --> -0.683323).  Saving model ...
Epoch: 10 cost time: 2.211785078048706
Epoch: 10, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.934 Vali Acc: 0.706 Test Loss: 0.934 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705546).  Saving model ...
Epoch: 11 cost time: 2.270699977874756
Epoch: 11, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.860 Vali Acc: 0.706 Test Loss: 0.860 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705547).  Saving model ...
Epoch: 12 cost time: 2.3284835815429688
Epoch: 12, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.851 Vali Acc: 0.694 Test Loss: 0.851 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3053503036499023
Epoch: 13, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.825 Vali Acc: 0.706 Test Loss: 0.825 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 14 cost time: 2.2663414478302
Epoch: 14, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.773 Vali Acc: 0.722 Test Loss: 0.773 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722214).  Saving model ...
Epoch: 15 cost time: 2.227932929992676
Epoch: 15, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.713 Vali Acc: 0.778 Test Loss: 0.713 Test Acc: 0.778
Validation loss decreased (-0.722214 --> -0.777771).  Saving model ...
Epoch: 16 cost time: 2.312812089920044
Epoch: 16, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.745 Vali Acc: 0.744 Test Loss: 0.745 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1903083324432373
Epoch: 17, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.681 Vali Acc: 0.772 Test Loss: 0.681 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2226476669311523
Epoch: 18, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.671 Vali Acc: 0.789 Test Loss: 0.671 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 19 cost time: 2.206040620803833
Epoch: 19, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.674 Vali Acc: 0.794 Test Loss: 0.674 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 20 cost time: 2.618361473083496
Epoch: 20, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5207130908966064
Epoch: 21, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.749 Vali Acc: 0.767 Test Loss: 0.749 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.492431640625
Epoch: 22, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.713 Vali Acc: 0.772 Test Loss: 0.713 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5969345569610596
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.473841428756714
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.799 Vali Acc: 0.756 Test Loss: 0.799 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.488055944442749
Epoch: 25, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.810 Vali Acc: 0.728 Test Loss: 0.810 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.332138776779175
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.867 Vali Acc: 0.739 Test Loss: 0.867 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.2823283672332764
Epoch: 27, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.756 Vali Acc: 0.783 Test Loss: 0.756 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.2847583293914795
Epoch: 28, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.588 Vali Acc: 0.839 Test Loss: 0.588 Test Acc: 0.839
Validation loss decreased (-0.794438 --> -0.838883).  Saving model ...
Epoch: 29 cost time: 2.3857054710388184
Epoch: 29, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.645 Vali Acc: 0.817 Test Loss: 0.645 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.4986982345581055
Epoch: 30, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.745 Vali Acc: 0.772 Test Loss: 0.745 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 9417935
model size : 37.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1360230445861816
Epoch: 1, Steps: 12 | Train Loss: 2.763 Vali Loss: 2.579 Vali Acc: 0.144 Test Loss: 2.579 Test Acc: 0.144
Validation loss decreased (inf --> -0.144419).  Saving model ...
Epoch: 2 cost time: 1.5540423393249512
Epoch: 2, Steps: 12 | Train Loss: 2.518 Vali Loss: 2.302 Vali Acc: 0.367 Test Loss: 2.302 Test Acc: 0.367
Validation loss decreased (-0.144419 --> -0.366644).  Saving model ...
Epoch: 3 cost time: 1.5932931900024414
Epoch: 3, Steps: 12 | Train Loss: 2.168 Vali Loss: 1.995 Vali Acc: 0.483 Test Loss: 1.995 Test Acc: 0.483
Validation loss decreased (-0.366644 --> -0.483313).  Saving model ...
Epoch: 4 cost time: 1.5746471881866455
Epoch: 4, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.725 Vali Acc: 0.517 Test Loss: 1.725 Test Acc: 0.517
Validation loss decreased (-0.483313 --> -0.516649).  Saving model ...
Epoch: 5 cost time: 1.5095832347869873
Epoch: 5, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.495 Vali Acc: 0.561 Test Loss: 1.495 Test Acc: 0.561
Validation loss decreased (-0.516649 --> -0.561096).  Saving model ...
Epoch: 6 cost time: 1.6213676929473877
Epoch: 6, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.313 Vali Acc: 0.544 Test Loss: 1.313 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7950055599212646
Epoch: 7, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.146 Vali Acc: 0.633 Test Loss: 1.146 Test Acc: 0.633
Validation loss decreased (-0.561096 --> -0.633322).  Saving model ...
Epoch: 8 cost time: 1.6868972778320312
Epoch: 8, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.653494119644165
Epoch: 9, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.961 Vali Acc: 0.628 Test Loss: 0.961 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6970977783203125
Epoch: 10, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.880 Vali Acc: 0.656 Test Loss: 0.880 Test Acc: 0.656
Validation loss decreased (-0.633322 --> -0.655547).  Saving model ...
Epoch: 11 cost time: 1.5840749740600586
Epoch: 11, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.835 Vali Acc: 0.689 Test Loss: 0.835 Test Acc: 0.689
Validation loss decreased (-0.655547 --> -0.688881).  Saving model ...
Epoch: 12 cost time: 1.6020090579986572
Epoch: 12, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.787 Vali Acc: 0.717 Test Loss: 0.787 Test Acc: 0.717
Validation loss decreased (-0.688881 --> -0.716659).  Saving model ...
Epoch: 13 cost time: 1.6815922260284424
Epoch: 13, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.754 Vali Acc: 0.706 Test Loss: 0.754 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.709634780883789
Epoch: 14, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.762 Vali Acc: 0.739 Test Loss: 0.762 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738881).  Saving model ...
Epoch: 15 cost time: 1.6092710494995117
Epoch: 15, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.737 Vali Acc: 0.728 Test Loss: 0.737 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5674595832824707
Epoch: 16, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.753 Vali Acc: 0.761 Test Loss: 0.753 Test Acc: 0.761
Validation loss decreased (-0.738881 --> -0.761104).  Saving model ...
Epoch: 17 cost time: 1.6448349952697754
Epoch: 17, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.729 Vali Acc: 0.756 Test Loss: 0.729 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6075260639190674
Epoch: 18, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.742 Vali Acc: 0.756 Test Loss: 0.742 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6363270282745361
Epoch: 19, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.713 Vali Acc: 0.789 Test Loss: 0.713 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788882).  Saving model ...
Epoch: 20 cost time: 1.556948184967041
Epoch: 20, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.752 Vali Acc: 0.750 Test Loss: 0.752 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.613011121749878
Epoch: 21, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.763 Vali Acc: 0.772 Test Loss: 0.763 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.767359733581543
Epoch: 22, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.758 Vali Acc: 0.778 Test Loss: 0.758 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6605958938598633
Epoch: 23, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.760 Vali Acc: 0.772 Test Loss: 0.760 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.606696367263794
Epoch: 24, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.782 Vali Acc: 0.756 Test Loss: 0.782 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6364569664001465
Epoch: 25, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.859 Vali Acc: 0.756 Test Loss: 0.859 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7681984901428223
Epoch: 26, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.761 Vali Acc: 0.772 Test Loss: 0.761 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.58882737159729
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.918 Vali Acc: 0.739 Test Loss: 0.918 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6129786968231201
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.804 Vali Acc: 0.789 Test Loss: 0.804 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6492793560028076
Epoch: 29, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.803 Vali Acc: 0.789 Test Loss: 0.803 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 2798031
model size : 11.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.651108026504517
Epoch: 1, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.655 Vali Acc: 0.172 Test Loss: 2.655 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 3.8813374042510986
Epoch: 2, Steps: 12 | Train Loss: 2.597 Vali Loss: 2.346 Vali Acc: 0.361 Test Loss: 2.346 Test Acc: 0.361
Validation loss decreased (-0.172196 --> -0.361088).  Saving model ...
Epoch: 3 cost time: 3.9103846549987793
Epoch: 3, Steps: 12 | Train Loss: 2.186 Vali Loss: 1.981 Vali Acc: 0.483 Test Loss: 1.981 Test Acc: 0.483
Validation loss decreased (-0.361088 --> -0.483314).  Saving model ...
Epoch: 4 cost time: 3.8862876892089844
Epoch: 4, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.617 Vali Acc: 0.561 Test Loss: 1.617 Test Acc: 0.561
Validation loss decreased (-0.483314 --> -0.561095).  Saving model ...
Epoch: 5 cost time: 3.894439697265625
Epoch: 5, Steps: 12 | Train Loss: 1.379 Vali Loss: 1.345 Vali Acc: 0.600 Test Loss: 1.345 Test Acc: 0.600
Validation loss decreased (-0.561095 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 3.8691582679748535
Epoch: 6, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.142 Vali Acc: 0.606 Test Loss: 1.142 Test Acc: 0.606
Validation loss decreased (-0.599987 --> -0.605544).  Saving model ...
Epoch: 7 cost time: 3.8944342136383057
Epoch: 7, Steps: 12 | Train Loss: 0.810 Vali Loss: 1.011 Vali Acc: 0.644 Test Loss: 1.011 Test Acc: 0.644
Validation loss decreased (-0.605544 --> -0.644434).  Saving model ...
Epoch: 8 cost time: 3.885749101638794
Epoch: 8, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.913 Vali Acc: 0.667 Test Loss: 0.913 Test Acc: 0.667
Validation loss decreased (-0.644434 --> -0.666658).  Saving model ...
Epoch: 9 cost time: 3.847748041152954
Epoch: 9, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.816 Vali Acc: 0.700 Test Loss: 0.816 Test Acc: 0.700
Validation loss decreased (-0.666658 --> -0.699992).  Saving model ...
Epoch: 10 cost time: 3.9070589542388916
Epoch: 10, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.765 Vali Acc: 0.717 Test Loss: 0.765 Test Acc: 0.717
Validation loss decreased (-0.699992 --> -0.716659).  Saving model ...
Epoch: 11 cost time: 3.5794644355773926
Epoch: 11, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.729 Vali Acc: 0.706 Test Loss: 0.729 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6051056385040283
Epoch: 12, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.681 Vali Acc: 0.739 Test Loss: 0.681 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 3.61641263961792
Epoch: 13, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.681 Vali Acc: 0.778 Test Loss: 0.681 Test Acc: 0.778
Validation loss decreased (-0.738882 --> -0.777771).  Saving model ...
Epoch: 14 cost time: 3.6780595779418945
Epoch: 14, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.645 Vali Acc: 0.767 Test Loss: 0.645 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5877931118011475
Epoch: 15, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.655 Vali Acc: 0.728 Test Loss: 0.655 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.672341823577881
Epoch: 16, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.657 Vali Acc: 0.772 Test Loss: 0.657 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5584511756896973
Epoch: 17, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.641 Vali Acc: 0.772 Test Loss: 0.641 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6731436252593994
Epoch: 18, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.661 Vali Acc: 0.778 Test Loss: 0.661 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 19 cost time: 3.781238317489624
Epoch: 19, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.673 Vali Acc: 0.772 Test Loss: 0.673 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8314156532287598
Epoch: 20, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.670 Vali Acc: 0.756 Test Loss: 0.670 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.773089647293091
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.673 Vali Acc: 0.756 Test Loss: 0.673 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.8589651584625244
Epoch: 22, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.669 Vali Acc: 0.789 Test Loss: 0.669 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 23 cost time: 3.7304842472076416
Epoch: 23, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.674 Vali Acc: 0.789 Test Loss: 0.674 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.922269821166992
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.715 Vali Acc: 0.783 Test Loss: 0.715 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.7348079681396484
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.670 Vali Acc: 0.794 Test Loss: 0.670 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 26 cost time: 3.8557162284851074
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.730 Vali Acc: 0.789 Test Loss: 0.730 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.72332763671875
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.724 Vali Acc: 0.794 Test Loss: 0.724 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.8810386657714844
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.709 Vali Acc: 0.800 Test Loss: 0.709 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 29 cost time: 3.7476611137390137
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.692 Vali Acc: 0.789 Test Loss: 0.692 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.9446685314178467
Epoch: 30, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.703 Vali Acc: 0.811 Test Loss: 0.703 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 4731343
model size : 19.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7666337490081787
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.606 Vali Acc: 0.089 Test Loss: 2.606 Test Acc: 0.089
Validation loss decreased (inf --> -0.088863).  Saving model ...
Epoch: 2 cost time: 2.04262638092041
Epoch: 2, Steps: 12 | Train Loss: 2.470 Vali Loss: 2.294 Vali Acc: 0.461 Test Loss: 2.294 Test Acc: 0.461
Validation loss decreased (-0.088863 --> -0.461088).  Saving model ...
Epoch: 3 cost time: 2.1788318157196045
Epoch: 3, Steps: 12 | Train Loss: 2.098 Vali Loss: 1.960 Vali Acc: 0.544 Test Loss: 1.960 Test Acc: 0.544
Validation loss decreased (-0.461088 --> -0.544425).  Saving model ...
Epoch: 4 cost time: 2.1797406673431396
Epoch: 4, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.660 Vali Acc: 0.578 Test Loss: 1.660 Test Acc: 0.578
Validation loss decreased (-0.544425 --> -0.577761).  Saving model ...
Epoch: 5 cost time: 2.1525492668151855
Epoch: 5, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.410 Vali Acc: 0.594 Test Loss: 1.410 Test Acc: 0.594
Validation loss decreased (-0.577761 --> -0.594430).  Saving model ...
Epoch: 6 cost time: 2.0940723419189453
Epoch: 6, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.212 Vali Acc: 0.617 Test Loss: 1.212 Test Acc: 0.617
Validation loss decreased (-0.594430 --> -0.616655).  Saving model ...
Epoch: 7 cost time: 2.0393991470336914
Epoch: 7, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.052 Vali Acc: 0.650 Test Loss: 1.052 Test Acc: 0.650
Validation loss decreased (-0.616655 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 1.9890820980072021
Epoch: 8, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.946 Vali Acc: 0.678 Test Loss: 0.946 Test Acc: 0.678
Validation loss decreased (-0.649989 --> -0.677768).  Saving model ...
Epoch: 9 cost time: 2.0525364875793457
Epoch: 9, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.860 Vali Acc: 0.706 Test Loss: 0.860 Test Acc: 0.706
Validation loss decreased (-0.677768 --> -0.705547).  Saving model ...
Epoch: 10 cost time: 2.0913736820220947
Epoch: 10, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.823 Vali Acc: 0.728 Test Loss: 0.823 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727770).  Saving model ...
Epoch: 11 cost time: 1.992802381515503
Epoch: 11, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.752 Vali Acc: 0.739 Test Loss: 0.752 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738881).  Saving model ...
Epoch: 12 cost time: 2.0715014934539795
Epoch: 12, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.729 Vali Acc: 0.739 Test Loss: 0.729 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 2.0115435123443604
Epoch: 13, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.728 Vali Acc: 0.744 Test Loss: 0.728 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744437).  Saving model ...
Epoch: 14 cost time: 2.12913179397583
Epoch: 14, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.672 Vali Acc: 0.744 Test Loss: 0.672 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744438).  Saving model ...
Epoch: 15 cost time: 2.103245973587036
Epoch: 15, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.712 Vali Acc: 0.750 Test Loss: 0.712 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 1.9465737342834473
Epoch: 16, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.713 Vali Acc: 0.744 Test Loss: 0.713 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9148445129394531
Epoch: 17, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.652 Vali Acc: 0.778 Test Loss: 0.652 Test Acc: 0.778
Validation loss decreased (-0.749993 --> -0.777771).  Saving model ...
Epoch: 18 cost time: 2.0365049839019775
Epoch: 18, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.661 Vali Acc: 0.756 Test Loss: 0.661 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8560373783111572
Epoch: 19, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.672 Vali Acc: 0.772 Test Loss: 0.672 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0514485836029053
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.665 Vali Acc: 0.761 Test Loss: 0.665 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9106647968292236
Epoch: 21, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.666 Vali Acc: 0.794 Test Loss: 0.666 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794438).  Saving model ...
Epoch: 22 cost time: 2.0011088848114014
Epoch: 22, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.699 Vali Acc: 0.794 Test Loss: 0.699 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8863584995269775
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.685 Vali Acc: 0.783 Test Loss: 0.685 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0040552616119385
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.672 Vali Acc: 0.794 Test Loss: 0.672 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.943336009979248
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.708 Vali Acc: 0.794 Test Loss: 0.708 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9202818870544434
Epoch: 26, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.694 Vali Acc: 0.778 Test Loss: 0.694 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8955016136169434
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.734 Vali Acc: 0.794 Test Loss: 0.734 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.878293752670288
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.738 Vali Acc: 0.800 Test Loss: 0.738 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 29 cost time: 2.075040578842163
Epoch: 29, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.722 Vali Acc: 0.778 Test Loss: 0.722 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0803112983703613
Epoch: 30, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.741 Vali Acc: 0.794 Test Loss: 0.741 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 1421263
model size : 6.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.327521562576294
Epoch: 1, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.654 Vali Acc: 0.172 Test Loss: 2.654 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 2.7774434089660645
Epoch: 2, Steps: 12 | Train Loss: 2.597 Vali Loss: 2.345 Vali Acc: 0.361 Test Loss: 2.345 Test Acc: 0.361
Validation loss decreased (-0.172196 --> -0.361088).  Saving model ...
Epoch: 3 cost time: 2.7146284580230713
Epoch: 3, Steps: 12 | Train Loss: 2.186 Vali Loss: 1.977 Vali Acc: 0.478 Test Loss: 1.977 Test Acc: 0.478
Validation loss decreased (-0.361088 --> -0.477758).  Saving model ...
Epoch: 4 cost time: 2.633535861968994
Epoch: 4, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.613 Vali Acc: 0.567 Test Loss: 1.613 Test Acc: 0.567
Validation loss decreased (-0.477758 --> -0.566651).  Saving model ...
Epoch: 5 cost time: 2.806321144104004
Epoch: 5, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.339 Vali Acc: 0.600 Test Loss: 1.339 Test Acc: 0.600
Validation loss decreased (-0.566651 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 2.6994402408599854
Epoch: 6, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.137 Vali Acc: 0.606 Test Loss: 1.137 Test Acc: 0.606
Validation loss decreased (-0.599987 --> -0.605544).  Saving model ...
Epoch: 7 cost time: 2.6837563514709473
Epoch: 7, Steps: 12 | Train Loss: 0.818 Vali Loss: 1.009 Vali Acc: 0.644 Test Loss: 1.009 Test Acc: 0.644
Validation loss decreased (-0.605544 --> -0.644434).  Saving model ...
Epoch: 8 cost time: 2.718278408050537
Epoch: 8, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.908 Vali Acc: 0.656 Test Loss: 0.908 Test Acc: 0.656
Validation loss decreased (-0.644434 --> -0.655546).  Saving model ...
Epoch: 9 cost time: 2.749765396118164
Epoch: 9, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.815 Vali Acc: 0.678 Test Loss: 0.815 Test Acc: 0.678
Validation loss decreased (-0.655546 --> -0.677770).  Saving model ...
Epoch: 10 cost time: 2.7828335762023926
Epoch: 10, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.765 Vali Acc: 0.722 Test Loss: 0.765 Test Acc: 0.722
Validation loss decreased (-0.677770 --> -0.722215).  Saving model ...
Epoch: 11 cost time: 2.717092275619507
Epoch: 11, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.726 Vali Acc: 0.706 Test Loss: 0.726 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7804880142211914
Epoch: 12, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.678 Vali Acc: 0.739 Test Loss: 0.678 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 2.8006389141082764
Epoch: 13, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.689 Vali Acc: 0.756 Test Loss: 0.689 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 2.728620767593384
Epoch: 14, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.664 Vali Acc: 0.739 Test Loss: 0.664 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.847666025161743
Epoch: 15, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.668 Vali Acc: 0.728 Test Loss: 0.668 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9092295169830322
Epoch: 16, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.663 Vali Acc: 0.778 Test Loss: 0.663 Test Acc: 0.778
Validation loss decreased (-0.755549 --> -0.777771).  Saving model ...
Epoch: 17 cost time: 2.9027023315429688
Epoch: 17, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.629 Vali Acc: 0.783 Test Loss: 0.629 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 18 cost time: 2.9646451473236084
Epoch: 18, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.648 Vali Acc: 0.794 Test Loss: 0.648 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794438).  Saving model ...
Epoch: 19 cost time: 2.953916311264038
Epoch: 19, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.676 Vali Acc: 0.767 Test Loss: 0.676 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.993425130844116
Epoch: 20, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.633 Vali Acc: 0.794 Test Loss: 0.633 Test Acc: 0.794
Validation loss decreased (-0.794438 --> -0.794438).  Saving model ...
Epoch: 21 cost time: 2.8639678955078125
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.661 Vali Acc: 0.789 Test Loss: 0.661 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.931213140487671
Epoch: 22, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.644 Vali Acc: 0.800 Test Loss: 0.644 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 2.9903767108917236
Epoch: 23, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.645 Vali Acc: 0.806 Test Loss: 0.645 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805549).  Saving model ...
Epoch: 24 cost time: 2.7051777839660645
Epoch: 24, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.6783807277679443
Epoch: 25, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.646 Vali Acc: 0.806 Test Loss: 0.646 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.4362130165100098
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.715 Vali Acc: 0.794 Test Loss: 0.715 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4068593978881836
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.701 Vali Acc: 0.806 Test Loss: 0.701 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.4042670726776123
Epoch: 28, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.705 Vali Acc: 0.811 Test Loss: 0.705 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811104).  Saving model ...
Epoch: 29 cost time: 2.31160569190979
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.691 Vali Acc: 0.794 Test Loss: 0.691 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.414625883102417
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.684 Vali Acc: 0.817 Test Loss: 0.684 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 4731343
model size : 19.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0813302993774414
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.606 Vali Acc: 0.089 Test Loss: 2.606 Test Acc: 0.089
Validation loss decreased (inf --> -0.088863).  Saving model ...
Epoch: 2 cost time: 1.8216025829315186
Epoch: 2, Steps: 12 | Train Loss: 2.470 Vali Loss: 2.293 Vali Acc: 0.461 Test Loss: 2.293 Test Acc: 0.461
Validation loss decreased (-0.088863 --> -0.461088).  Saving model ...
Epoch: 3 cost time: 1.7149498462677002
Epoch: 3, Steps: 12 | Train Loss: 2.098 Vali Loss: 1.959 Vali Acc: 0.550 Test Loss: 1.959 Test Acc: 0.550
Validation loss decreased (-0.461088 --> -0.549980).  Saving model ...
Epoch: 4 cost time: 1.7301652431488037
Epoch: 4, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.657 Vali Acc: 0.578 Test Loss: 1.657 Test Acc: 0.578
Validation loss decreased (-0.549980 --> -0.577761).  Saving model ...
Epoch: 5 cost time: 1.7078466415405273
Epoch: 5, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.407 Vali Acc: 0.589 Test Loss: 1.407 Test Acc: 0.589
Validation loss decreased (-0.577761 --> -0.588875).  Saving model ...
Epoch: 6 cost time: 1.6502723693847656
Epoch: 6, Steps: 12 | Train Loss: 1.116 Vali Loss: 1.207 Vali Acc: 0.617 Test Loss: 1.207 Test Acc: 0.617
Validation loss decreased (-0.588875 --> -0.616655).  Saving model ...
Epoch: 7 cost time: 1.781416893005371
Epoch: 7, Steps: 12 | Train Loss: 0.889 Vali Loss: 1.050 Vali Acc: 0.661 Test Loss: 1.050 Test Acc: 0.661
Validation loss decreased (-0.616655 --> -0.661101).  Saving model ...
Epoch: 8 cost time: 1.7257111072540283
Epoch: 8, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.943 Vali Acc: 0.683 Test Loss: 0.943 Test Acc: 0.683
Validation loss decreased (-0.661101 --> -0.683324).  Saving model ...
Epoch: 9 cost time: 1.6837842464447021
Epoch: 9, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.855 Vali Acc: 0.706 Test Loss: 0.855 Test Acc: 0.706
Validation loss decreased (-0.683324 --> -0.705547).  Saving model ...
Epoch: 10 cost time: 1.7485425472259521
Epoch: 10, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.818 Vali Acc: 0.739 Test Loss: 0.818 Test Acc: 0.739
Validation loss decreased (-0.705547 --> -0.738881).  Saving model ...
Epoch: 11 cost time: 1.6961162090301514
Epoch: 11, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.748 Vali Acc: 0.744 Test Loss: 0.748 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 12 cost time: 1.6305475234985352
Epoch: 12, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.724 Vali Acc: 0.750 Test Loss: 0.724 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 1.7550468444824219
Epoch: 13, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.728 Vali Acc: 0.739 Test Loss: 0.728 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7038068771362305
Epoch: 14, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.671 Vali Acc: 0.750 Test Loss: 0.671 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 1.5631113052368164
Epoch: 15, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.707 Vali Acc: 0.744 Test Loss: 0.707 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6649494171142578
Epoch: 16, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.710 Vali Acc: 0.761 Test Loss: 0.710 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761104).  Saving model ...
Epoch: 17 cost time: 1.5271387100219727
Epoch: 17, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.650 Vali Acc: 0.778 Test Loss: 0.650 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 18 cost time: 1.7530782222747803
Epoch: 18, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.649 Vali Acc: 0.778 Test Loss: 0.649 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 19 cost time: 1.7005767822265625
Epoch: 19, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.679 Vali Acc: 0.767 Test Loss: 0.679 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6816737651824951
Epoch: 20, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.653 Vali Acc: 0.772 Test Loss: 0.653 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7567381858825684
Epoch: 21, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.666 Vali Acc: 0.800 Test Loss: 0.666 Test Acc: 0.800
Validation loss decreased (-0.777771 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 1.6822900772094727
Epoch: 22, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.685 Vali Acc: 0.789 Test Loss: 0.685 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6384539604187012
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.677 Vali Acc: 0.789 Test Loss: 0.677 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7244713306427002
Epoch: 24, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 25 cost time: 1.6467702388763428
Epoch: 25, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5753419399261475
Epoch: 26, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.686 Vali Acc: 0.789 Test Loss: 0.686 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6706814765930176
Epoch: 27, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.707 Vali Acc: 0.794 Test Loss: 0.707 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6389853954315186
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.729 Vali Acc: 0.806 Test Loss: 0.729 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805548).  Saving model ...
Epoch: 29 cost time: 1.8527984619140625
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.701 Vali Acc: 0.800 Test Loss: 0.701 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3647470474243164
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 1421263
model size : 6.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.46893048286438
Epoch: 1, Steps: 12 | Train Loss: 2.803 Vali Loss: 2.670 Vali Acc: 0.161 Test Loss: 2.670 Test Acc: 0.161
Validation loss decreased (inf --> -0.161084).  Saving model ...
Epoch: 2 cost time: 1.8311283588409424
Epoch: 2, Steps: 12 | Train Loss: 2.632 Vali Loss: 2.407 Vali Acc: 0.317 Test Loss: 2.407 Test Acc: 0.317
Validation loss decreased (-0.161084 --> -0.316643).  Saving model ...
Epoch: 3 cost time: 1.724520206451416
Epoch: 3, Steps: 12 | Train Loss: 2.283 Vali Loss: 2.109 Vali Acc: 0.439 Test Loss: 2.109 Test Acc: 0.439
Validation loss decreased (-0.316643 --> -0.438868).  Saving model ...
Epoch: 4 cost time: 1.8045423030853271
Epoch: 4, Steps: 12 | Train Loss: 1.902 Vali Loss: 1.805 Vali Acc: 0.533 Test Loss: 1.805 Test Acc: 0.533
Validation loss decreased (-0.438868 --> -0.533315).  Saving model ...
Epoch: 5 cost time: 1.7477586269378662
Epoch: 5, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.563 Vali Acc: 0.578 Test Loss: 1.563 Test Acc: 0.578
Validation loss decreased (-0.533315 --> -0.577762).  Saving model ...
Epoch: 6 cost time: 1.5977928638458252
Epoch: 6, Steps: 12 | Train Loss: 1.397 Vali Loss: 1.373 Vali Acc: 0.583 Test Loss: 1.373 Test Acc: 0.583
Validation loss decreased (-0.577762 --> -0.583320).  Saving model ...
Epoch: 7 cost time: 1.7471392154693604
Epoch: 7, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.228 Vali Acc: 0.600 Test Loss: 1.228 Test Acc: 0.600
Validation loss decreased (-0.583320 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 1.6420133113861084
Epoch: 8, Steps: 12 | Train Loss: 0.898 Vali Loss: 1.106 Vali Acc: 0.628 Test Loss: 1.106 Test Acc: 0.628
Validation loss decreased (-0.599988 --> -0.627767).  Saving model ...
Epoch: 9 cost time: 1.5116336345672607
Epoch: 9, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.996 Vali Acc: 0.656 Test Loss: 0.996 Test Acc: 0.656
Validation loss decreased (-0.627767 --> -0.655546).  Saving model ...
Epoch: 10 cost time: 1.2188823223114014
Epoch: 10, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.928 Vali Acc: 0.667 Test Loss: 0.928 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 1.2611358165740967
Epoch: 11, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.872 Vali Acc: 0.667 Test Loss: 0.872 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666658).  Saving model ...
Epoch: 12 cost time: 1.351808786392212
Epoch: 12, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.789 Vali Acc: 0.711 Test Loss: 0.789 Test Acc: 0.711
Validation loss decreased (-0.666658 --> -0.711103).  Saving model ...
Epoch: 13 cost time: 1.2463531494140625
Epoch: 13, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.793 Vali Acc: 0.700 Test Loss: 0.793 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7343151569366455
Epoch: 14, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
Validation loss decreased (-0.711103 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 1.7497026920318604
Epoch: 15, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.682 Vali Acc: 0.750 Test Loss: 0.682 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 1.6093106269836426
Epoch: 16, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.697 Vali Acc: 0.772 Test Loss: 0.697 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772215).  Saving model ...
Epoch: 17 cost time: 1.7148053646087646
Epoch: 17, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.685 Vali Acc: 0.789 Test Loss: 0.685 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 18 cost time: 1.8922553062438965
Epoch: 18, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.688 Vali Acc: 0.783 Test Loss: 0.688 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9638655185699463
Epoch: 19, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.715 Vali Acc: 0.772 Test Loss: 0.715 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.908491849899292
Epoch: 20, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.660 Vali Acc: 0.811 Test Loss: 0.660 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811105).  Saving model ...
Epoch: 21 cost time: 1.8250117301940918
Epoch: 21, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.677 Vali Acc: 0.794 Test Loss: 0.677 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.864212989807129
Epoch: 22, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.676 Vali Acc: 0.794 Test Loss: 0.676 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9159362316131592
Epoch: 23, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.664 Vali Acc: 0.811 Test Loss: 0.664 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9755282402038574
Epoch: 24, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.709 Vali Acc: 0.794 Test Loss: 0.709 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9441940784454346
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.682 Vali Acc: 0.789 Test Loss: 0.682 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8919870853424072
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.763 Vali Acc: 0.778 Test Loss: 0.763 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9435436725616455
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.764 Vali Acc: 0.756 Test Loss: 0.764 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8193364143371582
Epoch: 28, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.760 Vali Acc: 0.783 Test Loss: 0.760 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.836488962173462
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.736 Vali Acc: 0.783 Test Loss: 0.736 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7900934219360352
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.722 Vali Acc: 0.772 Test Loss: 0.722 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 4731343
model size : 19.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9489312171936035
Epoch: 1, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.618 Vali Acc: 0.083 Test Loss: 2.618 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 1.2816684246063232
Epoch: 2, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.344 Vali Acc: 0.411 Test Loss: 2.344 Test Acc: 0.411
Validation loss decreased (-0.083307 --> -0.411088).  Saving model ...
Epoch: 3 cost time: 1.25685715675354
Epoch: 3, Steps: 12 | Train Loss: 2.170 Vali Loss: 2.055 Vali Acc: 0.511 Test Loss: 2.055 Test Acc: 0.511
Validation loss decreased (-0.411088 --> -0.511091).  Saving model ...
Epoch: 4 cost time: 1.294180154800415
Epoch: 4, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.786 Vali Acc: 0.556 Test Loss: 1.786 Test Acc: 0.556
Validation loss decreased (-0.511091 --> -0.555538).  Saving model ...
Epoch: 5 cost time: 1.2602972984313965
Epoch: 5, Steps: 12 | Train Loss: 1.516 Vali Loss: 1.559 Vali Acc: 0.556 Test Loss: 1.559 Test Acc: 0.556
Validation loss decreased (-0.555538 --> -0.555540).  Saving model ...
Epoch: 6 cost time: 1.2212884426116943
Epoch: 6, Steps: 12 | Train Loss: 1.297 Vali Loss: 1.384 Vali Acc: 0.594 Test Loss: 1.384 Test Acc: 0.594
Validation loss decreased (-0.555540 --> -0.594431).  Saving model ...
Epoch: 7 cost time: 1.2356150150299072
Epoch: 7, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.237 Vali Acc: 0.633 Test Loss: 1.237 Test Acc: 0.633
Validation loss decreased (-0.594431 --> -0.633321).  Saving model ...
Epoch: 8 cost time: 1.357839822769165
Epoch: 8, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.127 Vali Acc: 0.661 Test Loss: 1.127 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661100).  Saving model ...
Epoch: 9 cost time: 1.2809724807739258
Epoch: 9, Steps: 12 | Train Loss: 0.778 Vali Loss: 1.029 Vali Acc: 0.683 Test Loss: 1.029 Test Acc: 0.683
Validation loss decreased (-0.661100 --> -0.683323).  Saving model ...
Epoch: 10 cost time: 1.3117895126342773
Epoch: 10, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.976 Vali Acc: 0.689 Test Loss: 0.976 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 11 cost time: 1.2821340560913086
Epoch: 11, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.909 Vali Acc: 0.706 Test Loss: 0.909 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705546).  Saving model ...
Epoch: 12 cost time: 1.1783397197723389
Epoch: 12, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.880 Vali Acc: 0.683 Test Loss: 0.880 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.178661823272705
Epoch: 13, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.845 Vali Acc: 0.689 Test Loss: 0.845 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2052371501922607
Epoch: 14, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.782 Vali Acc: 0.728 Test Loss: 0.782 Test Acc: 0.728
Validation loss decreased (-0.705546 --> -0.727770).  Saving model ...
Epoch: 15 cost time: 1.3471601009368896
Epoch: 15, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.795 Vali Acc: 0.728 Test Loss: 0.795 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2704904079437256
Epoch: 16, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.794 Vali Acc: 0.728 Test Loss: 0.794 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.226785659790039
Epoch: 17, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.735 Vali Acc: 0.761 Test Loss: 0.735 Test Acc: 0.761
Validation loss decreased (-0.727770 --> -0.761104).  Saving model ...
Epoch: 18 cost time: 1.2607519626617432
Epoch: 18, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.744 Vali Acc: 0.744 Test Loss: 0.744 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3661456108093262
Epoch: 19, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.755 Vali Acc: 0.778 Test Loss: 0.755 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777770).  Saving model ...
Epoch: 20 cost time: 1.3050637245178223
Epoch: 20, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.709 Vali Acc: 0.761 Test Loss: 0.709 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2465569972991943
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.685 Vali Acc: 0.806 Test Loss: 0.685 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805549).  Saving model ...
Epoch: 22 cost time: 1.3786025047302246
Epoch: 22, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.747 Vali Acc: 0.761 Test Loss: 0.747 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2758853435516357
Epoch: 23, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.728 Vali Acc: 0.806 Test Loss: 0.728 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1121807098388672
Epoch: 24, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.688 Vali Acc: 0.817 Test Loss: 0.688 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 25 cost time: 1.191678524017334
Epoch: 25, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.734 Vali Acc: 0.794 Test Loss: 0.734 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1785378456115723
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.718 Vali Acc: 0.800 Test Loss: 0.718 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.148047924041748
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.733 Vali Acc: 0.783 Test Loss: 0.733 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1644287109375
Epoch: 28, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.783 Vali Acc: 0.811 Test Loss: 0.783 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2108409404754639
Epoch: 29, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.798 Vali Acc: 0.789 Test Loss: 0.798 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1647908687591553
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.742 Vali Acc: 0.800 Test Loss: 0.742 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 1421263
model size : 6.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.611120223999023
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.676 Vali Acc: 0.144 Test Loss: 2.676 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 2.7098419666290283
Epoch: 2, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.499 Vali Acc: 0.283 Test Loss: 2.499 Test Acc: 0.283
Validation loss decreased (-0.144418 --> -0.283308).  Saving model ...
Epoch: 3 cost time: 2.5697178840637207
Epoch: 3, Steps: 12 | Train Loss: 2.399 Vali Loss: 2.262 Vali Acc: 0.417 Test Loss: 2.262 Test Acc: 0.417
Validation loss decreased (-0.283308 --> -0.416644).  Saving model ...
Epoch: 4 cost time: 2.8252975940704346
Epoch: 4, Steps: 12 | Train Loss: 2.099 Vali Loss: 1.995 Vali Acc: 0.489 Test Loss: 1.995 Test Acc: 0.489
Validation loss decreased (-0.416644 --> -0.488869).  Saving model ...
Epoch: 5 cost time: 2.9516794681549072
Epoch: 5, Steps: 12 | Train Loss: 1.836 Vali Loss: 1.744 Vali Acc: 0.517 Test Loss: 1.744 Test Acc: 0.517
Validation loss decreased (-0.488869 --> -0.516649).  Saving model ...
Epoch: 6 cost time: 2.905043840408325
Epoch: 6, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.512 Vali Acc: 0.544 Test Loss: 1.512 Test Acc: 0.544
Validation loss decreased (-0.516649 --> -0.544429).  Saving model ...
Epoch: 7 cost time: 2.902780771255493
Epoch: 7, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.315 Vali Acc: 0.589 Test Loss: 1.315 Test Acc: 0.589
Validation loss decreased (-0.544429 --> -0.588876).  Saving model ...
Epoch: 8 cost time: 2.831125497817993
Epoch: 8, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.185 Vali Acc: 0.644 Test Loss: 1.185 Test Acc: 0.644
Validation loss decreased (-0.588876 --> -0.644433).  Saving model ...
Epoch: 9 cost time: 3.0988101959228516
Epoch: 9, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.076 Vali Acc: 0.689 Test Loss: 1.076 Test Acc: 0.689
Validation loss decreased (-0.644433 --> -0.688878).  Saving model ...
Epoch: 10 cost time: 3.045100688934326
Epoch: 10, Steps: 12 | Train Loss: 0.777 Vali Loss: 1.006 Vali Acc: 0.644 Test Loss: 1.006 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0045502185821533
Epoch: 11, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.945 Vali Acc: 0.656 Test Loss: 0.945 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1188600063323975
Epoch: 12, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.874 Vali Acc: 0.667 Test Loss: 0.874 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.14711594581604
Epoch: 13, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.836 Vali Acc: 0.678 Test Loss: 0.836 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.048154354095459
Epoch: 14, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.786 Vali Acc: 0.700 Test Loss: 0.786 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699992).  Saving model ...
Epoch: 15 cost time: 3.0191962718963623
Epoch: 15, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.761 Vali Acc: 0.717 Test Loss: 0.761 Test Acc: 0.717
Validation loss decreased (-0.699992 --> -0.716659).  Saving model ...
Epoch: 16 cost time: 3.0245773792266846
Epoch: 16, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.777 Vali Acc: 0.689 Test Loss: 0.777 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9182097911834717
Epoch: 17, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.749 Vali Acc: 0.683 Test Loss: 0.749 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3189992904663086
Epoch: 18, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.691 Vali Acc: 0.706 Test Loss: 0.691 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.2969472408294678
Epoch: 19, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.662 Vali Acc: 0.744 Test Loss: 0.662 Test Acc: 0.744
Validation loss decreased (-0.716659 --> -0.744438).  Saving model ...
Epoch: 20 cost time: 3.086095094680786
Epoch: 20, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.675 Vali Acc: 0.722 Test Loss: 0.675 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.180934190750122
Epoch: 21, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.659 Vali Acc: 0.733 Test Loss: 0.659 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.144491672515869
Epoch: 22, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.650 Vali Acc: 0.767 Test Loss: 0.650 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766660).  Saving model ...
Epoch: 23 cost time: 3.123613119125366
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.650 Vali Acc: 0.767 Test Loss: 0.650 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1354918479919434
Epoch: 24, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.657 Vali Acc: 0.767 Test Loss: 0.657 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.121105670928955
Epoch: 25, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.666 Vali Acc: 0.733 Test Loss: 0.666 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.175489664077759
Epoch: 26, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.668 Vali Acc: 0.772 Test Loss: 0.668 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 27 cost time: 3.152484178543091
Epoch: 27, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.693 Vali Acc: 0.772 Test Loss: 0.693 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.763932228088379
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.663 Vali Acc: 0.783 Test Loss: 0.663 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783327).  Saving model ...
Epoch: 29 cost time: 2.6467576026916504
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.692 Vali Acc: 0.789 Test Loss: 0.692 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788882).  Saving model ...
Epoch: 30 cost time: 2.5071754455566406
Epoch: 30, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.716 Vali Acc: 0.772 Test Loss: 0.716 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 4709743
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.50666880607605
Epoch: 1, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.664 Vali Acc: 0.083 Test Loss: 2.664 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 1.8726067543029785
Epoch: 2, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.458 Vali Acc: 0.244 Test Loss: 2.458 Test Acc: 0.244
Validation loss decreased (-0.083307 --> -0.244420).  Saving model ...
Epoch: 3 cost time: 1.884380578994751
Epoch: 3, Steps: 12 | Train Loss: 2.308 Vali Loss: 2.209 Vali Acc: 0.406 Test Loss: 2.209 Test Acc: 0.406
Validation loss decreased (-0.244420 --> -0.405533).  Saving model ...
Epoch: 4 cost time: 1.9668512344360352
Epoch: 4, Steps: 12 | Train Loss: 2.018 Vali Loss: 1.940 Vali Acc: 0.539 Test Loss: 1.940 Test Acc: 0.539
Validation loss decreased (-0.405533 --> -0.538869).  Saving model ...
Epoch: 5 cost time: 1.8556616306304932
Epoch: 5, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.705 Vali Acc: 0.539 Test Loss: 1.705 Test Acc: 0.539
Validation loss decreased (-0.538869 --> -0.538872).  Saving model ...
Epoch: 6 cost time: 1.939532995223999
Epoch: 6, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.513 Vali Acc: 0.578 Test Loss: 1.513 Test Acc: 0.578
Validation loss decreased (-0.538872 --> -0.577763).  Saving model ...
Epoch: 7 cost time: 1.7480478286743164
Epoch: 7, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.350 Vali Acc: 0.583 Test Loss: 1.350 Test Acc: 0.583
Validation loss decreased (-0.577763 --> -0.583320).  Saving model ...
Epoch: 8 cost time: 2.035759925842285
Epoch: 8, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.210 Vali Acc: 0.611 Test Loss: 1.210 Test Acc: 0.611
Validation loss decreased (-0.583320 --> -0.611099).  Saving model ...
Epoch: 9 cost time: 1.9919075965881348
Epoch: 9, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.108 Vali Acc: 0.622 Test Loss: 1.108 Test Acc: 0.622
Validation loss decreased (-0.611099 --> -0.622211).  Saving model ...
Epoch: 10 cost time: 2.0666322708129883
Epoch: 10, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.016 Vali Acc: 0.639 Test Loss: 1.016 Test Acc: 0.639
Validation loss decreased (-0.622211 --> -0.638879).  Saving model ...
Epoch: 11 cost time: 2.032463312149048
Epoch: 11, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.938 Vali Acc: 0.689 Test Loss: 0.938 Test Acc: 0.689
Validation loss decreased (-0.638879 --> -0.688880).  Saving model ...
Epoch: 12 cost time: 1.9406688213348389
Epoch: 12, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.880 Vali Acc: 0.700 Test Loss: 0.880 Test Acc: 0.700
Validation loss decreased (-0.688880 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 1.9243149757385254
Epoch: 13, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.841 Vali Acc: 0.711 Test Loss: 0.841 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711103).  Saving model ...
Epoch: 14 cost time: 1.9568982124328613
Epoch: 14, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.784 Vali Acc: 0.711 Test Loss: 0.784 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711103).  Saving model ...
Epoch: 15 cost time: 1.9178977012634277
Epoch: 15, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.760 Vali Acc: 0.744 Test Loss: 0.760 Test Acc: 0.744
Validation loss decreased (-0.711103 --> -0.744437).  Saving model ...
Epoch: 16 cost time: 1.9284954071044922
Epoch: 16, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.741 Vali Acc: 0.733 Test Loss: 0.741 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.959691047668457
Epoch: 17, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.706 Vali Acc: 0.750 Test Loss: 0.706 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 18 cost time: 1.912778377532959
Epoch: 18, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.701 Vali Acc: 0.744 Test Loss: 0.701 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9445774555206299
Epoch: 19, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.693 Vali Acc: 0.733 Test Loss: 0.693 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.896200180053711
Epoch: 20, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.698 Vali Acc: 0.739 Test Loss: 0.698 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9244046211242676
Epoch: 21, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.678 Vali Acc: 0.767 Test Loss: 0.678 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
Epoch: 22 cost time: 1.948692798614502
Epoch: 22, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.674 Vali Acc: 0.767 Test Loss: 0.674 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 23 cost time: 1.9552841186523438
Epoch: 23, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.663 Vali Acc: 0.761 Test Loss: 0.663 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9000356197357178
Epoch: 24, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.655 Vali Acc: 0.789 Test Loss: 0.655 Test Acc: 0.789
Validation loss decreased (-0.766660 --> -0.788882).  Saving model ...
Epoch: 25 cost time: 1.9675631523132324
Epoch: 25, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.644 Vali Acc: 0.800 Test Loss: 0.644 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 26 cost time: 1.9209015369415283
Epoch: 26, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.677 Vali Acc: 0.783 Test Loss: 0.677 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1010615825653076
Epoch: 27, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0275299549102783
Epoch: 28, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.677 Vali Acc: 0.800 Test Loss: 0.677 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.15698504447937
Epoch: 29, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.654 Vali Acc: 0.789 Test Loss: 0.654 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0195188522338867
Epoch: 30, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.679 Vali Acc: 0.783 Test Loss: 0.679 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 1399535
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.605712890625
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.676 Vali Acc: 0.144 Test Loss: 2.676 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 2.7323009967803955
Epoch: 2, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.498 Vali Acc: 0.283 Test Loss: 2.498 Test Acc: 0.283
Validation loss decreased (-0.144418 --> -0.283308).  Saving model ...
Epoch: 3 cost time: 2.7026236057281494
Epoch: 3, Steps: 12 | Train Loss: 2.402 Vali Loss: 2.261 Vali Acc: 0.417 Test Loss: 2.261 Test Acc: 0.417
Validation loss decreased (-0.283308 --> -0.416644).  Saving model ...
Epoch: 4 cost time: 2.794093370437622
Epoch: 4, Steps: 12 | Train Loss: 2.100 Vali Loss: 1.993 Vali Acc: 0.489 Test Loss: 1.993 Test Acc: 0.489
Validation loss decreased (-0.416644 --> -0.488869).  Saving model ...
Epoch: 5 cost time: 2.7426576614379883
Epoch: 5, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.743 Vali Acc: 0.517 Test Loss: 1.743 Test Acc: 0.517
Validation loss decreased (-0.488869 --> -0.516649).  Saving model ...
Epoch: 6 cost time: 2.72709059715271
Epoch: 6, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.511 Vali Acc: 0.544 Test Loss: 1.511 Test Acc: 0.544
Validation loss decreased (-0.516649 --> -0.544429).  Saving model ...
Epoch: 7 cost time: 2.8174071311950684
Epoch: 7, Steps: 12 | Train Loss: 1.328 Vali Loss: 1.315 Vali Acc: 0.583 Test Loss: 1.315 Test Acc: 0.583
Validation loss decreased (-0.544429 --> -0.583320).  Saving model ...
Epoch: 8 cost time: 2.7347571849823
Epoch: 8, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.186 Vali Acc: 0.644 Test Loss: 1.186 Test Acc: 0.644
Validation loss decreased (-0.583320 --> -0.644433).  Saving model ...
Epoch: 9 cost time: 2.482250213623047
Epoch: 9, Steps: 12 | Train Loss: 0.920 Vali Loss: 1.079 Vali Acc: 0.683 Test Loss: 1.079 Test Acc: 0.683
Validation loss decreased (-0.644433 --> -0.683323).  Saving model ...
Epoch: 10 cost time: 2.274601459503174
Epoch: 10, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.998 Vali Acc: 0.656 Test Loss: 0.998 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3548545837402344
Epoch: 11, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.933 Vali Acc: 0.672 Test Loss: 0.933 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.457155704498291
Epoch: 12, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.876 Vali Acc: 0.650 Test Loss: 0.876 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.389798641204834
Epoch: 13, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.823 Vali Acc: 0.683 Test Loss: 0.823 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683325).  Saving model ...
Epoch: 14 cost time: 2.0381968021392822
Epoch: 14, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.776 Vali Acc: 0.711 Test Loss: 0.776 Test Acc: 0.711
Validation loss decreased (-0.683325 --> -0.711103).  Saving model ...
Epoch: 15 cost time: 2.4080121517181396
Epoch: 15, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.745 Vali Acc: 0.711 Test Loss: 0.745 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711104).  Saving model ...
Epoch: 16 cost time: 2.29030704498291
Epoch: 16, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.769 Vali Acc: 0.683 Test Loss: 0.769 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3800103664398193
Epoch: 17, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.741 Vali Acc: 0.711 Test Loss: 0.741 Test Acc: 0.711
Validation loss decreased (-0.711104 --> -0.711104).  Saving model ...
Epoch: 18 cost time: 2.39294695854187
Epoch: 18, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
Validation loss decreased (-0.711104 --> -0.716660).  Saving model ...
Epoch: 19 cost time: 1.9747626781463623
Epoch: 19, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.653 Vali Acc: 0.733 Test Loss: 0.653 Test Acc: 0.733
Validation loss decreased (-0.716660 --> -0.733327).  Saving model ...
Epoch: 20 cost time: 2.581341028213501
Epoch: 20, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.665 Vali Acc: 0.717 Test Loss: 0.665 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.675361156463623
Epoch: 21, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.653 Vali Acc: 0.728 Test Loss: 0.653 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6591758728027344
Epoch: 22, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.649 Vali Acc: 0.767 Test Loss: 0.649 Test Acc: 0.767
Validation loss decreased (-0.733327 --> -0.766660).  Saving model ...
Epoch: 23 cost time: 2.6805953979492188
Epoch: 23, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.638 Vali Acc: 0.761 Test Loss: 0.638 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5763745307922363
Epoch: 24, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.638 Vali Acc: 0.767 Test Loss: 0.638 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 25 cost time: 2.6335344314575195
Epoch: 25, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.655 Vali Acc: 0.756 Test Loss: 0.655 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.753638744354248
Epoch: 26, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.654 Vali Acc: 0.778 Test Loss: 0.654 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 27 cost time: 2.7767345905303955
Epoch: 27, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.668 Vali Acc: 0.772 Test Loss: 0.668 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.640834093093872
Epoch: 28, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.660 Vali Acc: 0.778 Test Loss: 0.660 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.653918504714966
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.661 Vali Acc: 0.789 Test Loss: 0.661 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 30 cost time: 2.6078531742095947
Epoch: 30, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 4709743
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.314190149307251
Epoch: 1, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.664 Vali Acc: 0.083 Test Loss: 2.664 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 1.6224825382232666
Epoch: 2, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.458 Vali Acc: 0.244 Test Loss: 2.458 Test Acc: 0.244
Validation loss decreased (-0.083307 --> -0.244420).  Saving model ...
Epoch: 3 cost time: 1.6606957912445068
Epoch: 3, Steps: 12 | Train Loss: 2.309 Vali Loss: 2.209 Vali Acc: 0.406 Test Loss: 2.209 Test Acc: 0.406
Validation loss decreased (-0.244420 --> -0.405533).  Saving model ...
Epoch: 4 cost time: 1.652815818786621
Epoch: 4, Steps: 12 | Train Loss: 2.019 Vali Loss: 1.940 Vali Acc: 0.539 Test Loss: 1.940 Test Acc: 0.539
Validation loss decreased (-0.405533 --> -0.538869).  Saving model ...
Epoch: 5 cost time: 1.7014427185058594
Epoch: 5, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.704 Vali Acc: 0.539 Test Loss: 1.704 Test Acc: 0.539
Validation loss decreased (-0.538869 --> -0.538872).  Saving model ...
Epoch: 6 cost time: 1.6642553806304932
Epoch: 6, Steps: 12 | Train Loss: 1.459 Vali Loss: 1.510 Vali Acc: 0.578 Test Loss: 1.510 Test Acc: 0.578
Validation loss decreased (-0.538872 --> -0.577763).  Saving model ...
Epoch: 7 cost time: 1.6587932109832764
Epoch: 7, Steps: 12 | Train Loss: 1.271 Vali Loss: 1.346 Vali Acc: 0.589 Test Loss: 1.346 Test Acc: 0.589
Validation loss decreased (-0.577763 --> -0.588875).  Saving model ...
Epoch: 8 cost time: 1.695188283920288
Epoch: 8, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.206 Vali Acc: 0.617 Test Loss: 1.206 Test Acc: 0.617
Validation loss decreased (-0.588875 --> -0.616655).  Saving model ...
Epoch: 9 cost time: 1.6936190128326416
Epoch: 9, Steps: 12 | Train Loss: 0.990 Vali Loss: 1.104 Vali Acc: 0.628 Test Loss: 1.104 Test Acc: 0.628
Validation loss decreased (-0.616655 --> -0.627767).  Saving model ...
Epoch: 10 cost time: 1.6586201190948486
Epoch: 10, Steps: 12 | Train Loss: 0.848 Vali Loss: 1.011 Vali Acc: 0.644 Test Loss: 1.011 Test Acc: 0.644
Validation loss decreased (-0.627767 --> -0.644434).  Saving model ...
Epoch: 11 cost time: 1.7267029285430908
Epoch: 11, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.935 Vali Acc: 0.683 Test Loss: 0.935 Test Acc: 0.683
Validation loss decreased (-0.644434 --> -0.683324).  Saving model ...
Epoch: 12 cost time: 1.6438450813293457
Epoch: 12, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.876 Vali Acc: 0.711 Test Loss: 0.876 Test Acc: 0.711
Validation loss decreased (-0.683324 --> -0.711102).  Saving model ...
Epoch: 13 cost time: 1.696882724761963
Epoch: 13, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.835 Vali Acc: 0.711 Test Loss: 0.835 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711103).  Saving model ...
Epoch: 14 cost time: 1.6535608768463135
Epoch: 14, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.786 Vali Acc: 0.711 Test Loss: 0.786 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711103).  Saving model ...
Epoch: 15 cost time: 1.5877273082733154
Epoch: 15, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.772 Vali Acc: 0.739 Test Loss: 0.772 Test Acc: 0.739
Validation loss decreased (-0.711103 --> -0.738881).  Saving model ...
Epoch: 16 cost time: 1.8414256572723389
Epoch: 16, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.752 Vali Acc: 0.722 Test Loss: 0.752 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7345235347747803
Epoch: 17, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.715 Vali Acc: 0.744 Test Loss: 0.715 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 18 cost time: 1.7656011581420898
Epoch: 18, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.713 Vali Acc: 0.739 Test Loss: 0.713 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7360241413116455
Epoch: 19, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.710 Vali Acc: 0.722 Test Loss: 0.710 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7528276443481445
Epoch: 20, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.702 Vali Acc: 0.739 Test Loss: 0.702 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6864142417907715
Epoch: 21, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.654 Vali Acc: 0.767 Test Loss: 0.654 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766660).  Saving model ...
Epoch: 22 cost time: 1.5861387252807617
Epoch: 22, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.663 Vali Acc: 0.772 Test Loss: 0.663 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 23 cost time: 1.592400312423706
Epoch: 23, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.661 Vali Acc: 0.772 Test Loss: 0.661 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772216).  Saving model ...
Epoch: 24 cost time: 1.6783947944641113
Epoch: 24, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.641 Vali Acc: 0.789 Test Loss: 0.641 Test Acc: 0.789
Validation loss decreased (-0.772216 --> -0.788882).  Saving model ...
Epoch: 25 cost time: 1.5934019088745117
Epoch: 25, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.627 Vali Acc: 0.794 Test Loss: 0.627 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 26 cost time: 1.6221797466278076
Epoch: 26, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.646 Vali Acc: 0.778 Test Loss: 0.646 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5524733066558838
Epoch: 27, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.632 Vali Acc: 0.794 Test Loss: 0.632 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6395413875579834
Epoch: 28, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.665 Vali Acc: 0.789 Test Loss: 0.665 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6788280010223389
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.630 Vali Acc: 0.778 Test Loss: 0.630 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.566478967666626
Epoch: 30, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.648 Vali Acc: 0.789 Test Loss: 0.648 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 1399535
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.514383554458618
Epoch: 1, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.688 Vali Acc: 0.144 Test Loss: 2.688 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 1.742711067199707
Epoch: 2, Steps: 12 | Train Loss: 2.645 Vali Loss: 2.541 Vali Acc: 0.217 Test Loss: 2.541 Test Acc: 0.217
Validation loss decreased (-0.144418 --> -0.216641).  Saving model ...
Epoch: 3 cost time: 1.7201769351959229
Epoch: 3, Steps: 12 | Train Loss: 2.480 Vali Loss: 2.357 Vali Acc: 0.356 Test Loss: 2.357 Test Acc: 0.356
Validation loss decreased (-0.216641 --> -0.355532).  Saving model ...
Epoch: 4 cost time: 1.9977989196777344
Epoch: 4, Steps: 12 | Train Loss: 2.236 Vali Loss: 2.152 Vali Acc: 0.444 Test Loss: 2.152 Test Acc: 0.444
Validation loss decreased (-0.355532 --> -0.444423).  Saving model ...
Epoch: 5 cost time: 1.868812084197998
Epoch: 5, Steps: 12 | Train Loss: 2.033 Vali Loss: 1.959 Vali Acc: 0.494 Test Loss: 1.959 Test Acc: 0.494
Validation loss decreased (-0.444423 --> -0.494425).  Saving model ...
Epoch: 6 cost time: 1.889425277709961
Epoch: 6, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.765 Vali Acc: 0.544 Test Loss: 1.765 Test Acc: 0.544
Validation loss decreased (-0.494425 --> -0.544427).  Saving model ...
Epoch: 7 cost time: 1.9828898906707764
Epoch: 7, Steps: 12 | Train Loss: 1.599 Vali Loss: 1.578 Vali Acc: 0.550 Test Loss: 1.578 Test Acc: 0.550
Validation loss decreased (-0.544427 --> -0.549984).  Saving model ...
Epoch: 8 cost time: 2.0285730361938477
Epoch: 8, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.428 Vali Acc: 0.594 Test Loss: 1.428 Test Acc: 0.594
Validation loss decreased (-0.549984 --> -0.594430).  Saving model ...
Epoch: 9 cost time: 1.9646615982055664
Epoch: 9, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.305 Vali Acc: 0.583 Test Loss: 1.305 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9009006023406982
Epoch: 10, Steps: 12 | Train Loss: 1.019 Vali Loss: 1.208 Vali Acc: 0.617 Test Loss: 1.208 Test Acc: 0.617
Validation loss decreased (-0.594430 --> -0.616655).  Saving model ...
Epoch: 11 cost time: 1.9874744415283203
Epoch: 11, Steps: 12 | Train Loss: 0.926 Vali Loss: 1.118 Vali Acc: 0.633 Test Loss: 1.118 Test Acc: 0.633
Validation loss decreased (-0.616655 --> -0.633322).  Saving model ...
Epoch: 12 cost time: 2.080824375152588
Epoch: 12, Steps: 12 | Train Loss: 0.854 Vali Loss: 1.018 Vali Acc: 0.650 Test Loss: 1.018 Test Acc: 0.650
Validation loss decreased (-0.633322 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 1.954941987991333
Epoch: 13, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.962 Vali Acc: 0.683 Test Loss: 0.962 Test Acc: 0.683
Validation loss decreased (-0.649990 --> -0.683324).  Saving model ...
Epoch: 14 cost time: 2.047278642654419
Epoch: 14, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.900 Vali Acc: 0.700 Test Loss: 0.900 Test Acc: 0.700
Validation loss decreased (-0.683324 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 2.060122013092041
Epoch: 15, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.875 Vali Acc: 0.678 Test Loss: 0.875 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.04520845413208
Epoch: 16, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.856 Vali Acc: 0.683 Test Loss: 0.856 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0095584392547607
Epoch: 17, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.849 Vali Acc: 0.711 Test Loss: 0.849 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711103).  Saving model ...
Epoch: 18 cost time: 2.0712780952453613
Epoch: 18, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.784 Vali Acc: 0.700 Test Loss: 0.784 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8740935325622559
Epoch: 19, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.731 Vali Acc: 0.739 Test Loss: 0.731 Test Acc: 0.739
Validation loss decreased (-0.711103 --> -0.738882).  Saving model ...
Epoch: 20 cost time: 1.899371862411499
Epoch: 20, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.749 Vali Acc: 0.722 Test Loss: 0.749 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9488332271575928
Epoch: 21, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.720 Vali Acc: 0.728 Test Loss: 0.720 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8693041801452637
Epoch: 22, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.719 Vali Acc: 0.733 Test Loss: 0.719 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9259045124053955
Epoch: 23, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.736 Vali Acc: 0.717 Test Loss: 0.736 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8952772617340088
Epoch: 24, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.739 Vali Acc: 0.706 Test Loss: 0.739 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8458642959594727
Epoch: 25, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.724 Vali Acc: 0.711 Test Loss: 0.724 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8982057571411133
Epoch: 26, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.734 Vali Acc: 0.728 Test Loss: 0.734 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8210453987121582
Epoch: 27, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.702 Vali Acc: 0.739 Test Loss: 0.702 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738882).  Saving model ...
Epoch: 28 cost time: 1.6929519176483154
Epoch: 28, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.674 Vali Acc: 0.756 Test Loss: 0.674 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 29 cost time: 1.6877329349517822
Epoch: 29, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.638 Vali Acc: 0.811 Test Loss: 0.638 Test Acc: 0.811
Validation loss decreased (-0.755549 --> -0.811105).  Saving model ...
Epoch: 30 cost time: 1.7188384532928467
Epoch: 30, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.664 Vali Acc: 0.761 Test Loss: 0.664 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 4709743
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.675710439682007
Epoch: 1, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.677 Vali Acc: 0.072 Test Loss: 2.677 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 1.3026177883148193
Epoch: 2, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.507 Vali Acc: 0.172 Test Loss: 2.507 Test Acc: 0.172
Validation loss decreased (-0.072195 --> -0.172197).  Saving model ...
Epoch: 3 cost time: 1.3434560298919678
Epoch: 3, Steps: 12 | Train Loss: 2.385 Vali Loss: 2.306 Vali Acc: 0.339 Test Loss: 2.306 Test Acc: 0.339
Validation loss decreased (-0.172197 --> -0.338866).  Saving model ...
Epoch: 4 cost time: 1.1579432487487793
Epoch: 4, Steps: 12 | Train Loss: 2.150 Vali Loss: 2.083 Vali Acc: 0.494 Test Loss: 2.083 Test Acc: 0.494
Validation loss decreased (-0.338866 --> -0.494424).  Saving model ...
Epoch: 5 cost time: 1.1474523544311523
Epoch: 5, Steps: 12 | Train Loss: 1.948 Vali Loss: 1.885 Vali Acc: 0.550 Test Loss: 1.885 Test Acc: 0.550
Validation loss decreased (-0.494424 --> -0.549981).  Saving model ...
Epoch: 6 cost time: 1.2613449096679688
Epoch: 6, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.705 Vali Acc: 0.561 Test Loss: 1.705 Test Acc: 0.561
Validation loss decreased (-0.549981 --> -0.561094).  Saving model ...
Epoch: 7 cost time: 1.2350330352783203
Epoch: 7, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.549 Vali Acc: 0.561 Test Loss: 1.549 Test Acc: 0.561
Validation loss decreased (-0.561094 --> -0.561096).  Saving model ...
Epoch: 8 cost time: 1.2174062728881836
Epoch: 8, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.415 Vali Acc: 0.594 Test Loss: 1.415 Test Acc: 0.594
Validation loss decreased (-0.561096 --> -0.594430).  Saving model ...
Epoch: 9 cost time: 1.2981057167053223
Epoch: 9, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.311 Vali Acc: 0.600 Test Loss: 1.311 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599987).  Saving model ...
Epoch: 10 cost time: 1.2797436714172363
Epoch: 10, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.219 Vali Acc: 0.600 Test Loss: 1.219 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 1.1821489334106445
Epoch: 11, Steps: 12 | Train Loss: 0.962 Vali Loss: 1.128 Vali Acc: 0.617 Test Loss: 1.128 Test Acc: 0.617
Validation loss decreased (-0.599988 --> -0.616655).  Saving model ...
Epoch: 12 cost time: 1.3429012298583984
Epoch: 12, Steps: 12 | Train Loss: 0.796 Vali Loss: 1.048 Vali Acc: 0.633 Test Loss: 1.048 Test Acc: 0.633
Validation loss decreased (-0.616655 --> -0.633323).  Saving model ...
Epoch: 13 cost time: 1.3089334964752197
Epoch: 13, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.992 Vali Acc: 0.661 Test Loss: 0.992 Test Acc: 0.661
Validation loss decreased (-0.633323 --> -0.661101).  Saving model ...
Epoch: 14 cost time: 1.3228416442871094
Epoch: 14, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.952 Vali Acc: 0.683 Test Loss: 0.952 Test Acc: 0.683
Validation loss decreased (-0.661101 --> -0.683324).  Saving model ...
Epoch: 15 cost time: 1.3396944999694824
Epoch: 15, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.908 Vali Acc: 0.689 Test Loss: 0.908 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688880).  Saving model ...
Epoch: 16 cost time: 1.2559101581573486
Epoch: 16, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.881 Vali Acc: 0.667 Test Loss: 0.881 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2801904678344727
Epoch: 17, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.843 Vali Acc: 0.689 Test Loss: 0.843 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688880).  Saving model ...
Epoch: 18 cost time: 1.220414400100708
Epoch: 18, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.815 Vali Acc: 0.711 Test Loss: 0.815 Test Acc: 0.711
Validation loss decreased (-0.688880 --> -0.711103).  Saving model ...
Epoch: 19 cost time: 1.4785327911376953
Epoch: 19, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.802 Vali Acc: 0.706 Test Loss: 0.802 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.410630464553833
Epoch: 20, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.797 Vali Acc: 0.717 Test Loss: 0.797 Test Acc: 0.717
Validation loss decreased (-0.711103 --> -0.716659).  Saving model ...
Epoch: 21 cost time: 1.383089542388916
Epoch: 21, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.749 Vali Acc: 0.739 Test Loss: 0.749 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738881).  Saving model ...
Epoch: 22 cost time: 1.4693620204925537
Epoch: 22, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.778 Vali Acc: 0.733 Test Loss: 0.778 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.436145305633545
Epoch: 23, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.761 Vali Acc: 0.756 Test Loss: 0.761 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755548).  Saving model ...
Epoch: 24 cost time: 1.4513845443725586
Epoch: 24, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.742 Vali Acc: 0.761 Test Loss: 0.742 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 25 cost time: 1.3368284702301025
Epoch: 25, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.730 Vali Acc: 0.783 Test Loss: 0.730 Test Acc: 0.783
Validation loss decreased (-0.761104 --> -0.783326).  Saving model ...
Epoch: 26 cost time: 1.3732314109802246
Epoch: 26, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.750 Vali Acc: 0.778 Test Loss: 0.750 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3098344802856445
Epoch: 27, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.716 Vali Acc: 0.772 Test Loss: 0.716 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3263342380523682
Epoch: 28, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.711 Vali Acc: 0.783 Test Loss: 0.711 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 29 cost time: 1.3923840522766113
Epoch: 29, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.716 Vali Acc: 0.756 Test Loss: 0.716 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3503997325897217
Epoch: 30, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.735 Vali Acc: 0.778 Test Loss: 0.735 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 1399535
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.158416748046875
Epoch: 1, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.702 Vali Acc: 0.056 Test Loss: 2.702 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 2.369274377822876
Epoch: 2, Steps: 12 | Train Loss: 2.587 Vali Loss: 2.527 Vali Acc: 0.222 Test Loss: 2.527 Test Acc: 0.222
Validation loss decreased (-0.055529 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 2.443018913269043
Epoch: 3, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.306 Vali Acc: 0.378 Test Loss: 2.306 Test Acc: 0.378
Validation loss decreased (-0.222197 --> -0.377755).  Saving model ...
Epoch: 4 cost time: 2.4454805850982666
Epoch: 4, Steps: 12 | Train Loss: 2.116 Vali Loss: 2.053 Vali Acc: 0.489 Test Loss: 2.053 Test Acc: 0.489
Validation loss decreased (-0.377755 --> -0.488868).  Saving model ...
Epoch: 5 cost time: 2.3980321884155273
Epoch: 5, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.801 Vali Acc: 0.522 Test Loss: 1.801 Test Acc: 0.522
Validation loss decreased (-0.488868 --> -0.522204).  Saving model ...
Epoch: 6 cost time: 2.4506351947784424
Epoch: 6, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.579 Vali Acc: 0.556 Test Loss: 1.579 Test Acc: 0.556
Validation loss decreased (-0.522204 --> -0.555540).  Saving model ...
Epoch: 7 cost time: 2.523423194885254
Epoch: 7, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.408 Vali Acc: 0.561 Test Loss: 1.408 Test Acc: 0.561
Validation loss decreased (-0.555540 --> -0.561097).  Saving model ...
Epoch: 8 cost time: 2.539210081100464
Epoch: 8, Steps: 12 | Train Loss: 1.167 Vali Loss: 1.257 Vali Acc: 0.650 Test Loss: 1.257 Test Acc: 0.650
Validation loss decreased (-0.561097 --> -0.649987).  Saving model ...
Epoch: 9 cost time: 2.6060054302215576
Epoch: 9, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.164 Vali Acc: 0.622 Test Loss: 1.164 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.514798879623413
Epoch: 10, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.060 Vali Acc: 0.661 Test Loss: 1.060 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661101).  Saving model ...
Epoch: 11 cost time: 2.5522382259368896
Epoch: 11, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.973 Vali Acc: 0.661 Test Loss: 0.973 Test Acc: 0.661
Validation loss decreased (-0.661101 --> -0.661101).  Saving model ...
Epoch: 12 cost time: 2.4880549907684326
Epoch: 12, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.894 Vali Acc: 0.689 Test Loss: 0.894 Test Acc: 0.689
Validation loss decreased (-0.661101 --> -0.688880).  Saving model ...
Epoch: 13 cost time: 2.6157307624816895
Epoch: 13, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.821 Vali Acc: 0.683 Test Loss: 0.821 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.430104970932007
Epoch: 14, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.780 Vali Acc: 0.728 Test Loss: 0.780 Test Acc: 0.728
Validation loss decreased (-0.688880 --> -0.727770).  Saving model ...
Epoch: 15 cost time: 2.6695239543914795
Epoch: 15, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.753 Vali Acc: 0.717 Test Loss: 0.753 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.560931921005249
Epoch: 16, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.715 Vali Acc: 0.744 Test Loss: 0.715 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744437).  Saving model ...
Epoch: 17 cost time: 2.457357406616211
Epoch: 17, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.679 Vali Acc: 0.772 Test Loss: 0.679 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772215).  Saving model ...
Epoch: 18 cost time: 2.255190372467041
Epoch: 18, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.628 Vali Acc: 0.778 Test Loss: 0.628 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777772).  Saving model ...
Epoch: 19 cost time: 2.178957462310791
Epoch: 19, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788882).  Saving model ...
Epoch: 20 cost time: 2.208207368850708
Epoch: 20, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.621 Vali Acc: 0.778 Test Loss: 0.621 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1270735263824463
Epoch: 21, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.631 Vali Acc: 0.789 Test Loss: 0.631 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788883).  Saving model ...
Epoch: 22 cost time: 2.257964611053467
Epoch: 22, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.605 Vali Acc: 0.806 Test Loss: 0.605 Test Acc: 0.806
Validation loss decreased (-0.788883 --> -0.805550).  Saving model ...
Epoch: 23 cost time: 1.7822868824005127
Epoch: 23, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.631 Vali Acc: 0.794 Test Loss: 0.631 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8667664527893066
Epoch: 24, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.613 Vali Acc: 0.794 Test Loss: 0.613 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.003411293029785
Epoch: 25, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.600 Vali Acc: 0.806 Test Loss: 0.600 Test Acc: 0.806
Validation loss decreased (-0.805550 --> -0.805550).  Saving model ...
Epoch: 26 cost time: 1.971142292022705
Epoch: 26, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.614 Vali Acc: 0.800 Test Loss: 0.614 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1095058917999268
Epoch: 27, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.605 Vali Acc: 0.794 Test Loss: 0.605 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.997847557067871
Epoch: 28, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.604 Vali Acc: 0.800 Test Loss: 0.604 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.3533616065979004
Epoch: 29, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.577 Vali Acc: 0.817 Test Loss: 0.577 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816661).  Saving model ...
Epoch: 30 cost time: 2.402341365814209
Epoch: 30, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.629 Vali Acc: 0.811 Test Loss: 0.629 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 2366063
model size : 9.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.427694797515869
Epoch: 1, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.605 Vali Acc: 0.167 Test Loss: 2.605 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 1.6706743240356445
Epoch: 2, Steps: 12 | Train Loss: 2.617 Vali Loss: 2.459 Vali Acc: 0.294 Test Loss: 2.459 Test Acc: 0.294
Validation loss decreased (-0.166641 --> -0.294420).  Saving model ...
Epoch: 3 cost time: 1.7053892612457275
Epoch: 3, Steps: 12 | Train Loss: 2.379 Vali Loss: 2.272 Vali Acc: 0.356 Test Loss: 2.272 Test Acc: 0.356
Validation loss decreased (-0.294420 --> -0.355533).  Saving model ...
Epoch: 4 cost time: 1.690351963043213
Epoch: 4, Steps: 12 | Train Loss: 2.175 Vali Loss: 2.063 Vali Acc: 0.483 Test Loss: 2.063 Test Acc: 0.483
Validation loss decreased (-0.355533 --> -0.483313).  Saving model ...
Epoch: 5 cost time: 1.7215137481689453
Epoch: 5, Steps: 12 | Train Loss: 1.923 Vali Loss: 1.846 Vali Acc: 0.550 Test Loss: 1.846 Test Acc: 0.550
Validation loss decreased (-0.483313 --> -0.549982).  Saving model ...
Epoch: 6 cost time: 1.6782011985778809
Epoch: 6, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.618 Vali Acc: 0.589 Test Loss: 1.618 Test Acc: 0.589
Validation loss decreased (-0.549982 --> -0.588873).  Saving model ...
Epoch: 7 cost time: 1.6791696548461914
Epoch: 7, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.429 Vali Acc: 0.606 Test Loss: 1.429 Test Acc: 0.606
Validation loss decreased (-0.588873 --> -0.605541).  Saving model ...
Epoch: 8 cost time: 1.6877377033233643
Epoch: 8, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.274 Vali Acc: 0.639 Test Loss: 1.274 Test Acc: 0.639
Validation loss decreased (-0.605541 --> -0.638876).  Saving model ...
Epoch: 9 cost time: 1.5093369483947754
Epoch: 9, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.166 Vali Acc: 0.667 Test Loss: 1.166 Test Acc: 0.667
Validation loss decreased (-0.638876 --> -0.666655).  Saving model ...
Epoch: 10 cost time: 1.5792884826660156
Epoch: 10, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.051 Vali Acc: 0.656 Test Loss: 1.051 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5992751121520996
Epoch: 11, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.970 Vali Acc: 0.672 Test Loss: 0.970 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672213).  Saving model ...
Epoch: 12 cost time: 1.664252758026123
Epoch: 12, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.895 Vali Acc: 0.694 Test Loss: 0.895 Test Acc: 0.694
Validation loss decreased (-0.672213 --> -0.694435).  Saving model ...
Epoch: 13 cost time: 1.5189762115478516
Epoch: 13, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.833 Vali Acc: 0.728 Test Loss: 0.833 Test Acc: 0.728
Validation loss decreased (-0.694435 --> -0.727769).  Saving model ...
Epoch: 14 cost time: 1.7015154361724854
Epoch: 14, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.799 Vali Acc: 0.722 Test Loss: 0.799 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5478911399841309
Epoch: 15, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.778 Vali Acc: 0.739 Test Loss: 0.778 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738881).  Saving model ...
Epoch: 16 cost time: 1.5982933044433594
Epoch: 16, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.728 Vali Acc: 0.739 Test Loss: 0.728 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738882).  Saving model ...
Epoch: 17 cost time: 1.5655899047851562
Epoch: 17, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.707 Vali Acc: 0.739 Test Loss: 0.707 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738882).  Saving model ...
Epoch: 18 cost time: 1.6290268898010254
Epoch: 18, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.701 Vali Acc: 0.756 Test Loss: 0.701 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 19 cost time: 1.5990808010101318
Epoch: 19, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.665 Vali Acc: 0.778 Test Loss: 0.665 Test Acc: 0.778
Validation loss decreased (-0.755549 --> -0.777771).  Saving model ...
Epoch: 20 cost time: 1.6776623725891113
Epoch: 20, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.657 Vali Acc: 0.772 Test Loss: 0.657 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5791559219360352
Epoch: 21, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 22 cost time: 1.5671491622924805
Epoch: 22, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.649 Vali Acc: 0.772 Test Loss: 0.649 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6489336490631104
Epoch: 23, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.622 Vali Acc: 0.772 Test Loss: 0.622 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.643256664276123
Epoch: 24, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.639 Vali Acc: 0.778 Test Loss: 0.639 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6843228340148926
Epoch: 25, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.629 Vali Acc: 0.789 Test Loss: 0.629 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788883).  Saving model ...
Epoch: 26 cost time: 1.7387995719909668
Epoch: 26, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6617989540100098
Epoch: 27, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.630 Vali Acc: 0.783 Test Loss: 0.630 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6564311981201172
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.638 Vali Acc: 0.789 Test Loss: 0.638 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7364962100982666
Epoch: 29, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5882246494293213
Epoch: 30, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.610 Vali Acc: 0.789 Test Loss: 0.610 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 710895
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4670088291168213
Epoch: 1, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.702 Vali Acc: 0.056 Test Loss: 2.702 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 1.2926304340362549
Epoch: 2, Steps: 12 | Train Loss: 2.587 Vali Loss: 2.526 Vali Acc: 0.228 Test Loss: 2.526 Test Acc: 0.228
Validation loss decreased (-0.055529 --> -0.227753).  Saving model ...
Epoch: 3 cost time: 1.6377756595611572
Epoch: 3, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.305 Vali Acc: 0.383 Test Loss: 2.305 Test Acc: 0.383
Validation loss decreased (-0.227753 --> -0.383310).  Saving model ...
Epoch: 4 cost time: 1.6993050575256348
Epoch: 4, Steps: 12 | Train Loss: 2.116 Vali Loss: 2.052 Vali Acc: 0.494 Test Loss: 2.052 Test Acc: 0.494
Validation loss decreased (-0.383310 --> -0.494424).  Saving model ...
Epoch: 5 cost time: 1.603222370147705
Epoch: 5, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.798 Vali Acc: 0.528 Test Loss: 1.798 Test Acc: 0.528
Validation loss decreased (-0.494424 --> -0.527760).  Saving model ...
Epoch: 6 cost time: 1.6552014350891113
Epoch: 6, Steps: 12 | Train Loss: 1.549 Vali Loss: 1.579 Vali Acc: 0.556 Test Loss: 1.579 Test Acc: 0.556
Validation loss decreased (-0.527760 --> -0.555540).  Saving model ...
Epoch: 7 cost time: 1.7235794067382812
Epoch: 7, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.409 Vali Acc: 0.572 Test Loss: 1.409 Test Acc: 0.572
Validation loss decreased (-0.555540 --> -0.572208).  Saving model ...
Epoch: 8 cost time: 1.8445634841918945
Epoch: 8, Steps: 12 | Train Loss: 1.175 Vali Loss: 1.251 Vali Acc: 0.656 Test Loss: 1.251 Test Acc: 0.656
Validation loss decreased (-0.572208 --> -0.655543).  Saving model ...
Epoch: 9 cost time: 2.1382038593292236
Epoch: 9, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.159 Vali Acc: 0.628 Test Loss: 1.159 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9809911251068115
Epoch: 10, Steps: 12 | Train Loss: 0.912 Vali Loss: 1.056 Vali Acc: 0.672 Test Loss: 1.056 Test Acc: 0.672
Validation loss decreased (-0.655543 --> -0.672212).  Saving model ...
Epoch: 11 cost time: 2.0947370529174805
Epoch: 11, Steps: 12 | Train Loss: 0.773 Vali Loss: 0.972 Vali Acc: 0.667 Test Loss: 0.972 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.038879632949829
Epoch: 12, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.894 Vali Acc: 0.683 Test Loss: 0.894 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683324).  Saving model ...
Epoch: 13 cost time: 2.1133036613464355
Epoch: 13, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.816 Vali Acc: 0.672 Test Loss: 0.816 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8927273750305176
Epoch: 14, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.776 Vali Acc: 0.711 Test Loss: 0.776 Test Acc: 0.711
Validation loss decreased (-0.683324 --> -0.711103).  Saving model ...
Epoch: 15 cost time: 2.2365312576293945
Epoch: 15, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.744 Vali Acc: 0.722 Test Loss: 0.744 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722215).  Saving model ...
Epoch: 16 cost time: 2.060516119003296
Epoch: 16, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.718 Vali Acc: 0.722 Test Loss: 0.718 Test Acc: 0.722
Validation loss decreased (-0.722215 --> -0.722215).  Saving model ...
Epoch: 17 cost time: 2.230386972427368
Epoch: 17, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.679 Vali Acc: 0.772 Test Loss: 0.679 Test Acc: 0.772
Validation loss decreased (-0.722215 --> -0.772215).  Saving model ...
Epoch: 18 cost time: 2.1492466926574707
Epoch: 18, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.637 Vali Acc: 0.778 Test Loss: 0.637 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 19 cost time: 2.132624864578247
Epoch: 19, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 20 cost time: 2.102814197540283
Epoch: 20, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.614 Vali Acc: 0.778 Test Loss: 0.614 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0266363620758057
Epoch: 21, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.616 Vali Acc: 0.789 Test Loss: 0.616 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788883).  Saving model ...
Epoch: 22 cost time: 2.301302909851074
Epoch: 22, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.575 Vali Acc: 0.806 Test Loss: 0.575 Test Acc: 0.806
Validation loss decreased (-0.788883 --> -0.805550).  Saving model ...
Epoch: 23 cost time: 2.2020928859710693
Epoch: 23, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.583 Vali Acc: 0.817 Test Loss: 0.583 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816661).  Saving model ...
Epoch: 24 cost time: 2.241689443588257
Epoch: 24, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.583 Vali Acc: 0.811 Test Loss: 0.583 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1836447715759277
Epoch: 25, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.565 Vali Acc: 0.806 Test Loss: 0.565 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.145622491836548
Epoch: 26, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.587 Vali Acc: 0.806 Test Loss: 0.587 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0907561779022217
Epoch: 27, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.577 Vali Acc: 0.806 Test Loss: 0.577 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1428394317626953
Epoch: 28, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.546 Vali Acc: 0.817 Test Loss: 0.546 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816661).  Saving model ...
Epoch: 29 cost time: 2.157865285873413
Epoch: 29, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.575 Vali Acc: 0.800 Test Loss: 0.575 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.099761486053467
Epoch: 30, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.611 Vali Acc: 0.817 Test Loss: 0.611 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 2366063
model size : 9.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2805116176605225
Epoch: 1, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.604 Vali Acc: 0.167 Test Loss: 2.604 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 1.4530198574066162
Epoch: 2, Steps: 12 | Train Loss: 2.617 Vali Loss: 2.458 Vali Acc: 0.294 Test Loss: 2.458 Test Acc: 0.294
Validation loss decreased (-0.166641 --> -0.294420).  Saving model ...
Epoch: 3 cost time: 1.5285758972167969
Epoch: 3, Steps: 12 | Train Loss: 2.379 Vali Loss: 2.271 Vali Acc: 0.361 Test Loss: 2.271 Test Acc: 0.361
Validation loss decreased (-0.294420 --> -0.361088).  Saving model ...
Epoch: 4 cost time: 1.5485033988952637
Epoch: 4, Steps: 12 | Train Loss: 2.176 Vali Loss: 2.061 Vali Acc: 0.483 Test Loss: 2.061 Test Acc: 0.483
Validation loss decreased (-0.361088 --> -0.483313).  Saving model ...
Epoch: 5 cost time: 1.5116941928863525
Epoch: 5, Steps: 12 | Train Loss: 1.925 Vali Loss: 1.843 Vali Acc: 0.556 Test Loss: 1.843 Test Acc: 0.556
Validation loss decreased (-0.483313 --> -0.555537).  Saving model ...
Epoch: 6 cost time: 1.6026597023010254
Epoch: 6, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.613 Vali Acc: 0.589 Test Loss: 1.613 Test Acc: 0.589
Validation loss decreased (-0.555537 --> -0.588873).  Saving model ...
Epoch: 7 cost time: 1.5807688236236572
Epoch: 7, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.424 Vali Acc: 0.606 Test Loss: 1.424 Test Acc: 0.606
Validation loss decreased (-0.588873 --> -0.605541).  Saving model ...
Epoch: 8 cost time: 1.3609168529510498
Epoch: 8, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.269 Vali Acc: 0.656 Test Loss: 1.269 Test Acc: 0.656
Validation loss decreased (-0.605541 --> -0.655543).  Saving model ...
Epoch: 9 cost time: 1.4552013874053955
Epoch: 9, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.163 Vali Acc: 0.661 Test Loss: 1.163 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661099).  Saving model ...
Epoch: 10 cost time: 1.4458513259887695
Epoch: 10, Steps: 12 | Train Loss: 0.891 Vali Loss: 1.049 Vali Acc: 0.644 Test Loss: 1.049 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4417495727539062
Epoch: 11, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.969 Vali Acc: 0.678 Test Loss: 0.969 Test Acc: 0.678
Validation loss decreased (-0.661099 --> -0.677768).  Saving model ...
Epoch: 12 cost time: 1.4658758640289307
Epoch: 12, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.895 Vali Acc: 0.700 Test Loss: 0.895 Test Acc: 0.700
Validation loss decreased (-0.677768 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 1.456404685974121
Epoch: 13, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.832 Vali Acc: 0.728 Test Loss: 0.832 Test Acc: 0.728
Validation loss decreased (-0.699991 --> -0.727769).  Saving model ...
Epoch: 14 cost time: 1.505220890045166
Epoch: 14, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.802 Vali Acc: 0.717 Test Loss: 0.802 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4588603973388672
Epoch: 15, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.777 Vali Acc: 0.750 Test Loss: 0.777 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 1.261561393737793
Epoch: 16, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.725 Vali Acc: 0.739 Test Loss: 0.725 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.326747179031372
Epoch: 17, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.704 Vali Acc: 0.744 Test Loss: 0.704 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2347419261932373
Epoch: 18, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.698 Vali Acc: 0.761 Test Loss: 0.698 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761104).  Saving model ...
Epoch: 19 cost time: 1.1954917907714844
Epoch: 19, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.661 Vali Acc: 0.778 Test Loss: 0.661 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 20 cost time: 1.2392444610595703
Epoch: 20, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.653 Vali Acc: 0.778 Test Loss: 0.653 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 21 cost time: 1.6043992042541504
Epoch: 21, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.629 Vali Acc: 0.783 Test Loss: 0.629 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 22 cost time: 1.6739859580993652
Epoch: 22, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.646 Vali Acc: 0.778 Test Loss: 0.646 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7531490325927734
Epoch: 23, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.617 Vali Acc: 0.789 Test Loss: 0.617 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788883).  Saving model ...
Epoch: 24 cost time: 1.754889965057373
Epoch: 24, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.625 Vali Acc: 0.778 Test Loss: 0.625 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8043293952941895
Epoch: 25, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.623 Vali Acc: 0.789 Test Loss: 0.623 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.733982801437378
Epoch: 26, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.609 Vali Acc: 0.794 Test Loss: 0.609 Test Acc: 0.794
Validation loss decreased (-0.788883 --> -0.794438).  Saving model ...
Epoch: 27 cost time: 1.723283052444458
Epoch: 27, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.610 Vali Acc: 0.778 Test Loss: 0.610 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7523376941680908
Epoch: 28, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.624 Vali Acc: 0.789 Test Loss: 0.624 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7158963680267334
Epoch: 29, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.631 Vali Acc: 0.794 Test Loss: 0.631 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.792463779449463
Epoch: 30, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.606 Vali Acc: 0.789 Test Loss: 0.606 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 710895
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4618465900421143
Epoch: 1, Steps: 12 | Train Loss: 2.747 Vali Loss: 2.711 Vali Acc: 0.050 Test Loss: 2.711 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 1.8511803150177002
Epoch: 2, Steps: 12 | Train Loss: 2.604 Vali Loss: 2.562 Vali Acc: 0.161 Test Loss: 2.562 Test Acc: 0.161
Validation loss decreased (-0.049973 --> -0.161085).  Saving model ...
Epoch: 3 cost time: 1.850137710571289
Epoch: 3, Steps: 12 | Train Loss: 2.463 Vali Loss: 2.381 Vali Acc: 0.344 Test Loss: 2.381 Test Acc: 0.344
Validation loss decreased (-0.161085 --> -0.344421).  Saving model ...
Epoch: 4 cost time: 1.876800775527954
Epoch: 4, Steps: 12 | Train Loss: 2.221 Vali Loss: 2.172 Vali Acc: 0.478 Test Loss: 2.172 Test Acc: 0.478
Validation loss decreased (-0.344421 --> -0.477756).  Saving model ...
Epoch: 5 cost time: 1.7949275970458984
Epoch: 5, Steps: 12 | Train Loss: 1.986 Vali Loss: 1.973 Vali Acc: 0.522 Test Loss: 1.973 Test Acc: 0.522
Validation loss decreased (-0.477756 --> -0.522202).  Saving model ...
Epoch: 6 cost time: 1.7977964878082275
Epoch: 6, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.796 Vali Acc: 0.528 Test Loss: 1.796 Test Acc: 0.528
Validation loss decreased (-0.522202 --> -0.527760).  Saving model ...
Epoch: 7 cost time: 1.818413496017456
Epoch: 7, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.654 Vali Acc: 0.528 Test Loss: 1.654 Test Acc: 0.528
Validation loss decreased (-0.527760 --> -0.527761).  Saving model ...
Epoch: 8 cost time: 1.9238395690917969
Epoch: 8, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.495 Vali Acc: 0.572 Test Loss: 1.495 Test Acc: 0.572
Validation loss decreased (-0.527761 --> -0.572207).  Saving model ...
Epoch: 9 cost time: 1.8347358703613281
Epoch: 9, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.396 Vali Acc: 0.567 Test Loss: 1.396 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8955307006835938
Epoch: 10, Steps: 12 | Train Loss: 1.119 Vali Loss: 1.278 Vali Acc: 0.600 Test Loss: 1.278 Test Acc: 0.600
Validation loss decreased (-0.572207 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 1.901076316833496
Epoch: 11, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.179 Vali Acc: 0.628 Test Loss: 1.179 Test Acc: 0.628
Validation loss decreased (-0.599987 --> -0.627766).  Saving model ...
Epoch: 12 cost time: 1.899094820022583
Epoch: 12, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.075 Vali Acc: 0.628 Test Loss: 1.075 Test Acc: 0.628
Validation loss decreased (-0.627766 --> -0.627767).  Saving model ...
Epoch: 13 cost time: 1.7785301208496094
Epoch: 13, Steps: 12 | Train Loss: 0.800 Vali Loss: 0.987 Vali Acc: 0.622 Test Loss: 0.987 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8068628311157227
Epoch: 14, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.931 Vali Acc: 0.633 Test Loss: 0.931 Test Acc: 0.633
Validation loss decreased (-0.627767 --> -0.633324).  Saving model ...
Epoch: 15 cost time: 1.9208910465240479
Epoch: 15, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.869 Vali Acc: 0.683 Test Loss: 0.869 Test Acc: 0.683
Validation loss decreased (-0.633324 --> -0.683325).  Saving model ...
Epoch: 16 cost time: 1.8845689296722412
Epoch: 16, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.829 Vali Acc: 0.694 Test Loss: 0.829 Test Acc: 0.694
Validation loss decreased (-0.683325 --> -0.694436).  Saving model ...
Epoch: 17 cost time: 1.8388183116912842
Epoch: 17, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.803 Vali Acc: 0.728 Test Loss: 0.803 Test Acc: 0.728
Validation loss decreased (-0.694436 --> -0.727770).  Saving model ...
Epoch: 18 cost time: 1.8211784362792969
Epoch: 18, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.758 Vali Acc: 0.711 Test Loss: 0.758 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8612210750579834
Epoch: 19, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.774 Vali Acc: 0.728 Test Loss: 0.774 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727770).  Saving model ...
Epoch: 20 cost time: 1.865541934967041
Epoch: 20, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.718 Vali Acc: 0.750 Test Loss: 0.718 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749993).  Saving model ...
Epoch: 21 cost time: 1.8534634113311768
Epoch: 21, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.746 Vali Acc: 0.728 Test Loss: 0.746 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8143935203552246
Epoch: 22, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.695 Vali Acc: 0.717 Test Loss: 0.695 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7796287536621094
Epoch: 23, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.703 Vali Acc: 0.744 Test Loss: 0.703 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8740026950836182
Epoch: 24, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.679 Vali Acc: 0.739 Test Loss: 0.679 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8502211570739746
Epoch: 25, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.660 Vali Acc: 0.778 Test Loss: 0.660 Test Acc: 0.778
Validation loss decreased (-0.749993 --> -0.777771).  Saving model ...
Epoch: 26 cost time: 1.874645471572876
Epoch: 26, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.622 Vali Acc: 0.811 Test Loss: 0.622 Test Acc: 0.811
Validation loss decreased (-0.777771 --> -0.811105).  Saving model ...
Epoch: 27 cost time: 1.908998966217041
Epoch: 27, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.624 Vali Acc: 0.783 Test Loss: 0.624 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.850395679473877
Epoch: 28, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.571 Vali Acc: 0.806 Test Loss: 0.571 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.818479061126709
Epoch: 29, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.605 Vali Acc: 0.806 Test Loss: 0.605 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6245231628417969
Epoch: 30, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.627 Vali Acc: 0.783 Test Loss: 0.627 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 2366063
model size : 9.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9280407428741455
Epoch: 1, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.613 Vali Acc: 0.139 Test Loss: 2.613 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 1.3841605186462402
Epoch: 2, Steps: 12 | Train Loss: 2.633 Vali Loss: 2.484 Vali Acc: 0.256 Test Loss: 2.484 Test Acc: 0.256
Validation loss decreased (-0.138863 --> -0.255531).  Saving model ...
Epoch: 3 cost time: 1.2675836086273193
Epoch: 3, Steps: 12 | Train Loss: 2.423 Vali Loss: 2.321 Vali Acc: 0.367 Test Loss: 2.321 Test Acc: 0.367
Validation loss decreased (-0.255531 --> -0.366643).  Saving model ...
Epoch: 4 cost time: 1.2570915222167969
Epoch: 4, Steps: 12 | Train Loss: 2.251 Vali Loss: 2.140 Vali Acc: 0.439 Test Loss: 2.140 Test Acc: 0.439
Validation loss decreased (-0.366643 --> -0.438867).  Saving model ...
Epoch: 5 cost time: 1.2217187881469727
Epoch: 5, Steps: 12 | Train Loss: 2.030 Vali Loss: 1.961 Vali Acc: 0.528 Test Loss: 1.961 Test Acc: 0.528
Validation loss decreased (-0.438867 --> -0.527758).  Saving model ...
Epoch: 6 cost time: 1.1896157264709473
Epoch: 6, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.773 Vali Acc: 0.550 Test Loss: 1.773 Test Acc: 0.550
Validation loss decreased (-0.527758 --> -0.549982).  Saving model ...
Epoch: 7 cost time: 1.2271640300750732
Epoch: 7, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.614 Vali Acc: 0.567 Test Loss: 1.614 Test Acc: 0.567
Validation loss decreased (-0.549982 --> -0.566651).  Saving model ...
Epoch: 8 cost time: 1.2333979606628418
Epoch: 8, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.480 Vali Acc: 0.578 Test Loss: 1.480 Test Acc: 0.578
Validation loss decreased (-0.566651 --> -0.577763).  Saving model ...
Epoch: 9 cost time: 1.274235725402832
Epoch: 9, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.376 Vali Acc: 0.594 Test Loss: 1.376 Test Acc: 0.594
Validation loss decreased (-0.577763 --> -0.594431).  Saving model ...
Epoch: 10 cost time: 1.234253168106079
Epoch: 10, Steps: 12 | Train Loss: 1.082 Vali Loss: 1.263 Vali Acc: 0.572 Test Loss: 1.263 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3087782859802246
Epoch: 11, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.183 Vali Acc: 0.594 Test Loss: 1.183 Test Acc: 0.594
Validation loss decreased (-0.594431 --> -0.594433).  Saving model ...
Epoch: 12 cost time: 1.253114938735962
Epoch: 12, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.106 Vali Acc: 0.611 Test Loss: 1.106 Test Acc: 0.611
Validation loss decreased (-0.594433 --> -0.611100).  Saving model ...
Epoch: 13 cost time: 1.3606359958648682
Epoch: 13, Steps: 12 | Train Loss: 0.798 Vali Loss: 1.023 Vali Acc: 0.650 Test Loss: 1.023 Test Acc: 0.650
Validation loss decreased (-0.611100 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 1.4239892959594727
Epoch: 14, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.992 Vali Acc: 0.628 Test Loss: 0.992 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.382845401763916
Epoch: 15, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.939 Vali Acc: 0.667 Test Loss: 0.939 Test Acc: 0.667
Validation loss decreased (-0.649990 --> -0.666657).  Saving model ...
Epoch: 16 cost time: 1.349923849105835
Epoch: 16, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.891 Vali Acc: 0.672 Test Loss: 0.891 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672213).  Saving model ...
Epoch: 17 cost time: 1.3883230686187744
Epoch: 17, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.845 Vali Acc: 0.711 Test Loss: 0.845 Test Acc: 0.711
Validation loss decreased (-0.672213 --> -0.711103).  Saving model ...
Epoch: 18 cost time: 1.390202522277832
Epoch: 18, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.825 Vali Acc: 0.728 Test Loss: 0.825 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 19 cost time: 1.3180160522460938
Epoch: 19, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.799 Vali Acc: 0.728 Test Loss: 0.799 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727770).  Saving model ...
Epoch: 20 cost time: 1.523545742034912
Epoch: 20, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.794 Vali Acc: 0.739 Test Loss: 0.794 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738881).  Saving model ...
Epoch: 21 cost time: 1.4463202953338623
Epoch: 21, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.758 Vali Acc: 0.750 Test Loss: 0.758 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 1.498725175857544
Epoch: 22, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.766 Vali Acc: 0.761 Test Loss: 0.766 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 23 cost time: 1.4924752712249756
Epoch: 23, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.742 Vali Acc: 0.750 Test Loss: 0.742 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4585230350494385
Epoch: 24, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.738 Vali Acc: 0.750 Test Loss: 0.738 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4179129600524902
Epoch: 25, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.712 Vali Acc: 0.783 Test Loss: 0.712 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 26 cost time: 1.351121187210083
Epoch: 26, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.729 Vali Acc: 0.767 Test Loss: 0.729 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4431264400482178
Epoch: 27, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.724 Vali Acc: 0.761 Test Loss: 0.724 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4295051097869873
Epoch: 28, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.737 Vali Acc: 0.778 Test Loss: 0.737 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3693230152130127
Epoch: 29, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.738 Vali Acc: 0.772 Test Loss: 0.738 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4505107402801514
Epoch: 30, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.706 Vali Acc: 0.778 Test Loss: 0.706 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 710895
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9325737953186035
Epoch: 1, Steps: 12 | Train Loss: 2.728 Vali Loss: 2.682 Vali Acc: 0.044 Test Loss: 2.682 Test Acc: 0.044
Validation loss decreased (inf --> -0.044418).  Saving model ...
Epoch: 2 cost time: 2.1675775051116943
Epoch: 2, Steps: 12 | Train Loss: 2.621 Vali Loss: 2.532 Vali Acc: 0.189 Test Loss: 2.532 Test Acc: 0.189
Validation loss decreased (-0.044418 --> -0.188864).  Saving model ...
Epoch: 3 cost time: 2.2187492847442627
Epoch: 3, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.346 Vali Acc: 0.333 Test Loss: 2.346 Test Acc: 0.333
Validation loss decreased (-0.188864 --> -0.333310).  Saving model ...
Epoch: 4 cost time: 2.1802542209625244
Epoch: 4, Steps: 12 | Train Loss: 2.227 Vali Loss: 2.129 Vali Acc: 0.461 Test Loss: 2.129 Test Acc: 0.461
Validation loss decreased (-0.333310 --> -0.461090).  Saving model ...
Epoch: 5 cost time: 2.2328555583953857
Epoch: 5, Steps: 12 | Train Loss: 2.006 Vali Loss: 1.898 Vali Acc: 0.528 Test Loss: 1.898 Test Acc: 0.528
Validation loss decreased (-0.461090 --> -0.527759).  Saving model ...
Epoch: 6 cost time: 2.193362236022949
Epoch: 6, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.662 Vali Acc: 0.556 Test Loss: 1.662 Test Acc: 0.556
Validation loss decreased (-0.527759 --> -0.555539).  Saving model ...
Epoch: 7 cost time: 2.240643262863159
Epoch: 7, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.464 Vali Acc: 0.583 Test Loss: 1.464 Test Acc: 0.583
Validation loss decreased (-0.555539 --> -0.583319).  Saving model ...
Epoch: 8 cost time: 2.2989072799682617
Epoch: 8, Steps: 12 | Train Loss: 1.248 Vali Loss: 1.310 Vali Acc: 0.617 Test Loss: 1.310 Test Acc: 0.617
Validation loss decreased (-0.583319 --> -0.616654).  Saving model ...
Epoch: 9 cost time: 2.2172744274139404
Epoch: 9, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.178 Vali Acc: 0.622 Test Loss: 1.178 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 10 cost time: 2.3318395614624023
Epoch: 10, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.089 Vali Acc: 0.672 Test Loss: 1.089 Test Acc: 0.672
Validation loss decreased (-0.622210 --> -0.672211).  Saving model ...
Epoch: 11 cost time: 2.315135955810547
Epoch: 11, Steps: 12 | Train Loss: 0.847 Vali Loss: 1.016 Vali Acc: 0.650 Test Loss: 1.016 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.284972667694092
Epoch: 12, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.922 Vali Acc: 0.678 Test Loss: 0.922 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677769).  Saving model ...
Epoch: 13 cost time: 2.3042283058166504
Epoch: 13, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.872 Vali Acc: 0.717 Test Loss: 0.872 Test Acc: 0.717
Validation loss decreased (-0.677769 --> -0.716658).  Saving model ...
Epoch: 14 cost time: 2.2367870807647705
Epoch: 14, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.829 Vali Acc: 0.722 Test Loss: 0.829 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722214).  Saving model ...
Epoch: 15 cost time: 2.280536413192749
Epoch: 15, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.790 Vali Acc: 0.722 Test Loss: 0.790 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 16 cost time: 2.2513082027435303
Epoch: 16, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.766 Vali Acc: 0.694 Test Loss: 0.766 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2879743576049805
Epoch: 17, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.718 Vali Acc: 0.739 Test Loss: 0.718 Test Acc: 0.739
Validation loss decreased (-0.722214 --> -0.738882).  Saving model ...
Epoch: 18 cost time: 2.0839004516601562
Epoch: 18, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.707 Vali Acc: 0.750 Test Loss: 0.707 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749993).  Saving model ...
Epoch: 19 cost time: 2.118020534515381
Epoch: 19, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.058473587036133
Epoch: 20, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.700 Vali Acc: 0.733 Test Loss: 0.700 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0462162494659424
Epoch: 21, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.675 Vali Acc: 0.756 Test Loss: 0.675 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 22 cost time: 2.2186055183410645
Epoch: 22, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.653 Vali Acc: 0.772 Test Loss: 0.653 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772216).  Saving model ...
Epoch: 23 cost time: 2.062187910079956
Epoch: 23, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.632 Vali Acc: 0.783 Test Loss: 0.632 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783327).  Saving model ...
Epoch: 24 cost time: 2.1369447708129883
Epoch: 24, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.611 Vali Acc: 0.794 Test Loss: 0.611 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794438).  Saving model ...
Epoch: 25 cost time: 2.194955587387085
Epoch: 25, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.623 Vali Acc: 0.800 Test Loss: 0.623 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 26 cost time: 2.0969083309173584
Epoch: 26, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.588 Vali Acc: 0.806 Test Loss: 0.588 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805550).  Saving model ...
Epoch: 27 cost time: 2.208923816680908
Epoch: 27, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.614 Vali Acc: 0.789 Test Loss: 0.614 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.074082374572754
Epoch: 28, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.9495704174041748
Epoch: 29, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.602 Vali Acc: 0.789 Test Loss: 0.602 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.224410057067871
Epoch: 30, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.609 Vali Acc: 0.806 Test Loss: 0.609 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 1194223
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.585980176925659
Epoch: 1, Steps: 12 | Train Loss: 2.798 Vali Loss: 2.686 Vali Acc: 0.089 Test Loss: 2.686 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.816103458404541
Epoch: 2, Steps: 12 | Train Loss: 2.630 Vali Loss: 2.533 Vali Acc: 0.128 Test Loss: 2.533 Test Acc: 0.128
Validation loss decreased (-0.088862 --> -0.127752).  Saving model ...
Epoch: 3 cost time: 1.7378883361816406
Epoch: 3, Steps: 12 | Train Loss: 2.451 Vali Loss: 2.343 Vali Acc: 0.328 Test Loss: 2.343 Test Acc: 0.328
Validation loss decreased (-0.127752 --> -0.327754).  Saving model ...
Epoch: 4 cost time: 1.8075995445251465
Epoch: 4, Steps: 12 | Train Loss: 2.260 Vali Loss: 2.142 Vali Acc: 0.478 Test Loss: 2.142 Test Acc: 0.478
Validation loss decreased (-0.327754 --> -0.477756).  Saving model ...
Epoch: 5 cost time: 1.7860829830169678
Epoch: 5, Steps: 12 | Train Loss: 2.002 Vali Loss: 1.939 Vali Acc: 0.550 Test Loss: 1.939 Test Acc: 0.550
Validation loss decreased (-0.477756 --> -0.549981).  Saving model ...
Epoch: 6 cost time: 1.833221673965454
Epoch: 6, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.739 Vali Acc: 0.583 Test Loss: 1.739 Test Acc: 0.583
Validation loss decreased (-0.549981 --> -0.583316).  Saving model ...
Epoch: 7 cost time: 1.7473094463348389
Epoch: 7, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.564 Vali Acc: 0.617 Test Loss: 1.564 Test Acc: 0.617
Validation loss decreased (-0.583316 --> -0.616651).  Saving model ...
Epoch: 8 cost time: 1.7650985717773438
Epoch: 8, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.395 Vali Acc: 0.611 Test Loss: 1.395 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7967309951782227
Epoch: 9, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.267 Vali Acc: 0.633 Test Loss: 1.267 Test Acc: 0.633
Validation loss decreased (-0.616651 --> -0.633321).  Saving model ...
Epoch: 10 cost time: 1.8274729251861572
Epoch: 10, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.157 Vali Acc: 0.628 Test Loss: 1.157 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7696623802185059
Epoch: 11, Steps: 12 | Train Loss: 0.863 Vali Loss: 1.080 Vali Acc: 0.633 Test Loss: 1.080 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633323).  Saving model ...
Epoch: 12 cost time: 1.8595044612884521
Epoch: 12, Steps: 12 | Train Loss: 0.804 Vali Loss: 1.015 Vali Acc: 0.639 Test Loss: 1.015 Test Acc: 0.639
Validation loss decreased (-0.633323 --> -0.638879).  Saving model ...
Epoch: 13 cost time: 1.8496558666229248
Epoch: 13, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.969 Vali Acc: 0.639 Test Loss: 0.969 Test Acc: 0.639
Validation loss decreased (-0.638879 --> -0.638879).  Saving model ...
Epoch: 14 cost time: 1.793224811553955
Epoch: 14, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.924 Vali Acc: 0.656 Test Loss: 0.924 Test Acc: 0.656
Validation loss decreased (-0.638879 --> -0.655546).  Saving model ...
Epoch: 15 cost time: 1.7774848937988281
Epoch: 15, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.882 Vali Acc: 0.678 Test Loss: 0.882 Test Acc: 0.678
Validation loss decreased (-0.655546 --> -0.677769).  Saving model ...
Epoch: 16 cost time: 1.7341690063476562
Epoch: 16, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.870 Vali Acc: 0.678 Test Loss: 0.870 Test Acc: 0.678
Validation loss decreased (-0.677769 --> -0.677769).  Saving model ...
Epoch: 17 cost time: 1.7439746856689453
Epoch: 17, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.848 Vali Acc: 0.672 Test Loss: 0.848 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.759361982345581
Epoch: 18, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.819 Vali Acc: 0.700 Test Loss: 0.819 Test Acc: 0.700
Validation loss decreased (-0.677769 --> -0.699992).  Saving model ...
Epoch: 19 cost time: 1.6915757656097412
Epoch: 19, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.788 Vali Acc: 0.694 Test Loss: 0.788 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7870192527770996
Epoch: 20, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.761 Vali Acc: 0.689 Test Loss: 0.761 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7696254253387451
Epoch: 21, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.778 Vali Acc: 0.683 Test Loss: 0.778 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7148396968841553
Epoch: 22, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.770 Vali Acc: 0.711 Test Loss: 0.770 Test Acc: 0.711
Validation loss decreased (-0.699992 --> -0.711103).  Saving model ...
Epoch: 23 cost time: 1.8189537525177002
Epoch: 23, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.749 Vali Acc: 0.722 Test Loss: 0.749 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722215).  Saving model ...
Epoch: 24 cost time: 1.7282023429870605
Epoch: 24, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.743 Vali Acc: 0.711 Test Loss: 0.743 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.755812644958496
Epoch: 25, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.728 Vali Acc: 0.739 Test Loss: 0.728 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738882).  Saving model ...
Epoch: 26 cost time: 1.7775070667266846
Epoch: 26, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.723 Vali Acc: 0.744 Test Loss: 0.723 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744437).  Saving model ...
Epoch: 27 cost time: 1.6723554134368896
Epoch: 27, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.730 Vali Acc: 0.739 Test Loss: 0.730 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7412841320037842
Epoch: 28, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.712 Vali Acc: 0.761 Test Loss: 0.712 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761104).  Saving model ...
Epoch: 29 cost time: 1.779956340789795
Epoch: 29, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.725 Vali Acc: 0.739 Test Loss: 0.725 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7764170169830322
Epoch: 30, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.706 Vali Acc: 0.761 Test Loss: 0.706 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761104).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 366575
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.310230016708374
Epoch: 1, Steps: 12 | Train Loss: 2.728 Vali Loss: 2.682 Vali Acc: 0.044 Test Loss: 2.682 Test Acc: 0.044
Validation loss decreased (inf --> -0.044418).  Saving model ...
Epoch: 2 cost time: 1.5754692554473877
Epoch: 2, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.531 Vali Acc: 0.189 Test Loss: 2.531 Test Acc: 0.189
Validation loss decreased (-0.044418 --> -0.188864).  Saving model ...
Epoch: 3 cost time: 1.585458517074585
Epoch: 3, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.345 Vali Acc: 0.333 Test Loss: 2.345 Test Acc: 0.333
Validation loss decreased (-0.188864 --> -0.333310).  Saving model ...
Epoch: 4 cost time: 1.66876220703125
Epoch: 4, Steps: 12 | Train Loss: 2.227 Vali Loss: 2.127 Vali Acc: 0.456 Test Loss: 2.127 Test Acc: 0.456
Validation loss decreased (-0.333310 --> -0.455534).  Saving model ...
Epoch: 5 cost time: 1.5838675498962402
Epoch: 5, Steps: 12 | Train Loss: 2.006 Vali Loss: 1.896 Vali Acc: 0.522 Test Loss: 1.896 Test Acc: 0.522
Validation loss decreased (-0.455534 --> -0.522203).  Saving model ...
Epoch: 6 cost time: 1.6652312278747559
Epoch: 6, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.658 Vali Acc: 0.556 Test Loss: 1.658 Test Acc: 0.556
Validation loss decreased (-0.522203 --> -0.555539).  Saving model ...
Epoch: 7 cost time: 1.5807607173919678
Epoch: 7, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.463 Vali Acc: 0.572 Test Loss: 1.463 Test Acc: 0.572
Validation loss decreased (-0.555539 --> -0.572208).  Saving model ...
Epoch: 8 cost time: 1.5705790519714355
Epoch: 8, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.309 Vali Acc: 0.617 Test Loss: 1.309 Test Acc: 0.617
Validation loss decreased (-0.572208 --> -0.616654).  Saving model ...
Epoch: 9 cost time: 1.6398391723632812
Epoch: 9, Steps: 12 | Train Loss: 1.035 Vali Loss: 1.177 Vali Acc: 0.622 Test Loss: 1.177 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 10 cost time: 1.6123218536376953
Epoch: 10, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.088 Vali Acc: 0.672 Test Loss: 1.088 Test Acc: 0.672
Validation loss decreased (-0.622210 --> -0.672211).  Saving model ...
Epoch: 11 cost time: 1.716782569885254
Epoch: 11, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.014 Vali Acc: 0.650 Test Loss: 1.014 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7955677509307861
Epoch: 12, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.917 Vali Acc: 0.678 Test Loss: 0.917 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677769).  Saving model ...
Epoch: 13 cost time: 1.5794436931610107
Epoch: 13, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.864 Vali Acc: 0.722 Test Loss: 0.864 Test Acc: 0.722
Validation loss decreased (-0.677769 --> -0.722214).  Saving model ...
Epoch: 14 cost time: 1.783931016921997
Epoch: 14, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.825 Vali Acc: 0.717 Test Loss: 0.825 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8974337577819824
Epoch: 15, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.787 Vali Acc: 0.711 Test Loss: 0.787 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7722902297973633
Epoch: 16, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.763 Vali Acc: 0.700 Test Loss: 0.763 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.936372995376587
Epoch: 17, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.719 Vali Acc: 0.728 Test Loss: 0.719 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727771).  Saving model ...
Epoch: 18 cost time: 1.758213996887207
Epoch: 18, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.702 Vali Acc: 0.744 Test Loss: 0.702 Test Acc: 0.744
Validation loss decreased (-0.727771 --> -0.744437).  Saving model ...
Epoch: 19 cost time: 1.8433256149291992
Epoch: 19, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.681 Vali Acc: 0.728 Test Loss: 0.681 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8110487461090088
Epoch: 20, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.689 Vali Acc: 0.750 Test Loss: 0.689 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 21 cost time: 1.8521268367767334
Epoch: 21, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.675 Vali Acc: 0.739 Test Loss: 0.675 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9062542915344238
Epoch: 22, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.654 Vali Acc: 0.756 Test Loss: 0.654 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 23 cost time: 1.86079740524292
Epoch: 23, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.634 Vali Acc: 0.794 Test Loss: 0.634 Test Acc: 0.794
Validation loss decreased (-0.755549 --> -0.794438).  Saving model ...
Epoch: 24 cost time: 1.669363260269165
Epoch: 24, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.613 Vali Acc: 0.800 Test Loss: 0.613 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 25 cost time: 1.7857210636138916
Epoch: 25, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.626 Vali Acc: 0.794 Test Loss: 0.626 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7222368717193604
Epoch: 26, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.592 Vali Acc: 0.800 Test Loss: 0.592 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 27 cost time: 1.7350397109985352
Epoch: 27, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.620 Vali Acc: 0.794 Test Loss: 0.620 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7908287048339844
Epoch: 28, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.614 Vali Acc: 0.806 Test Loss: 0.614 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805549).  Saving model ...
Epoch: 29 cost time: 1.8546853065490723
Epoch: 29, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.599 Vali Acc: 0.794 Test Loss: 0.599 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8120059967041016
Epoch: 30, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.619 Vali Acc: 0.800 Test Loss: 0.619 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 1194223
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1785929203033447
Epoch: 1, Steps: 12 | Train Loss: 2.798 Vali Loss: 2.686 Vali Acc: 0.089 Test Loss: 2.686 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.4984016418457031
Epoch: 2, Steps: 12 | Train Loss: 2.629 Vali Loss: 2.533 Vali Acc: 0.128 Test Loss: 2.533 Test Acc: 0.128
Validation loss decreased (-0.088862 --> -0.127752).  Saving model ...
Epoch: 3 cost time: 1.4795715808868408
Epoch: 3, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.342 Vali Acc: 0.328 Test Loss: 2.342 Test Acc: 0.328
Validation loss decreased (-0.127752 --> -0.327754).  Saving model ...
Epoch: 4 cost time: 1.5531947612762451
Epoch: 4, Steps: 12 | Train Loss: 2.260 Vali Loss: 2.142 Vali Acc: 0.483 Test Loss: 2.142 Test Acc: 0.483
Validation loss decreased (-0.327754 --> -0.483312).  Saving model ...
Epoch: 5 cost time: 1.531343936920166
Epoch: 5, Steps: 12 | Train Loss: 2.002 Vali Loss: 1.938 Vali Acc: 0.550 Test Loss: 1.938 Test Acc: 0.550
Validation loss decreased (-0.483312 --> -0.549981).  Saving model ...
Epoch: 6 cost time: 1.4921133518218994
Epoch: 6, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.737 Vali Acc: 0.583 Test Loss: 1.737 Test Acc: 0.583
Validation loss decreased (-0.549981 --> -0.583316).  Saving model ...
Epoch: 7 cost time: 1.527021884918213
Epoch: 7, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.561 Vali Acc: 0.611 Test Loss: 1.561 Test Acc: 0.611
Validation loss decreased (-0.583316 --> -0.611095).  Saving model ...
Epoch: 8 cost time: 1.4857747554779053
Epoch: 8, Steps: 12 | Train Loss: 1.362 Vali Loss: 1.392 Vali Acc: 0.611 Test Loss: 1.392 Test Acc: 0.611
Validation loss decreased (-0.611095 --> -0.611097).  Saving model ...
Epoch: 9 cost time: 1.4906930923461914
Epoch: 9, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.263 Vali Acc: 0.633 Test Loss: 1.263 Test Acc: 0.633
Validation loss decreased (-0.611097 --> -0.633321).  Saving model ...
Epoch: 10 cost time: 1.4688398838043213
Epoch: 10, Steps: 12 | Train Loss: 1.010 Vali Loss: 1.151 Vali Acc: 0.628 Test Loss: 1.151 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5824344158172607
Epoch: 11, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.075 Vali Acc: 0.639 Test Loss: 1.075 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638878).  Saving model ...
Epoch: 12 cost time: 1.4943828582763672
Epoch: 12, Steps: 12 | Train Loss: 0.812 Vali Loss: 1.011 Vali Acc: 0.644 Test Loss: 1.011 Test Acc: 0.644
Validation loss decreased (-0.638878 --> -0.644434).  Saving model ...
Epoch: 13 cost time: 1.4763648509979248
Epoch: 13, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.965 Vali Acc: 0.644 Test Loss: 0.965 Test Acc: 0.644
Validation loss decreased (-0.644434 --> -0.644435).  Saving model ...
Epoch: 14 cost time: 1.3157615661621094
Epoch: 14, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.921 Vali Acc: 0.644 Test Loss: 0.921 Test Acc: 0.644
Validation loss decreased (-0.644435 --> -0.644435).  Saving model ...
Epoch: 15 cost time: 1.4245538711547852
Epoch: 15, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.880 Vali Acc: 0.667 Test Loss: 0.880 Test Acc: 0.667
Validation loss decreased (-0.644435 --> -0.666658).  Saving model ...
Epoch: 16 cost time: 1.4052021503448486
Epoch: 16, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.866 Vali Acc: 0.678 Test Loss: 0.866 Test Acc: 0.678
Validation loss decreased (-0.666658 --> -0.677769).  Saving model ...
Epoch: 17 cost time: 1.4499437808990479
Epoch: 17, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.849 Vali Acc: 0.672 Test Loss: 0.849 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3993604183197021
Epoch: 18, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.820 Vali Acc: 0.694 Test Loss: 0.820 Test Acc: 0.694
Validation loss decreased (-0.677769 --> -0.694436).  Saving model ...
Epoch: 19 cost time: 1.3568530082702637
Epoch: 19, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.795 Vali Acc: 0.689 Test Loss: 0.795 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3339605331420898
Epoch: 20, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.768 Vali Acc: 0.700 Test Loss: 0.768 Test Acc: 0.700
Validation loss decreased (-0.694436 --> -0.699992).  Saving model ...
Epoch: 21 cost time: 1.3298604488372803
Epoch: 21, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.782 Vali Acc: 0.694 Test Loss: 0.782 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4516937732696533
Epoch: 22, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.780 Vali Acc: 0.706 Test Loss: 0.780 Test Acc: 0.706
Validation loss decreased (-0.699992 --> -0.705548).  Saving model ...
Epoch: 23 cost time: 1.4302682876586914
Epoch: 23, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.757 Vali Acc: 0.722 Test Loss: 0.757 Test Acc: 0.722
Validation loss decreased (-0.705548 --> -0.722215).  Saving model ...
Epoch: 24 cost time: 1.410459280014038
Epoch: 24, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.750 Vali Acc: 0.700 Test Loss: 0.750 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4325377941131592
Epoch: 25, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749993).  Saving model ...
Epoch: 26 cost time: 1.3074941635131836
Epoch: 26, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.729 Vali Acc: 0.722 Test Loss: 0.729 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.299267292022705
Epoch: 27, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.727 Vali Acc: 0.744 Test Loss: 0.727 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0851213932037354
Epoch: 28, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.709 Vali Acc: 0.750 Test Loss: 0.709 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 29 cost time: 1.4597976207733154
Epoch: 29, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.723 Vali Acc: 0.739 Test Loss: 0.723 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.459798812866211
Epoch: 30, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.707 Vali Acc: 0.767 Test Loss: 0.707 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 366575
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8956847190856934
Epoch: 1, Steps: 12 | Train Loss: 2.731 Vali Loss: 2.689 Vali Acc: 0.044 Test Loss: 2.689 Test Acc: 0.044
Validation loss decreased (inf --> -0.044418).  Saving model ...
Epoch: 2 cost time: 1.2755348682403564
Epoch: 2, Steps: 12 | Train Loss: 2.633 Vali Loss: 2.555 Vali Acc: 0.167 Test Loss: 2.555 Test Acc: 0.167
Validation loss decreased (-0.044418 --> -0.166641).  Saving model ...
Epoch: 3 cost time: 1.2981560230255127
Epoch: 3, Steps: 12 | Train Loss: 2.494 Vali Loss: 2.393 Vali Acc: 0.289 Test Loss: 2.393 Test Acc: 0.289
Validation loss decreased (-0.166641 --> -0.288865).  Saving model ...
Epoch: 4 cost time: 1.3100337982177734
Epoch: 4, Steps: 12 | Train Loss: 2.292 Vali Loss: 2.215 Vali Acc: 0.428 Test Loss: 2.215 Test Acc: 0.428
Validation loss decreased (-0.288865 --> -0.427756).  Saving model ...
Epoch: 5 cost time: 1.2774999141693115
Epoch: 5, Steps: 12 | Train Loss: 2.131 Vali Loss: 2.042 Vali Acc: 0.506 Test Loss: 2.042 Test Acc: 0.506
Validation loss decreased (-0.427756 --> -0.505535).  Saving model ...
Epoch: 6 cost time: 1.3260626792907715
Epoch: 6, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.864 Vali Acc: 0.550 Test Loss: 1.864 Test Acc: 0.550
Validation loss decreased (-0.505535 --> -0.549981).  Saving model ...
Epoch: 7 cost time: 1.3550934791564941
Epoch: 7, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.692 Vali Acc: 0.583 Test Loss: 1.692 Test Acc: 0.583
Validation loss decreased (-0.549981 --> -0.583316).  Saving model ...
Epoch: 8 cost time: 1.3364927768707275
Epoch: 8, Steps: 12 | Train Loss: 1.507 Vali Loss: 1.538 Vali Acc: 0.594 Test Loss: 1.538 Test Acc: 0.594
Validation loss decreased (-0.583316 --> -0.594429).  Saving model ...
Epoch: 9 cost time: 1.4160490036010742
Epoch: 9, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.401 Vali Acc: 0.600 Test Loss: 1.401 Test Acc: 0.600
Validation loss decreased (-0.594429 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 1.3412795066833496
Epoch: 10, Steps: 12 | Train Loss: 1.154 Vali Loss: 1.295 Vali Acc: 0.617 Test Loss: 1.295 Test Acc: 0.617
Validation loss decreased (-0.599986 --> -0.616654).  Saving model ...
Epoch: 11 cost time: 1.3574609756469727
Epoch: 11, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.202 Vali Acc: 0.611 Test Loss: 1.202 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.345794677734375
Epoch: 12, Steps: 12 | Train Loss: 0.920 Vali Loss: 1.100 Vali Acc: 0.639 Test Loss: 1.100 Test Acc: 0.639
Validation loss decreased (-0.616654 --> -0.638878).  Saving model ...
Epoch: 13 cost time: 1.441840648651123
Epoch: 13, Steps: 12 | Train Loss: 0.804 Vali Loss: 1.037 Vali Acc: 0.656 Test Loss: 1.037 Test Acc: 0.656
Validation loss decreased (-0.638878 --> -0.655545).  Saving model ...
Epoch: 14 cost time: 1.4127397537231445
Epoch: 14, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.992 Vali Acc: 0.694 Test Loss: 0.992 Test Acc: 0.694
Validation loss decreased (-0.655545 --> -0.694435).  Saving model ...
Epoch: 15 cost time: 1.312851905822754
Epoch: 15, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.944 Vali Acc: 0.667 Test Loss: 0.944 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3371047973632812
Epoch: 16, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.920 Vali Acc: 0.667 Test Loss: 0.920 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4364769458770752
Epoch: 17, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.863 Vali Acc: 0.694 Test Loss: 0.863 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694436).  Saving model ...
Epoch: 18 cost time: 1.367722988128662
Epoch: 18, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.851 Vali Acc: 0.694 Test Loss: 0.851 Test Acc: 0.694
Validation loss decreased (-0.694436 --> -0.694436).  Saving model ...
Epoch: 19 cost time: 1.3390460014343262
Epoch: 19, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.816 Vali Acc: 0.694 Test Loss: 0.816 Test Acc: 0.694
Validation loss decreased (-0.694436 --> -0.694436).  Saving model ...
Epoch: 20 cost time: 1.3325421810150146
Epoch: 20, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.785 Vali Acc: 0.711 Test Loss: 0.785 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711103).  Saving model ...
Epoch: 21 cost time: 1.4187347888946533
Epoch: 21, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
Validation loss decreased (-0.711103 --> -0.716659).  Saving model ...
Epoch: 22 cost time: 1.428175926208496
Epoch: 22, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.741 Vali Acc: 0.739 Test Loss: 0.741 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738881).  Saving model ...
Epoch: 23 cost time: 1.3775713443756104
Epoch: 23, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.713 Vali Acc: 0.744 Test Loss: 0.713 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 24 cost time: 1.3627293109893799
Epoch: 24, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.701 Vali Acc: 0.750 Test Loss: 0.701 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 25 cost time: 1.4626166820526123
Epoch: 25, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.672 Vali Acc: 0.772 Test Loss: 0.672 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772216).  Saving model ...
Epoch: 26 cost time: 1.3867096900939941
Epoch: 26, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.694 Vali Acc: 0.750 Test Loss: 0.694 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3349335193634033
Epoch: 27, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.697 Vali Acc: 0.772 Test Loss: 0.697 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3269665241241455
Epoch: 28, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.652 Vali Acc: 0.794 Test Loss: 0.652 Test Acc: 0.794
Validation loss decreased (-0.772216 --> -0.794438).  Saving model ...
Epoch: 29 cost time: 1.4643666744232178
Epoch: 29, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.716 Vali Acc: 0.767 Test Loss: 0.716 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4226720333099365
Epoch: 30, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.639 Vali Acc: 0.783 Test Loss: 0.639 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 1194223
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9462928771972656
Epoch: 1, Steps: 12 | Train Loss: 2.796 Vali Loss: 2.687 Vali Acc: 0.089 Test Loss: 2.687 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.3818330764770508
Epoch: 2, Steps: 12 | Train Loss: 2.634 Vali Loss: 2.545 Vali Acc: 0.122 Test Loss: 2.545 Test Acc: 0.122
Validation loss decreased (-0.088862 --> -0.122197).  Saving model ...
Epoch: 3 cost time: 1.3512721061706543
Epoch: 3, Steps: 12 | Train Loss: 2.475 Vali Loss: 2.372 Vali Acc: 0.306 Test Loss: 2.372 Test Acc: 0.306
Validation loss decreased (-0.122197 --> -0.305532).  Saving model ...
Epoch: 4 cost time: 1.2777369022369385
Epoch: 4, Steps: 12 | Train Loss: 2.299 Vali Loss: 2.194 Vali Acc: 0.422 Test Loss: 2.194 Test Acc: 0.422
Validation loss decreased (-0.305532 --> -0.422200).  Saving model ...
Epoch: 5 cost time: 1.2783839702606201
Epoch: 5, Steps: 12 | Train Loss: 2.077 Vali Loss: 2.021 Vali Acc: 0.500 Test Loss: 2.021 Test Acc: 0.500
Validation loss decreased (-0.422200 --> -0.499980).  Saving model ...
Epoch: 6 cost time: 1.3426542282104492
Epoch: 6, Steps: 12 | Train Loss: 1.879 Vali Loss: 1.858 Vali Acc: 0.539 Test Loss: 1.858 Test Acc: 0.539
Validation loss decreased (-0.499980 --> -0.538870).  Saving model ...
Epoch: 7 cost time: 1.2509732246398926
Epoch: 7, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.719 Vali Acc: 0.572 Test Loss: 1.719 Test Acc: 0.572
Validation loss decreased (-0.538870 --> -0.572205).  Saving model ...
Epoch: 8 cost time: 1.25529146194458
Epoch: 8, Steps: 12 | Train Loss: 1.519 Vali Loss: 1.576 Vali Acc: 0.611 Test Loss: 1.576 Test Acc: 0.611
Validation loss decreased (-0.572205 --> -0.611095).  Saving model ...
Epoch: 9 cost time: 1.315338373184204
Epoch: 9, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.460 Vali Acc: 0.600 Test Loss: 1.460 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2932493686676025
Epoch: 10, Steps: 12 | Train Loss: 1.196 Vali Loss: 1.345 Vali Acc: 0.617 Test Loss: 1.345 Test Acc: 0.617
Validation loss decreased (-0.611095 --> -0.616653).  Saving model ...
Epoch: 11 cost time: 1.233980417251587
Epoch: 11, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.259 Vali Acc: 0.617 Test Loss: 1.259 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616654).  Saving model ...
Epoch: 12 cost time: 1.2470080852508545
Epoch: 12, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.182 Vali Acc: 0.617 Test Loss: 1.182 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616655).  Saving model ...
Epoch: 13 cost time: 1.2332124710083008
Epoch: 13, Steps: 12 | Train Loss: 0.902 Vali Loss: 1.122 Vali Acc: 0.628 Test Loss: 1.122 Test Acc: 0.628
Validation loss decreased (-0.616655 --> -0.627767).  Saving model ...
Epoch: 14 cost time: 1.258138656616211
Epoch: 14, Steps: 12 | Train Loss: 0.805 Vali Loss: 1.063 Vali Acc: 0.644 Test Loss: 1.063 Test Acc: 0.644
Validation loss decreased (-0.627767 --> -0.644434).  Saving model ...
Epoch: 15 cost time: 1.268355131149292
Epoch: 15, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.989 Vali Acc: 0.661 Test Loss: 0.989 Test Acc: 0.661
Validation loss decreased (-0.644434 --> -0.661101).  Saving model ...
Epoch: 16 cost time: 1.2294542789459229
Epoch: 16, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.949 Vali Acc: 0.661 Test Loss: 0.949 Test Acc: 0.661
Validation loss decreased (-0.661101 --> -0.661102).  Saving model ...
Epoch: 17 cost time: 1.2642388343811035
Epoch: 17, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.918 Vali Acc: 0.667 Test Loss: 0.918 Test Acc: 0.667
Validation loss decreased (-0.661102 --> -0.666657).  Saving model ...
Epoch: 18 cost time: 1.2873656749725342
Epoch: 18, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.886 Vali Acc: 0.700 Test Loss: 0.886 Test Acc: 0.700
Validation loss decreased (-0.666657 --> -0.699991).  Saving model ...
Epoch: 19 cost time: 1.338219165802002
Epoch: 19, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.869 Vali Acc: 0.706 Test Loss: 0.869 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705547).  Saving model ...
Epoch: 20 cost time: 1.1919941902160645
Epoch: 20, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.849 Vali Acc: 0.722 Test Loss: 0.849 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722214).  Saving model ...
Epoch: 21 cost time: 1.2584419250488281
Epoch: 21, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.851 Vali Acc: 0.711 Test Loss: 0.851 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2838082313537598
Epoch: 22, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.845 Vali Acc: 0.722 Test Loss: 0.845 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 23 cost time: 1.3069324493408203
Epoch: 23, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.815 Vali Acc: 0.739 Test Loss: 0.815 Test Acc: 0.739
Validation loss decreased (-0.722214 --> -0.738881).  Saving model ...
Epoch: 24 cost time: 1.3361258506774902
Epoch: 24, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.798 Vali Acc: 0.728 Test Loss: 0.798 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2718212604522705
Epoch: 25, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.776 Vali Acc: 0.744 Test Loss: 0.776 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 26 cost time: 1.2988181114196777
Epoch: 26, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.770 Vali Acc: 0.739 Test Loss: 0.770 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2743544578552246
Epoch: 27, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.767 Vali Acc: 0.756 Test Loss: 0.767 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 28 cost time: 1.0794951915740967
Epoch: 28, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.742 Vali Acc: 0.778 Test Loss: 0.742 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777770).  Saving model ...
Epoch: 29 cost time: 1.0801329612731934
Epoch: 29, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.747 Vali Acc: 0.761 Test Loss: 0.747 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0563175678253174
Epoch: 30, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.752 Vali Acc: 0.761 Test Loss: 0.752 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 366575
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8630306720733643
Epoch: 1, Steps: 12 | Train Loss: 2.825 Vali Loss: 2.779 Vali Acc: 0.106 Test Loss: 2.779 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 2.191016912460327
Epoch: 2, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.689 Vali Acc: 0.167 Test Loss: 2.689 Test Acc: 0.167
Validation loss decreased (-0.105528 --> -0.166640).  Saving model ...
Epoch: 3 cost time: 2.1871681213378906
Epoch: 3, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.571 Vali Acc: 0.161 Test Loss: 2.571 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1229441165924072
Epoch: 4, Steps: 12 | Train Loss: 2.523 Vali Loss: 2.439 Vali Acc: 0.233 Test Loss: 2.439 Test Acc: 0.233
Validation loss decreased (-0.166640 --> -0.233309).  Saving model ...
Epoch: 5 cost time: 2.274933338165283
Epoch: 5, Steps: 12 | Train Loss: 2.359 Vali Loss: 2.285 Vali Acc: 0.350 Test Loss: 2.285 Test Acc: 0.350
Validation loss decreased (-0.233309 --> -0.349977).  Saving model ...
Epoch: 6 cost time: 2.126117706298828
Epoch: 6, Steps: 12 | Train Loss: 2.157 Vali Loss: 2.122 Vali Acc: 0.428 Test Loss: 2.122 Test Acc: 0.428
Validation loss decreased (-0.349977 --> -0.427757).  Saving model ...
Epoch: 7 cost time: 2.2496345043182373
Epoch: 7, Steps: 12 | Train Loss: 1.968 Vali Loss: 1.956 Vali Acc: 0.467 Test Loss: 1.956 Test Acc: 0.467
Validation loss decreased (-0.427757 --> -0.466647).  Saving model ...
Epoch: 8 cost time: 2.227451801300049
Epoch: 8, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.794 Vali Acc: 0.500 Test Loss: 1.794 Test Acc: 0.500
Validation loss decreased (-0.466647 --> -0.499982).  Saving model ...
Epoch: 9 cost time: 2.1008152961730957
Epoch: 9, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.639 Vali Acc: 0.539 Test Loss: 1.639 Test Acc: 0.539
Validation loss decreased (-0.499982 --> -0.538873).  Saving model ...
Epoch: 10 cost time: 2.11175799369812
Epoch: 10, Steps: 12 | Train Loss: 1.405 Vali Loss: 1.498 Vali Acc: 0.567 Test Loss: 1.498 Test Acc: 0.567
Validation loss decreased (-0.538873 --> -0.566652).  Saving model ...
Epoch: 11 cost time: 2.234009027481079
Epoch: 11, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.386 Vali Acc: 0.594 Test Loss: 1.386 Test Acc: 0.594
Validation loss decreased (-0.566652 --> -0.594431).  Saving model ...
Epoch: 12 cost time: 2.2020366191864014
Epoch: 12, Steps: 12 | Train Loss: 1.156 Vali Loss: 1.286 Vali Acc: 0.606 Test Loss: 1.286 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605543).  Saving model ...
Epoch: 13 cost time: 2.104743480682373
Epoch: 13, Steps: 12 | Train Loss: 1.025 Vali Loss: 1.194 Vali Acc: 0.611 Test Loss: 1.194 Test Acc: 0.611
Validation loss decreased (-0.605543 --> -0.611099).  Saving model ...
Epoch: 14 cost time: 1.9941976070404053
Epoch: 14, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.117 Vali Acc: 0.611 Test Loss: 1.117 Test Acc: 0.611
Validation loss decreased (-0.611099 --> -0.611100).  Saving model ...
Epoch: 15 cost time: 1.897871494293213
Epoch: 15, Steps: 12 | Train Loss: 0.786 Vali Loss: 1.066 Vali Acc: 0.639 Test Loss: 1.066 Test Acc: 0.639
Validation loss decreased (-0.611100 --> -0.638878).  Saving model ...
Epoch: 16 cost time: 1.879760980606079
Epoch: 16, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.987 Vali Acc: 0.650 Test Loss: 0.987 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649990).  Saving model ...
Epoch: 17 cost time: 1.98193359375
Epoch: 17, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.950 Vali Acc: 0.656 Test Loss: 0.950 Test Acc: 0.656
Validation loss decreased (-0.649990 --> -0.655546).  Saving model ...
Epoch: 18 cost time: 1.9158132076263428
Epoch: 18, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.938 Vali Acc: 0.661 Test Loss: 0.938 Test Acc: 0.661
Validation loss decreased (-0.655546 --> -0.661102).  Saving model ...
Epoch: 19 cost time: 1.8724391460418701
Epoch: 19, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.892 Vali Acc: 0.678 Test Loss: 0.892 Test Acc: 0.678
Validation loss decreased (-0.661102 --> -0.677769).  Saving model ...
Epoch: 20 cost time: 1.9838461875915527
Epoch: 20, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.857 Vali Acc: 0.672 Test Loss: 0.857 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.925102710723877
Epoch: 21, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.816 Vali Acc: 0.694 Test Loss: 0.816 Test Acc: 0.694
Validation loss decreased (-0.677769 --> -0.694436).  Saving model ...
Epoch: 22 cost time: 1.904109001159668
Epoch: 22, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.796 Vali Acc: 0.706 Test Loss: 0.796 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705548).  Saving model ...
Epoch: 23 cost time: 2.1621763706207275
Epoch: 23, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.780 Vali Acc: 0.700 Test Loss: 0.780 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.067817449569702
Epoch: 24, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.769 Vali Acc: 0.706 Test Loss: 0.769 Test Acc: 0.706
Validation loss decreased (-0.705548 --> -0.705548).  Saving model ...
Epoch: 25 cost time: 2.052138566970825
Epoch: 25, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.725 Vali Acc: 0.739 Test Loss: 0.725 Test Acc: 0.739
Validation loss decreased (-0.705548 --> -0.738882).  Saving model ...
Epoch: 26 cost time: 2.129934072494507
Epoch: 26, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.719 Vali Acc: 0.717 Test Loss: 0.719 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.16264009475708
Epoch: 27, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.711 Vali Acc: 0.739 Test Loss: 0.711 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738882).  Saving model ...
Epoch: 28 cost time: 2.0631601810455322
Epoch: 28, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.688 Vali Acc: 0.744 Test Loss: 0.688 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 29 cost time: 2.0723235607147217
Epoch: 29, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.700 Vali Acc: 0.744 Test Loss: 0.700 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.073918342590332
Epoch: 30, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.663 Vali Acc: 0.744 Test Loss: 0.663 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 1183423
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.189312219619751
Epoch: 1, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.653 Vali Acc: 0.144 Test Loss: 2.653 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 1.574493646621704
Epoch: 2, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.568 Vali Acc: 0.183 Test Loss: 2.568 Test Acc: 0.183
Validation loss decreased (-0.144418 --> -0.183308).  Saving model ...
Epoch: 3 cost time: 1.5334107875823975
Epoch: 3, Steps: 12 | Train Loss: 2.475 Vali Loss: 2.454 Vali Acc: 0.339 Test Loss: 2.454 Test Acc: 0.339
Validation loss decreased (-0.183308 --> -0.338864).  Saving model ...
Epoch: 4 cost time: 1.5366876125335693
Epoch: 4, Steps: 12 | Train Loss: 2.379 Vali Loss: 2.322 Vali Acc: 0.389 Test Loss: 2.322 Test Acc: 0.389
Validation loss decreased (-0.338864 --> -0.388866).  Saving model ...
Epoch: 5 cost time: 1.426182746887207
Epoch: 5, Steps: 12 | Train Loss: 2.210 Vali Loss: 2.177 Vali Acc: 0.428 Test Loss: 2.177 Test Acc: 0.428
Validation loss decreased (-0.388866 --> -0.427756).  Saving model ...
Epoch: 6 cost time: 1.3668951988220215
Epoch: 6, Steps: 12 | Train Loss: 2.036 Vali Loss: 2.028 Vali Acc: 0.478 Test Loss: 2.028 Test Acc: 0.478
Validation loss decreased (-0.427756 --> -0.477757).  Saving model ...
Epoch: 7 cost time: 1.443342924118042
Epoch: 7, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.878 Vali Acc: 0.528 Test Loss: 1.878 Test Acc: 0.528
Validation loss decreased (-0.477757 --> -0.527759).  Saving model ...
Epoch: 8 cost time: 1.4094557762145996
Epoch: 8, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.735 Vali Acc: 0.578 Test Loss: 1.735 Test Acc: 0.578
Validation loss decreased (-0.527759 --> -0.577760).  Saving model ...
Epoch: 9 cost time: 1.3923735618591309
Epoch: 9, Steps: 12 | Train Loss: 1.529 Vali Loss: 1.596 Vali Acc: 0.594 Test Loss: 1.596 Test Acc: 0.594
Validation loss decreased (-0.577760 --> -0.594428).  Saving model ...
Epoch: 10 cost time: 1.248037338256836
Epoch: 10, Steps: 12 | Train Loss: 1.374 Vali Loss: 1.472 Vali Acc: 0.600 Test Loss: 1.472 Test Acc: 0.600
Validation loss decreased (-0.594428 --> -0.599985).  Saving model ...
Epoch: 11 cost time: 1.4709358215332031
Epoch: 11, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.365 Vali Acc: 0.617 Test Loss: 1.365 Test Acc: 0.617
Validation loss decreased (-0.599985 --> -0.616653).  Saving model ...
Epoch: 12 cost time: 1.4659311771392822
Epoch: 12, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.259 Vali Acc: 0.606 Test Loss: 1.259 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4931538105010986
Epoch: 13, Steps: 12 | Train Loss: 1.022 Vali Loss: 1.174 Vali Acc: 0.606 Test Loss: 1.174 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4314546585083008
Epoch: 14, Steps: 12 | Train Loss: 0.917 Vali Loss: 1.103 Vali Acc: 0.628 Test Loss: 1.103 Test Acc: 0.628
Validation loss decreased (-0.616653 --> -0.627767).  Saving model ...
Epoch: 15 cost time: 1.628654956817627
Epoch: 15, Steps: 12 | Train Loss: 0.775 Vali Loss: 1.038 Vali Acc: 0.639 Test Loss: 1.038 Test Acc: 0.639
Validation loss decreased (-0.627767 --> -0.638879).  Saving model ...
Epoch: 16 cost time: 1.6098825931549072
Epoch: 16, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.980 Vali Acc: 0.661 Test Loss: 0.980 Test Acc: 0.661
Validation loss decreased (-0.638879 --> -0.661101).  Saving model ...
Epoch: 17 cost time: 1.6615395545959473
Epoch: 17, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.928 Vali Acc: 0.661 Test Loss: 0.928 Test Acc: 0.661
Validation loss decreased (-0.661101 --> -0.661102).  Saving model ...
Epoch: 18 cost time: 1.654280424118042
Epoch: 18, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.899 Vali Acc: 0.672 Test Loss: 0.899 Test Acc: 0.672
Validation loss decreased (-0.661102 --> -0.672213).  Saving model ...
Epoch: 19 cost time: 1.6473145484924316
Epoch: 19, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.864 Vali Acc: 0.700 Test Loss: 0.864 Test Acc: 0.700
Validation loss decreased (-0.672213 --> -0.699991).  Saving model ...
Epoch: 20 cost time: 1.6449027061462402
Epoch: 20, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.833 Vali Acc: 0.694 Test Loss: 0.833 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6063244342803955
Epoch: 21, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.816 Vali Acc: 0.683 Test Loss: 0.816 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6366117000579834
Epoch: 22, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.808 Vali Acc: 0.694 Test Loss: 0.808 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6104633808135986
Epoch: 23, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.779 Vali Acc: 0.700 Test Loss: 0.779 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 24 cost time: 1.6036202907562256
Epoch: 24, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.764 Vali Acc: 0.744 Test Loss: 0.764 Test Acc: 0.744
Validation loss decreased (-0.699992 --> -0.744437).  Saving model ...
Epoch: 25 cost time: 1.7611758708953857
Epoch: 25, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.750 Vali Acc: 0.744 Test Loss: 0.750 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 26 cost time: 1.6390588283538818
Epoch: 26, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.745 Vali Acc: 0.733 Test Loss: 0.745 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6432130336761475
Epoch: 27, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.742 Vali Acc: 0.756 Test Loss: 0.742 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 28 cost time: 1.6779639720916748
Epoch: 28, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.731 Vali Acc: 0.739 Test Loss: 0.731 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6211199760437012
Epoch: 29, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.722 Vali Acc: 0.767 Test Loss: 0.722 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766659).  Saving model ...
Epoch: 30 cost time: 1.6448254585266113
Epoch: 30, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.722 Vali Acc: 0.772 Test Loss: 0.722 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 355711
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1012063026428223
Epoch: 1, Steps: 12 | Train Loss: 2.825 Vali Loss: 2.779 Vali Acc: 0.117 Test Loss: 2.779 Test Acc: 0.117
Validation loss decreased (inf --> -0.116639).  Saving model ...
Epoch: 2 cost time: 1.6670713424682617
Epoch: 2, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.689 Vali Acc: 0.156 Test Loss: 2.689 Test Acc: 0.156
Validation loss decreased (-0.116639 --> -0.155529).  Saving model ...
Epoch: 3 cost time: 1.6542093753814697
Epoch: 3, Steps: 12 | Train Loss: 2.643 Vali Loss: 2.571 Vali Acc: 0.161 Test Loss: 2.571 Test Acc: 0.161
Validation loss decreased (-0.155529 --> -0.161085).  Saving model ...
Epoch: 4 cost time: 1.6436820030212402
Epoch: 4, Steps: 12 | Train Loss: 2.524 Vali Loss: 2.440 Vali Acc: 0.222 Test Loss: 2.440 Test Acc: 0.222
Validation loss decreased (-0.161085 --> -0.222198).  Saving model ...
Epoch: 5 cost time: 1.6548588275909424
Epoch: 5, Steps: 12 | Train Loss: 2.360 Vali Loss: 2.287 Vali Acc: 0.344 Test Loss: 2.287 Test Acc: 0.344
Validation loss decreased (-0.222198 --> -0.344422).  Saving model ...
Epoch: 6 cost time: 1.625640869140625
Epoch: 6, Steps: 12 | Train Loss: 2.157 Vali Loss: 2.124 Vali Acc: 0.428 Test Loss: 2.124 Test Acc: 0.428
Validation loss decreased (-0.344422 --> -0.427757).  Saving model ...
Epoch: 7 cost time: 1.6491668224334717
Epoch: 7, Steps: 12 | Train Loss: 1.971 Vali Loss: 1.959 Vali Acc: 0.467 Test Loss: 1.959 Test Acc: 0.467
Validation loss decreased (-0.427757 --> -0.466647).  Saving model ...
Epoch: 8 cost time: 1.877274751663208
Epoch: 8, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.797 Vali Acc: 0.500 Test Loss: 1.797 Test Acc: 0.500
Validation loss decreased (-0.466647 --> -0.499982).  Saving model ...
Epoch: 9 cost time: 1.788694143295288
Epoch: 9, Steps: 12 | Train Loss: 1.624 Vali Loss: 1.643 Vali Acc: 0.539 Test Loss: 1.643 Test Acc: 0.539
Validation loss decreased (-0.499982 --> -0.538872).  Saving model ...
Epoch: 10 cost time: 1.7807824611663818
Epoch: 10, Steps: 12 | Train Loss: 1.407 Vali Loss: 1.507 Vali Acc: 0.567 Test Loss: 1.507 Test Acc: 0.567
Validation loss decreased (-0.538872 --> -0.566652).  Saving model ...
Epoch: 11 cost time: 1.8418750762939453
Epoch: 11, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.396 Vali Acc: 0.583 Test Loss: 1.396 Test Acc: 0.583
Validation loss decreased (-0.566652 --> -0.583319).  Saving model ...
Epoch: 12 cost time: 1.7869873046875
Epoch: 12, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.297 Vali Acc: 0.611 Test Loss: 1.297 Test Acc: 0.611
Validation loss decreased (-0.583319 --> -0.611098).  Saving model ...
Epoch: 13 cost time: 1.814415693283081
Epoch: 13, Steps: 12 | Train Loss: 1.030 Vali Loss: 1.206 Vali Acc: 0.622 Test Loss: 1.206 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622210).  Saving model ...
Epoch: 14 cost time: 1.8162555694580078
Epoch: 14, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.127 Vali Acc: 0.617 Test Loss: 1.127 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8183443546295166
Epoch: 15, Steps: 12 | Train Loss: 0.791 Vali Loss: 1.075 Vali Acc: 0.633 Test Loss: 1.075 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633323).  Saving model ...
Epoch: 16 cost time: 1.8102242946624756
Epoch: 16, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.999 Vali Acc: 0.650 Test Loss: 0.999 Test Acc: 0.650
Validation loss decreased (-0.633323 --> -0.649990).  Saving model ...
Epoch: 17 cost time: 1.7837824821472168
Epoch: 17, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.957 Vali Acc: 0.656 Test Loss: 0.957 Test Acc: 0.656
Validation loss decreased (-0.649990 --> -0.655546).  Saving model ...
Epoch: 18 cost time: 1.8250806331634521
Epoch: 18, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.945 Vali Acc: 0.667 Test Loss: 0.945 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666657).  Saving model ...
Epoch: 19 cost time: 1.9328153133392334
Epoch: 19, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.896 Vali Acc: 0.661 Test Loss: 0.896 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.819810152053833
Epoch: 20, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.861 Vali Acc: 0.672 Test Loss: 0.861 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672214).  Saving model ...
Epoch: 21 cost time: 1.8338406085968018
Epoch: 21, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.829 Vali Acc: 0.689 Test Loss: 0.829 Test Acc: 0.689
Validation loss decreased (-0.672214 --> -0.688881).  Saving model ...
Epoch: 22 cost time: 1.7960991859436035
Epoch: 22, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.806 Vali Acc: 0.700 Test Loss: 0.806 Test Acc: 0.700
Validation loss decreased (-0.688881 --> -0.699992).  Saving model ...
Epoch: 23 cost time: 1.776885747909546
Epoch: 23, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.786 Vali Acc: 0.706 Test Loss: 0.786 Test Acc: 0.706
Validation loss decreased (-0.699992 --> -0.705548).  Saving model ...
Epoch: 24 cost time: 1.5767509937286377
Epoch: 24, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.778 Vali Acc: 0.700 Test Loss: 0.778 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6421477794647217
Epoch: 25, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.730 Vali Acc: 0.728 Test Loss: 0.730 Test Acc: 0.728
Validation loss decreased (-0.705548 --> -0.727770).  Saving model ...
Epoch: 26 cost time: 1.5687594413757324
Epoch: 26, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.726 Vali Acc: 0.717 Test Loss: 0.726 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6730611324310303
Epoch: 27, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.723 Vali Acc: 0.739 Test Loss: 0.723 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738882).  Saving model ...
Epoch: 28 cost time: 1.6392369270324707
Epoch: 28, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.697 Vali Acc: 0.744 Test Loss: 0.697 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744437).  Saving model ...
Epoch: 29 cost time: 1.6512346267700195
Epoch: 29, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.699 Vali Acc: 0.750 Test Loss: 0.699 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 30 cost time: 1.693077564239502
Epoch: 30, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.671 Vali Acc: 0.744 Test Loss: 0.671 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 1183423
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.082257032394409
Epoch: 1, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.653 Vali Acc: 0.144 Test Loss: 2.653 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 1.4739916324615479
Epoch: 2, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.568 Vali Acc: 0.183 Test Loss: 2.568 Test Acc: 0.183
Validation loss decreased (-0.144418 --> -0.183308).  Saving model ...
Epoch: 3 cost time: 1.4841153621673584
Epoch: 3, Steps: 12 | Train Loss: 2.475 Vali Loss: 2.454 Vali Acc: 0.339 Test Loss: 2.454 Test Acc: 0.339
Validation loss decreased (-0.183308 --> -0.338864).  Saving model ...
Epoch: 4 cost time: 1.5483896732330322
Epoch: 4, Steps: 12 | Train Loss: 2.380 Vali Loss: 2.322 Vali Acc: 0.389 Test Loss: 2.322 Test Acc: 0.389
Validation loss decreased (-0.338864 --> -0.388866).  Saving model ...
Epoch: 5 cost time: 1.45401930809021
Epoch: 5, Steps: 12 | Train Loss: 2.210 Vali Loss: 2.177 Vali Acc: 0.428 Test Loss: 2.177 Test Acc: 0.428
Validation loss decreased (-0.388866 --> -0.427756).  Saving model ...
Epoch: 6 cost time: 1.507021188735962
Epoch: 6, Steps: 12 | Train Loss: 2.036 Vali Loss: 2.029 Vali Acc: 0.478 Test Loss: 2.029 Test Acc: 0.478
Validation loss decreased (-0.427756 --> -0.477757).  Saving model ...
Epoch: 7 cost time: 1.5466244220733643
Epoch: 7, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.878 Vali Acc: 0.528 Test Loss: 1.878 Test Acc: 0.528
Validation loss decreased (-0.477757 --> -0.527759).  Saving model ...
Epoch: 8 cost time: 1.4638574123382568
Epoch: 8, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.735 Vali Acc: 0.578 Test Loss: 1.735 Test Acc: 0.578
Validation loss decreased (-0.527759 --> -0.577760).  Saving model ...
Epoch: 9 cost time: 1.6000697612762451
Epoch: 9, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.595 Vali Acc: 0.583 Test Loss: 1.595 Test Acc: 0.583
Validation loss decreased (-0.577760 --> -0.583317).  Saving model ...
Epoch: 10 cost time: 1.4833219051361084
Epoch: 10, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.472 Vali Acc: 0.600 Test Loss: 1.472 Test Acc: 0.600
Validation loss decreased (-0.583317 --> -0.599985).  Saving model ...
Epoch: 11 cost time: 1.4537935256958008
Epoch: 11, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.366 Vali Acc: 0.611 Test Loss: 1.366 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611097).  Saving model ...
Epoch: 12 cost time: 1.5259757041931152
Epoch: 12, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.260 Vali Acc: 0.600 Test Loss: 1.260 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.239732265472412
Epoch: 13, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.176 Vali Acc: 0.606 Test Loss: 1.176 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3910784721374512
Epoch: 14, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.108 Vali Acc: 0.628 Test Loss: 1.108 Test Acc: 0.628
Validation loss decreased (-0.611097 --> -0.627767).  Saving model ...
Epoch: 15 cost time: 1.3915655612945557
Epoch: 15, Steps: 12 | Train Loss: 0.802 Vali Loss: 1.048 Vali Acc: 0.639 Test Loss: 1.048 Test Acc: 0.639
Validation loss decreased (-0.627767 --> -0.638878).  Saving model ...
Epoch: 16 cost time: 1.3604934215545654
Epoch: 16, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.991 Vali Acc: 0.661 Test Loss: 0.991 Test Acc: 0.661
Validation loss decreased (-0.638878 --> -0.661101).  Saving model ...
Epoch: 17 cost time: 1.2222208976745605
Epoch: 17, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.940 Vali Acc: 0.656 Test Loss: 0.940 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2936437129974365
Epoch: 18, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.904 Vali Acc: 0.667 Test Loss: 0.904 Test Acc: 0.667
Validation loss decreased (-0.661101 --> -0.666658).  Saving model ...
Epoch: 19 cost time: 1.218040943145752
Epoch: 19, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.867 Vali Acc: 0.683 Test Loss: 0.867 Test Acc: 0.683
Validation loss decreased (-0.666658 --> -0.683325).  Saving model ...
Epoch: 20 cost time: 1.2454149723052979
Epoch: 20, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.827 Vali Acc: 0.683 Test Loss: 0.827 Test Acc: 0.683
Validation loss decreased (-0.683325 --> -0.683325).  Saving model ...
Epoch: 21 cost time: 1.2634508609771729
Epoch: 21, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.807 Vali Acc: 0.683 Test Loss: 0.807 Test Acc: 0.683
Validation loss decreased (-0.683325 --> -0.683325).  Saving model ...
Epoch: 22 cost time: 1.2903501987457275
Epoch: 22, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.794 Vali Acc: 0.683 Test Loss: 0.794 Test Acc: 0.683
Validation loss decreased (-0.683325 --> -0.683325).  Saving model ...
Epoch: 23 cost time: 1.3060991764068604
Epoch: 23, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.761 Vali Acc: 0.694 Test Loss: 0.761 Test Acc: 0.694
Validation loss decreased (-0.683325 --> -0.694437).  Saving model ...
Epoch: 24 cost time: 1.3024258613586426
Epoch: 24, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.735 Vali Acc: 0.728 Test Loss: 0.735 Test Acc: 0.728
Validation loss decreased (-0.694437 --> -0.727770).  Saving model ...
Epoch: 25 cost time: 1.2405178546905518
Epoch: 25, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.727 Vali Acc: 0.722 Test Loss: 0.727 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.326660394668579
Epoch: 26, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.715 Vali Acc: 0.711 Test Loss: 0.715 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3985393047332764
Epoch: 27, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.711 Vali Acc: 0.733 Test Loss: 0.711 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733326).  Saving model ...
Epoch: 28 cost time: 1.4649853706359863
Epoch: 28, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.695 Vali Acc: 0.728 Test Loss: 0.695 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4595484733581543
Epoch: 29, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.698 Vali Acc: 0.761 Test Loss: 0.698 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761104).  Saving model ...
Epoch: 30 cost time: 1.4211194515228271
Epoch: 30, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.697 Vali Acc: 0.767 Test Loss: 0.697 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 355711
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8587543964385986
Epoch: 1, Steps: 12 | Train Loss: 2.822 Vali Loss: 2.784 Vali Acc: 0.117 Test Loss: 2.784 Test Acc: 0.117
Validation loss decreased (inf --> -0.116639).  Saving model ...
Epoch: 2 cost time: 1.2983605861663818
Epoch: 2, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.710 Vali Acc: 0.128 Test Loss: 2.710 Test Acc: 0.128
Validation loss decreased (-0.116639 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 1.3414855003356934
Epoch: 3, Steps: 12 | Train Loss: 2.669 Vali Loss: 2.610 Vali Acc: 0.111 Test Loss: 2.610 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3357610702514648
Epoch: 4, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.502 Vali Acc: 0.161 Test Loss: 2.502 Test Acc: 0.161
Validation loss decreased (-0.127751 --> -0.161086).  Saving model ...
Epoch: 5 cost time: 1.3972325325012207
Epoch: 5, Steps: 12 | Train Loss: 2.443 Vali Loss: 2.371 Vali Acc: 0.278 Test Loss: 2.371 Test Acc: 0.278
Validation loss decreased (-0.161086 --> -0.277754).  Saving model ...
Epoch: 6 cost time: 1.2922089099884033
Epoch: 6, Steps: 12 | Train Loss: 2.289 Vali Loss: 2.241 Vali Acc: 0.372 Test Loss: 2.241 Test Acc: 0.372
Validation loss decreased (-0.277754 --> -0.372200).  Saving model ...
Epoch: 7 cost time: 1.2991228103637695
Epoch: 7, Steps: 12 | Train Loss: 2.151 Vali Loss: 2.115 Vali Acc: 0.444 Test Loss: 2.115 Test Acc: 0.444
Validation loss decreased (-0.372200 --> -0.444423).  Saving model ...
Epoch: 8 cost time: 1.412318229675293
Epoch: 8, Steps: 12 | Train Loss: 1.986 Vali Loss: 1.988 Vali Acc: 0.522 Test Loss: 1.988 Test Acc: 0.522
Validation loss decreased (-0.444423 --> -0.522202).  Saving model ...
Epoch: 9 cost time: 1.304291009902954
Epoch: 9, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.869 Vali Acc: 0.556 Test Loss: 1.869 Test Acc: 0.556
Validation loss decreased (-0.522202 --> -0.555537).  Saving model ...
Epoch: 10 cost time: 1.2778401374816895
Epoch: 10, Steps: 12 | Train Loss: 1.720 Vali Loss: 1.761 Vali Acc: 0.556 Test Loss: 1.761 Test Acc: 0.556
Validation loss decreased (-0.555537 --> -0.555538).  Saving model ...
Epoch: 11 cost time: 1.1976511478424072
Epoch: 11, Steps: 12 | Train Loss: 1.571 Vali Loss: 1.663 Vali Acc: 0.583 Test Loss: 1.663 Test Acc: 0.583
Validation loss decreased (-0.555538 --> -0.583317).  Saving model ...
Epoch: 12 cost time: 1.1919474601745605
Epoch: 12, Steps: 12 | Train Loss: 1.464 Vali Loss: 1.553 Vali Acc: 0.572 Test Loss: 1.553 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1874809265136719
Epoch: 13, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.449 Vali Acc: 0.606 Test Loss: 1.449 Test Acc: 0.606
Validation loss decreased (-0.583317 --> -0.605541).  Saving model ...
Epoch: 14 cost time: 1.210120677947998
Epoch: 14, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.360 Vali Acc: 0.600 Test Loss: 1.360 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.19392991065979
Epoch: 15, Steps: 12 | Train Loss: 1.063 Vali Loss: 1.328 Vali Acc: 0.606 Test Loss: 1.328 Test Acc: 0.606
Validation loss decreased (-0.605541 --> -0.605542).  Saving model ...
Epoch: 16 cost time: 1.1350624561309814
Epoch: 16, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.211 Vali Acc: 0.644 Test Loss: 1.211 Test Acc: 0.644
Validation loss decreased (-0.605542 --> -0.644432).  Saving model ...
Epoch: 17 cost time: 1.1719894409179688
Epoch: 17, Steps: 12 | Train Loss: 0.920 Vali Loss: 1.150 Vali Acc: 0.650 Test Loss: 1.150 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649989).  Saving model ...
Epoch: 18 cost time: 1.2246990203857422
Epoch: 18, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.092 Vali Acc: 0.656 Test Loss: 1.092 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655545).  Saving model ...
Epoch: 19 cost time: 1.309854507446289
Epoch: 19, Steps: 12 | Train Loss: 0.748 Vali Loss: 1.024 Vali Acc: 0.650 Test Loss: 1.024 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2171447277069092
Epoch: 20, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.991 Vali Acc: 0.644 Test Loss: 0.991 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.219937801361084
Epoch: 21, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.950 Vali Acc: 0.656 Test Loss: 0.950 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655546).  Saving model ...
Epoch: 22 cost time: 1.317953109741211
Epoch: 22, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.933 Vali Acc: 0.667 Test Loss: 0.933 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666657).  Saving model ...
Epoch: 23 cost time: 1.2925448417663574
Epoch: 23, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.890 Vali Acc: 0.650 Test Loss: 0.890 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.350527048110962
Epoch: 24, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.902 Vali Acc: 0.661 Test Loss: 0.902 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2871756553649902
Epoch: 25, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.830 Vali Acc: 0.678 Test Loss: 0.830 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677769).  Saving model ...
Epoch: 26 cost time: 1.3448529243469238
Epoch: 26, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.838 Vali Acc: 0.672 Test Loss: 0.838 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3023357391357422
Epoch: 27, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.808 Vali Acc: 0.672 Test Loss: 0.808 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2934839725494385
Epoch: 28, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.791 Vali Acc: 0.694 Test Loss: 0.791 Test Acc: 0.694
Validation loss decreased (-0.677769 --> -0.694437).  Saving model ...
Epoch: 29 cost time: 1.3310604095458984
Epoch: 29, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.769 Vali Acc: 0.717 Test Loss: 0.769 Test Acc: 0.717
Validation loss decreased (-0.694437 --> -0.716659).  Saving model ...
Epoch: 30 cost time: 1.3521685600280762
Epoch: 30, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.749 Vali Acc: 0.733 Test Loss: 0.749 Test Acc: 0.733
Validation loss decreased (-0.716659 --> -0.733326).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7333333333333333
model parameter : 1183423
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.790330171585083
Epoch: 1, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.656 Vali Acc: 0.139 Test Loss: 2.656 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 1.2107162475585938
Epoch: 2, Steps: 12 | Train Loss: 2.623 Vali Loss: 2.580 Vali Acc: 0.172 Test Loss: 2.580 Test Acc: 0.172
Validation loss decreased (-0.138862 --> -0.172196).  Saving model ...
Epoch: 3 cost time: 1.0551722049713135
Epoch: 3, Steps: 12 | Train Loss: 2.503 Vali Loss: 2.479 Vali Acc: 0.311 Test Loss: 2.479 Test Acc: 0.311
Validation loss decreased (-0.172196 --> -0.311086).  Saving model ...
Epoch: 4 cost time: 1.0949678421020508
Epoch: 4, Steps: 12 | Train Loss: 2.421 Vali Loss: 2.368 Vali Acc: 0.339 Test Loss: 2.368 Test Acc: 0.339
Validation loss decreased (-0.311086 --> -0.338865).  Saving model ...
Epoch: 5 cost time: 1.1093246936798096
Epoch: 5, Steps: 12 | Train Loss: 2.278 Vali Loss: 2.243 Vali Acc: 0.400 Test Loss: 2.243 Test Acc: 0.400
Validation loss decreased (-0.338865 --> -0.399978).  Saving model ...
Epoch: 6 cost time: 1.0725986957550049
Epoch: 6, Steps: 12 | Train Loss: 2.142 Vali Loss: 2.115 Vali Acc: 0.456 Test Loss: 2.115 Test Acc: 0.456
Validation loss decreased (-0.399978 --> -0.455534).  Saving model ...
Epoch: 7 cost time: 0.9413526058197021
Epoch: 7, Steps: 12 | Train Loss: 1.995 Vali Loss: 1.987 Vali Acc: 0.478 Test Loss: 1.987 Test Acc: 0.478
Validation loss decreased (-0.455534 --> -0.477758).  Saving model ...
Epoch: 8 cost time: 1.1001503467559814
Epoch: 8, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.864 Vali Acc: 0.522 Test Loss: 1.864 Test Acc: 0.522
Validation loss decreased (-0.477758 --> -0.522204).  Saving model ...
Epoch: 9 cost time: 1.0098512172698975
Epoch: 9, Steps: 12 | Train Loss: 1.699 Vali Loss: 1.745 Vali Acc: 0.583 Test Loss: 1.745 Test Acc: 0.583
Validation loss decreased (-0.522204 --> -0.583316).  Saving model ...
Epoch: 10 cost time: 0.9867446422576904
Epoch: 10, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.643 Vali Acc: 0.583 Test Loss: 1.643 Test Acc: 0.583
Validation loss decreased (-0.583316 --> -0.583317).  Saving model ...
Epoch: 11 cost time: 0.9900374412536621
Epoch: 11, Steps: 12 | Train Loss: 1.430 Vali Loss: 1.550 Vali Acc: 0.589 Test Loss: 1.550 Test Acc: 0.589
Validation loss decreased (-0.583317 --> -0.588873).  Saving model ...
Epoch: 12 cost time: 1.0338432788848877
Epoch: 12, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.457 Vali Acc: 0.583 Test Loss: 1.457 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0482749938964844
Epoch: 13, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.379 Vali Acc: 0.589 Test Loss: 1.379 Test Acc: 0.589
Validation loss decreased (-0.588873 --> -0.588875).  Saving model ...
Epoch: 14 cost time: 1.0471947193145752
Epoch: 14, Steps: 12 | Train Loss: 1.151 Vali Loss: 1.320 Vali Acc: 0.600 Test Loss: 1.320 Test Acc: 0.600
Validation loss decreased (-0.588875 --> -0.599987).  Saving model ...
Epoch: 15 cost time: 1.0327999591827393
Epoch: 15, Steps: 12 | Train Loss: 1.037 Vali Loss: 1.267 Vali Acc: 0.617 Test Loss: 1.267 Test Acc: 0.617
Validation loss decreased (-0.599987 --> -0.616654).  Saving model ...
Epoch: 16 cost time: 1.014535665512085
Epoch: 16, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.208 Vali Acc: 0.633 Test Loss: 1.208 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633321).  Saving model ...
Epoch: 17 cost time: 1.1240990161895752
Epoch: 17, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.152 Vali Acc: 0.644 Test Loss: 1.152 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644433).  Saving model ...
Epoch: 18 cost time: 1.109832763671875
Epoch: 18, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.114 Vali Acc: 0.650 Test Loss: 1.114 Test Acc: 0.650
Validation loss decreased (-0.644433 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 1.1020047664642334
Epoch: 19, Steps: 12 | Train Loss: 0.751 Vali Loss: 1.072 Vali Acc: 0.622 Test Loss: 1.072 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.15602707862854
Epoch: 20, Steps: 12 | Train Loss: 0.736 Vali Loss: 1.045 Vali Acc: 0.633 Test Loss: 1.045 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1880807876586914
Epoch: 21, Steps: 12 | Train Loss: 0.653 Vali Loss: 1.008 Vali Acc: 0.661 Test Loss: 1.008 Test Acc: 0.661
Validation loss decreased (-0.649989 --> -0.661101).  Saving model ...
Epoch: 22 cost time: 1.125131368637085
Epoch: 22, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.972 Vali Acc: 0.650 Test Loss: 0.972 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1310288906097412
Epoch: 23, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.951 Vali Acc: 0.656 Test Loss: 0.951 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1762442588806152
Epoch: 24, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.909 Vali Acc: 0.678 Test Loss: 0.909 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677769).  Saving model ...
Epoch: 25 cost time: 1.1220152378082275
Epoch: 25, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.888 Vali Acc: 0.683 Test Loss: 0.888 Test Acc: 0.683
Validation loss decreased (-0.677769 --> -0.683324).  Saving model ...
Epoch: 26 cost time: 1.107574224472046
Epoch: 26, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.882 Vali Acc: 0.667 Test Loss: 0.882 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1088123321533203
Epoch: 27, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.860 Vali Acc: 0.689 Test Loss: 0.860 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688880).  Saving model ...
Epoch: 28 cost time: 1.1042742729187012
Epoch: 28, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.846 Vali Acc: 0.678 Test Loss: 0.846 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.117044448852539
Epoch: 29, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.842 Vali Acc: 0.694 Test Loss: 0.842 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694436).  Saving model ...
Epoch: 30 cost time: 1.1566317081451416
Epoch: 30, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.839 Vali Acc: 0.722 Test Loss: 0.839 Test Acc: 0.722
Validation loss decreased (-0.694436 --> -0.722214).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7222222222222222
model parameter : 355711
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.23427414894104
Epoch: 1, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.699 Vali Acc: 0.156 Test Loss: 2.699 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 1.56636643409729
Epoch: 2, Steps: 12 | Train Loss: 2.592 Vali Loss: 2.628 Vali Acc: 0.206 Test Loss: 2.628 Test Acc: 0.206
Validation loss decreased (-0.155529 --> -0.205529).  Saving model ...
Epoch: 3 cost time: 1.5323832035064697
Epoch: 3, Steps: 12 | Train Loss: 2.533 Vali Loss: 2.533 Vali Acc: 0.272 Test Loss: 2.533 Test Acc: 0.272
Validation loss decreased (-0.205529 --> -0.272197).  Saving model ...
Epoch: 4 cost time: 1.5942585468292236
Epoch: 4, Steps: 12 | Train Loss: 2.381 Vali Loss: 2.425 Vali Acc: 0.367 Test Loss: 2.425 Test Acc: 0.367
Validation loss decreased (-0.272197 --> -0.366642).  Saving model ...
Epoch: 5 cost time: 1.634983777999878
Epoch: 5, Steps: 12 | Train Loss: 2.275 Vali Loss: 2.302 Vali Acc: 0.417 Test Loss: 2.302 Test Acc: 0.417
Validation loss decreased (-0.366642 --> -0.416644).  Saving model ...
Epoch: 6 cost time: 1.637812614440918
Epoch: 6, Steps: 12 | Train Loss: 2.071 Vali Loss: 2.166 Vali Acc: 0.439 Test Loss: 2.166 Test Acc: 0.439
Validation loss decreased (-0.416644 --> -0.438867).  Saving model ...
Epoch: 7 cost time: 1.65977144241333
Epoch: 7, Steps: 12 | Train Loss: 1.941 Vali Loss: 2.012 Vali Acc: 0.467 Test Loss: 2.012 Test Acc: 0.467
Validation loss decreased (-0.438867 --> -0.466647).  Saving model ...
Epoch: 8 cost time: 1.6325950622558594
Epoch: 8, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.857 Vali Acc: 0.494 Test Loss: 1.857 Test Acc: 0.494
Validation loss decreased (-0.466647 --> -0.494426).  Saving model ...
Epoch: 9 cost time: 1.5917689800262451
Epoch: 9, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.703 Vali Acc: 0.528 Test Loss: 1.703 Test Acc: 0.528
Validation loss decreased (-0.494426 --> -0.527761).  Saving model ...
Epoch: 10 cost time: 1.7972509860992432
Epoch: 10, Steps: 12 | Train Loss: 1.423 Vali Loss: 1.546 Vali Acc: 0.578 Test Loss: 1.546 Test Acc: 0.578
Validation loss decreased (-0.527761 --> -0.577762).  Saving model ...
Epoch: 11 cost time: 1.7773628234863281
Epoch: 11, Steps: 12 | Train Loss: 1.265 Vali Loss: 1.410 Vali Acc: 0.589 Test Loss: 1.410 Test Acc: 0.589
Validation loss decreased (-0.577762 --> -0.588875).  Saving model ...
Epoch: 12 cost time: 1.8987107276916504
Epoch: 12, Steps: 12 | Train Loss: 1.124 Vali Loss: 1.293 Vali Acc: 0.611 Test Loss: 1.293 Test Acc: 0.611
Validation loss decreased (-0.588875 --> -0.611098).  Saving model ...
Epoch: 13 cost time: 1.7733449935913086
Epoch: 13, Steps: 12 | Train Loss: 1.042 Vali Loss: 1.211 Vali Acc: 0.639 Test Loss: 1.211 Test Acc: 0.639
Validation loss decreased (-0.611098 --> -0.638877).  Saving model ...
Epoch: 14 cost time: 1.8972012996673584
Epoch: 14, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.129 Vali Acc: 0.661 Test Loss: 1.129 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661100).  Saving model ...
Epoch: 15 cost time: 1.853766918182373
Epoch: 15, Steps: 12 | Train Loss: 0.849 Vali Loss: 1.061 Vali Acc: 0.644 Test Loss: 1.061 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8193674087524414
Epoch: 16, Steps: 12 | Train Loss: 0.758 Vali Loss: 1.006 Vali Acc: 0.650 Test Loss: 1.006 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7771809101104736
Epoch: 17, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.943 Vali Acc: 0.678 Test Loss: 0.943 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677768).  Saving model ...
Epoch: 18 cost time: 1.8289740085601807
Epoch: 18, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.899 Vali Acc: 0.689 Test Loss: 0.899 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688880).  Saving model ...
Epoch: 19 cost time: 1.8653581142425537
Epoch: 19, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.866 Vali Acc: 0.694 Test Loss: 0.866 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694436).  Saving model ...
Epoch: 20 cost time: 1.8645014762878418
Epoch: 20, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.826 Vali Acc: 0.728 Test Loss: 0.826 Test Acc: 0.728
Validation loss decreased (-0.694436 --> -0.727770).  Saving model ...
Epoch: 21 cost time: 1.849459171295166
Epoch: 21, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.796 Vali Acc: 0.717 Test Loss: 0.796 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.773768424987793
Epoch: 22, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.763 Vali Acc: 0.739 Test Loss: 0.763 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738881).  Saving model ...
Epoch: 23 cost time: 1.7872040271759033
Epoch: 23, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.752 Vali Acc: 0.728 Test Loss: 0.752 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.675117015838623
Epoch: 24, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.745 Vali Acc: 0.722 Test Loss: 0.745 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7040467262268066
Epoch: 25, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.706 Vali Acc: 0.744 Test Loss: 0.706 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 26 cost time: 1.6363310813903809
Epoch: 26, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.689 Vali Acc: 0.750 Test Loss: 0.689 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 27 cost time: 1.6895275115966797
Epoch: 27, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.693 Vali Acc: 0.739 Test Loss: 0.693 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6880466938018799
Epoch: 28, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.679 Vali Acc: 0.756 Test Loss: 0.679 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 29 cost time: 1.693336009979248
Epoch: 29, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.682 Vali Acc: 0.756 Test Loss: 0.682 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5718536376953125
Epoch: 30, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.654 Vali Acc: 0.756 Test Loss: 0.654 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 597311
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1601858139038086
Epoch: 1, Steps: 12 | Train Loss: 2.793 Vali Loss: 2.791 Vali Acc: 0.089 Test Loss: 2.791 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 1.4854812622070312
Epoch: 2, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.721 Vali Acc: 0.122 Test Loss: 2.721 Test Acc: 0.122
Validation loss decreased (-0.088861 --> -0.122195).  Saving model ...
Epoch: 3 cost time: 1.5245022773742676
Epoch: 3, Steps: 12 | Train Loss: 2.641 Vali Loss: 2.628 Vali Acc: 0.206 Test Loss: 2.628 Test Acc: 0.206
Validation loss decreased (-0.122195 --> -0.205529).  Saving model ...
Epoch: 4 cost time: 1.4942684173583984
Epoch: 4, Steps: 12 | Train Loss: 2.526 Vali Loss: 2.519 Vali Acc: 0.261 Test Loss: 2.519 Test Acc: 0.261
Validation loss decreased (-0.205529 --> -0.261086).  Saving model ...
Epoch: 5 cost time: 1.5241427421569824
Epoch: 5, Steps: 12 | Train Loss: 2.391 Vali Loss: 2.401 Vali Acc: 0.361 Test Loss: 2.401 Test Acc: 0.361
Validation loss decreased (-0.261086 --> -0.361087).  Saving model ...
Epoch: 6 cost time: 1.5256710052490234
Epoch: 6, Steps: 12 | Train Loss: 2.251 Vali Loss: 2.269 Vali Acc: 0.428 Test Loss: 2.269 Test Acc: 0.428
Validation loss decreased (-0.361087 --> -0.427755).  Saving model ...
Epoch: 7 cost time: 1.553915023803711
Epoch: 7, Steps: 12 | Train Loss: 2.101 Vali Loss: 2.128 Vali Acc: 0.539 Test Loss: 2.128 Test Acc: 0.539
Validation loss decreased (-0.427755 --> -0.538868).  Saving model ...
Epoch: 8 cost time: 1.5297138690948486
Epoch: 8, Steps: 12 | Train Loss: 1.901 Vali Loss: 1.971 Vali Acc: 0.556 Test Loss: 1.971 Test Acc: 0.556
Validation loss decreased (-0.538868 --> -0.555536).  Saving model ...
Epoch: 9 cost time: 1.6104810237884521
Epoch: 9, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.817 Vali Acc: 0.539 Test Loss: 1.817 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5240795612335205
Epoch: 10, Steps: 12 | Train Loss: 1.542 Vali Loss: 1.665 Vali Acc: 0.561 Test Loss: 1.665 Test Acc: 0.561
Validation loss decreased (-0.555536 --> -0.561094).  Saving model ...
Epoch: 11 cost time: 1.489610195159912
Epoch: 11, Steps: 12 | Train Loss: 1.427 Vali Loss: 1.528 Vali Acc: 0.589 Test Loss: 1.528 Test Acc: 0.589
Validation loss decreased (-0.561094 --> -0.588874).  Saving model ...
Epoch: 12 cost time: 1.6040534973144531
Epoch: 12, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.411 Vali Acc: 0.600 Test Loss: 1.411 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599986).  Saving model ...
Epoch: 13 cost time: 1.5994350910186768
Epoch: 13, Steps: 12 | Train Loss: 1.149 Vali Loss: 1.298 Vali Acc: 0.628 Test Loss: 1.298 Test Acc: 0.628
Validation loss decreased (-0.599986 --> -0.627765).  Saving model ...
Epoch: 14 cost time: 1.593796730041504
Epoch: 14, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.208 Vali Acc: 0.656 Test Loss: 1.208 Test Acc: 0.656
Validation loss decreased (-0.627765 --> -0.655543).  Saving model ...
Epoch: 15 cost time: 1.381925344467163
Epoch: 15, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.118 Vali Acc: 0.667 Test Loss: 1.118 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666655).  Saving model ...
Epoch: 16 cost time: 1.4411096572875977
Epoch: 16, Steps: 12 | Train Loss: 0.887 Vali Loss: 1.055 Vali Acc: 0.711 Test Loss: 1.055 Test Acc: 0.711
Validation loss decreased (-0.666655 --> -0.711101).  Saving model ...
Epoch: 17 cost time: 1.4744939804077148
Epoch: 17, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.993 Vali Acc: 0.711 Test Loss: 0.993 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 18 cost time: 1.4980182647705078
Epoch: 18, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.946 Vali Acc: 0.722 Test Loss: 0.946 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 19 cost time: 1.4092285633087158
Epoch: 19, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.905 Vali Acc: 0.717 Test Loss: 0.905 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4433977603912354
Epoch: 20, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.878 Vali Acc: 0.722 Test Loss: 0.878 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 21 cost time: 1.4029340744018555
Epoch: 21, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.844 Vali Acc: 0.733 Test Loss: 0.844 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 22 cost time: 1.4001195430755615
Epoch: 22, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.818 Vali Acc: 0.733 Test Loss: 0.818 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 23 cost time: 1.4618334770202637
Epoch: 23, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.790 Vali Acc: 0.744 Test Loss: 0.790 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744437).  Saving model ...
Epoch: 24 cost time: 1.4691121578216553
Epoch: 24, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.789 Vali Acc: 0.733 Test Loss: 0.789 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6030969619750977
Epoch: 25, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.758 Vali Acc: 0.756 Test Loss: 0.758 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 26 cost time: 1.5663931369781494
Epoch: 26, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6410713195800781
Epoch: 27, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.738 Vali Acc: 0.756 Test Loss: 0.738 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 28 cost time: 1.5471155643463135
Epoch: 28, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.724 Vali Acc: 0.750 Test Loss: 0.724 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.609205722808838
Epoch: 29, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.707 Vali Acc: 0.767 Test Loss: 0.707 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766660).  Saving model ...
Epoch: 30 cost time: 1.5117900371551514
Epoch: 30, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.691 Vali Acc: 0.767 Test Loss: 0.691 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 183423
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4325857162475586
Epoch: 1, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.700 Vali Acc: 0.156 Test Loss: 2.700 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 1.6569435596466064
Epoch: 2, Steps: 12 | Train Loss: 2.592 Vali Loss: 2.629 Vali Acc: 0.206 Test Loss: 2.629 Test Acc: 0.206
Validation loss decreased (-0.155529 --> -0.205529).  Saving model ...
Epoch: 3 cost time: 1.585261583328247
Epoch: 3, Steps: 12 | Train Loss: 2.533 Vali Loss: 2.533 Vali Acc: 0.272 Test Loss: 2.533 Test Acc: 0.272
Validation loss decreased (-0.205529 --> -0.272197).  Saving model ...
Epoch: 4 cost time: 1.5761334896087646
Epoch: 4, Steps: 12 | Train Loss: 2.382 Vali Loss: 2.425 Vali Acc: 0.372 Test Loss: 2.425 Test Acc: 0.372
Validation loss decreased (-0.272197 --> -0.372198).  Saving model ...
Epoch: 5 cost time: 1.6671791076660156
Epoch: 5, Steps: 12 | Train Loss: 2.277 Vali Loss: 2.304 Vali Acc: 0.417 Test Loss: 2.304 Test Acc: 0.417
Validation loss decreased (-0.372198 --> -0.416644).  Saving model ...
Epoch: 6 cost time: 1.647040605545044
Epoch: 6, Steps: 12 | Train Loss: 2.072 Vali Loss: 2.168 Vali Acc: 0.439 Test Loss: 2.168 Test Acc: 0.439
Validation loss decreased (-0.416644 --> -0.438867).  Saving model ...
Epoch: 7 cost time: 1.6523842811584473
Epoch: 7, Steps: 12 | Train Loss: 1.945 Vali Loss: 2.014 Vali Acc: 0.467 Test Loss: 2.014 Test Acc: 0.467
Validation loss decreased (-0.438867 --> -0.466647).  Saving model ...
Epoch: 8 cost time: 1.721858024597168
Epoch: 8, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.861 Vali Acc: 0.494 Test Loss: 1.861 Test Acc: 0.494
Validation loss decreased (-0.466647 --> -0.494426).  Saving model ...
Epoch: 9 cost time: 1.480177402496338
Epoch: 9, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.709 Vali Acc: 0.528 Test Loss: 1.709 Test Acc: 0.528
Validation loss decreased (-0.494426 --> -0.527761).  Saving model ...
Epoch: 10 cost time: 1.5726110935211182
Epoch: 10, Steps: 12 | Train Loss: 1.429 Vali Loss: 1.553 Vali Acc: 0.556 Test Loss: 1.553 Test Acc: 0.556
Validation loss decreased (-0.527761 --> -0.555540).  Saving model ...
Epoch: 11 cost time: 1.5019493103027344
Epoch: 11, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.418 Vali Acc: 0.578 Test Loss: 1.418 Test Acc: 0.578
Validation loss decreased (-0.555540 --> -0.577764).  Saving model ...
Epoch: 12 cost time: 1.560129165649414
Epoch: 12, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.301 Vali Acc: 0.617 Test Loss: 1.301 Test Acc: 0.617
Validation loss decreased (-0.577764 --> -0.616654).  Saving model ...
Epoch: 13 cost time: 1.5298964977264404
Epoch: 13, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.219 Vali Acc: 0.644 Test Loss: 1.219 Test Acc: 0.644
Validation loss decreased (-0.616654 --> -0.644432).  Saving model ...
Epoch: 14 cost time: 1.571591854095459
Epoch: 14, Steps: 12 | Train Loss: 0.968 Vali Loss: 1.135 Vali Acc: 0.667 Test Loss: 1.135 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666655).  Saving model ...
Epoch: 15 cost time: 1.5910115242004395
Epoch: 15, Steps: 12 | Train Loss: 0.862 Vali Loss: 1.071 Vali Acc: 0.650 Test Loss: 1.071 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6000685691833496
Epoch: 16, Steps: 12 | Train Loss: 0.786 Vali Loss: 1.016 Vali Acc: 0.656 Test Loss: 1.016 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5407633781433105
Epoch: 17, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.964 Vali Acc: 0.683 Test Loss: 0.964 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683324).  Saving model ...
Epoch: 18 cost time: 1.5999927520751953
Epoch: 18, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.920 Vali Acc: 0.689 Test Loss: 0.920 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688880).  Saving model ...
Epoch: 19 cost time: 1.6656148433685303
Epoch: 19, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.876 Vali Acc: 0.700 Test Loss: 0.876 Test Acc: 0.700
Validation loss decreased (-0.688880 --> -0.699991).  Saving model ...
Epoch: 20 cost time: 1.6085450649261475
Epoch: 20, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.837 Vali Acc: 0.733 Test Loss: 0.837 Test Acc: 0.733
Validation loss decreased (-0.699991 --> -0.733325).  Saving model ...
Epoch: 21 cost time: 1.6217944622039795
Epoch: 21, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.810 Vali Acc: 0.717 Test Loss: 0.810 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6769678592681885
Epoch: 22, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.775 Vali Acc: 0.728 Test Loss: 0.775 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.673518180847168
Epoch: 23, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.767 Vali Acc: 0.717 Test Loss: 0.767 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.665480613708496
Epoch: 24, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.757 Vali Acc: 0.728 Test Loss: 0.757 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6804440021514893
Epoch: 25, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.713 Vali Acc: 0.744 Test Loss: 0.713 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744437).  Saving model ...
Epoch: 26 cost time: 1.64986252784729
Epoch: 26, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.700 Vali Acc: 0.750 Test Loss: 0.700 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 27 cost time: 1.6451005935668945
Epoch: 27, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.697 Vali Acc: 0.744 Test Loss: 0.697 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7169687747955322
Epoch: 28, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.682 Vali Acc: 0.761 Test Loss: 0.682 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761104).  Saving model ...
Epoch: 29 cost time: 1.6939103603363037
Epoch: 29, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.691 Vali Acc: 0.739 Test Loss: 0.691 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7505757808685303
Epoch: 30, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.662 Vali Acc: 0.756 Test Loss: 0.662 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 597311
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0684502124786377
Epoch: 1, Steps: 12 | Train Loss: 2.794 Vali Loss: 2.792 Vali Acc: 0.089 Test Loss: 2.792 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 1.4516487121582031
Epoch: 2, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.722 Vali Acc: 0.128 Test Loss: 2.722 Test Acc: 0.128
Validation loss decreased (-0.088861 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 1.3591878414154053
Epoch: 3, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.629 Vali Acc: 0.206 Test Loss: 2.629 Test Acc: 0.206
Validation loss decreased (-0.127751 --> -0.205529).  Saving model ...
Epoch: 4 cost time: 1.3479795455932617
Epoch: 4, Steps: 12 | Train Loss: 2.528 Vali Loss: 2.521 Vali Acc: 0.256 Test Loss: 2.521 Test Acc: 0.256
Validation loss decreased (-0.205529 --> -0.255530).  Saving model ...
Epoch: 5 cost time: 1.3202815055847168
Epoch: 5, Steps: 12 | Train Loss: 2.393 Vali Loss: 2.404 Vali Acc: 0.356 Test Loss: 2.404 Test Acc: 0.356
Validation loss decreased (-0.255530 --> -0.355532).  Saving model ...
Epoch: 6 cost time: 1.3334052562713623
Epoch: 6, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.273 Vali Acc: 0.428 Test Loss: 2.273 Test Acc: 0.428
Validation loss decreased (-0.355532 --> -0.427755).  Saving model ...
Epoch: 7 cost time: 1.3386929035186768
Epoch: 7, Steps: 12 | Train Loss: 2.108 Vali Loss: 2.134 Vali Acc: 0.533 Test Loss: 2.134 Test Acc: 0.533
Validation loss decreased (-0.427755 --> -0.533312).  Saving model ...
Epoch: 8 cost time: 1.335601806640625
Epoch: 8, Steps: 12 | Train Loss: 1.911 Vali Loss: 1.979 Vali Acc: 0.544 Test Loss: 1.979 Test Acc: 0.544
Validation loss decreased (-0.533312 --> -0.544425).  Saving model ...
Epoch: 9 cost time: 1.3550288677215576
Epoch: 9, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.827 Vali Acc: 0.533 Test Loss: 1.827 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2900230884552002
Epoch: 10, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.676 Vali Acc: 0.550 Test Loss: 1.676 Test Acc: 0.550
Validation loss decreased (-0.544425 --> -0.549983).  Saving model ...
Epoch: 11 cost time: 1.32330322265625
Epoch: 11, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.543 Vali Acc: 0.583 Test Loss: 1.543 Test Acc: 0.583
Validation loss decreased (-0.549983 --> -0.583318).  Saving model ...
Epoch: 12 cost time: 1.3346192836761475
Epoch: 12, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.429 Vali Acc: 0.594 Test Loss: 1.429 Test Acc: 0.594
Validation loss decreased (-0.583318 --> -0.594430).  Saving model ...
Epoch: 13 cost time: 1.2310030460357666
Epoch: 13, Steps: 12 | Train Loss: 1.160 Vali Loss: 1.317 Vali Acc: 0.617 Test Loss: 1.317 Test Acc: 0.617
Validation loss decreased (-0.594430 --> -0.616653).  Saving model ...
Epoch: 14 cost time: 1.5281944274902344
Epoch: 14, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.228 Vali Acc: 0.633 Test Loss: 1.228 Test Acc: 0.633
Validation loss decreased (-0.616653 --> -0.633321).  Saving model ...
Epoch: 15 cost time: 1.4292545318603516
Epoch: 15, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.137 Vali Acc: 0.644 Test Loss: 1.137 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644433).  Saving model ...
Epoch: 16 cost time: 1.4847183227539062
Epoch: 16, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.073 Vali Acc: 0.678 Test Loss: 1.073 Test Acc: 0.678
Validation loss decreased (-0.644433 --> -0.677767).  Saving model ...
Epoch: 17 cost time: 1.4811134338378906
Epoch: 17, Steps: 12 | Train Loss: 0.824 Vali Loss: 1.011 Vali Acc: 0.694 Test Loss: 1.011 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694434).  Saving model ...
Epoch: 18 cost time: 1.4606714248657227
Epoch: 18, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.959 Vali Acc: 0.717 Test Loss: 0.959 Test Acc: 0.717
Validation loss decreased (-0.694434 --> -0.716657).  Saving model ...
Epoch: 19 cost time: 1.437809944152832
Epoch: 19, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.917 Vali Acc: 0.722 Test Loss: 0.917 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 20 cost time: 1.504413366317749
Epoch: 20, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.891 Vali Acc: 0.722 Test Loss: 0.891 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 21 cost time: 1.479400634765625
Epoch: 21, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.857 Vali Acc: 0.728 Test Loss: 0.857 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 22 cost time: 1.4452447891235352
Epoch: 22, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.830 Vali Acc: 0.728 Test Loss: 0.830 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 23 cost time: 1.4906699657440186
Epoch: 23, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.806 Vali Acc: 0.744 Test Loss: 0.806 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 24 cost time: 1.460052251815796
Epoch: 24, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.805 Vali Acc: 0.722 Test Loss: 0.805 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4523580074310303
Epoch: 25, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.772 Vali Acc: 0.744 Test Loss: 0.772 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 26 cost time: 1.450390338897705
Epoch: 26, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.754 Vali Acc: 0.722 Test Loss: 0.754 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4338061809539795
Epoch: 27, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.751 Vali Acc: 0.733 Test Loss: 0.751 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3938312530517578
Epoch: 28, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.743 Vali Acc: 0.733 Test Loss: 0.743 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.425055980682373
Epoch: 29, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.725 Vali Acc: 0.739 Test Loss: 0.725 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4274482727050781
Epoch: 30, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.706 Vali Acc: 0.756 Test Loss: 0.706 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 183423
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.533057928085327
Epoch: 1, Steps: 12 | Train Loss: 2.667 Vali Loss: 2.704 Vali Acc: 0.150 Test Loss: 2.704 Test Acc: 0.150
Validation loss decreased (inf --> -0.149973).  Saving model ...
Epoch: 2 cost time: 1.176755666732788
Epoch: 2, Steps: 12 | Train Loss: 2.603 Vali Loss: 2.642 Vali Acc: 0.183 Test Loss: 2.642 Test Acc: 0.183
Validation loss decreased (-0.149973 --> -0.183307).  Saving model ...
Epoch: 3 cost time: 1.1566364765167236
Epoch: 3, Steps: 12 | Train Loss: 2.554 Vali Loss: 2.562 Vali Acc: 0.256 Test Loss: 2.562 Test Acc: 0.256
Validation loss decreased (-0.183307 --> -0.255530).  Saving model ...
Epoch: 4 cost time: 1.1794509887695312
Epoch: 4, Steps: 12 | Train Loss: 2.418 Vali Loss: 2.472 Vali Acc: 0.317 Test Loss: 2.472 Test Acc: 0.317
Validation loss decreased (-0.255530 --> -0.316642).  Saving model ...
Epoch: 5 cost time: 1.2023959159851074
Epoch: 5, Steps: 12 | Train Loss: 2.330 Vali Loss: 2.369 Vali Acc: 0.350 Test Loss: 2.369 Test Acc: 0.350
Validation loss decreased (-0.316642 --> -0.349976).  Saving model ...
Epoch: 6 cost time: 1.2797949314117432
Epoch: 6, Steps: 12 | Train Loss: 2.146 Vali Loss: 2.255 Vali Acc: 0.417 Test Loss: 2.255 Test Acc: 0.417
Validation loss decreased (-0.349976 --> -0.416644).  Saving model ...
Epoch: 7 cost time: 1.2192332744598389
Epoch: 7, Steps: 12 | Train Loss: 2.072 Vali Loss: 2.131 Vali Acc: 0.444 Test Loss: 2.131 Test Acc: 0.444
Validation loss decreased (-0.416644 --> -0.444423).  Saving model ...
Epoch: 8 cost time: 1.0023386478424072
Epoch: 8, Steps: 12 | Train Loss: 1.961 Vali Loss: 2.006 Vali Acc: 0.467 Test Loss: 2.006 Test Acc: 0.467
Validation loss decreased (-0.444423 --> -0.466647).  Saving model ...
Epoch: 9 cost time: 1.2932772636413574
Epoch: 9, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.880 Vali Acc: 0.494 Test Loss: 1.880 Test Acc: 0.494
Validation loss decreased (-0.466647 --> -0.494426).  Saving model ...
Epoch: 10 cost time: 1.3252003192901611
Epoch: 10, Steps: 12 | Train Loss: 1.613 Vali Loss: 1.749 Vali Acc: 0.522 Test Loss: 1.749 Test Acc: 0.522
Validation loss decreased (-0.494426 --> -0.522205).  Saving model ...
Epoch: 11 cost time: 1.2993099689483643
Epoch: 11, Steps: 12 | Train Loss: 1.518 Vali Loss: 1.625 Vali Acc: 0.522 Test Loss: 1.625 Test Acc: 0.522
Validation loss decreased (-0.522205 --> -0.522206).  Saving model ...
Epoch: 12 cost time: 1.2998900413513184
Epoch: 12, Steps: 12 | Train Loss: 1.373 Vali Loss: 1.526 Vali Acc: 0.544 Test Loss: 1.526 Test Acc: 0.544
Validation loss decreased (-0.522206 --> -0.544429).  Saving model ...
Epoch: 13 cost time: 1.285064458847046
Epoch: 13, Steps: 12 | Train Loss: 1.350 Vali Loss: 1.448 Vali Acc: 0.539 Test Loss: 1.448 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.456772804260254
Epoch: 14, Steps: 12 | Train Loss: 1.199 Vali Loss: 1.352 Vali Acc: 0.561 Test Loss: 1.352 Test Acc: 0.561
Validation loss decreased (-0.544429 --> -0.561098).  Saving model ...
Epoch: 15 cost time: 1.3959884643554688
Epoch: 15, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.276 Vali Acc: 0.583 Test Loss: 1.276 Test Acc: 0.583
Validation loss decreased (-0.561098 --> -0.583321).  Saving model ...
Epoch: 16 cost time: 1.3048362731933594
Epoch: 16, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.209 Vali Acc: 0.589 Test Loss: 1.209 Test Acc: 0.589
Validation loss decreased (-0.583321 --> -0.588877).  Saving model ...
Epoch: 17 cost time: 1.3794617652893066
Epoch: 17, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.145 Vali Acc: 0.589 Test Loss: 1.145 Test Acc: 0.589
Validation loss decreased (-0.588877 --> -0.588877).  Saving model ...
Epoch: 18 cost time: 1.349261999130249
Epoch: 18, Steps: 12 | Train Loss: 0.836 Vali Loss: 1.098 Vali Acc: 0.611 Test Loss: 1.098 Test Acc: 0.611
Validation loss decreased (-0.588877 --> -0.611100).  Saving model ...
Epoch: 19 cost time: 1.4320857524871826
Epoch: 19, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.061 Vali Acc: 0.606 Test Loss: 1.061 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3991444110870361
Epoch: 20, Steps: 12 | Train Loss: 0.739 Vali Loss: 1.012 Vali Acc: 0.633 Test Loss: 1.012 Test Acc: 0.633
Validation loss decreased (-0.611100 --> -0.633323).  Saving model ...
Epoch: 21 cost time: 1.375882625579834
Epoch: 21, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.968 Vali Acc: 0.667 Test Loss: 0.968 Test Acc: 0.667
Validation loss decreased (-0.633323 --> -0.666657).  Saving model ...
Epoch: 22 cost time: 1.4521715641021729
Epoch: 22, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.942 Vali Acc: 0.644 Test Loss: 0.942 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3760311603546143
Epoch: 23, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.909 Vali Acc: 0.672 Test Loss: 0.909 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672213).  Saving model ...
Epoch: 24 cost time: 1.3654160499572754
Epoch: 24, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.881 Vali Acc: 0.672 Test Loss: 0.881 Test Acc: 0.672
Validation loss decreased (-0.672213 --> -0.672213).  Saving model ...
Epoch: 25 cost time: 1.4641597270965576
Epoch: 25, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.853 Vali Acc: 0.683 Test Loss: 0.853 Test Acc: 0.683
Validation loss decreased (-0.672213 --> -0.683325).  Saving model ...
Epoch: 26 cost time: 1.3574745655059814
Epoch: 26, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.828 Vali Acc: 0.683 Test Loss: 0.828 Test Acc: 0.683
Validation loss decreased (-0.683325 --> -0.683325).  Saving model ...
Epoch: 27 cost time: 1.3763954639434814
Epoch: 27, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.834 Vali Acc: 0.683 Test Loss: 0.834 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.308530330657959
Epoch: 28, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.823 Vali Acc: 0.689 Test Loss: 0.823 Test Acc: 0.689
Validation loss decreased (-0.683325 --> -0.688881).  Saving model ...
Epoch: 29 cost time: 1.3824305534362793
Epoch: 29, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.810 Vali Acc: 0.706 Test Loss: 0.810 Test Acc: 0.706
Validation loss decreased (-0.688881 --> -0.705547).  Saving model ...
Epoch: 30 cost time: 1.3923969268798828
Epoch: 30, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.780 Vali Acc: 0.711 Test Loss: 0.780 Test Acc: 0.711
Validation loss decreased (-0.705547 --> -0.711103).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7111111111111111
model parameter : 597311
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7284977436065674
Epoch: 1, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.797 Vali Acc: 0.089 Test Loss: 2.797 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 1.2375969886779785
Epoch: 2, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.735 Vali Acc: 0.128 Test Loss: 2.735 Test Acc: 0.128
Validation loss decreased (-0.088861 --> -0.127750).  Saving model ...
Epoch: 3 cost time: 1.2619249820709229
Epoch: 3, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.651 Vali Acc: 0.167 Test Loss: 2.651 Test Acc: 0.167
Validation loss decreased (-0.127750 --> -0.166640).  Saving model ...
Epoch: 4 cost time: 1.241239309310913
Epoch: 4, Steps: 12 | Train Loss: 2.548 Vali Loss: 2.555 Vali Acc: 0.206 Test Loss: 2.555 Test Acc: 0.206
Validation loss decreased (-0.166640 --> -0.205530).  Saving model ...
Epoch: 5 cost time: 1.235762357711792
Epoch: 5, Steps: 12 | Train Loss: 2.435 Vali Loss: 2.452 Vali Acc: 0.300 Test Loss: 2.452 Test Acc: 0.300
Validation loss decreased (-0.205530 --> -0.299975).  Saving model ...
Epoch: 6 cost time: 1.2979505062103271
Epoch: 6, Steps: 12 | Train Loss: 2.312 Vali Loss: 2.340 Vali Acc: 0.361 Test Loss: 2.340 Test Acc: 0.361
Validation loss decreased (-0.299975 --> -0.361088).  Saving model ...
Epoch: 7 cost time: 1.2503201961517334
Epoch: 7, Steps: 12 | Train Loss: 2.194 Vali Loss: 2.223 Vali Acc: 0.417 Test Loss: 2.223 Test Acc: 0.417
Validation loss decreased (-0.361088 --> -0.416644).  Saving model ...
Epoch: 8 cost time: 1.3446707725524902
Epoch: 8, Steps: 12 | Train Loss: 2.008 Vali Loss: 2.092 Vali Acc: 0.450 Test Loss: 2.092 Test Acc: 0.450
Validation loss decreased (-0.416644 --> -0.449979).  Saving model ...
Epoch: 9 cost time: 1.2856380939483643
Epoch: 9, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.957 Vali Acc: 0.467 Test Loss: 1.957 Test Acc: 0.467
Validation loss decreased (-0.449979 --> -0.466647).  Saving model ...
Epoch: 10 cost time: 1.3187198638916016
Epoch: 10, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.818 Vali Acc: 0.517 Test Loss: 1.818 Test Acc: 0.517
Validation loss decreased (-0.466647 --> -0.516648).  Saving model ...
Epoch: 11 cost time: 1.3160934448242188
Epoch: 11, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.687 Vali Acc: 0.567 Test Loss: 1.687 Test Acc: 0.567
Validation loss decreased (-0.516648 --> -0.566650).  Saving model ...
Epoch: 12 cost time: 1.2817192077636719
Epoch: 12, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.576 Vali Acc: 0.583 Test Loss: 1.576 Test Acc: 0.583
Validation loss decreased (-0.566650 --> -0.583318).  Saving model ...
Epoch: 13 cost time: 1.3047068119049072
Epoch: 13, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.468 Vali Acc: 0.578 Test Loss: 1.468 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2927923202514648
Epoch: 14, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.381 Vali Acc: 0.583 Test Loss: 1.381 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583320).  Saving model ...
Epoch: 15 cost time: 1.2904069423675537
Epoch: 15, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.290 Vali Acc: 0.600 Test Loss: 1.290 Test Acc: 0.600
Validation loss decreased (-0.583320 --> -0.599987).  Saving model ...
Epoch: 16 cost time: 1.3300561904907227
Epoch: 16, Steps: 12 | Train Loss: 1.096 Vali Loss: 1.228 Vali Acc: 0.628 Test Loss: 1.228 Test Acc: 0.628
Validation loss decreased (-0.599987 --> -0.627765).  Saving model ...
Epoch: 17 cost time: 1.2830634117126465
Epoch: 17, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.164 Vali Acc: 0.639 Test Loss: 1.164 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 18 cost time: 1.2693133354187012
Epoch: 18, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.111 Vali Acc: 0.628 Test Loss: 1.111 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4063794612884521
Epoch: 19, Steps: 12 | Train Loss: 0.912 Vali Loss: 1.062 Vali Acc: 0.644 Test Loss: 1.062 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644434).  Saving model ...
Epoch: 20 cost time: 1.327770709991455
Epoch: 20, Steps: 12 | Train Loss: 0.773 Vali Loss: 1.031 Vali Acc: 0.644 Test Loss: 1.031 Test Acc: 0.644
Validation loss decreased (-0.644434 --> -0.644434).  Saving model ...
Epoch: 21 cost time: 1.3287649154663086
Epoch: 21, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.991 Vali Acc: 0.672 Test Loss: 0.991 Test Acc: 0.672
Validation loss decreased (-0.644434 --> -0.672212).  Saving model ...
Epoch: 22 cost time: 1.335857629776001
Epoch: 22, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.959 Vali Acc: 0.706 Test Loss: 0.959 Test Acc: 0.706
Validation loss decreased (-0.672212 --> -0.705546).  Saving model ...
Epoch: 23 cost time: 1.3285326957702637
Epoch: 23, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.932 Vali Acc: 0.706 Test Loss: 0.932 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705546).  Saving model ...
Epoch: 24 cost time: 1.2886559963226318
Epoch: 24, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.919 Vali Acc: 0.683 Test Loss: 0.919 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3422532081604004
Epoch: 25, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.882 Vali Acc: 0.706 Test Loss: 0.882 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705547).  Saving model ...
Epoch: 26 cost time: 1.277778148651123
Epoch: 26, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.863 Vali Acc: 0.706 Test Loss: 0.863 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 27 cost time: 1.2281348705291748
Epoch: 27, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.852 Vali Acc: 0.700 Test Loss: 0.852 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2649681568145752
Epoch: 28, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.844 Vali Acc: 0.706 Test Loss: 0.844 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 29 cost time: 1.2020490169525146
Epoch: 29, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.827 Vali Acc: 0.722 Test Loss: 0.827 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722214).  Saving model ...
Epoch: 30 cost time: 1.1930088996887207
Epoch: 30, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.812 Vali Acc: 0.722 Test Loss: 0.812 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7222222222222222
model parameter : 183423
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.227013349533081
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.672 Vali Acc: 0.117 Test Loss: 2.672 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 1.6535418033599854
Epoch: 2, Steps: 12 | Train Loss: 2.666 Vali Loss: 2.585 Vali Acc: 0.183 Test Loss: 2.585 Test Acc: 0.183
Validation loss decreased (-0.116640 --> -0.183307).  Saving model ...
Epoch: 3 cost time: 1.7089383602142334
Epoch: 3, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.470 Vali Acc: 0.289 Test Loss: 2.470 Test Acc: 0.289
Validation loss decreased (-0.183307 --> -0.288864).  Saving model ...
Epoch: 4 cost time: 1.4278087615966797
Epoch: 4, Steps: 12 | Train Loss: 2.406 Vali Loss: 2.341 Vali Acc: 0.383 Test Loss: 2.341 Test Acc: 0.383
Validation loss decreased (-0.288864 --> -0.383310).  Saving model ...
Epoch: 5 cost time: 1.8604516983032227
Epoch: 5, Steps: 12 | Train Loss: 2.275 Vali Loss: 2.212 Vali Acc: 0.456 Test Loss: 2.212 Test Acc: 0.456
Validation loss decreased (-0.383310 --> -0.455533).  Saving model ...
Epoch: 6 cost time: 1.6917142868041992
Epoch: 6, Steps: 12 | Train Loss: 2.092 Vali Loss: 2.073 Vali Acc: 0.517 Test Loss: 2.073 Test Acc: 0.517
Validation loss decreased (-0.455533 --> -0.516646).  Saving model ...
Epoch: 7 cost time: 1.7021591663360596
Epoch: 7, Steps: 12 | Train Loss: 1.945 Vali Loss: 1.933 Vali Acc: 0.544 Test Loss: 1.933 Test Acc: 0.544
Validation loss decreased (-0.516646 --> -0.544425).  Saving model ...
Epoch: 8 cost time: 1.6718847751617432
Epoch: 8, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.795 Vali Acc: 0.539 Test Loss: 1.795 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6843879222869873
Epoch: 9, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.664 Vali Acc: 0.556 Test Loss: 1.664 Test Acc: 0.556
Validation loss decreased (-0.544425 --> -0.555539).  Saving model ...
Epoch: 10 cost time: 1.7798748016357422
Epoch: 10, Steps: 12 | Train Loss: 1.501 Vali Loss: 1.538 Vali Acc: 0.567 Test Loss: 1.538 Test Acc: 0.567
Validation loss decreased (-0.555539 --> -0.566651).  Saving model ...
Epoch: 11 cost time: 1.6611406803131104
Epoch: 11, Steps: 12 | Train Loss: 1.321 Vali Loss: 1.433 Vali Acc: 0.583 Test Loss: 1.433 Test Acc: 0.583
Validation loss decreased (-0.566651 --> -0.583319).  Saving model ...
Epoch: 12 cost time: 1.7942121028900146
Epoch: 12, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.339 Vali Acc: 0.594 Test Loss: 1.339 Test Acc: 0.594
Validation loss decreased (-0.583319 --> -0.594431).  Saving model ...
Epoch: 13 cost time: 1.5763967037200928
Epoch: 13, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.269 Vali Acc: 0.594 Test Loss: 1.269 Test Acc: 0.594
Validation loss decreased (-0.594431 --> -0.594432).  Saving model ...
Epoch: 14 cost time: 1.6462180614471436
Epoch: 14, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.196 Vali Acc: 0.611 Test Loss: 1.196 Test Acc: 0.611
Validation loss decreased (-0.594432 --> -0.611099).  Saving model ...
Epoch: 15 cost time: 1.7059500217437744
Epoch: 15, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.133 Vali Acc: 0.644 Test Loss: 1.133 Test Acc: 0.644
Validation loss decreased (-0.611099 --> -0.644433).  Saving model ...
Epoch: 16 cost time: 1.6725764274597168
Epoch: 16, Steps: 12 | Train Loss: 0.848 Vali Loss: 1.074 Vali Acc: 0.672 Test Loss: 1.074 Test Acc: 0.672
Validation loss decreased (-0.644433 --> -0.672211).  Saving model ...
Epoch: 17 cost time: 1.7211108207702637
Epoch: 17, Steps: 12 | Train Loss: 0.782 Vali Loss: 1.030 Vali Acc: 0.678 Test Loss: 1.030 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 18 cost time: 1.631286859512329
Epoch: 18, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.982 Vali Acc: 0.678 Test Loss: 0.982 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677768).  Saving model ...
Epoch: 19 cost time: 1.74314284324646
Epoch: 19, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.941 Vali Acc: 0.689 Test Loss: 0.941 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688879).  Saving model ...
Epoch: 20 cost time: 1.6990725994110107
Epoch: 20, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.912 Vali Acc: 0.700 Test Loss: 0.912 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699991).  Saving model ...
Epoch: 21 cost time: 1.5185904502868652
Epoch: 21, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.882 Vali Acc: 0.728 Test Loss: 0.882 Test Acc: 0.728
Validation loss decreased (-0.699991 --> -0.727769).  Saving model ...
Epoch: 22 cost time: 1.5231046676635742
Epoch: 22, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.858 Vali Acc: 0.717 Test Loss: 0.858 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4817485809326172
Epoch: 23, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.839 Vali Acc: 0.722 Test Loss: 0.839 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5333757400512695
Epoch: 24, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.822 Vali Acc: 0.722 Test Loss: 0.822 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3951256275177002
Epoch: 25, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.813 Vali Acc: 0.717 Test Loss: 0.813 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4534106254577637
Epoch: 26, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.787 Vali Acc: 0.711 Test Loss: 0.787 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.416102647781372
Epoch: 27, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.782 Vali Acc: 0.689 Test Loss: 0.782 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6178555488586426
Epoch: 28, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.772 Vali Acc: 0.717 Test Loss: 0.772 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4582457542419434
Epoch: 29, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.761 Vali Acc: 0.733 Test Loss: 0.761 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733326).  Saving model ...
Epoch: 30 cost time: 1.64573335647583
Epoch: 30, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.761 Vali Acc: 0.728 Test Loss: 0.761 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7333333333333333
model parameter : 304255
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.978921890258789
Epoch: 1, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.731 Vali Acc: 0.067 Test Loss: 2.731 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.155418872833252
Epoch: 2, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.651 Vali Acc: 0.083 Test Loss: 2.651 Test Acc: 0.083
Validation loss decreased (-0.066639 --> -0.083307).  Saving model ...
Epoch: 3 cost time: 1.537562608718872
Epoch: 3, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.543 Vali Acc: 0.139 Test Loss: 2.543 Test Acc: 0.139
Validation loss decreased (-0.083307 --> -0.138863).  Saving model ...
Epoch: 4 cost time: 1.5299663543701172
Epoch: 4, Steps: 12 | Train Loss: 2.457 Vali Loss: 2.420 Vali Acc: 0.233 Test Loss: 2.420 Test Acc: 0.233
Validation loss decreased (-0.138863 --> -0.233309).  Saving model ...
Epoch: 5 cost time: 1.5067119598388672
Epoch: 5, Steps: 12 | Train Loss: 2.311 Vali Loss: 2.294 Vali Acc: 0.428 Test Loss: 2.294 Test Acc: 0.428
Validation loss decreased (-0.233309 --> -0.427755).  Saving model ...
Epoch: 6 cost time: 1.5971527099609375
Epoch: 6, Steps: 12 | Train Loss: 2.165 Vali Loss: 2.161 Vali Acc: 0.489 Test Loss: 2.161 Test Acc: 0.489
Validation loss decreased (-0.427755 --> -0.488867).  Saving model ...
Epoch: 7 cost time: 1.4839134216308594
Epoch: 7, Steps: 12 | Train Loss: 2.024 Vali Loss: 2.032 Vali Acc: 0.500 Test Loss: 2.032 Test Acc: 0.500
Validation loss decreased (-0.488867 --> -0.499980).  Saving model ...
Epoch: 8 cost time: 1.5895192623138428
Epoch: 8, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.897 Vali Acc: 0.522 Test Loss: 1.897 Test Acc: 0.522
Validation loss decreased (-0.499980 --> -0.522203).  Saving model ...
Epoch: 9 cost time: 1.593573808670044
Epoch: 9, Steps: 12 | Train Loss: 1.705 Vali Loss: 1.772 Vali Acc: 0.556 Test Loss: 1.772 Test Acc: 0.556
Validation loss decreased (-0.522203 --> -0.555538).  Saving model ...
Epoch: 10 cost time: 1.5852694511413574
Epoch: 10, Steps: 12 | Train Loss: 1.520 Vali Loss: 1.644 Vali Acc: 0.572 Test Loss: 1.644 Test Acc: 0.572
Validation loss decreased (-0.555538 --> -0.572206).  Saving model ...
Epoch: 11 cost time: 1.553704023361206
Epoch: 11, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.538 Vali Acc: 0.594 Test Loss: 1.538 Test Acc: 0.594
Validation loss decreased (-0.572206 --> -0.594429).  Saving model ...
Epoch: 12 cost time: 1.5738945007324219
Epoch: 12, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.432 Vali Acc: 0.594 Test Loss: 1.432 Test Acc: 0.594
Validation loss decreased (-0.594429 --> -0.594430).  Saving model ...
Epoch: 13 cost time: 1.5895791053771973
Epoch: 13, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.338 Vali Acc: 0.567 Test Loss: 1.338 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4870069026947021
Epoch: 14, Steps: 12 | Train Loss: 1.120 Vali Loss: 1.249 Vali Acc: 0.589 Test Loss: 1.249 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5774898529052734
Epoch: 15, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.180 Vali Acc: 0.606 Test Loss: 1.180 Test Acc: 0.606
Validation loss decreased (-0.594430 --> -0.605544).  Saving model ...
Epoch: 16 cost time: 1.558765172958374
Epoch: 16, Steps: 12 | Train Loss: 0.887 Vali Loss: 1.102 Vali Acc: 0.611 Test Loss: 1.102 Test Acc: 0.611
Validation loss decreased (-0.605544 --> -0.611100).  Saving model ...
Epoch: 17 cost time: 1.6148426532745361
Epoch: 17, Steps: 12 | Train Loss: 0.891 Vali Loss: 1.041 Vali Acc: 0.622 Test Loss: 1.041 Test Acc: 0.622
Validation loss decreased (-0.611100 --> -0.622212).  Saving model ...
Epoch: 18 cost time: 1.5917611122131348
Epoch: 18, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.993 Vali Acc: 0.622 Test Loss: 0.993 Test Acc: 0.622
Validation loss decreased (-0.622212 --> -0.622212).  Saving model ...
Epoch: 19 cost time: 1.5607414245605469
Epoch: 19, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.945 Vali Acc: 0.667 Test Loss: 0.945 Test Acc: 0.667
Validation loss decreased (-0.622212 --> -0.666657).  Saving model ...
Epoch: 20 cost time: 1.552076816558838
Epoch: 20, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.909 Vali Acc: 0.700 Test Loss: 0.909 Test Acc: 0.700
Validation loss decreased (-0.666657 --> -0.699991).  Saving model ...
Epoch: 21 cost time: 1.5696890354156494
Epoch: 21, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.885 Vali Acc: 0.694 Test Loss: 0.885 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.589989185333252
Epoch: 22, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.860 Vali Acc: 0.683 Test Loss: 0.860 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.583751916885376
Epoch: 23, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.829 Vali Acc: 0.722 Test Loss: 0.829 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722214).  Saving model ...
Epoch: 24 cost time: 1.6982157230377197
Epoch: 24, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.810 Vali Acc: 0.717 Test Loss: 0.810 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5932338237762451
Epoch: 25, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.796 Vali Acc: 0.717 Test Loss: 0.796 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6445763111114502
Epoch: 26, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.773 Vali Acc: 0.728 Test Loss: 0.773 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727770).  Saving model ...
Epoch: 27 cost time: 1.5012516975402832
Epoch: 27, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.762 Vali Acc: 0.717 Test Loss: 0.762 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6737537384033203
Epoch: 28, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.750 Vali Acc: 0.733 Test Loss: 0.750 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733326).  Saving model ...
Epoch: 29 cost time: 1.6765697002410889
Epoch: 29, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.745 Vali Acc: 0.733 Test Loss: 0.745 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733326).  Saving model ...
Epoch: 30 cost time: 1.6483919620513916
Epoch: 30, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.741 Vali Acc: 0.739 Test Loss: 0.741 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738881).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 97279
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1868605613708496
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.672 Vali Acc: 0.117 Test Loss: 2.672 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 1.6589539051055908
Epoch: 2, Steps: 12 | Train Loss: 2.666 Vali Loss: 2.585 Vali Acc: 0.183 Test Loss: 2.585 Test Acc: 0.183
Validation loss decreased (-0.116640 --> -0.183307).  Saving model ...
Epoch: 3 cost time: 1.5463542938232422
Epoch: 3, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.470 Vali Acc: 0.289 Test Loss: 2.470 Test Acc: 0.289
Validation loss decreased (-0.183307 --> -0.288864).  Saving model ...
Epoch: 4 cost time: 1.611447811126709
Epoch: 4, Steps: 12 | Train Loss: 2.406 Vali Loss: 2.341 Vali Acc: 0.383 Test Loss: 2.341 Test Acc: 0.383
Validation loss decreased (-0.288864 --> -0.383310).  Saving model ...
Epoch: 5 cost time: 1.62833571434021
Epoch: 5, Steps: 12 | Train Loss: 2.275 Vali Loss: 2.212 Vali Acc: 0.456 Test Loss: 2.212 Test Acc: 0.456
Validation loss decreased (-0.383310 --> -0.455533).  Saving model ...
Epoch: 6 cost time: 1.6084198951721191
Epoch: 6, Steps: 12 | Train Loss: 2.092 Vali Loss: 2.073 Vali Acc: 0.517 Test Loss: 2.073 Test Acc: 0.517
Validation loss decreased (-0.455533 --> -0.516646).  Saving model ...
Epoch: 7 cost time: 1.5517466068267822
Epoch: 7, Steps: 12 | Train Loss: 1.945 Vali Loss: 1.933 Vali Acc: 0.539 Test Loss: 1.933 Test Acc: 0.539
Validation loss decreased (-0.516646 --> -0.538870).  Saving model ...
Epoch: 8 cost time: 1.6302719116210938
Epoch: 8, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.795 Vali Acc: 0.539 Test Loss: 1.795 Test Acc: 0.539
Validation loss decreased (-0.538870 --> -0.538871).  Saving model ...
Epoch: 9 cost time: 1.5833404064178467
Epoch: 9, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.664 Vali Acc: 0.556 Test Loss: 1.664 Test Acc: 0.556
Validation loss decreased (-0.538871 --> -0.555539).  Saving model ...
Epoch: 10 cost time: 1.7148041725158691
Epoch: 10, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.537 Vali Acc: 0.567 Test Loss: 1.537 Test Acc: 0.567
Validation loss decreased (-0.555539 --> -0.566651).  Saving model ...
Epoch: 11 cost time: 1.633596658706665
Epoch: 11, Steps: 12 | Train Loss: 1.321 Vali Loss: 1.433 Vali Acc: 0.583 Test Loss: 1.433 Test Acc: 0.583
Validation loss decreased (-0.566651 --> -0.583319).  Saving model ...
Epoch: 12 cost time: 1.5965712070465088
Epoch: 12, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.339 Vali Acc: 0.594 Test Loss: 1.339 Test Acc: 0.594
Validation loss decreased (-0.583319 --> -0.594431).  Saving model ...
Epoch: 13 cost time: 1.6163816452026367
Epoch: 13, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.269 Vali Acc: 0.594 Test Loss: 1.269 Test Acc: 0.594
Validation loss decreased (-0.594431 --> -0.594432).  Saving model ...
Epoch: 14 cost time: 1.5854063034057617
Epoch: 14, Steps: 12 | Train Loss: 0.990 Vali Loss: 1.196 Vali Acc: 0.611 Test Loss: 1.196 Test Acc: 0.611
Validation loss decreased (-0.594432 --> -0.611099).  Saving model ...
Epoch: 15 cost time: 1.6393098831176758
Epoch: 15, Steps: 12 | Train Loss: 0.938 Vali Loss: 1.133 Vali Acc: 0.650 Test Loss: 1.133 Test Acc: 0.650
Validation loss decreased (-0.611099 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 1.5530850887298584
Epoch: 16, Steps: 12 | Train Loss: 0.849 Vali Loss: 1.073 Vali Acc: 0.672 Test Loss: 1.073 Test Acc: 0.672
Validation loss decreased (-0.649989 --> -0.672211).  Saving model ...
Epoch: 17 cost time: 1.576920509338379
Epoch: 17, Steps: 12 | Train Loss: 0.783 Vali Loss: 1.029 Vali Acc: 0.672 Test Loss: 1.029 Test Acc: 0.672
Validation loss decreased (-0.672211 --> -0.672212).  Saving model ...
Epoch: 18 cost time: 1.584587574005127
Epoch: 18, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.982 Vali Acc: 0.678 Test Loss: 0.982 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 19 cost time: 1.5955889225006104
Epoch: 19, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.941 Vali Acc: 0.689 Test Loss: 0.941 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688879).  Saving model ...
Epoch: 20 cost time: 1.6203770637512207
Epoch: 20, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.913 Vali Acc: 0.694 Test Loss: 0.913 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 21 cost time: 1.6672592163085938
Epoch: 21, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.884 Vali Acc: 0.728 Test Loss: 0.884 Test Acc: 0.728
Validation loss decreased (-0.694435 --> -0.727769).  Saving model ...
Epoch: 22 cost time: 1.6960644721984863
Epoch: 22, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.860 Vali Acc: 0.706 Test Loss: 0.860 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4159839153289795
Epoch: 23, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.843 Vali Acc: 0.717 Test Loss: 0.843 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.710813045501709
Epoch: 24, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.828 Vali Acc: 0.722 Test Loss: 0.828 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6469745635986328
Epoch: 25, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.820 Vali Acc: 0.706 Test Loss: 0.820 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6738088130950928
Epoch: 26, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.798 Vali Acc: 0.694 Test Loss: 0.798 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4917676448822021
Epoch: 27, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.797 Vali Acc: 0.689 Test Loss: 0.797 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5790083408355713
Epoch: 28, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.793 Vali Acc: 0.700 Test Loss: 0.793 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4968888759613037
Epoch: 29, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.785 Vali Acc: 0.717 Test Loss: 0.785 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.703256368637085
Epoch: 30, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.790 Vali Acc: 0.711 Test Loss: 0.790 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7277777777777777
model parameter : 304255
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.184199810028076
Epoch: 1, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.732 Vali Acc: 0.067 Test Loss: 2.732 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.3800697326660156
Epoch: 2, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.651 Vali Acc: 0.083 Test Loss: 2.651 Test Acc: 0.083
Validation loss decreased (-0.066639 --> -0.083307).  Saving model ...
Epoch: 3 cost time: 1.300339937210083
Epoch: 3, Steps: 12 | Train Loss: 2.575 Vali Loss: 2.544 Vali Acc: 0.139 Test Loss: 2.544 Test Acc: 0.139
Validation loss decreased (-0.083307 --> -0.138863).  Saving model ...
Epoch: 4 cost time: 1.3566908836364746
Epoch: 4, Steps: 12 | Train Loss: 2.458 Vali Loss: 2.421 Vali Acc: 0.228 Test Loss: 2.421 Test Acc: 0.228
Validation loss decreased (-0.138863 --> -0.227754).  Saving model ...
Epoch: 5 cost time: 1.3347413539886475
Epoch: 5, Steps: 12 | Train Loss: 2.312 Vali Loss: 2.295 Vali Acc: 0.439 Test Loss: 2.295 Test Acc: 0.439
Validation loss decreased (-0.227754 --> -0.438866).  Saving model ...
Epoch: 6 cost time: 1.3919093608856201
Epoch: 6, Steps: 12 | Train Loss: 2.166 Vali Loss: 2.162 Vali Acc: 0.489 Test Loss: 2.162 Test Acc: 0.489
Validation loss decreased (-0.438866 --> -0.488867).  Saving model ...
Epoch: 7 cost time: 1.4311716556549072
Epoch: 7, Steps: 12 | Train Loss: 2.026 Vali Loss: 2.034 Vali Acc: 0.500 Test Loss: 2.034 Test Acc: 0.500
Validation loss decreased (-0.488867 --> -0.499980).  Saving model ...
Epoch: 8 cost time: 1.4269037246704102
Epoch: 8, Steps: 12 | Train Loss: 1.886 Vali Loss: 1.899 Vali Acc: 0.533 Test Loss: 1.899 Test Acc: 0.533
Validation loss decreased (-0.499980 --> -0.533314).  Saving model ...
Epoch: 9 cost time: 1.4280691146850586
Epoch: 9, Steps: 12 | Train Loss: 1.707 Vali Loss: 1.773 Vali Acc: 0.561 Test Loss: 1.773 Test Acc: 0.561
Validation loss decreased (-0.533314 --> -0.561093).  Saving model ...
Epoch: 10 cost time: 1.3644826412200928
Epoch: 10, Steps: 12 | Train Loss: 1.523 Vali Loss: 1.646 Vali Acc: 0.572 Test Loss: 1.646 Test Acc: 0.572
Validation loss decreased (-0.561093 --> -0.572206).  Saving model ...
Epoch: 11 cost time: 1.4604651927947998
Epoch: 11, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.539 Vali Acc: 0.600 Test Loss: 1.539 Test Acc: 0.600
Validation loss decreased (-0.572206 --> -0.599985).  Saving model ...
Epoch: 12 cost time: 1.3431353569030762
Epoch: 12, Steps: 12 | Train Loss: 1.351 Vali Loss: 1.433 Vali Acc: 0.600 Test Loss: 1.433 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599986).  Saving model ...
Epoch: 13 cost time: 1.3564043045043945
Epoch: 13, Steps: 12 | Train Loss: 1.185 Vali Loss: 1.340 Vali Acc: 0.578 Test Loss: 1.340 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4199354648590088
Epoch: 14, Steps: 12 | Train Loss: 1.137 Vali Loss: 1.252 Vali Acc: 0.589 Test Loss: 1.252 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.487119436264038
Epoch: 15, Steps: 12 | Train Loss: 0.969 Vali Loss: 1.188 Vali Acc: 0.600 Test Loss: 1.188 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 1.483839750289917
Epoch: 16, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.108 Vali Acc: 0.606 Test Loss: 1.108 Test Acc: 0.606
Validation loss decreased (-0.599988 --> -0.605544).  Saving model ...
Epoch: 17 cost time: 1.4777631759643555
Epoch: 17, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.047 Vali Acc: 0.617 Test Loss: 1.047 Test Acc: 0.617
Validation loss decreased (-0.605544 --> -0.616656).  Saving model ...
Epoch: 18 cost time: 1.495253086090088
Epoch: 18, Steps: 12 | Train Loss: 0.794 Vali Loss: 1.000 Vali Acc: 0.622 Test Loss: 1.000 Test Acc: 0.622
Validation loss decreased (-0.616656 --> -0.622212).  Saving model ...
Epoch: 19 cost time: 1.3505356311798096
Epoch: 19, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.949 Vali Acc: 0.639 Test Loss: 0.949 Test Acc: 0.639
Validation loss decreased (-0.622212 --> -0.638879).  Saving model ...
Epoch: 20 cost time: 1.4134368896484375
Epoch: 20, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.910 Vali Acc: 0.667 Test Loss: 0.910 Test Acc: 0.667
Validation loss decreased (-0.638879 --> -0.666658).  Saving model ...
Epoch: 21 cost time: 1.4466016292572021
Epoch: 21, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.882 Vali Acc: 0.678 Test Loss: 0.882 Test Acc: 0.678
Validation loss decreased (-0.666658 --> -0.677769).  Saving model ...
Epoch: 22 cost time: 1.405773401260376
Epoch: 22, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.853 Vali Acc: 0.700 Test Loss: 0.853 Test Acc: 0.700
Validation loss decreased (-0.677769 --> -0.699991).  Saving model ...
Epoch: 23 cost time: 1.2020928859710693
Epoch: 23, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.823 Vali Acc: 0.706 Test Loss: 0.823 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705547).  Saving model ...
Epoch: 24 cost time: 1.544865369796753
Epoch: 24, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.803 Vali Acc: 0.706 Test Loss: 0.803 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705548).  Saving model ...
Epoch: 25 cost time: 1.4776415824890137
Epoch: 25, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.788 Vali Acc: 0.717 Test Loss: 0.788 Test Acc: 0.717
Validation loss decreased (-0.705548 --> -0.716659).  Saving model ...
Epoch: 26 cost time: 1.5329310894012451
Epoch: 26, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.761 Vali Acc: 0.722 Test Loss: 0.761 Test Acc: 0.722
Validation loss decreased (-0.716659 --> -0.722215).  Saving model ...
Epoch: 27 cost time: 1.463374376296997
Epoch: 27, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.749 Vali Acc: 0.728 Test Loss: 0.749 Test Acc: 0.728
Validation loss decreased (-0.722215 --> -0.727770).  Saving model ...
Epoch: 28 cost time: 1.5382015705108643
Epoch: 28, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.738 Vali Acc: 0.717 Test Loss: 0.738 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5403809547424316
Epoch: 29, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.729 Vali Acc: 0.728 Test Loss: 0.729 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727770).  Saving model ...
Epoch: 30 cost time: 1.5854370594024658
Epoch: 30, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.726 Vali Acc: 0.733 Test Loss: 0.726 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733326).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7333333333333333
model parameter : 97279
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8093793392181396
Epoch: 1, Steps: 12 | Train Loss: 2.753 Vali Loss: 2.674 Vali Acc: 0.117 Test Loss: 2.674 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 1.2972311973571777
Epoch: 2, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.593 Vali Acc: 0.178 Test Loss: 2.593 Test Acc: 0.178
Validation loss decreased (-0.116640 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 1.4138424396514893
Epoch: 3, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.486 Vali Acc: 0.256 Test Loss: 2.486 Test Acc: 0.256
Validation loss decreased (-0.177752 --> -0.255531).  Saving model ...
Epoch: 4 cost time: 1.4454145431518555
Epoch: 4, Steps: 12 | Train Loss: 2.421 Vali Loss: 2.367 Vali Acc: 0.344 Test Loss: 2.367 Test Acc: 0.344
Validation loss decreased (-0.255531 --> -0.344421).  Saving model ...
Epoch: 5 cost time: 1.4927186965942383
Epoch: 5, Steps: 12 | Train Loss: 2.305 Vali Loss: 2.248 Vali Acc: 0.439 Test Loss: 2.248 Test Acc: 0.439
Validation loss decreased (-0.344421 --> -0.438866).  Saving model ...
Epoch: 6 cost time: 1.411832571029663
Epoch: 6, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.123 Vali Acc: 0.511 Test Loss: 2.123 Test Acc: 0.511
Validation loss decreased (-0.438866 --> -0.511090).  Saving model ...
Epoch: 7 cost time: 1.4206905364990234
Epoch: 7, Steps: 12 | Train Loss: 2.020 Vali Loss: 2.001 Vali Acc: 0.539 Test Loss: 2.001 Test Acc: 0.539
Validation loss decreased (-0.511090 --> -0.538869).  Saving model ...
Epoch: 8 cost time: 1.4664924144744873
Epoch: 8, Steps: 12 | Train Loss: 1.880 Vali Loss: 1.880 Vali Acc: 0.556 Test Loss: 1.880 Test Acc: 0.556
Validation loss decreased (-0.538869 --> -0.555537).  Saving model ...
Epoch: 9 cost time: 1.5475566387176514
Epoch: 9, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.764 Vali Acc: 0.561 Test Loss: 1.764 Test Acc: 0.561
Validation loss decreased (-0.555537 --> -0.561093).  Saving model ...
Epoch: 10 cost time: 1.5528502464294434
Epoch: 10, Steps: 12 | Train Loss: 1.624 Vali Loss: 1.650 Vali Acc: 0.583 Test Loss: 1.650 Test Acc: 0.583
Validation loss decreased (-0.561093 --> -0.583317).  Saving model ...
Epoch: 11 cost time: 1.3743939399719238
Epoch: 11, Steps: 12 | Train Loss: 1.461 Vali Loss: 1.551 Vali Acc: 0.589 Test Loss: 1.551 Test Acc: 0.589
Validation loss decreased (-0.583317 --> -0.588873).  Saving model ...
Epoch: 12 cost time: 1.5467164516448975
Epoch: 12, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.464 Vali Acc: 0.600 Test Loss: 1.464 Test Acc: 0.600
Validation loss decreased (-0.588873 --> -0.599985).  Saving model ...
Epoch: 13 cost time: 1.4370934963226318
Epoch: 13, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.401 Vali Acc: 0.583 Test Loss: 1.401 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4859237670898438
Epoch: 14, Steps: 12 | Train Loss: 1.145 Vali Loss: 1.329 Vali Acc: 0.600 Test Loss: 1.329 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599987).  Saving model ...
Epoch: 15 cost time: 1.5172343254089355
Epoch: 15, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.270 Vali Acc: 0.611 Test Loss: 1.270 Test Acc: 0.611
Validation loss decreased (-0.599987 --> -0.611098).  Saving model ...
Epoch: 16 cost time: 1.4391520023345947
Epoch: 16, Steps: 12 | Train Loss: 1.007 Vali Loss: 1.216 Vali Acc: 0.622 Test Loss: 1.216 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622210).  Saving model ...
Epoch: 17 cost time: 1.4495525360107422
Epoch: 17, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.177 Vali Acc: 0.633 Test Loss: 1.177 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633322).  Saving model ...
Epoch: 18 cost time: 1.4058465957641602
Epoch: 18, Steps: 12 | Train Loss: 0.901 Vali Loss: 1.127 Vali Acc: 0.639 Test Loss: 1.127 Test Acc: 0.639
Validation loss decreased (-0.633322 --> -0.638878).  Saving model ...
Epoch: 19 cost time: 1.4677424430847168
Epoch: 19, Steps: 12 | Train Loss: 0.857 Vali Loss: 1.088 Vali Acc: 0.672 Test Loss: 1.088 Test Acc: 0.672
Validation loss decreased (-0.638878 --> -0.672211).  Saving model ...
Epoch: 20 cost time: 1.433631181716919
Epoch: 20, Steps: 12 | Train Loss: 0.803 Vali Loss: 1.058 Vali Acc: 0.661 Test Loss: 1.058 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5733063220977783
Epoch: 21, Steps: 12 | Train Loss: 0.708 Vali Loss: 1.018 Vali Acc: 0.667 Test Loss: 1.018 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5650651454925537
Epoch: 22, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.993 Vali Acc: 0.683 Test Loss: 0.993 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 23 cost time: 1.4801039695739746
Epoch: 23, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.974 Vali Acc: 0.683 Test Loss: 0.974 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683324).  Saving model ...
Epoch: 24 cost time: 1.5117974281311035
Epoch: 24, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.947 Vali Acc: 0.683 Test Loss: 0.947 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683324).  Saving model ...
Epoch: 25 cost time: 1.464062213897705
Epoch: 25, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.931 Vali Acc: 0.683 Test Loss: 0.931 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683324).  Saving model ...
Epoch: 26 cost time: 1.5289254188537598
Epoch: 26, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.906 Vali Acc: 0.694 Test Loss: 0.906 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694435).  Saving model ...
Epoch: 27 cost time: 1.5350642204284668
Epoch: 27, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.888 Vali Acc: 0.683 Test Loss: 0.888 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.462655782699585
Epoch: 28, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.869 Vali Acc: 0.683 Test Loss: 0.869 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3664867877960205
Epoch: 29, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.853 Vali Acc: 0.694 Test Loss: 0.853 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694436).  Saving model ...
Epoch: 30 cost time: 1.6307084560394287
Epoch: 30, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.832 Vali Acc: 0.694 Test Loss: 0.832 Test Acc: 0.694
Validation loss decreased (-0.694436 --> -0.694436).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6944444444444444
model parameter : 304255
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.822969436645508
Epoch: 1, Steps: 12 | Train Loss: 2.763 Vali Loss: 2.732 Vali Acc: 0.067 Test Loss: 2.732 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.3546819686889648
Epoch: 2, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.655 Vali Acc: 0.072 Test Loss: 2.655 Test Acc: 0.072
Validation loss decreased (-0.066639 --> -0.072196).  Saving model ...
Epoch: 3 cost time: 1.2983920574188232
Epoch: 3, Steps: 12 | Train Loss: 2.586 Vali Loss: 2.553 Vali Acc: 0.128 Test Loss: 2.553 Test Acc: 0.128
Validation loss decreased (-0.072196 --> -0.127752).  Saving model ...
Epoch: 4 cost time: 1.3371179103851318
Epoch: 4, Steps: 12 | Train Loss: 2.474 Vali Loss: 2.437 Vali Acc: 0.233 Test Loss: 2.437 Test Acc: 0.233
Validation loss decreased (-0.127752 --> -0.233309).  Saving model ...
Epoch: 5 cost time: 1.2558741569519043
Epoch: 5, Steps: 12 | Train Loss: 2.338 Vali Loss: 2.319 Vali Acc: 0.422 Test Loss: 2.319 Test Acc: 0.422
Validation loss decreased (-0.233309 --> -0.422199).  Saving model ...
Epoch: 6 cost time: 1.3160665035247803
Epoch: 6, Steps: 12 | Train Loss: 2.203 Vali Loss: 2.194 Vali Acc: 0.461 Test Loss: 2.194 Test Acc: 0.461
Validation loss decreased (-0.422199 --> -0.461089).  Saving model ...
Epoch: 7 cost time: 1.2415847778320312
Epoch: 7, Steps: 12 | Train Loss: 2.083 Vali Loss: 2.077 Vali Acc: 0.489 Test Loss: 2.077 Test Acc: 0.489
Validation loss decreased (-0.461089 --> -0.488868).  Saving model ...
Epoch: 8 cost time: 1.3314099311828613
Epoch: 8, Steps: 12 | Train Loss: 1.947 Vali Loss: 1.955 Vali Acc: 0.506 Test Loss: 1.955 Test Acc: 0.506
Validation loss decreased (-0.488868 --> -0.505536).  Saving model ...
Epoch: 9 cost time: 1.2991611957550049
Epoch: 9, Steps: 12 | Train Loss: 1.785 Vali Loss: 1.846 Vali Acc: 0.550 Test Loss: 1.846 Test Acc: 0.550
Validation loss decreased (-0.505536 --> -0.549982).  Saving model ...
Epoch: 10 cost time: 1.2852935791015625
Epoch: 10, Steps: 12 | Train Loss: 1.625 Vali Loss: 1.734 Vali Acc: 0.567 Test Loss: 1.734 Test Acc: 0.567
Validation loss decreased (-0.549982 --> -0.566649).  Saving model ...
Epoch: 11 cost time: 1.2918801307678223
Epoch: 11, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.640 Vali Acc: 0.578 Test Loss: 1.640 Test Acc: 0.578
Validation loss decreased (-0.566649 --> -0.577761).  Saving model ...
Epoch: 12 cost time: 1.358658790588379
Epoch: 12, Steps: 12 | Train Loss: 1.473 Vali Loss: 1.550 Vali Acc: 0.583 Test Loss: 1.550 Test Acc: 0.583
Validation loss decreased (-0.577761 --> -0.583318).  Saving model ...
Epoch: 13 cost time: 1.2659316062927246
Epoch: 13, Steps: 12 | Train Loss: 1.315 Vali Loss: 1.471 Vali Acc: 0.556 Test Loss: 1.471 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2327122688293457
Epoch: 14, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.395 Vali Acc: 0.572 Test Loss: 1.395 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2514595985412598
Epoch: 15, Steps: 12 | Train Loss: 1.124 Vali Loss: 1.336 Vali Acc: 0.583 Test Loss: 1.336 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583320).  Saving model ...
Epoch: 16 cost time: 1.165097713470459
Epoch: 16, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.274 Vali Acc: 0.583 Test Loss: 1.274 Test Acc: 0.583
Validation loss decreased (-0.583320 --> -0.583321).  Saving model ...
Epoch: 17 cost time: 1.3147814273834229
Epoch: 17, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.221 Vali Acc: 0.567 Test Loss: 1.221 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2799978256225586
Epoch: 18, Steps: 12 | Train Loss: 0.936 Vali Loss: 1.175 Vali Acc: 0.589 Test Loss: 1.175 Test Acc: 0.589
Validation loss decreased (-0.583321 --> -0.588877).  Saving model ...
Epoch: 19 cost time: 1.1875250339508057
Epoch: 19, Steps: 12 | Train Loss: 0.854 Vali Loss: 1.129 Vali Acc: 0.606 Test Loss: 1.129 Test Acc: 0.606
Validation loss decreased (-0.588877 --> -0.605544).  Saving model ...
Epoch: 20 cost time: 1.1715984344482422
Epoch: 20, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.090 Vali Acc: 0.639 Test Loss: 1.090 Test Acc: 0.639
Validation loss decreased (-0.605544 --> -0.638878).  Saving model ...
Epoch: 21 cost time: 1.1914002895355225
Epoch: 21, Steps: 12 | Train Loss: 0.741 Vali Loss: 1.063 Vali Acc: 0.639 Test Loss: 1.063 Test Acc: 0.639
Validation loss decreased (-0.638878 --> -0.638878).  Saving model ...
Epoch: 22 cost time: 1.3359344005584717
Epoch: 22, Steps: 12 | Train Loss: 0.702 Vali Loss: 1.030 Vali Acc: 0.656 Test Loss: 1.030 Test Acc: 0.656
Validation loss decreased (-0.638878 --> -0.655545).  Saving model ...
Epoch: 23 cost time: 1.170952558517456
Epoch: 23, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.998 Vali Acc: 0.650 Test Loss: 0.998 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2948050498962402
Epoch: 24, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.977 Vali Acc: 0.667 Test Loss: 0.977 Test Acc: 0.667
Validation loss decreased (-0.655545 --> -0.666657).  Saving model ...
Epoch: 25 cost time: 1.194563865661621
Epoch: 25, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.955 Vali Acc: 0.667 Test Loss: 0.955 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 26 cost time: 1.1701109409332275
Epoch: 26, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.929 Vali Acc: 0.678 Test Loss: 0.929 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677768).  Saving model ...
Epoch: 27 cost time: 1.20328688621521
Epoch: 27, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.911 Vali Acc: 0.678 Test Loss: 0.911 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677769).  Saving model ...
Epoch: 28 cost time: 1.19846773147583
Epoch: 28, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.901 Vali Acc: 0.694 Test Loss: 0.901 Test Acc: 0.694
Validation loss decreased (-0.677769 --> -0.694435).  Saving model ...
Epoch: 29 cost time: 1.2323338985443115
Epoch: 29, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.877 Vali Acc: 0.667 Test Loss: 0.877 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2151050567626953
Epoch: 30, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.877 Vali Acc: 0.678 Test Loss: 0.877 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6944444444444444
model parameter : 97279
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8201770782470703
Epoch: 1, Steps: 12 | Train Loss: 2.835 Vali Loss: 2.804 Vali Acc: 0.072 Test Loss: 2.804 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 2.1731128692626953
Epoch: 2, Steps: 12 | Train Loss: 2.784 Vali Loss: 2.754 Vali Acc: 0.078 Test Loss: 2.754 Test Acc: 0.078
Validation loss decreased (-0.072194 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 2.1146984100341797
Epoch: 3, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.690 Vali Acc: 0.100 Test Loss: 2.690 Test Acc: 0.100
Validation loss decreased (-0.077750 --> -0.099973).  Saving model ...
Epoch: 4 cost time: 2.186706781387329
Epoch: 4, Steps: 12 | Train Loss: 2.643 Vali Loss: 2.611 Vali Acc: 0.150 Test Loss: 2.611 Test Acc: 0.150
Validation loss decreased (-0.099973 --> -0.149974).  Saving model ...
Epoch: 5 cost time: 2.1648178100585938
Epoch: 5, Steps: 12 | Train Loss: 2.519 Vali Loss: 2.519 Vali Acc: 0.250 Test Loss: 2.519 Test Acc: 0.250
Validation loss decreased (-0.149974 --> -0.249975).  Saving model ...
Epoch: 6 cost time: 2.205624580383301
Epoch: 6, Steps: 12 | Train Loss: 2.410 Vali Loss: 2.418 Vali Acc: 0.311 Test Loss: 2.418 Test Acc: 0.311
Validation loss decreased (-0.249975 --> -0.311087).  Saving model ...
Epoch: 7 cost time: 2.203415632247925
Epoch: 7, Steps: 12 | Train Loss: 2.323 Vali Loss: 2.308 Vali Acc: 0.406 Test Loss: 2.308 Test Acc: 0.406
Validation loss decreased (-0.311087 --> -0.405532).  Saving model ...
Epoch: 8 cost time: 2.2079882621765137
Epoch: 8, Steps: 12 | Train Loss: 2.181 Vali Loss: 2.190 Vali Acc: 0.467 Test Loss: 2.190 Test Acc: 0.467
Validation loss decreased (-0.405532 --> -0.466645).  Saving model ...
Epoch: 9 cost time: 2.2235829830169678
Epoch: 9, Steps: 12 | Train Loss: 2.030 Vali Loss: 2.071 Vali Acc: 0.522 Test Loss: 2.071 Test Acc: 0.522
Validation loss decreased (-0.466645 --> -0.522202).  Saving model ...
Epoch: 10 cost time: 2.1746039390563965
Epoch: 10, Steps: 12 | Train Loss: 1.922 Vali Loss: 1.953 Vali Acc: 0.533 Test Loss: 1.953 Test Acc: 0.533
Validation loss decreased (-0.522202 --> -0.533314).  Saving model ...
Epoch: 11 cost time: 2.1874537467956543
Epoch: 11, Steps: 12 | Train Loss: 1.783 Vali Loss: 1.823 Vali Acc: 0.550 Test Loss: 1.823 Test Acc: 0.550
Validation loss decreased (-0.533314 --> -0.549982).  Saving model ...
Epoch: 12 cost time: 2.1611273288726807
Epoch: 12, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.699 Vali Acc: 0.578 Test Loss: 1.699 Test Acc: 0.578
Validation loss decreased (-0.549982 --> -0.577761).  Saving model ...
Epoch: 13 cost time: 2.19273042678833
Epoch: 13, Steps: 12 | Train Loss: 1.512 Vali Loss: 1.583 Vali Acc: 0.606 Test Loss: 1.583 Test Acc: 0.606
Validation loss decreased (-0.577761 --> -0.605540).  Saving model ...
Epoch: 14 cost time: 2.334085464477539
Epoch: 14, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.465 Vali Acc: 0.628 Test Loss: 1.465 Test Acc: 0.628
Validation loss decreased (-0.605540 --> -0.627763).  Saving model ...
Epoch: 15 cost time: 2.2332704067230225
Epoch: 15, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.369 Vali Acc: 0.639 Test Loss: 1.369 Test Acc: 0.639
Validation loss decreased (-0.627763 --> -0.638875).  Saving model ...
Epoch: 16 cost time: 2.33030104637146
Epoch: 16, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.296 Vali Acc: 0.650 Test Loss: 1.296 Test Acc: 0.650
Validation loss decreased (-0.638875 --> -0.649987).  Saving model ...
Epoch: 17 cost time: 2.2941062450408936
Epoch: 17, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.211 Vali Acc: 0.633 Test Loss: 1.211 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3658947944641113
Epoch: 18, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.147 Vali Acc: 0.678 Test Loss: 1.147 Test Acc: 0.678
Validation loss decreased (-0.649987 --> -0.677766).  Saving model ...
Epoch: 19 cost time: 2.432431936264038
Epoch: 19, Steps: 12 | Train Loss: 0.945 Vali Loss: 1.090 Vali Acc: 0.689 Test Loss: 1.090 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688878).  Saving model ...
Epoch: 20 cost time: 2.3504467010498047
Epoch: 20, Steps: 12 | Train Loss: 0.930 Vali Loss: 1.051 Vali Acc: 0.689 Test Loss: 1.051 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 21 cost time: 2.331486940383911
Epoch: 21, Steps: 12 | Train Loss: 0.795 Vali Loss: 1.010 Vali Acc: 0.683 Test Loss: 1.010 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3194491863250732
Epoch: 22, Steps: 12 | Train Loss: 0.784 Vali Loss: 0.975 Vali Acc: 0.700 Test Loss: 0.975 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 2.3036623001098633
Epoch: 23, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.930 Vali Acc: 0.706 Test Loss: 0.930 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 24 cost time: 2.410020589828491
Epoch: 24, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.912 Vali Acc: 0.700 Test Loss: 0.912 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3325319290161133
Epoch: 25, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.883 Vali Acc: 0.711 Test Loss: 0.883 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 26 cost time: 2.2443814277648926
Epoch: 26, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.865 Vali Acc: 0.706 Test Loss: 0.865 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.318270444869995
Epoch: 27, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.847 Vali Acc: 0.706 Test Loss: 0.847 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.358861207962036
Epoch: 28, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.821 Vali Acc: 0.717 Test Loss: 0.821 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 29 cost time: 2.3439676761627197
Epoch: 29, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.807 Vali Acc: 0.717 Test Loss: 0.807 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716659).  Saving model ...
Epoch: 30 cost time: 2.4057998657226562
Epoch: 30, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.795 Vali Acc: 0.722 Test Loss: 0.795 Test Acc: 0.722
Validation loss decreased (-0.716659 --> -0.722214).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7222222222222222
model parameter : 592103
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6799545288085938
Epoch: 1, Steps: 12 | Train Loss: 2.730 Vali Loss: 2.712 Vali Acc: 0.094 Test Loss: 2.712 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 1.9799954891204834
Epoch: 2, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.663 Vali Acc: 0.111 Test Loss: 2.663 Test Acc: 0.111
Validation loss decreased (-0.094417 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 2.0365424156188965
Epoch: 3, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.601 Vali Acc: 0.133 Test Loss: 2.601 Test Acc: 0.133
Validation loss decreased (-0.111084 --> -0.133307).  Saving model ...
Epoch: 4 cost time: 1.997300624847412
Epoch: 4, Steps: 12 | Train Loss: 2.580 Vali Loss: 2.528 Vali Acc: 0.200 Test Loss: 2.528 Test Acc: 0.200
Validation loss decreased (-0.133307 --> -0.199975).  Saving model ...
Epoch: 5 cost time: 1.9473440647125244
Epoch: 5, Steps: 12 | Train Loss: 2.470 Vali Loss: 2.449 Vali Acc: 0.261 Test Loss: 2.449 Test Acc: 0.261
Validation loss decreased (-0.199975 --> -0.261087).  Saving model ...
Epoch: 6 cost time: 1.9928038120269775
Epoch: 6, Steps: 12 | Train Loss: 2.408 Vali Loss: 2.363 Vali Acc: 0.317 Test Loss: 2.363 Test Acc: 0.317
Validation loss decreased (-0.261087 --> -0.316643).  Saving model ...
Epoch: 7 cost time: 1.9077458381652832
Epoch: 7, Steps: 12 | Train Loss: 2.289 Vali Loss: 2.271 Vali Acc: 0.344 Test Loss: 2.271 Test Acc: 0.344
Validation loss decreased (-0.316643 --> -0.344422).  Saving model ...
Epoch: 8 cost time: 1.9807512760162354
Epoch: 8, Steps: 12 | Train Loss: 2.191 Vali Loss: 2.172 Vali Acc: 0.411 Test Loss: 2.172 Test Acc: 0.411
Validation loss decreased (-0.344422 --> -0.411089).  Saving model ...
Epoch: 9 cost time: 1.9937379360198975
Epoch: 9, Steps: 12 | Train Loss: 2.113 Vali Loss: 2.070 Vali Acc: 0.433 Test Loss: 2.070 Test Acc: 0.433
Validation loss decreased (-0.411089 --> -0.433313).  Saving model ...
Epoch: 10 cost time: 1.925238847732544
Epoch: 10, Steps: 12 | Train Loss: 1.954 Vali Loss: 1.966 Vali Acc: 0.483 Test Loss: 1.966 Test Acc: 0.483
Validation loss decreased (-0.433313 --> -0.483314).  Saving model ...
Epoch: 11 cost time: 2.0125601291656494
Epoch: 11, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.856 Vali Acc: 0.533 Test Loss: 1.856 Test Acc: 0.533
Validation loss decreased (-0.483314 --> -0.533315).  Saving model ...
Epoch: 12 cost time: 1.977806568145752
Epoch: 12, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.746 Vali Acc: 0.567 Test Loss: 1.746 Test Acc: 0.567
Validation loss decreased (-0.533315 --> -0.566649).  Saving model ...
Epoch: 13 cost time: 1.9525113105773926
Epoch: 13, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.640 Vali Acc: 0.567 Test Loss: 1.640 Test Acc: 0.567
Validation loss decreased (-0.566649 --> -0.566650).  Saving model ...
Epoch: 14 cost time: 1.9988553524017334
Epoch: 14, Steps: 12 | Train Loss: 1.530 Vali Loss: 1.539 Vali Acc: 0.589 Test Loss: 1.539 Test Acc: 0.589
Validation loss decreased (-0.566650 --> -0.588873).  Saving model ...
Epoch: 15 cost time: 1.980126142501831
Epoch: 15, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.455 Vali Acc: 0.611 Test Loss: 1.455 Test Acc: 0.611
Validation loss decreased (-0.588873 --> -0.611097).  Saving model ...
Epoch: 16 cost time: 1.965005874633789
Epoch: 16, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.361 Vali Acc: 0.639 Test Loss: 1.361 Test Acc: 0.639
Validation loss decreased (-0.611097 --> -0.638875).  Saving model ...
Epoch: 17 cost time: 2.0796000957489014
Epoch: 17, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.286 Vali Acc: 0.656 Test Loss: 1.286 Test Acc: 0.656
Validation loss decreased (-0.638875 --> -0.655543).  Saving model ...
Epoch: 18 cost time: 1.9271643161773682
Epoch: 18, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.218 Vali Acc: 0.661 Test Loss: 1.218 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661099).  Saving model ...
Epoch: 19 cost time: 1.931060552597046
Epoch: 19, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.171 Vali Acc: 0.650 Test Loss: 1.171 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.013702154159546
Epoch: 20, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9807472229003906
Epoch: 21, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.067 Vali Acc: 0.672 Test Loss: 1.067 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672212).  Saving model ...
Epoch: 22 cost time: 1.943145513534546
Epoch: 22, Steps: 12 | Train Loss: 0.817 Vali Loss: 1.019 Vali Acc: 0.689 Test Loss: 1.019 Test Acc: 0.689
Validation loss decreased (-0.672212 --> -0.688879).  Saving model ...
Epoch: 23 cost time: 1.9691104888916016
Epoch: 23, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.979 Vali Acc: 0.694 Test Loss: 0.979 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 24 cost time: 1.5925047397613525
Epoch: 24, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.949 Vali Acc: 0.700 Test Loss: 0.949 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 25 cost time: 1.8668229579925537
Epoch: 25, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.925 Vali Acc: 0.700 Test Loss: 0.925 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 26 cost time: 1.8881535530090332
Epoch: 26, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.906 Vali Acc: 0.706 Test Loss: 0.906 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705546).  Saving model ...
Epoch: 27 cost time: 1.921175241470337
Epoch: 27, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.889 Vali Acc: 0.722 Test Loss: 0.889 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 28 cost time: 1.9822356700897217
Epoch: 28, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.869 Vali Acc: 0.711 Test Loss: 0.869 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9108495712280273
Epoch: 29, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.853 Vali Acc: 0.717 Test Loss: 0.853 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8853259086608887
Epoch: 30, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.831 Vali Acc: 0.717 Test Loss: 0.831 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7222222222222222
model parameter : 178119
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6567487716674805
Epoch: 1, Steps: 12 | Train Loss: 2.834 Vali Loss: 2.804 Vali Acc: 0.072 Test Loss: 2.804 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 1.780536413192749
Epoch: 2, Steps: 12 | Train Loss: 2.786 Vali Loss: 2.755 Vali Acc: 0.078 Test Loss: 2.755 Test Acc: 0.078
Validation loss decreased (-0.072194 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 1.8058998584747314
Epoch: 3, Steps: 12 | Train Loss: 2.733 Vali Loss: 2.693 Vali Acc: 0.100 Test Loss: 2.693 Test Acc: 0.100
Validation loss decreased (-0.077750 --> -0.099973).  Saving model ...
Epoch: 4 cost time: 1.809004306793213
Epoch: 4, Steps: 12 | Train Loss: 2.652 Vali Loss: 2.617 Vali Acc: 0.150 Test Loss: 2.617 Test Acc: 0.150
Validation loss decreased (-0.099973 --> -0.149974).  Saving model ...
Epoch: 5 cost time: 1.8832554817199707
Epoch: 5, Steps: 12 | Train Loss: 2.532 Vali Loss: 2.532 Vali Acc: 0.250 Test Loss: 2.532 Test Acc: 0.250
Validation loss decreased (-0.149974 --> -0.249975).  Saving model ...
Epoch: 6 cost time: 1.834744930267334
Epoch: 6, Steps: 12 | Train Loss: 2.442 Vali Loss: 2.441 Vali Acc: 0.300 Test Loss: 2.441 Test Acc: 0.300
Validation loss decreased (-0.249975 --> -0.299976).  Saving model ...
Epoch: 7 cost time: 1.7257695198059082
Epoch: 7, Steps: 12 | Train Loss: 2.372 Vali Loss: 2.347 Vali Acc: 0.367 Test Loss: 2.347 Test Acc: 0.367
Validation loss decreased (-0.299976 --> -0.366643).  Saving model ...
Epoch: 8 cost time: 1.7282447814941406
Epoch: 8, Steps: 12 | Train Loss: 2.242 Vali Loss: 2.248 Vali Acc: 0.422 Test Loss: 2.248 Test Acc: 0.422
Validation loss decreased (-0.366643 --> -0.422200).  Saving model ...
Epoch: 9 cost time: 1.832824945449829
Epoch: 9, Steps: 12 | Train Loss: 2.113 Vali Loss: 2.142 Vali Acc: 0.483 Test Loss: 2.142 Test Acc: 0.483
Validation loss decreased (-0.422200 --> -0.483312).  Saving model ...
Epoch: 10 cost time: 1.7754559516906738
Epoch: 10, Steps: 12 | Train Loss: 2.018 Vali Loss: 2.033 Vali Acc: 0.483 Test Loss: 2.033 Test Acc: 0.483
Validation loss decreased (-0.483312 --> -0.483313).  Saving model ...
Epoch: 11 cost time: 1.8704054355621338
Epoch: 11, Steps: 12 | Train Loss: 1.882 Vali Loss: 1.916 Vali Acc: 0.494 Test Loss: 1.916 Test Acc: 0.494
Validation loss decreased (-0.483313 --> -0.494425).  Saving model ...
Epoch: 12 cost time: 1.9466300010681152
Epoch: 12, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.807 Vali Acc: 0.539 Test Loss: 1.807 Test Acc: 0.539
Validation loss decreased (-0.494425 --> -0.538871).  Saving model ...
Epoch: 13 cost time: 1.8728044033050537
Epoch: 13, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.706 Vali Acc: 0.561 Test Loss: 1.706 Test Acc: 0.561
Validation loss decreased (-0.538871 --> -0.561094).  Saving model ...
Epoch: 14 cost time: 1.8265902996063232
Epoch: 14, Steps: 12 | Train Loss: 1.528 Vali Loss: 1.605 Vali Acc: 0.578 Test Loss: 1.605 Test Acc: 0.578
Validation loss decreased (-0.561094 --> -0.577762).  Saving model ...
Epoch: 15 cost time: 1.866358757019043
Epoch: 15, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.516 Vali Acc: 0.600 Test Loss: 1.516 Test Acc: 0.600
Validation loss decreased (-0.577762 --> -0.599985).  Saving model ...
Epoch: 16 cost time: 1.8730409145355225
Epoch: 16, Steps: 12 | Train Loss: 1.297 Vali Loss: 1.443 Vali Acc: 0.617 Test Loss: 1.443 Test Acc: 0.617
Validation loss decreased (-0.599985 --> -0.616652).  Saving model ...
Epoch: 17 cost time: 1.813535213470459
Epoch: 17, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.363 Vali Acc: 0.617 Test Loss: 1.363 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616653).  Saving model ...
Epoch: 18 cost time: 1.8337247371673584
Epoch: 18, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.303 Vali Acc: 0.639 Test Loss: 1.303 Test Acc: 0.639
Validation loss decreased (-0.616653 --> -0.638876).  Saving model ...
Epoch: 19 cost time: 1.8981754779815674
Epoch: 19, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.245 Vali Acc: 0.656 Test Loss: 1.245 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655543).  Saving model ...
Epoch: 20 cost time: 1.8718724250793457
Epoch: 20, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.204 Vali Acc: 0.656 Test Loss: 1.204 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655544).  Saving model ...
Epoch: 21 cost time: 1.8141560554504395
Epoch: 21, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.156 Vali Acc: 0.656 Test Loss: 1.156 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 22 cost time: 1.8036198616027832
Epoch: 22, Steps: 12 | Train Loss: 0.891 Vali Loss: 1.119 Vali Acc: 0.661 Test Loss: 1.119 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 23 cost time: 1.8904838562011719
Epoch: 23, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.071 Vali Acc: 0.678 Test Loss: 1.071 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677767).  Saving model ...
Epoch: 24 cost time: 1.8337616920471191
Epoch: 24, Steps: 12 | Train Loss: 0.819 Vali Loss: 1.044 Vali Acc: 0.661 Test Loss: 1.044 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.894545555114746
Epoch: 25, Steps: 12 | Train Loss: 0.755 Vali Loss: 1.013 Vali Acc: 0.678 Test Loss: 1.013 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677768).  Saving model ...
Epoch: 26 cost time: 1.7526264190673828
Epoch: 26, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.998 Vali Acc: 0.667 Test Loss: 0.998 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.738910436630249
Epoch: 27, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.972 Vali Acc: 0.667 Test Loss: 0.972 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7498860359191895
Epoch: 28, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.935 Vali Acc: 0.700 Test Loss: 0.935 Test Acc: 0.700
Validation loss decreased (-0.677768 --> -0.699991).  Saving model ...
Epoch: 29 cost time: 1.8604156970977783
Epoch: 29, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.918 Vali Acc: 0.689 Test Loss: 0.918 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7877967357635498
Epoch: 30, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.897 Vali Acc: 0.683 Test Loss: 0.897 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7
model parameter : 592103
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.214454412460327
Epoch: 1, Steps: 12 | Train Loss: 2.731 Vali Loss: 2.712 Vali Acc: 0.094 Test Loss: 2.712 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 1.5931971073150635
Epoch: 2, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.665 Vali Acc: 0.117 Test Loss: 2.665 Test Acc: 0.117
Validation loss decreased (-0.094417 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 1.5907821655273438
Epoch: 3, Steps: 12 | Train Loss: 2.649 Vali Loss: 2.603 Vali Acc: 0.133 Test Loss: 2.603 Test Acc: 0.133
Validation loss decreased (-0.116640 --> -0.133307).  Saving model ...
Epoch: 4 cost time: 1.563997507095337
Epoch: 4, Steps: 12 | Train Loss: 2.583 Vali Loss: 2.531 Vali Acc: 0.194 Test Loss: 2.531 Test Acc: 0.194
Validation loss decreased (-0.133307 --> -0.194419).  Saving model ...
Epoch: 5 cost time: 1.5768871307373047
Epoch: 5, Steps: 12 | Train Loss: 2.479 Vali Loss: 2.454 Vali Acc: 0.261 Test Loss: 2.454 Test Acc: 0.261
Validation loss decreased (-0.194419 --> -0.261087).  Saving model ...
Epoch: 6 cost time: 1.5487794876098633
Epoch: 6, Steps: 12 | Train Loss: 2.414 Vali Loss: 2.370 Vali Acc: 0.306 Test Loss: 2.370 Test Acc: 0.306
Validation loss decreased (-0.261087 --> -0.305532).  Saving model ...
Epoch: 7 cost time: 1.5292212963104248
Epoch: 7, Steps: 12 | Train Loss: 2.301 Vali Loss: 2.281 Vali Acc: 0.344 Test Loss: 2.281 Test Acc: 0.344
Validation loss decreased (-0.305532 --> -0.344422).  Saving model ...
Epoch: 8 cost time: 1.5511767864227295
Epoch: 8, Steps: 12 | Train Loss: 2.213 Vali Loss: 2.184 Vali Acc: 0.422 Test Loss: 2.184 Test Acc: 0.422
Validation loss decreased (-0.344422 --> -0.422200).  Saving model ...
Epoch: 9 cost time: 1.5988690853118896
Epoch: 9, Steps: 12 | Train Loss: 2.129 Vali Loss: 2.086 Vali Acc: 0.439 Test Loss: 2.086 Test Acc: 0.439
Validation loss decreased (-0.422200 --> -0.438868).  Saving model ...
Epoch: 10 cost time: 1.5514366626739502
Epoch: 10, Steps: 12 | Train Loss: 1.976 Vali Loss: 1.987 Vali Acc: 0.483 Test Loss: 1.987 Test Acc: 0.483
Validation loss decreased (-0.438868 --> -0.483313).  Saving model ...
Epoch: 11 cost time: 1.5151023864746094
Epoch: 11, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.880 Vali Acc: 0.522 Test Loss: 1.880 Test Acc: 0.522
Validation loss decreased (-0.483313 --> -0.522203).  Saving model ...
Epoch: 12 cost time: 1.5359468460083008
Epoch: 12, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.778 Vali Acc: 0.539 Test Loss: 1.778 Test Acc: 0.539
Validation loss decreased (-0.522203 --> -0.538871).  Saving model ...
Epoch: 13 cost time: 1.5153062343597412
Epoch: 13, Steps: 12 | Train Loss: 1.633 Vali Loss: 1.680 Vali Acc: 0.561 Test Loss: 1.680 Test Acc: 0.561
Validation loss decreased (-0.538871 --> -0.561094).  Saving model ...
Epoch: 14 cost time: 1.5880649089813232
Epoch: 14, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.587 Vali Acc: 0.594 Test Loss: 1.587 Test Acc: 0.594
Validation loss decreased (-0.561094 --> -0.594429).  Saving model ...
Epoch: 15 cost time: 1.55672025680542
Epoch: 15, Steps: 12 | Train Loss: 1.434 Vali Loss: 1.510 Vali Acc: 0.633 Test Loss: 1.510 Test Acc: 0.633
Validation loss decreased (-0.594429 --> -0.633318).  Saving model ...
Epoch: 16 cost time: 1.5545506477355957
Epoch: 16, Steps: 12 | Train Loss: 1.332 Vali Loss: 1.423 Vali Acc: 0.639 Test Loss: 1.423 Test Acc: 0.639
Validation loss decreased (-0.633318 --> -0.638875).  Saving model ...
Epoch: 17 cost time: 1.5267086029052734
Epoch: 17, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.352 Vali Acc: 0.650 Test Loss: 1.352 Test Acc: 0.650
Validation loss decreased (-0.638875 --> -0.649986).  Saving model ...
Epoch: 18 cost time: 1.5481882095336914
Epoch: 18, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.292 Vali Acc: 0.661 Test Loss: 1.292 Test Acc: 0.661
Validation loss decreased (-0.649986 --> -0.661098).  Saving model ...
Epoch: 19 cost time: 1.5270390510559082
Epoch: 19, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.246 Vali Acc: 0.650 Test Loss: 1.246 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5266427993774414
Epoch: 20, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.199 Vali Acc: 0.628 Test Loss: 1.199 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5729904174804688
Epoch: 21, Steps: 12 | Train Loss: 0.953 Vali Loss: 1.155 Vali Acc: 0.644 Test Loss: 1.155 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.540208101272583
Epoch: 22, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.113 Vali Acc: 0.656 Test Loss: 1.113 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.541287899017334
Epoch: 23, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.070 Vali Acc: 0.650 Test Loss: 1.070 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5370140075683594
Epoch: 24, Steps: 12 | Train Loss: 0.802 Vali Loss: 1.039 Vali Acc: 0.683 Test Loss: 1.039 Test Acc: 0.683
Validation loss decreased (-0.661098 --> -0.683323).  Saving model ...
Epoch: 25 cost time: 1.5504870414733887
Epoch: 25, Steps: 12 | Train Loss: 0.767 Vali Loss: 1.014 Vali Acc: 0.661 Test Loss: 1.014 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5319468975067139
Epoch: 26, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.990 Vali Acc: 0.672 Test Loss: 0.990 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5883510112762451
Epoch: 27, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.971 Vali Acc: 0.672 Test Loss: 0.971 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6087639331817627
Epoch: 28, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.947 Vali Acc: 0.667 Test Loss: 0.947 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5728628635406494
Epoch: 29, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.932 Vali Acc: 0.667 Test Loss: 0.932 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.587294578552246
Epoch: 30, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.911 Vali Acc: 0.672 Test Loss: 0.911 Test Acc: 0.672
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6833333333333333
model parameter : 178119
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0192418098449707
Epoch: 1, Steps: 12 | Train Loss: 2.837 Vali Loss: 2.808 Vali Acc: 0.072 Test Loss: 2.808 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 1.2749831676483154
Epoch: 2, Steps: 12 | Train Loss: 2.794 Vali Loss: 2.770 Vali Acc: 0.078 Test Loss: 2.770 Test Acc: 0.078
Validation loss decreased (-0.072194 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 1.3773045539855957
Epoch: 3, Steps: 12 | Train Loss: 2.753 Vali Loss: 2.721 Vali Acc: 0.106 Test Loss: 2.721 Test Acc: 0.106
Validation loss decreased (-0.077750 --> -0.105528).  Saving model ...
Epoch: 4 cost time: 1.4132440090179443
Epoch: 4, Steps: 12 | Train Loss: 2.686 Vali Loss: 2.662 Vali Acc: 0.144 Test Loss: 2.662 Test Acc: 0.144
Validation loss decreased (-0.105528 --> -0.144418).  Saving model ...
Epoch: 5 cost time: 1.3860831260681152
Epoch: 5, Steps: 12 | Train Loss: 2.588 Vali Loss: 2.596 Vali Acc: 0.183 Test Loss: 2.596 Test Acc: 0.183
Validation loss decreased (-0.144418 --> -0.183307).  Saving model ...
Epoch: 6 cost time: 1.3470659255981445
Epoch: 6, Steps: 12 | Train Loss: 2.512 Vali Loss: 2.523 Vali Acc: 0.228 Test Loss: 2.523 Test Acc: 0.228
Validation loss decreased (-0.183307 --> -0.227753).  Saving model ...
Epoch: 7 cost time: 1.344022512435913
Epoch: 7, Steps: 12 | Train Loss: 2.470 Vali Loss: 2.448 Vali Acc: 0.261 Test Loss: 2.448 Test Acc: 0.261
Validation loss decreased (-0.227753 --> -0.261087).  Saving model ...
Epoch: 8 cost time: 1.410783052444458
Epoch: 8, Steps: 12 | Train Loss: 2.352 Vali Loss: 2.369 Vali Acc: 0.344 Test Loss: 2.369 Test Acc: 0.344
Validation loss decreased (-0.261087 --> -0.344421).  Saving model ...
Epoch: 9 cost time: 1.3649702072143555
Epoch: 9, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.283 Vali Acc: 0.389 Test Loss: 2.283 Test Acc: 0.389
Validation loss decreased (-0.344421 --> -0.388866).  Saving model ...
Epoch: 10 cost time: 1.3401567935943604
Epoch: 10, Steps: 12 | Train Loss: 2.151 Vali Loss: 2.197 Vali Acc: 0.389 Test Loss: 2.197 Test Acc: 0.389
Validation loss decreased (-0.388866 --> -0.388867).  Saving model ...
Epoch: 11 cost time: 1.319075345993042
Epoch: 11, Steps: 12 | Train Loss: 2.035 Vali Loss: 2.105 Vali Acc: 0.417 Test Loss: 2.105 Test Acc: 0.417
Validation loss decreased (-0.388867 --> -0.416646).  Saving model ...
Epoch: 12 cost time: 1.3185687065124512
Epoch: 12, Steps: 12 | Train Loss: 1.953 Vali Loss: 2.016 Vali Acc: 0.467 Test Loss: 2.016 Test Acc: 0.467
Validation loss decreased (-0.416646 --> -0.466647).  Saving model ...
Epoch: 13 cost time: 1.2598037719726562
Epoch: 13, Steps: 12 | Train Loss: 1.828 Vali Loss: 1.932 Vali Acc: 0.478 Test Loss: 1.932 Test Acc: 0.478
Validation loss decreased (-0.466647 --> -0.477758).  Saving model ...
Epoch: 14 cost time: 1.312356948852539
Epoch: 14, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.845 Vali Acc: 0.500 Test Loss: 1.845 Test Acc: 0.500
Validation loss decreased (-0.477758 --> -0.499982).  Saving model ...
Epoch: 15 cost time: 1.3177299499511719
Epoch: 15, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.765 Vali Acc: 0.517 Test Loss: 1.765 Test Acc: 0.517
Validation loss decreased (-0.499982 --> -0.516649).  Saving model ...
Epoch: 16 cost time: 1.356398105621338
Epoch: 16, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.695 Vali Acc: 0.517 Test Loss: 1.695 Test Acc: 0.517
Validation loss decreased (-0.516649 --> -0.516650).  Saving model ...
Epoch: 17 cost time: 1.3349380493164062
Epoch: 17, Steps: 12 | Train Loss: 1.485 Vali Loss: 1.604 Vali Acc: 0.544 Test Loss: 1.604 Test Acc: 0.544
Validation loss decreased (-0.516650 --> -0.544428).  Saving model ...
Epoch: 18 cost time: 1.3338732719421387
Epoch: 18, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.538 Vali Acc: 0.556 Test Loss: 1.538 Test Acc: 0.556
Validation loss decreased (-0.544428 --> -0.555540).  Saving model ...
Epoch: 19 cost time: 1.33115553855896
Epoch: 19, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.477 Vali Acc: 0.556 Test Loss: 1.477 Test Acc: 0.556
Validation loss decreased (-0.555540 --> -0.555541).  Saving model ...
Epoch: 20 cost time: 1.348038911819458
Epoch: 20, Steps: 12 | Train Loss: 1.251 Vali Loss: 1.427 Vali Acc: 0.567 Test Loss: 1.427 Test Acc: 0.567
Validation loss decreased (-0.555541 --> -0.566652).  Saving model ...
Epoch: 21 cost time: 1.3353664875030518
Epoch: 21, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.380 Vali Acc: 0.578 Test Loss: 1.380 Test Acc: 0.578
Validation loss decreased (-0.566652 --> -0.577764).  Saving model ...
Epoch: 22 cost time: 1.361201286315918
Epoch: 22, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.329 Vali Acc: 0.583 Test Loss: 1.329 Test Acc: 0.583
Validation loss decreased (-0.577764 --> -0.583320).  Saving model ...
Epoch: 23 cost time: 1.3115711212158203
Epoch: 23, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.276 Vali Acc: 0.606 Test Loss: 1.276 Test Acc: 0.606
Validation loss decreased (-0.583320 --> -0.605543).  Saving model ...
Epoch: 24 cost time: 1.1582868099212646
Epoch: 24, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.243 Vali Acc: 0.611 Test Loss: 1.243 Test Acc: 0.611
Validation loss decreased (-0.605543 --> -0.611099).  Saving model ...
Epoch: 25 cost time: 1.4196245670318604
Epoch: 25, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.192 Vali Acc: 0.639 Test Loss: 1.192 Test Acc: 0.639
Validation loss decreased (-0.611099 --> -0.638877).  Saving model ...
Epoch: 26 cost time: 1.3930737972259521
Epoch: 26, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.170 Vali Acc: 0.622 Test Loss: 1.170 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3988072872161865
Epoch: 27, Steps: 12 | Train Loss: 0.830 Vali Loss: 1.129 Vali Acc: 0.644 Test Loss: 1.129 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644433).  Saving model ...
Epoch: 28 cost time: 1.4116408824920654
Epoch: 28, Steps: 12 | Train Loss: 0.830 Vali Loss: 1.087 Vali Acc: 0.661 Test Loss: 1.087 Test Acc: 0.661
Validation loss decreased (-0.644433 --> -0.661100).  Saving model ...
Epoch: 29 cost time: 1.3736655712127686
Epoch: 29, Steps: 12 | Train Loss: 0.761 Vali Loss: 1.089 Vali Acc: 0.617 Test Loss: 1.089 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2622528076171875
Epoch: 30, Steps: 12 | Train Loss: 0.747 Vali Loss: 1.059 Vali Acc: 0.633 Test Loss: 1.059 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6611111111111111
model parameter : 592103
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.725571632385254
Epoch: 1, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.715 Vali Acc: 0.094 Test Loss: 2.715 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 1.2836742401123047
Epoch: 2, Steps: 12 | Train Loss: 2.728 Vali Loss: 2.673 Vali Acc: 0.117 Test Loss: 2.673 Test Acc: 0.117
Validation loss decreased (-0.094417 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 1.2903954982757568
Epoch: 3, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.619 Vali Acc: 0.128 Test Loss: 2.619 Test Acc: 0.128
Validation loss decreased (-0.116640 --> -0.127752).  Saving model ...
Epoch: 4 cost time: 1.2708995342254639
Epoch: 4, Steps: 12 | Train Loss: 2.599 Vali Loss: 2.557 Vali Acc: 0.178 Test Loss: 2.557 Test Acc: 0.178
Validation loss decreased (-0.127752 --> -0.177752).  Saving model ...
Epoch: 5 cost time: 1.346381425857544
Epoch: 5, Steps: 12 | Train Loss: 2.513 Vali Loss: 2.490 Vali Acc: 0.239 Test Loss: 2.490 Test Acc: 0.239
Validation loss decreased (-0.177752 --> -0.238864).  Saving model ...
Epoch: 6 cost time: 1.3183963298797607
Epoch: 6, Steps: 12 | Train Loss: 2.455 Vali Loss: 2.415 Vali Acc: 0.267 Test Loss: 2.415 Test Acc: 0.267
Validation loss decreased (-0.238864 --> -0.266643).  Saving model ...
Epoch: 7 cost time: 1.3143420219421387
Epoch: 7, Steps: 12 | Train Loss: 2.352 Vali Loss: 2.340 Vali Acc: 0.317 Test Loss: 2.340 Test Acc: 0.317
Validation loss decreased (-0.266643 --> -0.316643).  Saving model ...
Epoch: 8 cost time: 1.2851321697235107
Epoch: 8, Steps: 12 | Train Loss: 2.278 Vali Loss: 2.260 Vali Acc: 0.361 Test Loss: 2.260 Test Acc: 0.361
Validation loss decreased (-0.316643 --> -0.361089).  Saving model ...
Epoch: 9 cost time: 0.9356403350830078
Epoch: 9, Steps: 12 | Train Loss: 2.225 Vali Loss: 2.181 Vali Acc: 0.378 Test Loss: 2.181 Test Acc: 0.378
Validation loss decreased (-0.361089 --> -0.377756).  Saving model ...
Epoch: 10 cost time: 1.3065927028656006
Epoch: 10, Steps: 12 | Train Loss: 2.086 Vali Loss: 2.104 Vali Acc: 0.400 Test Loss: 2.104 Test Acc: 0.400
Validation loss decreased (-0.377756 --> -0.399979).  Saving model ...
Epoch: 11 cost time: 1.3522250652313232
Epoch: 11, Steps: 12 | Train Loss: 2.001 Vali Loss: 2.016 Vali Acc: 0.444 Test Loss: 2.016 Test Acc: 0.444
Validation loss decreased (-0.399979 --> -0.444424).  Saving model ...
Epoch: 12 cost time: 1.3105063438415527
Epoch: 12, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.934 Vali Acc: 0.494 Test Loss: 1.934 Test Acc: 0.494
Validation loss decreased (-0.444424 --> -0.494425).  Saving model ...
Epoch: 13 cost time: 1.2393755912780762
Epoch: 13, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.857 Vali Acc: 0.506 Test Loss: 1.857 Test Acc: 0.506
Validation loss decreased (-0.494425 --> -0.505537).  Saving model ...
Epoch: 14 cost time: 1.324251413345337
Epoch: 14, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.782 Vali Acc: 0.522 Test Loss: 1.782 Test Acc: 0.522
Validation loss decreased (-0.505537 --> -0.522204).  Saving model ...
Epoch: 15 cost time: 1.344552993774414
Epoch: 15, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.721 Vali Acc: 0.539 Test Loss: 1.721 Test Acc: 0.539
Validation loss decreased (-0.522204 --> -0.538872).  Saving model ...
Epoch: 16 cost time: 1.2569003105163574
Epoch: 16, Steps: 12 | Train Loss: 1.550 Vali Loss: 1.646 Vali Acc: 0.561 Test Loss: 1.646 Test Acc: 0.561
Validation loss decreased (-0.538872 --> -0.561095).  Saving model ...
Epoch: 17 cost time: 1.3536345958709717
Epoch: 17, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.581 Vali Acc: 0.578 Test Loss: 1.581 Test Acc: 0.578
Validation loss decreased (-0.561095 --> -0.577762).  Saving model ...
Epoch: 18 cost time: 1.300673246383667
Epoch: 18, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.521 Vali Acc: 0.572 Test Loss: 1.521 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3514621257781982
Epoch: 19, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.473 Vali Acc: 0.578 Test Loss: 1.473 Test Acc: 0.578
Validation loss decreased (-0.577762 --> -0.577763).  Saving model ...
Epoch: 20 cost time: 1.3247549533843994
Epoch: 20, Steps: 12 | Train Loss: 1.250 Vali Loss: 1.425 Vali Acc: 0.583 Test Loss: 1.425 Test Acc: 0.583
Validation loss decreased (-0.577763 --> -0.583319).  Saving model ...
Epoch: 21 cost time: 1.2771761417388916
Epoch: 21, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.376 Vali Acc: 0.578 Test Loss: 1.376 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.344782829284668
Epoch: 22, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.336 Vali Acc: 0.578 Test Loss: 1.336 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4138774871826172
Epoch: 23, Steps: 12 | Train Loss: 1.063 Vali Loss: 1.300 Vali Acc: 0.594 Test Loss: 1.300 Test Acc: 0.594
Validation loss decreased (-0.583319 --> -0.594431).  Saving model ...
Epoch: 24 cost time: 1.3115732669830322
Epoch: 24, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.269 Vali Acc: 0.611 Test Loss: 1.269 Test Acc: 0.611
Validation loss decreased (-0.594431 --> -0.611098).  Saving model ...
Epoch: 25 cost time: 1.294008731842041
Epoch: 25, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.238 Vali Acc: 0.589 Test Loss: 1.238 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3280653953552246
Epoch: 26, Steps: 12 | Train Loss: 0.952 Vali Loss: 1.218 Vali Acc: 0.611 Test Loss: 1.218 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611099).  Saving model ...
Epoch: 27 cost time: 1.368072509765625
Epoch: 27, Steps: 12 | Train Loss: 0.847 Vali Loss: 1.197 Vali Acc: 0.594 Test Loss: 1.197 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9569661617279053
Epoch: 28, Steps: 12 | Train Loss: 0.879 Vali Loss: 1.163 Vali Acc: 0.611 Test Loss: 1.163 Test Acc: 0.611
Validation loss decreased (-0.611099 --> -0.611099).  Saving model ...
Epoch: 29 cost time: 1.0615828037261963
Epoch: 29, Steps: 12 | Train Loss: 0.870 Vali Loss: 1.144 Vali Acc: 0.628 Test Loss: 1.144 Test Acc: 0.628
Validation loss decreased (-0.611099 --> -0.627766).  Saving model ...
Epoch: 30 cost time: 1.0877296924591064
Epoch: 30, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.111 Vali Acc: 0.622 Test Loss: 1.111 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6277777777777778
model parameter : 178119
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7471461296081543
Epoch: 1, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.654 Vali Acc: 0.150 Test Loss: 2.654 Test Acc: 0.150
Validation loss decreased (inf --> -0.149973).  Saving model ...
Epoch: 2 cost time: 1.8722620010375977
Epoch: 2, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.610 Vali Acc: 0.178 Test Loss: 2.610 Test Acc: 0.178
Validation loss decreased (-0.149973 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 1.888819932937622
Epoch: 3, Steps: 12 | Train Loss: 2.648 Vali Loss: 2.551 Vali Acc: 0.183 Test Loss: 2.551 Test Acc: 0.183
Validation loss decreased (-0.177752 --> -0.183308).  Saving model ...
Epoch: 4 cost time: 1.8616693019866943
Epoch: 4, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.482 Vali Acc: 0.228 Test Loss: 2.482 Test Acc: 0.228
Validation loss decreased (-0.183308 --> -0.227753).  Saving model ...
Epoch: 5 cost time: 1.8783247470855713
Epoch: 5, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.408 Vali Acc: 0.294 Test Loss: 2.408 Test Acc: 0.294
Validation loss decreased (-0.227753 --> -0.294420).  Saving model ...
Epoch: 6 cost time: 1.8716607093811035
Epoch: 6, Steps: 12 | Train Loss: 2.398 Vali Loss: 2.326 Vali Acc: 0.361 Test Loss: 2.326 Test Acc: 0.361
Validation loss decreased (-0.294420 --> -0.361088).  Saving model ...
Epoch: 7 cost time: 1.9197492599487305
Epoch: 7, Steps: 12 | Train Loss: 2.315 Vali Loss: 2.239 Vali Acc: 0.450 Test Loss: 2.239 Test Acc: 0.450
Validation loss decreased (-0.361088 --> -0.449978).  Saving model ...
Epoch: 8 cost time: 1.8845059871673584
Epoch: 8, Steps: 12 | Train Loss: 2.179 Vali Loss: 2.146 Vali Acc: 0.472 Test Loss: 2.146 Test Acc: 0.472
Validation loss decreased (-0.449978 --> -0.472201).  Saving model ...
Epoch: 9 cost time: 1.9126231670379639
Epoch: 9, Steps: 12 | Train Loss: 2.074 Vali Loss: 2.050 Vali Acc: 0.528 Test Loss: 2.050 Test Acc: 0.528
Validation loss decreased (-0.472201 --> -0.527757).  Saving model ...
Epoch: 10 cost time: 1.8987078666687012
Epoch: 10, Steps: 12 | Train Loss: 2.009 Vali Loss: 1.952 Vali Acc: 0.550 Test Loss: 1.952 Test Acc: 0.550
Validation loss decreased (-0.527757 --> -0.549980).  Saving model ...
Epoch: 11 cost time: 1.8472821712493896
Epoch: 11, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.847 Vali Acc: 0.561 Test Loss: 1.847 Test Acc: 0.561
Validation loss decreased (-0.549980 --> -0.561093).  Saving model ...
Epoch: 12 cost time: 1.839723825454712
Epoch: 12, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.743 Vali Acc: 0.578 Test Loss: 1.743 Test Acc: 0.578
Validation loss decreased (-0.561093 --> -0.577760).  Saving model ...
Epoch: 13 cost time: 1.9841728210449219
Epoch: 13, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.639 Vali Acc: 0.594 Test Loss: 1.639 Test Acc: 0.594
Validation loss decreased (-0.577760 --> -0.594428).  Saving model ...
Epoch: 14 cost time: 1.8537635803222656
Epoch: 14, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.549 Vali Acc: 0.600 Test Loss: 1.549 Test Acc: 0.600
Validation loss decreased (-0.594428 --> -0.599985).  Saving model ...
Epoch: 15 cost time: 1.8440897464752197
Epoch: 15, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.458 Vali Acc: 0.600 Test Loss: 1.458 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599985).  Saving model ...
Epoch: 16 cost time: 1.838982105255127
Epoch: 16, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.377 Vali Acc: 0.628 Test Loss: 1.377 Test Acc: 0.628
Validation loss decreased (-0.599985 --> -0.627764).  Saving model ...
Epoch: 17 cost time: 1.8027667999267578
Epoch: 17, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.293 Vali Acc: 0.644 Test Loss: 1.293 Test Acc: 0.644
Validation loss decreased (-0.627764 --> -0.644432).  Saving model ...
Epoch: 18 cost time: 1.6817984580993652
Epoch: 18, Steps: 12 | Train Loss: 1.119 Vali Loss: 1.219 Vali Acc: 0.678 Test Loss: 1.219 Test Acc: 0.678
Validation loss decreased (-0.644432 --> -0.677766).  Saving model ...
Epoch: 19 cost time: 1.6970555782318115
Epoch: 19, Steps: 12 | Train Loss: 1.025 Vali Loss: 1.154 Vali Acc: 0.678 Test Loss: 1.154 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677766).  Saving model ...
Epoch: 20 cost time: 1.717527151107788
Epoch: 20, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.102 Vali Acc: 0.678 Test Loss: 1.102 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677767).  Saving model ...
Epoch: 21 cost time: 1.714132308959961
Epoch: 21, Steps: 12 | Train Loss: 0.920 Vali Loss: 1.059 Vali Acc: 0.661 Test Loss: 1.059 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7327048778533936
Epoch: 22, Steps: 12 | Train Loss: 0.862 Vali Loss: 1.023 Vali Acc: 0.678 Test Loss: 1.023 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677768).  Saving model ...
Epoch: 23 cost time: 1.740882396697998
Epoch: 23, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.979 Vali Acc: 0.689 Test Loss: 0.979 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688879).  Saving model ...
Epoch: 24 cost time: 1.730428695678711
Epoch: 24, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.951 Vali Acc: 0.672 Test Loss: 0.951 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5509130954742432
Epoch: 25, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.927 Vali Acc: 0.683 Test Loss: 0.927 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6998326778411865
Epoch: 26, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.912 Vali Acc: 0.689 Test Loss: 0.912 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688880).  Saving model ...
Epoch: 27 cost time: 1.6637380123138428
Epoch: 27, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.887 Vali Acc: 0.700 Test Loss: 0.887 Test Acc: 0.700
Validation loss decreased (-0.688880 --> -0.699991).  Saving model ...
Epoch: 28 cost time: 1.7223269939422607
Epoch: 28, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.874 Vali Acc: 0.683 Test Loss: 0.874 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8816003799438477
Epoch: 29, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.861 Vali Acc: 0.700 Test Loss: 0.861 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 30 cost time: 1.8513967990875244
Epoch: 30, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.834 Vali Acc: 0.717 Test Loss: 0.834 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716658).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7166666666666667
model parameter : 298855
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5447723865509033
Epoch: 1, Steps: 12 | Train Loss: 2.806 Vali Loss: 2.781 Vali Acc: 0.044 Test Loss: 2.781 Test Acc: 0.044
Validation loss decreased (inf --> -0.044417).  Saving model ...
Epoch: 2 cost time: 1.774620532989502
Epoch: 2, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.734 Vali Acc: 0.078 Test Loss: 2.734 Test Acc: 0.078
Validation loss decreased (-0.044417 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 1.8181483745574951
Epoch: 3, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.674 Vali Acc: 0.106 Test Loss: 2.674 Test Acc: 0.106
Validation loss decreased (-0.077750 --> -0.105529).  Saving model ...
Epoch: 4 cost time: 1.8273940086364746
Epoch: 4, Steps: 12 | Train Loss: 2.645 Vali Loss: 2.605 Vali Acc: 0.133 Test Loss: 2.605 Test Acc: 0.133
Validation loss decreased (-0.105529 --> -0.133307).  Saving model ...
Epoch: 5 cost time: 1.777958631515503
Epoch: 5, Steps: 12 | Train Loss: 2.558 Vali Loss: 2.531 Vali Acc: 0.183 Test Loss: 2.531 Test Acc: 0.183
Validation loss decreased (-0.133307 --> -0.183308).  Saving model ...
Epoch: 6 cost time: 1.77297043800354
Epoch: 6, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.451 Vali Acc: 0.250 Test Loss: 2.451 Test Acc: 0.250
Validation loss decreased (-0.183308 --> -0.249975).  Saving model ...
Epoch: 7 cost time: 1.8490006923675537
Epoch: 7, Steps: 12 | Train Loss: 2.367 Vali Loss: 2.365 Vali Acc: 0.361 Test Loss: 2.365 Test Acc: 0.361
Validation loss decreased (-0.249975 --> -0.361087).  Saving model ...
Epoch: 8 cost time: 1.8074984550476074
Epoch: 8, Steps: 12 | Train Loss: 2.292 Vali Loss: 2.272 Vali Acc: 0.422 Test Loss: 2.272 Test Acc: 0.422
Validation loss decreased (-0.361087 --> -0.422199).  Saving model ...
Epoch: 9 cost time: 1.780522346496582
Epoch: 9, Steps: 12 | Train Loss: 2.181 Vali Loss: 2.173 Vali Acc: 0.489 Test Loss: 2.173 Test Acc: 0.489
Validation loss decreased (-0.422199 --> -0.488867).  Saving model ...
Epoch: 10 cost time: 1.852841854095459
Epoch: 10, Steps: 12 | Train Loss: 2.078 Vali Loss: 2.069 Vali Acc: 0.483 Test Loss: 2.069 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8922994136810303
Epoch: 11, Steps: 12 | Train Loss: 1.943 Vali Loss: 1.965 Vali Acc: 0.517 Test Loss: 1.965 Test Acc: 0.517
Validation loss decreased (-0.488867 --> -0.516647).  Saving model ...
Epoch: 12 cost time: 1.8820879459381104
Epoch: 12, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.858 Vali Acc: 0.533 Test Loss: 1.858 Test Acc: 0.533
Validation loss decreased (-0.516647 --> -0.533315).  Saving model ...
Epoch: 13 cost time: 1.8147480487823486
Epoch: 13, Steps: 12 | Train Loss: 1.699 Vali Loss: 1.757 Vali Acc: 0.572 Test Loss: 1.757 Test Acc: 0.572
Validation loss decreased (-0.533315 --> -0.572205).  Saving model ...
Epoch: 14 cost time: 1.840052604675293
Epoch: 14, Steps: 12 | Train Loss: 1.571 Vali Loss: 1.665 Vali Acc: 0.578 Test Loss: 1.665 Test Acc: 0.578
Validation loss decreased (-0.572205 --> -0.577761).  Saving model ...
Epoch: 15 cost time: 1.860945463180542
Epoch: 15, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.578 Vali Acc: 0.594 Test Loss: 1.578 Test Acc: 0.594
Validation loss decreased (-0.577761 --> -0.594429).  Saving model ...
Epoch: 16 cost time: 1.8354403972625732
Epoch: 16, Steps: 12 | Train Loss: 1.409 Vali Loss: 1.500 Vali Acc: 0.600 Test Loss: 1.500 Test Acc: 0.600
Validation loss decreased (-0.594429 --> -0.599985).  Saving model ...
Epoch: 17 cost time: 1.8642358779907227
Epoch: 17, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.424 Vali Acc: 0.606 Test Loss: 1.424 Test Acc: 0.606
Validation loss decreased (-0.599985 --> -0.605541).  Saving model ...
Epoch: 18 cost time: 1.9131426811218262
Epoch: 18, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.357 Vali Acc: 0.611 Test Loss: 1.357 Test Acc: 0.611
Validation loss decreased (-0.605541 --> -0.611098).  Saving model ...
Epoch: 19 cost time: 1.841926097869873
Epoch: 19, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.291 Vali Acc: 0.622 Test Loss: 1.291 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622209).  Saving model ...
Epoch: 20 cost time: 1.7887651920318604
Epoch: 20, Steps: 12 | Train Loss: 1.069 Vali Loss: 1.238 Vali Acc: 0.633 Test Loss: 1.238 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 21 cost time: 1.7553815841674805
Epoch: 21, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.177 Vali Acc: 0.656 Test Loss: 1.177 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655544).  Saving model ...
Epoch: 22 cost time: 1.793137788772583
Epoch: 22, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.136 Vali Acc: 0.650 Test Loss: 1.136 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7800402641296387
Epoch: 23, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.088 Vali Acc: 0.667 Test Loss: 1.088 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 24 cost time: 1.7920188903808594
Epoch: 24, Steps: 12 | Train Loss: 0.826 Vali Loss: 1.052 Vali Acc: 0.656 Test Loss: 1.052 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7375924587249756
Epoch: 25, Steps: 12 | Train Loss: 0.825 Vali Loss: 1.023 Vali Acc: 0.672 Test Loss: 1.023 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672212).  Saving model ...
Epoch: 26 cost time: 1.7189903259277344
Epoch: 26, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.985 Vali Acc: 0.678 Test Loss: 0.985 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 27 cost time: 1.7831604480743408
Epoch: 27, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.950 Vali Acc: 0.667 Test Loss: 0.950 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5853831768035889
Epoch: 28, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.921 Vali Acc: 0.667 Test Loss: 0.921 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7771751880645752
Epoch: 29, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.906 Vali Acc: 0.672 Test Loss: 0.906 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6813325881958008
Epoch: 30, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.881 Vali Acc: 0.667 Test Loss: 0.881 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6777777777777778
model parameter : 91847
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3335459232330322
Epoch: 1, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.654 Vali Acc: 0.150 Test Loss: 2.654 Test Acc: 0.150
Validation loss decreased (inf --> -0.149973).  Saving model ...
Epoch: 2 cost time: 1.6599946022033691
Epoch: 2, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.611 Vali Acc: 0.178 Test Loss: 2.611 Test Acc: 0.178
Validation loss decreased (-0.149973 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 1.7463347911834717
Epoch: 3, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.553 Vali Acc: 0.183 Test Loss: 2.553 Test Acc: 0.183
Validation loss decreased (-0.177752 --> -0.183308).  Saving model ...
Epoch: 4 cost time: 1.5727055072784424
Epoch: 4, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.486 Vali Acc: 0.228 Test Loss: 2.486 Test Acc: 0.228
Validation loss decreased (-0.183308 --> -0.227753).  Saving model ...
Epoch: 5 cost time: 1.7606151103973389
Epoch: 5, Steps: 12 | Train Loss: 2.507 Vali Loss: 2.414 Vali Acc: 0.294 Test Loss: 2.414 Test Acc: 0.294
Validation loss decreased (-0.227753 --> -0.294420).  Saving model ...
Epoch: 6 cost time: 1.790856122970581
Epoch: 6, Steps: 12 | Train Loss: 2.413 Vali Loss: 2.336 Vali Acc: 0.344 Test Loss: 2.336 Test Acc: 0.344
Validation loss decreased (-0.294420 --> -0.344421).  Saving model ...
Epoch: 7 cost time: 1.7780942916870117
Epoch: 7, Steps: 12 | Train Loss: 2.336 Vali Loss: 2.254 Vali Acc: 0.411 Test Loss: 2.254 Test Acc: 0.411
Validation loss decreased (-0.344421 --> -0.411089).  Saving model ...
Epoch: 8 cost time: 1.833155870437622
Epoch: 8, Steps: 12 | Train Loss: 2.205 Vali Loss: 2.168 Vali Acc: 0.456 Test Loss: 2.168 Test Acc: 0.456
Validation loss decreased (-0.411089 --> -0.455534).  Saving model ...
Epoch: 9 cost time: 1.777230978012085
Epoch: 9, Steps: 12 | Train Loss: 2.101 Vali Loss: 2.079 Vali Acc: 0.506 Test Loss: 2.079 Test Acc: 0.506
Validation loss decreased (-0.455534 --> -0.505535).  Saving model ...
Epoch: 10 cost time: 1.7838618755340576
Epoch: 10, Steps: 12 | Train Loss: 2.044 Vali Loss: 1.988 Vali Acc: 0.522 Test Loss: 1.988 Test Acc: 0.522
Validation loss decreased (-0.505535 --> -0.522202).  Saving model ...
Epoch: 11 cost time: 1.8109345436096191
Epoch: 11, Steps: 12 | Train Loss: 1.888 Vali Loss: 1.894 Vali Acc: 0.550 Test Loss: 1.894 Test Acc: 0.550
Validation loss decreased (-0.522202 --> -0.549981).  Saving model ...
Epoch: 12 cost time: 1.8462355136871338
Epoch: 12, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.799 Vali Acc: 0.544 Test Loss: 1.799 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8614308834075928
Epoch: 13, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.704 Vali Acc: 0.572 Test Loss: 1.704 Test Acc: 0.572
Validation loss decreased (-0.549981 --> -0.572205).  Saving model ...
Epoch: 14 cost time: 1.77888822555542
Epoch: 14, Steps: 12 | Train Loss: 1.536 Vali Loss: 1.621 Vali Acc: 0.572 Test Loss: 1.621 Test Acc: 0.572
Validation loss decreased (-0.572205 --> -0.572206).  Saving model ...
Epoch: 15 cost time: 1.79005765914917
Epoch: 15, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.542 Vali Acc: 0.572 Test Loss: 1.542 Test Acc: 0.572
Validation loss decreased (-0.572206 --> -0.572207).  Saving model ...
Epoch: 16 cost time: 1.8315808773040771
Epoch: 16, Steps: 12 | Train Loss: 1.362 Vali Loss: 1.472 Vali Acc: 0.589 Test Loss: 1.472 Test Acc: 0.589
Validation loss decreased (-0.572207 --> -0.588874).  Saving model ...
Epoch: 17 cost time: 1.8343353271484375
Epoch: 17, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.405 Vali Acc: 0.617 Test Loss: 1.405 Test Acc: 0.617
Validation loss decreased (-0.588874 --> -0.616653).  Saving model ...
Epoch: 18 cost time: 1.673666000366211
Epoch: 18, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.341 Vali Acc: 0.622 Test Loss: 1.341 Test Acc: 0.622
Validation loss decreased (-0.616653 --> -0.622209).  Saving model ...
Epoch: 19 cost time: 1.7804601192474365
Epoch: 19, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.293 Vali Acc: 0.633 Test Loss: 1.293 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633320).  Saving model ...
Epoch: 20 cost time: 1.745419979095459
Epoch: 20, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.248 Vali Acc: 0.617 Test Loss: 1.248 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8025310039520264
Epoch: 21, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.210 Vali Acc: 0.617 Test Loss: 1.210 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.789424180984497
Epoch: 22, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.169 Vali Acc: 0.622 Test Loss: 1.169 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7251248359680176
Epoch: 23, Steps: 12 | Train Loss: 0.888 Vali Loss: 1.123 Vali Acc: 0.644 Test Loss: 1.123 Test Acc: 0.644
Validation loss decreased (-0.633320 --> -0.644433).  Saving model ...
Epoch: 24 cost time: 1.7748708724975586
Epoch: 24, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.100 Vali Acc: 0.639 Test Loss: 1.100 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6483330726623535
Epoch: 25, Steps: 12 | Train Loss: 0.789 Vali Loss: 1.065 Vali Acc: 0.667 Test Loss: 1.065 Test Acc: 0.667
Validation loss decreased (-0.644433 --> -0.666656).  Saving model ...
Epoch: 26 cost time: 1.699106216430664
Epoch: 26, Steps: 12 | Train Loss: 0.816 Vali Loss: 1.041 Vali Acc: 0.661 Test Loss: 1.041 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6355395317077637
Epoch: 27, Steps: 12 | Train Loss: 0.784 Vali Loss: 1.013 Vali Acc: 0.683 Test Loss: 1.013 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683323).  Saving model ...
Epoch: 28 cost time: 1.5472681522369385
Epoch: 28, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.991 Vali Acc: 0.667 Test Loss: 0.991 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6537396907806396
Epoch: 29, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.972 Vali Acc: 0.667 Test Loss: 0.972 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6251769065856934
Epoch: 30, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.957 Vali Acc: 0.667 Test Loss: 0.957 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6833333333333333
model parameter : 298855
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.066899299621582
Epoch: 1, Steps: 12 | Train Loss: 2.805 Vali Loss: 2.781 Vali Acc: 0.044 Test Loss: 2.781 Test Acc: 0.044
Validation loss decreased (inf --> -0.044417).  Saving model ...
Epoch: 2 cost time: 1.5153963565826416
Epoch: 2, Steps: 12 | Train Loss: 2.798 Vali Loss: 2.734 Vali Acc: 0.078 Test Loss: 2.734 Test Acc: 0.078
Validation loss decreased (-0.044417 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 1.4771397113800049
Epoch: 3, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.674 Vali Acc: 0.106 Test Loss: 2.674 Test Acc: 0.106
Validation loss decreased (-0.077750 --> -0.105529).  Saving model ...
Epoch: 4 cost time: 1.49119234085083
Epoch: 4, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.606 Vali Acc: 0.133 Test Loss: 2.606 Test Acc: 0.133
Validation loss decreased (-0.105529 --> -0.133307).  Saving model ...
Epoch: 5 cost time: 1.5024547576904297
Epoch: 5, Steps: 12 | Train Loss: 2.559 Vali Loss: 2.533 Vali Acc: 0.189 Test Loss: 2.533 Test Acc: 0.189
Validation loss decreased (-0.133307 --> -0.188864).  Saving model ...
Epoch: 6 cost time: 1.548647403717041
Epoch: 6, Steps: 12 | Train Loss: 2.493 Vali Loss: 2.453 Vali Acc: 0.233 Test Loss: 2.453 Test Acc: 0.233
Validation loss decreased (-0.188864 --> -0.233309).  Saving model ...
Epoch: 7 cost time: 1.5743396282196045
Epoch: 7, Steps: 12 | Train Loss: 2.367 Vali Loss: 2.368 Vali Acc: 0.356 Test Loss: 2.368 Test Acc: 0.356
Validation loss decreased (-0.233309 --> -0.355532).  Saving model ...
Epoch: 8 cost time: 1.520301342010498
Epoch: 8, Steps: 12 | Train Loss: 2.295 Vali Loss: 2.276 Vali Acc: 0.417 Test Loss: 2.276 Test Acc: 0.417
Validation loss decreased (-0.355532 --> -0.416644).  Saving model ...
Epoch: 9 cost time: 1.5506601333618164
Epoch: 9, Steps: 12 | Train Loss: 2.182 Vali Loss: 2.178 Vali Acc: 0.472 Test Loss: 2.178 Test Acc: 0.472
Validation loss decreased (-0.416644 --> -0.472200).  Saving model ...
Epoch: 10 cost time: 1.5791473388671875
Epoch: 10, Steps: 12 | Train Loss: 2.083 Vali Loss: 2.076 Vali Acc: 0.483 Test Loss: 2.076 Test Acc: 0.483
Validation loss decreased (-0.472200 --> -0.483313).  Saving model ...
Epoch: 11 cost time: 1.6423523426055908
Epoch: 11, Steps: 12 | Train Loss: 1.946 Vali Loss: 1.974 Vali Acc: 0.511 Test Loss: 1.974 Test Acc: 0.511
Validation loss decreased (-0.483313 --> -0.511091).  Saving model ...
Epoch: 12 cost time: 1.5976824760437012
Epoch: 12, Steps: 12 | Train Loss: 1.831 Vali Loss: 1.870 Vali Acc: 0.533 Test Loss: 1.870 Test Acc: 0.533
Validation loss decreased (-0.511091 --> -0.533315).  Saving model ...
Epoch: 13 cost time: 1.6386091709136963
Epoch: 13, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.765 Vali Acc: 0.561 Test Loss: 1.765 Test Acc: 0.561
Validation loss decreased (-0.533315 --> -0.561093).  Saving model ...
Epoch: 14 cost time: 1.6770265102386475
Epoch: 14, Steps: 12 | Train Loss: 1.577 Vali Loss: 1.678 Vali Acc: 0.572 Test Loss: 1.678 Test Acc: 0.572
Validation loss decreased (-0.561093 --> -0.572205).  Saving model ...
Epoch: 15 cost time: 1.5697412490844727
Epoch: 15, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.602 Vali Acc: 0.589 Test Loss: 1.602 Test Acc: 0.589
Validation loss decreased (-0.572205 --> -0.588873).  Saving model ...
Epoch: 16 cost time: 1.6104528903961182
Epoch: 16, Steps: 12 | Train Loss: 1.420 Vali Loss: 1.535 Vali Acc: 0.583 Test Loss: 1.535 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5944528579711914
Epoch: 17, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.465 Vali Acc: 0.611 Test Loss: 1.465 Test Acc: 0.611
Validation loss decreased (-0.588873 --> -0.611096).  Saving model ...
Epoch: 18 cost time: 1.6486554145812988
Epoch: 18, Steps: 12 | Train Loss: 1.214 Vali Loss: 1.402 Vali Acc: 0.606 Test Loss: 1.402 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6227455139160156
Epoch: 19, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.344 Vali Acc: 0.611 Test Loss: 1.344 Test Acc: 0.611
Validation loss decreased (-0.611096 --> -0.611098).  Saving model ...
Epoch: 20 cost time: 1.5850958824157715
Epoch: 20, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.297 Vali Acc: 0.606 Test Loss: 1.297 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.627185344696045
Epoch: 21, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.240 Vali Acc: 0.611 Test Loss: 1.240 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611099).  Saving model ...
Epoch: 22 cost time: 1.6334171295166016
Epoch: 22, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.201 Vali Acc: 0.633 Test Loss: 1.201 Test Acc: 0.633
Validation loss decreased (-0.611099 --> -0.633321).  Saving model ...
Epoch: 23 cost time: 1.6604766845703125
Epoch: 23, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.159 Vali Acc: 0.639 Test Loss: 1.159 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 24 cost time: 1.719062089920044
Epoch: 24, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.124 Vali Acc: 0.617 Test Loss: 1.124 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.664834976196289
Epoch: 25, Steps: 12 | Train Loss: 0.899 Vali Loss: 1.095 Vali Acc: 0.639 Test Loss: 1.095 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638878).  Saving model ...
Epoch: 26 cost time: 1.6708543300628662
Epoch: 26, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.054 Vali Acc: 0.661 Test Loss: 1.054 Test Acc: 0.661
Validation loss decreased (-0.638878 --> -0.661101).  Saving model ...
Epoch: 27 cost time: 1.6820721626281738
Epoch: 27, Steps: 12 | Train Loss: 0.779 Vali Loss: 1.018 Vali Acc: 0.650 Test Loss: 1.018 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.680579662322998
Epoch: 28, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.987 Vali Acc: 0.656 Test Loss: 0.987 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7034854888916016
Epoch: 29, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.967 Vali Acc: 0.661 Test Loss: 0.967 Test Acc: 0.661
Validation loss decreased (-0.661101 --> -0.661101).  Saving model ...
Epoch: 30 cost time: 1.7107365131378174
Epoch: 30, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.942 Vali Acc: 0.661 Test Loss: 0.942 Test Acc: 0.661
Validation loss decreased (-0.661101 --> -0.661102).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6611111111111111
model parameter : 91847
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0530965328216553
Epoch: 1, Steps: 12 | Train Loss: 2.755 Vali Loss: 2.658 Vali Acc: 0.150 Test Loss: 2.658 Test Acc: 0.150
Validation loss decreased (inf --> -0.149973).  Saving model ...
Epoch: 2 cost time: 1.3958561420440674
Epoch: 2, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.618 Vali Acc: 0.178 Test Loss: 2.618 Test Acc: 0.178
Validation loss decreased (-0.149973 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 1.444432258605957
Epoch: 3, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.564 Vali Acc: 0.183 Test Loss: 2.564 Test Acc: 0.183
Validation loss decreased (-0.177752 --> -0.183308).  Saving model ...
Epoch: 4 cost time: 1.390481948852539
Epoch: 4, Steps: 12 | Train Loss: 2.608 Vali Loss: 2.502 Vali Acc: 0.189 Test Loss: 2.502 Test Acc: 0.189
Validation loss decreased (-0.183308 --> -0.188864).  Saving model ...
Epoch: 5 cost time: 1.4202334880828857
Epoch: 5, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.437 Vali Acc: 0.278 Test Loss: 2.437 Test Acc: 0.278
Validation loss decreased (-0.188864 --> -0.277753).  Saving model ...
Epoch: 6 cost time: 1.3757240772247314
Epoch: 6, Steps: 12 | Train Loss: 2.444 Vali Loss: 2.367 Vali Acc: 0.333 Test Loss: 2.367 Test Acc: 0.333
Validation loss decreased (-0.277753 --> -0.333310).  Saving model ...
Epoch: 7 cost time: 1.415959119796753
Epoch: 7, Steps: 12 | Train Loss: 2.372 Vali Loss: 2.294 Vali Acc: 0.389 Test Loss: 2.294 Test Acc: 0.389
Validation loss decreased (-0.333310 --> -0.388866).  Saving model ...
Epoch: 8 cost time: 1.3871471881866455
Epoch: 8, Steps: 12 | Train Loss: 2.254 Vali Loss: 2.220 Vali Acc: 0.433 Test Loss: 2.220 Test Acc: 0.433
Validation loss decreased (-0.388866 --> -0.433311).  Saving model ...
Epoch: 9 cost time: 1.380187749862671
Epoch: 9, Steps: 12 | Train Loss: 2.163 Vali Loss: 2.146 Vali Acc: 0.450 Test Loss: 2.146 Test Acc: 0.450
Validation loss decreased (-0.433311 --> -0.449979).  Saving model ...
Epoch: 10 cost time: 1.375763177871704
Epoch: 10, Steps: 12 | Train Loss: 2.121 Vali Loss: 2.074 Vali Acc: 0.483 Test Loss: 2.074 Test Acc: 0.483
Validation loss decreased (-0.449979 --> -0.483313).  Saving model ...
Epoch: 11 cost time: 1.3708055019378662
Epoch: 11, Steps: 12 | Train Loss: 1.983 Vali Loss: 1.999 Vali Acc: 0.500 Test Loss: 1.999 Test Acc: 0.500
Validation loss decreased (-0.483313 --> -0.499980).  Saving model ...
Epoch: 12 cost time: 1.4128339290618896
Epoch: 12, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.924 Vali Acc: 0.522 Test Loss: 1.924 Test Acc: 0.522
Validation loss decreased (-0.499980 --> -0.522203).  Saving model ...
Epoch: 13 cost time: 1.409879446029663
Epoch: 13, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.848 Vali Acc: 0.544 Test Loss: 1.848 Test Acc: 0.544
Validation loss decreased (-0.522203 --> -0.544426).  Saving model ...
Epoch: 14 cost time: 1.4314749240875244
Epoch: 14, Steps: 12 | Train Loss: 1.696 Vali Loss: 1.781 Vali Acc: 0.556 Test Loss: 1.781 Test Acc: 0.556
Validation loss decreased (-0.544426 --> -0.555538).  Saving model ...
Epoch: 15 cost time: 1.4329407215118408
Epoch: 15, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.717 Vali Acc: 0.544 Test Loss: 1.717 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4390928745269775
Epoch: 16, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.658 Vali Acc: 0.572 Test Loss: 1.658 Test Acc: 0.572
Validation loss decreased (-0.555538 --> -0.572206).  Saving model ...
Epoch: 17 cost time: 1.3879828453063965
Epoch: 17, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.599 Vali Acc: 0.589 Test Loss: 1.599 Test Acc: 0.589
Validation loss decreased (-0.572206 --> -0.588873).  Saving model ...
Epoch: 18 cost time: 1.404099702835083
Epoch: 18, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.543 Vali Acc: 0.594 Test Loss: 1.543 Test Acc: 0.594
Validation loss decreased (-0.588873 --> -0.594429).  Saving model ...
Epoch: 19 cost time: 1.4760658740997314
Epoch: 19, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.494 Vali Acc: 0.589 Test Loss: 1.494 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4331884384155273
Epoch: 20, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.444 Vali Acc: 0.583 Test Loss: 1.444 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4829003810882568
Epoch: 21, Steps: 12 | Train Loss: 1.185 Vali Loss: 1.403 Vali Acc: 0.583 Test Loss: 1.403 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.436905860900879
Epoch: 22, Steps: 12 | Train Loss: 1.148 Vali Loss: 1.366 Vali Acc: 0.572 Test Loss: 1.366 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4591565132141113
Epoch: 23, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.314 Vali Acc: 0.589 Test Loss: 1.314 Test Acc: 0.589
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4811615943908691
Epoch: 24, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.283 Vali Acc: 0.567 Test Loss: 1.283 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4789814949035645
Epoch: 25, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.241 Vali Acc: 0.583 Test Loss: 1.241 Test Acc: 0.583
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4693818092346191
Epoch: 26, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.216 Vali Acc: 0.600 Test Loss: 1.216 Test Acc: 0.600
Validation loss decreased (-0.594429 --> -0.599988).  Saving model ...
Epoch: 27 cost time: 1.4855384826660156
Epoch: 27, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.190 Vali Acc: 0.600 Test Loss: 1.190 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 28 cost time: 1.4414427280426025
Epoch: 28, Steps: 12 | Train Loss: 0.889 Vali Loss: 1.159 Vali Acc: 0.606 Test Loss: 1.159 Test Acc: 0.606
Validation loss decreased (-0.599988 --> -0.605544).  Saving model ...
Epoch: 29 cost time: 1.4361677169799805
Epoch: 29, Steps: 12 | Train Loss: 0.853 Vali Loss: 1.143 Vali Acc: 0.600 Test Loss: 1.143 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4542036056518555
Epoch: 30, Steps: 12 | Train Loss: 0.830 Vali Loss: 1.116 Vali Acc: 0.633 Test Loss: 1.116 Test Acc: 0.633
Validation loss decreased (-0.605544 --> -0.633322).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6333333333333333
model parameter : 298855
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.848118543624878
Epoch: 1, Steps: 12 | Train Loss: 2.811 Vali Loss: 2.780 Vali Acc: 0.044 Test Loss: 2.780 Test Acc: 0.044
Validation loss decreased (inf --> -0.044417).  Saving model ...
Epoch: 2 cost time: 1.3197698593139648
Epoch: 2, Steps: 12 | Train Loss: 2.802 Vali Loss: 2.737 Vali Acc: 0.078 Test Loss: 2.737 Test Acc: 0.078
Validation loss decreased (-0.044417 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 1.334728717803955
Epoch: 3, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.683 Vali Acc: 0.106 Test Loss: 2.683 Test Acc: 0.106
Validation loss decreased (-0.077750 --> -0.105529).  Saving model ...
Epoch: 4 cost time: 1.3612642288208008
Epoch: 4, Steps: 12 | Train Loss: 2.663 Vali Loss: 2.621 Vali Acc: 0.128 Test Loss: 2.621 Test Acc: 0.128
Validation loss decreased (-0.105529 --> -0.127752).  Saving model ...
Epoch: 5 cost time: 1.3899571895599365
Epoch: 5, Steps: 12 | Train Loss: 2.584 Vali Loss: 2.555 Vali Acc: 0.161 Test Loss: 2.555 Test Acc: 0.161
Validation loss decreased (-0.127752 --> -0.161086).  Saving model ...
Epoch: 6 cost time: 1.4568769931793213
Epoch: 6, Steps: 12 | Train Loss: 2.534 Vali Loss: 2.485 Vali Acc: 0.211 Test Loss: 2.485 Test Acc: 0.211
Validation loss decreased (-0.161086 --> -0.211086).  Saving model ...
Epoch: 7 cost time: 1.277212142944336
Epoch: 7, Steps: 12 | Train Loss: 2.419 Vali Loss: 2.413 Vali Acc: 0.289 Test Loss: 2.413 Test Acc: 0.289
Validation loss decreased (-0.211086 --> -0.288865).  Saving model ...
Epoch: 8 cost time: 1.3183495998382568
Epoch: 8, Steps: 12 | Train Loss: 2.354 Vali Loss: 2.336 Vali Acc: 0.378 Test Loss: 2.336 Test Acc: 0.378
Validation loss decreased (-0.288865 --> -0.377754).  Saving model ...
Epoch: 9 cost time: 1.129124402999878
Epoch: 9, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.257 Vali Acc: 0.439 Test Loss: 2.257 Test Acc: 0.439
Validation loss decreased (-0.377754 --> -0.438866).  Saving model ...
Epoch: 10 cost time: 1.2959990501403809
Epoch: 10, Steps: 12 | Train Loss: 2.183 Vali Loss: 2.177 Vali Acc: 0.467 Test Loss: 2.177 Test Acc: 0.467
Validation loss decreased (-0.438866 --> -0.466645).  Saving model ...
Epoch: 11 cost time: 1.2506370544433594
Epoch: 11, Steps: 12 | Train Loss: 2.075 Vali Loss: 2.097 Vali Acc: 0.489 Test Loss: 2.097 Test Acc: 0.489
Validation loss decreased (-0.466645 --> -0.488868).  Saving model ...
Epoch: 12 cost time: 1.2038586139678955
Epoch: 12, Steps: 12 | Train Loss: 1.984 Vali Loss: 2.014 Vali Acc: 0.511 Test Loss: 2.014 Test Acc: 0.511
Validation loss decreased (-0.488868 --> -0.511091).  Saving model ...
Epoch: 13 cost time: 1.1723909378051758
Epoch: 13, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.933 Vali Acc: 0.539 Test Loss: 1.933 Test Acc: 0.539
Validation loss decreased (-0.511091 --> -0.538870).  Saving model ...
Epoch: 14 cost time: 1.1759624481201172
Epoch: 14, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.860 Vali Acc: 0.561 Test Loss: 1.860 Test Acc: 0.561
Validation loss decreased (-0.538870 --> -0.561093).  Saving model ...
Epoch: 15 cost time: 1.158787727355957
Epoch: 15, Steps: 12 | Train Loss: 1.705 Vali Loss: 1.788 Vali Acc: 0.556 Test Loss: 1.788 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1959033012390137
Epoch: 16, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.720 Vali Acc: 0.561 Test Loss: 1.720 Test Acc: 0.561
Validation loss decreased (-0.561093 --> -0.561094).  Saving model ...
Epoch: 17 cost time: 1.17319917678833
Epoch: 17, Steps: 12 | Train Loss: 1.555 Vali Loss: 1.653 Vali Acc: 0.561 Test Loss: 1.653 Test Acc: 0.561
Validation loss decreased (-0.561094 --> -0.561095).  Saving model ...
Epoch: 18 cost time: 1.2171063423156738
Epoch: 18, Steps: 12 | Train Loss: 1.470 Vali Loss: 1.590 Vali Acc: 0.567 Test Loss: 1.590 Test Acc: 0.567
Validation loss decreased (-0.561095 --> -0.566651).  Saving model ...
Epoch: 19 cost time: 1.1164538860321045
Epoch: 19, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.529 Vali Acc: 0.556 Test Loss: 1.529 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9990899562835693
Epoch: 20, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.470 Vali Acc: 0.578 Test Loss: 1.470 Test Acc: 0.578
Validation loss decreased (-0.566651 --> -0.577763).  Saving model ...
Epoch: 21 cost time: 1.2446489334106445
Epoch: 21, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.411 Vali Acc: 0.578 Test Loss: 1.411 Test Acc: 0.578
Validation loss decreased (-0.577763 --> -0.577764).  Saving model ...
Epoch: 22 cost time: 1.2037012577056885
Epoch: 22, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.369 Vali Acc: 0.572 Test Loss: 1.369 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1407175064086914
Epoch: 23, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.327 Vali Acc: 0.594 Test Loss: 1.327 Test Acc: 0.594
Validation loss decreased (-0.577764 --> -0.594431).  Saving model ...
Epoch: 24 cost time: 1.2422995567321777
Epoch: 24, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.286 Vali Acc: 0.600 Test Loss: 1.286 Test Acc: 0.600
Validation loss decreased (-0.594431 --> -0.599987).  Saving model ...
Epoch: 25 cost time: 1.2218201160430908
Epoch: 25, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.242 Vali Acc: 0.628 Test Loss: 1.242 Test Acc: 0.628
Validation loss decreased (-0.599987 --> -0.627765).  Saving model ...
Epoch: 26 cost time: 1.1951565742492676
Epoch: 26, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.209 Vali Acc: 0.622 Test Loss: 1.209 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2223427295684814
Epoch: 27, Steps: 12 | Train Loss: 0.930 Vali Loss: 1.172 Vali Acc: 0.633 Test Loss: 1.172 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633322).  Saving model ...
Epoch: 28 cost time: 1.2002875804901123
Epoch: 28, Steps: 12 | Train Loss: 0.926 Vali Loss: 1.135 Vali Acc: 0.639 Test Loss: 1.135 Test Acc: 0.639
Validation loss decreased (-0.633322 --> -0.638878).  Saving model ...
Epoch: 29 cost time: 1.2397186756134033
Epoch: 29, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.110 Vali Acc: 0.639 Test Loss: 1.110 Test Acc: 0.639
Validation loss decreased (-0.638878 --> -0.638878).  Saving model ...
Epoch: 30 cost time: 1.294713020324707
Epoch: 30, Steps: 12 | Train Loss: 0.855 Vali Loss: 1.089 Vali Acc: 0.661 Test Loss: 1.089 Test Acc: 0.661
Validation loss decreased (-0.638878 --> -0.661100).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6611111111111111
model parameter : 91847
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.69016695022583
Epoch: 1, Steps: 12 | Train Loss: 2.837 Vali Loss: 2.701 Vali Acc: 0.072 Test Loss: 2.701 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 1.8759245872497559
Epoch: 2, Steps: 12 | Train Loss: 2.744 Vali Loss: 2.663 Vali Acc: 0.089 Test Loss: 2.663 Test Acc: 0.089
Validation loss decreased (-0.072195 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 1.8921899795532227
Epoch: 3, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.611 Vali Acc: 0.122 Test Loss: 2.611 Test Acc: 0.122
Validation loss decreased (-0.088862 --> -0.122196).  Saving model ...
Epoch: 4 cost time: 1.8618495464324951
Epoch: 4, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.552 Vali Acc: 0.178 Test Loss: 2.552 Test Acc: 0.178
Validation loss decreased (-0.122196 --> -0.177752).  Saving model ...
Epoch: 5 cost time: 1.9175598621368408
Epoch: 5, Steps: 12 | Train Loss: 2.576 Vali Loss: 2.486 Vali Acc: 0.228 Test Loss: 2.486 Test Acc: 0.228
Validation loss decreased (-0.177752 --> -0.227753).  Saving model ...
Epoch: 6 cost time: 1.7995879650115967
Epoch: 6, Steps: 12 | Train Loss: 2.487 Vali Loss: 2.413 Vali Acc: 0.283 Test Loss: 2.413 Test Acc: 0.283
Validation loss decreased (-0.227753 --> -0.283309).  Saving model ...
Epoch: 7 cost time: 1.897507667541504
Epoch: 7, Steps: 12 | Train Loss: 2.421 Vali Loss: 2.335 Vali Acc: 0.367 Test Loss: 2.335 Test Acc: 0.367
Validation loss decreased (-0.283309 --> -0.366643).  Saving model ...
Epoch: 8 cost time: 1.8440535068511963
Epoch: 8, Steps: 12 | Train Loss: 2.329 Vali Loss: 2.246 Vali Acc: 0.411 Test Loss: 2.246 Test Acc: 0.411
Validation loss decreased (-0.366643 --> -0.411089).  Saving model ...
Epoch: 9 cost time: 1.857363224029541
Epoch: 9, Steps: 12 | Train Loss: 2.205 Vali Loss: 2.149 Vali Acc: 0.428 Test Loss: 2.149 Test Acc: 0.428
Validation loss decreased (-0.411089 --> -0.427756).  Saving model ...
Epoch: 10 cost time: 1.9020378589630127
Epoch: 10, Steps: 12 | Train Loss: 2.094 Vali Loss: 2.042 Vali Acc: 0.456 Test Loss: 2.042 Test Acc: 0.456
Validation loss decreased (-0.427756 --> -0.455535).  Saving model ...
Epoch: 11 cost time: 1.8748364448547363
Epoch: 11, Steps: 12 | Train Loss: 1.935 Vali Loss: 1.935 Vali Acc: 0.483 Test Loss: 1.935 Test Acc: 0.483
Validation loss decreased (-0.455535 --> -0.483314).  Saving model ...
Epoch: 12 cost time: 1.8751673698425293
Epoch: 12, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.820 Vali Acc: 0.511 Test Loss: 1.820 Test Acc: 0.511
Validation loss decreased (-0.483314 --> -0.511093).  Saving model ...
Epoch: 13 cost time: 1.8088324069976807
Epoch: 13, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.708 Vali Acc: 0.511 Test Loss: 1.708 Test Acc: 0.511
Validation loss decreased (-0.511093 --> -0.511094).  Saving model ...
Epoch: 14 cost time: 1.806952714920044
Epoch: 14, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.607 Vali Acc: 0.511 Test Loss: 1.607 Test Acc: 0.511
Validation loss decreased (-0.511094 --> -0.511095).  Saving model ...
Epoch: 15 cost time: 1.5609421730041504
Epoch: 15, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.517 Vali Acc: 0.544 Test Loss: 1.517 Test Acc: 0.544
Validation loss decreased (-0.511095 --> -0.544429).  Saving model ...
Epoch: 16 cost time: 1.7638909816741943
Epoch: 16, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.432 Vali Acc: 0.572 Test Loss: 1.432 Test Acc: 0.572
Validation loss decreased (-0.544429 --> -0.572208).  Saving model ...
Epoch: 17 cost time: 1.7305676937103271
Epoch: 17, Steps: 12 | Train Loss: 1.255 Vali Loss: 1.351 Vali Acc: 0.589 Test Loss: 1.351 Test Acc: 0.589
Validation loss decreased (-0.572208 --> -0.588875).  Saving model ...
Epoch: 18 cost time: 1.7701306343078613
Epoch: 18, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.273 Vali Acc: 0.628 Test Loss: 1.273 Test Acc: 0.628
Validation loss decreased (-0.588875 --> -0.627765).  Saving model ...
Epoch: 19 cost time: 1.76387357711792
Epoch: 19, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.206 Vali Acc: 0.617 Test Loss: 1.206 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7560174465179443
Epoch: 20, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.134 Vali Acc: 0.661 Test Loss: 1.134 Test Acc: 0.661
Validation loss decreased (-0.627765 --> -0.661100).  Saving model ...
Epoch: 21 cost time: 1.6941909790039062
Epoch: 21, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.078 Vali Acc: 0.661 Test Loss: 1.078 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661100).  Saving model ...
Epoch: 22 cost time: 1.6812076568603516
Epoch: 22, Steps: 12 | Train Loss: 0.886 Vali Loss: 1.031 Vali Acc: 0.672 Test Loss: 1.031 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672212).  Saving model ...
Epoch: 23 cost time: 1.652261734008789
Epoch: 23, Steps: 12 | Train Loss: 0.818 Vali Loss: 0.983 Vali Acc: 0.678 Test Loss: 0.983 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 24 cost time: 1.7204406261444092
Epoch: 24, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.948 Vali Acc: 0.678 Test Loss: 0.948 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677768).  Saving model ...
Epoch: 25 cost time: 1.782200813293457
Epoch: 25, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.932 Vali Acc: 0.683 Test Loss: 0.932 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683324).  Saving model ...
Epoch: 26 cost time: 1.7388052940368652
Epoch: 26, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.896 Vali Acc: 0.672 Test Loss: 0.896 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.741492748260498
Epoch: 27, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.868 Vali Acc: 0.689 Test Loss: 0.868 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688880).  Saving model ...
Epoch: 28 cost time: 1.6874032020568848
Epoch: 28, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.849 Vali Acc: 0.694 Test Loss: 0.849 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694436).  Saving model ...
Epoch: 29 cost time: 1.7750592231750488
Epoch: 29, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.837 Vali Acc: 0.706 Test Loss: 0.837 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705547).  Saving model ...
Epoch: 30 cost time: 1.666017770767212
Epoch: 30, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.824 Vali Acc: 0.694 Test Loss: 0.824 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7055555555555556
model parameter : 152231
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1738665103912354
Epoch: 1, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.733 Vali Acc: 0.089 Test Loss: 2.733 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.6701302528381348
Epoch: 2, Steps: 12 | Train Loss: 2.669 Vali Loss: 2.693 Vali Acc: 0.117 Test Loss: 2.693 Test Acc: 0.117
Validation loss decreased (-0.088862 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 1.5905663967132568
Epoch: 3, Steps: 12 | Train Loss: 2.620 Vali Loss: 2.639 Vali Acc: 0.172 Test Loss: 2.639 Test Acc: 0.172
Validation loss decreased (-0.116640 --> -0.172196).  Saving model ...
Epoch: 4 cost time: 1.7245800495147705
Epoch: 4, Steps: 12 | Train Loss: 2.564 Vali Loss: 2.576 Vali Acc: 0.211 Test Loss: 2.576 Test Acc: 0.211
Validation loss decreased (-0.172196 --> -0.211085).  Saving model ...
Epoch: 5 cost time: 1.6545636653900146
Epoch: 5, Steps: 12 | Train Loss: 2.493 Vali Loss: 2.504 Vali Acc: 0.244 Test Loss: 2.504 Test Acc: 0.244
Validation loss decreased (-0.211085 --> -0.244419).  Saving model ...
Epoch: 6 cost time: 1.577620029449463
Epoch: 6, Steps: 12 | Train Loss: 2.441 Vali Loss: 2.429 Vali Acc: 0.328 Test Loss: 2.429 Test Acc: 0.328
Validation loss decreased (-0.244419 --> -0.327753).  Saving model ...
Epoch: 7 cost time: 1.548675775527954
Epoch: 7, Steps: 12 | Train Loss: 2.323 Vali Loss: 2.345 Vali Acc: 0.400 Test Loss: 2.345 Test Acc: 0.400
Validation loss decreased (-0.327753 --> -0.399977).  Saving model ...
Epoch: 8 cost time: 1.5948803424835205
Epoch: 8, Steps: 12 | Train Loss: 2.224 Vali Loss: 2.259 Vali Acc: 0.411 Test Loss: 2.259 Test Acc: 0.411
Validation loss decreased (-0.399977 --> -0.411089).  Saving model ...
Epoch: 9 cost time: 1.629709243774414
Epoch: 9, Steps: 12 | Train Loss: 2.149 Vali Loss: 2.171 Vali Acc: 0.467 Test Loss: 2.171 Test Acc: 0.467
Validation loss decreased (-0.411089 --> -0.466645).  Saving model ...
Epoch: 10 cost time: 1.5927751064300537
Epoch: 10, Steps: 12 | Train Loss: 2.037 Vali Loss: 2.084 Vali Acc: 0.500 Test Loss: 2.084 Test Acc: 0.500
Validation loss decreased (-0.466645 --> -0.499979).  Saving model ...
Epoch: 11 cost time: 1.5627775192260742
Epoch: 11, Steps: 12 | Train Loss: 1.956 Vali Loss: 1.995 Vali Acc: 0.511 Test Loss: 1.995 Test Acc: 0.511
Validation loss decreased (-0.499979 --> -0.511091).  Saving model ...
Epoch: 12 cost time: 1.5791897773742676
Epoch: 12, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.905 Vali Acc: 0.522 Test Loss: 1.905 Test Acc: 0.522
Validation loss decreased (-0.511091 --> -0.522203).  Saving model ...
Epoch: 13 cost time: 1.4212348461151123
Epoch: 13, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.816 Vali Acc: 0.533 Test Loss: 1.816 Test Acc: 0.533
Validation loss decreased (-0.522203 --> -0.533315).  Saving model ...
Epoch: 14 cost time: 1.5909152030944824
Epoch: 14, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.734 Vali Acc: 0.539 Test Loss: 1.734 Test Acc: 0.539
Validation loss decreased (-0.533315 --> -0.538872).  Saving model ...
Epoch: 15 cost time: 1.549706220626831
Epoch: 15, Steps: 12 | Train Loss: 1.518 Vali Loss: 1.653 Vali Acc: 0.539 Test Loss: 1.653 Test Acc: 0.539
Validation loss decreased (-0.538872 --> -0.538872).  Saving model ...
Epoch: 16 cost time: 1.5750067234039307
Epoch: 16, Steps: 12 | Train Loss: 1.431 Vali Loss: 1.576 Vali Acc: 0.550 Test Loss: 1.576 Test Acc: 0.550
Validation loss decreased (-0.538872 --> -0.549984).  Saving model ...
Epoch: 17 cost time: 1.5823073387145996
Epoch: 17, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.496 Vali Acc: 0.561 Test Loss: 1.496 Test Acc: 0.561
Validation loss decreased (-0.549984 --> -0.561096).  Saving model ...
Epoch: 18 cost time: 1.569742202758789
Epoch: 18, Steps: 12 | Train Loss: 1.240 Vali Loss: 1.420 Vali Acc: 0.583 Test Loss: 1.420 Test Acc: 0.583
Validation loss decreased (-0.561096 --> -0.583319).  Saving model ...
Epoch: 19 cost time: 1.4902963638305664
Epoch: 19, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.358 Vali Acc: 0.606 Test Loss: 1.358 Test Acc: 0.606
Validation loss decreased (-0.583319 --> -0.605542).  Saving model ...
Epoch: 20 cost time: 1.457205057144165
Epoch: 20, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.291 Vali Acc: 0.644 Test Loss: 1.291 Test Acc: 0.644
Validation loss decreased (-0.605542 --> -0.644432).  Saving model ...
Epoch: 21 cost time: 1.549332857131958
Epoch: 21, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.227 Vali Acc: 0.644 Test Loss: 1.227 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644432).  Saving model ...
Epoch: 22 cost time: 1.5695338249206543
Epoch: 22, Steps: 12 | Train Loss: 0.942 Vali Loss: 1.172 Vali Acc: 0.656 Test Loss: 1.172 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 23 cost time: 1.5479762554168701
Epoch: 23, Steps: 12 | Train Loss: 0.898 Vali Loss: 1.130 Vali Acc: 0.667 Test Loss: 1.130 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666655).  Saving model ...
Epoch: 24 cost time: 1.5547118186950684
Epoch: 24, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.090 Vali Acc: 0.656 Test Loss: 1.090 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5938184261322021
Epoch: 25, Steps: 12 | Train Loss: 0.807 Vali Loss: 1.052 Vali Acc: 0.672 Test Loss: 1.052 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672212).  Saving model ...
Epoch: 26 cost time: 1.4885368347167969
Epoch: 26, Steps: 12 | Train Loss: 0.781 Vali Loss: 1.018 Vali Acc: 0.661 Test Loss: 1.018 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.572200059890747
Epoch: 27, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.985 Vali Acc: 0.667 Test Loss: 0.985 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5253405570983887
Epoch: 28, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.962 Vali Acc: 0.678 Test Loss: 0.962 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 29 cost time: 1.587540626525879
Epoch: 29, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.932 Vali Acc: 0.678 Test Loss: 0.932 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677768).  Saving model ...
Epoch: 30 cost time: 1.5675969123840332
Epoch: 30, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.907 Vali Acc: 0.683 Test Loss: 0.907 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683324).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6833333333333333
model parameter : 48711
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.324774742126465
Epoch: 1, Steps: 12 | Train Loss: 2.835 Vali Loss: 2.701 Vali Acc: 0.072 Test Loss: 2.701 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 1.5920610427856445
Epoch: 2, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.664 Vali Acc: 0.089 Test Loss: 2.664 Test Acc: 0.089
Validation loss decreased (-0.072195 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 1.6207315921783447
Epoch: 3, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.614 Vali Acc: 0.122 Test Loss: 2.614 Test Acc: 0.122
Validation loss decreased (-0.088862 --> -0.122196).  Saving model ...
Epoch: 4 cost time: 1.5565540790557861
Epoch: 4, Steps: 12 | Train Loss: 2.667 Vali Loss: 2.556 Vali Acc: 0.178 Test Loss: 2.556 Test Acc: 0.178
Validation loss decreased (-0.122196 --> -0.177752).  Saving model ...
Epoch: 5 cost time: 1.6271321773529053
Epoch: 5, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.492 Vali Acc: 0.222 Test Loss: 2.492 Test Acc: 0.222
Validation loss decreased (-0.177752 --> -0.222197).  Saving model ...
Epoch: 6 cost time: 1.525651216506958
Epoch: 6, Steps: 12 | Train Loss: 2.495 Vali Loss: 2.422 Vali Acc: 0.267 Test Loss: 2.422 Test Acc: 0.267
Validation loss decreased (-0.222197 --> -0.266642).  Saving model ...
Epoch: 7 cost time: 1.5604503154754639
Epoch: 7, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.348 Vali Acc: 0.344 Test Loss: 2.348 Test Acc: 0.344
Validation loss decreased (-0.266642 --> -0.344421).  Saving model ...
Epoch: 8 cost time: 1.528226375579834
Epoch: 8, Steps: 12 | Train Loss: 2.341 Vali Loss: 2.267 Vali Acc: 0.406 Test Loss: 2.267 Test Acc: 0.406
Validation loss decreased (-0.344421 --> -0.405533).  Saving model ...
Epoch: 9 cost time: 1.573237419128418
Epoch: 9, Steps: 12 | Train Loss: 2.234 Vali Loss: 2.183 Vali Acc: 0.433 Test Loss: 2.183 Test Acc: 0.433
Validation loss decreased (-0.405533 --> -0.433312).  Saving model ...
Epoch: 10 cost time: 1.519660234451294
Epoch: 10, Steps: 12 | Train Loss: 2.142 Vali Loss: 2.095 Vali Acc: 0.439 Test Loss: 2.095 Test Acc: 0.439
Validation loss decreased (-0.433312 --> -0.438868).  Saving model ...
Epoch: 11 cost time: 1.5785160064697266
Epoch: 11, Steps: 12 | Train Loss: 2.020 Vali Loss: 2.007 Vali Acc: 0.467 Test Loss: 2.007 Test Acc: 0.467
Validation loss decreased (-0.438868 --> -0.466647).  Saving model ...
Epoch: 12 cost time: 1.6210150718688965
Epoch: 12, Steps: 12 | Train Loss: 1.966 Vali Loss: 1.914 Vali Acc: 0.506 Test Loss: 1.914 Test Acc: 0.506
Validation loss decreased (-0.466647 --> -0.505536).  Saving model ...
Epoch: 13 cost time: 1.5596373081207275
Epoch: 13, Steps: 12 | Train Loss: 1.826 Vali Loss: 1.828 Vali Acc: 0.517 Test Loss: 1.828 Test Acc: 0.517
Validation loss decreased (-0.505536 --> -0.516648).  Saving model ...
Epoch: 14 cost time: 1.5776913166046143
Epoch: 14, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.744 Vali Acc: 0.528 Test Loss: 1.744 Test Acc: 0.528
Validation loss decreased (-0.516648 --> -0.527760).  Saving model ...
Epoch: 15 cost time: 1.5794854164123535
Epoch: 15, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.663 Vali Acc: 0.533 Test Loss: 1.663 Test Acc: 0.533
Validation loss decreased (-0.527760 --> -0.533317).  Saving model ...
Epoch: 16 cost time: 1.6230809688568115
Epoch: 16, Steps: 12 | Train Loss: 1.496 Vali Loss: 1.589 Vali Acc: 0.544 Test Loss: 1.589 Test Acc: 0.544
Validation loss decreased (-0.533317 --> -0.544429).  Saving model ...
Epoch: 17 cost time: 1.5699210166931152
Epoch: 17, Steps: 12 | Train Loss: 1.379 Vali Loss: 1.519 Vali Acc: 0.561 Test Loss: 1.519 Test Acc: 0.561
Validation loss decreased (-0.544429 --> -0.561096).  Saving model ...
Epoch: 18 cost time: 1.6215896606445312
Epoch: 18, Steps: 12 | Train Loss: 1.299 Vali Loss: 1.456 Vali Acc: 0.589 Test Loss: 1.456 Test Acc: 0.589
Validation loss decreased (-0.561096 --> -0.588874).  Saving model ...
Epoch: 19 cost time: 1.5834357738494873
Epoch: 19, Steps: 12 | Train Loss: 1.240 Vali Loss: 1.395 Vali Acc: 0.594 Test Loss: 1.395 Test Acc: 0.594
Validation loss decreased (-0.588874 --> -0.594430).  Saving model ...
Epoch: 20 cost time: 1.4599206447601318
Epoch: 20, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.345 Vali Acc: 0.600 Test Loss: 1.345 Test Acc: 0.600
Validation loss decreased (-0.594430 --> -0.599987).  Saving model ...
Epoch: 21 cost time: 1.4728221893310547
Epoch: 21, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.298 Vali Acc: 0.617 Test Loss: 1.298 Test Acc: 0.617
Validation loss decreased (-0.599987 --> -0.616654).  Saving model ...
Epoch: 22 cost time: 1.5124051570892334
Epoch: 22, Steps: 12 | Train Loss: 1.021 Vali Loss: 1.254 Vali Acc: 0.622 Test Loss: 1.254 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 23 cost time: 1.5518467426300049
Epoch: 23, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.209 Vali Acc: 0.611 Test Loss: 1.209 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5373241901397705
Epoch: 24, Steps: 12 | Train Loss: 0.920 Vali Loss: 1.177 Vali Acc: 0.622 Test Loss: 1.177 Test Acc: 0.622
Validation loss decreased (-0.622210 --> -0.622210).  Saving model ...
Epoch: 25 cost time: 1.5148422718048096
Epoch: 25, Steps: 12 | Train Loss: 0.849 Vali Loss: 1.158 Vali Acc: 0.611 Test Loss: 1.158 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4866981506347656
Epoch: 26, Steps: 12 | Train Loss: 0.819 Vali Loss: 1.114 Vali Acc: 0.628 Test Loss: 1.114 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627767).  Saving model ...
Epoch: 27 cost time: 1.5195834636688232
Epoch: 27, Steps: 12 | Train Loss: 0.817 Vali Loss: 1.080 Vali Acc: 0.617 Test Loss: 1.080 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5529518127441406
Epoch: 28, Steps: 12 | Train Loss: 0.730 Vali Loss: 1.067 Vali Acc: 0.633 Test Loss: 1.067 Test Acc: 0.633
Validation loss decreased (-0.627767 --> -0.633323).  Saving model ...
Epoch: 29 cost time: 1.4372336864471436
Epoch: 29, Steps: 12 | Train Loss: 0.719 Vali Loss: 1.035 Vali Acc: 0.628 Test Loss: 1.035 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4852726459503174
Epoch: 30, Steps: 12 | Train Loss: 0.707 Vali Loss: 1.009 Vali Acc: 0.617 Test Loss: 1.009 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6333333333333333
model parameter : 152231
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9925143718719482
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.733 Vali Acc: 0.089 Test Loss: 2.733 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.4073941707611084
Epoch: 2, Steps: 12 | Train Loss: 2.669 Vali Loss: 2.693 Vali Acc: 0.117 Test Loss: 2.693 Test Acc: 0.117
Validation loss decreased (-0.088862 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 1.3995893001556396
Epoch: 3, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.640 Vali Acc: 0.172 Test Loss: 2.640 Test Acc: 0.172
Validation loss decreased (-0.116640 --> -0.172196).  Saving model ...
Epoch: 4 cost time: 1.3914616107940674
Epoch: 4, Steps: 12 | Train Loss: 2.563 Vali Loss: 2.578 Vali Acc: 0.211 Test Loss: 2.578 Test Acc: 0.211
Validation loss decreased (-0.172196 --> -0.211085).  Saving model ...
Epoch: 5 cost time: 1.6347143650054932
Epoch: 5, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.508 Vali Acc: 0.244 Test Loss: 2.508 Test Acc: 0.244
Validation loss decreased (-0.211085 --> -0.244419).  Saving model ...
Epoch: 6 cost time: 1.5966534614562988
Epoch: 6, Steps: 12 | Train Loss: 2.443 Vali Loss: 2.433 Vali Acc: 0.306 Test Loss: 2.433 Test Acc: 0.306
Validation loss decreased (-0.244419 --> -0.305531).  Saving model ...
Epoch: 7 cost time: 1.4253194332122803
Epoch: 7, Steps: 12 | Train Loss: 2.324 Vali Loss: 2.350 Vali Acc: 0.389 Test Loss: 2.350 Test Acc: 0.389
Validation loss decreased (-0.305531 --> -0.388865).  Saving model ...
Epoch: 8 cost time: 1.5204520225524902
Epoch: 8, Steps: 12 | Train Loss: 2.225 Vali Loss: 2.265 Vali Acc: 0.406 Test Loss: 2.265 Test Acc: 0.406
Validation loss decreased (-0.388865 --> -0.405533).  Saving model ...
Epoch: 9 cost time: 1.5152490139007568
Epoch: 9, Steps: 12 | Train Loss: 2.150 Vali Loss: 2.179 Vali Acc: 0.450 Test Loss: 2.179 Test Acc: 0.450
Validation loss decreased (-0.405533 --> -0.449978).  Saving model ...
Epoch: 10 cost time: 1.5325746536254883
Epoch: 10, Steps: 12 | Train Loss: 2.036 Vali Loss: 2.093 Vali Acc: 0.489 Test Loss: 2.093 Test Acc: 0.489
Validation loss decreased (-0.449978 --> -0.488868).  Saving model ...
Epoch: 11 cost time: 1.5899889469146729
Epoch: 11, Steps: 12 | Train Loss: 1.962 Vali Loss: 2.007 Vali Acc: 0.489 Test Loss: 2.007 Test Acc: 0.489
Validation loss decreased (-0.488868 --> -0.488869).  Saving model ...
Epoch: 12 cost time: 1.5534579753875732
Epoch: 12, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.920 Vali Acc: 0.494 Test Loss: 1.920 Test Acc: 0.494
Validation loss decreased (-0.488869 --> -0.494425).  Saving model ...
Epoch: 13 cost time: 1.5453546047210693
Epoch: 13, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.838 Vali Acc: 0.511 Test Loss: 1.838 Test Acc: 0.511
Validation loss decreased (-0.494425 --> -0.511093).  Saving model ...
Epoch: 14 cost time: 1.5522096157073975
Epoch: 14, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.765 Vali Acc: 0.528 Test Loss: 1.765 Test Acc: 0.528
Validation loss decreased (-0.511093 --> -0.527760).  Saving model ...
Epoch: 15 cost time: 1.5567896366119385
Epoch: 15, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.697 Vali Acc: 0.533 Test Loss: 1.697 Test Acc: 0.533
Validation loss decreased (-0.527760 --> -0.533316).  Saving model ...
Epoch: 16 cost time: 1.5541226863861084
Epoch: 16, Steps: 12 | Train Loss: 1.450 Vali Loss: 1.635 Vali Acc: 0.550 Test Loss: 1.635 Test Acc: 0.550
Validation loss decreased (-0.533316 --> -0.549984).  Saving model ...
Epoch: 17 cost time: 1.4586262702941895
Epoch: 17, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.570 Vali Acc: 0.556 Test Loss: 1.570 Test Acc: 0.556
Validation loss decreased (-0.549984 --> -0.555540).  Saving model ...
Epoch: 18 cost time: 1.5588786602020264
Epoch: 18, Steps: 12 | Train Loss: 1.271 Vali Loss: 1.513 Vali Acc: 0.567 Test Loss: 1.513 Test Acc: 0.567
Validation loss decreased (-0.555540 --> -0.566652).  Saving model ...
Epoch: 19 cost time: 1.5840272903442383
Epoch: 19, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.467 Vali Acc: 0.572 Test Loss: 1.467 Test Acc: 0.572
Validation loss decreased (-0.566652 --> -0.572208).  Saving model ...
Epoch: 20 cost time: 1.573270320892334
Epoch: 20, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.422 Vali Acc: 0.600 Test Loss: 1.422 Test Acc: 0.600
Validation loss decreased (-0.572208 --> -0.599986).  Saving model ...
Epoch: 21 cost time: 1.5823185443878174
Epoch: 21, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.374 Vali Acc: 0.628 Test Loss: 1.374 Test Acc: 0.628
Validation loss decreased (-0.599986 --> -0.627764).  Saving model ...
Epoch: 22 cost time: 1.5429422855377197
Epoch: 22, Steps: 12 | Train Loss: 1.069 Vali Loss: 1.330 Vali Acc: 0.606 Test Loss: 1.330 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5179860591888428
Epoch: 23, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.294 Vali Acc: 0.594 Test Loss: 1.294 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5493121147155762
Epoch: 24, Steps: 12 | Train Loss: 0.954 Vali Loss: 1.261 Vali Acc: 0.617 Test Loss: 1.261 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.485576868057251
Epoch: 25, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.230 Vali Acc: 0.611 Test Loss: 1.230 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4943859577178955
Epoch: 26, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.200 Vali Acc: 0.589 Test Loss: 1.200 Test Acc: 0.589
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3769760131835938
Epoch: 27, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.162 Vali Acc: 0.600 Test Loss: 1.162 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5914011001586914
Epoch: 28, Steps: 12 | Train Loss: 0.784 Vali Loss: 1.131 Vali Acc: 0.606 Test Loss: 1.131 Test Acc: 0.606
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4847450256347656
Epoch: 29, Steps: 12 | Train Loss: 0.723 Vali Loss: 1.104 Vali Acc: 0.628 Test Loss: 1.104 Test Acc: 0.628
Validation loss decreased (-0.627764 --> -0.627767).  Saving model ...
Epoch: 30 cost time: 1.5367279052734375
Epoch: 30, Steps: 12 | Train Loss: 0.716 Vali Loss: 1.087 Vali Acc: 0.633 Test Loss: 1.087 Test Acc: 0.633
Validation loss decreased (-0.627767 --> -0.633322).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6333333333333333
model parameter : 48711
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0005929470062256
Epoch: 1, Steps: 12 | Train Loss: 2.834 Vali Loss: 2.700 Vali Acc: 0.072 Test Loss: 2.700 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 1.3469326496124268
Epoch: 2, Steps: 12 | Train Loss: 2.744 Vali Loss: 2.665 Vali Acc: 0.094 Test Loss: 2.665 Test Acc: 0.094
Validation loss decreased (-0.072195 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 1.3435640335083008
Epoch: 3, Steps: 12 | Train Loss: 2.695 Vali Loss: 2.617 Vali Acc: 0.122 Test Loss: 2.617 Test Acc: 0.122
Validation loss decreased (-0.094418 --> -0.122196).  Saving model ...
Epoch: 4 cost time: 1.3145864009857178
Epoch: 4, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.563 Vali Acc: 0.172 Test Loss: 2.563 Test Acc: 0.172
Validation loss decreased (-0.122196 --> -0.172197).  Saving model ...
Epoch: 5 cost time: 1.3638041019439697
Epoch: 5, Steps: 12 | Train Loss: 2.588 Vali Loss: 2.503 Vali Acc: 0.217 Test Loss: 2.503 Test Acc: 0.217
Validation loss decreased (-0.172197 --> -0.216642).  Saving model ...
Epoch: 6 cost time: 1.3617262840270996
Epoch: 6, Steps: 12 | Train Loss: 2.510 Vali Loss: 2.438 Vali Acc: 0.239 Test Loss: 2.438 Test Acc: 0.239
Validation loss decreased (-0.216642 --> -0.238865).  Saving model ...
Epoch: 7 cost time: 1.2764391899108887
Epoch: 7, Steps: 12 | Train Loss: 2.455 Vali Loss: 2.370 Vali Acc: 0.289 Test Loss: 2.370 Test Acc: 0.289
Validation loss decreased (-0.238865 --> -0.288865).  Saving model ...
Epoch: 8 cost time: 1.3724427223205566
Epoch: 8, Steps: 12 | Train Loss: 2.369 Vali Loss: 2.297 Vali Acc: 0.344 Test Loss: 2.297 Test Acc: 0.344
Validation loss decreased (-0.288865 --> -0.344421).  Saving model ...
Epoch: 9 cost time: 1.475844144821167
Epoch: 9, Steps: 12 | Train Loss: 2.271 Vali Loss: 2.223 Vali Acc: 0.406 Test Loss: 2.223 Test Acc: 0.406
Validation loss decreased (-0.344421 --> -0.405533).  Saving model ...
Epoch: 10 cost time: 1.328399658203125
Epoch: 10, Steps: 12 | Train Loss: 2.194 Vali Loss: 2.147 Vali Acc: 0.428 Test Loss: 2.147 Test Acc: 0.428
Validation loss decreased (-0.405533 --> -0.427756).  Saving model ...
Epoch: 11 cost time: 1.2976136207580566
Epoch: 11, Steps: 12 | Train Loss: 2.088 Vali Loss: 2.074 Vali Acc: 0.467 Test Loss: 2.074 Test Acc: 0.467
Validation loss decreased (-0.427756 --> -0.466646).  Saving model ...
Epoch: 12 cost time: 1.3289942741394043
Epoch: 12, Steps: 12 | Train Loss: 2.051 Vali Loss: 1.996 Vali Acc: 0.472 Test Loss: 1.996 Test Acc: 0.472
Validation loss decreased (-0.466646 --> -0.472202).  Saving model ...
Epoch: 13 cost time: 1.39261794090271
Epoch: 13, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.924 Vali Acc: 0.500 Test Loss: 1.924 Test Acc: 0.500
Validation loss decreased (-0.472202 --> -0.499981).  Saving model ...
Epoch: 14 cost time: 1.4324531555175781
Epoch: 14, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.857 Vali Acc: 0.506 Test Loss: 1.857 Test Acc: 0.506
Validation loss decreased (-0.499981 --> -0.505537).  Saving model ...
Epoch: 15 cost time: 1.394918441772461
Epoch: 15, Steps: 12 | Train Loss: 1.720 Vali Loss: 1.793 Vali Acc: 0.506 Test Loss: 1.793 Test Acc: 0.506
Validation loss decreased (-0.505537 --> -0.505538).  Saving model ...
Epoch: 16 cost time: 1.4074268341064453
Epoch: 16, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.731 Vali Acc: 0.506 Test Loss: 1.731 Test Acc: 0.506
Validation loss decreased (-0.505538 --> -0.505538).  Saving model ...
Epoch: 17 cost time: 1.4378769397735596
Epoch: 17, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.674 Vali Acc: 0.511 Test Loss: 1.674 Test Acc: 0.511
Validation loss decreased (-0.505538 --> -0.511094).  Saving model ...
Epoch: 18 cost time: 1.4790263175964355
Epoch: 18, Steps: 12 | Train Loss: 1.504 Vali Loss: 1.622 Vali Acc: 0.528 Test Loss: 1.622 Test Acc: 0.528
Validation loss decreased (-0.511094 --> -0.527762).  Saving model ...
Epoch: 19 cost time: 1.4019427299499512
Epoch: 19, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.564 Vali Acc: 0.556 Test Loss: 1.564 Test Acc: 0.556
Validation loss decreased (-0.527762 --> -0.555540).  Saving model ...
Epoch: 20 cost time: 1.4041924476623535
Epoch: 20, Steps: 12 | Train Loss: 1.386 Vali Loss: 1.517 Vali Acc: 0.561 Test Loss: 1.517 Test Acc: 0.561
Validation loss decreased (-0.555540 --> -0.561096).  Saving model ...
Epoch: 21 cost time: 1.4297945499420166
Epoch: 21, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.472 Vali Acc: 0.567 Test Loss: 1.472 Test Acc: 0.567
Validation loss decreased (-0.561096 --> -0.566652).  Saving model ...
Epoch: 22 cost time: 1.421109914779663
Epoch: 22, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.426 Vali Acc: 0.583 Test Loss: 1.426 Test Acc: 0.583
Validation loss decreased (-0.566652 --> -0.583319).  Saving model ...
Epoch: 23 cost time: 1.4056274890899658
Epoch: 23, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.380 Vali Acc: 0.572 Test Loss: 1.380 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4182791709899902
Epoch: 24, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.349 Vali Acc: 0.561 Test Loss: 1.349 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4590034484863281
Epoch: 25, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.331 Vali Acc: 0.572 Test Loss: 1.331 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3779847621917725
Epoch: 26, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.279 Vali Acc: 0.572 Test Loss: 1.279 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.423293113708496
Epoch: 27, Steps: 12 | Train Loss: 1.002 Vali Loss: 1.244 Vali Acc: 0.578 Test Loss: 1.244 Test Acc: 0.578
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4507384300231934
Epoch: 28, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.214 Vali Acc: 0.600 Test Loss: 1.214 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599988).  Saving model ...
Epoch: 29 cost time: 1.4222075939178467
Epoch: 29, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.176 Vali Acc: 0.600 Test Loss: 1.176 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 30 cost time: 1.3916943073272705
Epoch: 30, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.152 Vali Acc: 0.600 Test Loss: 1.152 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6
model parameter : 152231
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.877549886703491
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.732 Vali Acc: 0.094 Test Loss: 2.732 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 1.3559484481811523
Epoch: 2, Steps: 12 | Train Loss: 2.675 Vali Loss: 2.694 Vali Acc: 0.106 Test Loss: 2.694 Test Acc: 0.106
Validation loss decreased (-0.094417 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 1.3558259010314941
Epoch: 3, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.643 Vali Acc: 0.161 Test Loss: 2.643 Test Acc: 0.161
Validation loss decreased (-0.105529 --> -0.161085).  Saving model ...
Epoch: 4 cost time: 1.2977347373962402
Epoch: 4, Steps: 12 | Train Loss: 2.571 Vali Loss: 2.584 Vali Acc: 0.200 Test Loss: 2.584 Test Acc: 0.200
Validation loss decreased (-0.161085 --> -0.199974).  Saving model ...
Epoch: 5 cost time: 1.3220598697662354
Epoch: 5, Steps: 12 | Train Loss: 2.508 Vali Loss: 2.517 Vali Acc: 0.228 Test Loss: 2.517 Test Acc: 0.228
Validation loss decreased (-0.199974 --> -0.227753).  Saving model ...
Epoch: 6 cost time: 1.2660455703735352
Epoch: 6, Steps: 12 | Train Loss: 2.461 Vali Loss: 2.445 Vali Acc: 0.289 Test Loss: 2.445 Test Acc: 0.289
Validation loss decreased (-0.227753 --> -0.288864).  Saving model ...
Epoch: 7 cost time: 1.2227060794830322
Epoch: 7, Steps: 12 | Train Loss: 2.354 Vali Loss: 2.367 Vali Acc: 0.367 Test Loss: 2.367 Test Acc: 0.367
Validation loss decreased (-0.288864 --> -0.366643).  Saving model ...
Epoch: 8 cost time: 1.255242109298706
Epoch: 8, Steps: 12 | Train Loss: 2.259 Vali Loss: 2.289 Vali Acc: 0.400 Test Loss: 2.289 Test Acc: 0.400
Validation loss decreased (-0.366643 --> -0.399977).  Saving model ...
Epoch: 9 cost time: 1.3059587478637695
Epoch: 9, Steps: 12 | Train Loss: 2.197 Vali Loss: 2.209 Vali Acc: 0.428 Test Loss: 2.209 Test Acc: 0.428
Validation loss decreased (-0.399977 --> -0.427756).  Saving model ...
Epoch: 10 cost time: 1.2502999305725098
Epoch: 10, Steps: 12 | Train Loss: 2.094 Vali Loss: 2.133 Vali Acc: 0.472 Test Loss: 2.133 Test Acc: 0.472
Validation loss decreased (-0.427756 --> -0.472201).  Saving model ...
Epoch: 11 cost time: 1.2695338726043701
Epoch: 11, Steps: 12 | Train Loss: 2.031 Vali Loss: 2.056 Vali Acc: 0.472 Test Loss: 2.056 Test Acc: 0.472
Validation loss decreased (-0.472201 --> -0.472202).  Saving model ...
Epoch: 12 cost time: 1.2843775749206543
Epoch: 12, Steps: 12 | Train Loss: 1.917 Vali Loss: 1.980 Vali Acc: 0.494 Test Loss: 1.980 Test Acc: 0.494
Validation loss decreased (-0.472202 --> -0.494425).  Saving model ...
Epoch: 13 cost time: 1.2744429111480713
Epoch: 13, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.906 Vali Acc: 0.483 Test Loss: 1.906 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2735872268676758
Epoch: 14, Steps: 12 | Train Loss: 1.721 Vali Loss: 1.838 Vali Acc: 0.489 Test Loss: 1.838 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.298816204071045
Epoch: 15, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.772 Vali Acc: 0.506 Test Loss: 1.772 Test Acc: 0.506
Validation loss decreased (-0.494425 --> -0.505538).  Saving model ...
Epoch: 16 cost time: 1.2253937721252441
Epoch: 16, Steps: 12 | Train Loss: 1.565 Vali Loss: 1.714 Vali Acc: 0.522 Test Loss: 1.714 Test Acc: 0.522
Validation loss decreased (-0.505538 --> -0.522205).  Saving model ...
Epoch: 17 cost time: 1.3079938888549805
Epoch: 17, Steps: 12 | Train Loss: 1.516 Vali Loss: 1.651 Vali Acc: 0.528 Test Loss: 1.651 Test Acc: 0.528
Validation loss decreased (-0.522205 --> -0.527761).  Saving model ...
Epoch: 18 cost time: 1.3261516094207764
Epoch: 18, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.597 Vali Acc: 0.567 Test Loss: 1.597 Test Acc: 0.567
Validation loss decreased (-0.527761 --> -0.566651).  Saving model ...
Epoch: 19 cost time: 1.2987215518951416
Epoch: 19, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.552 Vali Acc: 0.567 Test Loss: 1.552 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 20 cost time: 1.3272502422332764
Epoch: 20, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.506 Vali Acc: 0.567 Test Loss: 1.506 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566652).  Saving model ...
Epoch: 21 cost time: 1.2141952514648438
Epoch: 21, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.466 Vali Acc: 0.572 Test Loss: 1.466 Test Acc: 0.572
Validation loss decreased (-0.566652 --> -0.572208).  Saving model ...
Epoch: 22 cost time: 1.2775273323059082
Epoch: 22, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.430 Vali Acc: 0.572 Test Loss: 1.430 Test Acc: 0.572
Validation loss decreased (-0.572208 --> -0.572208).  Saving model ...
Epoch: 23 cost time: 1.222313404083252
Epoch: 23, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.393 Vali Acc: 0.578 Test Loss: 1.393 Test Acc: 0.578
Validation loss decreased (-0.572208 --> -0.577764).  Saving model ...
Epoch: 24 cost time: 1.2078802585601807
Epoch: 24, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.360 Vali Acc: 0.594 Test Loss: 1.360 Test Acc: 0.594
Validation loss decreased (-0.577764 --> -0.594431).  Saving model ...
Epoch: 25 cost time: 1.2378039360046387
Epoch: 25, Steps: 12 | Train Loss: 1.034 Vali Loss: 1.335 Vali Acc: 0.578 Test Loss: 1.335 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2887508869171143
Epoch: 26, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.303 Vali Acc: 0.583 Test Loss: 1.303 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2964823246002197
Epoch: 27, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.278 Vali Acc: 0.606 Test Loss: 1.278 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605543).  Saving model ...
Epoch: 28 cost time: 1.2976562976837158
Epoch: 28, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.252 Vali Acc: 0.600 Test Loss: 1.252 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3081789016723633
Epoch: 29, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.225 Vali Acc: 0.606 Test Loss: 1.225 Test Acc: 0.606
Validation loss decreased (-0.605543 --> -0.605543).  Saving model ...
Epoch: 30 cost time: 1.2717444896697998
Epoch: 30, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.199 Vali Acc: 0.600 Test Loss: 1.199 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_TimesNet_UEA_ftM_sl45_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6055555555555555
model parameter : 48711
model size : 0.35MB
