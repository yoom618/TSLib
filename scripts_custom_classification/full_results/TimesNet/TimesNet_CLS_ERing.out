Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 7.393781900405884
Epoch: 1, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.766 Vali Acc: 0.193 Test Loss: 1.766 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 5.271359920501709
Epoch: 2, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.691 Vali Acc: 0.319 Test Loss: 1.691 Test Acc: 0.319
Validation loss decreased (-0.192575 --> -0.318502).  Saving model ...
Epoch: 3 cost time: 5.504803419113159
Epoch: 3, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.598 Vali Acc: 0.463 Test Loss: 1.598 Test Acc: 0.463
Validation loss decreased (-0.318502 --> -0.462947).  Saving model ...
Epoch: 4 cost time: 4.891514301300049
Epoch: 4, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.449 Vali Acc: 0.644 Test Loss: 1.449 Test Acc: 0.644
Validation loss decreased (-0.462947 --> -0.644430).  Saving model ...
Epoch: 5 cost time: 5.299727201461792
Epoch: 5, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.275 Vali Acc: 0.774 Test Loss: 1.275 Test Acc: 0.774
Validation loss decreased (-0.644430 --> -0.774061).  Saving model ...
Epoch: 6 cost time: 5.231614828109741
Epoch: 6, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.095 Vali Acc: 0.822 Test Loss: 1.095 Test Acc: 0.822
Validation loss decreased (-0.774061 --> -0.822211).  Saving model ...
Epoch: 7 cost time: 5.139734268188477
Epoch: 7, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.927 Vali Acc: 0.870 Test Loss: 0.927 Test Acc: 0.870
Validation loss decreased (-0.822211 --> -0.870361).  Saving model ...
Epoch: 8 cost time: 5.26805567741394
Epoch: 8, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.777 Vali Acc: 0.896 Test Loss: 0.777 Test Acc: 0.896
Validation loss decreased (-0.870361 --> -0.896289).  Saving model ...
Epoch: 9 cost time: 5.237114191055298
Epoch: 9, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.652 Vali Acc: 0.907 Test Loss: 0.652 Test Acc: 0.907
Validation loss decreased (-0.896289 --> -0.907401).  Saving model ...
Epoch: 10 cost time: 4.348952054977417
Epoch: 10, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.551 Vali Acc: 0.907 Test Loss: 0.551 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 11 cost time: 5.1996750831604
Epoch: 11, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.469 Vali Acc: 0.922 Test Loss: 0.469 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922218).  Saving model ...
Epoch: 12 cost time: 4.8165507316589355
Epoch: 12, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.408 Vali Acc: 0.907 Test Loss: 0.408 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.857728719711304
Epoch: 13, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.355 Vali Acc: 0.911 Test Loss: 0.355 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.798889636993408
Epoch: 14, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.70228910446167
Epoch: 15, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.281 Vali Acc: 0.919 Test Loss: 0.281 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.717091798782349
Epoch: 16, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 4.811241865158081
Epoch: 17, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.241 Vali Acc: 0.926 Test Loss: 0.241 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 18 cost time: 4.924548149108887
Epoch: 18, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.230 Vali Acc: 0.919 Test Loss: 0.230 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.704285383224487
Epoch: 19, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.291903257369995
Epoch: 20, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.215 Vali Acc: 0.915 Test Loss: 0.215 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.83169150352478
Epoch: 21, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.919 Test Loss: 0.210 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.88605260848999
Epoch: 22, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.207 Vali Acc: 0.915 Test Loss: 0.207 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.264500141143799
Epoch: 23, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.915 Test Loss: 0.204 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.2518227100372314
Epoch: 24, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.915 Test Loss: 0.203 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.214106321334839
Epoch: 25, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.919 Test Loss: 0.201 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.310762166976929
Epoch: 26, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.8086371421813965
Epoch: 27, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 75034630
model size : 288.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.277900695800781
Epoch: 1, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.790 Vali Acc: 0.259 Test Loss: 1.790 Test Acc: 0.259
Validation loss decreased (inf --> -0.259241).  Saving model ...
Epoch: 2 cost time: 2.6505355834960938
Epoch: 2, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.722 Vali Acc: 0.319 Test Loss: 1.722 Test Acc: 0.319
Validation loss decreased (-0.259241 --> -0.318501).  Saving model ...
Epoch: 3 cost time: 2.626455783843994
Epoch: 3, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.630 Vali Acc: 0.389 Test Loss: 1.630 Test Acc: 0.389
Validation loss decreased (-0.318501 --> -0.388873).  Saving model ...
Epoch: 4 cost time: 2.7291810512542725
Epoch: 4, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.479 Vali Acc: 0.515 Test Loss: 1.479 Test Acc: 0.515
Validation loss decreased (-0.388873 --> -0.514800).  Saving model ...
Epoch: 5 cost time: 2.6063919067382812
Epoch: 5, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.300 Vali Acc: 0.644 Test Loss: 1.300 Test Acc: 0.644
Validation loss decreased (-0.514800 --> -0.644431).  Saving model ...
Epoch: 6 cost time: 2.6956045627593994
Epoch: 6, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.116 Vali Acc: 0.719 Test Loss: 1.116 Test Acc: 0.719
Validation loss decreased (-0.644431 --> -0.718507).  Saving model ...
Epoch: 7 cost time: 2.735891819000244
Epoch: 7, Steps: 2 | Train Loss: 0.967 Vali Loss: 0.946 Vali Acc: 0.789 Test Loss: 0.946 Test Acc: 0.789
Validation loss decreased (-0.718507 --> -0.788879).  Saving model ...
Epoch: 8 cost time: 2.6134324073791504
Epoch: 8, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.799 Vali Acc: 0.841 Test Loss: 0.799 Test Acc: 0.841
Validation loss decreased (-0.788879 --> -0.840733).  Saving model ...
Epoch: 9 cost time: 2.2016983032226562
Epoch: 9, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.674 Vali Acc: 0.870 Test Loss: 0.674 Test Acc: 0.870
Validation loss decreased (-0.840733 --> -0.870364).  Saving model ...
Epoch: 10 cost time: 2.641512155532837
Epoch: 10, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.574 Vali Acc: 0.889 Test Loss: 0.574 Test Acc: 0.889
Validation loss decreased (-0.870364 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 2.594456195831299
Epoch: 11, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.491 Vali Acc: 0.907 Test Loss: 0.491 Test Acc: 0.907
Validation loss decreased (-0.888883 --> -0.907403).  Saving model ...
Epoch: 12 cost time: 2.8338441848754883
Epoch: 12, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.426 Vali Acc: 0.911 Test Loss: 0.426 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 13 cost time: 2.515744686126709
Epoch: 13, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.372 Vali Acc: 0.922 Test Loss: 0.372 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922219).  Saving model ...
Epoch: 14 cost time: 2.4149222373962402
Epoch: 14, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.328 Vali Acc: 0.919 Test Loss: 0.328 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1876072883605957
Epoch: 15, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.295 Vali Acc: 0.919 Test Loss: 0.295 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3758602142333984
Epoch: 16, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.277003049850464
Epoch: 17, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.252 Vali Acc: 0.915 Test Loss: 0.252 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2774882316589355
Epoch: 18, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925924).  Saving model ...
Epoch: 19 cost time: 2.385286331176758
Epoch: 19, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 20 cost time: 2.247988224029541
Epoch: 20, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 21 cost time: 2.5295591354370117
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 22 cost time: 2.601886034011841
Epoch: 22, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 23 cost time: 2.6846652030944824
Epoch: 23, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 24 cost time: 2.7650578022003174
Epoch: 24, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 25 cost time: 2.7563316822052
Epoch: 25, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 26 cost time: 2.643277168273926
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 27 cost time: 2.455324411392212
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 28 cost time: 2.6357972621917725
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 29 cost time: 2.650256633758545
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 30 cost time: 2.6964187622070312
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 22078470
model size : 86.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 5.291962623596191
Epoch: 1, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.766 Vali Acc: 0.193 Test Loss: 1.766 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 3.2334096431732178
Epoch: 2, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.691 Vali Acc: 0.319 Test Loss: 1.691 Test Acc: 0.319
Validation loss decreased (-0.192575 --> -0.318502).  Saving model ...
Epoch: 3 cost time: 3.465193271636963
Epoch: 3, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.598 Vali Acc: 0.463 Test Loss: 1.598 Test Acc: 0.463
Validation loss decreased (-0.318502 --> -0.462947).  Saving model ...
Epoch: 4 cost time: 3.367138385772705
Epoch: 4, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.449 Vali Acc: 0.644 Test Loss: 1.449 Test Acc: 0.644
Validation loss decreased (-0.462947 --> -0.644430).  Saving model ...
Epoch: 5 cost time: 3.2186973094940186
Epoch: 5, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.275 Vali Acc: 0.774 Test Loss: 1.275 Test Acc: 0.774
Validation loss decreased (-0.644430 --> -0.774061).  Saving model ...
Epoch: 6 cost time: 3.333404064178467
Epoch: 6, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.095 Vali Acc: 0.822 Test Loss: 1.095 Test Acc: 0.822
Validation loss decreased (-0.774061 --> -0.822211).  Saving model ...
Epoch: 7 cost time: 3.1675796508789062
Epoch: 7, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.927 Vali Acc: 0.870 Test Loss: 0.927 Test Acc: 0.870
Validation loss decreased (-0.822211 --> -0.870361).  Saving model ...
Epoch: 8 cost time: 4.024467468261719
Epoch: 8, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.777 Vali Acc: 0.896 Test Loss: 0.777 Test Acc: 0.896
Validation loss decreased (-0.870361 --> -0.896289).  Saving model ...
Epoch: 9 cost time: 4.02428936958313
Epoch: 9, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.652 Vali Acc: 0.907 Test Loss: 0.652 Test Acc: 0.907
Validation loss decreased (-0.896289 --> -0.907401).  Saving model ...
Epoch: 10 cost time: 3.9536702632904053
Epoch: 10, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.551 Vali Acc: 0.907 Test Loss: 0.551 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 11 cost time: 3.847431182861328
Epoch: 11, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.469 Vali Acc: 0.922 Test Loss: 0.469 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922218).  Saving model ...
Epoch: 12 cost time: 3.9900169372558594
Epoch: 12, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.408 Vali Acc: 0.907 Test Loss: 0.408 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.749234199523926
Epoch: 13, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.355 Vali Acc: 0.911 Test Loss: 0.355 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.779758930206299
Epoch: 14, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.825697183609009
Epoch: 15, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.281 Vali Acc: 0.919 Test Loss: 0.281 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.8356316089630127
Epoch: 16, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 3.5979037284851074
Epoch: 17, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.241 Vali Acc: 0.926 Test Loss: 0.241 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 18 cost time: 3.760268449783325
Epoch: 18, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.230 Vali Acc: 0.919 Test Loss: 0.230 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.854475498199463
Epoch: 19, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.7889328002929688
Epoch: 20, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.215 Vali Acc: 0.915 Test Loss: 0.215 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.1265108585357666
Epoch: 21, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.919 Test Loss: 0.210 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.4226174354553223
Epoch: 22, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.207 Vali Acc: 0.915 Test Loss: 0.207 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.2525670528411865
Epoch: 23, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.915 Test Loss: 0.204 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.68595552444458
Epoch: 24, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.915 Test Loss: 0.203 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.7664806842803955
Epoch: 25, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.919 Test Loss: 0.201 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.102943181991577
Epoch: 26, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.7339248657226562
Epoch: 27, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 75034630
model size : 288.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.630970001220703
Epoch: 1, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.790 Vali Acc: 0.259 Test Loss: 1.790 Test Acc: 0.259
Validation loss decreased (inf --> -0.259241).  Saving model ...
Epoch: 2 cost time: 2.038067102432251
Epoch: 2, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.722 Vali Acc: 0.319 Test Loss: 1.722 Test Acc: 0.319
Validation loss decreased (-0.259241 --> -0.318501).  Saving model ...
Epoch: 3 cost time: 2.031764507293701
Epoch: 3, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.630 Vali Acc: 0.389 Test Loss: 1.630 Test Acc: 0.389
Validation loss decreased (-0.318501 --> -0.388873).  Saving model ...
Epoch: 4 cost time: 2.4534409046173096
Epoch: 4, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.479 Vali Acc: 0.515 Test Loss: 1.479 Test Acc: 0.515
Validation loss decreased (-0.388873 --> -0.514800).  Saving model ...
Epoch: 5 cost time: 2.296368360519409
Epoch: 5, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.300 Vali Acc: 0.644 Test Loss: 1.300 Test Acc: 0.644
Validation loss decreased (-0.514800 --> -0.644431).  Saving model ...
Epoch: 6 cost time: 2.345954179763794
Epoch: 6, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.116 Vali Acc: 0.719 Test Loss: 1.116 Test Acc: 0.719
Validation loss decreased (-0.644431 --> -0.718507).  Saving model ...
Epoch: 7 cost time: 2.5404748916625977
Epoch: 7, Steps: 2 | Train Loss: 0.967 Vali Loss: 0.946 Vali Acc: 0.789 Test Loss: 0.946 Test Acc: 0.789
Validation loss decreased (-0.718507 --> -0.788879).  Saving model ...
Epoch: 8 cost time: 2.3395726680755615
Epoch: 8, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.799 Vali Acc: 0.841 Test Loss: 0.799 Test Acc: 0.841
Validation loss decreased (-0.788879 --> -0.840733).  Saving model ...
Epoch: 9 cost time: 2.4082677364349365
Epoch: 9, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.674 Vali Acc: 0.870 Test Loss: 0.674 Test Acc: 0.870
Validation loss decreased (-0.840733 --> -0.870364).  Saving model ...
Epoch: 10 cost time: 2.1694555282592773
Epoch: 10, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.574 Vali Acc: 0.889 Test Loss: 0.574 Test Acc: 0.889
Validation loss decreased (-0.870364 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 2.396472930908203
Epoch: 11, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.491 Vali Acc: 0.907 Test Loss: 0.491 Test Acc: 0.907
Validation loss decreased (-0.888883 --> -0.907403).  Saving model ...
Epoch: 12 cost time: 2.286027669906616
Epoch: 12, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.426 Vali Acc: 0.911 Test Loss: 0.426 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 13 cost time: 2.0839338302612305
Epoch: 13, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.372 Vali Acc: 0.922 Test Loss: 0.372 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922219).  Saving model ...
Epoch: 14 cost time: 2.3865184783935547
Epoch: 14, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.328 Vali Acc: 0.919 Test Loss: 0.328 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.350245952606201
Epoch: 15, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.295 Vali Acc: 0.919 Test Loss: 0.295 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.384990692138672
Epoch: 16, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3435797691345215
Epoch: 17, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.252 Vali Acc: 0.915 Test Loss: 0.252 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.364637613296509
Epoch: 18, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925924).  Saving model ...
Epoch: 19 cost time: 2.516315460205078
Epoch: 19, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 20 cost time: 2.2882683277130127
Epoch: 20, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 21 cost time: 2.320446252822876
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 22 cost time: 2.015117883682251
Epoch: 22, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 23 cost time: 2.070604085922241
Epoch: 23, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 24 cost time: 2.0438199043273926
Epoch: 24, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 25 cost time: 2.3763716220855713
Epoch: 25, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 26 cost time: 2.130446195602417
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 27 cost time: 2.1616263389587402
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 28 cost time: 2.057427406311035
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 29 cost time: 2.2845091819763184
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 30 cost time: 2.2004940509796143
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 22078470
model size : 86.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.250216007232666
Epoch: 1, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.765 Vali Acc: 0.193 Test Loss: 1.765 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 2.2315425872802734
Epoch: 2, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.691 Vali Acc: 0.319 Test Loss: 1.691 Test Acc: 0.319
Validation loss decreased (-0.192575 --> -0.318502).  Saving model ...
Epoch: 3 cost time: 2.4337801933288574
Epoch: 3, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.599 Vali Acc: 0.459 Test Loss: 1.599 Test Acc: 0.459
Validation loss decreased (-0.318502 --> -0.459243).  Saving model ...
Epoch: 4 cost time: 1.9520151615142822
Epoch: 4, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.453 Vali Acc: 0.637 Test Loss: 1.453 Test Acc: 0.637
Validation loss decreased (-0.459243 --> -0.637023).  Saving model ...
Epoch: 5 cost time: 2.159782648086548
Epoch: 5, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.282 Vali Acc: 0.770 Test Loss: 1.282 Test Acc: 0.770
Validation loss decreased (-0.637023 --> -0.770358).  Saving model ...
Epoch: 6 cost time: 2.1156647205352783
Epoch: 6, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.105 Vali Acc: 0.819 Test Loss: 1.105 Test Acc: 0.819
Validation loss decreased (-0.770358 --> -0.818507).  Saving model ...
Epoch: 7 cost time: 2.200260639190674
Epoch: 7, Steps: 2 | Train Loss: 0.922 Vali Loss: 0.937 Vali Acc: 0.856 Test Loss: 0.937 Test Acc: 0.856
Validation loss decreased (-0.818507 --> -0.855546).  Saving model ...
Epoch: 8 cost time: 2.2764692306518555
Epoch: 8, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.786 Vali Acc: 0.893 Test Loss: 0.786 Test Acc: 0.893
Validation loss decreased (-0.855546 --> -0.892585).  Saving model ...
Epoch: 9 cost time: 2.414642095565796
Epoch: 9, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.659 Vali Acc: 0.904 Test Loss: 0.659 Test Acc: 0.904
Validation loss decreased (-0.892585 --> -0.903697).  Saving model ...
Epoch: 10 cost time: 2.3250489234924316
Epoch: 10, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.557 Vali Acc: 0.911 Test Loss: 0.557 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911106).  Saving model ...
Epoch: 11 cost time: 2.3484747409820557
Epoch: 11, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.475 Vali Acc: 0.922 Test Loss: 0.475 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922217).  Saving model ...
Epoch: 12 cost time: 2.4471890926361084
Epoch: 12, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.413 Vali Acc: 0.907 Test Loss: 0.413 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1979119777679443
Epoch: 13, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1659181118011475
Epoch: 14, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.318 Vali Acc: 0.911 Test Loss: 0.318 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1796932220458984
Epoch: 15, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.286 Vali Acc: 0.919 Test Loss: 0.286 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3758833408355713
Epoch: 16, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.263 Vali Acc: 0.919 Test Loss: 0.263 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3087854385375977
Epoch: 17, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3603882789611816
Epoch: 18, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.235 Vali Acc: 0.915 Test Loss: 0.235 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.003201484680176
Epoch: 19, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7813947200775146
Epoch: 20, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0122733116149902
Epoch: 21, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.216 Vali Acc: 0.915 Test Loss: 0.216 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 75034630
model size : 288.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.915130853652954
Epoch: 1, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.791 Vali Acc: 0.252 Test Loss: 1.791 Test Acc: 0.252
Validation loss decreased (inf --> -0.251834).  Saving model ...
Epoch: 2 cost time: 1.2980303764343262
Epoch: 2, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.723 Vali Acc: 0.311 Test Loss: 1.723 Test Acc: 0.311
Validation loss decreased (-0.251834 --> -0.311094).  Saving model ...
Epoch: 3 cost time: 1.1818702220916748
Epoch: 3, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.632 Vali Acc: 0.385 Test Loss: 1.632 Test Acc: 0.385
Validation loss decreased (-0.311094 --> -0.385169).  Saving model ...
Epoch: 4 cost time: 1.0985753536224365
Epoch: 4, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.483 Vali Acc: 0.511 Test Loss: 1.483 Test Acc: 0.511
Validation loss decreased (-0.385169 --> -0.511096).  Saving model ...
Epoch: 5 cost time: 1.0692760944366455
Epoch: 5, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.307 Vali Acc: 0.641 Test Loss: 1.307 Test Acc: 0.641
Validation loss decreased (-0.511096 --> -0.640728).  Saving model ...
Epoch: 6 cost time: 1.142103672027588
Epoch: 6, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.123 Vali Acc: 0.711 Test Loss: 1.123 Test Acc: 0.711
Validation loss decreased (-0.640728 --> -0.711100).  Saving model ...
Epoch: 7 cost time: 1.311413288116455
Epoch: 7, Steps: 2 | Train Loss: 0.984 Vali Loss: 0.955 Vali Acc: 0.789 Test Loss: 0.955 Test Acc: 0.789
Validation loss decreased (-0.711100 --> -0.788879).  Saving model ...
Epoch: 8 cost time: 1.2731680870056152
Epoch: 8, Steps: 2 | Train Loss: 0.796 Vali Loss: 0.806 Vali Acc: 0.833 Test Loss: 0.806 Test Acc: 0.833
Validation loss decreased (-0.788879 --> -0.833325).  Saving model ...
Epoch: 9 cost time: 0.9922354221343994
Epoch: 9, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.681 Vali Acc: 0.870 Test Loss: 0.681 Test Acc: 0.870
Validation loss decreased (-0.833325 --> -0.870364).  Saving model ...
Epoch: 10 cost time: 1.2178139686584473
Epoch: 10, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.579 Vali Acc: 0.885 Test Loss: 0.579 Test Acc: 0.885
Validation loss decreased (-0.870364 --> -0.885179).  Saving model ...
Epoch: 11 cost time: 1.1931092739105225
Epoch: 11, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.495 Vali Acc: 0.904 Test Loss: 0.495 Test Acc: 0.904
Validation loss decreased (-0.885179 --> -0.903699).  Saving model ...
Epoch: 12 cost time: 1.2135684490203857
Epoch: 12, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.429 Vali Acc: 0.904 Test Loss: 0.429 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 13 cost time: 1.243100643157959
Epoch: 13, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.375 Vali Acc: 0.919 Test Loss: 0.375 Test Acc: 0.919
Validation loss decreased (-0.903699 --> -0.918515).  Saving model ...
Epoch: 14 cost time: 1.1586289405822754
Epoch: 14, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.331 Vali Acc: 0.915 Test Loss: 0.331 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2085084915161133
Epoch: 15, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.298 Vali Acc: 0.919 Test Loss: 0.298 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 16 cost time: 1.2189273834228516
Epoch: 16, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.275 Vali Acc: 0.919 Test Loss: 0.275 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 17 cost time: 1.297266960144043
Epoch: 17, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.255 Vali Acc: 0.915 Test Loss: 0.255 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.164778709411621
Epoch: 18, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 19 cost time: 1.2606127262115479
Epoch: 19, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 20 cost time: 1.3408148288726807
Epoch: 20, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 21 cost time: 1.4066481590270996
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 1.2543656826019287
Epoch: 22, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.375216007232666
Epoch: 23, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4309885501861572
Epoch: 24, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3355226516723633
Epoch: 25, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.926 Test Loss: 0.186 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1293444633483887
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2693519592285156
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.385883092880249
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1901283264160156
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2152085304260254
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 22078470
model size : 86.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 5.453871250152588
Epoch: 1, Steps: 2 | Train Loss: 2.012 Vali Loss: 1.823 Vali Acc: 0.148 Test Loss: 1.823 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 3.433527946472168
Epoch: 2, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.744 Vali Acc: 0.207 Test Loss: 1.744 Test Acc: 0.207
Validation loss decreased (-0.148130 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 3.327188491821289
Epoch: 3, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.652 Vali Acc: 0.356 Test Loss: 1.652 Test Acc: 0.356
Validation loss decreased (-0.207390 --> -0.355539).  Saving model ...
Epoch: 4 cost time: 2.8538761138916016
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.515 Vali Acc: 0.541 Test Loss: 1.515 Test Acc: 0.541
Validation loss decreased (-0.355539 --> -0.540726).  Saving model ...
Epoch: 5 cost time: 3.224364995956421
Epoch: 5, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.350 Vali Acc: 0.693 Test Loss: 1.350 Test Acc: 0.693
Validation loss decreased (-0.540726 --> -0.692579).  Saving model ...
Epoch: 6 cost time: 3.2810094356536865
Epoch: 6, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.175 Vali Acc: 0.830 Test Loss: 1.175 Test Acc: 0.830
Validation loss decreased (-0.692579 --> -0.829618).  Saving model ...
Epoch: 7 cost time: 3.2985146045684814
Epoch: 7, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.003 Vali Acc: 0.878 Test Loss: 1.003 Test Acc: 0.878
Validation loss decreased (-0.829618 --> -0.877768).  Saving model ...
Epoch: 8 cost time: 3.2831897735595703
Epoch: 8, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.848 Vali Acc: 0.893 Test Loss: 0.848 Test Acc: 0.893
Validation loss decreased (-0.877768 --> -0.892584).  Saving model ...
Epoch: 9 cost time: 2.8431224822998047
Epoch: 9, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.710 Vali Acc: 0.919 Test Loss: 0.710 Test Acc: 0.919
Validation loss decreased (-0.892584 --> -0.918511).  Saving model ...
Epoch: 10 cost time: 3.1302242279052734
Epoch: 10, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.593 Vali Acc: 0.926 Test Loss: 0.593 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925920).  Saving model ...
Epoch: 11 cost time: 3.1915972232818604
Epoch: 11, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.496 Vali Acc: 0.933 Test Loss: 0.496 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933328).  Saving model ...
Epoch: 12 cost time: 3.3201146125793457
Epoch: 12, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.420 Vali Acc: 0.937 Test Loss: 0.420 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937033).  Saving model ...
Epoch: 13 cost time: 3.081045389175415
Epoch: 13, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.358 Vali Acc: 0.941 Test Loss: 0.358 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 14 cost time: 3.2920584678649902
Epoch: 14, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.633871078491211
Epoch: 15, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4228355884552
Epoch: 16, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.256439208984375
Epoch: 17, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3356757164001465
Epoch: 18, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.6424167156219482
Epoch: 19, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.526980400085449
Epoch: 20, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.869920492172241
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.1621227264404297
Epoch: 22, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.919 Test Loss: 0.197 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.5475027561187744
Epoch: 23, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.195 Vali Acc: 0.915 Test Loss: 0.195 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 37544966
model size : 145.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.725308895111084
Epoch: 1, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.725 Vali Acc: 0.285 Test Loss: 1.725 Test Acc: 0.285
Validation loss decreased (inf --> -0.285168).  Saving model ...
Epoch: 2 cost time: 1.456122875213623
Epoch: 2, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.658 Vali Acc: 0.330 Test Loss: 1.658 Test Acc: 0.330
Validation loss decreased (-0.285168 --> -0.329613).  Saving model ...
Epoch: 3 cost time: 1.4371862411499023
Epoch: 3, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.578 Vali Acc: 0.396 Test Loss: 1.578 Test Acc: 0.396
Validation loss decreased (-0.329613 --> -0.396281).  Saving model ...
Epoch: 4 cost time: 1.6297223567962646
Epoch: 4, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.458 Vali Acc: 0.504 Test Loss: 1.458 Test Acc: 0.504
Validation loss decreased (-0.396281 --> -0.503689).  Saving model ...
Epoch: 5 cost time: 1.6239190101623535
Epoch: 5, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.316 Vali Acc: 0.633 Test Loss: 1.316 Test Acc: 0.633
Validation loss decreased (-0.503689 --> -0.633320).  Saving model ...
Epoch: 6 cost time: 1.7424232959747314
Epoch: 6, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.164 Vali Acc: 0.730 Test Loss: 1.164 Test Acc: 0.730
Validation loss decreased (-0.633320 --> -0.729618).  Saving model ...
Epoch: 7 cost time: 1.6875214576721191
Epoch: 7, Steps: 2 | Train Loss: 1.005 Vali Loss: 1.016 Vali Acc: 0.800 Test Loss: 1.016 Test Acc: 0.800
Validation loss decreased (-0.729618 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 1.5706703662872314
Epoch: 8, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.881 Vali Acc: 0.856 Test Loss: 0.881 Test Acc: 0.856
Validation loss decreased (-0.799990 --> -0.855547).  Saving model ...
Epoch: 9 cost time: 1.6410503387451172
Epoch: 9, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.762 Vali Acc: 0.874 Test Loss: 0.762 Test Acc: 0.874
Validation loss decreased (-0.855547 --> -0.874066).  Saving model ...
Epoch: 10 cost time: 1.571150779724121
Epoch: 10, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.656 Vali Acc: 0.893 Test Loss: 0.656 Test Acc: 0.893
Validation loss decreased (-0.874066 --> -0.892586).  Saving model ...
Epoch: 11 cost time: 1.553894281387329
Epoch: 11, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.567 Vali Acc: 0.889 Test Loss: 0.567 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6603126525878906
Epoch: 12, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.491 Vali Acc: 0.893 Test Loss: 0.491 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892588).  Saving model ...
Epoch: 13 cost time: 1.5340948104858398
Epoch: 13, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.428 Vali Acc: 0.904 Test Loss: 0.428 Test Acc: 0.904
Validation loss decreased (-0.892588 --> -0.903699).  Saving model ...
Epoch: 14 cost time: 1.6810956001281738
Epoch: 14, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.378 Vali Acc: 0.907 Test Loss: 0.378 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907404).  Saving model ...
Epoch: 15 cost time: 1.5333945751190186
Epoch: 15, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.338 Vali Acc: 0.911 Test Loss: 0.338 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 1.5114943981170654
Epoch: 16, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.311 Vali Acc: 0.911 Test Loss: 0.311 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 17 cost time: 1.4654786586761475
Epoch: 17, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 18 cost time: 1.5629944801330566
Epoch: 18, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.267 Vali Acc: 0.915 Test Loss: 0.267 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 19 cost time: 1.4979655742645264
Epoch: 19, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.250 Vali Acc: 0.915 Test Loss: 0.250 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 20 cost time: 1.597733974456787
Epoch: 20, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
Validation loss decreased (-0.914812 --> -0.925924).  Saving model ...
Epoch: 21 cost time: 1.3734149932861328
Epoch: 21, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6401023864746094
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5813407897949219
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5547754764556885
Epoch: 24, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5367238521575928
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.514754295349121
Epoch: 26, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 27 cost time: 1.5367803573608398
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4985589981079102
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 1.650773286819458
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 30 cost time: 1.789940357208252
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 11066374
model size : 44.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.378258943557739
Epoch: 1, Steps: 2 | Train Loss: 2.012 Vali Loss: 1.823 Vali Acc: 0.148 Test Loss: 1.823 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 2.543778419494629
Epoch: 2, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.744 Vali Acc: 0.207 Test Loss: 1.744 Test Acc: 0.207
Validation loss decreased (-0.148130 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 2.3313817977905273
Epoch: 3, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.652 Vali Acc: 0.356 Test Loss: 1.652 Test Acc: 0.356
Validation loss decreased (-0.207390 --> -0.355539).  Saving model ...
Epoch: 4 cost time: 2.4330742359161377
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.515 Vali Acc: 0.541 Test Loss: 1.515 Test Acc: 0.541
Validation loss decreased (-0.355539 --> -0.540726).  Saving model ...
Epoch: 5 cost time: 2.073631763458252
Epoch: 5, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.350 Vali Acc: 0.693 Test Loss: 1.350 Test Acc: 0.693
Validation loss decreased (-0.540726 --> -0.692579).  Saving model ...
Epoch: 6 cost time: 2.0880672931671143
Epoch: 6, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.175 Vali Acc: 0.830 Test Loss: 1.175 Test Acc: 0.830
Validation loss decreased (-0.692579 --> -0.829618).  Saving model ...
Epoch: 7 cost time: 2.1261708736419678
Epoch: 7, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.003 Vali Acc: 0.878 Test Loss: 1.003 Test Acc: 0.878
Validation loss decreased (-0.829618 --> -0.877768).  Saving model ...
Epoch: 8 cost time: 2.109616994857788
Epoch: 8, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.848 Vali Acc: 0.893 Test Loss: 0.848 Test Acc: 0.893
Validation loss decreased (-0.877768 --> -0.892584).  Saving model ...
Epoch: 9 cost time: 2.045525550842285
Epoch: 9, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.710 Vali Acc: 0.919 Test Loss: 0.710 Test Acc: 0.919
Validation loss decreased (-0.892584 --> -0.918511).  Saving model ...
Epoch: 10 cost time: 2.077087879180908
Epoch: 10, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.593 Vali Acc: 0.926 Test Loss: 0.593 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925920).  Saving model ...
Epoch: 11 cost time: 2.356865406036377
Epoch: 11, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.496 Vali Acc: 0.933 Test Loss: 0.496 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933328).  Saving model ...
Epoch: 12 cost time: 2.2624242305755615
Epoch: 12, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.420 Vali Acc: 0.937 Test Loss: 0.420 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937033).  Saving model ...
Epoch: 13 cost time: 1.9129106998443604
Epoch: 13, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.358 Vali Acc: 0.941 Test Loss: 0.358 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 14 cost time: 2.1125564575195312
Epoch: 14, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.225916862487793
Epoch: 15, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2719249725341797
Epoch: 16, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.393812656402588
Epoch: 17, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2627546787261963
Epoch: 18, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.324960231781006
Epoch: 19, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.03833270072937
Epoch: 20, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.3929286003112793
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.383183479309082
Epoch: 22, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.919 Test Loss: 0.197 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.345998525619507
Epoch: 23, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.195 Vali Acc: 0.915 Test Loss: 0.195 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 37544966
model size : 145.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.147406816482544
Epoch: 1, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.725 Vali Acc: 0.285 Test Loss: 1.725 Test Acc: 0.285
Validation loss decreased (inf --> -0.285168).  Saving model ...
Epoch: 2 cost time: 1.2452282905578613
Epoch: 2, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.658 Vali Acc: 0.330 Test Loss: 1.658 Test Acc: 0.330
Validation loss decreased (-0.285168 --> -0.329613).  Saving model ...
Epoch: 3 cost time: 1.4322071075439453
Epoch: 3, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.578 Vali Acc: 0.396 Test Loss: 1.578 Test Acc: 0.396
Validation loss decreased (-0.329613 --> -0.396281).  Saving model ...
Epoch: 4 cost time: 1.2801146507263184
Epoch: 4, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.458 Vali Acc: 0.504 Test Loss: 1.458 Test Acc: 0.504
Validation loss decreased (-0.396281 --> -0.503689).  Saving model ...
Epoch: 5 cost time: 1.4559009075164795
Epoch: 5, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.316 Vali Acc: 0.633 Test Loss: 1.316 Test Acc: 0.633
Validation loss decreased (-0.503689 --> -0.633320).  Saving model ...
Epoch: 6 cost time: 1.410322904586792
Epoch: 6, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.164 Vali Acc: 0.730 Test Loss: 1.164 Test Acc: 0.730
Validation loss decreased (-0.633320 --> -0.729618).  Saving model ...
Epoch: 7 cost time: 1.4643568992614746
Epoch: 7, Steps: 2 | Train Loss: 1.005 Vali Loss: 1.016 Vali Acc: 0.800 Test Loss: 1.016 Test Acc: 0.800
Validation loss decreased (-0.729618 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 1.341519832611084
Epoch: 8, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.881 Vali Acc: 0.856 Test Loss: 0.881 Test Acc: 0.856
Validation loss decreased (-0.799990 --> -0.855547).  Saving model ...
Epoch: 9 cost time: 1.3832459449768066
Epoch: 9, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.762 Vali Acc: 0.874 Test Loss: 0.762 Test Acc: 0.874
Validation loss decreased (-0.855547 --> -0.874066).  Saving model ...
Epoch: 10 cost time: 1.1494827270507812
Epoch: 10, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.656 Vali Acc: 0.893 Test Loss: 0.656 Test Acc: 0.893
Validation loss decreased (-0.874066 --> -0.892586).  Saving model ...
Epoch: 11 cost time: 1.2966673374176025
Epoch: 11, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.567 Vali Acc: 0.889 Test Loss: 0.567 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.301826000213623
Epoch: 12, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.491 Vali Acc: 0.893 Test Loss: 0.491 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892588).  Saving model ...
Epoch: 13 cost time: 1.317796230316162
Epoch: 13, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.428 Vali Acc: 0.904 Test Loss: 0.428 Test Acc: 0.904
Validation loss decreased (-0.892588 --> -0.903699).  Saving model ...
Epoch: 14 cost time: 1.494727373123169
Epoch: 14, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.378 Vali Acc: 0.907 Test Loss: 0.378 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907404).  Saving model ...
Epoch: 15 cost time: 1.3386528491973877
Epoch: 15, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.338 Vali Acc: 0.911 Test Loss: 0.338 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 1.4131674766540527
Epoch: 16, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.311 Vali Acc: 0.911 Test Loss: 0.311 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 17 cost time: 1.300666093826294
Epoch: 17, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 18 cost time: 1.4410061836242676
Epoch: 18, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.267 Vali Acc: 0.915 Test Loss: 0.267 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 19 cost time: 1.2758400440216064
Epoch: 19, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.250 Vali Acc: 0.915 Test Loss: 0.250 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 20 cost time: 1.308866262435913
Epoch: 20, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
Validation loss decreased (-0.914812 --> -0.925924).  Saving model ...
Epoch: 21 cost time: 1.2479195594787598
Epoch: 21, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.255554437637329
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2942314147949219
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2098872661590576
Epoch: 24, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3484797477722168
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.318105936050415
Epoch: 26, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 27 cost time: 1.2801094055175781
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2550694942474365
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3322117328643799
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 30 cost time: 1.1786024570465088
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 11066374
model size : 44.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.168919086456299
Epoch: 1, Steps: 2 | Train Loss: 2.014 Vali Loss: 1.823 Vali Acc: 0.148 Test Loss: 1.823 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 1.3191184997558594
Epoch: 2, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.744 Vali Acc: 0.211 Test Loss: 1.744 Test Acc: 0.211
Validation loss decreased (-0.148130 --> -0.211094).  Saving model ...
Epoch: 3 cost time: 1.5253145694732666
Epoch: 3, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.653 Vali Acc: 0.348 Test Loss: 1.653 Test Acc: 0.348
Validation loss decreased (-0.211094 --> -0.348132).  Saving model ...
Epoch: 4 cost time: 1.3127093315124512
Epoch: 4, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.518 Vali Acc: 0.537 Test Loss: 1.518 Test Acc: 0.537
Validation loss decreased (-0.348132 --> -0.537022).  Saving model ...
Epoch: 5 cost time: 1.4651644229888916
Epoch: 5, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.356 Vali Acc: 0.696 Test Loss: 1.356 Test Acc: 0.696
Validation loss decreased (-0.537022 --> -0.696283).  Saving model ...
Epoch: 6 cost time: 1.332491159439087
Epoch: 6, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.183 Vali Acc: 0.826 Test Loss: 1.183 Test Acc: 0.826
Validation loss decreased (-0.696283 --> -0.825914).  Saving model ...
Epoch: 7 cost time: 1.6331253051757812
Epoch: 7, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.012 Vali Acc: 0.885 Test Loss: 1.012 Test Acc: 0.885
Validation loss decreased (-0.825914 --> -0.885175).  Saving model ...
Epoch: 8 cost time: 1.409062385559082
Epoch: 8, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.857 Vali Acc: 0.896 Test Loss: 0.857 Test Acc: 0.896
Validation loss decreased (-0.885175 --> -0.896288).  Saving model ...
Epoch: 9 cost time: 1.3650615215301514
Epoch: 9, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.719 Vali Acc: 0.919 Test Loss: 0.719 Test Acc: 0.919
Validation loss decreased (-0.896288 --> -0.918511).  Saving model ...
Epoch: 10 cost time: 1.552567481994629
Epoch: 10, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.602 Vali Acc: 0.926 Test Loss: 0.602 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925920).  Saving model ...
Epoch: 11 cost time: 1.3518261909484863
Epoch: 11, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.504 Vali Acc: 0.941 Test Loss: 0.504 Test Acc: 0.941
Validation loss decreased (-0.925920 --> -0.940736).  Saving model ...
Epoch: 12 cost time: 1.5311379432678223
Epoch: 12, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.427 Vali Acc: 0.941 Test Loss: 0.427 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 13 cost time: 1.606783151626587
Epoch: 13, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.363 Vali Acc: 0.941 Test Loss: 0.363 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 14 cost time: 1.5081617832183838
Epoch: 14, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.316 Vali Acc: 0.933 Test Loss: 0.316 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5623242855072021
Epoch: 15, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.279 Vali Acc: 0.937 Test Loss: 0.279 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4595308303833008
Epoch: 16, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4667484760284424
Epoch: 17, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4068682193756104
Epoch: 18, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4839749336242676
Epoch: 19, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5768153667449951
Epoch: 20, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4448814392089844
Epoch: 21, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.540839672088623
Epoch: 22, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.926 Test Loss: 0.195 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3304328918457031
Epoch: 23, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.926 Test Loss: 0.193 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 37544966
model size : 145.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4969558715820312
Epoch: 1, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.725 Vali Acc: 0.289 Test Loss: 1.725 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 1.0403094291687012
Epoch: 2, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.657 Vali Acc: 0.330 Test Loss: 1.657 Test Acc: 0.330
Validation loss decreased (-0.288872 --> -0.329613).  Saving model ...
Epoch: 3 cost time: 0.9320554733276367
Epoch: 3, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.579 Vali Acc: 0.396 Test Loss: 1.579 Test Acc: 0.396
Validation loss decreased (-0.329613 --> -0.396281).  Saving model ...
Epoch: 4 cost time: 0.9922444820404053
Epoch: 4, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.460 Vali Acc: 0.500 Test Loss: 1.460 Test Acc: 0.500
Validation loss decreased (-0.396281 --> -0.499985).  Saving model ...
Epoch: 5 cost time: 0.9887347221374512
Epoch: 5, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.320 Vali Acc: 0.626 Test Loss: 1.320 Test Acc: 0.626
Validation loss decreased (-0.499985 --> -0.625913).  Saving model ...
Epoch: 6 cost time: 0.7930591106414795
Epoch: 6, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.169 Vali Acc: 0.722 Test Loss: 1.169 Test Acc: 0.722
Validation loss decreased (-0.625913 --> -0.722211).  Saving model ...
Epoch: 7 cost time: 0.8257229328155518
Epoch: 7, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.021 Vali Acc: 0.793 Test Loss: 1.021 Test Acc: 0.793
Validation loss decreased (-0.722211 --> -0.792582).  Saving model ...
Epoch: 8 cost time: 0.8691384792327881
Epoch: 8, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.886 Vali Acc: 0.856 Test Loss: 0.886 Test Acc: 0.856
Validation loss decreased (-0.792582 --> -0.855547).  Saving model ...
Epoch: 9 cost time: 0.8970463275909424
Epoch: 9, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.767 Vali Acc: 0.878 Test Loss: 0.767 Test Acc: 0.878
Validation loss decreased (-0.855547 --> -0.877770).  Saving model ...
Epoch: 10 cost time: 0.9630353450775146
Epoch: 10, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.660 Vali Acc: 0.889 Test Loss: 0.660 Test Acc: 0.889
Validation loss decreased (-0.877770 --> -0.888882).  Saving model ...
Epoch: 11 cost time: 1.0812644958496094
Epoch: 11, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.570 Vali Acc: 0.896 Test Loss: 0.570 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896291).  Saving model ...
Epoch: 12 cost time: 0.9066183567047119
Epoch: 12, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.493 Vali Acc: 0.896 Test Loss: 0.493 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 13 cost time: 0.9436542987823486
Epoch: 13, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.430 Vali Acc: 0.904 Test Loss: 0.430 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 14 cost time: 0.9223082065582275
Epoch: 14, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.380 Vali Acc: 0.907 Test Loss: 0.380 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907404).  Saving model ...
Epoch: 15 cost time: 0.8477284908294678
Epoch: 15, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.340 Vali Acc: 0.907 Test Loss: 0.340 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 16 cost time: 0.8811092376708984
Epoch: 16, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.312 Vali Acc: 0.907 Test Loss: 0.312 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 17 cost time: 0.873084306716919
Epoch: 17, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.289 Vali Acc: 0.904 Test Loss: 0.289 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9438681602478027
Epoch: 18, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 0.9510583877563477
Epoch: 19, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.251 Vali Acc: 0.915 Test Loss: 0.251 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 20 cost time: 0.8247992992401123
Epoch: 20, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
Validation loss decreased (-0.914812 --> -0.925924).  Saving model ...
Epoch: 21 cost time: 0.8872511386871338
Epoch: 21, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.872309684753418
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.960249662399292
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9531335830688477
Epoch: 24, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.950369119644165
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.140122890472412
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 27 cost time: 1.0634167194366455
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9547812938690186
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.916111946105957
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.919 Test Loss: 0.208 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9946913719177246
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 11066374
model size : 44.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 5.751341342926025
Epoch: 1, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.831 Vali Acc: 0.148 Test Loss: 1.831 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 3.6784520149230957
Epoch: 2, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.776 Vali Acc: 0.170 Test Loss: 1.776 Test Acc: 0.170
Validation loss decreased (-0.148130 --> -0.170353).  Saving model ...
Epoch: 3 cost time: 3.5839169025421143
Epoch: 3, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.716 Vali Acc: 0.211 Test Loss: 1.716 Test Acc: 0.211
Validation loss decreased (-0.170353 --> -0.211094).  Saving model ...
Epoch: 4 cost time: 3.38110613822937
Epoch: 4, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.626 Vali Acc: 0.270 Test Loss: 1.626 Test Acc: 0.270
Validation loss decreased (-0.211094 --> -0.270354).  Saving model ...
Epoch: 5 cost time: 3.80218768119812
Epoch: 5, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.515 Vali Acc: 0.511 Test Loss: 1.515 Test Acc: 0.511
Validation loss decreased (-0.270354 --> -0.511096).  Saving model ...
Epoch: 6 cost time: 3.6783227920532227
Epoch: 6, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.394 Vali Acc: 0.630 Test Loss: 1.394 Test Acc: 0.630
Validation loss decreased (-0.511096 --> -0.629616).  Saving model ...
Epoch: 7 cost time: 3.384995937347412
Epoch: 7, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.268 Vali Acc: 0.693 Test Loss: 1.268 Test Acc: 0.693
Validation loss decreased (-0.629616 --> -0.692580).  Saving model ...
Epoch: 8 cost time: 3.7269020080566406
Epoch: 8, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.149 Vali Acc: 0.733 Test Loss: 1.149 Test Acc: 0.733
Validation loss decreased (-0.692580 --> -0.733322).  Saving model ...
Epoch: 9 cost time: 3.5801405906677246
Epoch: 9, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.035 Vali Acc: 0.763 Test Loss: 1.035 Test Acc: 0.763
Validation loss decreased (-0.733322 --> -0.762953).  Saving model ...
Epoch: 10 cost time: 3.4834156036376953
Epoch: 10, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.932 Vali Acc: 0.789 Test Loss: 0.932 Test Acc: 0.789
Validation loss decreased (-0.762953 --> -0.788880).  Saving model ...
Epoch: 11 cost time: 3.8532912731170654
Epoch: 11, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.840 Vali Acc: 0.800 Test Loss: 0.840 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 3.906022071838379
Epoch: 12, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.757 Vali Acc: 0.848 Test Loss: 0.757 Test Acc: 0.848
Validation loss decreased (-0.799992 --> -0.848141).  Saving model ...
Epoch: 13 cost time: 3.66123104095459
Epoch: 13, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.684 Vali Acc: 0.863 Test Loss: 0.684 Test Acc: 0.863
Validation loss decreased (-0.848141 --> -0.862956).  Saving model ...
Epoch: 14 cost time: 3.5202927589416504
Epoch: 14, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.616 Vali Acc: 0.874 Test Loss: 0.616 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874068).  Saving model ...
Epoch: 15 cost time: 4.031139135360718
Epoch: 15, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.557 Vali Acc: 0.889 Test Loss: 0.557 Test Acc: 0.889
Validation loss decreased (-0.874068 --> -0.888883).  Saving model ...
Epoch: 16 cost time: 3.674452304840088
Epoch: 16, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.505 Vali Acc: 0.889 Test Loss: 0.505 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 17 cost time: 3.7449545860290527
Epoch: 17, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.461 Vali Acc: 0.893 Test Loss: 0.461 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 18 cost time: 3.712172508239746
Epoch: 18, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.421 Vali Acc: 0.896 Test Loss: 0.421 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 19 cost time: 3.8449411392211914
Epoch: 19, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.385 Vali Acc: 0.896 Test Loss: 0.385 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 20 cost time: 3.850874662399292
Epoch: 20, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 3.553481340408325
Epoch: 21, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 3.6513538360595703
Epoch: 22, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 23 cost time: 4.052111387252808
Epoch: 23, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.284 Vali Acc: 0.922 Test Loss: 0.284 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 24 cost time: 3.8876333236694336
Epoch: 24, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.270 Vali Acc: 0.922 Test Loss: 0.270 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 4.081712245941162
Epoch: 25, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 3.731447696685791
Epoch: 26, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 27 cost time: 3.2492144107818604
Epoch: 27, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 28 cost time: 3.2637269496917725
Epoch: 28, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 3.2681121826171875
Epoch: 29, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 30 cost time: 3.4654393196105957
Epoch: 30, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 37520390
model size : 144.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.626443862915039
Epoch: 1, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.781 Vali Acc: 0.215 Test Loss: 1.781 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 1.6173450946807861
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.731 Vali Acc: 0.244 Test Loss: 1.731 Test Acc: 0.244
Validation loss decreased (-0.214797 --> -0.244427).  Saving model ...
Epoch: 3 cost time: 1.56056547164917
Epoch: 3, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.674 Vali Acc: 0.326 Test Loss: 1.674 Test Acc: 0.326
Validation loss decreased (-0.244427 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 1.4981317520141602
Epoch: 4, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.585 Vali Acc: 0.478 Test Loss: 1.585 Test Acc: 0.478
Validation loss decreased (-0.325909 --> -0.477762).  Saving model ...
Epoch: 5 cost time: 1.6012682914733887
Epoch: 5, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.477 Vali Acc: 0.611 Test Loss: 1.477 Test Acc: 0.611
Validation loss decreased (-0.477762 --> -0.611096).  Saving model ...
Epoch: 6 cost time: 1.420853614807129
Epoch: 6, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.357 Vali Acc: 0.704 Test Loss: 1.357 Test Acc: 0.704
Validation loss decreased (-0.611096 --> -0.703690).  Saving model ...
Epoch: 7 cost time: 1.7534246444702148
Epoch: 7, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.235 Vali Acc: 0.770 Test Loss: 1.235 Test Acc: 0.770
Validation loss decreased (-0.703690 --> -0.770358).  Saving model ...
Epoch: 8 cost time: 1.745377540588379
Epoch: 8, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.113 Vali Acc: 0.837 Test Loss: 1.113 Test Acc: 0.837
Validation loss decreased (-0.770358 --> -0.837026).  Saving model ...
Epoch: 9 cost time: 1.746652603149414
Epoch: 9, Steps: 2 | Train Loss: 0.962 Vali Loss: 0.995 Vali Acc: 0.893 Test Loss: 0.995 Test Acc: 0.893
Validation loss decreased (-0.837026 --> -0.892583).  Saving model ...
Epoch: 10 cost time: 1.3337206840515137
Epoch: 10, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.884 Vali Acc: 0.915 Test Loss: 0.884 Test Acc: 0.915
Validation loss decreased (-0.892583 --> -0.914806).  Saving model ...
Epoch: 11 cost time: 1.7113304138183594
Epoch: 11, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.784 Vali Acc: 0.930 Test Loss: 0.784 Test Acc: 0.930
Validation loss decreased (-0.914806 --> -0.929622).  Saving model ...
Epoch: 12 cost time: 1.730393886566162
Epoch: 12, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.697 Vali Acc: 0.926 Test Loss: 0.697 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8390312194824219
Epoch: 13, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.619 Vali Acc: 0.919 Test Loss: 0.619 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6239182949066162
Epoch: 14, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.552 Vali Acc: 0.915 Test Loss: 0.552 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7026522159576416
Epoch: 15, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.496 Vali Acc: 0.907 Test Loss: 0.496 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.788853645324707
Epoch: 16, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.449 Vali Acc: 0.919 Test Loss: 0.449 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6755506992340088
Epoch: 17, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.409 Vali Acc: 0.922 Test Loss: 0.409 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.61086106300354
Epoch: 18, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.377 Vali Acc: 0.922 Test Loss: 0.377 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5487518310546875
Epoch: 19, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.350 Vali Acc: 0.930 Test Loss: 0.350 Test Acc: 0.930
Validation loss decreased (-0.929622 --> -0.929626).  Saving model ...
Epoch: 20 cost time: 1.5389738082885742
Epoch: 20, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.328 Vali Acc: 0.930 Test Loss: 0.328 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 21 cost time: 1.6353812217712402
Epoch: 21, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5730648040771484
Epoch: 22, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.50284743309021
Epoch: 23, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4560716152191162
Epoch: 24, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.429948091506958
Epoch: 25, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.266 Vali Acc: 0.926 Test Loss: 0.266 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5722193717956543
Epoch: 26, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.482088327407837
Epoch: 27, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 28 cost time: 1.646789312362671
Epoch: 28, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 1.591111421585083
Epoch: 29, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 1.5703058242797852
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 11041286
model size : 43.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.8224477767944336
Epoch: 1, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.831 Vali Acc: 0.148 Test Loss: 1.831 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 2.1257293224334717
Epoch: 2, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.776 Vali Acc: 0.170 Test Loss: 1.776 Test Acc: 0.170
Validation loss decreased (-0.148130 --> -0.170353).  Saving model ...
Epoch: 3 cost time: 2.2885234355926514
Epoch: 3, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.716 Vali Acc: 0.211 Test Loss: 1.716 Test Acc: 0.211
Validation loss decreased (-0.170353 --> -0.211094).  Saving model ...
Epoch: 4 cost time: 2.3527262210845947
Epoch: 4, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.626 Vali Acc: 0.270 Test Loss: 1.626 Test Acc: 0.270
Validation loss decreased (-0.211094 --> -0.270354).  Saving model ...
Epoch: 5 cost time: 2.468989372253418
Epoch: 5, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.515 Vali Acc: 0.511 Test Loss: 1.515 Test Acc: 0.511
Validation loss decreased (-0.270354 --> -0.511096).  Saving model ...
Epoch: 6 cost time: 2.5080504417419434
Epoch: 6, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.394 Vali Acc: 0.630 Test Loss: 1.394 Test Acc: 0.630
Validation loss decreased (-0.511096 --> -0.629616).  Saving model ...
Epoch: 7 cost time: 2.5673794746398926
Epoch: 7, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.268 Vali Acc: 0.693 Test Loss: 1.268 Test Acc: 0.693
Validation loss decreased (-0.629616 --> -0.692580).  Saving model ...
Epoch: 8 cost time: 2.462820053100586
Epoch: 8, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.149 Vali Acc: 0.733 Test Loss: 1.149 Test Acc: 0.733
Validation loss decreased (-0.692580 --> -0.733322).  Saving model ...
Epoch: 9 cost time: 2.1427266597747803
Epoch: 9, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.035 Vali Acc: 0.763 Test Loss: 1.035 Test Acc: 0.763
Validation loss decreased (-0.733322 --> -0.762953).  Saving model ...
Epoch: 10 cost time: 2.356882333755493
Epoch: 10, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.932 Vali Acc: 0.789 Test Loss: 0.932 Test Acc: 0.789
Validation loss decreased (-0.762953 --> -0.788880).  Saving model ...
Epoch: 11 cost time: 2.2200019359588623
Epoch: 11, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.840 Vali Acc: 0.800 Test Loss: 0.840 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 2.387779474258423
Epoch: 12, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.757 Vali Acc: 0.848 Test Loss: 0.757 Test Acc: 0.848
Validation loss decreased (-0.799992 --> -0.848141).  Saving model ...
Epoch: 13 cost time: 2.2263596057891846
Epoch: 13, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.684 Vali Acc: 0.863 Test Loss: 0.684 Test Acc: 0.863
Validation loss decreased (-0.848141 --> -0.862956).  Saving model ...
Epoch: 14 cost time: 2.26513934135437
Epoch: 14, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.616 Vali Acc: 0.874 Test Loss: 0.616 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874068).  Saving model ...
Epoch: 15 cost time: 2.415349006652832
Epoch: 15, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.557 Vali Acc: 0.889 Test Loss: 0.557 Test Acc: 0.889
Validation loss decreased (-0.874068 --> -0.888883).  Saving model ...
Epoch: 16 cost time: 2.015641212463379
Epoch: 16, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.505 Vali Acc: 0.889 Test Loss: 0.505 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 17 cost time: 2.1740190982818604
Epoch: 17, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.461 Vali Acc: 0.893 Test Loss: 0.461 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 18 cost time: 2.524836778640747
Epoch: 18, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.421 Vali Acc: 0.896 Test Loss: 0.421 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 19 cost time: 2.282902717590332
Epoch: 19, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.385 Vali Acc: 0.896 Test Loss: 0.385 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 20 cost time: 2.6330406665802
Epoch: 20, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 2.451080322265625
Epoch: 21, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 2.0567033290863037
Epoch: 22, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 23 cost time: 2.145419120788574
Epoch: 23, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.284 Vali Acc: 0.922 Test Loss: 0.284 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 24 cost time: 2.375330686569214
Epoch: 24, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.270 Vali Acc: 0.922 Test Loss: 0.270 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 2.045243740081787
Epoch: 25, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 2.1432130336761475
Epoch: 26, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 27 cost time: 2.329908609390259
Epoch: 27, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 28 cost time: 2.3522584438323975
Epoch: 28, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 2.4165635108947754
Epoch: 29, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 30 cost time: 2.554208278656006
Epoch: 30, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 37520390
model size : 144.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2286930084228516
Epoch: 1, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.781 Vali Acc: 0.215 Test Loss: 1.781 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 1.2832658290863037
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.731 Vali Acc: 0.244 Test Loss: 1.731 Test Acc: 0.244
Validation loss decreased (-0.214797 --> -0.244427).  Saving model ...
Epoch: 3 cost time: 1.1746494770050049
Epoch: 3, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.674 Vali Acc: 0.326 Test Loss: 1.674 Test Acc: 0.326
Validation loss decreased (-0.244427 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 1.2312047481536865
Epoch: 4, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.585 Vali Acc: 0.478 Test Loss: 1.585 Test Acc: 0.478
Validation loss decreased (-0.325909 --> -0.477762).  Saving model ...
Epoch: 5 cost time: 1.2123394012451172
Epoch: 5, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.477 Vali Acc: 0.611 Test Loss: 1.477 Test Acc: 0.611
Validation loss decreased (-0.477762 --> -0.611096).  Saving model ...
Epoch: 6 cost time: 1.4095408916473389
Epoch: 6, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.357 Vali Acc: 0.704 Test Loss: 1.357 Test Acc: 0.704
Validation loss decreased (-0.611096 --> -0.703690).  Saving model ...
Epoch: 7 cost time: 1.2700541019439697
Epoch: 7, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.235 Vali Acc: 0.770 Test Loss: 1.235 Test Acc: 0.770
Validation loss decreased (-0.703690 --> -0.770358).  Saving model ...
Epoch: 8 cost time: 1.3774056434631348
Epoch: 8, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.113 Vali Acc: 0.837 Test Loss: 1.113 Test Acc: 0.837
Validation loss decreased (-0.770358 --> -0.837026).  Saving model ...
Epoch: 9 cost time: 1.1076607704162598
Epoch: 9, Steps: 2 | Train Loss: 0.962 Vali Loss: 0.995 Vali Acc: 0.893 Test Loss: 0.995 Test Acc: 0.893
Validation loss decreased (-0.837026 --> -0.892583).  Saving model ...
Epoch: 10 cost time: 1.2807936668395996
Epoch: 10, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.884 Vali Acc: 0.915 Test Loss: 0.884 Test Acc: 0.915
Validation loss decreased (-0.892583 --> -0.914806).  Saving model ...
Epoch: 11 cost time: 1.2788076400756836
Epoch: 11, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.784 Vali Acc: 0.930 Test Loss: 0.784 Test Acc: 0.930
Validation loss decreased (-0.914806 --> -0.929622).  Saving model ...
Epoch: 12 cost time: 1.2304718494415283
Epoch: 12, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.697 Vali Acc: 0.926 Test Loss: 0.697 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1873302459716797
Epoch: 13, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.619 Vali Acc: 0.919 Test Loss: 0.619 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2968382835388184
Epoch: 14, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.552 Vali Acc: 0.915 Test Loss: 0.552 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2952897548675537
Epoch: 15, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.496 Vali Acc: 0.907 Test Loss: 0.496 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2706713676452637
Epoch: 16, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.449 Vali Acc: 0.919 Test Loss: 0.449 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2376601696014404
Epoch: 17, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.409 Vali Acc: 0.922 Test Loss: 0.409 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1412878036499023
Epoch: 18, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.377 Vali Acc: 0.922 Test Loss: 0.377 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.249140739440918
Epoch: 19, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.350 Vali Acc: 0.930 Test Loss: 0.350 Test Acc: 0.930
Validation loss decreased (-0.929622 --> -0.929626).  Saving model ...
Epoch: 20 cost time: 1.301063060760498
Epoch: 20, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.328 Vali Acc: 0.930 Test Loss: 0.328 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 21 cost time: 1.1384778022766113
Epoch: 21, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.311 Vali Acc: 0.926 Test Loss: 0.311 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3857240676879883
Epoch: 22, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2479689121246338
Epoch: 23, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2092242240905762
Epoch: 24, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.130617380142212
Epoch: 25, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.266 Vali Acc: 0.926 Test Loss: 0.266 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.244149923324585
Epoch: 26, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.249176263809204
Epoch: 27, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 28 cost time: 1.2335102558135986
Epoch: 28, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 1.2932531833648682
Epoch: 29, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 1.216235637664795
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 11041286
model size : 43.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.342625379562378
Epoch: 1, Steps: 2 | Train Loss: 1.957 Vali Loss: 1.831 Vali Acc: 0.148 Test Loss: 1.831 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 1.6769800186157227
Epoch: 2, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.776 Vali Acc: 0.170 Test Loss: 1.776 Test Acc: 0.170
Validation loss decreased (-0.148130 --> -0.170353).  Saving model ...
Epoch: 3 cost time: 1.4352846145629883
Epoch: 3, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.717 Vali Acc: 0.211 Test Loss: 1.717 Test Acc: 0.211
Validation loss decreased (-0.170353 --> -0.211094).  Saving model ...
Epoch: 4 cost time: 1.5461552143096924
Epoch: 4, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.630 Vali Acc: 0.270 Test Loss: 1.630 Test Acc: 0.270
Validation loss decreased (-0.211094 --> -0.270354).  Saving model ...
Epoch: 5 cost time: 1.6910278797149658
Epoch: 5, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.523 Vali Acc: 0.504 Test Loss: 1.523 Test Acc: 0.504
Validation loss decreased (-0.270354 --> -0.503688).  Saving model ...
Epoch: 6 cost time: 1.4268016815185547
Epoch: 6, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.405 Vali Acc: 0.619 Test Loss: 1.405 Test Acc: 0.619
Validation loss decreased (-0.503688 --> -0.618504).  Saving model ...
Epoch: 7 cost time: 1.4100136756896973
Epoch: 7, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.283 Vali Acc: 0.689 Test Loss: 1.283 Test Acc: 0.689
Validation loss decreased (-0.618504 --> -0.688876).  Saving model ...
Epoch: 8 cost time: 1.5872547626495361
Epoch: 8, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.166 Vali Acc: 0.726 Test Loss: 1.166 Test Acc: 0.726
Validation loss decreased (-0.688876 --> -0.725914).  Saving model ...
Epoch: 9 cost time: 1.3776402473449707
Epoch: 9, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.054 Vali Acc: 0.778 Test Loss: 1.054 Test Acc: 0.778
Validation loss decreased (-0.725914 --> -0.777767).  Saving model ...
Epoch: 10 cost time: 1.3600609302520752
Epoch: 10, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.952 Vali Acc: 0.793 Test Loss: 0.952 Test Acc: 0.793
Validation loss decreased (-0.777767 --> -0.792583).  Saving model ...
Epoch: 11 cost time: 1.42586088180542
Epoch: 11, Steps: 2 | Train Loss: 0.791 Vali Loss: 0.860 Vali Acc: 0.811 Test Loss: 0.860 Test Acc: 0.811
Validation loss decreased (-0.792583 --> -0.811103).  Saving model ...
Epoch: 12 cost time: 1.4503650665283203
Epoch: 12, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.775 Vali Acc: 0.859 Test Loss: 0.775 Test Acc: 0.859
Validation loss decreased (-0.811103 --> -0.859252).  Saving model ...
Epoch: 13 cost time: 1.634141445159912
Epoch: 13, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.700 Vali Acc: 0.878 Test Loss: 0.700 Test Acc: 0.878
Validation loss decreased (-0.859252 --> -0.877771).  Saving model ...
Epoch: 14 cost time: 1.5226051807403564
Epoch: 14, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.630 Vali Acc: 0.889 Test Loss: 0.630 Test Acc: 0.889
Validation loss decreased (-0.877771 --> -0.888883).  Saving model ...
Epoch: 15 cost time: 1.699505090713501
Epoch: 15, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.569 Vali Acc: 0.900 Test Loss: 0.569 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 1.5330090522766113
Epoch: 16, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.514 Vali Acc: 0.911 Test Loss: 0.514 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.911106).  Saving model ...
Epoch: 17 cost time: 1.411278247833252
Epoch: 17, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.466 Vali Acc: 0.911 Test Loss: 0.466 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 18 cost time: 1.412618637084961
Epoch: 18, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.424 Vali Acc: 0.919 Test Loss: 0.424 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 19 cost time: 1.2805163860321045
Epoch: 19, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.388 Vali Acc: 0.911 Test Loss: 0.388 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3295364379882812
Epoch: 20, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.357 Vali Acc: 0.907 Test Loss: 0.357 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.156033992767334
Epoch: 21, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.331 Vali Acc: 0.904 Test Loss: 0.331 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3789575099945068
Epoch: 22, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.307 Vali Acc: 0.919 Test Loss: 0.307 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 23 cost time: 1.2086009979248047
Epoch: 23, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.288 Vali Acc: 0.922 Test Loss: 0.288 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 24 cost time: 1.673877239227295
Epoch: 24, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.273 Vali Acc: 0.919 Test Loss: 0.273 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4996254444122314
Epoch: 25, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 1.336961030960083
Epoch: 26, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 1.3093993663787842
Epoch: 27, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 28 cost time: 1.3916914463043213
Epoch: 28, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 1.5558428764343262
Epoch: 29, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 30 cost time: 1.5347018241882324
Epoch: 30, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 37520390
model size : 144.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6655561923980713
Epoch: 1, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.783 Vali Acc: 0.211 Test Loss: 1.783 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.984581708908081
Epoch: 2, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.733 Vali Acc: 0.244 Test Loss: 1.733 Test Acc: 0.244
Validation loss decreased (-0.211093 --> -0.244427).  Saving model ...
Epoch: 3 cost time: 0.8543906211853027
Epoch: 3, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.676 Vali Acc: 0.326 Test Loss: 1.676 Test Acc: 0.326
Validation loss decreased (-0.244427 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 0.9059076309204102
Epoch: 4, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.589 Vali Acc: 0.474 Test Loss: 1.589 Test Acc: 0.474
Validation loss decreased (-0.325909 --> -0.474058).  Saving model ...
Epoch: 5 cost time: 0.9937374591827393
Epoch: 5, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.483 Vali Acc: 0.607 Test Loss: 1.483 Test Acc: 0.607
Validation loss decreased (-0.474058 --> -0.607393).  Saving model ...
Epoch: 6 cost time: 0.9950308799743652
Epoch: 6, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.366 Vali Acc: 0.693 Test Loss: 1.366 Test Acc: 0.693
Validation loss decreased (-0.607393 --> -0.692579).  Saving model ...
Epoch: 7 cost time: 1.0250568389892578
Epoch: 7, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.245 Vali Acc: 0.767 Test Loss: 1.245 Test Acc: 0.767
Validation loss decreased (-0.692579 --> -0.766654).  Saving model ...
Epoch: 8 cost time: 0.9822921752929688
Epoch: 8, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.125 Vali Acc: 0.837 Test Loss: 1.125 Test Acc: 0.837
Validation loss decreased (-0.766654 --> -0.837026).  Saving model ...
Epoch: 9 cost time: 0.8446550369262695
Epoch: 9, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.008 Vali Acc: 0.900 Test Loss: 1.008 Test Acc: 0.900
Validation loss decreased (-0.837026 --> -0.899990).  Saving model ...
Epoch: 10 cost time: 0.8755574226379395
Epoch: 10, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.898 Vali Acc: 0.911 Test Loss: 0.898 Test Acc: 0.911
Validation loss decreased (-0.899990 --> -0.911102).  Saving model ...
Epoch: 11 cost time: 0.8480467796325684
Epoch: 11, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.798 Vali Acc: 0.926 Test Loss: 0.798 Test Acc: 0.926
Validation loss decreased (-0.911102 --> -0.925918).  Saving model ...
Epoch: 12 cost time: 0.8798141479492188
Epoch: 12, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.710 Vali Acc: 0.930 Test Loss: 0.710 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929623).  Saving model ...
Epoch: 13 cost time: 0.8997185230255127
Epoch: 13, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.630 Vali Acc: 0.911 Test Loss: 0.630 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.929725170135498
Epoch: 14, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.562 Vali Acc: 0.926 Test Loss: 0.562 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8445925712585449
Epoch: 15, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.507 Vali Acc: 0.922 Test Loss: 0.507 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9753131866455078
Epoch: 16, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.459 Vali Acc: 0.926 Test Loss: 0.459 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9007554054260254
Epoch: 17, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.418 Vali Acc: 0.926 Test Loss: 0.418 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9790418148040771
Epoch: 18, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.385 Vali Acc: 0.930 Test Loss: 0.385 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929626).  Saving model ...
Epoch: 19 cost time: 0.9435486793518066
Epoch: 19, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.357 Vali Acc: 0.926 Test Loss: 0.357 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0184965133666992
Epoch: 20, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.335 Vali Acc: 0.926 Test Loss: 0.335 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.041724681854248
Epoch: 21, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.316 Vali Acc: 0.926 Test Loss: 0.316 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8487262725830078
Epoch: 22, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.301 Vali Acc: 0.919 Test Loss: 0.301 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.800673246383667
Epoch: 23, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.289 Vali Acc: 0.919 Test Loss: 0.289 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.893761396408081
Epoch: 24, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.278 Vali Acc: 0.919 Test Loss: 0.278 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.941380500793457
Epoch: 25, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.270 Vali Acc: 0.919 Test Loss: 0.270 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8717808723449707
Epoch: 26, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.262 Vali Acc: 0.919 Test Loss: 0.262 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9632668495178223
Epoch: 27, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.256 Vali Acc: 0.919 Test Loss: 0.256 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8680393695831299
Epoch: 28, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 11041286
model size : 43.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.492831230163574
Epoch: 1, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.632 Vali Acc: 0.396 Test Loss: 1.632 Test Acc: 0.396
Validation loss decreased (inf --> -0.396280).  Saving model ...
Epoch: 2 cost time: 2.0923073291778564
Epoch: 2, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.583 Vali Acc: 0.441 Test Loss: 1.583 Test Acc: 0.441
Validation loss decreased (-0.396280 --> -0.440725).  Saving model ...
Epoch: 3 cost time: 2.0255916118621826
Epoch: 3, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.535 Vali Acc: 0.459 Test Loss: 1.535 Test Acc: 0.459
Validation loss decreased (-0.440725 --> -0.459244).  Saving model ...
Epoch: 4 cost time: 2.0271849632263184
Epoch: 4, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.471 Vali Acc: 0.489 Test Loss: 1.471 Test Acc: 0.489
Validation loss decreased (-0.459244 --> -0.488874).  Saving model ...
Epoch: 5 cost time: 2.0554099082946777
Epoch: 5, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.393 Vali Acc: 0.556 Test Loss: 1.393 Test Acc: 0.556
Validation loss decreased (-0.488874 --> -0.555542).  Saving model ...
Epoch: 6 cost time: 2.0226316452026367
Epoch: 6, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.305 Vali Acc: 0.607 Test Loss: 1.305 Test Acc: 0.607
Validation loss decreased (-0.555542 --> -0.607394).  Saving model ...
Epoch: 7 cost time: 2.288485288619995
Epoch: 7, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.212 Vali Acc: 0.652 Test Loss: 1.212 Test Acc: 0.652
Validation loss decreased (-0.607394 --> -0.651840).  Saving model ...
Epoch: 8 cost time: 2.177553653717041
Epoch: 8, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.119 Vali Acc: 0.722 Test Loss: 1.119 Test Acc: 0.722
Validation loss decreased (-0.651840 --> -0.722211).  Saving model ...
Epoch: 9 cost time: 2.01894474029541
Epoch: 9, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.027 Vali Acc: 0.767 Test Loss: 1.027 Test Acc: 0.767
Validation loss decreased (-0.722211 --> -0.766656).  Saving model ...
Epoch: 10 cost time: 2.265199899673462
Epoch: 10, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.938 Vali Acc: 0.815 Test Loss: 0.938 Test Acc: 0.815
Validation loss decreased (-0.766656 --> -0.814805).  Saving model ...
Epoch: 11 cost time: 2.2374207973480225
Epoch: 11, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.853 Vali Acc: 0.852 Test Loss: 0.853 Test Acc: 0.852
Validation loss decreased (-0.814805 --> -0.851843).  Saving model ...
Epoch: 12 cost time: 2.2210700511932373
Epoch: 12, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.774 Vali Acc: 0.856 Test Loss: 0.774 Test Acc: 0.856
Validation loss decreased (-0.851843 --> -0.855548).  Saving model ...
Epoch: 13 cost time: 2.140108585357666
Epoch: 13, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.701 Vali Acc: 0.867 Test Loss: 0.701 Test Acc: 0.867
Validation loss decreased (-0.855548 --> -0.866660).  Saving model ...
Epoch: 14 cost time: 2.2099146842956543
Epoch: 14, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.633 Vali Acc: 0.889 Test Loss: 0.633 Test Acc: 0.889
Validation loss decreased (-0.866660 --> -0.888883).  Saving model ...
Epoch: 15 cost time: 2.3272314071655273
Epoch: 15, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.572 Vali Acc: 0.893 Test Loss: 0.572 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 16 cost time: 2.0711824893951416
Epoch: 16, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 1.884126901626587
Epoch: 17, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.472 Vali Acc: 0.904 Test Loss: 0.472 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 18 cost time: 2.0857977867126465
Epoch: 18, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.432 Vali Acc: 0.907 Test Loss: 0.432 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 19 cost time: 1.9301183223724365
Epoch: 19, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1921956539154053
Epoch: 20, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.373 Vali Acc: 0.896 Test Loss: 0.373 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0461666584014893
Epoch: 21, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.351 Vali Acc: 0.896 Test Loss: 0.351 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9072530269622803
Epoch: 22, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.331 Vali Acc: 0.904 Test Loss: 0.331 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.177122116088867
Epoch: 23, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.313 Vali Acc: 0.907 Test Loss: 0.313 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 24 cost time: 1.9530227184295654
Epoch: 24, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.298 Vali Acc: 0.911 Test Loss: 0.298 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 25 cost time: 1.9036238193511963
Epoch: 25, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.285 Vali Acc: 0.915 Test Loss: 0.285 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 26 cost time: 2.0416204929351807
Epoch: 26, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8608787059783936
Epoch: 27, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9575741291046143
Epoch: 28, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.261 Vali Acc: 0.904 Test Loss: 0.261 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1563117504119873
Epoch: 29, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.257 Vali Acc: 0.904 Test Loss: 0.257 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0116066932678223
Epoch: 30, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.254 Vali Acc: 0.904 Test Loss: 0.254 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 18774022
model size : 72.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2273001670837402
Epoch: 1, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.675 Vali Acc: 0.374 Test Loss: 1.675 Test Acc: 0.374
Validation loss decreased (inf --> -0.374057).  Saving model ...
Epoch: 2 cost time: 1.1188876628875732
Epoch: 2, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.622 Vali Acc: 0.430 Test Loss: 1.622 Test Acc: 0.430
Validation loss decreased (-0.374057 --> -0.429613).  Saving model ...
Epoch: 3 cost time: 1.1466038227081299
Epoch: 3, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.569 Vali Acc: 0.474 Test Loss: 1.569 Test Acc: 0.474
Validation loss decreased (-0.429613 --> -0.474058).  Saving model ...
Epoch: 4 cost time: 1.1385102272033691
Epoch: 4, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.499 Vali Acc: 0.522 Test Loss: 1.499 Test Acc: 0.522
Validation loss decreased (-0.474058 --> -0.522207).  Saving model ...
Epoch: 5 cost time: 1.2240324020385742
Epoch: 5, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.412 Vali Acc: 0.615 Test Loss: 1.412 Test Acc: 0.615
Validation loss decreased (-0.522207 --> -0.614801).  Saving model ...
Epoch: 6 cost time: 1.1898176670074463
Epoch: 6, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.313 Vali Acc: 0.681 Test Loss: 1.313 Test Acc: 0.681
Validation loss decreased (-0.614801 --> -0.681468).  Saving model ...
Epoch: 7 cost time: 1.256241798400879
Epoch: 7, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.209 Vali Acc: 0.733 Test Loss: 1.209 Test Acc: 0.733
Validation loss decreased (-0.681468 --> -0.733321).  Saving model ...
Epoch: 8 cost time: 1.1246328353881836
Epoch: 8, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.103 Vali Acc: 0.796 Test Loss: 1.103 Test Acc: 0.796
Validation loss decreased (-0.733321 --> -0.796285).  Saving model ...
Epoch: 9 cost time: 1.046541690826416
Epoch: 9, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.001 Vali Acc: 0.844 Test Loss: 1.001 Test Acc: 0.844
Validation loss decreased (-0.796285 --> -0.844434).  Saving model ...
Epoch: 10 cost time: 1.0368545055389404
Epoch: 10, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.904 Vali Acc: 0.878 Test Loss: 0.904 Test Acc: 0.878
Validation loss decreased (-0.844434 --> -0.877769).  Saving model ...
Epoch: 11 cost time: 1.0537049770355225
Epoch: 11, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.813 Vali Acc: 0.896 Test Loss: 0.813 Test Acc: 0.896
Validation loss decreased (-0.877769 --> -0.896288).  Saving model ...
Epoch: 12 cost time: 0.9870395660400391
Epoch: 12, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.730 Vali Acc: 0.915 Test Loss: 0.730 Test Acc: 0.915
Validation loss decreased (-0.896288 --> -0.914808).  Saving model ...
Epoch: 13 cost time: 1.078315019607544
Epoch: 13, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.655 Vali Acc: 0.915 Test Loss: 0.655 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 14 cost time: 1.0339889526367188
Epoch: 14, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.587 Vali Acc: 0.926 Test Loss: 0.587 Test Acc: 0.926
Validation loss decreased (-0.914808 --> -0.925920).  Saving model ...
Epoch: 15 cost time: 1.0035896301269531
Epoch: 15, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.526 Vali Acc: 0.922 Test Loss: 0.526 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0256996154785156
Epoch: 16, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.472 Vali Acc: 0.930 Test Loss: 0.472 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929625).  Saving model ...
Epoch: 17 cost time: 1.0611987113952637
Epoch: 17, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.425 Vali Acc: 0.933 Test Loss: 0.425 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 18 cost time: 0.9823508262634277
Epoch: 18, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.385 Vali Acc: 0.937 Test Loss: 0.385 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 19 cost time: 1.1446404457092285
Epoch: 19, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.351 Vali Acc: 0.933 Test Loss: 0.351 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1493184566497803
Epoch: 20, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.322 Vali Acc: 0.937 Test Loss: 0.322 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 21 cost time: 0.9921596050262451
Epoch: 21, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.299 Vali Acc: 0.941 Test Loss: 0.299 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 22 cost time: 1.1760413646697998
Epoch: 22, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.030508279800415
Epoch: 23, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.264 Vali Acc: 0.948 Test Loss: 0.264 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 1.0600457191467285
Epoch: 24, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.250 Vali Acc: 0.952 Test Loss: 0.250 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 25 cost time: 1.1521191596984863
Epoch: 25, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.240 Vali Acc: 0.952 Test Loss: 0.240 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 26 cost time: 1.0425317287445068
Epoch: 26, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.232 Vali Acc: 0.956 Test Loss: 0.232 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 27 cost time: 1.0671286582946777
Epoch: 27, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.225 Vali Acc: 0.956 Test Loss: 0.225 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 1.0776641368865967
Epoch: 28, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 29 cost time: 1.043083906173706
Epoch: 29, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0770506858825684
Epoch: 30, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 5534214
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.385127544403076
Epoch: 1, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.632 Vali Acc: 0.396 Test Loss: 1.632 Test Acc: 0.396
Validation loss decreased (inf --> -0.396280).  Saving model ...
Epoch: 2 cost time: 1.540914535522461
Epoch: 2, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.583 Vali Acc: 0.441 Test Loss: 1.583 Test Acc: 0.441
Validation loss decreased (-0.396280 --> -0.440725).  Saving model ...
Epoch: 3 cost time: 1.4340784549713135
Epoch: 3, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.535 Vali Acc: 0.459 Test Loss: 1.535 Test Acc: 0.459
Validation loss decreased (-0.440725 --> -0.459244).  Saving model ...
Epoch: 4 cost time: 1.455435037612915
Epoch: 4, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.471 Vali Acc: 0.489 Test Loss: 1.471 Test Acc: 0.489
Validation loss decreased (-0.459244 --> -0.488874).  Saving model ...
Epoch: 5 cost time: 1.4396882057189941
Epoch: 5, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.393 Vali Acc: 0.556 Test Loss: 1.393 Test Acc: 0.556
Validation loss decreased (-0.488874 --> -0.555542).  Saving model ...
Epoch: 6 cost time: 1.4790499210357666
Epoch: 6, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.305 Vali Acc: 0.607 Test Loss: 1.305 Test Acc: 0.607
Validation loss decreased (-0.555542 --> -0.607394).  Saving model ...
Epoch: 7 cost time: 1.409440279006958
Epoch: 7, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.212 Vali Acc: 0.652 Test Loss: 1.212 Test Acc: 0.652
Validation loss decreased (-0.607394 --> -0.651840).  Saving model ...
Epoch: 8 cost time: 1.282499074935913
Epoch: 8, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.119 Vali Acc: 0.722 Test Loss: 1.119 Test Acc: 0.722
Validation loss decreased (-0.651840 --> -0.722211).  Saving model ...
Epoch: 9 cost time: 1.300853967666626
Epoch: 9, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.027 Vali Acc: 0.767 Test Loss: 1.027 Test Acc: 0.767
Validation loss decreased (-0.722211 --> -0.766656).  Saving model ...
Epoch: 10 cost time: 1.392005205154419
Epoch: 10, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.938 Vali Acc: 0.815 Test Loss: 0.938 Test Acc: 0.815
Validation loss decreased (-0.766656 --> -0.814805).  Saving model ...
Epoch: 11 cost time: 1.3410954475402832
Epoch: 11, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.853 Vali Acc: 0.852 Test Loss: 0.853 Test Acc: 0.852
Validation loss decreased (-0.814805 --> -0.851843).  Saving model ...
Epoch: 12 cost time: 1.3045852184295654
Epoch: 12, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.774 Vali Acc: 0.856 Test Loss: 0.774 Test Acc: 0.856
Validation loss decreased (-0.851843 --> -0.855548).  Saving model ...
Epoch: 13 cost time: 1.3929576873779297
Epoch: 13, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.701 Vali Acc: 0.867 Test Loss: 0.701 Test Acc: 0.867
Validation loss decreased (-0.855548 --> -0.866660).  Saving model ...
Epoch: 14 cost time: 1.469874382019043
Epoch: 14, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.633 Vali Acc: 0.889 Test Loss: 0.633 Test Acc: 0.889
Validation loss decreased (-0.866660 --> -0.888883).  Saving model ...
Epoch: 15 cost time: 1.2903270721435547
Epoch: 15, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.572 Vali Acc: 0.893 Test Loss: 0.572 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 16 cost time: 1.5367484092712402
Epoch: 16, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 1.380502700805664
Epoch: 17, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.472 Vali Acc: 0.904 Test Loss: 0.472 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 18 cost time: 1.5168025493621826
Epoch: 18, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.432 Vali Acc: 0.907 Test Loss: 0.432 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 19 cost time: 1.4149141311645508
Epoch: 19, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3829443454742432
Epoch: 20, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.373 Vali Acc: 0.896 Test Loss: 0.373 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.494858741760254
Epoch: 21, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.351 Vali Acc: 0.896 Test Loss: 0.351 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3645286560058594
Epoch: 22, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.331 Vali Acc: 0.904 Test Loss: 0.331 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5894711017608643
Epoch: 23, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.313 Vali Acc: 0.907 Test Loss: 0.313 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 24 cost time: 1.600224256515503
Epoch: 24, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.298 Vali Acc: 0.911 Test Loss: 0.298 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 25 cost time: 1.7369446754455566
Epoch: 25, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.285 Vali Acc: 0.915 Test Loss: 0.285 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 26 cost time: 1.6976017951965332
Epoch: 26, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5203258991241455
Epoch: 27, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.47005033493042
Epoch: 28, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.261 Vali Acc: 0.904 Test Loss: 0.261 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4924767017364502
Epoch: 29, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.257 Vali Acc: 0.904 Test Loss: 0.257 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5738413333892822
Epoch: 30, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.254 Vali Acc: 0.904 Test Loss: 0.254 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 18774022
model size : 72.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.763619899749756
Epoch: 1, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.675 Vali Acc: 0.374 Test Loss: 1.675 Test Acc: 0.374
Validation loss decreased (inf --> -0.374057).  Saving model ...
Epoch: 2 cost time: 0.9843075275421143
Epoch: 2, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.622 Vali Acc: 0.430 Test Loss: 1.622 Test Acc: 0.430
Validation loss decreased (-0.374057 --> -0.429613).  Saving model ...
Epoch: 3 cost time: 0.9547195434570312
Epoch: 3, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.569 Vali Acc: 0.474 Test Loss: 1.569 Test Acc: 0.474
Validation loss decreased (-0.429613 --> -0.474058).  Saving model ...
Epoch: 4 cost time: 0.9110162258148193
Epoch: 4, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.499 Vali Acc: 0.522 Test Loss: 1.499 Test Acc: 0.522
Validation loss decreased (-0.474058 --> -0.522207).  Saving model ...
Epoch: 5 cost time: 1.0329697132110596
Epoch: 5, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.412 Vali Acc: 0.615 Test Loss: 1.412 Test Acc: 0.615
Validation loss decreased (-0.522207 --> -0.614801).  Saving model ...
Epoch: 6 cost time: 0.9526233673095703
Epoch: 6, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.313 Vali Acc: 0.681 Test Loss: 1.313 Test Acc: 0.681
Validation loss decreased (-0.614801 --> -0.681468).  Saving model ...
Epoch: 7 cost time: 1.0743520259857178
Epoch: 7, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.209 Vali Acc: 0.733 Test Loss: 1.209 Test Acc: 0.733
Validation loss decreased (-0.681468 --> -0.733321).  Saving model ...
Epoch: 8 cost time: 0.9711403846740723
Epoch: 8, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.103 Vali Acc: 0.796 Test Loss: 1.103 Test Acc: 0.796
Validation loss decreased (-0.733321 --> -0.796285).  Saving model ...
Epoch: 9 cost time: 0.9593017101287842
Epoch: 9, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.001 Vali Acc: 0.844 Test Loss: 1.001 Test Acc: 0.844
Validation loss decreased (-0.796285 --> -0.844434).  Saving model ...
Epoch: 10 cost time: 0.9532091617584229
Epoch: 10, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.904 Vali Acc: 0.878 Test Loss: 0.904 Test Acc: 0.878
Validation loss decreased (-0.844434 --> -0.877769).  Saving model ...
Epoch: 11 cost time: 0.918097972869873
Epoch: 11, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.813 Vali Acc: 0.896 Test Loss: 0.813 Test Acc: 0.896
Validation loss decreased (-0.877769 --> -0.896288).  Saving model ...
Epoch: 12 cost time: 0.9143445491790771
Epoch: 12, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.730 Vali Acc: 0.915 Test Loss: 0.730 Test Acc: 0.915
Validation loss decreased (-0.896288 --> -0.914808).  Saving model ...
Epoch: 13 cost time: 0.9249515533447266
Epoch: 13, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.655 Vali Acc: 0.915 Test Loss: 0.655 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 14 cost time: 0.9198048114776611
Epoch: 14, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.587 Vali Acc: 0.926 Test Loss: 0.587 Test Acc: 0.926
Validation loss decreased (-0.914808 --> -0.925920).  Saving model ...
Epoch: 15 cost time: 0.973311185836792
Epoch: 15, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.526 Vali Acc: 0.922 Test Loss: 0.526 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0173568725585938
Epoch: 16, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.472 Vali Acc: 0.930 Test Loss: 0.472 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929625).  Saving model ...
Epoch: 17 cost time: 0.9705734252929688
Epoch: 17, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.425 Vali Acc: 0.933 Test Loss: 0.425 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 18 cost time: 0.9621844291687012
Epoch: 18, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.385 Vali Acc: 0.937 Test Loss: 0.385 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 19 cost time: 0.9766671657562256
Epoch: 19, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.351 Vali Acc: 0.933 Test Loss: 0.351 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1410107612609863
Epoch: 20, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.322 Vali Acc: 0.937 Test Loss: 0.322 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 21 cost time: 1.0350368022918701
Epoch: 21, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.299 Vali Acc: 0.941 Test Loss: 0.299 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 22 cost time: 1.0183920860290527
Epoch: 22, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.9542438983917236
Epoch: 23, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.264 Vali Acc: 0.948 Test Loss: 0.264 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 1.0495960712432861
Epoch: 24, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.250 Vali Acc: 0.952 Test Loss: 0.250 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 25 cost time: 1.118072271347046
Epoch: 25, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.240 Vali Acc: 0.952 Test Loss: 0.240 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 26 cost time: 1.1949257850646973
Epoch: 26, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.232 Vali Acc: 0.956 Test Loss: 0.232 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 27 cost time: 1.0873701572418213
Epoch: 27, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.225 Vali Acc: 0.956 Test Loss: 0.225 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 1.0447258949279785
Epoch: 28, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 29 cost time: 1.000929355621338
Epoch: 29, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.962315559387207
Epoch: 30, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 5534214
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9667272567749023
Epoch: 1, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.633 Vali Acc: 0.396 Test Loss: 1.633 Test Acc: 0.396
Validation loss decreased (inf --> -0.396280).  Saving model ...
Epoch: 2 cost time: 1.02699613571167
Epoch: 2, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.583 Vali Acc: 0.441 Test Loss: 1.583 Test Acc: 0.441
Validation loss decreased (-0.396280 --> -0.440725).  Saving model ...
Epoch: 3 cost time: 1.0236213207244873
Epoch: 3, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.536 Vali Acc: 0.459 Test Loss: 1.536 Test Acc: 0.459
Validation loss decreased (-0.440725 --> -0.459244).  Saving model ...
Epoch: 4 cost time: 1.047576665878296
Epoch: 4, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.473 Vali Acc: 0.481 Test Loss: 1.473 Test Acc: 0.481
Validation loss decreased (-0.459244 --> -0.481467).  Saving model ...
Epoch: 5 cost time: 1.038773536682129
Epoch: 5, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.397 Vali Acc: 0.556 Test Loss: 1.397 Test Acc: 0.556
Validation loss decreased (-0.481467 --> -0.555542).  Saving model ...
Epoch: 6 cost time: 1.127465009689331
Epoch: 6, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.310 Vali Acc: 0.607 Test Loss: 1.310 Test Acc: 0.607
Validation loss decreased (-0.555542 --> -0.607394).  Saving model ...
Epoch: 7 cost time: 1.0784721374511719
Epoch: 7, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.219 Vali Acc: 0.652 Test Loss: 1.219 Test Acc: 0.652
Validation loss decreased (-0.607394 --> -0.651840).  Saving model ...
Epoch: 8 cost time: 1.0354866981506348
Epoch: 8, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.127 Vali Acc: 0.722 Test Loss: 1.127 Test Acc: 0.722
Validation loss decreased (-0.651840 --> -0.722211).  Saving model ...
Epoch: 9 cost time: 1.0036892890930176
Epoch: 9, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.035 Vali Acc: 0.763 Test Loss: 1.035 Test Acc: 0.763
Validation loss decreased (-0.722211 --> -0.762953).  Saving model ...
Epoch: 10 cost time: 1.0227534770965576
Epoch: 10, Steps: 2 | Train Loss: 0.933 Vali Loss: 0.946 Vali Acc: 0.815 Test Loss: 0.946 Test Acc: 0.815
Validation loss decreased (-0.762953 --> -0.814805).  Saving model ...
Epoch: 11 cost time: 1.150005578994751
Epoch: 11, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.862 Vali Acc: 0.848 Test Loss: 0.862 Test Acc: 0.848
Validation loss decreased (-0.814805 --> -0.848140).  Saving model ...
Epoch: 12 cost time: 1.1400282382965088
Epoch: 12, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.783 Vali Acc: 0.856 Test Loss: 0.783 Test Acc: 0.856
Validation loss decreased (-0.848140 --> -0.855548).  Saving model ...
Epoch: 13 cost time: 1.166341781616211
Epoch: 13, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.708 Vali Acc: 0.863 Test Loss: 0.708 Test Acc: 0.863
Validation loss decreased (-0.855548 --> -0.862956).  Saving model ...
Epoch: 14 cost time: 1.1488735675811768
Epoch: 14, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.640 Vali Acc: 0.885 Test Loss: 0.640 Test Acc: 0.885
Validation loss decreased (-0.862956 --> -0.885179).  Saving model ...
Epoch: 15 cost time: 1.0793273448944092
Epoch: 15, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.577 Vali Acc: 0.885 Test Loss: 0.577 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885179).  Saving model ...
Epoch: 16 cost time: 1.084956169128418
Epoch: 16, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
Validation loss decreased (-0.885179 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 1.1555662155151367
Epoch: 17, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.9932327270507812
Epoch: 18, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 1.067164659500122
Epoch: 19, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.399 Vali Acc: 0.907 Test Loss: 0.399 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907403).  Saving model ...
Epoch: 20 cost time: 1.1235496997833252
Epoch: 20, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.060516119003296
Epoch: 21, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.346 Vali Acc: 0.893 Test Loss: 0.346 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0438544750213623
Epoch: 22, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.325 Vali Acc: 0.896 Test Loss: 0.325 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.996251106262207
Epoch: 23, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.306 Vali Acc: 0.907 Test Loss: 0.306 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 24 cost time: 1.0532019138336182
Epoch: 24, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.290 Vali Acc: 0.907 Test Loss: 0.290 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907405).  Saving model ...
Epoch: 25 cost time: 1.080136775970459
Epoch: 25, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.276 Vali Acc: 0.919 Test Loss: 0.276 Test Acc: 0.919
Validation loss decreased (-0.907405 --> -0.918516).  Saving model ...
Epoch: 26 cost time: 1.085974931716919
Epoch: 26, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 27 cost time: 1.0398614406585693
Epoch: 27, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 28 cost time: 0.9448986053466797
Epoch: 28, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.250 Vali Acc: 0.907 Test Loss: 0.250 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9825727939605713
Epoch: 29, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.245 Vali Acc: 0.907 Test Loss: 0.245 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0662128925323486
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.241 Vali Acc: 0.907 Test Loss: 0.241 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 18774022
model size : 72.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.576169729232788
Epoch: 1, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.675 Vali Acc: 0.374 Test Loss: 1.675 Test Acc: 0.374
Validation loss decreased (inf --> -0.374057).  Saving model ...
Epoch: 2 cost time: 0.8101439476013184
Epoch: 2, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.621 Vali Acc: 0.430 Test Loss: 1.621 Test Acc: 0.430
Validation loss decreased (-0.374057 --> -0.429613).  Saving model ...
Epoch: 3 cost time: 0.6955766677856445
Epoch: 3, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.569 Vali Acc: 0.474 Test Loss: 1.569 Test Acc: 0.474
Validation loss decreased (-0.429613 --> -0.474058).  Saving model ...
Epoch: 4 cost time: 0.7071752548217773
Epoch: 4, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.500 Vali Acc: 0.522 Test Loss: 1.500 Test Acc: 0.522
Validation loss decreased (-0.474058 --> -0.522207).  Saving model ...
Epoch: 5 cost time: 0.7628669738769531
Epoch: 5, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.414 Vali Acc: 0.619 Test Loss: 1.414 Test Acc: 0.619
Validation loss decreased (-0.522207 --> -0.618504).  Saving model ...
Epoch: 6 cost time: 0.7566802501678467
Epoch: 6, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.317 Vali Acc: 0.681 Test Loss: 1.317 Test Acc: 0.681
Validation loss decreased (-0.618504 --> -0.681468).  Saving model ...
Epoch: 7 cost time: 0.7537484169006348
Epoch: 7, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.214 Vali Acc: 0.730 Test Loss: 1.214 Test Acc: 0.730
Validation loss decreased (-0.681468 --> -0.729617).  Saving model ...
Epoch: 8 cost time: 0.8221855163574219
Epoch: 8, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.109 Vali Acc: 0.785 Test Loss: 1.109 Test Acc: 0.785
Validation loss decreased (-0.729617 --> -0.785174).  Saving model ...
Epoch: 9 cost time: 0.8270711898803711
Epoch: 9, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.008 Vali Acc: 0.837 Test Loss: 1.008 Test Acc: 0.837
Validation loss decreased (-0.785174 --> -0.837027).  Saving model ...
Epoch: 10 cost time: 0.8288674354553223
Epoch: 10, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.912 Vali Acc: 0.863 Test Loss: 0.912 Test Acc: 0.863
Validation loss decreased (-0.837027 --> -0.862954).  Saving model ...
Epoch: 11 cost time: 0.8909189701080322
Epoch: 11, Steps: 2 | Train Loss: 0.744 Vali Loss: 0.821 Vali Acc: 0.893 Test Loss: 0.821 Test Acc: 0.893
Validation loss decreased (-0.862954 --> -0.892584).  Saving model ...
Epoch: 12 cost time: 0.8822712898254395
Epoch: 12, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.738 Vali Acc: 0.907 Test Loss: 0.738 Test Acc: 0.907
Validation loss decreased (-0.892584 --> -0.907400).  Saving model ...
Epoch: 13 cost time: 0.8583700656890869
Epoch: 13, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.664 Vali Acc: 0.907 Test Loss: 0.664 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 14 cost time: 0.9261536598205566
Epoch: 14, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.595 Vali Acc: 0.919 Test Loss: 0.595 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 15 cost time: 0.7565066814422607
Epoch: 15, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.533 Vali Acc: 0.919 Test Loss: 0.533 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 16 cost time: 0.7591736316680908
Epoch: 16, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.478 Vali Acc: 0.930 Test Loss: 0.478 Test Acc: 0.930
Validation loss decreased (-0.918513 --> -0.929625).  Saving model ...
Epoch: 17 cost time: 0.83974289894104
Epoch: 17, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.431 Vali Acc: 0.941 Test Loss: 0.431 Test Acc: 0.941
Validation loss decreased (-0.929625 --> -0.940736).  Saving model ...
Epoch: 18 cost time: 0.8166513442993164
Epoch: 18, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.390 Vali Acc: 0.944 Test Loss: 0.390 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.8041481971740723
Epoch: 19, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.355 Vali Acc: 0.933 Test Loss: 0.355 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7846434116363525
Epoch: 20, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.327 Vali Acc: 0.937 Test Loss: 0.327 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7375667095184326
Epoch: 21, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.303 Vali Acc: 0.944 Test Loss: 0.303 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 22 cost time: 0.8100624084472656
Epoch: 22, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.7565915584564209
Epoch: 23, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7690494060516357
Epoch: 24, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.7375133037567139
Epoch: 25, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.738269567489624
Epoch: 26, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.236 Vali Acc: 0.948 Test Loss: 0.236 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.7286689281463623
Epoch: 27, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.7992429733276367
Epoch: 28, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.7538435459136963
Epoch: 29, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7857537269592285
Epoch: 30, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 5534214
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.25673246383667
Epoch: 1, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.736 Vali Acc: 0.200 Test Loss: 1.736 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.3768713474273682
Epoch: 2, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.690 Vali Acc: 0.237 Test Loss: 1.690 Test Acc: 0.237
Validation loss decreased (-0.199983 --> -0.237020).  Saving model ...
Epoch: 3 cost time: 1.460036277770996
Epoch: 3, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.645 Vali Acc: 0.281 Test Loss: 1.645 Test Acc: 0.281
Validation loss decreased (-0.237020 --> -0.281465).  Saving model ...
Epoch: 4 cost time: 1.4852838516235352
Epoch: 4, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.584 Vali Acc: 0.367 Test Loss: 1.584 Test Acc: 0.367
Validation loss decreased (-0.281465 --> -0.366651).  Saving model ...
Epoch: 5 cost time: 1.6348342895507812
Epoch: 5, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.508 Vali Acc: 0.448 Test Loss: 1.508 Test Acc: 0.448
Validation loss decreased (-0.366651 --> -0.448133).  Saving model ...
Epoch: 6 cost time: 1.4321885108947754
Epoch: 6, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.421 Vali Acc: 0.589 Test Loss: 1.421 Test Acc: 0.589
Validation loss decreased (-0.448133 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 1.620445966720581
Epoch: 7, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.325 Vali Acc: 0.670 Test Loss: 1.325 Test Acc: 0.670
Validation loss decreased (-0.588875 --> -0.670357).  Saving model ...
Epoch: 8 cost time: 1.485393762588501
Epoch: 8, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.226 Vali Acc: 0.752 Test Loss: 1.226 Test Acc: 0.752
Validation loss decreased (-0.670357 --> -0.751840).  Saving model ...
Epoch: 9 cost time: 1.2559163570404053
Epoch: 9, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.125 Vali Acc: 0.800 Test Loss: 1.125 Test Acc: 0.800
Validation loss decreased (-0.751840 --> -0.799989).  Saving model ...
Epoch: 10 cost time: 1.3667776584625244
Epoch: 10, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.027 Vali Acc: 0.837 Test Loss: 1.027 Test Acc: 0.837
Validation loss decreased (-0.799989 --> -0.837027).  Saving model ...
Epoch: 11 cost time: 1.350160837173462
Epoch: 11, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.933 Vali Acc: 0.859 Test Loss: 0.933 Test Acc: 0.859
Validation loss decreased (-0.837027 --> -0.859250).  Saving model ...
Epoch: 12 cost time: 1.5676145553588867
Epoch: 12, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.846 Vali Acc: 0.870 Test Loss: 0.846 Test Acc: 0.870
Validation loss decreased (-0.859250 --> -0.870362).  Saving model ...
Epoch: 13 cost time: 1.5253016948699951
Epoch: 13, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.764 Vali Acc: 0.889 Test Loss: 0.764 Test Acc: 0.889
Validation loss decreased (-0.870362 --> -0.888881).  Saving model ...
Epoch: 14 cost time: 1.487537145614624
Epoch: 14, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.689 Vali Acc: 0.889 Test Loss: 0.689 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888882).  Saving model ...
Epoch: 15 cost time: 1.4989666938781738
Epoch: 15, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.619 Vali Acc: 0.896 Test Loss: 0.619 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 16 cost time: 1.523867130279541
Epoch: 16, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.557 Vali Acc: 0.907 Test Loss: 0.557 Test Acc: 0.907
Validation loss decreased (-0.896290 --> -0.907402).  Saving model ...
Epoch: 17 cost time: 1.44716215133667
Epoch: 17, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.502 Vali Acc: 0.911 Test Loss: 0.502 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 18 cost time: 1.4497873783111572
Epoch: 18, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.453 Vali Acc: 0.911 Test Loss: 0.453 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 19 cost time: 1.5773093700408936
Epoch: 19, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.412 Vali Acc: 0.911 Test Loss: 0.412 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 20 cost time: 1.6057653427124023
Epoch: 20, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.379 Vali Acc: 0.926 Test Loss: 0.379 Test Acc: 0.926
Validation loss decreased (-0.911107 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 1.5155951976776123
Epoch: 21, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.352 Vali Acc: 0.922 Test Loss: 0.352 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4503991603851318
Epoch: 22, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.329 Vali Acc: 0.919 Test Loss: 0.329 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4601130485534668
Epoch: 23, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.310 Vali Acc: 0.919 Test Loss: 0.310 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5240912437438965
Epoch: 24, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 25 cost time: 1.379492998123169
Epoch: 25, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.280 Vali Acc: 0.919 Test Loss: 0.280 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4528956413269043
Epoch: 26, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.269 Vali Acc: 0.915 Test Loss: 0.269 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.573124885559082
Epoch: 27, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.261 Vali Acc: 0.919 Test Loss: 0.261 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5079455375671387
Epoch: 28, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.254 Vali Acc: 0.915 Test Loss: 0.254 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4786357879638672
Epoch: 29, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4890851974487305
Epoch: 30, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 9400838
model size : 37.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.71016263961792
Epoch: 1, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.773 Vali Acc: 0.304 Test Loss: 1.773 Test Acc: 0.304
Validation loss decreased (inf --> -0.303686).  Saving model ...
Epoch: 2 cost time: 0.9800362586975098
Epoch: 2, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.721 Vali Acc: 0.367 Test Loss: 1.721 Test Acc: 0.367
Validation loss decreased (-0.303686 --> -0.366649).  Saving model ...
Epoch: 3 cost time: 0.9517109394073486
Epoch: 3, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.671 Vali Acc: 0.404 Test Loss: 1.671 Test Acc: 0.404
Validation loss decreased (-0.366649 --> -0.403687).  Saving model ...
Epoch: 4 cost time: 0.9870204925537109
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.606 Vali Acc: 0.437 Test Loss: 1.606 Test Acc: 0.437
Validation loss decreased (-0.403687 --> -0.437021).  Saving model ...
Epoch: 5 cost time: 0.9133298397064209
Epoch: 5, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.526 Vali Acc: 0.485 Test Loss: 1.526 Test Acc: 0.485
Validation loss decreased (-0.437021 --> -0.485170).  Saving model ...
Epoch: 6 cost time: 0.9726264476776123
Epoch: 6, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.436 Vali Acc: 0.548 Test Loss: 1.436 Test Acc: 0.548
Validation loss decreased (-0.485170 --> -0.548134).  Saving model ...
Epoch: 7 cost time: 0.871098518371582
Epoch: 7, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.338 Vali Acc: 0.633 Test Loss: 1.338 Test Acc: 0.633
Validation loss decreased (-0.548134 --> -0.633320).  Saving model ...
Epoch: 8 cost time: 0.9416759014129639
Epoch: 8, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.238 Vali Acc: 0.730 Test Loss: 1.238 Test Acc: 0.730
Validation loss decreased (-0.633320 --> -0.729617).  Saving model ...
Epoch: 9 cost time: 0.9690937995910645
Epoch: 9, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.140 Vali Acc: 0.807 Test Loss: 1.140 Test Acc: 0.807
Validation loss decreased (-0.729617 --> -0.807396).  Saving model ...
Epoch: 10 cost time: 0.9801561832427979
Epoch: 10, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.044 Vali Acc: 0.826 Test Loss: 1.044 Test Acc: 0.826
Validation loss decreased (-0.807396 --> -0.825915).  Saving model ...
Epoch: 11 cost time: 0.9461033344268799
Epoch: 11, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.952 Vali Acc: 0.856 Test Loss: 0.952 Test Acc: 0.856
Validation loss decreased (-0.825915 --> -0.855546).  Saving model ...
Epoch: 12 cost time: 1.000135898590088
Epoch: 12, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.864 Vali Acc: 0.870 Test Loss: 0.864 Test Acc: 0.870
Validation loss decreased (-0.855546 --> -0.870362).  Saving model ...
Epoch: 13 cost time: 0.9966344833374023
Epoch: 13, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.782 Vali Acc: 0.893 Test Loss: 0.782 Test Acc: 0.893
Validation loss decreased (-0.870362 --> -0.892585).  Saving model ...
Epoch: 14 cost time: 0.9141647815704346
Epoch: 14, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.708 Vali Acc: 0.904 Test Loss: 0.708 Test Acc: 0.904
Validation loss decreased (-0.892585 --> -0.903697).  Saving model ...
Epoch: 15 cost time: 1.0621397495269775
Epoch: 15, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.642 Vali Acc: 0.907 Test Loss: 0.642 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 16 cost time: 0.9657912254333496
Epoch: 16, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.584 Vali Acc: 0.915 Test Loss: 0.584 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 17 cost time: 0.9672062397003174
Epoch: 17, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.532 Vali Acc: 0.919 Test Loss: 0.532 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 18 cost time: 0.9515988826751709
Epoch: 18, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.487 Vali Acc: 0.915 Test Loss: 0.487 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9268555641174316
Epoch: 19, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.448 Vali Acc: 0.915 Test Loss: 0.448 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8905704021453857
Epoch: 20, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.415 Vali Acc: 0.907 Test Loss: 0.415 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9185137748718262
Epoch: 21, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.387 Vali Acc: 0.904 Test Loss: 0.387 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9350650310516357
Epoch: 22, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.363 Vali Acc: 0.907 Test Loss: 0.363 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9568789005279541
Epoch: 23, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.341 Vali Acc: 0.907 Test Loss: 0.341 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9696979522705078
Epoch: 24, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.322 Vali Acc: 0.907 Test Loss: 0.322 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.946054220199585
Epoch: 25, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.304 Vali Acc: 0.907 Test Loss: 0.304 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1127612590789795
Epoch: 26, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0415091514587402
Epoch: 27, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 2780678
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.722308874130249
Epoch: 1, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.736 Vali Acc: 0.200 Test Loss: 1.736 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.053959846496582
Epoch: 2, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.690 Vali Acc: 0.237 Test Loss: 1.690 Test Acc: 0.237
Validation loss decreased (-0.199983 --> -0.237020).  Saving model ...
Epoch: 3 cost time: 1.0525999069213867
Epoch: 3, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.645 Vali Acc: 0.281 Test Loss: 1.645 Test Acc: 0.281
Validation loss decreased (-0.237020 --> -0.281465).  Saving model ...
Epoch: 4 cost time: 1.1081318855285645
Epoch: 4, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.584 Vali Acc: 0.367 Test Loss: 1.584 Test Acc: 0.367
Validation loss decreased (-0.281465 --> -0.366651).  Saving model ...
Epoch: 5 cost time: 0.98417067527771
Epoch: 5, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.508 Vali Acc: 0.448 Test Loss: 1.508 Test Acc: 0.448
Validation loss decreased (-0.366651 --> -0.448133).  Saving model ...
Epoch: 6 cost time: 1.1759252548217773
Epoch: 6, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.421 Vali Acc: 0.589 Test Loss: 1.421 Test Acc: 0.589
Validation loss decreased (-0.448133 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 1.2146477699279785
Epoch: 7, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.325 Vali Acc: 0.670 Test Loss: 1.325 Test Acc: 0.670
Validation loss decreased (-0.588875 --> -0.670357).  Saving model ...
Epoch: 8 cost time: 1.1951427459716797
Epoch: 8, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.226 Vali Acc: 0.752 Test Loss: 1.226 Test Acc: 0.752
Validation loss decreased (-0.670357 --> -0.751840).  Saving model ...
Epoch: 9 cost time: 1.0070700645446777
Epoch: 9, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.125 Vali Acc: 0.800 Test Loss: 1.125 Test Acc: 0.800
Validation loss decreased (-0.751840 --> -0.799989).  Saving model ...
Epoch: 10 cost time: 1.0437171459197998
Epoch: 10, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.027 Vali Acc: 0.837 Test Loss: 1.027 Test Acc: 0.837
Validation loss decreased (-0.799989 --> -0.837027).  Saving model ...
Epoch: 11 cost time: 1.0115182399749756
Epoch: 11, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.933 Vali Acc: 0.859 Test Loss: 0.933 Test Acc: 0.859
Validation loss decreased (-0.837027 --> -0.859250).  Saving model ...
Epoch: 12 cost time: 1.1104111671447754
Epoch: 12, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.846 Vali Acc: 0.870 Test Loss: 0.846 Test Acc: 0.870
Validation loss decreased (-0.859250 --> -0.870362).  Saving model ...
Epoch: 13 cost time: 1.1284270286560059
Epoch: 13, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.764 Vali Acc: 0.889 Test Loss: 0.764 Test Acc: 0.889
Validation loss decreased (-0.870362 --> -0.888881).  Saving model ...
Epoch: 14 cost time: 1.0930211544036865
Epoch: 14, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.689 Vali Acc: 0.889 Test Loss: 0.689 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888882).  Saving model ...
Epoch: 15 cost time: 1.0084657669067383
Epoch: 15, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.619 Vali Acc: 0.896 Test Loss: 0.619 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 16 cost time: 1.0600683689117432
Epoch: 16, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.557 Vali Acc: 0.907 Test Loss: 0.557 Test Acc: 0.907
Validation loss decreased (-0.896290 --> -0.907402).  Saving model ...
Epoch: 17 cost time: 1.2124505043029785
Epoch: 17, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.502 Vali Acc: 0.911 Test Loss: 0.502 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 18 cost time: 1.0302956104278564
Epoch: 18, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.453 Vali Acc: 0.911 Test Loss: 0.453 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 19 cost time: 1.1097006797790527
Epoch: 19, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.412 Vali Acc: 0.911 Test Loss: 0.412 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 20 cost time: 1.0919947624206543
Epoch: 20, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.379 Vali Acc: 0.926 Test Loss: 0.379 Test Acc: 0.926
Validation loss decreased (-0.911107 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 1.1124753952026367
Epoch: 21, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.352 Vali Acc: 0.922 Test Loss: 0.352 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3072140216827393
Epoch: 22, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.329 Vali Acc: 0.919 Test Loss: 0.329 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0466654300689697
Epoch: 23, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.310 Vali Acc: 0.919 Test Loss: 0.310 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.247532606124878
Epoch: 24, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 25 cost time: 1.1213314533233643
Epoch: 25, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.280 Vali Acc: 0.919 Test Loss: 0.280 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1886720657348633
Epoch: 26, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.269 Vali Acc: 0.915 Test Loss: 0.269 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1535780429840088
Epoch: 27, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.261 Vali Acc: 0.919 Test Loss: 0.261 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2158596515655518
Epoch: 28, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.254 Vali Acc: 0.915 Test Loss: 0.254 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0776994228363037
Epoch: 29, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3478846549987793
Epoch: 30, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 9400838
model size : 37.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4405438899993896
Epoch: 1, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.773 Vali Acc: 0.304 Test Loss: 1.773 Test Acc: 0.304
Validation loss decreased (inf --> -0.303686).  Saving model ...
Epoch: 2 cost time: 0.7783043384552002
Epoch: 2, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.721 Vali Acc: 0.367 Test Loss: 1.721 Test Acc: 0.367
Validation loss decreased (-0.303686 --> -0.366649).  Saving model ...
Epoch: 3 cost time: 0.8449921607971191
Epoch: 3, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.671 Vali Acc: 0.404 Test Loss: 1.671 Test Acc: 0.404
Validation loss decreased (-0.366649 --> -0.403687).  Saving model ...
Epoch: 4 cost time: 0.8022036552429199
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.606 Vali Acc: 0.437 Test Loss: 1.606 Test Acc: 0.437
Validation loss decreased (-0.403687 --> -0.437021).  Saving model ...
Epoch: 5 cost time: 0.8236112594604492
Epoch: 5, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.526 Vali Acc: 0.485 Test Loss: 1.526 Test Acc: 0.485
Validation loss decreased (-0.437021 --> -0.485170).  Saving model ...
Epoch: 6 cost time: 0.8677120208740234
Epoch: 6, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.436 Vali Acc: 0.548 Test Loss: 1.436 Test Acc: 0.548
Validation loss decreased (-0.485170 --> -0.548134).  Saving model ...
Epoch: 7 cost time: 0.9496874809265137
Epoch: 7, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.338 Vali Acc: 0.633 Test Loss: 1.338 Test Acc: 0.633
Validation loss decreased (-0.548134 --> -0.633320).  Saving model ...
Epoch: 8 cost time: 0.9067575931549072
Epoch: 8, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.238 Vali Acc: 0.730 Test Loss: 1.238 Test Acc: 0.730
Validation loss decreased (-0.633320 --> -0.729617).  Saving model ...
Epoch: 9 cost time: 0.9822449684143066
Epoch: 9, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.140 Vali Acc: 0.807 Test Loss: 1.140 Test Acc: 0.807
Validation loss decreased (-0.729617 --> -0.807396).  Saving model ...
Epoch: 10 cost time: 0.902695894241333
Epoch: 10, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.044 Vali Acc: 0.826 Test Loss: 1.044 Test Acc: 0.826
Validation loss decreased (-0.807396 --> -0.825915).  Saving model ...
Epoch: 11 cost time: 0.8876175880432129
Epoch: 11, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.952 Vali Acc: 0.856 Test Loss: 0.952 Test Acc: 0.856
Validation loss decreased (-0.825915 --> -0.855546).  Saving model ...
Epoch: 12 cost time: 0.8114819526672363
Epoch: 12, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.864 Vali Acc: 0.870 Test Loss: 0.864 Test Acc: 0.870
Validation loss decreased (-0.855546 --> -0.870362).  Saving model ...
Epoch: 13 cost time: 0.7942395210266113
Epoch: 13, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.782 Vali Acc: 0.893 Test Loss: 0.782 Test Acc: 0.893
Validation loss decreased (-0.870362 --> -0.892585).  Saving model ...
Epoch: 14 cost time: 0.8314449787139893
Epoch: 14, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.708 Vali Acc: 0.904 Test Loss: 0.708 Test Acc: 0.904
Validation loss decreased (-0.892585 --> -0.903697).  Saving model ...
Epoch: 15 cost time: 0.8008913993835449
Epoch: 15, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.642 Vali Acc: 0.907 Test Loss: 0.642 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 16 cost time: 0.9377353191375732
Epoch: 16, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.584 Vali Acc: 0.915 Test Loss: 0.584 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 17 cost time: 0.9035015106201172
Epoch: 17, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.532 Vali Acc: 0.919 Test Loss: 0.532 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 18 cost time: 0.8891279697418213
Epoch: 18, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.487 Vali Acc: 0.915 Test Loss: 0.487 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7462329864501953
Epoch: 19, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.448 Vali Acc: 0.915 Test Loss: 0.448 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9562385082244873
Epoch: 20, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.415 Vali Acc: 0.907 Test Loss: 0.415 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8154935836791992
Epoch: 21, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.387 Vali Acc: 0.904 Test Loss: 0.387 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8933959007263184
Epoch: 22, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.364 Vali Acc: 0.907 Test Loss: 0.364 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7538971900939941
Epoch: 23, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.341 Vali Acc: 0.907 Test Loss: 0.341 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9324123859405518
Epoch: 24, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.322 Vali Acc: 0.907 Test Loss: 0.322 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9963710308074951
Epoch: 25, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.304 Vali Acc: 0.907 Test Loss: 0.304 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.879927396774292
Epoch: 26, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9420487880706787
Epoch: 27, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 2780678
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.620011568069458
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.735 Vali Acc: 0.200 Test Loss: 1.735 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 0.8419950008392334
Epoch: 2, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.689 Vali Acc: 0.237 Test Loss: 1.689 Test Acc: 0.237
Validation loss decreased (-0.199983 --> -0.237020).  Saving model ...
Epoch: 3 cost time: 0.8662002086639404
Epoch: 3, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.645 Vali Acc: 0.281 Test Loss: 1.645 Test Acc: 0.281
Validation loss decreased (-0.237020 --> -0.281465).  Saving model ...
Epoch: 4 cost time: 0.8482546806335449
Epoch: 4, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.586 Vali Acc: 0.367 Test Loss: 1.586 Test Acc: 0.367
Validation loss decreased (-0.281465 --> -0.366651).  Saving model ...
Epoch: 5 cost time: 0.8287820816040039
Epoch: 5, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.512 Vali Acc: 0.441 Test Loss: 1.512 Test Acc: 0.441
Validation loss decreased (-0.366651 --> -0.440726).  Saving model ...
Epoch: 6 cost time: 0.8522629737854004
Epoch: 6, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.427 Vali Acc: 0.570 Test Loss: 1.427 Test Acc: 0.570
Validation loss decreased (-0.440726 --> -0.570356).  Saving model ...
Epoch: 7 cost time: 0.8923842906951904
Epoch: 7, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.334 Vali Acc: 0.659 Test Loss: 1.334 Test Acc: 0.659
Validation loss decreased (-0.570356 --> -0.659246).  Saving model ...
Epoch: 8 cost time: 0.7212035655975342
Epoch: 8, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.238 Vali Acc: 0.756 Test Loss: 1.238 Test Acc: 0.756
Validation loss decreased (-0.659246 --> -0.755543).  Saving model ...
Epoch: 9 cost time: 0.912672758102417
Epoch: 9, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.140 Vali Acc: 0.785 Test Loss: 1.140 Test Acc: 0.785
Validation loss decreased (-0.755543 --> -0.785174).  Saving model ...
Epoch: 10 cost time: 0.9138257503509521
Epoch: 10, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.044 Vali Acc: 0.833 Test Loss: 1.044 Test Acc: 0.833
Validation loss decreased (-0.785174 --> -0.833323).  Saving model ...
Epoch: 11 cost time: 0.8073110580444336
Epoch: 11, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.952 Vali Acc: 0.856 Test Loss: 0.952 Test Acc: 0.856
Validation loss decreased (-0.833323 --> -0.855546).  Saving model ...
Epoch: 12 cost time: 0.8782966136932373
Epoch: 12, Steps: 2 | Train Loss: 0.807 Vali Loss: 0.866 Vali Acc: 0.867 Test Loss: 0.866 Test Acc: 0.867
Validation loss decreased (-0.855546 --> -0.866658).  Saving model ...
Epoch: 13 cost time: 0.828404426574707
Epoch: 13, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.785 Vali Acc: 0.881 Test Loss: 0.785 Test Acc: 0.881
Validation loss decreased (-0.866658 --> -0.881474).  Saving model ...
Epoch: 14 cost time: 0.8791539669036865
Epoch: 14, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.709 Vali Acc: 0.885 Test Loss: 0.709 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885178).  Saving model ...
Epoch: 15 cost time: 0.90000319480896
Epoch: 15, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.639 Vali Acc: 0.889 Test Loss: 0.639 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888882).  Saving model ...
Epoch: 16 cost time: 0.7933351993560791
Epoch: 16, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
Validation loss decreased (-0.888882 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 0.8975467681884766
Epoch: 17, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.519 Vali Acc: 0.904 Test Loss: 0.519 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903699).  Saving model ...
Epoch: 18 cost time: 0.8859293460845947
Epoch: 18, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.468 Vali Acc: 0.907 Test Loss: 0.468 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 19 cost time: 0.8449623584747314
Epoch: 19, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.425 Vali Acc: 0.907 Test Loss: 0.425 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 20 cost time: 0.8627457618713379
Epoch: 20, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.388 Vali Acc: 0.926 Test Loss: 0.388 Test Acc: 0.926
Validation loss decreased (-0.907403 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 0.7946591377258301
Epoch: 21, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.358 Vali Acc: 0.926 Test Loss: 0.358 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 22 cost time: 0.8349711894989014
Epoch: 22, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.332 Vali Acc: 0.930 Test Loss: 0.332 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 23 cost time: 0.7811141014099121
Epoch: 23, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 24 cost time: 0.8402774333953857
Epoch: 24, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.292 Vali Acc: 0.933 Test Loss: 0.292 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933330).  Saving model ...
Epoch: 25 cost time: 0.9554297924041748
Epoch: 25, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8391737937927246
Epoch: 26, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.264 Vali Acc: 0.926 Test Loss: 0.264 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8377366065979004
Epoch: 27, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.254 Vali Acc: 0.926 Test Loss: 0.254 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8424396514892578
Epoch: 28, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8324897289276123
Epoch: 29, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8982071876525879
Epoch: 30, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 9400838
model size : 37.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4482216835021973
Epoch: 1, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.775 Vali Acc: 0.296 Test Loss: 1.775 Test Acc: 0.296
Validation loss decreased (inf --> -0.296279).  Saving model ...
Epoch: 2 cost time: 0.6907618045806885
Epoch: 2, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.722 Vali Acc: 0.356 Test Loss: 1.722 Test Acc: 0.356
Validation loss decreased (-0.296279 --> -0.355538).  Saving model ...
Epoch: 3 cost time: 0.7265725135803223
Epoch: 3, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.673 Vali Acc: 0.389 Test Loss: 1.673 Test Acc: 0.389
Validation loss decreased (-0.355538 --> -0.388872).  Saving model ...
Epoch: 4 cost time: 0.8284101486206055
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.609 Vali Acc: 0.430 Test Loss: 1.609 Test Acc: 0.430
Validation loss decreased (-0.388872 --> -0.429614).  Saving model ...
Epoch: 5 cost time: 0.7079370021820068
Epoch: 5, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.530 Vali Acc: 0.478 Test Loss: 1.530 Test Acc: 0.478
Validation loss decreased (-0.429614 --> -0.477762).  Saving model ...
Epoch: 6 cost time: 0.7829627990722656
Epoch: 6, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.441 Vali Acc: 0.544 Test Loss: 1.441 Test Acc: 0.544
Validation loss decreased (-0.477762 --> -0.544430).  Saving model ...
Epoch: 7 cost time: 0.8555765151977539
Epoch: 7, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.344 Vali Acc: 0.630 Test Loss: 1.344 Test Acc: 0.630
Validation loss decreased (-0.544430 --> -0.629616).  Saving model ...
Epoch: 8 cost time: 0.7720327377319336
Epoch: 8, Steps: 2 | Train Loss: 1.264 Vali Loss: 1.245 Vali Acc: 0.730 Test Loss: 1.245 Test Acc: 0.730
Validation loss decreased (-0.629616 --> -0.729617).  Saving model ...
Epoch: 9 cost time: 0.8327836990356445
Epoch: 9, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.147 Vali Acc: 0.807 Test Loss: 1.147 Test Acc: 0.807
Validation loss decreased (-0.729617 --> -0.807396).  Saving model ...
Epoch: 10 cost time: 0.751981258392334
Epoch: 10, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.051 Vali Acc: 0.826 Test Loss: 1.051 Test Acc: 0.826
Validation loss decreased (-0.807396 --> -0.825915).  Saving model ...
Epoch: 11 cost time: 0.7457325458526611
Epoch: 11, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.959 Vali Acc: 0.856 Test Loss: 0.959 Test Acc: 0.856
Validation loss decreased (-0.825915 --> -0.855546).  Saving model ...
Epoch: 12 cost time: 0.7989249229431152
Epoch: 12, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.871 Vali Acc: 0.867 Test Loss: 0.871 Test Acc: 0.867
Validation loss decreased (-0.855546 --> -0.866658).  Saving model ...
Epoch: 13 cost time: 0.7735788822174072
Epoch: 13, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.789 Vali Acc: 0.885 Test Loss: 0.789 Test Acc: 0.885
Validation loss decreased (-0.866658 --> -0.885177).  Saving model ...
Epoch: 14 cost time: 0.6694900989532471
Epoch: 14, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.714 Vali Acc: 0.900 Test Loss: 0.714 Test Acc: 0.900
Validation loss decreased (-0.885177 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 0.6769227981567383
Epoch: 15, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.648 Vali Acc: 0.900 Test Loss: 0.648 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.7675042152404785
Epoch: 16, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.589 Vali Acc: 0.911 Test Loss: 0.589 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.911105).  Saving model ...
Epoch: 17 cost time: 0.7076625823974609
Epoch: 17, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.537 Vali Acc: 0.915 Test Loss: 0.537 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 18 cost time: 0.7645783424377441
Epoch: 18, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.491 Vali Acc: 0.911 Test Loss: 0.491 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7614905834197998
Epoch: 19, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.451 Vali Acc: 0.915 Test Loss: 0.451 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 20 cost time: 0.7744591236114502
Epoch: 20, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.418 Vali Acc: 0.907 Test Loss: 0.418 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7487874031066895
Epoch: 21, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.390 Vali Acc: 0.904 Test Loss: 0.390 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7319767475128174
Epoch: 22, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.366 Vali Acc: 0.907 Test Loss: 0.366 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.760026216506958
Epoch: 23, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.344 Vali Acc: 0.907 Test Loss: 0.344 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7856669425964355
Epoch: 24, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.325 Vali Acc: 0.907 Test Loss: 0.325 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.665881872177124
Epoch: 25, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.307 Vali Acc: 0.907 Test Loss: 0.307 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7292881011962891
Epoch: 26, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7678086757659912
Epoch: 27, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.283 Vali Acc: 0.911 Test Loss: 0.283 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6642472743988037
Epoch: 28, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7236795425415039
Epoch: 29, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.266 Vali Acc: 0.911 Test Loss: 0.266 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 2780678
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2636666297912598
Epoch: 1, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.841 Vali Acc: 0.170 Test Loss: 1.841 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 1.5410380363464355
Epoch: 2, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.804 Vali Acc: 0.185 Test Loss: 1.804 Test Acc: 0.185
Validation loss decreased (-0.170352 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 1.5188508033752441
Epoch: 3, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.771 Vali Acc: 0.207 Test Loss: 1.771 Test Acc: 0.207
Validation loss decreased (-0.185167 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 1.5134756565093994
Epoch: 4, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.732 Vali Acc: 0.241 Test Loss: 1.732 Test Acc: 0.241
Validation loss decreased (-0.207390 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 1.4488921165466309
Epoch: 5, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.683 Vali Acc: 0.285 Test Loss: 1.683 Test Acc: 0.285
Validation loss decreased (-0.240723 --> -0.285168).  Saving model ...
Epoch: 6 cost time: 1.55179762840271
Epoch: 6, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.626 Vali Acc: 0.352 Test Loss: 1.626 Test Acc: 0.352
Validation loss decreased (-0.285168 --> -0.351836).  Saving model ...
Epoch: 7 cost time: 1.4442548751831055
Epoch: 7, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.564 Vali Acc: 0.441 Test Loss: 1.564 Test Acc: 0.441
Validation loss decreased (-0.351836 --> -0.440725).  Saving model ...
Epoch: 8 cost time: 1.397205114364624
Epoch: 8, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.495 Vali Acc: 0.526 Test Loss: 1.495 Test Acc: 0.526
Validation loss decreased (-0.440725 --> -0.525911).  Saving model ...
Epoch: 9 cost time: 1.509946584701538
Epoch: 9, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.424 Vali Acc: 0.600 Test Loss: 1.424 Test Acc: 0.600
Validation loss decreased (-0.525911 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 1.3948698043823242
Epoch: 10, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.350 Vali Acc: 0.681 Test Loss: 1.350 Test Acc: 0.681
Validation loss decreased (-0.599986 --> -0.681468).  Saving model ...
Epoch: 11 cost time: 1.5508053302764893
Epoch: 11, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.274 Vali Acc: 0.726 Test Loss: 1.274 Test Acc: 0.726
Validation loss decreased (-0.681468 --> -0.725913).  Saving model ...
Epoch: 12 cost time: 1.4755382537841797
Epoch: 12, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.199 Vali Acc: 0.770 Test Loss: 1.199 Test Acc: 0.770
Validation loss decreased (-0.725913 --> -0.770358).  Saving model ...
Epoch: 13 cost time: 1.5341682434082031
Epoch: 13, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.126 Vali Acc: 0.793 Test Loss: 1.126 Test Acc: 0.793
Validation loss decreased (-0.770358 --> -0.792581).  Saving model ...
Epoch: 14 cost time: 1.701005458831787
Epoch: 14, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.055 Vali Acc: 0.800 Test Loss: 1.055 Test Acc: 0.800
Validation loss decreased (-0.792581 --> -0.799989).  Saving model ...
Epoch: 15 cost time: 1.6060688495635986
Epoch: 15, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.986 Vali Acc: 0.830 Test Loss: 0.986 Test Acc: 0.830
Validation loss decreased (-0.799989 --> -0.829620).  Saving model ...
Epoch: 16 cost time: 1.438234806060791
Epoch: 16, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.919 Vali Acc: 0.837 Test Loss: 0.919 Test Acc: 0.837
Validation loss decreased (-0.829620 --> -0.837028).  Saving model ...
Epoch: 17 cost time: 1.4627254009246826
Epoch: 17, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.856 Vali Acc: 0.844 Test Loss: 0.856 Test Acc: 0.844
Validation loss decreased (-0.837028 --> -0.844436).  Saving model ...
Epoch: 18 cost time: 1.470870018005371
Epoch: 18, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.798 Vali Acc: 0.856 Test Loss: 0.798 Test Acc: 0.856
Validation loss decreased (-0.844436 --> -0.855548).  Saving model ...
Epoch: 19 cost time: 1.411672830581665
Epoch: 19, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.743 Vali Acc: 0.856 Test Loss: 0.743 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855548).  Saving model ...
Epoch: 20 cost time: 1.4282779693603516
Epoch: 20, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.692 Vali Acc: 0.870 Test Loss: 0.692 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870363).  Saving model ...
Epoch: 21 cost time: 1.3984472751617432
Epoch: 21, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.646 Vali Acc: 0.874 Test Loss: 0.646 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874068).  Saving model ...
Epoch: 22 cost time: 1.3528358936309814
Epoch: 22, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
Validation loss decreased (-0.874068 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.2904541492462158
Epoch: 23, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.567 Vali Acc: 0.885 Test Loss: 0.567 Test Acc: 0.885
Validation loss decreased (-0.877772 --> -0.885180).  Saving model ...
Epoch: 24 cost time: 1.4630866050720215
Epoch: 24, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.533 Vali Acc: 0.889 Test Loss: 0.533 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 25 cost time: 1.503190040588379
Epoch: 25, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.503 Vali Acc: 0.893 Test Loss: 0.503 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 26 cost time: 1.3246703147888184
Epoch: 26, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.476 Vali Acc: 0.896 Test Loss: 0.476 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 27 cost time: 1.3698434829711914
Epoch: 27, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.452 Vali Acc: 0.907 Test Loss: 0.452 Test Acc: 0.907
Validation loss decreased (-0.896292 --> -0.907403).  Saving model ...
Epoch: 28 cost time: 1.427609920501709
Epoch: 28, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.431 Vali Acc: 0.907 Test Loss: 0.431 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 29 cost time: 1.4025263786315918
Epoch: 29, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.412 Vali Acc: 0.904 Test Loss: 0.412 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.481644630432129
Epoch: 30, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.396 Vali Acc: 0.907 Test Loss: 0.396 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 9388550
model size : 36.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8195059299468994
Epoch: 1, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.744 Vali Acc: 0.270 Test Loss: 1.744 Test Acc: 0.270
Validation loss decreased (inf --> -0.270353).  Saving model ...
Epoch: 2 cost time: 0.94667649269104
Epoch: 2, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.708 Vali Acc: 0.293 Test Loss: 1.708 Test Acc: 0.293
Validation loss decreased (-0.270353 --> -0.292576).  Saving model ...
Epoch: 3 cost time: 0.917478084564209
Epoch: 3, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.675 Vali Acc: 0.300 Test Loss: 1.675 Test Acc: 0.300
Validation loss decreased (-0.292576 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.9784460067749023
Epoch: 4, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.635 Vali Acc: 0.322 Test Loss: 1.635 Test Acc: 0.322
Validation loss decreased (-0.299983 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 0.9854190349578857
Epoch: 5, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.585 Vali Acc: 0.337 Test Loss: 1.585 Test Acc: 0.337
Validation loss decreased (-0.322206 --> -0.337021).  Saving model ...
Epoch: 6 cost time: 0.9772021770477295
Epoch: 6, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.525 Vali Acc: 0.415 Test Loss: 1.525 Test Acc: 0.415
Validation loss decreased (-0.337021 --> -0.414800).  Saving model ...
Epoch: 7 cost time: 1.0010147094726562
Epoch: 7, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.459 Vali Acc: 0.537 Test Loss: 1.459 Test Acc: 0.537
Validation loss decreased (-0.414800 --> -0.537022).  Saving model ...
Epoch: 8 cost time: 0.9538474082946777
Epoch: 8, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.389 Vali Acc: 0.644 Test Loss: 1.389 Test Acc: 0.644
Validation loss decreased (-0.537022 --> -0.644431).  Saving model ...
Epoch: 9 cost time: 0.9574811458587646
Epoch: 9, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.316 Vali Acc: 0.674 Test Loss: 1.316 Test Acc: 0.674
Validation loss decreased (-0.644431 --> -0.674061).  Saving model ...
Epoch: 10 cost time: 0.9807925224304199
Epoch: 10, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.242 Vali Acc: 0.704 Test Loss: 1.242 Test Acc: 0.704
Validation loss decreased (-0.674061 --> -0.703691).  Saving model ...
Epoch: 11 cost time: 0.9320621490478516
Epoch: 11, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.166 Vali Acc: 0.733 Test Loss: 1.166 Test Acc: 0.733
Validation loss decreased (-0.703691 --> -0.733322).  Saving model ...
Epoch: 12 cost time: 0.9588546752929688
Epoch: 12, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.092 Vali Acc: 0.785 Test Loss: 1.092 Test Acc: 0.785
Validation loss decreased (-0.733322 --> -0.785174).  Saving model ...
Epoch: 13 cost time: 0.9747796058654785
Epoch: 13, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.020 Vali Acc: 0.837 Test Loss: 1.020 Test Acc: 0.837
Validation loss decreased (-0.785174 --> -0.837027).  Saving model ...
Epoch: 14 cost time: 1.0355165004730225
Epoch: 14, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.951 Vali Acc: 0.867 Test Loss: 0.951 Test Acc: 0.867
Validation loss decreased (-0.837027 --> -0.866657).  Saving model ...
Epoch: 15 cost time: 1.0659971237182617
Epoch: 15, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.886 Vali Acc: 0.881 Test Loss: 0.886 Test Acc: 0.881
Validation loss decreased (-0.866657 --> -0.881473).  Saving model ...
Epoch: 16 cost time: 0.9671173095703125
Epoch: 16, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.824 Vali Acc: 0.893 Test Loss: 0.824 Test Acc: 0.893
Validation loss decreased (-0.881473 --> -0.892584).  Saving model ...
Epoch: 17 cost time: 0.9996817111968994
Epoch: 17, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.767 Vali Acc: 0.900 Test Loss: 0.767 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 18 cost time: 0.9470665454864502
Epoch: 18, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.715 Vali Acc: 0.907 Test Loss: 0.715 Test Acc: 0.907
Validation loss decreased (-0.899992 --> -0.907400).  Saving model ...
Epoch: 19 cost time: 0.8902568817138672
Epoch: 19, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.667 Vali Acc: 0.919 Test Loss: 0.667 Test Acc: 0.919
Validation loss decreased (-0.907400 --> -0.918512).  Saving model ...
Epoch: 20 cost time: 0.908980131149292
Epoch: 20, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.622 Vali Acc: 0.919 Test Loss: 0.622 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 21 cost time: 0.9438693523406982
Epoch: 21, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.580 Vali Acc: 0.919 Test Loss: 0.580 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 22 cost time: 1.0888125896453857
Epoch: 22, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.543 Vali Acc: 0.919 Test Loss: 0.543 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 23 cost time: 1.1190533638000488
Epoch: 23, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.511 Vali Acc: 0.919 Test Loss: 0.511 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 24 cost time: 1.0439863204956055
Epoch: 24, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.482 Vali Acc: 0.922 Test Loss: 0.482 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 1.1337580680847168
Epoch: 25, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.455 Vali Acc: 0.922 Test Loss: 0.455 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 26 cost time: 1.029512882232666
Epoch: 26, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.433 Vali Acc: 0.922 Test Loss: 0.433 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 27 cost time: 1.0414199829101562
Epoch: 27, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.413 Vali Acc: 0.915 Test Loss: 0.413 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0577268600463867
Epoch: 28, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.396 Vali Acc: 0.915 Test Loss: 0.396 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.144108533859253
Epoch: 29, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.380 Vali Acc: 0.915 Test Loss: 0.380 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0709762573242188
Epoch: 30, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.368 Vali Acc: 0.919 Test Loss: 0.368 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 2768134
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9553279876708984
Epoch: 1, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.841 Vali Acc: 0.170 Test Loss: 1.841 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 1.006096363067627
Epoch: 2, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.804 Vali Acc: 0.185 Test Loss: 1.804 Test Acc: 0.185
Validation loss decreased (-0.170352 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 1.1048665046691895
Epoch: 3, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.771 Vali Acc: 0.207 Test Loss: 1.771 Test Acc: 0.207
Validation loss decreased (-0.185167 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 1.125420093536377
Epoch: 4, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.732 Vali Acc: 0.241 Test Loss: 1.732 Test Acc: 0.241
Validation loss decreased (-0.207390 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 1.0971996784210205
Epoch: 5, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.683 Vali Acc: 0.285 Test Loss: 1.683 Test Acc: 0.285
Validation loss decreased (-0.240723 --> -0.285168).  Saving model ...
Epoch: 6 cost time: 1.0858569145202637
Epoch: 6, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.626 Vali Acc: 0.352 Test Loss: 1.626 Test Acc: 0.352
Validation loss decreased (-0.285168 --> -0.351836).  Saving model ...
Epoch: 7 cost time: 1.1772282123565674
Epoch: 7, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.564 Vali Acc: 0.441 Test Loss: 1.564 Test Acc: 0.441
Validation loss decreased (-0.351836 --> -0.440725).  Saving model ...
Epoch: 8 cost time: 1.049896001815796
Epoch: 8, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.495 Vali Acc: 0.526 Test Loss: 1.495 Test Acc: 0.526
Validation loss decreased (-0.440725 --> -0.525911).  Saving model ...
Epoch: 9 cost time: 0.9460937976837158
Epoch: 9, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.424 Vali Acc: 0.600 Test Loss: 1.424 Test Acc: 0.600
Validation loss decreased (-0.525911 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 0.9379687309265137
Epoch: 10, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.350 Vali Acc: 0.681 Test Loss: 1.350 Test Acc: 0.681
Validation loss decreased (-0.599986 --> -0.681468).  Saving model ...
Epoch: 11 cost time: 0.9283525943756104
Epoch: 11, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.275 Vali Acc: 0.726 Test Loss: 1.275 Test Acc: 0.726
Validation loss decreased (-0.681468 --> -0.725913).  Saving model ...
Epoch: 12 cost time: 0.936265230178833
Epoch: 12, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.199 Vali Acc: 0.770 Test Loss: 1.199 Test Acc: 0.770
Validation loss decreased (-0.725913 --> -0.770358).  Saving model ...
Epoch: 13 cost time: 0.9950580596923828
Epoch: 13, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.126 Vali Acc: 0.793 Test Loss: 1.126 Test Acc: 0.793
Validation loss decreased (-0.770358 --> -0.792581).  Saving model ...
Epoch: 14 cost time: 0.9443454742431641
Epoch: 14, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.055 Vali Acc: 0.800 Test Loss: 1.055 Test Acc: 0.800
Validation loss decreased (-0.792581 --> -0.799989).  Saving model ...
Epoch: 15 cost time: 0.8617043495178223
Epoch: 15, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.986 Vali Acc: 0.830 Test Loss: 0.986 Test Acc: 0.830
Validation loss decreased (-0.799989 --> -0.829620).  Saving model ...
Epoch: 16 cost time: 1.088552713394165
Epoch: 16, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.920 Vali Acc: 0.837 Test Loss: 0.920 Test Acc: 0.837
Validation loss decreased (-0.829620 --> -0.837028).  Saving model ...
Epoch: 17 cost time: 1.2458226680755615
Epoch: 17, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.857 Vali Acc: 0.844 Test Loss: 0.857 Test Acc: 0.844
Validation loss decreased (-0.837028 --> -0.844436).  Saving model ...
Epoch: 18 cost time: 1.1859521865844727
Epoch: 18, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.798 Vali Acc: 0.856 Test Loss: 0.798 Test Acc: 0.856
Validation loss decreased (-0.844436 --> -0.855548).  Saving model ...
Epoch: 19 cost time: 1.1926846504211426
Epoch: 19, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.743 Vali Acc: 0.856 Test Loss: 0.743 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855548).  Saving model ...
Epoch: 20 cost time: 1.1347217559814453
Epoch: 20, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.692 Vali Acc: 0.870 Test Loss: 0.692 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870363).  Saving model ...
Epoch: 21 cost time: 1.2808613777160645
Epoch: 21, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.646 Vali Acc: 0.874 Test Loss: 0.646 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874068).  Saving model ...
Epoch: 22 cost time: 1.155524492263794
Epoch: 22, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
Validation loss decreased (-0.874068 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.163057804107666
Epoch: 23, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.568 Vali Acc: 0.885 Test Loss: 0.568 Test Acc: 0.885
Validation loss decreased (-0.877772 --> -0.885180).  Saving model ...
Epoch: 24 cost time: 1.1803851127624512
Epoch: 24, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.534 Vali Acc: 0.889 Test Loss: 0.534 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 25 cost time: 1.10308837890625
Epoch: 25, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.504 Vali Acc: 0.893 Test Loss: 0.504 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 26 cost time: 1.1181902885437012
Epoch: 26, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.477 Vali Acc: 0.896 Test Loss: 0.477 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 27 cost time: 1.2039318084716797
Epoch: 27, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.452 Vali Acc: 0.907 Test Loss: 0.452 Test Acc: 0.907
Validation loss decreased (-0.896292 --> -0.907403).  Saving model ...
Epoch: 28 cost time: 1.2188348770141602
Epoch: 28, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.431 Vali Acc: 0.907 Test Loss: 0.431 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 29 cost time: 1.2540614604949951
Epoch: 29, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.413 Vali Acc: 0.904 Test Loss: 0.413 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1855039596557617
Epoch: 30, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.396 Vali Acc: 0.907 Test Loss: 0.396 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 9388550
model size : 36.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7041475772857666
Epoch: 1, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.744 Vali Acc: 0.270 Test Loss: 1.744 Test Acc: 0.270
Validation loss decreased (inf --> -0.270353).  Saving model ...
Epoch: 2 cost time: 0.8774125576019287
Epoch: 2, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.708 Vali Acc: 0.293 Test Loss: 1.708 Test Acc: 0.293
Validation loss decreased (-0.270353 --> -0.292576).  Saving model ...
Epoch: 3 cost time: 0.8911726474761963
Epoch: 3, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.675 Vali Acc: 0.300 Test Loss: 1.675 Test Acc: 0.300
Validation loss decreased (-0.292576 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.8599672317504883
Epoch: 4, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.635 Vali Acc: 0.322 Test Loss: 1.635 Test Acc: 0.322
Validation loss decreased (-0.299983 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 0.8531703948974609
Epoch: 5, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.585 Vali Acc: 0.337 Test Loss: 1.585 Test Acc: 0.337
Validation loss decreased (-0.322206 --> -0.337021).  Saving model ...
Epoch: 6 cost time: 0.8781638145446777
Epoch: 6, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.525 Vali Acc: 0.415 Test Loss: 1.525 Test Acc: 0.415
Validation loss decreased (-0.337021 --> -0.414800).  Saving model ...
Epoch: 7 cost time: 0.8119504451751709
Epoch: 7, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.459 Vali Acc: 0.537 Test Loss: 1.459 Test Acc: 0.537
Validation loss decreased (-0.414800 --> -0.537022).  Saving model ...
Epoch: 8 cost time: 0.7562899589538574
Epoch: 8, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.389 Vali Acc: 0.644 Test Loss: 1.389 Test Acc: 0.644
Validation loss decreased (-0.537022 --> -0.644431).  Saving model ...
Epoch: 9 cost time: 0.8311247825622559
Epoch: 9, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.316 Vali Acc: 0.674 Test Loss: 1.316 Test Acc: 0.674
Validation loss decreased (-0.644431 --> -0.674061).  Saving model ...
Epoch: 10 cost time: 0.8329751491546631
Epoch: 10, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.242 Vali Acc: 0.704 Test Loss: 1.242 Test Acc: 0.704
Validation loss decreased (-0.674061 --> -0.703691).  Saving model ...
Epoch: 11 cost time: 0.8896083831787109
Epoch: 11, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.166 Vali Acc: 0.733 Test Loss: 1.166 Test Acc: 0.733
Validation loss decreased (-0.703691 --> -0.733322).  Saving model ...
Epoch: 12 cost time: 0.809232234954834
Epoch: 12, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.092 Vali Acc: 0.785 Test Loss: 1.092 Test Acc: 0.785
Validation loss decreased (-0.733322 --> -0.785174).  Saving model ...
Epoch: 13 cost time: 0.8929183483123779
Epoch: 13, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.020 Vali Acc: 0.837 Test Loss: 1.020 Test Acc: 0.837
Validation loss decreased (-0.785174 --> -0.837027).  Saving model ...
Epoch: 14 cost time: 0.7947568893432617
Epoch: 14, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.951 Vali Acc: 0.867 Test Loss: 0.951 Test Acc: 0.867
Validation loss decreased (-0.837027 --> -0.866657).  Saving model ...
Epoch: 15 cost time: 0.8168601989746094
Epoch: 15, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.886 Vali Acc: 0.881 Test Loss: 0.886 Test Acc: 0.881
Validation loss decreased (-0.866657 --> -0.881473).  Saving model ...
Epoch: 16 cost time: 0.8299148082733154
Epoch: 16, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.824 Vali Acc: 0.893 Test Loss: 0.824 Test Acc: 0.893
Validation loss decreased (-0.881473 --> -0.892584).  Saving model ...
Epoch: 17 cost time: 0.8137218952178955
Epoch: 17, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.767 Vali Acc: 0.900 Test Loss: 0.767 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 18 cost time: 0.7968108654022217
Epoch: 18, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.715 Vali Acc: 0.907 Test Loss: 0.715 Test Acc: 0.907
Validation loss decreased (-0.899992 --> -0.907400).  Saving model ...
Epoch: 19 cost time: 0.81363844871521
Epoch: 19, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.667 Vali Acc: 0.919 Test Loss: 0.667 Test Acc: 0.919
Validation loss decreased (-0.907400 --> -0.918512).  Saving model ...
Epoch: 20 cost time: 0.8182816505432129
Epoch: 20, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.622 Vali Acc: 0.919 Test Loss: 0.622 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 21 cost time: 0.7864325046539307
Epoch: 21, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.580 Vali Acc: 0.919 Test Loss: 0.580 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 22 cost time: 0.8103697299957275
Epoch: 22, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.543 Vali Acc: 0.919 Test Loss: 0.543 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 23 cost time: 0.8067805767059326
Epoch: 23, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.511 Vali Acc: 0.919 Test Loss: 0.511 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 24 cost time: 0.9346458911895752
Epoch: 24, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.482 Vali Acc: 0.922 Test Loss: 0.482 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 0.81239914894104
Epoch: 25, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.456 Vali Acc: 0.922 Test Loss: 0.456 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 26 cost time: 0.8049390316009521
Epoch: 26, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.433 Vali Acc: 0.922 Test Loss: 0.433 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 27 cost time: 0.8325586318969727
Epoch: 27, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.413 Vali Acc: 0.915 Test Loss: 0.413 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.846930742263794
Epoch: 28, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.396 Vali Acc: 0.915 Test Loss: 0.396 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8157298564910889
Epoch: 29, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.381 Vali Acc: 0.915 Test Loss: 0.381 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8195774555206299
Epoch: 30, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.368 Vali Acc: 0.919 Test Loss: 0.368 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 2768134
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.782910108566284
Epoch: 1, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.842 Vali Acc: 0.170 Test Loss: 1.842 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.9040749073028564
Epoch: 2, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.805 Vali Acc: 0.185 Test Loss: 1.805 Test Acc: 0.185
Validation loss decreased (-0.170352 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 1.090169906616211
Epoch: 3, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.773 Vali Acc: 0.207 Test Loss: 1.773 Test Acc: 0.207
Validation loss decreased (-0.185167 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.9664697647094727
Epoch: 4, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.734 Vali Acc: 0.230 Test Loss: 1.734 Test Acc: 0.230
Validation loss decreased (-0.207390 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.9320454597473145
Epoch: 5, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.687 Vali Acc: 0.278 Test Loss: 1.687 Test Acc: 0.278
Validation loss decreased (-0.229612 --> -0.277761).  Saving model ...
Epoch: 6 cost time: 0.9638500213623047
Epoch: 6, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.632 Vali Acc: 0.348 Test Loss: 1.632 Test Acc: 0.348
Validation loss decreased (-0.277761 --> -0.348132).  Saving model ...
Epoch: 7 cost time: 0.925325870513916
Epoch: 7, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.571 Vali Acc: 0.426 Test Loss: 1.571 Test Acc: 0.426
Validation loss decreased (-0.348132 --> -0.425910).  Saving model ...
Epoch: 8 cost time: 0.9121732711791992
Epoch: 8, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.505 Vali Acc: 0.511 Test Loss: 1.505 Test Acc: 0.511
Validation loss decreased (-0.425910 --> -0.511096).  Saving model ...
Epoch: 9 cost time: 0.8683242797851562
Epoch: 9, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.436 Vali Acc: 0.607 Test Loss: 1.436 Test Acc: 0.607
Validation loss decreased (-0.511096 --> -0.607393).  Saving model ...
Epoch: 10 cost time: 0.8992986679077148
Epoch: 10, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.364 Vali Acc: 0.674 Test Loss: 1.364 Test Acc: 0.674
Validation loss decreased (-0.607393 --> -0.674060).  Saving model ...
Epoch: 11 cost time: 0.8826286792755127
Epoch: 11, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.290 Vali Acc: 0.726 Test Loss: 1.290 Test Acc: 0.726
Validation loss decreased (-0.674060 --> -0.725913).  Saving model ...
Epoch: 12 cost time: 0.8322138786315918
Epoch: 12, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.216 Vali Acc: 0.767 Test Loss: 1.216 Test Acc: 0.767
Validation loss decreased (-0.725913 --> -0.766655).  Saving model ...
Epoch: 13 cost time: 0.9948666095733643
Epoch: 13, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.143 Vali Acc: 0.793 Test Loss: 1.143 Test Acc: 0.793
Validation loss decreased (-0.766655 --> -0.792581).  Saving model ...
Epoch: 14 cost time: 0.9363179206848145
Epoch: 14, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.071 Vali Acc: 0.793 Test Loss: 1.071 Test Acc: 0.793
Validation loss decreased (-0.792581 --> -0.792582).  Saving model ...
Epoch: 15 cost time: 0.9653611183166504
Epoch: 15, Steps: 2 | Train Loss: 0.926 Vali Loss: 1.001 Vali Acc: 0.826 Test Loss: 1.001 Test Acc: 0.826
Validation loss decreased (-0.792582 --> -0.825916).  Saving model ...
Epoch: 16 cost time: 0.9502732753753662
Epoch: 16, Steps: 2 | Train Loss: 0.855 Vali Loss: 0.933 Vali Acc: 0.841 Test Loss: 0.933 Test Acc: 0.841
Validation loss decreased (-0.825916 --> -0.840731).  Saving model ...
Epoch: 17 cost time: 0.9886159896850586
Epoch: 17, Steps: 2 | Train Loss: 0.744 Vali Loss: 0.867 Vali Acc: 0.841 Test Loss: 0.867 Test Acc: 0.841
Validation loss decreased (-0.840731 --> -0.840732).  Saving model ...
Epoch: 18 cost time: 1.0093536376953125
Epoch: 18, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.806 Vali Acc: 0.844 Test Loss: 0.806 Test Acc: 0.844
Validation loss decreased (-0.840732 --> -0.844436).  Saving model ...
Epoch: 19 cost time: 0.965796709060669
Epoch: 19, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.749 Vali Acc: 0.859 Test Loss: 0.749 Test Acc: 0.859
Validation loss decreased (-0.844436 --> -0.859252).  Saving model ...
Epoch: 20 cost time: 1.012249231338501
Epoch: 20, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.695 Vali Acc: 0.870 Test Loss: 0.695 Test Acc: 0.870
Validation loss decreased (-0.859252 --> -0.870363).  Saving model ...
Epoch: 21 cost time: 1.0111017227172852
Epoch: 21, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.646 Vali Acc: 0.874 Test Loss: 0.646 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874068).  Saving model ...
Epoch: 22 cost time: 0.9575018882751465
Epoch: 22, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.602 Vali Acc: 0.881 Test Loss: 0.602 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881475).  Saving model ...
Epoch: 23 cost time: 1.0032422542572021
Epoch: 23, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.563 Vali Acc: 0.885 Test Loss: 0.563 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885180).  Saving model ...
Epoch: 24 cost time: 0.8823883533477783
Epoch: 24, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.527 Vali Acc: 0.893 Test Loss: 0.527 Test Acc: 0.893
Validation loss decreased (-0.885180 --> -0.892587).  Saving model ...
Epoch: 25 cost time: 0.952988862991333
Epoch: 25, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.495 Vali Acc: 0.893 Test Loss: 0.495 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892588).  Saving model ...
Epoch: 26 cost time: 0.8602211475372314
Epoch: 26, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.467 Vali Acc: 0.904 Test Loss: 0.467 Test Acc: 0.904
Validation loss decreased (-0.892588 --> -0.903699).  Saving model ...
Epoch: 27 cost time: 0.9605679512023926
Epoch: 27, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.441 Vali Acc: 0.915 Test Loss: 0.441 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914810).  Saving model ...
Epoch: 28 cost time: 0.8336606025695801
Epoch: 28, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.419 Vali Acc: 0.915 Test Loss: 0.419 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 29 cost time: 0.9320666790008545
Epoch: 29, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.399 Vali Acc: 0.915 Test Loss: 0.399 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 30 cost time: 0.8204562664031982
Epoch: 30, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.381 Vali Acc: 0.915 Test Loss: 0.381 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 9388550
model size : 36.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4464383125305176
Epoch: 1, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.744 Vali Acc: 0.267 Test Loss: 1.744 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 0.621903657913208
Epoch: 2, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.707 Vali Acc: 0.289 Test Loss: 1.707 Test Acc: 0.289
Validation loss decreased (-0.266649 --> -0.288872).  Saving model ...
Epoch: 3 cost time: 0.6823530197143555
Epoch: 3, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.675 Vali Acc: 0.300 Test Loss: 1.675 Test Acc: 0.300
Validation loss decreased (-0.288872 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.6286125183105469
Epoch: 4, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.636 Vali Acc: 0.322 Test Loss: 1.636 Test Acc: 0.322
Validation loss decreased (-0.299983 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 0.6857609748840332
Epoch: 5, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.587 Vali Acc: 0.337 Test Loss: 1.587 Test Acc: 0.337
Validation loss decreased (-0.322206 --> -0.337021).  Saving model ...
Epoch: 6 cost time: 0.636887788772583
Epoch: 6, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.529 Vali Acc: 0.407 Test Loss: 1.529 Test Acc: 0.407
Validation loss decreased (-0.337021 --> -0.407392).  Saving model ...
Epoch: 7 cost time: 0.6924049854278564
Epoch: 7, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.464 Vali Acc: 0.526 Test Loss: 1.464 Test Acc: 0.526
Validation loss decreased (-0.407392 --> -0.525911).  Saving model ...
Epoch: 8 cost time: 0.7179791927337646
Epoch: 8, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.396 Vali Acc: 0.626 Test Loss: 1.396 Test Acc: 0.626
Validation loss decreased (-0.525911 --> -0.625912).  Saving model ...
Epoch: 9 cost time: 0.7730424404144287
Epoch: 9, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.325 Vali Acc: 0.663 Test Loss: 1.325 Test Acc: 0.663
Validation loss decreased (-0.625912 --> -0.662950).  Saving model ...
Epoch: 10 cost time: 0.7563884258270264
Epoch: 10, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.251 Vali Acc: 0.696 Test Loss: 1.251 Test Acc: 0.696
Validation loss decreased (-0.662950 --> -0.696284).  Saving model ...
Epoch: 11 cost time: 0.7717068195343018
Epoch: 11, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.178 Vali Acc: 0.722 Test Loss: 1.178 Test Acc: 0.722
Validation loss decreased (-0.696284 --> -0.722210).  Saving model ...
Epoch: 12 cost time: 0.700589656829834
Epoch: 12, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.105 Vali Acc: 0.778 Test Loss: 1.105 Test Acc: 0.778
Validation loss decreased (-0.722210 --> -0.777767).  Saving model ...
Epoch: 13 cost time: 0.6764404773712158
Epoch: 13, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.033 Vali Acc: 0.830 Test Loss: 1.033 Test Acc: 0.830
Validation loss decreased (-0.777767 --> -0.829619).  Saving model ...
Epoch: 14 cost time: 0.709928035736084
Epoch: 14, Steps: 2 | Train Loss: 0.948 Vali Loss: 0.965 Vali Acc: 0.859 Test Loss: 0.965 Test Acc: 0.859
Validation loss decreased (-0.829619 --> -0.859250).  Saving model ...
Epoch: 15 cost time: 0.7563550472259521
Epoch: 15, Steps: 2 | Train Loss: 0.861 Vali Loss: 0.899 Vali Acc: 0.881 Test Loss: 0.899 Test Acc: 0.881
Validation loss decreased (-0.859250 --> -0.881472).  Saving model ...
Epoch: 16 cost time: 0.777076244354248
Epoch: 16, Steps: 2 | Train Loss: 0.781 Vali Loss: 0.837 Vali Acc: 0.889 Test Loss: 0.837 Test Acc: 0.889
Validation loss decreased (-0.881472 --> -0.888881).  Saving model ...
Epoch: 17 cost time: 0.7074160575866699
Epoch: 17, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.779 Vali Acc: 0.896 Test Loss: 0.779 Test Acc: 0.896
Validation loss decreased (-0.888881 --> -0.896289).  Saving model ...
Epoch: 18 cost time: 0.7978153228759766
Epoch: 18, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.725 Vali Acc: 0.911 Test Loss: 0.725 Test Acc: 0.911
Validation loss decreased (-0.896289 --> -0.911104).  Saving model ...
Epoch: 19 cost time: 0.7281382083892822
Epoch: 19, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.676 Vali Acc: 0.919 Test Loss: 0.676 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918512).  Saving model ...
Epoch: 20 cost time: 0.6832072734832764
Epoch: 20, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.629 Vali Acc: 0.926 Test Loss: 0.629 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925920).  Saving model ...
Epoch: 21 cost time: 0.6172916889190674
Epoch: 21, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.585 Vali Acc: 0.922 Test Loss: 0.585 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7246088981628418
Epoch: 22, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.545 Vali Acc: 0.922 Test Loss: 0.545 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.699800968170166
Epoch: 23, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.511 Vali Acc: 0.919 Test Loss: 0.511 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7574729919433594
Epoch: 24, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.479 Vali Acc: 0.926 Test Loss: 0.479 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925921).  Saving model ...
Epoch: 25 cost time: 0.7747194766998291
Epoch: 25, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.451 Vali Acc: 0.919 Test Loss: 0.451 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7382721900939941
Epoch: 26, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.427 Vali Acc: 0.919 Test Loss: 0.427 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7007243633270264
Epoch: 27, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.404 Vali Acc: 0.922 Test Loss: 0.404 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6859867572784424
Epoch: 28, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.385 Vali Acc: 0.919 Test Loss: 0.385 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7462539672851562
Epoch: 29, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.369 Vali Acc: 0.922 Test Loss: 0.369 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7235310077667236
Epoch: 30, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.354 Vali Acc: 0.919 Test Loss: 0.354 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 2768134
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.081217050552368
Epoch: 1, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.857 Vali Acc: 0.126 Test Loss: 1.857 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 1.1896235942840576
Epoch: 2, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.818 Vali Acc: 0.185 Test Loss: 1.818 Test Acc: 0.185
Validation loss decreased (-0.125907 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 1.213425874710083
Epoch: 3, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.785 Vali Acc: 0.215 Test Loss: 1.785 Test Acc: 0.215
Validation loss decreased (-0.185167 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 1.0807232856750488
Epoch: 4, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.750 Vali Acc: 0.244 Test Loss: 1.750 Test Acc: 0.244
Validation loss decreased (-0.214797 --> -0.244427).  Saving model ...
Epoch: 5 cost time: 1.1313047409057617
Epoch: 5, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.704 Vali Acc: 0.311 Test Loss: 1.704 Test Acc: 0.311
Validation loss decreased (-0.244427 --> -0.311094).  Saving model ...
Epoch: 6 cost time: 1.110546350479126
Epoch: 6, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.650 Vali Acc: 0.359 Test Loss: 1.650 Test Acc: 0.359
Validation loss decreased (-0.311094 --> -0.359243).  Saving model ...
Epoch: 7 cost time: 1.1980555057525635
Epoch: 7, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.592 Vali Acc: 0.422 Test Loss: 1.592 Test Acc: 0.422
Validation loss decreased (-0.359243 --> -0.422206).  Saving model ...
Epoch: 8 cost time: 1.1374382972717285
Epoch: 8, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.528 Vali Acc: 0.485 Test Loss: 1.528 Test Acc: 0.485
Validation loss decreased (-0.422206 --> -0.485170).  Saving model ...
Epoch: 9 cost time: 1.1829893589019775
Epoch: 9, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.461 Vali Acc: 0.570 Test Loss: 1.461 Test Acc: 0.570
Validation loss decreased (-0.485170 --> -0.570356).  Saving model ...
Epoch: 10 cost time: 1.0619797706604004
Epoch: 10, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.392 Vali Acc: 0.644 Test Loss: 1.392 Test Acc: 0.644
Validation loss decreased (-0.570356 --> -0.644431).  Saving model ...
Epoch: 11 cost time: 1.1217031478881836
Epoch: 11, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.322 Vali Acc: 0.744 Test Loss: 1.322 Test Acc: 0.744
Validation loss decreased (-0.644431 --> -0.744431).  Saving model ...
Epoch: 12 cost time: 1.1370022296905518
Epoch: 12, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.253 Vali Acc: 0.789 Test Loss: 1.253 Test Acc: 0.789
Validation loss decreased (-0.744431 --> -0.788876).  Saving model ...
Epoch: 13 cost time: 1.0693211555480957
Epoch: 13, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.183 Vali Acc: 0.822 Test Loss: 1.183 Test Acc: 0.822
Validation loss decreased (-0.788876 --> -0.822210).  Saving model ...
Epoch: 14 cost time: 1.2307260036468506
Epoch: 14, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.116 Vali Acc: 0.826 Test Loss: 1.116 Test Acc: 0.826
Validation loss decreased (-0.822210 --> -0.825915).  Saving model ...
Epoch: 15 cost time: 1.136017084121704
Epoch: 15, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.050 Vali Acc: 0.826 Test Loss: 1.050 Test Acc: 0.826
Validation loss decreased (-0.825915 --> -0.825915).  Saving model ...
Epoch: 16 cost time: 1.1601922512054443
Epoch: 16, Steps: 2 | Train Loss: 0.870 Vali Loss: 0.985 Vali Acc: 0.837 Test Loss: 0.985 Test Acc: 0.837
Validation loss decreased (-0.825915 --> -0.837027).  Saving model ...
Epoch: 17 cost time: 1.1362943649291992
Epoch: 17, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.924 Vali Acc: 0.844 Test Loss: 0.924 Test Acc: 0.844
Validation loss decreased (-0.837027 --> -0.844435).  Saving model ...
Epoch: 18 cost time: 1.2172105312347412
Epoch: 18, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.866 Vali Acc: 0.848 Test Loss: 0.866 Test Acc: 0.848
Validation loss decreased (-0.844435 --> -0.848139).  Saving model ...
Epoch: 19 cost time: 1.0556073188781738
Epoch: 19, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.810 Vali Acc: 0.859 Test Loss: 0.810 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859251).  Saving model ...
Epoch: 20 cost time: 1.0815095901489258
Epoch: 20, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.759 Vali Acc: 0.874 Test Loss: 0.759 Test Acc: 0.874
Validation loss decreased (-0.859251 --> -0.874066).  Saving model ...
Epoch: 21 cost time: 1.1076593399047852
Epoch: 21, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.711 Vali Acc: 0.907 Test Loss: 0.711 Test Acc: 0.907
Validation loss decreased (-0.874066 --> -0.907400).  Saving model ...
Epoch: 22 cost time: 1.1984517574310303
Epoch: 22, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.666 Vali Acc: 0.922 Test Loss: 0.666 Test Acc: 0.922
Validation loss decreased (-0.907400 --> -0.922216).  Saving model ...
Epoch: 23 cost time: 1.0980794429779053
Epoch: 23, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.623 Vali Acc: 0.933 Test Loss: 0.623 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933327).  Saving model ...
Epoch: 24 cost time: 1.1598789691925049
Epoch: 24, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.583 Vali Acc: 0.933 Test Loss: 0.583 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933327).  Saving model ...
Epoch: 25 cost time: 1.1582767963409424
Epoch: 25, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.546 Vali Acc: 0.933 Test Loss: 0.546 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 26 cost time: 1.0974657535552979
Epoch: 26, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.512 Vali Acc: 0.933 Test Loss: 0.512 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 27 cost time: 1.0656225681304932
Epoch: 27, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.482 Vali Acc: 0.926 Test Loss: 0.482 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2084181308746338
Epoch: 28, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.454 Vali Acc: 0.926 Test Loss: 0.454 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1588711738586426
Epoch: 29, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.429 Vali Acc: 0.930 Test Loss: 0.429 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.088773250579834
Epoch: 30, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.407 Vali Acc: 0.930 Test Loss: 0.407 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 4701190
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8365418910980225
Epoch: 1, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.842 Vali Acc: 0.104 Test Loss: 1.842 Test Acc: 0.104
Validation loss decreased (inf --> -0.103685).  Saving model ...
Epoch: 2 cost time: 0.858698844909668
Epoch: 2, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.800 Vali Acc: 0.163 Test Loss: 1.800 Test Acc: 0.163
Validation loss decreased (-0.103685 --> -0.162945).  Saving model ...
Epoch: 3 cost time: 0.9822275638580322
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.766 Vali Acc: 0.204 Test Loss: 1.766 Test Acc: 0.204
Validation loss decreased (-0.162945 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.9054973125457764
Epoch: 4, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.729 Vali Acc: 0.241 Test Loss: 1.729 Test Acc: 0.241
Validation loss decreased (-0.203686 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 1.0061120986938477
Epoch: 5, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.683 Vali Acc: 0.315 Test Loss: 1.683 Test Acc: 0.315
Validation loss decreased (-0.240723 --> -0.314798).  Saving model ...
Epoch: 6 cost time: 0.9894952774047852
Epoch: 6, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.630 Vali Acc: 0.407 Test Loss: 1.630 Test Acc: 0.407
Validation loss decreased (-0.314798 --> -0.407391).  Saving model ...
Epoch: 7 cost time: 0.9274041652679443
Epoch: 7, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.571 Vali Acc: 0.504 Test Loss: 1.571 Test Acc: 0.504
Validation loss decreased (-0.407391 --> -0.503688).  Saving model ...
Epoch: 8 cost time: 0.8652136325836182
Epoch: 8, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.510 Vali Acc: 0.578 Test Loss: 1.510 Test Acc: 0.578
Validation loss decreased (-0.503688 --> -0.577763).  Saving model ...
Epoch: 9 cost time: 0.8596947193145752
Epoch: 9, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.446 Vali Acc: 0.641 Test Loss: 1.446 Test Acc: 0.641
Validation loss decreased (-0.577763 --> -0.640726).  Saving model ...
Epoch: 10 cost time: 0.937943696975708
Epoch: 10, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.379 Vali Acc: 0.674 Test Loss: 1.379 Test Acc: 0.674
Validation loss decreased (-0.640726 --> -0.674060).  Saving model ...
Epoch: 11 cost time: 0.9459080696105957
Epoch: 11, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.312 Vali Acc: 0.704 Test Loss: 1.312 Test Acc: 0.704
Validation loss decreased (-0.674060 --> -0.703691).  Saving model ...
Epoch: 12 cost time: 0.9455108642578125
Epoch: 12, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.244 Vali Acc: 0.715 Test Loss: 1.244 Test Acc: 0.715
Validation loss decreased (-0.703691 --> -0.714802).  Saving model ...
Epoch: 13 cost time: 0.8769865036010742
Epoch: 13, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.175 Vali Acc: 0.737 Test Loss: 1.175 Test Acc: 0.737
Validation loss decreased (-0.714802 --> -0.737025).  Saving model ...
Epoch: 14 cost time: 0.9270730018615723
Epoch: 14, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.107 Vali Acc: 0.756 Test Loss: 1.107 Test Acc: 0.756
Validation loss decreased (-0.737025 --> -0.755544).  Saving model ...
Epoch: 15 cost time: 0.9416840076446533
Epoch: 15, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.040 Vali Acc: 0.774 Test Loss: 1.040 Test Acc: 0.774
Validation loss decreased (-0.755544 --> -0.774064).  Saving model ...
Epoch: 16 cost time: 0.9362637996673584
Epoch: 16, Steps: 2 | Train Loss: 0.861 Vali Loss: 0.975 Vali Acc: 0.800 Test Loss: 0.975 Test Acc: 0.800
Validation loss decreased (-0.774064 --> -0.799990).  Saving model ...
Epoch: 17 cost time: 0.8616409301757812
Epoch: 17, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.912 Vali Acc: 0.819 Test Loss: 0.912 Test Acc: 0.819
Validation loss decreased (-0.799990 --> -0.818509).  Saving model ...
Epoch: 18 cost time: 0.8560616970062256
Epoch: 18, Steps: 2 | Train Loss: 0.726 Vali Loss: 0.852 Vali Acc: 0.822 Test Loss: 0.852 Test Acc: 0.822
Validation loss decreased (-0.818509 --> -0.822214).  Saving model ...
Epoch: 19 cost time: 0.9003028869628906
Epoch: 19, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.794 Vali Acc: 0.841 Test Loss: 0.794 Test Acc: 0.841
Validation loss decreased (-0.822214 --> -0.840733).  Saving model ...
Epoch: 20 cost time: 0.9328243732452393
Epoch: 20, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.740 Vali Acc: 0.844 Test Loss: 0.740 Test Acc: 0.844
Validation loss decreased (-0.840733 --> -0.844437).  Saving model ...
Epoch: 21 cost time: 0.9335470199584961
Epoch: 21, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.690 Vali Acc: 0.859 Test Loss: 0.690 Test Acc: 0.859
Validation loss decreased (-0.844437 --> -0.859252).  Saving model ...
Epoch: 22 cost time: 0.9088253974914551
Epoch: 22, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.644 Vali Acc: 0.878 Test Loss: 0.644 Test Acc: 0.878
Validation loss decreased (-0.859252 --> -0.877771).  Saving model ...
Epoch: 23 cost time: 0.9234240055084229
Epoch: 23, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.601 Vali Acc: 0.900 Test Loss: 0.601 Test Acc: 0.900
Validation loss decreased (-0.877771 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.9632492065429688
Epoch: 24, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.562 Vali Acc: 0.907 Test Loss: 0.562 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 25 cost time: 0.8378431797027588
Epoch: 25, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.526 Vali Acc: 0.907 Test Loss: 0.526 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 26 cost time: 0.8699467182159424
Epoch: 26, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.494 Vali Acc: 0.911 Test Loss: 0.494 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 27 cost time: 0.8942501544952393
Epoch: 27, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.467 Vali Acc: 0.919 Test Loss: 0.467 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 28 cost time: 1.0015716552734375
Epoch: 28, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.441 Vali Acc: 0.922 Test Loss: 0.441 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 29 cost time: 1.0084476470947266
Epoch: 29, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.420 Vali Acc: 0.922 Test Loss: 0.420 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 30 cost time: 0.880361795425415
Epoch: 30, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.400 Vali Acc: 0.926 Test Loss: 0.400 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 1390854
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.075948476791382
Epoch: 1, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.857 Vali Acc: 0.126 Test Loss: 1.857 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 0.9738626480102539
Epoch: 2, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.818 Vali Acc: 0.185 Test Loss: 1.818 Test Acc: 0.185
Validation loss decreased (-0.125907 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 1.0017280578613281
Epoch: 3, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.785 Vali Acc: 0.215 Test Loss: 1.785 Test Acc: 0.215
Validation loss decreased (-0.185167 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 0.9883103370666504
Epoch: 4, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.750 Vali Acc: 0.244 Test Loss: 1.750 Test Acc: 0.244
Validation loss decreased (-0.214797 --> -0.244427).  Saving model ...
Epoch: 5 cost time: 1.0709447860717773
Epoch: 5, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.704 Vali Acc: 0.311 Test Loss: 1.704 Test Acc: 0.311
Validation loss decreased (-0.244427 --> -0.311094).  Saving model ...
Epoch: 6 cost time: 1.0317869186401367
Epoch: 6, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.650 Vali Acc: 0.359 Test Loss: 1.650 Test Acc: 0.359
Validation loss decreased (-0.311094 --> -0.359243).  Saving model ...
Epoch: 7 cost time: 1.063732385635376
Epoch: 7, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.592 Vali Acc: 0.422 Test Loss: 1.592 Test Acc: 0.422
Validation loss decreased (-0.359243 --> -0.422206).  Saving model ...
Epoch: 8 cost time: 0.930840015411377
Epoch: 8, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.528 Vali Acc: 0.485 Test Loss: 1.528 Test Acc: 0.485
Validation loss decreased (-0.422206 --> -0.485170).  Saving model ...
Epoch: 9 cost time: 0.9843950271606445
Epoch: 9, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.461 Vali Acc: 0.570 Test Loss: 1.461 Test Acc: 0.570
Validation loss decreased (-0.485170 --> -0.570356).  Saving model ...
Epoch: 10 cost time: 1.0745995044708252
Epoch: 10, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.392 Vali Acc: 0.644 Test Loss: 1.392 Test Acc: 0.644
Validation loss decreased (-0.570356 --> -0.644431).  Saving model ...
Epoch: 11 cost time: 0.9757087230682373
Epoch: 11, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.322 Vali Acc: 0.744 Test Loss: 1.322 Test Acc: 0.744
Validation loss decreased (-0.644431 --> -0.744431).  Saving model ...
Epoch: 12 cost time: 0.8865535259246826
Epoch: 12, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.253 Vali Acc: 0.789 Test Loss: 1.253 Test Acc: 0.789
Validation loss decreased (-0.744431 --> -0.788876).  Saving model ...
Epoch: 13 cost time: 0.9445013999938965
Epoch: 13, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.183 Vali Acc: 0.822 Test Loss: 1.183 Test Acc: 0.822
Validation loss decreased (-0.788876 --> -0.822210).  Saving model ...
Epoch: 14 cost time: 1.155245304107666
Epoch: 14, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.116 Vali Acc: 0.826 Test Loss: 1.116 Test Acc: 0.826
Validation loss decreased (-0.822210 --> -0.825915).  Saving model ...
Epoch: 15 cost time: 1.1207785606384277
Epoch: 15, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.050 Vali Acc: 0.826 Test Loss: 1.050 Test Acc: 0.826
Validation loss decreased (-0.825915 --> -0.825915).  Saving model ...
Epoch: 16 cost time: 1.163872480392456
Epoch: 16, Steps: 2 | Train Loss: 0.870 Vali Loss: 0.985 Vali Acc: 0.837 Test Loss: 0.985 Test Acc: 0.837
Validation loss decreased (-0.825915 --> -0.837027).  Saving model ...
Epoch: 17 cost time: 1.0453927516937256
Epoch: 17, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.924 Vali Acc: 0.844 Test Loss: 0.924 Test Acc: 0.844
Validation loss decreased (-0.837027 --> -0.844435).  Saving model ...
Epoch: 18 cost time: 1.1070034503936768
Epoch: 18, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.866 Vali Acc: 0.848 Test Loss: 0.866 Test Acc: 0.848
Validation loss decreased (-0.844435 --> -0.848139).  Saving model ...
Epoch: 19 cost time: 1.2321577072143555
Epoch: 19, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.810 Vali Acc: 0.859 Test Loss: 0.810 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859251).  Saving model ...
Epoch: 20 cost time: 1.2139098644256592
Epoch: 20, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.759 Vali Acc: 0.874 Test Loss: 0.759 Test Acc: 0.874
Validation loss decreased (-0.859251 --> -0.874066).  Saving model ...
Epoch: 21 cost time: 1.1612739562988281
Epoch: 21, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.711 Vali Acc: 0.907 Test Loss: 0.711 Test Acc: 0.907
Validation loss decreased (-0.874066 --> -0.907400).  Saving model ...
Epoch: 22 cost time: 1.1601312160491943
Epoch: 22, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.666 Vali Acc: 0.922 Test Loss: 0.666 Test Acc: 0.922
Validation loss decreased (-0.907400 --> -0.922216).  Saving model ...
Epoch: 23 cost time: 1.1488256454467773
Epoch: 23, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.623 Vali Acc: 0.933 Test Loss: 0.623 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933327).  Saving model ...
Epoch: 24 cost time: 1.1646091938018799
Epoch: 24, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.583 Vali Acc: 0.933 Test Loss: 0.583 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933327).  Saving model ...
Epoch: 25 cost time: 1.1392614841461182
Epoch: 25, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.546 Vali Acc: 0.933 Test Loss: 0.546 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 26 cost time: 1.086371660232544
Epoch: 26, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.512 Vali Acc: 0.933 Test Loss: 0.512 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 27 cost time: 1.1105413436889648
Epoch: 27, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.482 Vali Acc: 0.926 Test Loss: 0.482 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2526867389678955
Epoch: 28, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.454 Vali Acc: 0.926 Test Loss: 0.454 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.140723705291748
Epoch: 29, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.429 Vali Acc: 0.930 Test Loss: 0.429 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1794788837432861
Epoch: 30, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.407 Vali Acc: 0.930 Test Loss: 0.407 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 4701190
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.705872058868408
Epoch: 1, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.842 Vali Acc: 0.104 Test Loss: 1.842 Test Acc: 0.104
Validation loss decreased (inf --> -0.103685).  Saving model ...
Epoch: 2 cost time: 0.760347843170166
Epoch: 2, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.800 Vali Acc: 0.163 Test Loss: 1.800 Test Acc: 0.163
Validation loss decreased (-0.103685 --> -0.162945).  Saving model ...
Epoch: 3 cost time: 0.7338142395019531
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.766 Vali Acc: 0.204 Test Loss: 1.766 Test Acc: 0.204
Validation loss decreased (-0.162945 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.8062942028045654
Epoch: 4, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.729 Vali Acc: 0.241 Test Loss: 1.729 Test Acc: 0.241
Validation loss decreased (-0.203686 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 0.698606014251709
Epoch: 5, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.683 Vali Acc: 0.315 Test Loss: 1.683 Test Acc: 0.315
Validation loss decreased (-0.240723 --> -0.314798).  Saving model ...
Epoch: 6 cost time: 0.7315232753753662
Epoch: 6, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.630 Vali Acc: 0.407 Test Loss: 1.630 Test Acc: 0.407
Validation loss decreased (-0.314798 --> -0.407391).  Saving model ...
Epoch: 7 cost time: 0.7929291725158691
Epoch: 7, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.571 Vali Acc: 0.504 Test Loss: 1.571 Test Acc: 0.504
Validation loss decreased (-0.407391 --> -0.503688).  Saving model ...
Epoch: 8 cost time: 0.7628729343414307
Epoch: 8, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.510 Vali Acc: 0.578 Test Loss: 1.510 Test Acc: 0.578
Validation loss decreased (-0.503688 --> -0.577763).  Saving model ...
Epoch: 9 cost time: 0.7735645771026611
Epoch: 9, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.446 Vali Acc: 0.641 Test Loss: 1.446 Test Acc: 0.641
Validation loss decreased (-0.577763 --> -0.640726).  Saving model ...
Epoch: 10 cost time: 0.7966628074645996
Epoch: 10, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.379 Vali Acc: 0.674 Test Loss: 1.379 Test Acc: 0.674
Validation loss decreased (-0.640726 --> -0.674060).  Saving model ...
Epoch: 11 cost time: 0.7731976509094238
Epoch: 11, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.312 Vali Acc: 0.704 Test Loss: 1.312 Test Acc: 0.704
Validation loss decreased (-0.674060 --> -0.703691).  Saving model ...
Epoch: 12 cost time: 0.7634198665618896
Epoch: 12, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.244 Vali Acc: 0.715 Test Loss: 1.244 Test Acc: 0.715
Validation loss decreased (-0.703691 --> -0.714802).  Saving model ...
Epoch: 13 cost time: 0.7602612972259521
Epoch: 13, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.175 Vali Acc: 0.737 Test Loss: 1.175 Test Acc: 0.737
Validation loss decreased (-0.714802 --> -0.737025).  Saving model ...
Epoch: 14 cost time: 0.7770562171936035
Epoch: 14, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.107 Vali Acc: 0.756 Test Loss: 1.107 Test Acc: 0.756
Validation loss decreased (-0.737025 --> -0.755544).  Saving model ...
Epoch: 15 cost time: 0.7608482837677002
Epoch: 15, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.040 Vali Acc: 0.774 Test Loss: 1.040 Test Acc: 0.774
Validation loss decreased (-0.755544 --> -0.774064).  Saving model ...
Epoch: 16 cost time: 0.7682094573974609
Epoch: 16, Steps: 2 | Train Loss: 0.861 Vali Loss: 0.975 Vali Acc: 0.800 Test Loss: 0.975 Test Acc: 0.800
Validation loss decreased (-0.774064 --> -0.799990).  Saving model ...
Epoch: 17 cost time: 0.7202355861663818
Epoch: 17, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.912 Vali Acc: 0.819 Test Loss: 0.912 Test Acc: 0.819
Validation loss decreased (-0.799990 --> -0.818509).  Saving model ...
Epoch: 18 cost time: 0.746755838394165
Epoch: 18, Steps: 2 | Train Loss: 0.726 Vali Loss: 0.852 Vali Acc: 0.822 Test Loss: 0.852 Test Acc: 0.822
Validation loss decreased (-0.818509 --> -0.822214).  Saving model ...
Epoch: 19 cost time: 0.7630043029785156
Epoch: 19, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.794 Vali Acc: 0.841 Test Loss: 0.794 Test Acc: 0.841
Validation loss decreased (-0.822214 --> -0.840733).  Saving model ...
Epoch: 20 cost time: 0.7775986194610596
Epoch: 20, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.740 Vali Acc: 0.844 Test Loss: 0.740 Test Acc: 0.844
Validation loss decreased (-0.840733 --> -0.844437).  Saving model ...
Epoch: 21 cost time: 0.7141985893249512
Epoch: 21, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.690 Vali Acc: 0.859 Test Loss: 0.690 Test Acc: 0.859
Validation loss decreased (-0.844437 --> -0.859252).  Saving model ...
Epoch: 22 cost time: 0.6768269538879395
Epoch: 22, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.644 Vali Acc: 0.878 Test Loss: 0.644 Test Acc: 0.878
Validation loss decreased (-0.859252 --> -0.877771).  Saving model ...
Epoch: 23 cost time: 0.7598254680633545
Epoch: 23, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.601 Vali Acc: 0.900 Test Loss: 0.601 Test Acc: 0.900
Validation loss decreased (-0.877771 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.760230541229248
Epoch: 24, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.562 Vali Acc: 0.907 Test Loss: 0.562 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 25 cost time: 0.7696912288665771
Epoch: 25, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.526 Vali Acc: 0.907 Test Loss: 0.526 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 26 cost time: 0.7482287883758545
Epoch: 26, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.494 Vali Acc: 0.911 Test Loss: 0.494 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 27 cost time: 0.7793915271759033
Epoch: 27, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.467 Vali Acc: 0.919 Test Loss: 0.467 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 28 cost time: 0.774390697479248
Epoch: 28, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.441 Vali Acc: 0.922 Test Loss: 0.441 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 29 cost time: 0.7994043827056885
Epoch: 29, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.420 Vali Acc: 0.922 Test Loss: 0.420 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 30 cost time: 0.7771775722503662
Epoch: 30, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.400 Vali Acc: 0.926 Test Loss: 0.400 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 1390854
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.480637550354004
Epoch: 1, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.857 Vali Acc: 0.126 Test Loss: 1.857 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 0.6870682239532471
Epoch: 2, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.818 Vali Acc: 0.189 Test Loss: 1.818 Test Acc: 0.189
Validation loss decreased (-0.125907 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.7548828125
Epoch: 3, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.786 Vali Acc: 0.215 Test Loss: 1.786 Test Acc: 0.215
Validation loss decreased (-0.188871 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 0.7918868064880371
Epoch: 4, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.751 Vali Acc: 0.244 Test Loss: 1.751 Test Acc: 0.244
Validation loss decreased (-0.214797 --> -0.244427).  Saving model ...
Epoch: 5 cost time: 0.7567048072814941
Epoch: 5, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.705 Vali Acc: 0.307 Test Loss: 1.705 Test Acc: 0.307
Validation loss decreased (-0.244427 --> -0.307390).  Saving model ...
Epoch: 6 cost time: 0.86716628074646
Epoch: 6, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.653 Vali Acc: 0.356 Test Loss: 1.653 Test Acc: 0.356
Validation loss decreased (-0.307390 --> -0.355539).  Saving model ...
Epoch: 7 cost time: 0.7342360019683838
Epoch: 7, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.595 Vali Acc: 0.419 Test Loss: 1.595 Test Acc: 0.419
Validation loss decreased (-0.355539 --> -0.418503).  Saving model ...
Epoch: 8 cost time: 0.7184946537017822
Epoch: 8, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.532 Vali Acc: 0.489 Test Loss: 1.532 Test Acc: 0.489
Validation loss decreased (-0.418503 --> -0.488874).  Saving model ...
Epoch: 9 cost time: 0.7579069137573242
Epoch: 9, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.466 Vali Acc: 0.567 Test Loss: 1.466 Test Acc: 0.567
Validation loss decreased (-0.488874 --> -0.566652).  Saving model ...
Epoch: 10 cost time: 0.8727538585662842
Epoch: 10, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.398 Vali Acc: 0.641 Test Loss: 1.398 Test Acc: 0.641
Validation loss decreased (-0.566652 --> -0.640727).  Saving model ...
Epoch: 11 cost time: 0.8226053714752197
Epoch: 11, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.329 Vali Acc: 0.737 Test Loss: 1.329 Test Acc: 0.737
Validation loss decreased (-0.640727 --> -0.737024).  Saving model ...
Epoch: 12 cost time: 0.7586677074432373
Epoch: 12, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.260 Vali Acc: 0.781 Test Loss: 1.260 Test Acc: 0.781
Validation loss decreased (-0.737024 --> -0.781469).  Saving model ...
Epoch: 13 cost time: 0.8488380908966064
Epoch: 13, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.192 Vali Acc: 0.819 Test Loss: 1.192 Test Acc: 0.819
Validation loss decreased (-0.781469 --> -0.818507).  Saving model ...
Epoch: 14 cost time: 0.8060891628265381
Epoch: 14, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.124 Vali Acc: 0.830 Test Loss: 1.124 Test Acc: 0.830
Validation loss decreased (-0.818507 --> -0.829618).  Saving model ...
Epoch: 15 cost time: 0.7939009666442871
Epoch: 15, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.059 Vali Acc: 0.830 Test Loss: 1.059 Test Acc: 0.830
Validation loss decreased (-0.829618 --> -0.829619).  Saving model ...
Epoch: 16 cost time: 0.8115408420562744
Epoch: 16, Steps: 2 | Train Loss: 0.887 Vali Loss: 0.994 Vali Acc: 0.837 Test Loss: 0.994 Test Acc: 0.837
Validation loss decreased (-0.829619 --> -0.837027).  Saving model ...
Epoch: 17 cost time: 0.7815227508544922
Epoch: 17, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.932 Vali Acc: 0.844 Test Loss: 0.932 Test Acc: 0.844
Validation loss decreased (-0.837027 --> -0.844435).  Saving model ...
Epoch: 18 cost time: 0.7957251071929932
Epoch: 18, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.873 Vali Acc: 0.848 Test Loss: 0.873 Test Acc: 0.848
Validation loss decreased (-0.844435 --> -0.848139).  Saving model ...
Epoch: 19 cost time: 0.8984146118164062
Epoch: 19, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.817 Vali Acc: 0.859 Test Loss: 0.817 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859251).  Saving model ...
Epoch: 20 cost time: 0.8359737396240234
Epoch: 20, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.765 Vali Acc: 0.881 Test Loss: 0.765 Test Acc: 0.881
Validation loss decreased (-0.859251 --> -0.881474).  Saving model ...
Epoch: 21 cost time: 0.8204216957092285
Epoch: 21, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.716 Vali Acc: 0.904 Test Loss: 0.716 Test Acc: 0.904
Validation loss decreased (-0.881474 --> -0.903697).  Saving model ...
Epoch: 22 cost time: 0.7802250385284424
Epoch: 22, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.671 Vali Acc: 0.926 Test Loss: 0.671 Test Acc: 0.926
Validation loss decreased (-0.903697 --> -0.925919).  Saving model ...
Epoch: 23 cost time: 0.8440051078796387
Epoch: 23, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.628 Vali Acc: 0.937 Test Loss: 0.628 Test Acc: 0.937
Validation loss decreased (-0.925919 --> -0.937031).  Saving model ...
Epoch: 24 cost time: 0.8302805423736572
Epoch: 24, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.588 Vali Acc: 0.930 Test Loss: 0.588 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8495960235595703
Epoch: 25, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.550 Vali Acc: 0.933 Test Loss: 0.550 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9402410984039307
Epoch: 26, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.516 Vali Acc: 0.933 Test Loss: 0.516 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8378617763519287
Epoch: 27, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.486 Vali Acc: 0.926 Test Loss: 0.486 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8028337955474854
Epoch: 28, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.458 Vali Acc: 0.930 Test Loss: 0.458 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.802741289138794
Epoch: 29, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.433 Vali Acc: 0.933 Test Loss: 0.433 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7628400325775146
Epoch: 30, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.411 Vali Acc: 0.930 Test Loss: 0.411 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 4701190
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.26076340675354
Epoch: 1, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.842 Vali Acc: 0.104 Test Loss: 1.842 Test Acc: 0.104
Validation loss decreased (inf --> -0.103685).  Saving model ...
Epoch: 2 cost time: 0.6408631801605225
Epoch: 2, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.800 Vali Acc: 0.163 Test Loss: 1.800 Test Acc: 0.163
Validation loss decreased (-0.103685 --> -0.162945).  Saving model ...
Epoch: 3 cost time: 0.6866476535797119
Epoch: 3, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.766 Vali Acc: 0.204 Test Loss: 1.766 Test Acc: 0.204
Validation loss decreased (-0.162945 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.6192607879638672
Epoch: 4, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.730 Vali Acc: 0.241 Test Loss: 1.730 Test Acc: 0.241
Validation loss decreased (-0.203686 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 0.6409242153167725
Epoch: 5, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.685 Vali Acc: 0.311 Test Loss: 1.685 Test Acc: 0.311
Validation loss decreased (-0.240723 --> -0.311094).  Saving model ...
Epoch: 6 cost time: 0.6729879379272461
Epoch: 6, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.632 Vali Acc: 0.407 Test Loss: 1.632 Test Acc: 0.407
Validation loss decreased (-0.311094 --> -0.407391).  Saving model ...
Epoch: 7 cost time: 0.724280595779419
Epoch: 7, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.574 Vali Acc: 0.504 Test Loss: 1.574 Test Acc: 0.504
Validation loss decreased (-0.407391 --> -0.503688).  Saving model ...
Epoch: 8 cost time: 0.6421537399291992
Epoch: 8, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.513 Vali Acc: 0.570 Test Loss: 1.513 Test Acc: 0.570
Validation loss decreased (-0.503688 --> -0.570355).  Saving model ...
Epoch: 9 cost time: 0.7723350524902344
Epoch: 9, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.450 Vali Acc: 0.637 Test Loss: 1.450 Test Acc: 0.637
Validation loss decreased (-0.570355 --> -0.637023).  Saving model ...
Epoch: 10 cost time: 0.6681599617004395
Epoch: 10, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.384 Vali Acc: 0.674 Test Loss: 1.384 Test Acc: 0.674
Validation loss decreased (-0.637023 --> -0.674060).  Saving model ...
Epoch: 11 cost time: 0.6792628765106201
Epoch: 11, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.317 Vali Acc: 0.696 Test Loss: 1.317 Test Acc: 0.696
Validation loss decreased (-0.674060 --> -0.696283).  Saving model ...
Epoch: 12 cost time: 0.5920469760894775
Epoch: 12, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.249 Vali Acc: 0.707 Test Loss: 1.249 Test Acc: 0.707
Validation loss decreased (-0.696283 --> -0.707395).  Saving model ...
Epoch: 13 cost time: 0.6694474220275879
Epoch: 13, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.181 Vali Acc: 0.737 Test Loss: 1.181 Test Acc: 0.737
Validation loss decreased (-0.707395 --> -0.737025).  Saving model ...
Epoch: 14 cost time: 0.6629014015197754
Epoch: 14, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.113 Vali Acc: 0.756 Test Loss: 1.113 Test Acc: 0.756
Validation loss decreased (-0.737025 --> -0.755544).  Saving model ...
Epoch: 15 cost time: 0.6210007667541504
Epoch: 15, Steps: 2 | Train Loss: 0.961 Vali Loss: 1.046 Vali Acc: 0.770 Test Loss: 1.046 Test Acc: 0.770
Validation loss decreased (-0.755544 --> -0.770360).  Saving model ...
Epoch: 16 cost time: 0.6659369468688965
Epoch: 16, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.981 Vali Acc: 0.800 Test Loss: 0.981 Test Acc: 0.800
Validation loss decreased (-0.770360 --> -0.799990).  Saving model ...
Epoch: 17 cost time: 0.6467714309692383
Epoch: 17, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.918 Vali Acc: 0.819 Test Loss: 0.918 Test Acc: 0.819
Validation loss decreased (-0.799990 --> -0.818509).  Saving model ...
Epoch: 18 cost time: 0.637028694152832
Epoch: 18, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.857 Vali Acc: 0.830 Test Loss: 0.857 Test Acc: 0.830
Validation loss decreased (-0.818509 --> -0.829621).  Saving model ...
Epoch: 19 cost time: 0.6689550876617432
Epoch: 19, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.800 Vali Acc: 0.837 Test Loss: 0.800 Test Acc: 0.837
Validation loss decreased (-0.829621 --> -0.837029).  Saving model ...
Epoch: 20 cost time: 0.6865444183349609
Epoch: 20, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.745 Vali Acc: 0.852 Test Loss: 0.745 Test Acc: 0.852
Validation loss decreased (-0.837029 --> -0.851844).  Saving model ...
Epoch: 21 cost time: 0.7572612762451172
Epoch: 21, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
Validation loss decreased (-0.851844 --> -0.855549).  Saving model ...
Epoch: 22 cost time: 0.7574026584625244
Epoch: 22, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.648 Vali Acc: 0.885 Test Loss: 0.648 Test Acc: 0.885
Validation loss decreased (-0.855549 --> -0.885179).  Saving model ...
Epoch: 23 cost time: 0.765446662902832
Epoch: 23, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.605 Vali Acc: 0.900 Test Loss: 0.605 Test Acc: 0.900
Validation loss decreased (-0.885179 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.6455132961273193
Epoch: 24, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.566 Vali Acc: 0.904 Test Loss: 0.566 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 25 cost time: 0.622403621673584
Epoch: 25, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.530 Vali Acc: 0.907 Test Loss: 0.530 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 26 cost time: 0.7649097442626953
Epoch: 26, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.498 Vali Acc: 0.911 Test Loss: 0.498 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 27 cost time: 0.7474744319915771
Epoch: 27, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.470 Vali Acc: 0.919 Test Loss: 0.470 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 28 cost time: 0.7346987724304199
Epoch: 28, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.445 Vali Acc: 0.922 Test Loss: 0.445 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 29 cost time: 0.7253179550170898
Epoch: 29, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.423 Vali Acc: 0.922 Test Loss: 0.423 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 30 cost time: 0.7511703968048096
Epoch: 30, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.403 Vali Acc: 0.933 Test Loss: 0.403 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933329).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 1390854
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.890023946762085
Epoch: 1, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.826 Vali Acc: 0.270 Test Loss: 1.826 Test Acc: 0.270
Validation loss decreased (inf --> -0.270352).  Saving model ...
Epoch: 2 cost time: 0.9935204982757568
Epoch: 2, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.786 Vali Acc: 0.278 Test Loss: 1.786 Test Acc: 0.278
Validation loss decreased (-0.270352 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 0.9825217723846436
Epoch: 3, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.755 Vali Acc: 0.293 Test Loss: 1.755 Test Acc: 0.293
Validation loss decreased (-0.277760 --> -0.292575).  Saving model ...
Epoch: 4 cost time: 0.9183564186096191
Epoch: 4, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.722 Vali Acc: 0.322 Test Loss: 1.722 Test Acc: 0.322
Validation loss decreased (-0.292575 --> -0.322205).  Saving model ...
Epoch: 5 cost time: 0.9692487716674805
Epoch: 5, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.680 Vali Acc: 0.337 Test Loss: 1.680 Test Acc: 0.337
Validation loss decreased (-0.322205 --> -0.337020).  Saving model ...
Epoch: 6 cost time: 0.9175057411193848
Epoch: 6, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.632 Vali Acc: 0.389 Test Loss: 1.632 Test Acc: 0.389
Validation loss decreased (-0.337020 --> -0.388873).  Saving model ...
Epoch: 7 cost time: 0.9500904083251953
Epoch: 7, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.578 Vali Acc: 0.448 Test Loss: 1.578 Test Acc: 0.448
Validation loss decreased (-0.388873 --> -0.448132).  Saving model ...
Epoch: 8 cost time: 0.9187393188476562
Epoch: 8, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.520 Vali Acc: 0.526 Test Loss: 1.520 Test Acc: 0.526
Validation loss decreased (-0.448132 --> -0.525911).  Saving model ...
Epoch: 9 cost time: 0.9511888027191162
Epoch: 9, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.458 Vali Acc: 0.585 Test Loss: 1.458 Test Acc: 0.585
Validation loss decreased (-0.525911 --> -0.585171).  Saving model ...
Epoch: 10 cost time: 0.9395565986633301
Epoch: 10, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.393 Vali Acc: 0.626 Test Loss: 1.393 Test Acc: 0.626
Validation loss decreased (-0.585171 --> -0.625912).  Saving model ...
Epoch: 11 cost time: 0.952216625213623
Epoch: 11, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.328 Vali Acc: 0.693 Test Loss: 1.328 Test Acc: 0.693
Validation loss decreased (-0.625912 --> -0.692579).  Saving model ...
Epoch: 12 cost time: 0.9626460075378418
Epoch: 12, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.261 Vali Acc: 0.789 Test Loss: 1.261 Test Acc: 0.789
Validation loss decreased (-0.692579 --> -0.788876).  Saving model ...
Epoch: 13 cost time: 1.06898832321167
Epoch: 13, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.194 Vali Acc: 0.830 Test Loss: 1.194 Test Acc: 0.830
Validation loss decreased (-0.788876 --> -0.829618).  Saving model ...
Epoch: 14 cost time: 0.9583101272583008
Epoch: 14, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.128 Vali Acc: 0.867 Test Loss: 1.128 Test Acc: 0.867
Validation loss decreased (-0.829618 --> -0.866655).  Saving model ...
Epoch: 15 cost time: 1.0085082054138184
Epoch: 15, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.062 Vali Acc: 0.881 Test Loss: 1.062 Test Acc: 0.881
Validation loss decreased (-0.866655 --> -0.881471).  Saving model ...
Epoch: 16 cost time: 1.0020489692687988
Epoch: 16, Steps: 2 | Train Loss: 0.902 Vali Loss: 0.998 Vali Acc: 0.896 Test Loss: 0.998 Test Acc: 0.896
Validation loss decreased (-0.881471 --> -0.896286).  Saving model ...
Epoch: 17 cost time: 0.9707930088043213
Epoch: 17, Steps: 2 | Train Loss: 0.876 Vali Loss: 0.935 Vali Acc: 0.907 Test Loss: 0.935 Test Acc: 0.907
Validation loss decreased (-0.896286 --> -0.907398).  Saving model ...
Epoch: 18 cost time: 0.945115327835083
Epoch: 18, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.876 Vali Acc: 0.915 Test Loss: 0.876 Test Acc: 0.915
Validation loss decreased (-0.907398 --> -0.914806).  Saving model ...
Epoch: 19 cost time: 0.94344162940979
Epoch: 19, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.818 Vali Acc: 0.919 Test Loss: 0.818 Test Acc: 0.919
Validation loss decreased (-0.914806 --> -0.918510).  Saving model ...
Epoch: 20 cost time: 0.916637659072876
Epoch: 20, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.763 Vali Acc: 0.922 Test Loss: 0.763 Test Acc: 0.922
Validation loss decreased (-0.918510 --> -0.922215).  Saving model ...
Epoch: 21 cost time: 0.999887228012085
Epoch: 21, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.710 Vali Acc: 0.930 Test Loss: 0.710 Test Acc: 0.930
Validation loss decreased (-0.922215 --> -0.929623).  Saving model ...
Epoch: 22 cost time: 0.9944026470184326
Epoch: 22, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.661 Vali Acc: 0.926 Test Loss: 0.661 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0531432628631592
Epoch: 23, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.616 Vali Acc: 0.926 Test Loss: 0.616 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1227922439575195
Epoch: 24, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.575 Vali Acc: 0.922 Test Loss: 0.575 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0063161849975586
Epoch: 25, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.538 Vali Acc: 0.919 Test Loss: 0.538 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0313847064971924
Epoch: 26, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.505 Vali Acc: 0.926 Test Loss: 0.505 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0145330429077148
Epoch: 27, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.475 Vali Acc: 0.915 Test Loss: 0.475 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1463415622711182
Epoch: 28, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.449 Vali Acc: 0.919 Test Loss: 0.449 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2503235340118408
Epoch: 29, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.426 Vali Acc: 0.915 Test Loss: 0.426 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0607364177703857
Epoch: 30, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.405 Vali Acc: 0.919 Test Loss: 0.405 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 2357510
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.507230758666992
Epoch: 1, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.798 Vali Acc: 0.193 Test Loss: 1.798 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.7797603607177734
Epoch: 2, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.763 Vali Acc: 0.237 Test Loss: 1.763 Test Acc: 0.237
Validation loss decreased (-0.192575 --> -0.237019).  Saving model ...
Epoch: 3 cost time: 0.8010191917419434
Epoch: 3, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.735 Vali Acc: 0.263 Test Loss: 1.735 Test Acc: 0.263
Validation loss decreased (-0.237019 --> -0.262946).  Saving model ...
Epoch: 4 cost time: 0.7991106510162354
Epoch: 4, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.705 Vali Acc: 0.296 Test Loss: 1.705 Test Acc: 0.296
Validation loss decreased (-0.262946 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 0.8001484870910645
Epoch: 5, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.669 Vali Acc: 0.330 Test Loss: 1.669 Test Acc: 0.330
Validation loss decreased (-0.296279 --> -0.329613).  Saving model ...
Epoch: 6 cost time: 0.7828512191772461
Epoch: 6, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.625 Vali Acc: 0.404 Test Loss: 1.625 Test Acc: 0.404
Validation loss decreased (-0.329613 --> -0.403687).  Saving model ...
Epoch: 7 cost time: 0.8766274452209473
Epoch: 7, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.577 Vali Acc: 0.430 Test Loss: 1.577 Test Acc: 0.430
Validation loss decreased (-0.403687 --> -0.429614).  Saving model ...
Epoch: 8 cost time: 0.926577091217041
Epoch: 8, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.525 Vali Acc: 0.489 Test Loss: 1.525 Test Acc: 0.489
Validation loss decreased (-0.429614 --> -0.488874).  Saving model ...
Epoch: 9 cost time: 0.9174330234527588
Epoch: 9, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.468 Vali Acc: 0.530 Test Loss: 1.468 Test Acc: 0.530
Validation loss decreased (-0.488874 --> -0.529615).  Saving model ...
Epoch: 10 cost time: 0.8967692852020264
Epoch: 10, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.408 Vali Acc: 0.604 Test Loss: 1.408 Test Acc: 0.604
Validation loss decreased (-0.529615 --> -0.603690).  Saving model ...
Epoch: 11 cost time: 0.9082455635070801
Epoch: 11, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.347 Vali Acc: 0.678 Test Loss: 1.347 Test Acc: 0.678
Validation loss decreased (-0.603690 --> -0.677764).  Saving model ...
Epoch: 12 cost time: 0.9126057624816895
Epoch: 12, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.285 Vali Acc: 0.719 Test Loss: 1.285 Test Acc: 0.719
Validation loss decreased (-0.677764 --> -0.718506).  Saving model ...
Epoch: 13 cost time: 0.9136905670166016
Epoch: 13, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.222 Vali Acc: 0.759 Test Loss: 1.222 Test Acc: 0.759
Validation loss decreased (-0.718506 --> -0.759247).  Saving model ...
Epoch: 14 cost time: 0.952354907989502
Epoch: 14, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.158 Vali Acc: 0.781 Test Loss: 1.158 Test Acc: 0.781
Validation loss decreased (-0.759247 --> -0.781470).  Saving model ...
Epoch: 15 cost time: 0.784337043762207
Epoch: 15, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.095 Vali Acc: 0.826 Test Loss: 1.095 Test Acc: 0.826
Validation loss decreased (-0.781470 --> -0.825915).  Saving model ...
Epoch: 16 cost time: 0.9336793422698975
Epoch: 16, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.032 Vali Acc: 0.852 Test Loss: 1.032 Test Acc: 0.852
Validation loss decreased (-0.825915 --> -0.851842).  Saving model ...
Epoch: 17 cost time: 0.9121866226196289
Epoch: 17, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.972 Vali Acc: 0.867 Test Loss: 0.972 Test Acc: 0.867
Validation loss decreased (-0.851842 --> -0.866657).  Saving model ...
Epoch: 18 cost time: 0.9374871253967285
Epoch: 18, Steps: 2 | Train Loss: 0.802 Vali Loss: 0.915 Vali Acc: 0.870 Test Loss: 0.915 Test Acc: 0.870
Validation loss decreased (-0.866657 --> -0.870361).  Saving model ...
Epoch: 19 cost time: 0.8855698108673096
Epoch: 19, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.858 Vali Acc: 0.889 Test Loss: 0.858 Test Acc: 0.889
Validation loss decreased (-0.870361 --> -0.888880).  Saving model ...
Epoch: 20 cost time: 1.0411992073059082
Epoch: 20, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.804 Vali Acc: 0.896 Test Loss: 0.804 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896288).  Saving model ...
Epoch: 21 cost time: 0.920872688293457
Epoch: 21, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.752 Vali Acc: 0.904 Test Loss: 0.752 Test Acc: 0.904
Validation loss decreased (-0.896288 --> -0.903696).  Saving model ...
Epoch: 22 cost time: 0.9752001762390137
Epoch: 22, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.701 Vali Acc: 0.907 Test Loss: 0.701 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907400).  Saving model ...
Epoch: 23 cost time: 0.9691948890686035
Epoch: 23, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.655 Vali Acc: 0.907 Test Loss: 0.655 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 24 cost time: 0.9649190902709961
Epoch: 24, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.612 Vali Acc: 0.911 Test Loss: 0.612 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 25 cost time: 0.8864092826843262
Epoch: 25, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.574 Vali Acc: 0.907 Test Loss: 0.574 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9323785305023193
Epoch: 26, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.539 Vali Acc: 0.915 Test Loss: 0.539 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 27 cost time: 0.8947100639343262
Epoch: 27, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.507 Vali Acc: 0.911 Test Loss: 0.507 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9265458583831787
Epoch: 28, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.479 Vali Acc: 0.911 Test Loss: 0.479 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8875942230224609
Epoch: 29, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.453 Vali Acc: 0.911 Test Loss: 0.453 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.879241943359375
Epoch: 30, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.430 Vali Acc: 0.911 Test Loss: 0.430 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 702214
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6666412353515625
Epoch: 1, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.826 Vali Acc: 0.270 Test Loss: 1.826 Test Acc: 0.270
Validation loss decreased (inf --> -0.270352).  Saving model ...
Epoch: 2 cost time: 0.8630197048187256
Epoch: 2, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.785 Vali Acc: 0.278 Test Loss: 1.785 Test Acc: 0.278
Validation loss decreased (-0.270352 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 0.8675312995910645
Epoch: 3, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.754 Vali Acc: 0.293 Test Loss: 1.754 Test Acc: 0.293
Validation loss decreased (-0.277760 --> -0.292575).  Saving model ...
Epoch: 4 cost time: 0.728632926940918
Epoch: 4, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.722 Vali Acc: 0.322 Test Loss: 1.722 Test Acc: 0.322
Validation loss decreased (-0.292575 --> -0.322205).  Saving model ...
Epoch: 5 cost time: 0.9037821292877197
Epoch: 5, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.680 Vali Acc: 0.337 Test Loss: 1.680 Test Acc: 0.337
Validation loss decreased (-0.322205 --> -0.337020).  Saving model ...
Epoch: 6 cost time: 0.8775975704193115
Epoch: 6, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.632 Vali Acc: 0.389 Test Loss: 1.632 Test Acc: 0.389
Validation loss decreased (-0.337020 --> -0.388873).  Saving model ...
Epoch: 7 cost time: 0.8613979816436768
Epoch: 7, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.578 Vali Acc: 0.448 Test Loss: 1.578 Test Acc: 0.448
Validation loss decreased (-0.388873 --> -0.448132).  Saving model ...
Epoch: 8 cost time: 0.8259589672088623
Epoch: 8, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.520 Vali Acc: 0.526 Test Loss: 1.520 Test Acc: 0.526
Validation loss decreased (-0.448132 --> -0.525911).  Saving model ...
Epoch: 9 cost time: 0.7380309104919434
Epoch: 9, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.458 Vali Acc: 0.585 Test Loss: 1.458 Test Acc: 0.585
Validation loss decreased (-0.525911 --> -0.585171).  Saving model ...
Epoch: 10 cost time: 0.8519387245178223
Epoch: 10, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.393 Vali Acc: 0.626 Test Loss: 1.393 Test Acc: 0.626
Validation loss decreased (-0.585171 --> -0.625912).  Saving model ...
Epoch: 11 cost time: 0.8746516704559326
Epoch: 11, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.328 Vali Acc: 0.693 Test Loss: 1.328 Test Acc: 0.693
Validation loss decreased (-0.625912 --> -0.692579).  Saving model ...
Epoch: 12 cost time: 0.8614182472229004
Epoch: 12, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.261 Vali Acc: 0.789 Test Loss: 1.261 Test Acc: 0.789
Validation loss decreased (-0.692579 --> -0.788876).  Saving model ...
Epoch: 13 cost time: 0.8974168300628662
Epoch: 13, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.194 Vali Acc: 0.830 Test Loss: 1.194 Test Acc: 0.830
Validation loss decreased (-0.788876 --> -0.829618).  Saving model ...
Epoch: 14 cost time: 0.8948953151702881
Epoch: 14, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.128 Vali Acc: 0.867 Test Loss: 1.128 Test Acc: 0.867
Validation loss decreased (-0.829618 --> -0.866655).  Saving model ...
Epoch: 15 cost time: 0.971895694732666
Epoch: 15, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.062 Vali Acc: 0.881 Test Loss: 1.062 Test Acc: 0.881
Validation loss decreased (-0.866655 --> -0.881471).  Saving model ...
Epoch: 16 cost time: 0.9286675453186035
Epoch: 16, Steps: 2 | Train Loss: 0.902 Vali Loss: 0.998 Vali Acc: 0.896 Test Loss: 0.998 Test Acc: 0.896
Validation loss decreased (-0.881471 --> -0.896286).  Saving model ...
Epoch: 17 cost time: 0.9083302021026611
Epoch: 17, Steps: 2 | Train Loss: 0.876 Vali Loss: 0.935 Vali Acc: 0.907 Test Loss: 0.935 Test Acc: 0.907
Validation loss decreased (-0.896286 --> -0.907398).  Saving model ...
Epoch: 18 cost time: 1.0950727462768555
Epoch: 18, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.876 Vali Acc: 0.915 Test Loss: 0.876 Test Acc: 0.915
Validation loss decreased (-0.907398 --> -0.914806).  Saving model ...
Epoch: 19 cost time: 1.028224229812622
Epoch: 19, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.818 Vali Acc: 0.919 Test Loss: 0.818 Test Acc: 0.919
Validation loss decreased (-0.914806 --> -0.918510).  Saving model ...
Epoch: 20 cost time: 0.994300127029419
Epoch: 20, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.763 Vali Acc: 0.922 Test Loss: 0.763 Test Acc: 0.922
Validation loss decreased (-0.918510 --> -0.922215).  Saving model ...
Epoch: 21 cost time: 0.958228588104248
Epoch: 21, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.710 Vali Acc: 0.930 Test Loss: 0.710 Test Acc: 0.930
Validation loss decreased (-0.922215 --> -0.929623).  Saving model ...
Epoch: 22 cost time: 0.95558762550354
Epoch: 22, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.661 Vali Acc: 0.926 Test Loss: 0.661 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.965233325958252
Epoch: 23, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.616 Vali Acc: 0.926 Test Loss: 0.616 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.992088794708252
Epoch: 24, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.575 Vali Acc: 0.922 Test Loss: 0.575 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0760838985443115
Epoch: 25, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.538 Vali Acc: 0.919 Test Loss: 0.538 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.990185022354126
Epoch: 26, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.504 Vali Acc: 0.926 Test Loss: 0.504 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9818398952484131
Epoch: 27, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.475 Vali Acc: 0.915 Test Loss: 0.475 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.036829948425293
Epoch: 28, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.449 Vali Acc: 0.915 Test Loss: 0.449 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9488592147827148
Epoch: 29, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.426 Vali Acc: 0.915 Test Loss: 0.426 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0526316165924072
Epoch: 30, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.405 Vali Acc: 0.919 Test Loss: 0.405 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 2357510
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.515679121017456
Epoch: 1, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.798 Vali Acc: 0.193 Test Loss: 1.798 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.7328519821166992
Epoch: 2, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.763 Vali Acc: 0.237 Test Loss: 1.763 Test Acc: 0.237
Validation loss decreased (-0.192575 --> -0.237019).  Saving model ...
Epoch: 3 cost time: 0.7055110931396484
Epoch: 3, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.735 Vali Acc: 0.263 Test Loss: 1.735 Test Acc: 0.263
Validation loss decreased (-0.237019 --> -0.262946).  Saving model ...
Epoch: 4 cost time: 0.7544076442718506
Epoch: 4, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.705 Vali Acc: 0.296 Test Loss: 1.705 Test Acc: 0.296
Validation loss decreased (-0.262946 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 0.7384283542633057
Epoch: 5, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.669 Vali Acc: 0.330 Test Loss: 1.669 Test Acc: 0.330
Validation loss decreased (-0.296279 --> -0.329613).  Saving model ...
Epoch: 6 cost time: 0.7944526672363281
Epoch: 6, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.625 Vali Acc: 0.404 Test Loss: 1.625 Test Acc: 0.404
Validation loss decreased (-0.329613 --> -0.403687).  Saving model ...
Epoch: 7 cost time: 0.7147500514984131
Epoch: 7, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.577 Vali Acc: 0.430 Test Loss: 1.577 Test Acc: 0.430
Validation loss decreased (-0.403687 --> -0.429614).  Saving model ...
Epoch: 8 cost time: 0.7786173820495605
Epoch: 8, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.525 Vali Acc: 0.489 Test Loss: 1.525 Test Acc: 0.489
Validation loss decreased (-0.429614 --> -0.488874).  Saving model ...
Epoch: 9 cost time: 0.6721770763397217
Epoch: 9, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.468 Vali Acc: 0.530 Test Loss: 1.468 Test Acc: 0.530
Validation loss decreased (-0.488874 --> -0.529615).  Saving model ...
Epoch: 10 cost time: 0.7530109882354736
Epoch: 10, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.408 Vali Acc: 0.604 Test Loss: 1.408 Test Acc: 0.604
Validation loss decreased (-0.529615 --> -0.603690).  Saving model ...
Epoch: 11 cost time: 0.7631962299346924
Epoch: 11, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.347 Vali Acc: 0.678 Test Loss: 1.347 Test Acc: 0.678
Validation loss decreased (-0.603690 --> -0.677764).  Saving model ...
Epoch: 12 cost time: 0.7349576950073242
Epoch: 12, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.285 Vali Acc: 0.719 Test Loss: 1.285 Test Acc: 0.719
Validation loss decreased (-0.677764 --> -0.718506).  Saving model ...
Epoch: 13 cost time: 0.7314889430999756
Epoch: 13, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.222 Vali Acc: 0.759 Test Loss: 1.222 Test Acc: 0.759
Validation loss decreased (-0.718506 --> -0.759247).  Saving model ...
Epoch: 14 cost time: 0.711815595626831
Epoch: 14, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.158 Vali Acc: 0.781 Test Loss: 1.158 Test Acc: 0.781
Validation loss decreased (-0.759247 --> -0.781470).  Saving model ...
Epoch: 15 cost time: 0.7660772800445557
Epoch: 15, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.095 Vali Acc: 0.826 Test Loss: 1.095 Test Acc: 0.826
Validation loss decreased (-0.781470 --> -0.825915).  Saving model ...
Epoch: 16 cost time: 0.7376086711883545
Epoch: 16, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.032 Vali Acc: 0.852 Test Loss: 1.032 Test Acc: 0.852
Validation loss decreased (-0.825915 --> -0.851842).  Saving model ...
Epoch: 17 cost time: 0.7703666687011719
Epoch: 17, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.972 Vali Acc: 0.867 Test Loss: 0.972 Test Acc: 0.867
Validation loss decreased (-0.851842 --> -0.866657).  Saving model ...
Epoch: 18 cost time: 0.7608003616333008
Epoch: 18, Steps: 2 | Train Loss: 0.802 Vali Loss: 0.915 Vali Acc: 0.870 Test Loss: 0.915 Test Acc: 0.870
Validation loss decreased (-0.866657 --> -0.870361).  Saving model ...
Epoch: 19 cost time: 0.7142939567565918
Epoch: 19, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.858 Vali Acc: 0.889 Test Loss: 0.858 Test Acc: 0.889
Validation loss decreased (-0.870361 --> -0.888880).  Saving model ...
Epoch: 20 cost time: 0.7694315910339355
Epoch: 20, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.804 Vali Acc: 0.896 Test Loss: 0.804 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896288).  Saving model ...
Epoch: 21 cost time: 0.9207746982574463
Epoch: 21, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.752 Vali Acc: 0.904 Test Loss: 0.752 Test Acc: 0.904
Validation loss decreased (-0.896288 --> -0.903696).  Saving model ...
Epoch: 22 cost time: 0.8124005794525146
Epoch: 22, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.701 Vali Acc: 0.907 Test Loss: 0.701 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907400).  Saving model ...
Epoch: 23 cost time: 0.8471560478210449
Epoch: 23, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.655 Vali Acc: 0.907 Test Loss: 0.655 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 24 cost time: 0.8480372428894043
Epoch: 24, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.612 Vali Acc: 0.911 Test Loss: 0.612 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 25 cost time: 0.8295660018920898
Epoch: 25, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.574 Vali Acc: 0.907 Test Loss: 0.574 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8861756324768066
Epoch: 26, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.539 Vali Acc: 0.915 Test Loss: 0.539 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 27 cost time: 0.8902106285095215
Epoch: 27, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.507 Vali Acc: 0.911 Test Loss: 0.507 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7207446098327637
Epoch: 28, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.479 Vali Acc: 0.911 Test Loss: 0.479 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8026933670043945
Epoch: 29, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.453 Vali Acc: 0.911 Test Loss: 0.453 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8174417018890381
Epoch: 30, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.430 Vali Acc: 0.911 Test Loss: 0.430 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 702214
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.532486915588379
Epoch: 1, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.825 Vali Acc: 0.270 Test Loss: 1.825 Test Acc: 0.270
Validation loss decreased (inf --> -0.270352).  Saving model ...
Epoch: 2 cost time: 0.7304232120513916
Epoch: 2, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.785 Vali Acc: 0.281 Test Loss: 1.785 Test Acc: 0.281
Validation loss decreased (-0.270352 --> -0.281464).  Saving model ...
Epoch: 3 cost time: 0.7378542423248291
Epoch: 3, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.754 Vali Acc: 0.296 Test Loss: 1.754 Test Acc: 0.296
Validation loss decreased (-0.281464 --> -0.296279).  Saving model ...
Epoch: 4 cost time: 0.7425227165222168
Epoch: 4, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.721 Vali Acc: 0.322 Test Loss: 1.721 Test Acc: 0.322
Validation loss decreased (-0.296279 --> -0.322205).  Saving model ...
Epoch: 5 cost time: 0.8013901710510254
Epoch: 5, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.680 Vali Acc: 0.337 Test Loss: 1.680 Test Acc: 0.337
Validation loss decreased (-0.322205 --> -0.337020).  Saving model ...
Epoch: 6 cost time: 0.7210643291473389
Epoch: 6, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.633 Vali Acc: 0.389 Test Loss: 1.633 Test Acc: 0.389
Validation loss decreased (-0.337020 --> -0.388873).  Saving model ...
Epoch: 7 cost time: 0.6970438957214355
Epoch: 7, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.579 Vali Acc: 0.448 Test Loss: 1.579 Test Acc: 0.448
Validation loss decreased (-0.388873 --> -0.448132).  Saving model ...
Epoch: 8 cost time: 0.7617130279541016
Epoch: 8, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.522 Vali Acc: 0.522 Test Loss: 1.522 Test Acc: 0.522
Validation loss decreased (-0.448132 --> -0.522207).  Saving model ...
Epoch: 9 cost time: 0.7872357368469238
Epoch: 9, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.460 Vali Acc: 0.585 Test Loss: 1.460 Test Acc: 0.585
Validation loss decreased (-0.522207 --> -0.585171).  Saving model ...
Epoch: 10 cost time: 0.7058901786804199
Epoch: 10, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.397 Vali Acc: 0.626 Test Loss: 1.397 Test Acc: 0.626
Validation loss decreased (-0.585171 --> -0.625912).  Saving model ...
Epoch: 11 cost time: 0.7073700428009033
Epoch: 11, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.332 Vali Acc: 0.693 Test Loss: 1.332 Test Acc: 0.693
Validation loss decreased (-0.625912 --> -0.692579).  Saving model ...
Epoch: 12 cost time: 0.69382643699646
Epoch: 12, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.265 Vali Acc: 0.789 Test Loss: 1.265 Test Acc: 0.789
Validation loss decreased (-0.692579 --> -0.788876).  Saving model ...
Epoch: 13 cost time: 0.695152997970581
Epoch: 13, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.199 Vali Acc: 0.830 Test Loss: 1.199 Test Acc: 0.830
Validation loss decreased (-0.788876 --> -0.829618).  Saving model ...
Epoch: 14 cost time: 0.7745411396026611
Epoch: 14, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.133 Vali Acc: 0.867 Test Loss: 1.133 Test Acc: 0.867
Validation loss decreased (-0.829618 --> -0.866655).  Saving model ...
Epoch: 15 cost time: 0.8295156955718994
Epoch: 15, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.068 Vali Acc: 0.881 Test Loss: 1.068 Test Acc: 0.881
Validation loss decreased (-0.866655 --> -0.881471).  Saving model ...
Epoch: 16 cost time: 0.6946954727172852
Epoch: 16, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.003 Vali Acc: 0.896 Test Loss: 1.003 Test Acc: 0.896
Validation loss decreased (-0.881471 --> -0.896286).  Saving model ...
Epoch: 17 cost time: 0.6817090511322021
Epoch: 17, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.941 Vali Acc: 0.907 Test Loss: 0.941 Test Acc: 0.907
Validation loss decreased (-0.896286 --> -0.907398).  Saving model ...
Epoch: 18 cost time: 0.7366325855255127
Epoch: 18, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.881 Vali Acc: 0.911 Test Loss: 0.881 Test Acc: 0.911
Validation loss decreased (-0.907398 --> -0.911102).  Saving model ...
Epoch: 19 cost time: 0.7040903568267822
Epoch: 19, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.823 Vali Acc: 0.919 Test Loss: 0.823 Test Acc: 0.919
Validation loss decreased (-0.911102 --> -0.918510).  Saving model ...
Epoch: 20 cost time: 0.7468526363372803
Epoch: 20, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.768 Vali Acc: 0.930 Test Loss: 0.768 Test Acc: 0.930
Validation loss decreased (-0.918510 --> -0.929622).  Saving model ...
Epoch: 21 cost time: 0.705420732498169
Epoch: 21, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.714 Vali Acc: 0.930 Test Loss: 0.714 Test Acc: 0.930
Validation loss decreased (-0.929622 --> -0.929622).  Saving model ...
Epoch: 22 cost time: 0.7119166851043701
Epoch: 22, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.664 Vali Acc: 0.926 Test Loss: 0.664 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7533509731292725
Epoch: 23, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.617 Vali Acc: 0.926 Test Loss: 0.617 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.720656156539917
Epoch: 24, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.575 Vali Acc: 0.930 Test Loss: 0.575 Test Acc: 0.930
Validation loss decreased (-0.929622 --> -0.929624).  Saving model ...
Epoch: 25 cost time: 0.686967134475708
Epoch: 25, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.536 Vali Acc: 0.926 Test Loss: 0.536 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7038986682891846
Epoch: 26, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.502 Vali Acc: 0.933 Test Loss: 0.502 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 27 cost time: 0.8033037185668945
Epoch: 27, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.470 Vali Acc: 0.930 Test Loss: 0.470 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7357981204986572
Epoch: 28, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.443 Vali Acc: 0.930 Test Loss: 0.443 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7177181243896484
Epoch: 29, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.419 Vali Acc: 0.933 Test Loss: 0.419 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 30 cost time: 0.7802159786224365
Epoch: 30, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.397 Vali Acc: 0.930 Test Loss: 0.397 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 2357510
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4113662242889404
Epoch: 1, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.796 Vali Acc: 0.196 Test Loss: 1.796 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.6291141510009766
Epoch: 2, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.761 Vali Acc: 0.237 Test Loss: 1.761 Test Acc: 0.237
Validation loss decreased (-0.196278 --> -0.237019).  Saving model ...
Epoch: 3 cost time: 0.663153886795044
Epoch: 3, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.734 Vali Acc: 0.263 Test Loss: 1.734 Test Acc: 0.263
Validation loss decreased (-0.237019 --> -0.262946).  Saving model ...
Epoch: 4 cost time: 0.6541953086853027
Epoch: 4, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.704 Vali Acc: 0.300 Test Loss: 1.704 Test Acc: 0.300
Validation loss decreased (-0.262946 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 0.6266460418701172
Epoch: 5, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.667 Vali Acc: 0.333 Test Loss: 1.667 Test Acc: 0.333
Validation loss decreased (-0.299983 --> -0.333317).  Saving model ...
Epoch: 6 cost time: 0.5148279666900635
Epoch: 6, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.624 Vali Acc: 0.404 Test Loss: 1.624 Test Acc: 0.404
Validation loss decreased (-0.333317 --> -0.403687).  Saving model ...
Epoch: 7 cost time: 0.5338649749755859
Epoch: 7, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.576 Vali Acc: 0.430 Test Loss: 1.576 Test Acc: 0.430
Validation loss decreased (-0.403687 --> -0.429614).  Saving model ...
Epoch: 8 cost time: 0.5345792770385742
Epoch: 8, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.524 Vali Acc: 0.493 Test Loss: 1.524 Test Acc: 0.493
Validation loss decreased (-0.429614 --> -0.492577).  Saving model ...
Epoch: 9 cost time: 0.5799918174743652
Epoch: 9, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.467 Vali Acc: 0.541 Test Loss: 1.467 Test Acc: 0.541
Validation loss decreased (-0.492577 --> -0.540726).  Saving model ...
Epoch: 10 cost time: 0.6123020648956299
Epoch: 10, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.408 Vali Acc: 0.619 Test Loss: 1.408 Test Acc: 0.619
Validation loss decreased (-0.540726 --> -0.618504).  Saving model ...
Epoch: 11 cost time: 0.6724169254302979
Epoch: 11, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.347 Vali Acc: 0.681 Test Loss: 1.347 Test Acc: 0.681
Validation loss decreased (-0.618504 --> -0.681468).  Saving model ...
Epoch: 12 cost time: 0.635183572769165
Epoch: 12, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.285 Vali Acc: 0.722 Test Loss: 1.285 Test Acc: 0.722
Validation loss decreased (-0.681468 --> -0.722209).  Saving model ...
Epoch: 13 cost time: 0.630124568939209
Epoch: 13, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.222 Vali Acc: 0.756 Test Loss: 1.222 Test Acc: 0.756
Validation loss decreased (-0.722209 --> -0.755543).  Saving model ...
Epoch: 14 cost time: 0.6504387855529785
Epoch: 14, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.159 Vali Acc: 0.785 Test Loss: 1.159 Test Acc: 0.785
Validation loss decreased (-0.755543 --> -0.785174).  Saving model ...
Epoch: 15 cost time: 0.6144487857818604
Epoch: 15, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.096 Vali Acc: 0.822 Test Loss: 1.096 Test Acc: 0.822
Validation loss decreased (-0.785174 --> -0.822211).  Saving model ...
Epoch: 16 cost time: 0.6819660663604736
Epoch: 16, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.033 Vali Acc: 0.852 Test Loss: 1.033 Test Acc: 0.852
Validation loss decreased (-0.822211 --> -0.851842).  Saving model ...
Epoch: 17 cost time: 0.6101617813110352
Epoch: 17, Steps: 2 | Train Loss: 0.876 Vali Loss: 0.974 Vali Acc: 0.863 Test Loss: 0.974 Test Acc: 0.863
Validation loss decreased (-0.851842 --> -0.862953).  Saving model ...
Epoch: 18 cost time: 0.5654201507568359
Epoch: 18, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.916 Vali Acc: 0.867 Test Loss: 0.916 Test Acc: 0.867
Validation loss decreased (-0.862953 --> -0.866658).  Saving model ...
Epoch: 19 cost time: 0.6638729572296143
Epoch: 19, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.860 Vali Acc: 0.889 Test Loss: 0.860 Test Acc: 0.889
Validation loss decreased (-0.866658 --> -0.888880).  Saving model ...
Epoch: 20 cost time: 0.6539032459259033
Epoch: 20, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.805 Vali Acc: 0.893 Test Loss: 0.805 Test Acc: 0.893
Validation loss decreased (-0.888880 --> -0.892585).  Saving model ...
Epoch: 21 cost time: 0.6251053810119629
Epoch: 21, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.753 Vali Acc: 0.900 Test Loss: 0.753 Test Acc: 0.900
Validation loss decreased (-0.892585 --> -0.899992).  Saving model ...
Epoch: 22 cost time: 0.7304708957672119
Epoch: 22, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.702 Vali Acc: 0.904 Test Loss: 0.702 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903697).  Saving model ...
Epoch: 23 cost time: 0.7064685821533203
Epoch: 23, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.656 Vali Acc: 0.907 Test Loss: 0.656 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 24 cost time: 0.650219202041626
Epoch: 24, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.613 Vali Acc: 0.907 Test Loss: 0.613 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 25 cost time: 0.7024779319763184
Epoch: 25, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.574 Vali Acc: 0.907 Test Loss: 0.574 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 26 cost time: 0.723092794418335
Epoch: 26, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.539 Vali Acc: 0.915 Test Loss: 0.539 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914809).  Saving model ...
Epoch: 27 cost time: 0.7127187252044678
Epoch: 27, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.507 Vali Acc: 0.911 Test Loss: 0.507 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7133352756500244
Epoch: 28, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.478 Vali Acc: 0.911 Test Loss: 0.478 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6888132095336914
Epoch: 29, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.453 Vali Acc: 0.911 Test Loss: 0.453 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7209980487823486
Epoch: 30, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.430 Vali Acc: 0.911 Test Loss: 0.430 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 702214
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0786943435668945
Epoch: 1, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.836 Vali Acc: 0.170 Test Loss: 1.836 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 1.0472209453582764
Epoch: 2, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.811 Vali Acc: 0.200 Test Loss: 1.811 Test Acc: 0.200
Validation loss decreased (-0.170352 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 1.0759813785552979
Epoch: 3, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.792 Vali Acc: 0.222 Test Loss: 1.792 Test Acc: 0.222
Validation loss decreased (-0.199982 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 1.1102583408355713
Epoch: 4, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.773 Vali Acc: 0.241 Test Loss: 1.773 Test Acc: 0.241
Validation loss decreased (-0.222204 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 1.0880961418151855
Epoch: 5, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.748 Vali Acc: 0.274 Test Loss: 1.748 Test Acc: 0.274
Validation loss decreased (-0.240723 --> -0.274057).  Saving model ...
Epoch: 6 cost time: 1.0569329261779785
Epoch: 6, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.720 Vali Acc: 0.319 Test Loss: 1.720 Test Acc: 0.319
Validation loss decreased (-0.274057 --> -0.318501).  Saving model ...
Epoch: 7 cost time: 0.9408626556396484
Epoch: 7, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.688 Vali Acc: 0.341 Test Loss: 1.688 Test Acc: 0.341
Validation loss decreased (-0.318501 --> -0.340724).  Saving model ...
Epoch: 8 cost time: 1.0119578838348389
Epoch: 8, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.653 Vali Acc: 0.385 Test Loss: 1.653 Test Acc: 0.385
Validation loss decreased (-0.340724 --> -0.385169).  Saving model ...
Epoch: 9 cost time: 1.1163513660430908
Epoch: 9, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.616 Vali Acc: 0.452 Test Loss: 1.616 Test Acc: 0.452
Validation loss decreased (-0.385169 --> -0.451836).  Saving model ...
Epoch: 10 cost time: 1.0951414108276367
Epoch: 10, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.578 Vali Acc: 0.493 Test Loss: 1.578 Test Acc: 0.493
Validation loss decreased (-0.451836 --> -0.492577).  Saving model ...
Epoch: 11 cost time: 1.0308430194854736
Epoch: 11, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.537 Vali Acc: 0.537 Test Loss: 1.537 Test Acc: 0.537
Validation loss decreased (-0.492577 --> -0.537022).  Saving model ...
Epoch: 12 cost time: 1.1463332176208496
Epoch: 12, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.495 Vali Acc: 0.589 Test Loss: 1.495 Test Acc: 0.589
Validation loss decreased (-0.537022 --> -0.588874).  Saving model ...
Epoch: 13 cost time: 1.1367743015289307
Epoch: 13, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.452 Vali Acc: 0.637 Test Loss: 1.452 Test Acc: 0.637
Validation loss decreased (-0.588874 --> -0.637023).  Saving model ...
Epoch: 14 cost time: 1.046609878540039
Epoch: 14, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.407 Vali Acc: 0.689 Test Loss: 1.407 Test Acc: 0.689
Validation loss decreased (-0.637023 --> -0.688875).  Saving model ...
Epoch: 15 cost time: 1.0222549438476562
Epoch: 15, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.363 Vali Acc: 0.719 Test Loss: 1.363 Test Acc: 0.719
Validation loss decreased (-0.688875 --> -0.718505).  Saving model ...
Epoch: 16 cost time: 1.0529296398162842
Epoch: 16, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.317 Vali Acc: 0.741 Test Loss: 1.317 Test Acc: 0.741
Validation loss decreased (-0.718505 --> -0.740728).  Saving model ...
Epoch: 17 cost time: 1.104130744934082
Epoch: 17, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.272 Vali Acc: 0.752 Test Loss: 1.272 Test Acc: 0.752
Validation loss decreased (-0.740728 --> -0.751839).  Saving model ...
Epoch: 18 cost time: 1.1490354537963867
Epoch: 18, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.227 Vali Acc: 0.770 Test Loss: 1.227 Test Acc: 0.770
Validation loss decreased (-0.751839 --> -0.770358).  Saving model ...
Epoch: 19 cost time: 1.1048529148101807
Epoch: 19, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.181 Vali Acc: 0.796 Test Loss: 1.181 Test Acc: 0.796
Validation loss decreased (-0.770358 --> -0.796284).  Saving model ...
Epoch: 20 cost time: 1.0607194900512695
Epoch: 20, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.136 Vali Acc: 0.807 Test Loss: 1.136 Test Acc: 0.807
Validation loss decreased (-0.796284 --> -0.807396).  Saving model ...
Epoch: 21 cost time: 1.0552723407745361
Epoch: 21, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.090 Vali Acc: 0.807 Test Loss: 1.090 Test Acc: 0.807
Validation loss decreased (-0.807396 --> -0.807397).  Saving model ...
Epoch: 22 cost time: 1.0800807476043701
Epoch: 22, Steps: 2 | Train Loss: 0.880 Vali Loss: 1.046 Vali Acc: 0.830 Test Loss: 1.046 Test Acc: 0.830
Validation loss decreased (-0.807397 --> -0.829619).  Saving model ...
Epoch: 23 cost time: 1.0299334526062012
Epoch: 23, Steps: 2 | Train Loss: 0.798 Vali Loss: 1.002 Vali Acc: 0.841 Test Loss: 1.002 Test Acc: 0.841
Validation loss decreased (-0.829619 --> -0.840731).  Saving model ...
Epoch: 24 cost time: 1.0883805751800537
Epoch: 24, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.960 Vali Acc: 0.848 Test Loss: 0.960 Test Acc: 0.848
Validation loss decreased (-0.840731 --> -0.848139).  Saving model ...
Epoch: 25 cost time: 1.1293995380401611
Epoch: 25, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.919 Vali Acc: 0.848 Test Loss: 0.919 Test Acc: 0.848
Validation loss decreased (-0.848139 --> -0.848139).  Saving model ...
Epoch: 26 cost time: 1.0728490352630615
Epoch: 26, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.880 Vali Acc: 0.856 Test Loss: 0.880 Test Acc: 0.856
Validation loss decreased (-0.848139 --> -0.855547).  Saving model ...
Epoch: 27 cost time: 0.9374740123748779
Epoch: 27, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.843 Vali Acc: 0.867 Test Loss: 0.843 Test Acc: 0.867
Validation loss decreased (-0.855547 --> -0.866658).  Saving model ...
Epoch: 28 cost time: 1.117279291152954
Epoch: 28, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.808 Vali Acc: 0.870 Test Loss: 0.808 Test Acc: 0.870
Validation loss decreased (-0.866658 --> -0.870362).  Saving model ...
Epoch: 29 cost time: 1.1397905349731445
Epoch: 29, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.775 Vali Acc: 0.870 Test Loss: 0.775 Test Acc: 0.870
Validation loss decreased (-0.870362 --> -0.870363).  Saving model ...
Epoch: 30 cost time: 1.0861737728118896
Epoch: 30, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.744 Vali Acc: 0.870 Test Loss: 0.744 Test Acc: 0.870
Validation loss decreased (-0.870363 --> -0.870363).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8703703703703703
model parameter : 2351366
model size : 9.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6840457916259766
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.685 Vali Acc: 0.311 Test Loss: 1.685 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 0.8934335708618164
Epoch: 2, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.659 Vali Acc: 0.315 Test Loss: 1.659 Test Acc: 0.315
Validation loss decreased (-0.311094 --> -0.314798).  Saving model ...
Epoch: 3 cost time: 0.8802096843719482
Epoch: 3, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.639 Vali Acc: 0.319 Test Loss: 1.639 Test Acc: 0.319
Validation loss decreased (-0.314798 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.869055986404419
Epoch: 4, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.621 Vali Acc: 0.333 Test Loss: 1.621 Test Acc: 0.333
Validation loss decreased (-0.318502 --> -0.333317).  Saving model ...
Epoch: 5 cost time: 0.8794617652893066
Epoch: 5, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.597 Vali Acc: 0.341 Test Loss: 1.597 Test Acc: 0.341
Validation loss decreased (-0.333317 --> -0.340725).  Saving model ...
Epoch: 6 cost time: 0.9404287338256836
Epoch: 6, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.569 Vali Acc: 0.352 Test Loss: 1.569 Test Acc: 0.352
Validation loss decreased (-0.340725 --> -0.351836).  Saving model ...
Epoch: 7 cost time: 0.8843345642089844
Epoch: 7, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.538 Vali Acc: 0.370 Test Loss: 1.538 Test Acc: 0.370
Validation loss decreased (-0.351836 --> -0.370355).  Saving model ...
Epoch: 8 cost time: 0.8609888553619385
Epoch: 8, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.506 Vali Acc: 0.400 Test Loss: 1.506 Test Acc: 0.400
Validation loss decreased (-0.370355 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 0.8450524806976318
Epoch: 9, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.471 Vali Acc: 0.426 Test Loss: 1.471 Test Acc: 0.426
Validation loss decreased (-0.399985 --> -0.425911).  Saving model ...
Epoch: 10 cost time: 0.9006078243255615
Epoch: 10, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.435 Vali Acc: 0.456 Test Loss: 1.435 Test Acc: 0.456
Validation loss decreased (-0.425911 --> -0.455541).  Saving model ...
Epoch: 11 cost time: 0.9113590717315674
Epoch: 11, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.398 Vali Acc: 0.507 Test Loss: 1.398 Test Acc: 0.507
Validation loss decreased (-0.455541 --> -0.507393).  Saving model ...
Epoch: 12 cost time: 0.8647811412811279
Epoch: 12, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.359 Vali Acc: 0.596 Test Loss: 1.359 Test Acc: 0.596
Validation loss decreased (-0.507393 --> -0.596283).  Saving model ...
Epoch: 13 cost time: 0.8782346248626709
Epoch: 13, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.320 Vali Acc: 0.644 Test Loss: 1.320 Test Acc: 0.644
Validation loss decreased (-0.596283 --> -0.644431).  Saving model ...
Epoch: 14 cost time: 0.9071002006530762
Epoch: 14, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.281 Vali Acc: 0.656 Test Loss: 1.281 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655543).  Saving model ...
Epoch: 15 cost time: 0.904019832611084
Epoch: 15, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.241 Vali Acc: 0.711 Test Loss: 1.241 Test Acc: 0.711
Validation loss decreased (-0.655543 --> -0.711099).  Saving model ...
Epoch: 16 cost time: 1.006483793258667
Epoch: 16, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.200 Vali Acc: 0.752 Test Loss: 1.200 Test Acc: 0.752
Validation loss decreased (-0.711099 --> -0.751840).  Saving model ...
Epoch: 17 cost time: 0.87215256690979
Epoch: 17, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.161 Vali Acc: 0.804 Test Loss: 1.161 Test Acc: 0.804
Validation loss decreased (-0.751840 --> -0.803692).  Saving model ...
Epoch: 18 cost time: 0.9438164234161377
Epoch: 18, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.121 Vali Acc: 0.819 Test Loss: 1.121 Test Acc: 0.819
Validation loss decreased (-0.803692 --> -0.818507).  Saving model ...
Epoch: 19 cost time: 0.9092051982879639
Epoch: 19, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.081 Vali Acc: 0.833 Test Loss: 1.081 Test Acc: 0.833
Validation loss decreased (-0.818507 --> -0.833323).  Saving model ...
Epoch: 20 cost time: 0.8979220390319824
Epoch: 20, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.041 Vali Acc: 0.841 Test Loss: 1.041 Test Acc: 0.841
Validation loss decreased (-0.833323 --> -0.840730).  Saving model ...
Epoch: 21 cost time: 0.8687641620635986
Epoch: 21, Steps: 2 | Train Loss: 0.961 Vali Loss: 1.002 Vali Acc: 0.859 Test Loss: 1.002 Test Acc: 0.859
Validation loss decreased (-0.840730 --> -0.859249).  Saving model ...
Epoch: 22 cost time: 0.9049959182739258
Epoch: 22, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.964 Vali Acc: 0.870 Test Loss: 0.964 Test Acc: 0.870
Validation loss decreased (-0.859249 --> -0.870361).  Saving model ...
Epoch: 23 cost time: 0.9042336940765381
Epoch: 23, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.928 Vali Acc: 0.881 Test Loss: 0.928 Test Acc: 0.881
Validation loss decreased (-0.870361 --> -0.881472).  Saving model ...
Epoch: 24 cost time: 0.9691345691680908
Epoch: 24, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.893 Vali Acc: 0.881 Test Loss: 0.893 Test Acc: 0.881
Validation loss decreased (-0.881472 --> -0.881473).  Saving model ...
Epoch: 25 cost time: 0.887850284576416
Epoch: 25, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.858 Vali Acc: 0.881 Test Loss: 0.858 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881473).  Saving model ...
Epoch: 26 cost time: 0.9067492485046387
Epoch: 26, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.826 Vali Acc: 0.889 Test Loss: 0.826 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888881).  Saving model ...
Epoch: 27 cost time: 0.9151368141174316
Epoch: 27, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.794 Vali Acc: 0.889 Test Loss: 0.794 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 28 cost time: 0.9589920043945312
Epoch: 28, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.764 Vali Acc: 0.893 Test Loss: 0.764 Test Acc: 0.893
Validation loss decreased (-0.888881 --> -0.892585).  Saving model ...
Epoch: 29 cost time: 0.8927900791168213
Epoch: 29, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.736 Vali Acc: 0.896 Test Loss: 0.736 Test Acc: 0.896
Validation loss decreased (-0.892585 --> -0.896289).  Saving model ...
Epoch: 30 cost time: 0.9190843105316162
Epoch: 30, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.708 Vali Acc: 0.900 Test Loss: 0.708 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 695942
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.648324966430664
Epoch: 1, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.836 Vali Acc: 0.170 Test Loss: 1.836 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 1.0405406951904297
Epoch: 2, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.812 Vali Acc: 0.200 Test Loss: 1.812 Test Acc: 0.200
Validation loss decreased (-0.170352 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.9419331550598145
Epoch: 3, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.792 Vali Acc: 0.222 Test Loss: 1.792 Test Acc: 0.222
Validation loss decreased (-0.199982 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 0.9348649978637695
Epoch: 4, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.773 Vali Acc: 0.241 Test Loss: 1.773 Test Acc: 0.241
Validation loss decreased (-0.222204 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 0.9759058952331543
Epoch: 5, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.749 Vali Acc: 0.274 Test Loss: 1.749 Test Acc: 0.274
Validation loss decreased (-0.240723 --> -0.274057).  Saving model ...
Epoch: 6 cost time: 0.9137840270996094
Epoch: 6, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.720 Vali Acc: 0.319 Test Loss: 1.720 Test Acc: 0.319
Validation loss decreased (-0.274057 --> -0.318501).  Saving model ...
Epoch: 7 cost time: 0.9910895824432373
Epoch: 7, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.688 Vali Acc: 0.341 Test Loss: 1.688 Test Acc: 0.341
Validation loss decreased (-0.318501 --> -0.340724).  Saving model ...
Epoch: 8 cost time: 0.9608750343322754
Epoch: 8, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.654 Vali Acc: 0.385 Test Loss: 1.654 Test Acc: 0.385
Validation loss decreased (-0.340724 --> -0.385169).  Saving model ...
Epoch: 9 cost time: 0.9101862907409668
Epoch: 9, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.617 Vali Acc: 0.452 Test Loss: 1.617 Test Acc: 0.452
Validation loss decreased (-0.385169 --> -0.451836).  Saving model ...
Epoch: 10 cost time: 0.976494550704956
Epoch: 10, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.578 Vali Acc: 0.493 Test Loss: 1.578 Test Acc: 0.493
Validation loss decreased (-0.451836 --> -0.492577).  Saving model ...
Epoch: 11 cost time: 0.9328131675720215
Epoch: 11, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.538 Vali Acc: 0.537 Test Loss: 1.538 Test Acc: 0.537
Validation loss decreased (-0.492577 --> -0.537022).  Saving model ...
Epoch: 12 cost time: 0.9590957164764404
Epoch: 12, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.496 Vali Acc: 0.589 Test Loss: 1.496 Test Acc: 0.589
Validation loss decreased (-0.537022 --> -0.588874).  Saving model ...
Epoch: 13 cost time: 1.0073416233062744
Epoch: 13, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.453 Vali Acc: 0.630 Test Loss: 1.453 Test Acc: 0.630
Validation loss decreased (-0.588874 --> -0.629615).  Saving model ...
Epoch: 14 cost time: 1.018747091293335
Epoch: 14, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.408 Vali Acc: 0.681 Test Loss: 1.408 Test Acc: 0.681
Validation loss decreased (-0.629615 --> -0.681467).  Saving model ...
Epoch: 15 cost time: 0.9678788185119629
Epoch: 15, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.364 Vali Acc: 0.711 Test Loss: 1.364 Test Acc: 0.711
Validation loss decreased (-0.681467 --> -0.711097).  Saving model ...
Epoch: 16 cost time: 0.9837520122528076
Epoch: 16, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.319 Vali Acc: 0.733 Test Loss: 1.319 Test Acc: 0.733
Validation loss decreased (-0.711097 --> -0.733320).  Saving model ...
Epoch: 17 cost time: 0.9540040493011475
Epoch: 17, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.274 Vali Acc: 0.752 Test Loss: 1.274 Test Acc: 0.752
Validation loss decreased (-0.733320 --> -0.751839).  Saving model ...
Epoch: 18 cost time: 1.011601448059082
Epoch: 18, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.229 Vali Acc: 0.770 Test Loss: 1.229 Test Acc: 0.770
Validation loss decreased (-0.751839 --> -0.770358).  Saving model ...
Epoch: 19 cost time: 1.0258443355560303
Epoch: 19, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.183 Vali Acc: 0.796 Test Loss: 1.183 Test Acc: 0.796
Validation loss decreased (-0.770358 --> -0.796284).  Saving model ...
Epoch: 20 cost time: 0.9660842418670654
Epoch: 20, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.137 Vali Acc: 0.804 Test Loss: 1.137 Test Acc: 0.804
Validation loss decreased (-0.796284 --> -0.803692).  Saving model ...
Epoch: 21 cost time: 0.992943525314331
Epoch: 21, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.092 Vali Acc: 0.804 Test Loss: 1.092 Test Acc: 0.804
Validation loss decreased (-0.803692 --> -0.803693).  Saving model ...
Epoch: 22 cost time: 0.9176912307739258
Epoch: 22, Steps: 2 | Train Loss: 0.881 Vali Loss: 1.048 Vali Acc: 0.826 Test Loss: 1.048 Test Acc: 0.826
Validation loss decreased (-0.803693 --> -0.825915).  Saving model ...
Epoch: 23 cost time: 0.9606289863586426
Epoch: 23, Steps: 2 | Train Loss: 0.801 Vali Loss: 1.005 Vali Acc: 0.837 Test Loss: 1.005 Test Acc: 0.837
Validation loss decreased (-0.825915 --> -0.837027).  Saving model ...
Epoch: 24 cost time: 0.8234479427337646
Epoch: 24, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.962 Vali Acc: 0.844 Test Loss: 0.962 Test Acc: 0.844
Validation loss decreased (-0.837027 --> -0.844435).  Saving model ...
Epoch: 25 cost time: 0.8850643634796143
Epoch: 25, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.921 Vali Acc: 0.844 Test Loss: 0.921 Test Acc: 0.844
Validation loss decreased (-0.844435 --> -0.844435).  Saving model ...
Epoch: 26 cost time: 0.9742512702941895
Epoch: 26, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.882 Vali Acc: 0.848 Test Loss: 0.882 Test Acc: 0.848
Validation loss decreased (-0.844435 --> -0.848139).  Saving model ...
Epoch: 27 cost time: 0.9423463344573975
Epoch: 27, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.846 Vali Acc: 0.863 Test Loss: 0.846 Test Acc: 0.863
Validation loss decreased (-0.848139 --> -0.862955).  Saving model ...
Epoch: 28 cost time: 0.877009391784668
Epoch: 28, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.811 Vali Acc: 0.867 Test Loss: 0.811 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866659).  Saving model ...
Epoch: 29 cost time: 0.8809340000152588
Epoch: 29, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.778 Vali Acc: 0.867 Test Loss: 0.778 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 30 cost time: 0.9883472919464111
Epoch: 30, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.747 Vali Acc: 0.867 Test Loss: 0.747 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8666666666666667
model parameter : 2351366
model size : 9.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.469641923904419
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.685 Vali Acc: 0.311 Test Loss: 1.685 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 0.7969760894775391
Epoch: 2, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.658 Vali Acc: 0.315 Test Loss: 1.658 Test Acc: 0.315
Validation loss decreased (-0.311094 --> -0.314798).  Saving model ...
Epoch: 3 cost time: 0.8432307243347168
Epoch: 3, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.639 Vali Acc: 0.319 Test Loss: 1.639 Test Acc: 0.319
Validation loss decreased (-0.314798 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.7575688362121582
Epoch: 4, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.621 Vali Acc: 0.333 Test Loss: 1.621 Test Acc: 0.333
Validation loss decreased (-0.318502 --> -0.333317).  Saving model ...
Epoch: 5 cost time: 0.790264368057251
Epoch: 5, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.597 Vali Acc: 0.341 Test Loss: 1.597 Test Acc: 0.341
Validation loss decreased (-0.333317 --> -0.340725).  Saving model ...
Epoch: 6 cost time: 0.7715456485748291
Epoch: 6, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.569 Vali Acc: 0.352 Test Loss: 1.569 Test Acc: 0.352
Validation loss decreased (-0.340725 --> -0.351836).  Saving model ...
Epoch: 7 cost time: 0.764721155166626
Epoch: 7, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.538 Vali Acc: 0.370 Test Loss: 1.538 Test Acc: 0.370
Validation loss decreased (-0.351836 --> -0.370355).  Saving model ...
Epoch: 8 cost time: 0.810002326965332
Epoch: 8, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.505 Vali Acc: 0.400 Test Loss: 1.505 Test Acc: 0.400
Validation loss decreased (-0.370355 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 0.8273301124572754
Epoch: 9, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.471 Vali Acc: 0.426 Test Loss: 1.471 Test Acc: 0.426
Validation loss decreased (-0.399985 --> -0.425911).  Saving model ...
Epoch: 10 cost time: 0.7664189338684082
Epoch: 10, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.435 Vali Acc: 0.456 Test Loss: 1.435 Test Acc: 0.456
Validation loss decreased (-0.425911 --> -0.455541).  Saving model ...
Epoch: 11 cost time: 0.7978672981262207
Epoch: 11, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.397 Vali Acc: 0.507 Test Loss: 1.397 Test Acc: 0.507
Validation loss decreased (-0.455541 --> -0.507393).  Saving model ...
Epoch: 12 cost time: 0.8432581424713135
Epoch: 12, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.359 Vali Acc: 0.596 Test Loss: 1.359 Test Acc: 0.596
Validation loss decreased (-0.507393 --> -0.596283).  Saving model ...
Epoch: 13 cost time: 0.7944254875183105
Epoch: 13, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.320 Vali Acc: 0.644 Test Loss: 1.320 Test Acc: 0.644
Validation loss decreased (-0.596283 --> -0.644431).  Saving model ...
Epoch: 14 cost time: 0.8407814502716064
Epoch: 14, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.280 Vali Acc: 0.656 Test Loss: 1.280 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655543).  Saving model ...
Epoch: 15 cost time: 0.7795140743255615
Epoch: 15, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.240 Vali Acc: 0.711 Test Loss: 1.240 Test Acc: 0.711
Validation loss decreased (-0.655543 --> -0.711099).  Saving model ...
Epoch: 16 cost time: 0.8804032802581787
Epoch: 16, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.200 Vali Acc: 0.752 Test Loss: 1.200 Test Acc: 0.752
Validation loss decreased (-0.711099 --> -0.751840).  Saving model ...
Epoch: 17 cost time: 0.8771884441375732
Epoch: 17, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.160 Vali Acc: 0.804 Test Loss: 1.160 Test Acc: 0.804
Validation loss decreased (-0.751840 --> -0.803692).  Saving model ...
Epoch: 18 cost time: 0.8349311351776123
Epoch: 18, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.120 Vali Acc: 0.819 Test Loss: 1.120 Test Acc: 0.819
Validation loss decreased (-0.803692 --> -0.818507).  Saving model ...
Epoch: 19 cost time: 0.8383896350860596
Epoch: 19, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.080 Vali Acc: 0.833 Test Loss: 1.080 Test Acc: 0.833
Validation loss decreased (-0.818507 --> -0.833323).  Saving model ...
Epoch: 20 cost time: 0.8321700096130371
Epoch: 20, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.041 Vali Acc: 0.841 Test Loss: 1.041 Test Acc: 0.841
Validation loss decreased (-0.833323 --> -0.840730).  Saving model ...
Epoch: 21 cost time: 0.7702286243438721
Epoch: 21, Steps: 2 | Train Loss: 0.961 Vali Loss: 1.002 Vali Acc: 0.859 Test Loss: 1.002 Test Acc: 0.859
Validation loss decreased (-0.840730 --> -0.859249).  Saving model ...
Epoch: 22 cost time: 0.8031456470489502
Epoch: 22, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.964 Vali Acc: 0.870 Test Loss: 0.964 Test Acc: 0.870
Validation loss decreased (-0.859249 --> -0.870361).  Saving model ...
Epoch: 23 cost time: 0.8141732215881348
Epoch: 23, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.927 Vali Acc: 0.881 Test Loss: 0.927 Test Acc: 0.881
Validation loss decreased (-0.870361 --> -0.881472).  Saving model ...
Epoch: 24 cost time: 0.7678909301757812
Epoch: 24, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.892 Vali Acc: 0.881 Test Loss: 0.892 Test Acc: 0.881
Validation loss decreased (-0.881472 --> -0.881473).  Saving model ...
Epoch: 25 cost time: 0.7767672538757324
Epoch: 25, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.858 Vali Acc: 0.881 Test Loss: 0.858 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881473).  Saving model ...
Epoch: 26 cost time: 0.7800016403198242
Epoch: 26, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.825 Vali Acc: 0.885 Test Loss: 0.825 Test Acc: 0.885
Validation loss decreased (-0.881473 --> -0.885177).  Saving model ...
Epoch: 27 cost time: 0.7581586837768555
Epoch: 27, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.793 Vali Acc: 0.885 Test Loss: 0.793 Test Acc: 0.885
Validation loss decreased (-0.885177 --> -0.885177).  Saving model ...
Epoch: 28 cost time: 0.8159515857696533
Epoch: 28, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.763 Vali Acc: 0.893 Test Loss: 0.763 Test Acc: 0.893
Validation loss decreased (-0.885177 --> -0.892585).  Saving model ...
Epoch: 29 cost time: 0.8692846298217773
Epoch: 29, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.735 Vali Acc: 0.896 Test Loss: 0.735 Test Acc: 0.896
Validation loss decreased (-0.892585 --> -0.896289).  Saving model ...
Epoch: 30 cost time: 0.8238122463226318
Epoch: 30, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.707 Vali Acc: 0.900 Test Loss: 0.707 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 695942
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4311299324035645
Epoch: 1, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.835 Vali Acc: 0.170 Test Loss: 1.835 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.7504229545593262
Epoch: 2, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.810 Vali Acc: 0.200 Test Loss: 1.810 Test Acc: 0.200
Validation loss decreased (-0.170352 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.7221450805664062
Epoch: 3, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.791 Vali Acc: 0.222 Test Loss: 1.791 Test Acc: 0.222
Validation loss decreased (-0.199982 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 0.7758169174194336
Epoch: 4, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.772 Vali Acc: 0.241 Test Loss: 1.772 Test Acc: 0.241
Validation loss decreased (-0.222204 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 0.7654619216918945
Epoch: 5, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.748 Vali Acc: 0.278 Test Loss: 1.748 Test Acc: 0.278
Validation loss decreased (-0.240723 --> -0.277760).  Saving model ...
Epoch: 6 cost time: 0.753861665725708
Epoch: 6, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.720 Vali Acc: 0.311 Test Loss: 1.720 Test Acc: 0.311
Validation loss decreased (-0.277760 --> -0.311094).  Saving model ...
Epoch: 7 cost time: 0.6867160797119141
Epoch: 7, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.689 Vali Acc: 0.337 Test Loss: 1.689 Test Acc: 0.337
Validation loss decreased (-0.311094 --> -0.337020).  Saving model ...
Epoch: 8 cost time: 0.7606630325317383
Epoch: 8, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.654 Vali Acc: 0.389 Test Loss: 1.654 Test Acc: 0.389
Validation loss decreased (-0.337020 --> -0.388872).  Saving model ...
Epoch: 9 cost time: 0.8125486373901367
Epoch: 9, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.618 Vali Acc: 0.459 Test Loss: 1.618 Test Acc: 0.459
Validation loss decreased (-0.388872 --> -0.459243).  Saving model ...
Epoch: 10 cost time: 0.79410719871521
Epoch: 10, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.580 Vali Acc: 0.496 Test Loss: 1.580 Test Acc: 0.496
Validation loss decreased (-0.459243 --> -0.496280).  Saving model ...
Epoch: 11 cost time: 0.8247776031494141
Epoch: 11, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.540 Vali Acc: 0.541 Test Loss: 1.540 Test Acc: 0.541
Validation loss decreased (-0.496280 --> -0.540725).  Saving model ...
Epoch: 12 cost time: 0.7610242366790771
Epoch: 12, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.499 Vali Acc: 0.585 Test Loss: 1.499 Test Acc: 0.585
Validation loss decreased (-0.540725 --> -0.585170).  Saving model ...
Epoch: 13 cost time: 0.8096861839294434
Epoch: 13, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.456 Vali Acc: 0.637 Test Loss: 1.456 Test Acc: 0.637
Validation loss decreased (-0.585170 --> -0.637022).  Saving model ...
Epoch: 14 cost time: 0.8385269641876221
Epoch: 14, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.413 Vali Acc: 0.678 Test Loss: 1.413 Test Acc: 0.678
Validation loss decreased (-0.637022 --> -0.677764).  Saving model ...
Epoch: 15 cost time: 0.731273889541626
Epoch: 15, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.368 Vali Acc: 0.711 Test Loss: 1.368 Test Acc: 0.711
Validation loss decreased (-0.677764 --> -0.711097).  Saving model ...
Epoch: 16 cost time: 0.7692582607269287
Epoch: 16, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.324 Vali Acc: 0.722 Test Loss: 1.324 Test Acc: 0.722
Validation loss decreased (-0.711097 --> -0.722209).  Saving model ...
Epoch: 17 cost time: 0.7676575183868408
Epoch: 17, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.279 Vali Acc: 0.744 Test Loss: 1.279 Test Acc: 0.744
Validation loss decreased (-0.722209 --> -0.744432).  Saving model ...
Epoch: 18 cost time: 0.8055920600891113
Epoch: 18, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.234 Vali Acc: 0.756 Test Loss: 1.234 Test Acc: 0.756
Validation loss decreased (-0.744432 --> -0.755543).  Saving model ...
Epoch: 19 cost time: 0.7699990272521973
Epoch: 19, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.189 Vali Acc: 0.778 Test Loss: 1.189 Test Acc: 0.778
Validation loss decreased (-0.755543 --> -0.777766).  Saving model ...
Epoch: 20 cost time: 0.7812130451202393
Epoch: 20, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.144 Vali Acc: 0.796 Test Loss: 1.144 Test Acc: 0.796
Validation loss decreased (-0.777766 --> -0.796285).  Saving model ...
Epoch: 21 cost time: 0.7839198112487793
Epoch: 21, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.098 Vali Acc: 0.804 Test Loss: 1.098 Test Acc: 0.804
Validation loss decreased (-0.796285 --> -0.803693).  Saving model ...
Epoch: 22 cost time: 0.8632204532623291
Epoch: 22, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.054 Vali Acc: 0.819 Test Loss: 1.054 Test Acc: 0.819
Validation loss decreased (-0.803693 --> -0.818508).  Saving model ...
Epoch: 23 cost time: 0.8011724948883057
Epoch: 23, Steps: 2 | Train Loss: 0.847 Vali Loss: 1.009 Vali Acc: 0.833 Test Loss: 1.009 Test Acc: 0.833
Validation loss decreased (-0.818508 --> -0.833323).  Saving model ...
Epoch: 24 cost time: 0.7683377265930176
Epoch: 24, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.966 Vali Acc: 0.841 Test Loss: 0.966 Test Acc: 0.841
Validation loss decreased (-0.833323 --> -0.840731).  Saving model ...
Epoch: 25 cost time: 0.7953460216522217
Epoch: 25, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.923 Vali Acc: 0.848 Test Loss: 0.923 Test Acc: 0.848
Validation loss decreased (-0.840731 --> -0.848139).  Saving model ...
Epoch: 26 cost time: 0.8273370265960693
Epoch: 26, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.882 Vali Acc: 0.856 Test Loss: 0.882 Test Acc: 0.856
Validation loss decreased (-0.848139 --> -0.855547).  Saving model ...
Epoch: 27 cost time: 0.7838125228881836
Epoch: 27, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.843 Vali Acc: 0.863 Test Loss: 0.843 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862955).  Saving model ...
Epoch: 28 cost time: 0.8547828197479248
Epoch: 28, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.806 Vali Acc: 0.874 Test Loss: 0.806 Test Acc: 0.874
Validation loss decreased (-0.862955 --> -0.874066).  Saving model ...
Epoch: 29 cost time: 0.7904946804046631
Epoch: 29, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.770 Vali Acc: 0.881 Test Loss: 0.770 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881474).  Saving model ...
Epoch: 30 cost time: 0.824723482131958
Epoch: 30, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.737 Vali Acc: 0.881 Test Loss: 0.737 Test Acc: 0.881
Validation loss decreased (-0.881474 --> -0.881474).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8814814814814815
model parameter : 2351366
model size : 9.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2483882904052734
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.685 Vali Acc: 0.311 Test Loss: 1.685 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 0.6733691692352295
Epoch: 2, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.659 Vali Acc: 0.315 Test Loss: 1.659 Test Acc: 0.315
Validation loss decreased (-0.311094 --> -0.314798).  Saving model ...
Epoch: 3 cost time: 0.6549744606018066
Epoch: 3, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.639 Vali Acc: 0.315 Test Loss: 1.639 Test Acc: 0.315
Validation loss decreased (-0.314798 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 0.623441219329834
Epoch: 4, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.622 Vali Acc: 0.330 Test Loss: 1.622 Test Acc: 0.330
Validation loss decreased (-0.314798 --> -0.329613).  Saving model ...
Epoch: 5 cost time: 0.6434247493743896
Epoch: 5, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.598 Vali Acc: 0.341 Test Loss: 1.598 Test Acc: 0.341
Validation loss decreased (-0.329613 --> -0.340725).  Saving model ...
Epoch: 6 cost time: 0.6752243041992188
Epoch: 6, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.571 Vali Acc: 0.352 Test Loss: 1.571 Test Acc: 0.352
Validation loss decreased (-0.340725 --> -0.351836).  Saving model ...
Epoch: 7 cost time: 0.5843913555145264
Epoch: 7, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.541 Vali Acc: 0.370 Test Loss: 1.541 Test Acc: 0.370
Validation loss decreased (-0.351836 --> -0.370355).  Saving model ...
Epoch: 8 cost time: 0.6468987464904785
Epoch: 8, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.509 Vali Acc: 0.400 Test Loss: 1.509 Test Acc: 0.400
Validation loss decreased (-0.370355 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 0.6703987121582031
Epoch: 9, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.474 Vali Acc: 0.430 Test Loss: 1.474 Test Acc: 0.430
Validation loss decreased (-0.399985 --> -0.429615).  Saving model ...
Epoch: 10 cost time: 0.7369883060455322
Epoch: 10, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.439 Vali Acc: 0.456 Test Loss: 1.439 Test Acc: 0.456
Validation loss decreased (-0.429615 --> -0.455541).  Saving model ...
Epoch: 11 cost time: 0.6838493347167969
Epoch: 11, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.402 Vali Acc: 0.504 Test Loss: 1.402 Test Acc: 0.504
Validation loss decreased (-0.455541 --> -0.503690).  Saving model ...
Epoch: 12 cost time: 0.6057925224304199
Epoch: 12, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.365 Vali Acc: 0.593 Test Loss: 1.365 Test Acc: 0.593
Validation loss decreased (-0.503690 --> -0.592579).  Saving model ...
Epoch: 13 cost time: 0.6599032878875732
Epoch: 13, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.327 Vali Acc: 0.637 Test Loss: 1.327 Test Acc: 0.637
Validation loss decreased (-0.592579 --> -0.637024).  Saving model ...
Epoch: 14 cost time: 0.6583526134490967
Epoch: 14, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.288 Vali Acc: 0.641 Test Loss: 1.288 Test Acc: 0.641
Validation loss decreased (-0.637024 --> -0.640728).  Saving model ...
Epoch: 15 cost time: 0.675825834274292
Epoch: 15, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.249 Vali Acc: 0.696 Test Loss: 1.249 Test Acc: 0.696
Validation loss decreased (-0.640728 --> -0.696284).  Saving model ...
Epoch: 16 cost time: 0.6936757564544678
Epoch: 16, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.210 Vali Acc: 0.748 Test Loss: 1.210 Test Acc: 0.748
Validation loss decreased (-0.696284 --> -0.748136).  Saving model ...
Epoch: 17 cost time: 0.7652080059051514
Epoch: 17, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.171 Vali Acc: 0.789 Test Loss: 1.171 Test Acc: 0.789
Validation loss decreased (-0.748136 --> -0.788877).  Saving model ...
Epoch: 18 cost time: 0.7328543663024902
Epoch: 18, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.132 Vali Acc: 0.811 Test Loss: 1.132 Test Acc: 0.811
Validation loss decreased (-0.788877 --> -0.811100).  Saving model ...
Epoch: 19 cost time: 0.7526099681854248
Epoch: 19, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.093 Vali Acc: 0.822 Test Loss: 1.093 Test Acc: 0.822
Validation loss decreased (-0.811100 --> -0.822211).  Saving model ...
Epoch: 20 cost time: 0.6840436458587646
Epoch: 20, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.054 Vali Acc: 0.830 Test Loss: 1.054 Test Acc: 0.830
Validation loss decreased (-0.822211 --> -0.829619).  Saving model ...
Epoch: 21 cost time: 0.6626029014587402
Epoch: 21, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.016 Vali Acc: 0.841 Test Loss: 1.016 Test Acc: 0.841
Validation loss decreased (-0.829619 --> -0.840731).  Saving model ...
Epoch: 22 cost time: 0.6467442512512207
Epoch: 22, Steps: 2 | Train Loss: 0.902 Vali Loss: 0.978 Vali Acc: 0.856 Test Loss: 0.978 Test Acc: 0.856
Validation loss decreased (-0.840731 --> -0.855546).  Saving model ...
Epoch: 23 cost time: 0.6077475547790527
Epoch: 23, Steps: 2 | Train Loss: 0.822 Vali Loss: 0.941 Vali Acc: 0.867 Test Loss: 0.941 Test Acc: 0.867
Validation loss decreased (-0.855546 --> -0.866657).  Saving model ...
Epoch: 24 cost time: 0.6527109146118164
Epoch: 24, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.906 Vali Acc: 0.874 Test Loss: 0.906 Test Acc: 0.874
Validation loss decreased (-0.866657 --> -0.874065).  Saving model ...
Epoch: 25 cost time: 0.675076961517334
Epoch: 25, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.871 Vali Acc: 0.881 Test Loss: 0.871 Test Acc: 0.881
Validation loss decreased (-0.874065 --> -0.881473).  Saving model ...
Epoch: 26 cost time: 0.6812808513641357
Epoch: 26, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.837 Vali Acc: 0.889 Test Loss: 0.837 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888881).  Saving model ...
Epoch: 27 cost time: 0.6878049373626709
Epoch: 27, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.804 Vali Acc: 0.889 Test Loss: 0.804 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 28 cost time: 0.7048277854919434
Epoch: 28, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.773 Vali Acc: 0.889 Test Loss: 0.773 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 29 cost time: 0.6786911487579346
Epoch: 29, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.744 Vali Acc: 0.889 Test Loss: 0.744 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 30 cost time: 0.6970107555389404
Epoch: 30, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.715 Vali Acc: 0.900 Test Loss: 0.715 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899993).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 695942
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.667729139328003
Epoch: 1, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.753 Vali Acc: 0.278 Test Loss: 1.753 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 0.9741411209106445
Epoch: 2, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.727 Vali Acc: 0.278 Test Loss: 1.727 Test Acc: 0.278
Validation loss decreased (-0.277760 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 0.9474399089813232
Epoch: 3, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.708 Vali Acc: 0.285 Test Loss: 1.708 Test Acc: 0.285
Validation loss decreased (-0.277761 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.9869492053985596
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.692 Vali Acc: 0.285 Test Loss: 1.692 Test Acc: 0.285
Validation loss decreased (-0.285168 --> -0.285168).  Saving model ...
Epoch: 5 cost time: 1.0060279369354248
Epoch: 5, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.672 Vali Acc: 0.293 Test Loss: 1.672 Test Acc: 0.293
Validation loss decreased (-0.285168 --> -0.292576).  Saving model ...
Epoch: 6 cost time: 0.9730899333953857
Epoch: 6, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.648 Vali Acc: 0.304 Test Loss: 1.648 Test Acc: 0.304
Validation loss decreased (-0.292576 --> -0.303687).  Saving model ...
Epoch: 7 cost time: 0.8894820213317871
Epoch: 7, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.621 Vali Acc: 0.311 Test Loss: 1.621 Test Acc: 0.311
Validation loss decreased (-0.303687 --> -0.311095).  Saving model ...
Epoch: 8 cost time: 0.9626107215881348
Epoch: 8, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.592 Vali Acc: 0.341 Test Loss: 1.592 Test Acc: 0.341
Validation loss decreased (-0.311095 --> -0.340725).  Saving model ...
Epoch: 9 cost time: 1.0090522766113281
Epoch: 9, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.560 Vali Acc: 0.396 Test Loss: 1.560 Test Acc: 0.396
Validation loss decreased (-0.340725 --> -0.396281).  Saving model ...
Epoch: 10 cost time: 0.9302668571472168
Epoch: 10, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.527 Vali Acc: 0.433 Test Loss: 1.527 Test Acc: 0.433
Validation loss decreased (-0.396281 --> -0.433318).  Saving model ...
Epoch: 11 cost time: 0.9162609577178955
Epoch: 11, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.493 Vali Acc: 0.467 Test Loss: 1.493 Test Acc: 0.467
Validation loss decreased (-0.433318 --> -0.466652).  Saving model ...
Epoch: 12 cost time: 0.920365571975708
Epoch: 12, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.457 Vali Acc: 0.511 Test Loss: 1.457 Test Acc: 0.511
Validation loss decreased (-0.466652 --> -0.511097).  Saving model ...
Epoch: 13 cost time: 1.0335612297058105
Epoch: 13, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.421 Vali Acc: 0.533 Test Loss: 1.421 Test Acc: 0.533
Validation loss decreased (-0.511097 --> -0.533319).  Saving model ...
Epoch: 14 cost time: 0.9648001194000244
Epoch: 14, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.384 Vali Acc: 0.578 Test Loss: 1.384 Test Acc: 0.578
Validation loss decreased (-0.533319 --> -0.577764).  Saving model ...
Epoch: 15 cost time: 0.890913724899292
Epoch: 15, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.347 Vali Acc: 0.600 Test Loss: 1.347 Test Acc: 0.600
Validation loss decreased (-0.577764 --> -0.599987).  Saving model ...
Epoch: 16 cost time: 0.7875878810882568
Epoch: 16, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.309 Vali Acc: 0.622 Test Loss: 1.309 Test Acc: 0.622
Validation loss decreased (-0.599987 --> -0.622209).  Saving model ...
Epoch: 17 cost time: 0.9538822174072266
Epoch: 17, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.271 Vali Acc: 0.659 Test Loss: 1.271 Test Acc: 0.659
Validation loss decreased (-0.622209 --> -0.659247).  Saving model ...
Epoch: 18 cost time: 1.0368549823760986
Epoch: 18, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.232 Vali Acc: 0.667 Test Loss: 1.232 Test Acc: 0.667
Validation loss decreased (-0.659247 --> -0.666654).  Saving model ...
Epoch: 19 cost time: 0.9434442520141602
Epoch: 19, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.195 Vali Acc: 0.696 Test Loss: 1.195 Test Acc: 0.696
Validation loss decreased (-0.666654 --> -0.696284).  Saving model ...
Epoch: 20 cost time: 1.0302588939666748
Epoch: 20, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.158 Vali Acc: 0.711 Test Loss: 1.158 Test Acc: 0.711
Validation loss decreased (-0.696284 --> -0.711100).  Saving model ...
Epoch: 21 cost time: 0.9492874145507812
Epoch: 21, Steps: 2 | Train Loss: 1.015 Vali Loss: 1.121 Vali Acc: 0.741 Test Loss: 1.121 Test Acc: 0.741
Validation loss decreased (-0.711100 --> -0.740730).  Saving model ...
Epoch: 22 cost time: 1.013913869857788
Epoch: 22, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.084 Vali Acc: 0.756 Test Loss: 1.084 Test Acc: 0.756
Validation loss decreased (-0.740730 --> -0.755545).  Saving model ...
Epoch: 23 cost time: 1.1092679500579834
Epoch: 23, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.048 Vali Acc: 0.767 Test Loss: 1.048 Test Acc: 0.767
Validation loss decreased (-0.755545 --> -0.766656).  Saving model ...
Epoch: 24 cost time: 1.1476171016693115
Epoch: 24, Steps: 2 | Train Loss: 0.854 Vali Loss: 1.013 Vali Acc: 0.774 Test Loss: 1.013 Test Acc: 0.774
Validation loss decreased (-0.766656 --> -0.774064).  Saving model ...
Epoch: 25 cost time: 1.1317856311798096
Epoch: 25, Steps: 2 | Train Loss: 0.827 Vali Loss: 0.979 Vali Acc: 0.774 Test Loss: 0.979 Test Acc: 0.774
Validation loss decreased (-0.774064 --> -0.774064).  Saving model ...
Epoch: 26 cost time: 0.9984660148620605
Epoch: 26, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.946 Vali Acc: 0.785 Test Loss: 0.946 Test Acc: 0.785
Validation loss decreased (-0.774064 --> -0.785176).  Saving model ...
Epoch: 27 cost time: 1.1572787761688232
Epoch: 27, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.914 Vali Acc: 0.789 Test Loss: 0.914 Test Acc: 0.789
Validation loss decreased (-0.785176 --> -0.788880).  Saving model ...
Epoch: 28 cost time: 1.0603110790252686
Epoch: 28, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.883 Vali Acc: 0.796 Test Loss: 0.883 Test Acc: 0.796
Validation loss decreased (-0.788880 --> -0.796287).  Saving model ...
Epoch: 29 cost time: 1.091968059539795
Epoch: 29, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.854 Vali Acc: 0.804 Test Loss: 0.854 Test Acc: 0.804
Validation loss decreased (-0.796287 --> -0.803695).  Saving model ...
Epoch: 30 cost time: 0.9503586292266846
Epoch: 30, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.825 Vali Acc: 0.815 Test Loss: 0.825 Test Acc: 0.815
Validation loss decreased (-0.803695 --> -0.814807).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8148148148148148
model parameter : 1179142
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.567887544631958
Epoch: 1, Steps: 2 | Train Loss: 1.981 Vali Loss: 1.889 Vali Acc: 0.081 Test Loss: 1.889 Test Acc: 0.081
Validation loss decreased (inf --> -0.081463).  Saving model ...
Epoch: 2 cost time: 0.8238968849182129
Epoch: 2, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.856 Vali Acc: 0.100 Test Loss: 1.856 Test Acc: 0.100
Validation loss decreased (-0.081463 --> -0.099981).  Saving model ...
Epoch: 3 cost time: 0.9068546295166016
Epoch: 3, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.834 Vali Acc: 0.104 Test Loss: 1.834 Test Acc: 0.104
Validation loss decreased (-0.099981 --> -0.103685).  Saving model ...
Epoch: 4 cost time: 0.9448502063751221
Epoch: 4, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.816 Vali Acc: 0.107 Test Loss: 1.816 Test Acc: 0.107
Validation loss decreased (-0.103685 --> -0.107389).  Saving model ...
Epoch: 5 cost time: 0.9008290767669678
Epoch: 5, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.793 Vali Acc: 0.122 Test Loss: 1.793 Test Acc: 0.122
Validation loss decreased (-0.107389 --> -0.122204).  Saving model ...
Epoch: 6 cost time: 0.8610544204711914
Epoch: 6, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.766 Vali Acc: 0.137 Test Loss: 1.766 Test Acc: 0.137
Validation loss decreased (-0.122204 --> -0.137019).  Saving model ...
Epoch: 7 cost time: 0.8250701427459717
Epoch: 7, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.736 Vali Acc: 0.156 Test Loss: 1.736 Test Acc: 0.156
Validation loss decreased (-0.137019 --> -0.155538).  Saving model ...
Epoch: 8 cost time: 0.9061281681060791
Epoch: 8, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.702 Vali Acc: 0.178 Test Loss: 1.702 Test Acc: 0.178
Validation loss decreased (-0.155538 --> -0.177761).  Saving model ...
Epoch: 9 cost time: 0.8828961849212646
Epoch: 9, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.667 Vali Acc: 0.204 Test Loss: 1.667 Test Acc: 0.204
Validation loss decreased (-0.177761 --> -0.203687).  Saving model ...
Epoch: 10 cost time: 0.8533704280853271
Epoch: 10, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.630 Vali Acc: 0.237 Test Loss: 1.630 Test Acc: 0.237
Validation loss decreased (-0.203687 --> -0.237021).  Saving model ...
Epoch: 11 cost time: 0.8878471851348877
Epoch: 11, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.591 Vali Acc: 0.281 Test Loss: 1.591 Test Acc: 0.281
Validation loss decreased (-0.237021 --> -0.281466).  Saving model ...
Epoch: 12 cost time: 1.0168356895446777
Epoch: 12, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.551 Vali Acc: 0.322 Test Loss: 1.551 Test Acc: 0.322
Validation loss decreased (-0.281466 --> -0.322207).  Saving model ...
Epoch: 13 cost time: 0.9283156394958496
Epoch: 13, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.511 Vali Acc: 0.374 Test Loss: 1.511 Test Acc: 0.374
Validation loss decreased (-0.322207 --> -0.374059).  Saving model ...
Epoch: 14 cost time: 0.9094855785369873
Epoch: 14, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.469 Vali Acc: 0.485 Test Loss: 1.469 Test Acc: 0.485
Validation loss decreased (-0.374059 --> -0.485170).  Saving model ...
Epoch: 15 cost time: 0.9655611515045166
Epoch: 15, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.427 Vali Acc: 0.570 Test Loss: 1.427 Test Acc: 0.570
Validation loss decreased (-0.485170 --> -0.570356).  Saving model ...
Epoch: 16 cost time: 0.9539411067962646
Epoch: 16, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.384 Vali Acc: 0.622 Test Loss: 1.384 Test Acc: 0.622
Validation loss decreased (-0.570356 --> -0.622208).  Saving model ...
Epoch: 17 cost time: 0.8811507225036621
Epoch: 17, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.340 Vali Acc: 0.681 Test Loss: 1.340 Test Acc: 0.681
Validation loss decreased (-0.622208 --> -0.681468).  Saving model ...
Epoch: 18 cost time: 0.8665704727172852
Epoch: 18, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.296 Vali Acc: 0.722 Test Loss: 1.296 Test Acc: 0.722
Validation loss decreased (-0.681468 --> -0.722209).  Saving model ...
Epoch: 19 cost time: 0.7846353054046631
Epoch: 19, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.252 Vali Acc: 0.733 Test Loss: 1.252 Test Acc: 0.733
Validation loss decreased (-0.722209 --> -0.733321).  Saving model ...
Epoch: 20 cost time: 0.9148414134979248
Epoch: 20, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.208 Vali Acc: 0.770 Test Loss: 1.208 Test Acc: 0.770
Validation loss decreased (-0.733321 --> -0.770358).  Saving model ...
Epoch: 21 cost time: 0.8801212310791016
Epoch: 21, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.164 Vali Acc: 0.789 Test Loss: 1.164 Test Acc: 0.789
Validation loss decreased (-0.770358 --> -0.788877).  Saving model ...
Epoch: 22 cost time: 0.9153122901916504
Epoch: 22, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.121 Vali Acc: 0.819 Test Loss: 1.121 Test Acc: 0.819
Validation loss decreased (-0.788877 --> -0.818507).  Saving model ...
Epoch: 23 cost time: 0.929760217666626
Epoch: 23, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.078 Vali Acc: 0.837 Test Loss: 1.078 Test Acc: 0.837
Validation loss decreased (-0.818507 --> -0.837026).  Saving model ...
Epoch: 24 cost time: 0.8685755729675293
Epoch: 24, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.038 Vali Acc: 0.841 Test Loss: 1.038 Test Acc: 0.841
Validation loss decreased (-0.837026 --> -0.840730).  Saving model ...
Epoch: 25 cost time: 0.8688864707946777
Epoch: 25, Steps: 2 | Train Loss: 0.963 Vali Loss: 0.998 Vali Acc: 0.844 Test Loss: 0.998 Test Acc: 0.844
Validation loss decreased (-0.840730 --> -0.844434).  Saving model ...
Epoch: 26 cost time: 1.003908634185791
Epoch: 26, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.959 Vali Acc: 0.848 Test Loss: 0.959 Test Acc: 0.848
Validation loss decreased (-0.844434 --> -0.848139).  Saving model ...
Epoch: 27 cost time: 0.922288179397583
Epoch: 27, Steps: 2 | Train Loss: 0.821 Vali Loss: 0.921 Vali Acc: 0.859 Test Loss: 0.921 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859250).  Saving model ...
Epoch: 28 cost time: 0.8952531814575195
Epoch: 28, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.883 Vali Acc: 0.863 Test Loss: 0.883 Test Acc: 0.863
Validation loss decreased (-0.859250 --> -0.862954).  Saving model ...
Epoch: 29 cost time: 0.8377470970153809
Epoch: 29, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.846 Vali Acc: 0.870 Test Loss: 0.846 Test Acc: 0.870
Validation loss decreased (-0.862954 --> -0.870362).  Saving model ...
Epoch: 30 cost time: 0.9499623775482178
Epoch: 30, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.810 Vali Acc: 0.874 Test Loss: 0.810 Test Acc: 0.874
Validation loss decreased (-0.870362 --> -0.874066).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8740740740740741
model parameter : 351366
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6399857997894287
Epoch: 1, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.753 Vali Acc: 0.278 Test Loss: 1.753 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 0.6863918304443359
Epoch: 2, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.727 Vali Acc: 0.278 Test Loss: 1.727 Test Acc: 0.278
Validation loss decreased (-0.277760 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 0.8386392593383789
Epoch: 3, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.708 Vali Acc: 0.285 Test Loss: 1.708 Test Acc: 0.285
Validation loss decreased (-0.277761 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.872734546661377
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.692 Vali Acc: 0.285 Test Loss: 1.692 Test Acc: 0.285
Validation loss decreased (-0.285168 --> -0.285168).  Saving model ...
Epoch: 5 cost time: 0.8666331768035889
Epoch: 5, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.672 Vali Acc: 0.293 Test Loss: 1.672 Test Acc: 0.293
Validation loss decreased (-0.285168 --> -0.292576).  Saving model ...
Epoch: 6 cost time: 0.9713387489318848
Epoch: 6, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.648 Vali Acc: 0.304 Test Loss: 1.648 Test Acc: 0.304
Validation loss decreased (-0.292576 --> -0.303687).  Saving model ...
Epoch: 7 cost time: 0.8425037860870361
Epoch: 7, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.621 Vali Acc: 0.311 Test Loss: 1.621 Test Acc: 0.311
Validation loss decreased (-0.303687 --> -0.311095).  Saving model ...
Epoch: 8 cost time: 0.8415782451629639
Epoch: 8, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.592 Vali Acc: 0.341 Test Loss: 1.592 Test Acc: 0.341
Validation loss decreased (-0.311095 --> -0.340725).  Saving model ...
Epoch: 9 cost time: 0.8740561008453369
Epoch: 9, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.560 Vali Acc: 0.396 Test Loss: 1.560 Test Acc: 0.396
Validation loss decreased (-0.340725 --> -0.396281).  Saving model ...
Epoch: 10 cost time: 0.9922909736633301
Epoch: 10, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.527 Vali Acc: 0.433 Test Loss: 1.527 Test Acc: 0.433
Validation loss decreased (-0.396281 --> -0.433318).  Saving model ...
Epoch: 11 cost time: 0.8566231727600098
Epoch: 11, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.493 Vali Acc: 0.467 Test Loss: 1.493 Test Acc: 0.467
Validation loss decreased (-0.433318 --> -0.466652).  Saving model ...
Epoch: 12 cost time: 0.9153075218200684
Epoch: 12, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.457 Vali Acc: 0.511 Test Loss: 1.457 Test Acc: 0.511
Validation loss decreased (-0.466652 --> -0.511097).  Saving model ...
Epoch: 13 cost time: 0.8204543590545654
Epoch: 13, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.421 Vali Acc: 0.537 Test Loss: 1.421 Test Acc: 0.537
Validation loss decreased (-0.511097 --> -0.537023).  Saving model ...
Epoch: 14 cost time: 0.908686637878418
Epoch: 14, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.384 Vali Acc: 0.578 Test Loss: 1.384 Test Acc: 0.578
Validation loss decreased (-0.537023 --> -0.577764).  Saving model ...
Epoch: 15 cost time: 0.8522906303405762
Epoch: 15, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.347 Vali Acc: 0.600 Test Loss: 1.347 Test Acc: 0.600
Validation loss decreased (-0.577764 --> -0.599987).  Saving model ...
Epoch: 16 cost time: 0.804269552230835
Epoch: 16, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.309 Vali Acc: 0.622 Test Loss: 1.309 Test Acc: 0.622
Validation loss decreased (-0.599987 --> -0.622209).  Saving model ...
Epoch: 17 cost time: 0.8922736644744873
Epoch: 17, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.271 Vali Acc: 0.659 Test Loss: 1.271 Test Acc: 0.659
Validation loss decreased (-0.622209 --> -0.659247).  Saving model ...
Epoch: 18 cost time: 0.8272767066955566
Epoch: 18, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.232 Vali Acc: 0.667 Test Loss: 1.232 Test Acc: 0.667
Validation loss decreased (-0.659247 --> -0.666654).  Saving model ...
Epoch: 19 cost time: 0.8444631099700928
Epoch: 19, Steps: 2 | Train Loss: 1.076 Vali Loss: 1.195 Vali Acc: 0.696 Test Loss: 1.195 Test Acc: 0.696
Validation loss decreased (-0.666654 --> -0.696284).  Saving model ...
Epoch: 20 cost time: 0.8378159999847412
Epoch: 20, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.158 Vali Acc: 0.715 Test Loss: 1.158 Test Acc: 0.715
Validation loss decreased (-0.696284 --> -0.714803).  Saving model ...
Epoch: 21 cost time: 0.7717459201812744
Epoch: 21, Steps: 2 | Train Loss: 1.015 Vali Loss: 1.121 Vali Acc: 0.741 Test Loss: 1.121 Test Acc: 0.741
Validation loss decreased (-0.714803 --> -0.740730).  Saving model ...
Epoch: 22 cost time: 0.8446824550628662
Epoch: 22, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.084 Vali Acc: 0.756 Test Loss: 1.084 Test Acc: 0.756
Validation loss decreased (-0.740730 --> -0.755545).  Saving model ...
Epoch: 23 cost time: 0.7815742492675781
Epoch: 23, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.048 Vali Acc: 0.767 Test Loss: 1.048 Test Acc: 0.767
Validation loss decreased (-0.755545 --> -0.766656).  Saving model ...
Epoch: 24 cost time: 0.8409814834594727
Epoch: 24, Steps: 2 | Train Loss: 0.854 Vali Loss: 1.013 Vali Acc: 0.774 Test Loss: 1.013 Test Acc: 0.774
Validation loss decreased (-0.766656 --> -0.774064).  Saving model ...
Epoch: 25 cost time: 0.8656938076019287
Epoch: 25, Steps: 2 | Train Loss: 0.827 Vali Loss: 0.979 Vali Acc: 0.774 Test Loss: 0.979 Test Acc: 0.774
Validation loss decreased (-0.774064 --> -0.774064).  Saving model ...
Epoch: 26 cost time: 0.7846269607543945
Epoch: 26, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.946 Vali Acc: 0.785 Test Loss: 0.946 Test Acc: 0.785
Validation loss decreased (-0.774064 --> -0.785176).  Saving model ...
Epoch: 27 cost time: 0.8502194881439209
Epoch: 27, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.914 Vali Acc: 0.789 Test Loss: 0.914 Test Acc: 0.789
Validation loss decreased (-0.785176 --> -0.788880).  Saving model ...
Epoch: 28 cost time: 0.7805218696594238
Epoch: 28, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.883 Vali Acc: 0.796 Test Loss: 0.883 Test Acc: 0.796
Validation loss decreased (-0.788880 --> -0.796287).  Saving model ...
Epoch: 29 cost time: 0.7267789840698242
Epoch: 29, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.854 Vali Acc: 0.804 Test Loss: 0.854 Test Acc: 0.804
Validation loss decreased (-0.796287 --> -0.803695).  Saving model ...
Epoch: 30 cost time: 0.7939150333404541
Epoch: 30, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.825 Vali Acc: 0.815 Test Loss: 0.825 Test Acc: 0.815
Validation loss decreased (-0.803695 --> -0.814807).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8148148148148148
model parameter : 1179142
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.532945156097412
Epoch: 1, Steps: 2 | Train Loss: 1.981 Vali Loss: 1.889 Vali Acc: 0.081 Test Loss: 1.889 Test Acc: 0.081
Validation loss decreased (inf --> -0.081463).  Saving model ...
Epoch: 2 cost time: 0.7321774959564209
Epoch: 2, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.856 Vali Acc: 0.100 Test Loss: 1.856 Test Acc: 0.100
Validation loss decreased (-0.081463 --> -0.099981).  Saving model ...
Epoch: 3 cost time: 0.7885746955871582
Epoch: 3, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.834 Vali Acc: 0.104 Test Loss: 1.834 Test Acc: 0.104
Validation loss decreased (-0.099981 --> -0.103685).  Saving model ...
Epoch: 4 cost time: 0.6979677677154541
Epoch: 4, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.816 Vali Acc: 0.107 Test Loss: 1.816 Test Acc: 0.107
Validation loss decreased (-0.103685 --> -0.107389).  Saving model ...
Epoch: 5 cost time: 0.7688899040222168
Epoch: 5, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.793 Vali Acc: 0.122 Test Loss: 1.793 Test Acc: 0.122
Validation loss decreased (-0.107389 --> -0.122204).  Saving model ...
Epoch: 6 cost time: 0.7439754009246826
Epoch: 6, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.766 Vali Acc: 0.137 Test Loss: 1.766 Test Acc: 0.137
Validation loss decreased (-0.122204 --> -0.137019).  Saving model ...
Epoch: 7 cost time: 0.7194294929504395
Epoch: 7, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.736 Vali Acc: 0.156 Test Loss: 1.736 Test Acc: 0.156
Validation loss decreased (-0.137019 --> -0.155538).  Saving model ...
Epoch: 8 cost time: 0.7790224552154541
Epoch: 8, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.702 Vali Acc: 0.178 Test Loss: 1.702 Test Acc: 0.178
Validation loss decreased (-0.155538 --> -0.177761).  Saving model ...
Epoch: 9 cost time: 0.7411987781524658
Epoch: 9, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.667 Vali Acc: 0.204 Test Loss: 1.667 Test Acc: 0.204
Validation loss decreased (-0.177761 --> -0.203687).  Saving model ...
Epoch: 10 cost time: 0.8665637969970703
Epoch: 10, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.630 Vali Acc: 0.237 Test Loss: 1.630 Test Acc: 0.237
Validation loss decreased (-0.203687 --> -0.237021).  Saving model ...
Epoch: 11 cost time: 0.8287122249603271
Epoch: 11, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.591 Vali Acc: 0.281 Test Loss: 1.591 Test Acc: 0.281
Validation loss decreased (-0.237021 --> -0.281466).  Saving model ...
Epoch: 12 cost time: 0.6857430934906006
Epoch: 12, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.551 Vali Acc: 0.322 Test Loss: 1.551 Test Acc: 0.322
Validation loss decreased (-0.281466 --> -0.322207).  Saving model ...
Epoch: 13 cost time: 0.6915433406829834
Epoch: 13, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.511 Vali Acc: 0.374 Test Loss: 1.511 Test Acc: 0.374
Validation loss decreased (-0.322207 --> -0.374059).  Saving model ...
Epoch: 14 cost time: 0.7968361377716064
Epoch: 14, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.469 Vali Acc: 0.485 Test Loss: 1.469 Test Acc: 0.485
Validation loss decreased (-0.374059 --> -0.485170).  Saving model ...
Epoch: 15 cost time: 0.7418763637542725
Epoch: 15, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.427 Vali Acc: 0.570 Test Loss: 1.427 Test Acc: 0.570
Validation loss decreased (-0.485170 --> -0.570356).  Saving model ...
Epoch: 16 cost time: 0.7925288677215576
Epoch: 16, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.384 Vali Acc: 0.622 Test Loss: 1.384 Test Acc: 0.622
Validation loss decreased (-0.570356 --> -0.622208).  Saving model ...
Epoch: 17 cost time: 0.7417001724243164
Epoch: 17, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.340 Vali Acc: 0.681 Test Loss: 1.340 Test Acc: 0.681
Validation loss decreased (-0.622208 --> -0.681468).  Saving model ...
Epoch: 18 cost time: 0.8366122245788574
Epoch: 18, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.296 Vali Acc: 0.722 Test Loss: 1.296 Test Acc: 0.722
Validation loss decreased (-0.681468 --> -0.722209).  Saving model ...
Epoch: 19 cost time: 0.7332475185394287
Epoch: 19, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.252 Vali Acc: 0.733 Test Loss: 1.252 Test Acc: 0.733
Validation loss decreased (-0.722209 --> -0.733321).  Saving model ...
Epoch: 20 cost time: 0.7865586280822754
Epoch: 20, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.208 Vali Acc: 0.770 Test Loss: 1.208 Test Acc: 0.770
Validation loss decreased (-0.733321 --> -0.770358).  Saving model ...
Epoch: 21 cost time: 0.7703578472137451
Epoch: 21, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.164 Vali Acc: 0.789 Test Loss: 1.164 Test Acc: 0.789
Validation loss decreased (-0.770358 --> -0.788877).  Saving model ...
Epoch: 22 cost time: 0.7187938690185547
Epoch: 22, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.121 Vali Acc: 0.819 Test Loss: 1.121 Test Acc: 0.819
Validation loss decreased (-0.788877 --> -0.818507).  Saving model ...
Epoch: 23 cost time: 0.7675979137420654
Epoch: 23, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.078 Vali Acc: 0.837 Test Loss: 1.078 Test Acc: 0.837
Validation loss decreased (-0.818507 --> -0.837026).  Saving model ...
Epoch: 24 cost time: 0.8606777191162109
Epoch: 24, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.038 Vali Acc: 0.841 Test Loss: 1.038 Test Acc: 0.841
Validation loss decreased (-0.837026 --> -0.840730).  Saving model ...
Epoch: 25 cost time: 0.7998206615447998
Epoch: 25, Steps: 2 | Train Loss: 0.963 Vali Loss: 0.998 Vali Acc: 0.844 Test Loss: 0.998 Test Acc: 0.844
Validation loss decreased (-0.840730 --> -0.844434).  Saving model ...
Epoch: 26 cost time: 0.7086360454559326
Epoch: 26, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.959 Vali Acc: 0.848 Test Loss: 0.959 Test Acc: 0.848
Validation loss decreased (-0.844434 --> -0.848139).  Saving model ...
Epoch: 27 cost time: 0.864020824432373
Epoch: 27, Steps: 2 | Train Loss: 0.821 Vali Loss: 0.921 Vali Acc: 0.859 Test Loss: 0.921 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859250).  Saving model ...
Epoch: 28 cost time: 0.965723991394043
Epoch: 28, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.883 Vali Acc: 0.863 Test Loss: 0.883 Test Acc: 0.863
Validation loss decreased (-0.859250 --> -0.862954).  Saving model ...
Epoch: 29 cost time: 0.8556680679321289
Epoch: 29, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.846 Vali Acc: 0.870 Test Loss: 0.846 Test Acc: 0.870
Validation loss decreased (-0.862954 --> -0.870362).  Saving model ...
Epoch: 30 cost time: 0.8595223426818848
Epoch: 30, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.810 Vali Acc: 0.874 Test Loss: 0.810 Test Acc: 0.874
Validation loss decreased (-0.870362 --> -0.874066).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8740740740740741
model parameter : 351366
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.591102123260498
Epoch: 1, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.751 Vali Acc: 0.278 Test Loss: 1.751 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 0.791886568069458
Epoch: 2, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.724 Vali Acc: 0.281 Test Loss: 1.724 Test Acc: 0.281
Validation loss decreased (-0.277760 --> -0.281464).  Saving model ...
Epoch: 3 cost time: 0.7204117774963379
Epoch: 3, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.706 Vali Acc: 0.289 Test Loss: 1.706 Test Acc: 0.289
Validation loss decreased (-0.281464 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 0.795135498046875
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.690 Vali Acc: 0.289 Test Loss: 1.690 Test Acc: 0.289
Validation loss decreased (-0.288872 --> -0.288872).  Saving model ...
Epoch: 5 cost time: 0.6672263145446777
Epoch: 5, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.670 Vali Acc: 0.293 Test Loss: 1.670 Test Acc: 0.293
Validation loss decreased (-0.288872 --> -0.292576).  Saving model ...
Epoch: 6 cost time: 0.7174086570739746
Epoch: 6, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.647 Vali Acc: 0.304 Test Loss: 1.647 Test Acc: 0.304
Validation loss decreased (-0.292576 --> -0.303687).  Saving model ...
Epoch: 7 cost time: 0.7809484004974365
Epoch: 7, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.620 Vali Acc: 0.311 Test Loss: 1.620 Test Acc: 0.311
Validation loss decreased (-0.303687 --> -0.311095).  Saving model ...
Epoch: 8 cost time: 0.9007265567779541
Epoch: 8, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.592 Vali Acc: 0.344 Test Loss: 1.592 Test Acc: 0.344
Validation loss decreased (-0.311095 --> -0.344429).  Saving model ...
Epoch: 9 cost time: 0.8099014759063721
Epoch: 9, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.561 Vali Acc: 0.396 Test Loss: 1.561 Test Acc: 0.396
Validation loss decreased (-0.344429 --> -0.396281).  Saving model ...
Epoch: 10 cost time: 0.8320767879486084
Epoch: 10, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.528 Vali Acc: 0.441 Test Loss: 1.528 Test Acc: 0.441
Validation loss decreased (-0.396281 --> -0.440725).  Saving model ...
Epoch: 11 cost time: 0.7661397457122803
Epoch: 11, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.494 Vali Acc: 0.474 Test Loss: 1.494 Test Acc: 0.474
Validation loss decreased (-0.440725 --> -0.474059).  Saving model ...
Epoch: 12 cost time: 0.7557568550109863
Epoch: 12, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.459 Vali Acc: 0.519 Test Loss: 1.459 Test Acc: 0.519
Validation loss decreased (-0.474059 --> -0.518504).  Saving model ...
Epoch: 13 cost time: 0.8078079223632812
Epoch: 13, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.423 Vali Acc: 0.541 Test Loss: 1.423 Test Acc: 0.541
Validation loss decreased (-0.518504 --> -0.540727).  Saving model ...
Epoch: 14 cost time: 0.7739152908325195
Epoch: 14, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.387 Vali Acc: 0.563 Test Loss: 1.387 Test Acc: 0.563
Validation loss decreased (-0.540727 --> -0.562949).  Saving model ...
Epoch: 15 cost time: 0.829028844833374
Epoch: 15, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.350 Vali Acc: 0.585 Test Loss: 1.350 Test Acc: 0.585
Validation loss decreased (-0.562949 --> -0.585172).  Saving model ...
Epoch: 16 cost time: 0.8051984310150146
Epoch: 16, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.313 Vali Acc: 0.611 Test Loss: 1.313 Test Acc: 0.611
Validation loss decreased (-0.585172 --> -0.611098).  Saving model ...
Epoch: 17 cost time: 0.8562650680541992
Epoch: 17, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.275 Vali Acc: 0.648 Test Loss: 1.275 Test Acc: 0.648
Validation loss decreased (-0.611098 --> -0.648135).  Saving model ...
Epoch: 18 cost time: 0.8383569717407227
Epoch: 18, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.237 Vali Acc: 0.656 Test Loss: 1.237 Test Acc: 0.656
Validation loss decreased (-0.648135 --> -0.655543).  Saving model ...
Epoch: 19 cost time: 0.8077487945556641
Epoch: 19, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.200 Vali Acc: 0.685 Test Loss: 1.200 Test Acc: 0.685
Validation loss decreased (-0.655543 --> -0.685173).  Saving model ...
Epoch: 20 cost time: 0.8164854049682617
Epoch: 20, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.164 Vali Acc: 0.704 Test Loss: 1.164 Test Acc: 0.704
Validation loss decreased (-0.685173 --> -0.703692).  Saving model ...
Epoch: 21 cost time: 0.7810919284820557
Epoch: 21, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.127 Vali Acc: 0.730 Test Loss: 1.127 Test Acc: 0.730
Validation loss decreased (-0.703692 --> -0.729618).  Saving model ...
Epoch: 22 cost time: 0.8135988712310791
Epoch: 22, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.090 Vali Acc: 0.748 Test Loss: 1.090 Test Acc: 0.748
Validation loss decreased (-0.729618 --> -0.748137).  Saving model ...
Epoch: 23 cost time: 0.9076492786407471
Epoch: 23, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.054 Vali Acc: 0.767 Test Loss: 1.054 Test Acc: 0.767
Validation loss decreased (-0.748137 --> -0.766656).  Saving model ...
Epoch: 24 cost time: 0.8170838356018066
Epoch: 24, Steps: 2 | Train Loss: 0.865 Vali Loss: 1.019 Vali Acc: 0.774 Test Loss: 1.019 Test Acc: 0.774
Validation loss decreased (-0.766656 --> -0.774064).  Saving model ...
Epoch: 25 cost time: 0.7744617462158203
Epoch: 25, Steps: 2 | Train Loss: 0.840 Vali Loss: 0.985 Vali Acc: 0.778 Test Loss: 0.985 Test Acc: 0.778
Validation loss decreased (-0.774064 --> -0.777768).  Saving model ...
Epoch: 26 cost time: 0.8130533695220947
Epoch: 26, Steps: 2 | Train Loss: 0.806 Vali Loss: 0.952 Vali Acc: 0.789 Test Loss: 0.952 Test Acc: 0.789
Validation loss decreased (-0.777768 --> -0.788879).  Saving model ...
Epoch: 27 cost time: 0.7820281982421875
Epoch: 27, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.920 Vali Acc: 0.793 Test Loss: 0.920 Test Acc: 0.793
Validation loss decreased (-0.788879 --> -0.792583).  Saving model ...
Epoch: 28 cost time: 0.8997907638549805
Epoch: 28, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.889 Vali Acc: 0.804 Test Loss: 0.889 Test Acc: 0.804
Validation loss decreased (-0.792583 --> -0.803695).  Saving model ...
Epoch: 29 cost time: 0.8216526508331299
Epoch: 29, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.859 Vali Acc: 0.807 Test Loss: 0.859 Test Acc: 0.807
Validation loss decreased (-0.803695 --> -0.807399).  Saving model ...
Epoch: 30 cost time: 0.812492847442627
Epoch: 30, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.830 Vali Acc: 0.815 Test Loss: 0.830 Test Acc: 0.815
Validation loss decreased (-0.807399 --> -0.814807).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8148148148148148
model parameter : 1179142
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.425478458404541
Epoch: 1, Steps: 2 | Train Loss: 1.981 Vali Loss: 1.889 Vali Acc: 0.081 Test Loss: 1.889 Test Acc: 0.081
Validation loss decreased (inf --> -0.081463).  Saving model ...
Epoch: 2 cost time: 0.6458542346954346
Epoch: 2, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.856 Vali Acc: 0.100 Test Loss: 1.856 Test Acc: 0.100
Validation loss decreased (-0.081463 --> -0.099981).  Saving model ...
Epoch: 3 cost time: 0.6387953758239746
Epoch: 3, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.834 Vali Acc: 0.104 Test Loss: 1.834 Test Acc: 0.104
Validation loss decreased (-0.099981 --> -0.103685).  Saving model ...
Epoch: 4 cost time: 0.5795407295227051
Epoch: 4, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.816 Vali Acc: 0.107 Test Loss: 1.816 Test Acc: 0.107
Validation loss decreased (-0.103685 --> -0.107389).  Saving model ...
Epoch: 5 cost time: 0.5678119659423828
Epoch: 5, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.793 Vali Acc: 0.122 Test Loss: 1.793 Test Acc: 0.122
Validation loss decreased (-0.107389 --> -0.122204).  Saving model ...
Epoch: 6 cost time: 0.5611326694488525
Epoch: 6, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.766 Vali Acc: 0.137 Test Loss: 1.766 Test Acc: 0.137
Validation loss decreased (-0.122204 --> -0.137019).  Saving model ...
Epoch: 7 cost time: 0.6101980209350586
Epoch: 7, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.736 Vali Acc: 0.156 Test Loss: 1.736 Test Acc: 0.156
Validation loss decreased (-0.137019 --> -0.155538).  Saving model ...
Epoch: 8 cost time: 0.6276350021362305
Epoch: 8, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.703 Vali Acc: 0.178 Test Loss: 1.703 Test Acc: 0.178
Validation loss decreased (-0.155538 --> -0.177761).  Saving model ...
Epoch: 9 cost time: 0.6236767768859863
Epoch: 9, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.668 Vali Acc: 0.204 Test Loss: 1.668 Test Acc: 0.204
Validation loss decreased (-0.177761 --> -0.203687).  Saving model ...
Epoch: 10 cost time: 0.6165733337402344
Epoch: 10, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.630 Vali Acc: 0.237 Test Loss: 1.630 Test Acc: 0.237
Validation loss decreased (-0.203687 --> -0.237021).  Saving model ...
Epoch: 11 cost time: 0.6643674373626709
Epoch: 11, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.592 Vali Acc: 0.281 Test Loss: 1.592 Test Acc: 0.281
Validation loss decreased (-0.237021 --> -0.281466).  Saving model ...
Epoch: 12 cost time: 0.641080379486084
Epoch: 12, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.552 Vali Acc: 0.326 Test Loss: 1.552 Test Acc: 0.326
Validation loss decreased (-0.281466 --> -0.325910).  Saving model ...
Epoch: 13 cost time: 0.6988084316253662
Epoch: 13, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.512 Vali Acc: 0.374 Test Loss: 1.512 Test Acc: 0.374
Validation loss decreased (-0.325910 --> -0.374059).  Saving model ...
Epoch: 14 cost time: 0.6249301433563232
Epoch: 14, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.470 Vali Acc: 0.485 Test Loss: 1.470 Test Acc: 0.485
Validation loss decreased (-0.374059 --> -0.485170).  Saving model ...
Epoch: 15 cost time: 0.6470057964324951
Epoch: 15, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.428 Vali Acc: 0.567 Test Loss: 1.428 Test Acc: 0.567
Validation loss decreased (-0.485170 --> -0.566652).  Saving model ...
Epoch: 16 cost time: 0.6511640548706055
Epoch: 16, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.385 Vali Acc: 0.622 Test Loss: 1.385 Test Acc: 0.622
Validation loss decreased (-0.566652 --> -0.622208).  Saving model ...
Epoch: 17 cost time: 0.6163296699523926
Epoch: 17, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.341 Vali Acc: 0.681 Test Loss: 1.341 Test Acc: 0.681
Validation loss decreased (-0.622208 --> -0.681468).  Saving model ...
Epoch: 18 cost time: 0.566554069519043
Epoch: 18, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.297 Vali Acc: 0.722 Test Loss: 1.297 Test Acc: 0.722
Validation loss decreased (-0.681468 --> -0.722209).  Saving model ...
Epoch: 19 cost time: 0.6062052249908447
Epoch: 19, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.253 Vali Acc: 0.733 Test Loss: 1.253 Test Acc: 0.733
Validation loss decreased (-0.722209 --> -0.733321).  Saving model ...
Epoch: 20 cost time: 0.6713137626647949
Epoch: 20, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.209 Vali Acc: 0.770 Test Loss: 1.209 Test Acc: 0.770
Validation loss decreased (-0.733321 --> -0.770358).  Saving model ...
Epoch: 21 cost time: 0.5724895000457764
Epoch: 21, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.165 Vali Acc: 0.789 Test Loss: 1.165 Test Acc: 0.789
Validation loss decreased (-0.770358 --> -0.788877).  Saving model ...
Epoch: 22 cost time: 0.6685469150543213
Epoch: 22, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.122 Vali Acc: 0.819 Test Loss: 1.122 Test Acc: 0.819
Validation loss decreased (-0.788877 --> -0.818507).  Saving model ...
Epoch: 23 cost time: 0.6910831928253174
Epoch: 23, Steps: 2 | Train Loss: 1.027 Vali Loss: 1.079 Vali Acc: 0.830 Test Loss: 1.079 Test Acc: 0.830
Validation loss decreased (-0.818507 --> -0.829619).  Saving model ...
Epoch: 24 cost time: 0.5986566543579102
Epoch: 24, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.039 Vali Acc: 0.837 Test Loss: 1.039 Test Acc: 0.837
Validation loss decreased (-0.829619 --> -0.837027).  Saving model ...
Epoch: 25 cost time: 0.6457357406616211
Epoch: 25, Steps: 2 | Train Loss: 0.965 Vali Loss: 0.999 Vali Acc: 0.844 Test Loss: 0.999 Test Acc: 0.844
Validation loss decreased (-0.837027 --> -0.844434).  Saving model ...
Epoch: 26 cost time: 0.5793366432189941
Epoch: 26, Steps: 2 | Train Loss: 0.901 Vali Loss: 0.960 Vali Acc: 0.848 Test Loss: 0.960 Test Acc: 0.848
Validation loss decreased (-0.844434 --> -0.848139).  Saving model ...
Epoch: 27 cost time: 0.586824893951416
Epoch: 27, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.921 Vali Acc: 0.856 Test Loss: 0.921 Test Acc: 0.856
Validation loss decreased (-0.848139 --> -0.855546).  Saving model ...
Epoch: 28 cost time: 0.6345715522766113
Epoch: 28, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.884 Vali Acc: 0.859 Test Loss: 0.884 Test Acc: 0.859
Validation loss decreased (-0.855546 --> -0.859250).  Saving model ...
Epoch: 29 cost time: 0.6417961120605469
Epoch: 29, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.846 Vali Acc: 0.863 Test Loss: 0.846 Test Acc: 0.863
Validation loss decreased (-0.859250 --> -0.862955).  Saving model ...
Epoch: 30 cost time: 0.674217939376831
Epoch: 30, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.810 Vali Acc: 0.874 Test Loss: 0.810 Test Acc: 0.874
Validation loss decreased (-0.862955 --> -0.874066).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8740740740740741
model parameter : 351366
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.32472825050354
Epoch: 1, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.693 Vali Acc: 0.256 Test Loss: 1.693 Test Acc: 0.256
Validation loss decreased (inf --> -0.255539).  Saving model ...
Epoch: 2 cost time: 0.8427937030792236
Epoch: 2, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.669 Vali Acc: 0.285 Test Loss: 1.669 Test Acc: 0.285
Validation loss decreased (-0.255539 --> -0.285168).  Saving model ...
Epoch: 3 cost time: 0.9310791492462158
Epoch: 3, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.653 Vali Acc: 0.319 Test Loss: 1.653 Test Acc: 0.319
Validation loss decreased (-0.285168 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.7845556735992432
Epoch: 4, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.639 Vali Acc: 0.330 Test Loss: 1.639 Test Acc: 0.330
Validation loss decreased (-0.318502 --> -0.329613).  Saving model ...
Epoch: 5 cost time: 0.8562486171722412
Epoch: 5, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.621 Vali Acc: 0.352 Test Loss: 1.621 Test Acc: 0.352
Validation loss decreased (-0.329613 --> -0.351836).  Saving model ...
Epoch: 6 cost time: 0.9126484394073486
Epoch: 6, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.601 Vali Acc: 0.367 Test Loss: 1.601 Test Acc: 0.367
Validation loss decreased (-0.351836 --> -0.366651).  Saving model ...
Epoch: 7 cost time: 0.8570518493652344
Epoch: 7, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.578 Vali Acc: 0.385 Test Loss: 1.578 Test Acc: 0.385
Validation loss decreased (-0.366651 --> -0.385169).  Saving model ...
Epoch: 8 cost time: 0.9233596324920654
Epoch: 8, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.553 Vali Acc: 0.400 Test Loss: 1.553 Test Acc: 0.400
Validation loss decreased (-0.385169 --> -0.399984).  Saving model ...
Epoch: 9 cost time: 0.8814570903778076
Epoch: 9, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.526 Vali Acc: 0.419 Test Loss: 1.526 Test Acc: 0.419
Validation loss decreased (-0.399984 --> -0.418503).  Saving model ...
Epoch: 10 cost time: 0.9241538047790527
Epoch: 10, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.497 Vali Acc: 0.441 Test Loss: 1.497 Test Acc: 0.441
Validation loss decreased (-0.418503 --> -0.440726).  Saving model ...
Epoch: 11 cost time: 0.90238356590271
Epoch: 11, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.467 Vali Acc: 0.478 Test Loss: 1.467 Test Acc: 0.478
Validation loss decreased (-0.440726 --> -0.477763).  Saving model ...
Epoch: 12 cost time: 0.8449594974517822
Epoch: 12, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.436 Vali Acc: 0.500 Test Loss: 1.436 Test Acc: 0.500
Validation loss decreased (-0.477763 --> -0.499986).  Saving model ...
Epoch: 13 cost time: 0.9146358966827393
Epoch: 13, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.403 Vali Acc: 0.533 Test Loss: 1.403 Test Acc: 0.533
Validation loss decreased (-0.499986 --> -0.533319).  Saving model ...
Epoch: 14 cost time: 0.8512439727783203
Epoch: 14, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.369 Vali Acc: 0.578 Test Loss: 1.369 Test Acc: 0.578
Validation loss decreased (-0.533319 --> -0.577764).  Saving model ...
Epoch: 15 cost time: 0.9472801685333252
Epoch: 15, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.335 Vali Acc: 0.615 Test Loss: 1.335 Test Acc: 0.615
Validation loss decreased (-0.577764 --> -0.614801).  Saving model ...
Epoch: 16 cost time: 0.9344203472137451
Epoch: 16, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.300 Vali Acc: 0.644 Test Loss: 1.300 Test Acc: 0.644
Validation loss decreased (-0.614801 --> -0.644431).  Saving model ...
Epoch: 17 cost time: 0.8991937637329102
Epoch: 17, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.266 Vali Acc: 0.663 Test Loss: 1.266 Test Acc: 0.663
Validation loss decreased (-0.644431 --> -0.662950).  Saving model ...
Epoch: 18 cost time: 0.8852810859680176
Epoch: 18, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.231 Vali Acc: 0.674 Test Loss: 1.231 Test Acc: 0.674
Validation loss decreased (-0.662950 --> -0.674062).  Saving model ...
Epoch: 19 cost time: 1.0587158203125
Epoch: 19, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.195 Vali Acc: 0.693 Test Loss: 1.195 Test Acc: 0.693
Validation loss decreased (-0.674062 --> -0.692581).  Saving model ...
Epoch: 20 cost time: 0.9449129104614258
Epoch: 20, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.159 Vali Acc: 0.715 Test Loss: 1.159 Test Acc: 0.715
Validation loss decreased (-0.692581 --> -0.714803).  Saving model ...
Epoch: 21 cost time: 0.8197391033172607
Epoch: 21, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.124 Vali Acc: 0.730 Test Loss: 1.124 Test Acc: 0.730
Validation loss decreased (-0.714803 --> -0.729618).  Saving model ...
Epoch: 22 cost time: 0.9048004150390625
Epoch: 22, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.089 Vali Acc: 0.748 Test Loss: 1.089 Test Acc: 0.748
Validation loss decreased (-0.729618 --> -0.748137).  Saving model ...
Epoch: 23 cost time: 1.0492565631866455
Epoch: 23, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.055 Vali Acc: 0.759 Test Loss: 1.055 Test Acc: 0.759
Validation loss decreased (-0.748137 --> -0.759249).  Saving model ...
Epoch: 24 cost time: 0.9640071392059326
Epoch: 24, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.021 Vali Acc: 0.778 Test Loss: 1.021 Test Acc: 0.778
Validation loss decreased (-0.759249 --> -0.777768).  Saving model ...
Epoch: 25 cost time: 1.0013494491577148
Epoch: 25, Steps: 2 | Train Loss: 0.904 Vali Loss: 0.987 Vali Acc: 0.785 Test Loss: 0.987 Test Acc: 0.785
Validation loss decreased (-0.777768 --> -0.785175).  Saving model ...
Epoch: 26 cost time: 0.9895024299621582
Epoch: 26, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.953 Vali Acc: 0.796 Test Loss: 0.953 Test Acc: 0.796
Validation loss decreased (-0.785175 --> -0.796287).  Saving model ...
Epoch: 27 cost time: 0.93959641456604
Epoch: 27, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.921 Vali Acc: 0.811 Test Loss: 0.921 Test Acc: 0.811
Validation loss decreased (-0.796287 --> -0.811102).  Saving model ...
Epoch: 28 cost time: 0.8816578388214111
Epoch: 28, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.888 Vali Acc: 0.819 Test Loss: 0.888 Test Acc: 0.819
Validation loss decreased (-0.811102 --> -0.818510).  Saving model ...
Epoch: 29 cost time: 0.9662425518035889
Epoch: 29, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.856 Vali Acc: 0.826 Test Loss: 0.856 Test Acc: 0.826
Validation loss decreased (-0.818510 --> -0.825917).  Saving model ...
Epoch: 30 cost time: 1.015815258026123
Epoch: 30, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.826 Vali Acc: 0.833 Test Loss: 0.826 Test Acc: 0.833
Validation loss decreased (-0.825917 --> -0.833325).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8333333333333334
model parameter : 593030
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4581077098846436
Epoch: 1, Steps: 2 | Train Loss: 1.954 Vali Loss: 1.866 Vali Acc: 0.241 Test Loss: 1.866 Test Acc: 0.241
Validation loss decreased (inf --> -0.240722).  Saving model ...
Epoch: 2 cost time: 0.820906400680542
Epoch: 2, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.838 Vali Acc: 0.248 Test Loss: 1.838 Test Acc: 0.248
Validation loss decreased (-0.240722 --> -0.248130).  Saving model ...
Epoch: 3 cost time: 0.80605149269104
Epoch: 3, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.819 Vali Acc: 0.256 Test Loss: 1.819 Test Acc: 0.256
Validation loss decreased (-0.248130 --> -0.255537).  Saving model ...
Epoch: 4 cost time: 0.8170526027679443
Epoch: 4, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.803 Vali Acc: 0.256 Test Loss: 1.803 Test Acc: 0.256
Validation loss decreased (-0.255537 --> -0.255538).  Saving model ...
Epoch: 5 cost time: 0.8493845462799072
Epoch: 5, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.783 Vali Acc: 0.270 Test Loss: 1.783 Test Acc: 0.270
Validation loss decreased (-0.255538 --> -0.270353).  Saving model ...
Epoch: 6 cost time: 0.8127944469451904
Epoch: 6, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.759 Vali Acc: 0.278 Test Loss: 1.759 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277760).  Saving model ...
Epoch: 7 cost time: 0.8513028621673584
Epoch: 7, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.732 Vali Acc: 0.285 Test Loss: 1.732 Test Acc: 0.285
Validation loss decreased (-0.277760 --> -0.285168).  Saving model ...
Epoch: 8 cost time: 0.8233685493469238
Epoch: 8, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.703 Vali Acc: 0.307 Test Loss: 1.703 Test Acc: 0.307
Validation loss decreased (-0.285168 --> -0.307390).  Saving model ...
Epoch: 9 cost time: 0.8946366310119629
Epoch: 9, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.671 Vali Acc: 0.319 Test Loss: 1.671 Test Acc: 0.319
Validation loss decreased (-0.307390 --> -0.318502).  Saving model ...
Epoch: 10 cost time: 0.8367099761962891
Epoch: 10, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.638 Vali Acc: 0.337 Test Loss: 1.638 Test Acc: 0.337
Validation loss decreased (-0.318502 --> -0.337021).  Saving model ...
Epoch: 11 cost time: 0.8370137214660645
Epoch: 11, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.603 Vali Acc: 0.378 Test Loss: 1.603 Test Acc: 0.378
Validation loss decreased (-0.337021 --> -0.377762).  Saving model ...
Epoch: 12 cost time: 0.9119412899017334
Epoch: 12, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.566 Vali Acc: 0.415 Test Loss: 1.566 Test Acc: 0.415
Validation loss decreased (-0.377762 --> -0.414799).  Saving model ...
Epoch: 13 cost time: 0.8773853778839111
Epoch: 13, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.528 Vali Acc: 0.448 Test Loss: 1.528 Test Acc: 0.448
Validation loss decreased (-0.414799 --> -0.448133).  Saving model ...
Epoch: 14 cost time: 0.8040404319763184
Epoch: 14, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.489 Vali Acc: 0.522 Test Loss: 1.489 Test Acc: 0.522
Validation loss decreased (-0.448133 --> -0.522207).  Saving model ...
Epoch: 15 cost time: 0.8997902870178223
Epoch: 15, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.449 Vali Acc: 0.630 Test Loss: 1.449 Test Acc: 0.630
Validation loss decreased (-0.522207 --> -0.629615).  Saving model ...
Epoch: 16 cost time: 0.807020902633667
Epoch: 16, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.407 Vali Acc: 0.715 Test Loss: 1.407 Test Acc: 0.715
Validation loss decreased (-0.629615 --> -0.714801).  Saving model ...
Epoch: 17 cost time: 0.8260760307312012
Epoch: 17, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.365 Vali Acc: 0.748 Test Loss: 1.365 Test Acc: 0.748
Validation loss decreased (-0.714801 --> -0.748135).  Saving model ...
Epoch: 18 cost time: 0.710874080657959
Epoch: 18, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.323 Vali Acc: 0.778 Test Loss: 1.323 Test Acc: 0.778
Validation loss decreased (-0.748135 --> -0.777765).  Saving model ...
Epoch: 19 cost time: 0.87882399559021
Epoch: 19, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.281 Vali Acc: 0.781 Test Loss: 1.281 Test Acc: 0.781
Validation loss decreased (-0.777765 --> -0.781469).  Saving model ...
Epoch: 20 cost time: 0.9034867286682129
Epoch: 20, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.239 Vali Acc: 0.789 Test Loss: 1.239 Test Acc: 0.789
Validation loss decreased (-0.781469 --> -0.788876).  Saving model ...
Epoch: 21 cost time: 0.8950960636138916
Epoch: 21, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.198 Vali Acc: 0.796 Test Loss: 1.198 Test Acc: 0.796
Validation loss decreased (-0.788876 --> -0.796284).  Saving model ...
Epoch: 22 cost time: 0.9062836170196533
Epoch: 22, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.157 Vali Acc: 0.796 Test Loss: 1.157 Test Acc: 0.796
Validation loss decreased (-0.796284 --> -0.796285).  Saving model ...
Epoch: 23 cost time: 0.8606421947479248
Epoch: 23, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.117 Vali Acc: 0.811 Test Loss: 1.117 Test Acc: 0.811
Validation loss decreased (-0.796285 --> -0.811100).  Saving model ...
Epoch: 24 cost time: 0.7942099571228027
Epoch: 24, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.077 Vali Acc: 0.830 Test Loss: 1.077 Test Acc: 0.830
Validation loss decreased (-0.811100 --> -0.829619).  Saving model ...
Epoch: 25 cost time: 1.0117743015289307
Epoch: 25, Steps: 2 | Train Loss: 0.982 Vali Loss: 1.038 Vali Acc: 0.830 Test Loss: 1.038 Test Acc: 0.830
Validation loss decreased (-0.829619 --> -0.829619).  Saving model ...
Epoch: 26 cost time: 0.7939586639404297
Epoch: 26, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.000 Vali Acc: 0.837 Test Loss: 1.000 Test Acc: 0.837
Validation loss decreased (-0.829619 --> -0.837027).  Saving model ...
Epoch: 27 cost time: 0.8706965446472168
Epoch: 27, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.964 Vali Acc: 0.833 Test Loss: 0.964 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8821964263916016
Epoch: 28, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.929 Vali Acc: 0.841 Test Loss: 0.929 Test Acc: 0.841
Validation loss decreased (-0.837027 --> -0.840731).  Saving model ...
Epoch: 29 cost time: 0.8832459449768066
Epoch: 29, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.896 Vali Acc: 0.844 Test Loss: 0.896 Test Acc: 0.844
Validation loss decreased (-0.840731 --> -0.844435).  Saving model ...
Epoch: 30 cost time: 0.9458198547363281
Epoch: 30, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.864 Vali Acc: 0.852 Test Loss: 0.864 Test Acc: 0.852
Validation loss decreased (-0.844435 --> -0.851843).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8518518518518519
model parameter : 179078
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.720339775085449
Epoch: 1, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.693 Vali Acc: 0.256 Test Loss: 1.693 Test Acc: 0.256
Validation loss decreased (inf --> -0.255539).  Saving model ...
Epoch: 2 cost time: 0.8549003601074219
Epoch: 2, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.669 Vali Acc: 0.285 Test Loss: 1.669 Test Acc: 0.285
Validation loss decreased (-0.255539 --> -0.285168).  Saving model ...
Epoch: 3 cost time: 0.805668830871582
Epoch: 3, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.653 Vali Acc: 0.319 Test Loss: 1.653 Test Acc: 0.319
Validation loss decreased (-0.285168 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.7946450710296631
Epoch: 4, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.639 Vali Acc: 0.330 Test Loss: 1.639 Test Acc: 0.330
Validation loss decreased (-0.318502 --> -0.329613).  Saving model ...
Epoch: 5 cost time: 0.9047200679779053
Epoch: 5, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.622 Vali Acc: 0.352 Test Loss: 1.622 Test Acc: 0.352
Validation loss decreased (-0.329613 --> -0.351836).  Saving model ...
Epoch: 6 cost time: 0.9020576477050781
Epoch: 6, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.601 Vali Acc: 0.367 Test Loss: 1.601 Test Acc: 0.367
Validation loss decreased (-0.351836 --> -0.366651).  Saving model ...
Epoch: 7 cost time: 0.9484958648681641
Epoch: 7, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.578 Vali Acc: 0.385 Test Loss: 1.578 Test Acc: 0.385
Validation loss decreased (-0.366651 --> -0.385169).  Saving model ...
Epoch: 8 cost time: 0.8300168514251709
Epoch: 8, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.553 Vali Acc: 0.400 Test Loss: 1.553 Test Acc: 0.400
Validation loss decreased (-0.385169 --> -0.399984).  Saving model ...
Epoch: 9 cost time: 0.8356335163116455
Epoch: 9, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.526 Vali Acc: 0.419 Test Loss: 1.526 Test Acc: 0.419
Validation loss decreased (-0.399984 --> -0.418503).  Saving model ...
Epoch: 10 cost time: 0.8165090084075928
Epoch: 10, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.498 Vali Acc: 0.441 Test Loss: 1.498 Test Acc: 0.441
Validation loss decreased (-0.418503 --> -0.440726).  Saving model ...
Epoch: 11 cost time: 0.885345458984375
Epoch: 11, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.468 Vali Acc: 0.478 Test Loss: 1.468 Test Acc: 0.478
Validation loss decreased (-0.440726 --> -0.477763).  Saving model ...
Epoch: 12 cost time: 0.8591992855072021
Epoch: 12, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.436 Vali Acc: 0.500 Test Loss: 1.436 Test Acc: 0.500
Validation loss decreased (-0.477763 --> -0.499986).  Saving model ...
Epoch: 13 cost time: 0.8404734134674072
Epoch: 13, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.403 Vali Acc: 0.533 Test Loss: 1.403 Test Acc: 0.533
Validation loss decreased (-0.499986 --> -0.533319).  Saving model ...
Epoch: 14 cost time: 0.8542008399963379
Epoch: 14, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.369 Vali Acc: 0.578 Test Loss: 1.369 Test Acc: 0.578
Validation loss decreased (-0.533319 --> -0.577764).  Saving model ...
Epoch: 15 cost time: 0.8592290878295898
Epoch: 15, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.335 Vali Acc: 0.615 Test Loss: 1.335 Test Acc: 0.615
Validation loss decreased (-0.577764 --> -0.614801).  Saving model ...
Epoch: 16 cost time: 0.8113200664520264
Epoch: 16, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.300 Vali Acc: 0.641 Test Loss: 1.300 Test Acc: 0.641
Validation loss decreased (-0.614801 --> -0.640728).  Saving model ...
Epoch: 17 cost time: 0.8146193027496338
Epoch: 17, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.266 Vali Acc: 0.663 Test Loss: 1.266 Test Acc: 0.663
Validation loss decreased (-0.640728 --> -0.662950).  Saving model ...
Epoch: 18 cost time: 0.8772578239440918
Epoch: 18, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.231 Vali Acc: 0.674 Test Loss: 1.231 Test Acc: 0.674
Validation loss decreased (-0.662950 --> -0.674062).  Saving model ...
Epoch: 19 cost time: 0.8730130195617676
Epoch: 19, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.195 Vali Acc: 0.693 Test Loss: 1.195 Test Acc: 0.693
Validation loss decreased (-0.674062 --> -0.692581).  Saving model ...
Epoch: 20 cost time: 0.9193079471588135
Epoch: 20, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.159 Vali Acc: 0.711 Test Loss: 1.159 Test Acc: 0.711
Validation loss decreased (-0.692581 --> -0.711100).  Saving model ...
Epoch: 21 cost time: 0.8229608535766602
Epoch: 21, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.124 Vali Acc: 0.730 Test Loss: 1.124 Test Acc: 0.730
Validation loss decreased (-0.711100 --> -0.729618).  Saving model ...
Epoch: 22 cost time: 0.7777740955352783
Epoch: 22, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.089 Vali Acc: 0.748 Test Loss: 1.089 Test Acc: 0.748
Validation loss decreased (-0.729618 --> -0.748137).  Saving model ...
Epoch: 23 cost time: 0.8315722942352295
Epoch: 23, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.055 Vali Acc: 0.759 Test Loss: 1.055 Test Acc: 0.759
Validation loss decreased (-0.748137 --> -0.759249).  Saving model ...
Epoch: 24 cost time: 0.826439619064331
Epoch: 24, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.021 Vali Acc: 0.778 Test Loss: 1.021 Test Acc: 0.778
Validation loss decreased (-0.759249 --> -0.777768).  Saving model ...
Epoch: 25 cost time: 0.81260085105896
Epoch: 25, Steps: 2 | Train Loss: 0.904 Vali Loss: 0.987 Vali Acc: 0.785 Test Loss: 0.987 Test Acc: 0.785
Validation loss decreased (-0.777768 --> -0.785175).  Saving model ...
Epoch: 26 cost time: 0.9257323741912842
Epoch: 26, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.954 Vali Acc: 0.796 Test Loss: 0.954 Test Acc: 0.796
Validation loss decreased (-0.785175 --> -0.796287).  Saving model ...
Epoch: 27 cost time: 0.8431453704833984
Epoch: 27, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.921 Vali Acc: 0.811 Test Loss: 0.921 Test Acc: 0.811
Validation loss decreased (-0.796287 --> -0.811102).  Saving model ...
Epoch: 28 cost time: 0.8163857460021973
Epoch: 28, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.888 Vali Acc: 0.819 Test Loss: 0.888 Test Acc: 0.819
Validation loss decreased (-0.811102 --> -0.818510).  Saving model ...
Epoch: 29 cost time: 0.8067395687103271
Epoch: 29, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.857 Vali Acc: 0.826 Test Loss: 0.857 Test Acc: 0.826
Validation loss decreased (-0.818510 --> -0.825917).  Saving model ...
Epoch: 30 cost time: 0.8467044830322266
Epoch: 30, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.826 Vali Acc: 0.833 Test Loss: 0.826 Test Acc: 0.833
Validation loss decreased (-0.825917 --> -0.833325).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8333333333333334
model parameter : 593030
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5771431922912598
Epoch: 1, Steps: 2 | Train Loss: 1.954 Vali Loss: 1.866 Vali Acc: 0.241 Test Loss: 1.866 Test Acc: 0.241
Validation loss decreased (inf --> -0.240722).  Saving model ...
Epoch: 2 cost time: 0.7393951416015625
Epoch: 2, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.838 Vali Acc: 0.248 Test Loss: 1.838 Test Acc: 0.248
Validation loss decreased (-0.240722 --> -0.248130).  Saving model ...
Epoch: 3 cost time: 0.7469391822814941
Epoch: 3, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.819 Vali Acc: 0.256 Test Loss: 1.819 Test Acc: 0.256
Validation loss decreased (-0.248130 --> -0.255537).  Saving model ...
Epoch: 4 cost time: 0.9150643348693848
Epoch: 4, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.803 Vali Acc: 0.256 Test Loss: 1.803 Test Acc: 0.256
Validation loss decreased (-0.255537 --> -0.255538).  Saving model ...
Epoch: 5 cost time: 0.6621582508087158
Epoch: 5, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.783 Vali Acc: 0.270 Test Loss: 1.783 Test Acc: 0.270
Validation loss decreased (-0.255538 --> -0.270353).  Saving model ...
Epoch: 6 cost time: 0.7755265235900879
Epoch: 6, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.759 Vali Acc: 0.278 Test Loss: 1.759 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277760).  Saving model ...
Epoch: 7 cost time: 0.6759796142578125
Epoch: 7, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.732 Vali Acc: 0.285 Test Loss: 1.732 Test Acc: 0.285
Validation loss decreased (-0.277760 --> -0.285168).  Saving model ...
Epoch: 8 cost time: 0.7657012939453125
Epoch: 8, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.703 Vali Acc: 0.307 Test Loss: 1.703 Test Acc: 0.307
Validation loss decreased (-0.285168 --> -0.307390).  Saving model ...
Epoch: 9 cost time: 0.6808295249938965
Epoch: 9, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.671 Vali Acc: 0.319 Test Loss: 1.671 Test Acc: 0.319
Validation loss decreased (-0.307390 --> -0.318502).  Saving model ...
Epoch: 10 cost time: 0.8114697933197021
Epoch: 10, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.638 Vali Acc: 0.337 Test Loss: 1.638 Test Acc: 0.337
Validation loss decreased (-0.318502 --> -0.337021).  Saving model ...
Epoch: 11 cost time: 0.7403528690338135
Epoch: 11, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.603 Vali Acc: 0.378 Test Loss: 1.603 Test Acc: 0.378
Validation loss decreased (-0.337021 --> -0.377762).  Saving model ...
Epoch: 12 cost time: 0.7907059192657471
Epoch: 12, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.566 Vali Acc: 0.415 Test Loss: 1.566 Test Acc: 0.415
Validation loss decreased (-0.377762 --> -0.414799).  Saving model ...
Epoch: 13 cost time: 0.8806684017181396
Epoch: 13, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.528 Vali Acc: 0.448 Test Loss: 1.528 Test Acc: 0.448
Validation loss decreased (-0.414799 --> -0.448133).  Saving model ...
Epoch: 14 cost time: 0.7243497371673584
Epoch: 14, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.489 Vali Acc: 0.522 Test Loss: 1.489 Test Acc: 0.522
Validation loss decreased (-0.448133 --> -0.522207).  Saving model ...
Epoch: 15 cost time: 0.8933851718902588
Epoch: 15, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.449 Vali Acc: 0.630 Test Loss: 1.449 Test Acc: 0.630
Validation loss decreased (-0.522207 --> -0.629615).  Saving model ...
Epoch: 16 cost time: 0.8230664730072021
Epoch: 16, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.407 Vali Acc: 0.715 Test Loss: 1.407 Test Acc: 0.715
Validation loss decreased (-0.629615 --> -0.714801).  Saving model ...
Epoch: 17 cost time: 0.7782061100006104
Epoch: 17, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.365 Vali Acc: 0.748 Test Loss: 1.365 Test Acc: 0.748
Validation loss decreased (-0.714801 --> -0.748135).  Saving model ...
Epoch: 18 cost time: 0.7622666358947754
Epoch: 18, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.323 Vali Acc: 0.778 Test Loss: 1.323 Test Acc: 0.778
Validation loss decreased (-0.748135 --> -0.777765).  Saving model ...
Epoch: 19 cost time: 0.7370939254760742
Epoch: 19, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.281 Vali Acc: 0.781 Test Loss: 1.281 Test Acc: 0.781
Validation loss decreased (-0.777765 --> -0.781469).  Saving model ...
Epoch: 20 cost time: 0.7981574535369873
Epoch: 20, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.239 Vali Acc: 0.789 Test Loss: 1.239 Test Acc: 0.789
Validation loss decreased (-0.781469 --> -0.788876).  Saving model ...
Epoch: 21 cost time: 0.7948706150054932
Epoch: 21, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.198 Vali Acc: 0.796 Test Loss: 1.198 Test Acc: 0.796
Validation loss decreased (-0.788876 --> -0.796284).  Saving model ...
Epoch: 22 cost time: 0.7723712921142578
Epoch: 22, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.157 Vali Acc: 0.796 Test Loss: 1.157 Test Acc: 0.796
Validation loss decreased (-0.796284 --> -0.796285).  Saving model ...
Epoch: 23 cost time: 0.8380343914031982
Epoch: 23, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.117 Vali Acc: 0.811 Test Loss: 1.117 Test Acc: 0.811
Validation loss decreased (-0.796285 --> -0.811100).  Saving model ...
Epoch: 24 cost time: 0.7530460357666016
Epoch: 24, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.077 Vali Acc: 0.830 Test Loss: 1.077 Test Acc: 0.830
Validation loss decreased (-0.811100 --> -0.829619).  Saving model ...
Epoch: 25 cost time: 0.7888643741607666
Epoch: 25, Steps: 2 | Train Loss: 0.982 Vali Loss: 1.038 Vali Acc: 0.830 Test Loss: 1.038 Test Acc: 0.830
Validation loss decreased (-0.829619 --> -0.829619).  Saving model ...
Epoch: 26 cost time: 0.8593113422393799
Epoch: 26, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.000 Vali Acc: 0.837 Test Loss: 1.000 Test Acc: 0.837
Validation loss decreased (-0.829619 --> -0.837027).  Saving model ...
Epoch: 27 cost time: 0.7344539165496826
Epoch: 27, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.964 Vali Acc: 0.833 Test Loss: 0.964 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8220164775848389
Epoch: 28, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.929 Vali Acc: 0.841 Test Loss: 0.929 Test Acc: 0.841
Validation loss decreased (-0.837027 --> -0.840731).  Saving model ...
Epoch: 29 cost time: 0.70951247215271
Epoch: 29, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.896 Vali Acc: 0.844 Test Loss: 0.896 Test Acc: 0.844
Validation loss decreased (-0.840731 --> -0.844435).  Saving model ...
Epoch: 30 cost time: 0.7644193172454834
Epoch: 30, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.864 Vali Acc: 0.852 Test Loss: 0.864 Test Acc: 0.852
Validation loss decreased (-0.844435 --> -0.851843).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8518518518518519
model parameter : 179078
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.34328031539917
Epoch: 1, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.693 Vali Acc: 0.256 Test Loss: 1.693 Test Acc: 0.256
Validation loss decreased (inf --> -0.255539).  Saving model ...
Epoch: 2 cost time: 0.704749345779419
Epoch: 2, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.669 Vali Acc: 0.285 Test Loss: 1.669 Test Acc: 0.285
Validation loss decreased (-0.255539 --> -0.285168).  Saving model ...
Epoch: 3 cost time: 0.7084958553314209
Epoch: 3, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.653 Vali Acc: 0.315 Test Loss: 1.653 Test Acc: 0.315
Validation loss decreased (-0.285168 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 0.6959865093231201
Epoch: 4, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.640 Vali Acc: 0.333 Test Loss: 1.640 Test Acc: 0.333
Validation loss decreased (-0.314798 --> -0.333317).  Saving model ...
Epoch: 5 cost time: 0.7325937747955322
Epoch: 5, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.622 Vali Acc: 0.356 Test Loss: 1.622 Test Acc: 0.356
Validation loss decreased (-0.333317 --> -0.355539).  Saving model ...
Epoch: 6 cost time: 0.6496169567108154
Epoch: 6, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.602 Vali Acc: 0.370 Test Loss: 1.602 Test Acc: 0.370
Validation loss decreased (-0.355539 --> -0.370354).  Saving model ...
Epoch: 7 cost time: 0.6271622180938721
Epoch: 7, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.579 Vali Acc: 0.385 Test Loss: 1.579 Test Acc: 0.385
Validation loss decreased (-0.370354 --> -0.385169).  Saving model ...
Epoch: 8 cost time: 0.7008707523345947
Epoch: 8, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.554 Vali Acc: 0.400 Test Loss: 1.554 Test Acc: 0.400
Validation loss decreased (-0.385169 --> -0.399984).  Saving model ...
Epoch: 9 cost time: 0.6836144924163818
Epoch: 9, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.527 Vali Acc: 0.419 Test Loss: 1.527 Test Acc: 0.419
Validation loss decreased (-0.399984 --> -0.418503).  Saving model ...
Epoch: 10 cost time: 0.6731486320495605
Epoch: 10, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.499 Vali Acc: 0.441 Test Loss: 1.499 Test Acc: 0.441
Validation loss decreased (-0.418503 --> -0.440726).  Saving model ...
Epoch: 11 cost time: 0.7284834384918213
Epoch: 11, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.470 Vali Acc: 0.478 Test Loss: 1.470 Test Acc: 0.478
Validation loss decreased (-0.440726 --> -0.477763).  Saving model ...
Epoch: 12 cost time: 0.648813009262085
Epoch: 12, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.438 Vali Acc: 0.500 Test Loss: 1.438 Test Acc: 0.500
Validation loss decreased (-0.477763 --> -0.499986).  Saving model ...
Epoch: 13 cost time: 0.7346010208129883
Epoch: 13, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.406 Vali Acc: 0.530 Test Loss: 1.406 Test Acc: 0.530
Validation loss decreased (-0.499986 --> -0.529616).  Saving model ...
Epoch: 14 cost time: 0.7007203102111816
Epoch: 14, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.372 Vali Acc: 0.578 Test Loss: 1.372 Test Acc: 0.578
Validation loss decreased (-0.529616 --> -0.577764).  Saving model ...
Epoch: 15 cost time: 0.6030795574188232
Epoch: 15, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.338 Vali Acc: 0.615 Test Loss: 1.338 Test Acc: 0.615
Validation loss decreased (-0.577764 --> -0.614801).  Saving model ...
Epoch: 16 cost time: 0.7588784694671631
Epoch: 16, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.304 Vali Acc: 0.641 Test Loss: 1.304 Test Acc: 0.641
Validation loss decreased (-0.614801 --> -0.640728).  Saving model ...
Epoch: 17 cost time: 0.6773595809936523
Epoch: 17, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.270 Vali Acc: 0.663 Test Loss: 1.270 Test Acc: 0.663
Validation loss decreased (-0.640728 --> -0.662950).  Saving model ...
Epoch: 18 cost time: 0.6353366374969482
Epoch: 18, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.235 Vali Acc: 0.678 Test Loss: 1.235 Test Acc: 0.678
Validation loss decreased (-0.662950 --> -0.677765).  Saving model ...
Epoch: 19 cost time: 0.7202298641204834
Epoch: 19, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.200 Vali Acc: 0.696 Test Loss: 1.200 Test Acc: 0.696
Validation loss decreased (-0.677765 --> -0.696284).  Saving model ...
Epoch: 20 cost time: 0.6820447444915771
Epoch: 20, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.164 Vali Acc: 0.715 Test Loss: 1.164 Test Acc: 0.715
Validation loss decreased (-0.696284 --> -0.714803).  Saving model ...
Epoch: 21 cost time: 0.6111454963684082
Epoch: 21, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.129 Vali Acc: 0.726 Test Loss: 1.129 Test Acc: 0.726
Validation loss decreased (-0.714803 --> -0.725915).  Saving model ...
Epoch: 22 cost time: 0.6769871711730957
Epoch: 22, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.095 Vali Acc: 0.748 Test Loss: 1.095 Test Acc: 0.748
Validation loss decreased (-0.725915 --> -0.748137).  Saving model ...
Epoch: 23 cost time: 0.7114536762237549
Epoch: 23, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.061 Vali Acc: 0.759 Test Loss: 1.061 Test Acc: 0.759
Validation loss decreased (-0.748137 --> -0.759249).  Saving model ...
Epoch: 24 cost time: 0.721320390701294
Epoch: 24, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.027 Vali Acc: 0.774 Test Loss: 1.027 Test Acc: 0.774
Validation loss decreased (-0.759249 --> -0.774064).  Saving model ...
Epoch: 25 cost time: 0.7135992050170898
Epoch: 25, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.993 Vali Acc: 0.781 Test Loss: 0.993 Test Acc: 0.781
Validation loss decreased (-0.774064 --> -0.781472).  Saving model ...
Epoch: 26 cost time: 0.6673095226287842
Epoch: 26, Steps: 2 | Train Loss: 0.876 Vali Loss: 0.960 Vali Acc: 0.785 Test Loss: 0.960 Test Acc: 0.785
Validation loss decreased (-0.781472 --> -0.785176).  Saving model ...
Epoch: 27 cost time: 0.6554470062255859
Epoch: 27, Steps: 2 | Train Loss: 0.845 Vali Loss: 0.928 Vali Acc: 0.811 Test Loss: 0.928 Test Acc: 0.811
Validation loss decreased (-0.785176 --> -0.811102).  Saving model ...
Epoch: 28 cost time: 0.6798455715179443
Epoch: 28, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.895 Vali Acc: 0.826 Test Loss: 0.895 Test Acc: 0.826
Validation loss decreased (-0.811102 --> -0.825917).  Saving model ...
Epoch: 29 cost time: 0.7116029262542725
Epoch: 29, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.864 Vali Acc: 0.826 Test Loss: 0.864 Test Acc: 0.826
Validation loss decreased (-0.825917 --> -0.825917).  Saving model ...
Epoch: 30 cost time: 0.7289860248565674
Epoch: 30, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.833 Vali Acc: 0.830 Test Loss: 0.833 Test Acc: 0.830
Validation loss decreased (-0.825917 --> -0.829621).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8296296296296296
model parameter : 593030
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1636364459991455
Epoch: 1, Steps: 2 | Train Loss: 1.955 Vali Loss: 1.867 Vali Acc: 0.241 Test Loss: 1.867 Test Acc: 0.241
Validation loss decreased (inf --> -0.240722).  Saving model ...
Epoch: 2 cost time: 0.7247195243835449
Epoch: 2, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.840 Vali Acc: 0.248 Test Loss: 1.840 Test Acc: 0.248
Validation loss decreased (-0.240722 --> -0.248130).  Saving model ...
Epoch: 3 cost time: 0.6405131816864014
Epoch: 3, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.820 Vali Acc: 0.256 Test Loss: 1.820 Test Acc: 0.256
Validation loss decreased (-0.248130 --> -0.255537).  Saving model ...
Epoch: 4 cost time: 0.6645293235778809
Epoch: 4, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.805 Vali Acc: 0.256 Test Loss: 1.805 Test Acc: 0.256
Validation loss decreased (-0.255537 --> -0.255538).  Saving model ...
Epoch: 5 cost time: 0.6459307670593262
Epoch: 5, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.784 Vali Acc: 0.270 Test Loss: 1.784 Test Acc: 0.270
Validation loss decreased (-0.255538 --> -0.270353).  Saving model ...
Epoch: 6 cost time: 0.557748556137085
Epoch: 6, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.761 Vali Acc: 0.278 Test Loss: 1.761 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277760).  Saving model ...
Epoch: 7 cost time: 0.6813325881958008
Epoch: 7, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.734 Vali Acc: 0.285 Test Loss: 1.734 Test Acc: 0.285
Validation loss decreased (-0.277760 --> -0.285168).  Saving model ...
Epoch: 8 cost time: 0.701531171798706
Epoch: 8, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.705 Vali Acc: 0.311 Test Loss: 1.705 Test Acc: 0.311
Validation loss decreased (-0.285168 --> -0.311094).  Saving model ...
Epoch: 9 cost time: 0.6197905540466309
Epoch: 9, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.673 Vali Acc: 0.319 Test Loss: 1.673 Test Acc: 0.319
Validation loss decreased (-0.311094 --> -0.318502).  Saving model ...
Epoch: 10 cost time: 0.6502203941345215
Epoch: 10, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.640 Vali Acc: 0.337 Test Loss: 1.640 Test Acc: 0.337
Validation loss decreased (-0.318502 --> -0.337021).  Saving model ...
Epoch: 11 cost time: 0.6387228965759277
Epoch: 11, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.605 Vali Acc: 0.378 Test Loss: 1.605 Test Acc: 0.378
Validation loss decreased (-0.337021 --> -0.377762).  Saving model ...
Epoch: 12 cost time: 0.6551530361175537
Epoch: 12, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.569 Vali Acc: 0.407 Test Loss: 1.569 Test Acc: 0.407
Validation loss decreased (-0.377762 --> -0.407392).  Saving model ...
Epoch: 13 cost time: 0.6812372207641602
Epoch: 13, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.531 Vali Acc: 0.448 Test Loss: 1.531 Test Acc: 0.448
Validation loss decreased (-0.407392 --> -0.448133).  Saving model ...
Epoch: 14 cost time: 0.6418499946594238
Epoch: 14, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.492 Vali Acc: 0.515 Test Loss: 1.492 Test Acc: 0.515
Validation loss decreased (-0.448133 --> -0.514800).  Saving model ...
Epoch: 15 cost time: 0.6087675094604492
Epoch: 15, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.451 Vali Acc: 0.626 Test Loss: 1.451 Test Acc: 0.626
Validation loss decreased (-0.514800 --> -0.625911).  Saving model ...
Epoch: 16 cost time: 0.6383533477783203
Epoch: 16, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.410 Vali Acc: 0.707 Test Loss: 1.410 Test Acc: 0.707
Validation loss decreased (-0.625911 --> -0.707393).  Saving model ...
Epoch: 17 cost time: 0.6769125461578369
Epoch: 17, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.367 Vali Acc: 0.744 Test Loss: 1.367 Test Acc: 0.744
Validation loss decreased (-0.707393 --> -0.744431).  Saving model ...
Epoch: 18 cost time: 0.6295113563537598
Epoch: 18, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.326 Vali Acc: 0.770 Test Loss: 1.326 Test Acc: 0.770
Validation loss decreased (-0.744431 --> -0.770357).  Saving model ...
Epoch: 19 cost time: 0.642409086227417
Epoch: 19, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.284 Vali Acc: 0.781 Test Loss: 1.284 Test Acc: 0.781
Validation loss decreased (-0.770357 --> -0.781469).  Saving model ...
Epoch: 20 cost time: 0.7138152122497559
Epoch: 20, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.242 Vali Acc: 0.789 Test Loss: 1.242 Test Acc: 0.789
Validation loss decreased (-0.781469 --> -0.788876).  Saving model ...
Epoch: 21 cost time: 0.6633234024047852
Epoch: 21, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.201 Vali Acc: 0.796 Test Loss: 1.201 Test Acc: 0.796
Validation loss decreased (-0.788876 --> -0.796284).  Saving model ...
Epoch: 22 cost time: 0.6071350574493408
Epoch: 22, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.160 Vali Acc: 0.796 Test Loss: 1.160 Test Acc: 0.796
Validation loss decreased (-0.796284 --> -0.796285).  Saving model ...
Epoch: 23 cost time: 0.6095921993255615
Epoch: 23, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.120 Vali Acc: 0.819 Test Loss: 1.120 Test Acc: 0.819
Validation loss decreased (-0.796285 --> -0.818507).  Saving model ...
Epoch: 24 cost time: 0.6464812755584717
Epoch: 24, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.080 Vali Acc: 0.833 Test Loss: 1.080 Test Acc: 0.833
Validation loss decreased (-0.818507 --> -0.833323).  Saving model ...
Epoch: 25 cost time: 0.6190543174743652
Epoch: 25, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.041 Vali Acc: 0.837 Test Loss: 1.041 Test Acc: 0.837
Validation loss decreased (-0.833323 --> -0.837027).  Saving model ...
Epoch: 26 cost time: 0.6197805404663086
Epoch: 26, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.003 Vali Acc: 0.837 Test Loss: 1.003 Test Acc: 0.837
Validation loss decreased (-0.837027 --> -0.837027).  Saving model ...
Epoch: 27 cost time: 0.6965758800506592
Epoch: 27, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.967 Vali Acc: 0.833 Test Loss: 0.967 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6605396270751953
Epoch: 28, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.932 Vali Acc: 0.837 Test Loss: 0.932 Test Acc: 0.837
Validation loss decreased (-0.837027 --> -0.837028).  Saving model ...
Epoch: 29 cost time: 0.6235923767089844
Epoch: 29, Steps: 2 | Train Loss: 0.807 Vali Loss: 0.899 Vali Acc: 0.844 Test Loss: 0.899 Test Acc: 0.844
Validation loss decreased (-0.837028 --> -0.844435).  Saving model ...
Epoch: 30 cost time: 0.6278917789459229
Epoch: 30, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.866 Vali Acc: 0.848 Test Loss: 0.866 Test Acc: 0.848
Validation loss decreased (-0.844435 --> -0.848139).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8481481481481481
model parameter : 179078
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.898655652999878
Epoch: 1, Steps: 2 | Train Loss: 2.009 Vali Loss: 1.900 Vali Acc: 0.263 Test Loss: 1.900 Test Acc: 0.263
Validation loss decreased (inf --> -0.262944).  Saving model ...
Epoch: 2 cost time: 1.0048801898956299
Epoch: 2, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.880 Vali Acc: 0.270 Test Loss: 1.880 Test Acc: 0.270
Validation loss decreased (-0.262944 --> -0.270352).  Saving model ...
Epoch: 3 cost time: 0.9201431274414062
Epoch: 3, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.867 Vali Acc: 0.270 Test Loss: 1.867 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270352).  Saving model ...
Epoch: 4 cost time: 1.102118968963623
Epoch: 4, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.858 Vali Acc: 0.270 Test Loss: 1.858 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270352).  Saving model ...
Epoch: 5 cost time: 1.0555460453033447
Epoch: 5, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.846 Vali Acc: 0.274 Test Loss: 1.846 Test Acc: 0.274
Validation loss decreased (-0.270352 --> -0.274056).  Saving model ...
Epoch: 6 cost time: 0.8778817653656006
Epoch: 6, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.831 Vali Acc: 0.278 Test Loss: 1.831 Test Acc: 0.278
Validation loss decreased (-0.274056 --> -0.277759).  Saving model ...
Epoch: 7 cost time: 1.0081555843353271
Epoch: 7, Steps: 2 | Train Loss: 1.898 Vali Loss: 1.815 Vali Acc: 0.278 Test Loss: 1.815 Test Acc: 0.278
Validation loss decreased (-0.277759 --> -0.277760).  Saving model ...
Epoch: 8 cost time: 1.0934057235717773
Epoch: 8, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.797 Vali Acc: 0.281 Test Loss: 1.797 Test Acc: 0.281
Validation loss decreased (-0.277760 --> -0.281464).  Saving model ...
Epoch: 9 cost time: 1.0645995140075684
Epoch: 9, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.777 Vali Acc: 0.281 Test Loss: 1.777 Test Acc: 0.281
Validation loss decreased (-0.281464 --> -0.281464).  Saving model ...
Epoch: 10 cost time: 1.1418266296386719
Epoch: 10, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.756 Vali Acc: 0.289 Test Loss: 1.756 Test Acc: 0.289
Validation loss decreased (-0.281464 --> -0.288871).  Saving model ...
Epoch: 11 cost time: 1.0662224292755127
Epoch: 11, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.735 Vali Acc: 0.296 Test Loss: 1.735 Test Acc: 0.296
Validation loss decreased (-0.288871 --> -0.296279).  Saving model ...
Epoch: 12 cost time: 1.1505436897277832
Epoch: 12, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.713 Vali Acc: 0.315 Test Loss: 1.713 Test Acc: 0.315
Validation loss decreased (-0.296279 --> -0.314798).  Saving model ...
Epoch: 13 cost time: 1.0822505950927734
Epoch: 13, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.689 Vali Acc: 0.326 Test Loss: 1.689 Test Acc: 0.326
Validation loss decreased (-0.314798 --> -0.325909).  Saving model ...
Epoch: 14 cost time: 1.025352954864502
Epoch: 14, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.665 Vali Acc: 0.348 Test Loss: 1.665 Test Acc: 0.348
Validation loss decreased (-0.325909 --> -0.348132).  Saving model ...
Epoch: 15 cost time: 0.9585208892822266
Epoch: 15, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.640 Vali Acc: 0.363 Test Loss: 1.640 Test Acc: 0.363
Validation loss decreased (-0.348132 --> -0.362947).  Saving model ...
Epoch: 16 cost time: 1.1657774448394775
Epoch: 16, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.613 Vali Acc: 0.396 Test Loss: 1.613 Test Acc: 0.396
Validation loss decreased (-0.362947 --> -0.396280).  Saving model ...
Epoch: 17 cost time: 1.1118237972259521
Epoch: 17, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.586 Vali Acc: 0.426 Test Loss: 1.586 Test Acc: 0.426
Validation loss decreased (-0.396280 --> -0.425910).  Saving model ...
Epoch: 18 cost time: 1.1811494827270508
Epoch: 18, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.559 Vali Acc: 0.463 Test Loss: 1.559 Test Acc: 0.463
Validation loss decreased (-0.425910 --> -0.462947).  Saving model ...
Epoch: 19 cost time: 1.1139607429504395
Epoch: 19, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.531 Vali Acc: 0.559 Test Loss: 1.531 Test Acc: 0.559
Validation loss decreased (-0.462947 --> -0.559244).  Saving model ...
Epoch: 20 cost time: 1.165834665298462
Epoch: 20, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.502 Vali Acc: 0.600 Test Loss: 1.502 Test Acc: 0.600
Validation loss decreased (-0.559244 --> -0.599985).  Saving model ...
Epoch: 21 cost time: 1.167186975479126
Epoch: 21, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.473 Vali Acc: 0.659 Test Loss: 1.473 Test Acc: 0.659
Validation loss decreased (-0.599985 --> -0.659245).  Saving model ...
Epoch: 22 cost time: 1.1239428520202637
Epoch: 22, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.443 Vali Acc: 0.681 Test Loss: 1.443 Test Acc: 0.681
Validation loss decreased (-0.659245 --> -0.681467).  Saving model ...
Epoch: 23 cost time: 1.1353180408477783
Epoch: 23, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.413 Vali Acc: 0.693 Test Loss: 1.413 Test Acc: 0.693
Validation loss decreased (-0.681467 --> -0.692578).  Saving model ...
Epoch: 24 cost time: 1.1722450256347656
Epoch: 24, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.383 Vali Acc: 0.711 Test Loss: 1.383 Test Acc: 0.711
Validation loss decreased (-0.692578 --> -0.711097).  Saving model ...
Epoch: 25 cost time: 1.15543532371521
Epoch: 25, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.351 Vali Acc: 0.733 Test Loss: 1.351 Test Acc: 0.733
Validation loss decreased (-0.711097 --> -0.733320).  Saving model ...
Epoch: 26 cost time: 1.115626573562622
Epoch: 26, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.320 Vali Acc: 0.752 Test Loss: 1.320 Test Acc: 0.752
Validation loss decreased (-0.733320 --> -0.751839).  Saving model ...
Epoch: 27 cost time: 1.1050317287445068
Epoch: 27, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.288 Vali Acc: 0.778 Test Loss: 1.288 Test Acc: 0.778
Validation loss decreased (-0.751839 --> -0.777765).  Saving model ...
Epoch: 28 cost time: 1.0318350791931152
Epoch: 28, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.256 Vali Acc: 0.793 Test Loss: 1.256 Test Acc: 0.793
Validation loss decreased (-0.777765 --> -0.792580).  Saving model ...
Epoch: 29 cost time: 1.025792121887207
Epoch: 29, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.224 Vali Acc: 0.807 Test Loss: 1.224 Test Acc: 0.807
Validation loss decreased (-0.792580 --> -0.807395).  Saving model ...
Epoch: 30 cost time: 1.0133440494537354
Epoch: 30, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.192 Vali Acc: 0.841 Test Loss: 1.192 Test Acc: 0.841
Validation loss decreased (-0.807395 --> -0.840729).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8407407407407408
model parameter : 1176454
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.378166913986206
Epoch: 1, Steps: 2 | Train Loss: 1.991 Vali Loss: 1.974 Vali Acc: 0.315 Test Loss: 1.974 Test Acc: 0.315
Validation loss decreased (inf --> -0.314795).  Saving model ...
Epoch: 2 cost time: 0.8400728702545166
Epoch: 2, Steps: 2 | Train Loss: 1.942 Vali Loss: 1.956 Vali Acc: 0.319 Test Loss: 1.956 Test Acc: 0.319
Validation loss decreased (-0.314795 --> -0.318499).  Saving model ...
Epoch: 3 cost time: 0.8128275871276855
Epoch: 3, Steps: 2 | Train Loss: 1.982 Vali Loss: 1.944 Vali Acc: 0.319 Test Loss: 1.944 Test Acc: 0.319
Validation loss decreased (-0.318499 --> -0.318499).  Saving model ...
Epoch: 4 cost time: 0.87326979637146
Epoch: 4, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.935 Vali Acc: 0.326 Test Loss: 1.935 Test Acc: 0.326
Validation loss decreased (-0.318499 --> -0.325907).  Saving model ...
Epoch: 5 cost time: 0.8227927684783936
Epoch: 5, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.924 Vali Acc: 0.326 Test Loss: 1.924 Test Acc: 0.326
Validation loss decreased (-0.325907 --> -0.325907).  Saving model ...
Epoch: 6 cost time: 0.7999064922332764
Epoch: 6, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.910 Vali Acc: 0.330 Test Loss: 1.910 Test Acc: 0.330
Validation loss decreased (-0.325907 --> -0.329611).  Saving model ...
Epoch: 7 cost time: 0.7901694774627686
Epoch: 7, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.895 Vali Acc: 0.341 Test Loss: 1.895 Test Acc: 0.341
Validation loss decreased (-0.329611 --> -0.340722).  Saving model ...
Epoch: 8 cost time: 0.7775967121124268
Epoch: 8, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.878 Vali Acc: 0.344 Test Loss: 1.878 Test Acc: 0.344
Validation loss decreased (-0.340722 --> -0.344426).  Saving model ...
Epoch: 9 cost time: 0.7885770797729492
Epoch: 9, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.859 Vali Acc: 0.348 Test Loss: 1.859 Test Acc: 0.348
Validation loss decreased (-0.344426 --> -0.348130).  Saving model ...
Epoch: 10 cost time: 0.7945997714996338
Epoch: 10, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.840 Vali Acc: 0.356 Test Loss: 1.840 Test Acc: 0.356
Validation loss decreased (-0.348130 --> -0.355537).  Saving model ...
Epoch: 11 cost time: 0.7641100883483887
Epoch: 11, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.819 Vali Acc: 0.359 Test Loss: 1.819 Test Acc: 0.359
Validation loss decreased (-0.355537 --> -0.359241).  Saving model ...
Epoch: 12 cost time: 0.7919628620147705
Epoch: 12, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.796 Vali Acc: 0.359 Test Loss: 1.796 Test Acc: 0.359
Validation loss decreased (-0.359241 --> -0.359241).  Saving model ...
Epoch: 13 cost time: 0.8120577335357666
Epoch: 13, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.773 Vali Acc: 0.374 Test Loss: 1.773 Test Acc: 0.374
Validation loss decreased (-0.359241 --> -0.374056).  Saving model ...
Epoch: 14 cost time: 0.8459386825561523
Epoch: 14, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.750 Vali Acc: 0.396 Test Loss: 1.750 Test Acc: 0.396
Validation loss decreased (-0.374056 --> -0.396279).  Saving model ...
Epoch: 15 cost time: 0.7512598037719727
Epoch: 15, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.726 Vali Acc: 0.404 Test Loss: 1.726 Test Acc: 0.404
Validation loss decreased (-0.396279 --> -0.403686).  Saving model ...
Epoch: 16 cost time: 0.7665276527404785
Epoch: 16, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.701 Vali Acc: 0.404 Test Loss: 1.701 Test Acc: 0.404
Validation loss decreased (-0.403686 --> -0.403687).  Saving model ...
Epoch: 17 cost time: 0.732403039932251
Epoch: 17, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.675 Vali Acc: 0.407 Test Loss: 1.675 Test Acc: 0.407
Validation loss decreased (-0.403687 --> -0.407391).  Saving model ...
Epoch: 18 cost time: 0.8049910068511963
Epoch: 18, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.648 Vali Acc: 0.437 Test Loss: 1.648 Test Acc: 0.437
Validation loss decreased (-0.407391 --> -0.437021).  Saving model ...
Epoch: 19 cost time: 0.9017624855041504
Epoch: 19, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.621 Vali Acc: 0.444 Test Loss: 1.621 Test Acc: 0.444
Validation loss decreased (-0.437021 --> -0.444428).  Saving model ...
Epoch: 20 cost time: 0.7614428997039795
Epoch: 20, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.593 Vali Acc: 0.459 Test Loss: 1.593 Test Acc: 0.459
Validation loss decreased (-0.444428 --> -0.459243).  Saving model ...
Epoch: 21 cost time: 0.8403732776641846
Epoch: 21, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.565 Vali Acc: 0.489 Test Loss: 1.565 Test Acc: 0.489
Validation loss decreased (-0.459243 --> -0.488873).  Saving model ...
Epoch: 22 cost time: 0.8420264720916748
Epoch: 22, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.536 Vali Acc: 0.500 Test Loss: 1.536 Test Acc: 0.500
Validation loss decreased (-0.488873 --> -0.499985).  Saving model ...
Epoch: 23 cost time: 0.707228422164917
Epoch: 23, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.507 Vali Acc: 0.530 Test Loss: 1.507 Test Acc: 0.530
Validation loss decreased (-0.499985 --> -0.529615).  Saving model ...
Epoch: 24 cost time: 0.8601372241973877
Epoch: 24, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.478 Vali Acc: 0.548 Test Loss: 1.478 Test Acc: 0.548
Validation loss decreased (-0.529615 --> -0.548133).  Saving model ...
Epoch: 25 cost time: 0.8450865745544434
Epoch: 25, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.447 Vali Acc: 0.570 Test Loss: 1.447 Test Acc: 0.570
Validation loss decreased (-0.548133 --> -0.570356).  Saving model ...
Epoch: 26 cost time: 0.7204020023345947
Epoch: 26, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.417 Vali Acc: 0.589 Test Loss: 1.417 Test Acc: 0.589
Validation loss decreased (-0.570356 --> -0.588875).  Saving model ...
Epoch: 27 cost time: 0.8431174755096436
Epoch: 27, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.386 Vali Acc: 0.607 Test Loss: 1.386 Test Acc: 0.607
Validation loss decreased (-0.588875 --> -0.607394).  Saving model ...
Epoch: 28 cost time: 0.8098814487457275
Epoch: 28, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.356 Vali Acc: 0.622 Test Loss: 1.356 Test Acc: 0.622
Validation loss decreased (-0.607394 --> -0.622209).  Saving model ...
Epoch: 29 cost time: 0.7565319538116455
Epoch: 29, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.325 Vali Acc: 0.641 Test Loss: 1.325 Test Acc: 0.641
Validation loss decreased (-0.622209 --> -0.640727).  Saving model ...
Epoch: 30 cost time: 0.840545654296875
Epoch: 30, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.295 Vali Acc: 0.652 Test Loss: 1.295 Test Acc: 0.652
Validation loss decreased (-0.640727 --> -0.651839).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6518518518518519
model parameter : 348486
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6013431549072266
Epoch: 1, Steps: 2 | Train Loss: 2.009 Vali Loss: 1.900 Vali Acc: 0.263 Test Loss: 1.900 Test Acc: 0.263
Validation loss decreased (inf --> -0.262944).  Saving model ...
Epoch: 2 cost time: 0.8211116790771484
Epoch: 2, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.880 Vali Acc: 0.270 Test Loss: 1.880 Test Acc: 0.270
Validation loss decreased (-0.262944 --> -0.270352).  Saving model ...
Epoch: 3 cost time: 0.8269326686859131
Epoch: 3, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.867 Vali Acc: 0.270 Test Loss: 1.867 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270352).  Saving model ...
Epoch: 4 cost time: 0.8869903087615967
Epoch: 4, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.858 Vali Acc: 0.270 Test Loss: 1.858 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270352).  Saving model ...
Epoch: 5 cost time: 0.820746898651123
Epoch: 5, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.846 Vali Acc: 0.274 Test Loss: 1.846 Test Acc: 0.274
Validation loss decreased (-0.270352 --> -0.274056).  Saving model ...
Epoch: 6 cost time: 0.862769365310669
Epoch: 6, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.831 Vali Acc: 0.278 Test Loss: 1.831 Test Acc: 0.278
Validation loss decreased (-0.274056 --> -0.277759).  Saving model ...
Epoch: 7 cost time: 0.7776055335998535
Epoch: 7, Steps: 2 | Train Loss: 1.898 Vali Loss: 1.815 Vali Acc: 0.278 Test Loss: 1.815 Test Acc: 0.278
Validation loss decreased (-0.277759 --> -0.277760).  Saving model ...
Epoch: 8 cost time: 0.8668372631072998
Epoch: 8, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.797 Vali Acc: 0.281 Test Loss: 1.797 Test Acc: 0.281
Validation loss decreased (-0.277760 --> -0.281464).  Saving model ...
Epoch: 9 cost time: 0.7752790451049805
Epoch: 9, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.777 Vali Acc: 0.281 Test Loss: 1.777 Test Acc: 0.281
Validation loss decreased (-0.281464 --> -0.281464).  Saving model ...
Epoch: 10 cost time: 0.8706121444702148
Epoch: 10, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.756 Vali Acc: 0.289 Test Loss: 1.756 Test Acc: 0.289
Validation loss decreased (-0.281464 --> -0.288871).  Saving model ...
Epoch: 11 cost time: 0.858349084854126
Epoch: 11, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.735 Vali Acc: 0.296 Test Loss: 1.735 Test Acc: 0.296
Validation loss decreased (-0.288871 --> -0.296279).  Saving model ...
Epoch: 12 cost time: 0.8295543193817139
Epoch: 12, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.713 Vali Acc: 0.315 Test Loss: 1.713 Test Acc: 0.315
Validation loss decreased (-0.296279 --> -0.314798).  Saving model ...
Epoch: 13 cost time: 0.9009475708007812
Epoch: 13, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.689 Vali Acc: 0.326 Test Loss: 1.689 Test Acc: 0.326
Validation loss decreased (-0.314798 --> -0.325909).  Saving model ...
Epoch: 14 cost time: 0.913823127746582
Epoch: 14, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.665 Vali Acc: 0.348 Test Loss: 1.665 Test Acc: 0.348
Validation loss decreased (-0.325909 --> -0.348132).  Saving model ...
Epoch: 15 cost time: 0.7979514598846436
Epoch: 15, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.640 Vali Acc: 0.363 Test Loss: 1.640 Test Acc: 0.363
Validation loss decreased (-0.348132 --> -0.362947).  Saving model ...
Epoch: 16 cost time: 0.8313148021697998
Epoch: 16, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.613 Vali Acc: 0.396 Test Loss: 1.613 Test Acc: 0.396
Validation loss decreased (-0.362947 --> -0.396280).  Saving model ...
Epoch: 17 cost time: 0.8348298072814941
Epoch: 17, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.586 Vali Acc: 0.426 Test Loss: 1.586 Test Acc: 0.426
Validation loss decreased (-0.396280 --> -0.425910).  Saving model ...
Epoch: 18 cost time: 0.8286612033843994
Epoch: 18, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.559 Vali Acc: 0.463 Test Loss: 1.559 Test Acc: 0.463
Validation loss decreased (-0.425910 --> -0.462947).  Saving model ...
Epoch: 19 cost time: 0.9117732048034668
Epoch: 19, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.531 Vali Acc: 0.559 Test Loss: 1.531 Test Acc: 0.559
Validation loss decreased (-0.462947 --> -0.559244).  Saving model ...
Epoch: 20 cost time: 0.8549833297729492
Epoch: 20, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.502 Vali Acc: 0.600 Test Loss: 1.502 Test Acc: 0.600
Validation loss decreased (-0.559244 --> -0.599985).  Saving model ...
Epoch: 21 cost time: 0.8935122489929199
Epoch: 21, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.473 Vali Acc: 0.659 Test Loss: 1.473 Test Acc: 0.659
Validation loss decreased (-0.599985 --> -0.659245).  Saving model ...
Epoch: 22 cost time: 0.879664421081543
Epoch: 22, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.443 Vali Acc: 0.681 Test Loss: 1.443 Test Acc: 0.681
Validation loss decreased (-0.659245 --> -0.681467).  Saving model ...
Epoch: 23 cost time: 0.853626012802124
Epoch: 23, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.413 Vali Acc: 0.693 Test Loss: 1.413 Test Acc: 0.693
Validation loss decreased (-0.681467 --> -0.692578).  Saving model ...
Epoch: 24 cost time: 0.8921022415161133
Epoch: 24, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.383 Vali Acc: 0.711 Test Loss: 1.383 Test Acc: 0.711
Validation loss decreased (-0.692578 --> -0.711097).  Saving model ...
Epoch: 25 cost time: 0.7649519443511963
Epoch: 25, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.351 Vali Acc: 0.733 Test Loss: 1.351 Test Acc: 0.733
Validation loss decreased (-0.711097 --> -0.733320).  Saving model ...
Epoch: 26 cost time: 0.877587080001831
Epoch: 26, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.320 Vali Acc: 0.752 Test Loss: 1.320 Test Acc: 0.752
Validation loss decreased (-0.733320 --> -0.751839).  Saving model ...
Epoch: 27 cost time: 0.9311683177947998
Epoch: 27, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.288 Vali Acc: 0.778 Test Loss: 1.288 Test Acc: 0.778
Validation loss decreased (-0.751839 --> -0.777765).  Saving model ...
Epoch: 28 cost time: 0.9002656936645508
Epoch: 28, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.256 Vali Acc: 0.793 Test Loss: 1.256 Test Acc: 0.793
Validation loss decreased (-0.777765 --> -0.792580).  Saving model ...
Epoch: 29 cost time: 0.78072190284729
Epoch: 29, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.224 Vali Acc: 0.807 Test Loss: 1.224 Test Acc: 0.807
Validation loss decreased (-0.792580 --> -0.807395).  Saving model ...
Epoch: 30 cost time: 0.8014013767242432
Epoch: 30, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.192 Vali Acc: 0.841 Test Loss: 1.192 Test Acc: 0.841
Validation loss decreased (-0.807395 --> -0.840729).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8407407407407408
model parameter : 1176454
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4709959030151367
Epoch: 1, Steps: 2 | Train Loss: 1.991 Vali Loss: 1.974 Vali Acc: 0.315 Test Loss: 1.974 Test Acc: 0.315
Validation loss decreased (inf --> -0.314795).  Saving model ...
Epoch: 2 cost time: 0.7314128875732422
Epoch: 2, Steps: 2 | Train Loss: 1.942 Vali Loss: 1.956 Vali Acc: 0.319 Test Loss: 1.956 Test Acc: 0.319
Validation loss decreased (-0.314795 --> -0.318499).  Saving model ...
Epoch: 3 cost time: 0.7878072261810303
Epoch: 3, Steps: 2 | Train Loss: 1.982 Vali Loss: 1.944 Vali Acc: 0.319 Test Loss: 1.944 Test Acc: 0.319
Validation loss decreased (-0.318499 --> -0.318499).  Saving model ...
Epoch: 4 cost time: 0.798386812210083
Epoch: 4, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.935 Vali Acc: 0.326 Test Loss: 1.935 Test Acc: 0.326
Validation loss decreased (-0.318499 --> -0.325907).  Saving model ...
Epoch: 5 cost time: 0.8251957893371582
Epoch: 5, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.924 Vali Acc: 0.326 Test Loss: 1.924 Test Acc: 0.326
Validation loss decreased (-0.325907 --> -0.325907).  Saving model ...
Epoch: 6 cost time: 0.7735040187835693
Epoch: 6, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.910 Vali Acc: 0.330 Test Loss: 1.910 Test Acc: 0.330
Validation loss decreased (-0.325907 --> -0.329611).  Saving model ...
Epoch: 7 cost time: 0.7703197002410889
Epoch: 7, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.895 Vali Acc: 0.341 Test Loss: 1.895 Test Acc: 0.341
Validation loss decreased (-0.329611 --> -0.340722).  Saving model ...
Epoch: 8 cost time: 0.7610487937927246
Epoch: 8, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.878 Vali Acc: 0.344 Test Loss: 1.878 Test Acc: 0.344
Validation loss decreased (-0.340722 --> -0.344426).  Saving model ...
Epoch: 9 cost time: 0.7260172367095947
Epoch: 9, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.859 Vali Acc: 0.348 Test Loss: 1.859 Test Acc: 0.348
Validation loss decreased (-0.344426 --> -0.348130).  Saving model ...
Epoch: 10 cost time: 0.7583246231079102
Epoch: 10, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.840 Vali Acc: 0.356 Test Loss: 1.840 Test Acc: 0.356
Validation loss decreased (-0.348130 --> -0.355537).  Saving model ...
Epoch: 11 cost time: 0.7901859283447266
Epoch: 11, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.818 Vali Acc: 0.359 Test Loss: 1.818 Test Acc: 0.359
Validation loss decreased (-0.355537 --> -0.359241).  Saving model ...
Epoch: 12 cost time: 0.7066380977630615
Epoch: 12, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.796 Vali Acc: 0.359 Test Loss: 1.796 Test Acc: 0.359
Validation loss decreased (-0.359241 --> -0.359241).  Saving model ...
Epoch: 13 cost time: 0.7558066844940186
Epoch: 13, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.773 Vali Acc: 0.374 Test Loss: 1.773 Test Acc: 0.374
Validation loss decreased (-0.359241 --> -0.374056).  Saving model ...
Epoch: 14 cost time: 0.6707677841186523
Epoch: 14, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.750 Vali Acc: 0.396 Test Loss: 1.750 Test Acc: 0.396
Validation loss decreased (-0.374056 --> -0.396279).  Saving model ...
Epoch: 15 cost time: 0.7058978080749512
Epoch: 15, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.726 Vali Acc: 0.404 Test Loss: 1.726 Test Acc: 0.404
Validation loss decreased (-0.396279 --> -0.403686).  Saving model ...
Epoch: 16 cost time: 0.7310764789581299
Epoch: 16, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.701 Vali Acc: 0.404 Test Loss: 1.701 Test Acc: 0.404
Validation loss decreased (-0.403686 --> -0.403687).  Saving model ...
Epoch: 17 cost time: 0.7656724452972412
Epoch: 17, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.675 Vali Acc: 0.407 Test Loss: 1.675 Test Acc: 0.407
Validation loss decreased (-0.403687 --> -0.407391).  Saving model ...
Epoch: 18 cost time: 0.7863445281982422
Epoch: 18, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.648 Vali Acc: 0.437 Test Loss: 1.648 Test Acc: 0.437
Validation loss decreased (-0.407391 --> -0.437021).  Saving model ...
Epoch: 19 cost time: 0.7895922660827637
Epoch: 19, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.621 Vali Acc: 0.444 Test Loss: 1.621 Test Acc: 0.444
Validation loss decreased (-0.437021 --> -0.444428).  Saving model ...
Epoch: 20 cost time: 0.7251927852630615
Epoch: 20, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.593 Vali Acc: 0.459 Test Loss: 1.593 Test Acc: 0.459
Validation loss decreased (-0.444428 --> -0.459243).  Saving model ...
Epoch: 21 cost time: 0.7592260837554932
Epoch: 21, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.565 Vali Acc: 0.489 Test Loss: 1.565 Test Acc: 0.489
Validation loss decreased (-0.459243 --> -0.488873).  Saving model ...
Epoch: 22 cost time: 0.7357823848724365
Epoch: 22, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.536 Vali Acc: 0.500 Test Loss: 1.536 Test Acc: 0.500
Validation loss decreased (-0.488873 --> -0.499985).  Saving model ...
Epoch: 23 cost time: 0.7853248119354248
Epoch: 23, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.507 Vali Acc: 0.530 Test Loss: 1.507 Test Acc: 0.530
Validation loss decreased (-0.499985 --> -0.529615).  Saving model ...
Epoch: 24 cost time: 0.7723619937896729
Epoch: 24, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.478 Vali Acc: 0.548 Test Loss: 1.478 Test Acc: 0.548
Validation loss decreased (-0.529615 --> -0.548133).  Saving model ...
Epoch: 25 cost time: 0.7631170749664307
Epoch: 25, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.447 Vali Acc: 0.570 Test Loss: 1.447 Test Acc: 0.570
Validation loss decreased (-0.548133 --> -0.570356).  Saving model ...
Epoch: 26 cost time: 0.7537417411804199
Epoch: 26, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.417 Vali Acc: 0.589 Test Loss: 1.417 Test Acc: 0.589
Validation loss decreased (-0.570356 --> -0.588875).  Saving model ...
Epoch: 27 cost time: 0.7684032917022705
Epoch: 27, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.386 Vali Acc: 0.607 Test Loss: 1.386 Test Acc: 0.607
Validation loss decreased (-0.588875 --> -0.607394).  Saving model ...
Epoch: 28 cost time: 0.7540993690490723
Epoch: 28, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.356 Vali Acc: 0.622 Test Loss: 1.356 Test Acc: 0.622
Validation loss decreased (-0.607394 --> -0.622209).  Saving model ...
Epoch: 29 cost time: 0.7929399013519287
Epoch: 29, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.325 Vali Acc: 0.641 Test Loss: 1.325 Test Acc: 0.641
Validation loss decreased (-0.622209 --> -0.640727).  Saving model ...
Epoch: 30 cost time: 0.7641339302062988
Epoch: 30, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.295 Vali Acc: 0.652 Test Loss: 1.295 Test Acc: 0.652
Validation loss decreased (-0.640727 --> -0.651839).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6518518518518519
model parameter : 348486
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4404430389404297
Epoch: 1, Steps: 2 | Train Loss: 2.009 Vali Loss: 1.899 Vali Acc: 0.263 Test Loss: 1.899 Test Acc: 0.263
Validation loss decreased (inf --> -0.262944).  Saving model ...
Epoch: 2 cost time: 0.6841130256652832
Epoch: 2, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.880 Vali Acc: 0.270 Test Loss: 1.880 Test Acc: 0.270
Validation loss decreased (-0.262944 --> -0.270352).  Saving model ...
Epoch: 3 cost time: 0.7229442596435547
Epoch: 3, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.866 Vali Acc: 0.270 Test Loss: 1.866 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270352).  Saving model ...
Epoch: 4 cost time: 0.7047903537750244
Epoch: 4, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.857 Vali Acc: 0.270 Test Loss: 1.857 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270352).  Saving model ...
Epoch: 5 cost time: 0.7162582874298096
Epoch: 5, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.846 Vali Acc: 0.274 Test Loss: 1.846 Test Acc: 0.274
Validation loss decreased (-0.270352 --> -0.274056).  Saving model ...
Epoch: 6 cost time: 0.7062745094299316
Epoch: 6, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.831 Vali Acc: 0.278 Test Loss: 1.831 Test Acc: 0.278
Validation loss decreased (-0.274056 --> -0.277759).  Saving model ...
Epoch: 7 cost time: 0.7040669918060303
Epoch: 7, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.815 Vali Acc: 0.278 Test Loss: 1.815 Test Acc: 0.278
Validation loss decreased (-0.277759 --> -0.277760).  Saving model ...
Epoch: 8 cost time: 0.7313063144683838
Epoch: 8, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.797 Vali Acc: 0.281 Test Loss: 1.797 Test Acc: 0.281
Validation loss decreased (-0.277760 --> -0.281464).  Saving model ...
Epoch: 9 cost time: 0.6650338172912598
Epoch: 9, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.778 Vali Acc: 0.281 Test Loss: 1.778 Test Acc: 0.281
Validation loss decreased (-0.281464 --> -0.281464).  Saving model ...
Epoch: 10 cost time: 0.756072998046875
Epoch: 10, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.758 Vali Acc: 0.289 Test Loss: 1.758 Test Acc: 0.289
Validation loss decreased (-0.281464 --> -0.288871).  Saving model ...
Epoch: 11 cost time: 0.7378275394439697
Epoch: 11, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.737 Vali Acc: 0.296 Test Loss: 1.737 Test Acc: 0.296
Validation loss decreased (-0.288871 --> -0.296279).  Saving model ...
Epoch: 12 cost time: 0.6954984664916992
Epoch: 12, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.715 Vali Acc: 0.311 Test Loss: 1.715 Test Acc: 0.311
Validation loss decreased (-0.296279 --> -0.311094).  Saving model ...
Epoch: 13 cost time: 0.6838123798370361
Epoch: 13, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.692 Vali Acc: 0.322 Test Loss: 1.692 Test Acc: 0.322
Validation loss decreased (-0.311094 --> -0.322205).  Saving model ...
Epoch: 14 cost time: 0.715569257736206
Epoch: 14, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.668 Vali Acc: 0.341 Test Loss: 1.668 Test Acc: 0.341
Validation loss decreased (-0.322205 --> -0.340724).  Saving model ...
Epoch: 15 cost time: 0.6891252994537354
Epoch: 15, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.644 Vali Acc: 0.356 Test Loss: 1.644 Test Acc: 0.356
Validation loss decreased (-0.340724 --> -0.355539).  Saving model ...
Epoch: 16 cost time: 0.6402292251586914
Epoch: 16, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.618 Vali Acc: 0.385 Test Loss: 1.618 Test Acc: 0.385
Validation loss decreased (-0.355539 --> -0.385169).  Saving model ...
Epoch: 17 cost time: 0.7672595977783203
Epoch: 17, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.591 Vali Acc: 0.415 Test Loss: 1.591 Test Acc: 0.415
Validation loss decreased (-0.385169 --> -0.414799).  Saving model ...
Epoch: 18 cost time: 0.7025673389434814
Epoch: 18, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.564 Vali Acc: 0.459 Test Loss: 1.564 Test Acc: 0.459
Validation loss decreased (-0.414799 --> -0.459244).  Saving model ...
Epoch: 19 cost time: 0.6742813587188721
Epoch: 19, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.537 Vali Acc: 0.530 Test Loss: 1.537 Test Acc: 0.530
Validation loss decreased (-0.459244 --> -0.529614).  Saving model ...
Epoch: 20 cost time: 0.7034087181091309
Epoch: 20, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.508 Vali Acc: 0.596 Test Loss: 1.508 Test Acc: 0.596
Validation loss decreased (-0.529614 --> -0.596281).  Saving model ...
Epoch: 21 cost time: 0.6399290561676025
Epoch: 21, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.480 Vali Acc: 0.652 Test Loss: 1.480 Test Acc: 0.652
Validation loss decreased (-0.596281 --> -0.651837).  Saving model ...
Epoch: 22 cost time: 0.6819057464599609
Epoch: 22, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.450 Vali Acc: 0.674 Test Loss: 1.450 Test Acc: 0.674
Validation loss decreased (-0.651837 --> -0.674060).  Saving model ...
Epoch: 23 cost time: 0.7511558532714844
Epoch: 23, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.420 Vali Acc: 0.696 Test Loss: 1.420 Test Acc: 0.696
Validation loss decreased (-0.674060 --> -0.696282).  Saving model ...
Epoch: 24 cost time: 0.740391731262207
Epoch: 24, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.390 Vali Acc: 0.715 Test Loss: 1.390 Test Acc: 0.715
Validation loss decreased (-0.696282 --> -0.714801).  Saving model ...
Epoch: 25 cost time: 0.6934421062469482
Epoch: 25, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.359 Vali Acc: 0.741 Test Loss: 1.359 Test Acc: 0.741
Validation loss decreased (-0.714801 --> -0.740727).  Saving model ...
Epoch: 26 cost time: 0.700345516204834
Epoch: 26, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.328 Vali Acc: 0.763 Test Loss: 1.328 Test Acc: 0.763
Validation loss decreased (-0.740727 --> -0.762950).  Saving model ...
Epoch: 27 cost time: 0.7114052772521973
Epoch: 27, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.296 Vali Acc: 0.781 Test Loss: 1.296 Test Acc: 0.781
Validation loss decreased (-0.762950 --> -0.781469).  Saving model ...
Epoch: 28 cost time: 0.7659592628479004
Epoch: 28, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.264 Vali Acc: 0.804 Test Loss: 1.264 Test Acc: 0.804
Validation loss decreased (-0.781469 --> -0.803691).  Saving model ...
Epoch: 29 cost time: 0.7224626541137695
Epoch: 29, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.232 Vali Acc: 0.833 Test Loss: 1.232 Test Acc: 0.833
Validation loss decreased (-0.803691 --> -0.833321).  Saving model ...
Epoch: 30 cost time: 0.6242389678955078
Epoch: 30, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.200 Vali Acc: 0.841 Test Loss: 1.200 Test Acc: 0.841
Validation loss decreased (-0.833321 --> -0.840729).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8407407407407408
model parameter : 1176454
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2899091243743896
Epoch: 1, Steps: 2 | Train Loss: 1.996 Vali Loss: 1.976 Vali Acc: 0.315 Test Loss: 1.976 Test Acc: 0.315
Validation loss decreased (inf --> -0.314795).  Saving model ...
Epoch: 2 cost time: 0.623875617980957
Epoch: 2, Steps: 2 | Train Loss: 1.943 Vali Loss: 1.958 Vali Acc: 0.319 Test Loss: 1.958 Test Acc: 0.319
Validation loss decreased (-0.314795 --> -0.318499).  Saving model ...
Epoch: 3 cost time: 0.587702751159668
Epoch: 3, Steps: 2 | Train Loss: 1.986 Vali Loss: 1.946 Vali Acc: 0.319 Test Loss: 1.946 Test Acc: 0.319
Validation loss decreased (-0.318499 --> -0.318499).  Saving model ...
Epoch: 4 cost time: 0.6501710414886475
Epoch: 4, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.937 Vali Acc: 0.326 Test Loss: 1.937 Test Acc: 0.326
Validation loss decreased (-0.318499 --> -0.325907).  Saving model ...
Epoch: 5 cost time: 0.6075749397277832
Epoch: 5, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.926 Vali Acc: 0.330 Test Loss: 1.926 Test Acc: 0.330
Validation loss decreased (-0.325907 --> -0.329610).  Saving model ...
Epoch: 6 cost time: 0.6282351016998291
Epoch: 6, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.913 Vali Acc: 0.333 Test Loss: 1.913 Test Acc: 0.333
Validation loss decreased (-0.329610 --> -0.333314).  Saving model ...
Epoch: 7 cost time: 0.7062435150146484
Epoch: 7, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.898 Vali Acc: 0.344 Test Loss: 1.898 Test Acc: 0.344
Validation loss decreased (-0.333314 --> -0.344425).  Saving model ...
Epoch: 8 cost time: 0.6095716953277588
Epoch: 8, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.881 Vali Acc: 0.344 Test Loss: 1.881 Test Acc: 0.344
Validation loss decreased (-0.344425 --> -0.344426).  Saving model ...
Epoch: 9 cost time: 0.7035973072052002
Epoch: 9, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.863 Vali Acc: 0.348 Test Loss: 1.863 Test Acc: 0.348
Validation loss decreased (-0.344426 --> -0.348130).  Saving model ...
Epoch: 10 cost time: 0.7031271457672119
Epoch: 10, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.844 Vali Acc: 0.356 Test Loss: 1.844 Test Acc: 0.356
Validation loss decreased (-0.348130 --> -0.355537).  Saving model ...
Epoch: 11 cost time: 0.6638071537017822
Epoch: 11, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.824 Vali Acc: 0.356 Test Loss: 1.824 Test Acc: 0.356
Validation loss decreased (-0.355537 --> -0.355537).  Saving model ...
Epoch: 12 cost time: 0.6980350017547607
Epoch: 12, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.802 Vali Acc: 0.356 Test Loss: 1.802 Test Acc: 0.356
Validation loss decreased (-0.355537 --> -0.355538).  Saving model ...
Epoch: 13 cost time: 0.683021068572998
Epoch: 13, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.780 Vali Acc: 0.367 Test Loss: 1.780 Test Acc: 0.367
Validation loss decreased (-0.355538 --> -0.366649).  Saving model ...
Epoch: 14 cost time: 0.6784322261810303
Epoch: 14, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.757 Vali Acc: 0.374 Test Loss: 1.757 Test Acc: 0.374
Validation loss decreased (-0.366649 --> -0.374057).  Saving model ...
Epoch: 15 cost time: 0.732501745223999
Epoch: 15, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.733 Vali Acc: 0.385 Test Loss: 1.733 Test Acc: 0.385
Validation loss decreased (-0.374057 --> -0.385168).  Saving model ...
Epoch: 16 cost time: 0.6828312873840332
Epoch: 16, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.708 Vali Acc: 0.389 Test Loss: 1.708 Test Acc: 0.389
Validation loss decreased (-0.385168 --> -0.388872).  Saving model ...
Epoch: 17 cost time: 0.6639606952667236
Epoch: 17, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.683 Vali Acc: 0.393 Test Loss: 1.683 Test Acc: 0.393
Validation loss decreased (-0.388872 --> -0.392576).  Saving model ...
Epoch: 18 cost time: 0.7065384387969971
Epoch: 18, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.657 Vali Acc: 0.426 Test Loss: 1.657 Test Acc: 0.426
Validation loss decreased (-0.392576 --> -0.425909).  Saving model ...
Epoch: 19 cost time: 0.6687307357788086
Epoch: 19, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.630 Vali Acc: 0.437 Test Loss: 1.630 Test Acc: 0.437
Validation loss decreased (-0.425909 --> -0.437021).  Saving model ...
Epoch: 20 cost time: 0.6385669708251953
Epoch: 20, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.603 Vali Acc: 0.444 Test Loss: 1.603 Test Acc: 0.444
Validation loss decreased (-0.437021 --> -0.444428).  Saving model ...
Epoch: 21 cost time: 0.680945634841919
Epoch: 21, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.575 Vali Acc: 0.470 Test Loss: 1.575 Test Acc: 0.470
Validation loss decreased (-0.444428 --> -0.470355).  Saving model ...
Epoch: 22 cost time: 0.6824285984039307
Epoch: 22, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.546 Vali Acc: 0.500 Test Loss: 1.546 Test Acc: 0.500
Validation loss decreased (-0.470355 --> -0.499985).  Saving model ...
Epoch: 23 cost time: 0.6965665817260742
Epoch: 23, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.517 Vali Acc: 0.530 Test Loss: 1.517 Test Acc: 0.530
Validation loss decreased (-0.499985 --> -0.529614).  Saving model ...
Epoch: 24 cost time: 0.6952745914459229
Epoch: 24, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.488 Vali Acc: 0.541 Test Loss: 1.488 Test Acc: 0.541
Validation loss decreased (-0.529614 --> -0.540726).  Saving model ...
Epoch: 25 cost time: 0.6908025741577148
Epoch: 25, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.457 Vali Acc: 0.567 Test Loss: 1.457 Test Acc: 0.567
Validation loss decreased (-0.540726 --> -0.566652).  Saving model ...
Epoch: 26 cost time: 0.7159228324890137
Epoch: 26, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.426 Vali Acc: 0.574 Test Loss: 1.426 Test Acc: 0.574
Validation loss decreased (-0.566652 --> -0.574060).  Saving model ...
Epoch: 27 cost time: 0.690526008605957
Epoch: 27, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.395 Vali Acc: 0.589 Test Loss: 1.395 Test Acc: 0.589
Validation loss decreased (-0.574060 --> -0.588875).  Saving model ...
Epoch: 28 cost time: 0.6625592708587646
Epoch: 28, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.364 Vali Acc: 0.611 Test Loss: 1.364 Test Acc: 0.611
Validation loss decreased (-0.588875 --> -0.611097).  Saving model ...
Epoch: 29 cost time: 0.6928308010101318
Epoch: 29, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.333 Vali Acc: 0.637 Test Loss: 1.333 Test Acc: 0.637
Validation loss decreased (-0.611097 --> -0.637024).  Saving model ...
Epoch: 30 cost time: 0.7138330936431885
Epoch: 30, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.302 Vali Acc: 0.648 Test Loss: 1.302 Test Acc: 0.648
Validation loss decreased (-0.637024 --> -0.648135).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6481481481481481
model parameter : 348486
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.553631067276001
Epoch: 1, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.745 Vali Acc: 0.270 Test Loss: 1.745 Test Acc: 0.270
Validation loss decreased (inf --> -0.270353).  Saving model ...
Epoch: 2 cost time: 0.8852145671844482
Epoch: 2, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.728 Vali Acc: 0.278 Test Loss: 1.728 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 0.8822145462036133
Epoch: 3, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.716 Vali Acc: 0.285 Test Loss: 1.716 Test Acc: 0.285
Validation loss decreased (-0.277761 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.8778476715087891
Epoch: 4, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.708 Vali Acc: 0.285 Test Loss: 1.708 Test Acc: 0.285
Validation loss decreased (-0.285168 --> -0.285168).  Saving model ...
Epoch: 5 cost time: 0.8747785091400146
Epoch: 5, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.698 Vali Acc: 0.285 Test Loss: 1.698 Test Acc: 0.285
Validation loss decreased (-0.285168 --> -0.285168).  Saving model ...
Epoch: 6 cost time: 0.8526701927185059
Epoch: 6, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.686 Vali Acc: 0.289 Test Loss: 1.686 Test Acc: 0.289
Validation loss decreased (-0.285168 --> -0.288872).  Saving model ...
Epoch: 7 cost time: 0.9590404033660889
Epoch: 7, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.672 Vali Acc: 0.300 Test Loss: 1.672 Test Acc: 0.300
Validation loss decreased (-0.288872 --> -0.299983).  Saving model ...
Epoch: 8 cost time: 0.926903247833252
Epoch: 8, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.658 Vali Acc: 0.304 Test Loss: 1.658 Test Acc: 0.304
Validation loss decreased (-0.299983 --> -0.303687).  Saving model ...
Epoch: 9 cost time: 0.9328122138977051
Epoch: 9, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.642 Vali Acc: 0.319 Test Loss: 1.642 Test Acc: 0.319
Validation loss decreased (-0.303687 --> -0.318502).  Saving model ...
Epoch: 10 cost time: 0.9925179481506348
Epoch: 10, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.625 Vali Acc: 0.330 Test Loss: 1.625 Test Acc: 0.330
Validation loss decreased (-0.318502 --> -0.329613).  Saving model ...
Epoch: 11 cost time: 0.9080874919891357
Epoch: 11, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.607 Vali Acc: 0.352 Test Loss: 1.607 Test Acc: 0.352
Validation loss decreased (-0.329613 --> -0.351836).  Saving model ...
Epoch: 12 cost time: 0.9015822410583496
Epoch: 12, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.588 Vali Acc: 0.367 Test Loss: 1.588 Test Acc: 0.367
Validation loss decreased (-0.351836 --> -0.366651).  Saving model ...
Epoch: 13 cost time: 0.9305696487426758
Epoch: 13, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.569 Vali Acc: 0.419 Test Loss: 1.569 Test Acc: 0.419
Validation loss decreased (-0.366651 --> -0.418503).  Saving model ...
Epoch: 14 cost time: 0.9312386512756348
Epoch: 14, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.548 Vali Acc: 0.441 Test Loss: 1.548 Test Acc: 0.441
Validation loss decreased (-0.418503 --> -0.440725).  Saving model ...
Epoch: 15 cost time: 0.9224886894226074
Epoch: 15, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.527 Vali Acc: 0.493 Test Loss: 1.527 Test Acc: 0.493
Validation loss decreased (-0.440725 --> -0.492577).  Saving model ...
Epoch: 16 cost time: 0.8948075771331787
Epoch: 16, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.505 Vali Acc: 0.519 Test Loss: 1.505 Test Acc: 0.519
Validation loss decreased (-0.492577 --> -0.518503).  Saving model ...
Epoch: 17 cost time: 0.9438908100128174
Epoch: 17, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.483 Vali Acc: 0.552 Test Loss: 1.483 Test Acc: 0.552
Validation loss decreased (-0.518503 --> -0.551837).  Saving model ...
Epoch: 18 cost time: 0.8866267204284668
Epoch: 18, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.461 Vali Acc: 0.585 Test Loss: 1.461 Test Acc: 0.585
Validation loss decreased (-0.551837 --> -0.585171).  Saving model ...
Epoch: 19 cost time: 0.9224302768707275
Epoch: 19, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.438 Vali Acc: 0.600 Test Loss: 1.438 Test Acc: 0.600
Validation loss decreased (-0.585171 --> -0.599986).  Saving model ...
Epoch: 20 cost time: 0.9414572715759277
Epoch: 20, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.414 Vali Acc: 0.615 Test Loss: 1.414 Test Acc: 0.615
Validation loss decreased (-0.599986 --> -0.614801).  Saving model ...
Epoch: 21 cost time: 0.9501733779907227
Epoch: 21, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.390 Vali Acc: 0.630 Test Loss: 1.390 Test Acc: 0.630
Validation loss decreased (-0.614801 --> -0.629616).  Saving model ...
Epoch: 22 cost time: 0.8922033309936523
Epoch: 22, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.366 Vali Acc: 0.644 Test Loss: 1.366 Test Acc: 0.644
Validation loss decreased (-0.629616 --> -0.644431).  Saving model ...
Epoch: 23 cost time: 0.9526853561401367
Epoch: 23, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.341 Vali Acc: 0.659 Test Loss: 1.341 Test Acc: 0.659
Validation loss decreased (-0.644431 --> -0.659246).  Saving model ...
Epoch: 24 cost time: 0.9752733707427979
Epoch: 24, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.316 Vali Acc: 0.674 Test Loss: 1.316 Test Acc: 0.674
Validation loss decreased (-0.659246 --> -0.674061).  Saving model ...
Epoch: 25 cost time: 0.9026689529418945
Epoch: 25, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.291 Vali Acc: 0.689 Test Loss: 1.291 Test Acc: 0.689
Validation loss decreased (-0.674061 --> -0.688876).  Saving model ...
Epoch: 26 cost time: 0.89497971534729
Epoch: 26, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.266 Vali Acc: 0.704 Test Loss: 1.266 Test Acc: 0.704
Validation loss decreased (-0.688876 --> -0.703691).  Saving model ...
Epoch: 27 cost time: 0.9494092464447021
Epoch: 27, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.241 Vali Acc: 0.715 Test Loss: 1.241 Test Acc: 0.715
Validation loss decreased (-0.703691 --> -0.714802).  Saving model ...
Epoch: 28 cost time: 0.9058263301849365
Epoch: 28, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.216 Vali Acc: 0.722 Test Loss: 1.216 Test Acc: 0.722
Validation loss decreased (-0.714802 --> -0.722210).  Saving model ...
Epoch: 29 cost time: 0.9084486961364746
Epoch: 29, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.191 Vali Acc: 0.733 Test Loss: 1.191 Test Acc: 0.733
Validation loss decreased (-0.722210 --> -0.733321).  Saving model ...
Epoch: 30 cost time: 0.9113564491271973
Epoch: 30, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.166 Vali Acc: 0.748 Test Loss: 1.166 Test Acc: 0.748
Validation loss decreased (-0.733321 --> -0.748136).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7481481481481481
model parameter : 589958
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.525987386703491
Epoch: 1, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.806 Vali Acc: 0.241 Test Loss: 1.806 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 0.7535247802734375
Epoch: 2, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.784 Vali Acc: 0.270 Test Loss: 1.784 Test Acc: 0.270
Validation loss decreased (-0.240723 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 0.8155508041381836
Epoch: 3, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.769 Vali Acc: 0.278 Test Loss: 1.769 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277760).  Saving model ...
Epoch: 4 cost time: 0.7882506847381592
Epoch: 4, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.760 Vali Acc: 0.278 Test Loss: 1.760 Test Acc: 0.278
Validation loss decreased (-0.277760 --> -0.277760).  Saving model ...
Epoch: 5 cost time: 0.9201693534851074
Epoch: 5, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.748 Vali Acc: 0.289 Test Loss: 1.748 Test Acc: 0.289
Validation loss decreased (-0.277760 --> -0.288871).  Saving model ...
Epoch: 6 cost time: 0.840216875076294
Epoch: 6, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.734 Vali Acc: 0.300 Test Loss: 1.734 Test Acc: 0.300
Validation loss decreased (-0.288871 --> -0.299983).  Saving model ...
Epoch: 7 cost time: 0.8532617092132568
Epoch: 7, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.718 Vali Acc: 0.315 Test Loss: 1.718 Test Acc: 0.315
Validation loss decreased (-0.299983 --> -0.314798).  Saving model ...
Epoch: 8 cost time: 0.8642089366912842
Epoch: 8, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.701 Vali Acc: 0.322 Test Loss: 1.701 Test Acc: 0.322
Validation loss decreased (-0.314798 --> -0.322205).  Saving model ...
Epoch: 9 cost time: 0.8638389110565186
Epoch: 9, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.683 Vali Acc: 0.333 Test Loss: 1.683 Test Acc: 0.333
Validation loss decreased (-0.322205 --> -0.333317).  Saving model ...
Epoch: 10 cost time: 0.8861544132232666
Epoch: 10, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.663 Vali Acc: 0.341 Test Loss: 1.663 Test Acc: 0.341
Validation loss decreased (-0.333317 --> -0.340724).  Saving model ...
Epoch: 11 cost time: 0.8702089786529541
Epoch: 11, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.642 Vali Acc: 0.356 Test Loss: 1.642 Test Acc: 0.356
Validation loss decreased (-0.340724 --> -0.355539).  Saving model ...
Epoch: 12 cost time: 0.8827414512634277
Epoch: 12, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.620 Vali Acc: 0.359 Test Loss: 1.620 Test Acc: 0.359
Validation loss decreased (-0.355539 --> -0.359243).  Saving model ...
Epoch: 13 cost time: 0.8004631996154785
Epoch: 13, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.597 Vali Acc: 0.396 Test Loss: 1.597 Test Acc: 0.396
Validation loss decreased (-0.359243 --> -0.396280).  Saving model ...
Epoch: 14 cost time: 0.8390638828277588
Epoch: 14, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.574 Vali Acc: 0.415 Test Loss: 1.574 Test Acc: 0.415
Validation loss decreased (-0.396280 --> -0.414799).  Saving model ...
Epoch: 15 cost time: 0.9392385482788086
Epoch: 15, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.549 Vali Acc: 0.433 Test Loss: 1.549 Test Acc: 0.433
Validation loss decreased (-0.414799 --> -0.433318).  Saving model ...
Epoch: 16 cost time: 0.9012291431427002
Epoch: 16, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.524 Vali Acc: 0.452 Test Loss: 1.524 Test Acc: 0.452
Validation loss decreased (-0.433318 --> -0.451837).  Saving model ...
Epoch: 17 cost time: 0.8146836757659912
Epoch: 17, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.498 Vali Acc: 0.474 Test Loss: 1.498 Test Acc: 0.474
Validation loss decreased (-0.451837 --> -0.474059).  Saving model ...
Epoch: 18 cost time: 0.8482460975646973
Epoch: 18, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.471 Vali Acc: 0.507 Test Loss: 1.471 Test Acc: 0.507
Validation loss decreased (-0.474059 --> -0.507393).  Saving model ...
Epoch: 19 cost time: 0.8817172050476074
Epoch: 19, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.444 Vali Acc: 0.530 Test Loss: 1.444 Test Acc: 0.530
Validation loss decreased (-0.507393 --> -0.529615).  Saving model ...
Epoch: 20 cost time: 0.8591303825378418
Epoch: 20, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.417 Vali Acc: 0.574 Test Loss: 1.417 Test Acc: 0.574
Validation loss decreased (-0.529615 --> -0.574060).  Saving model ...
Epoch: 21 cost time: 0.8474605083465576
Epoch: 21, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.389 Vali Acc: 0.607 Test Loss: 1.389 Test Acc: 0.607
Validation loss decreased (-0.574060 --> -0.607394).  Saving model ...
Epoch: 22 cost time: 0.8385300636291504
Epoch: 22, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.362 Vali Acc: 0.641 Test Loss: 1.362 Test Acc: 0.641
Validation loss decreased (-0.607394 --> -0.640727).  Saving model ...
Epoch: 23 cost time: 0.8498420715332031
Epoch: 23, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.333 Vali Acc: 0.659 Test Loss: 1.333 Test Acc: 0.659
Validation loss decreased (-0.640727 --> -0.659246).  Saving model ...
Epoch: 24 cost time: 0.8416974544525146
Epoch: 24, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.305 Vali Acc: 0.674 Test Loss: 1.305 Test Acc: 0.674
Validation loss decreased (-0.659246 --> -0.674061).  Saving model ...
Epoch: 25 cost time: 0.8325552940368652
Epoch: 25, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.277 Vali Acc: 0.693 Test Loss: 1.277 Test Acc: 0.693
Validation loss decreased (-0.674061 --> -0.692580).  Saving model ...
Epoch: 26 cost time: 0.93172287940979
Epoch: 26, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.249 Vali Acc: 0.722 Test Loss: 1.249 Test Acc: 0.722
Validation loss decreased (-0.692580 --> -0.722210).  Saving model ...
Epoch: 27 cost time: 0.7630984783172607
Epoch: 27, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.220 Vali Acc: 0.741 Test Loss: 1.220 Test Acc: 0.741
Validation loss decreased (-0.722210 --> -0.740729).  Saving model ...
Epoch: 28 cost time: 0.7817418575286865
Epoch: 28, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.192 Vali Acc: 0.767 Test Loss: 1.192 Test Acc: 0.767
Validation loss decreased (-0.740729 --> -0.766655).  Saving model ...
Epoch: 29 cost time: 0.7986140251159668
Epoch: 29, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.165 Vali Acc: 0.793 Test Loss: 1.165 Test Acc: 0.793
Validation loss decreased (-0.766655 --> -0.792581).  Saving model ...
Epoch: 30 cost time: 0.8401212692260742
Epoch: 30, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.137 Vali Acc: 0.807 Test Loss: 1.137 Test Acc: 0.807
Validation loss decreased (-0.792581 --> -0.807396).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8074074074074075
model parameter : 175942
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6214041709899902
Epoch: 1, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.745 Vali Acc: 0.270 Test Loss: 1.745 Test Acc: 0.270
Validation loss decreased (inf --> -0.270353).  Saving model ...
Epoch: 2 cost time: 0.8154146671295166
Epoch: 2, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.728 Vali Acc: 0.278 Test Loss: 1.728 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 0.7764043807983398
Epoch: 3, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.716 Vali Acc: 0.285 Test Loss: 1.716 Test Acc: 0.285
Validation loss decreased (-0.277761 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.758232831954956
Epoch: 4, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.708 Vali Acc: 0.285 Test Loss: 1.708 Test Acc: 0.285
Validation loss decreased (-0.285168 --> -0.285168).  Saving model ...
Epoch: 5 cost time: 0.8040962219238281
Epoch: 5, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.698 Vali Acc: 0.285 Test Loss: 1.698 Test Acc: 0.285
Validation loss decreased (-0.285168 --> -0.285168).  Saving model ...
Epoch: 6 cost time: 0.7316694259643555
Epoch: 6, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.686 Vali Acc: 0.289 Test Loss: 1.686 Test Acc: 0.289
Validation loss decreased (-0.285168 --> -0.288872).  Saving model ...
Epoch: 7 cost time: 0.8144357204437256
Epoch: 7, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.672 Vali Acc: 0.300 Test Loss: 1.672 Test Acc: 0.300
Validation loss decreased (-0.288872 --> -0.299983).  Saving model ...
Epoch: 8 cost time: 0.8324015140533447
Epoch: 8, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.658 Vali Acc: 0.304 Test Loss: 1.658 Test Acc: 0.304
Validation loss decreased (-0.299983 --> -0.303687).  Saving model ...
Epoch: 9 cost time: 0.8325862884521484
Epoch: 9, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.642 Vali Acc: 0.319 Test Loss: 1.642 Test Acc: 0.319
Validation loss decreased (-0.303687 --> -0.318502).  Saving model ...
Epoch: 10 cost time: 0.8256235122680664
Epoch: 10, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.625 Vali Acc: 0.330 Test Loss: 1.625 Test Acc: 0.330
Validation loss decreased (-0.318502 --> -0.329613).  Saving model ...
Epoch: 11 cost time: 0.8377120494842529
Epoch: 11, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.607 Vali Acc: 0.352 Test Loss: 1.607 Test Acc: 0.352
Validation loss decreased (-0.329613 --> -0.351836).  Saving model ...
Epoch: 12 cost time: 0.7293300628662109
Epoch: 12, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.588 Vali Acc: 0.367 Test Loss: 1.588 Test Acc: 0.367
Validation loss decreased (-0.351836 --> -0.366651).  Saving model ...
Epoch: 13 cost time: 0.8239645957946777
Epoch: 13, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.569 Vali Acc: 0.419 Test Loss: 1.569 Test Acc: 0.419
Validation loss decreased (-0.366651 --> -0.418503).  Saving model ...
Epoch: 14 cost time: 0.7758522033691406
Epoch: 14, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.548 Vali Acc: 0.441 Test Loss: 1.548 Test Acc: 0.441
Validation loss decreased (-0.418503 --> -0.440725).  Saving model ...
Epoch: 15 cost time: 0.7681787014007568
Epoch: 15, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.527 Vali Acc: 0.493 Test Loss: 1.527 Test Acc: 0.493
Validation loss decreased (-0.440725 --> -0.492577).  Saving model ...
Epoch: 16 cost time: 0.8955810070037842
Epoch: 16, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.505 Vali Acc: 0.519 Test Loss: 1.505 Test Acc: 0.519
Validation loss decreased (-0.492577 --> -0.518503).  Saving model ...
Epoch: 17 cost time: 0.7798388004302979
Epoch: 17, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.483 Vali Acc: 0.552 Test Loss: 1.483 Test Acc: 0.552
Validation loss decreased (-0.518503 --> -0.551837).  Saving model ...
Epoch: 18 cost time: 0.818763256072998
Epoch: 18, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.461 Vali Acc: 0.585 Test Loss: 1.461 Test Acc: 0.585
Validation loss decreased (-0.551837 --> -0.585171).  Saving model ...
Epoch: 19 cost time: 0.843132734298706
Epoch: 19, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.438 Vali Acc: 0.600 Test Loss: 1.438 Test Acc: 0.600
Validation loss decreased (-0.585171 --> -0.599986).  Saving model ...
Epoch: 20 cost time: 0.9703445434570312
Epoch: 20, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.414 Vali Acc: 0.615 Test Loss: 1.414 Test Acc: 0.615
Validation loss decreased (-0.599986 --> -0.614801).  Saving model ...
Epoch: 21 cost time: 0.8343791961669922
Epoch: 21, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.390 Vali Acc: 0.630 Test Loss: 1.390 Test Acc: 0.630
Validation loss decreased (-0.614801 --> -0.629616).  Saving model ...
Epoch: 22 cost time: 0.811957836151123
Epoch: 22, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.366 Vali Acc: 0.644 Test Loss: 1.366 Test Acc: 0.644
Validation loss decreased (-0.629616 --> -0.644431).  Saving model ...
Epoch: 23 cost time: 0.8125197887420654
Epoch: 23, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.341 Vali Acc: 0.659 Test Loss: 1.341 Test Acc: 0.659
Validation loss decreased (-0.644431 --> -0.659246).  Saving model ...
Epoch: 24 cost time: 0.8161394596099854
Epoch: 24, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.316 Vali Acc: 0.674 Test Loss: 1.316 Test Acc: 0.674
Validation loss decreased (-0.659246 --> -0.674061).  Saving model ...
Epoch: 25 cost time: 0.8016138076782227
Epoch: 25, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.291 Vali Acc: 0.689 Test Loss: 1.291 Test Acc: 0.689
Validation loss decreased (-0.674061 --> -0.688876).  Saving model ...
Epoch: 26 cost time: 0.7752926349639893
Epoch: 26, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.266 Vali Acc: 0.704 Test Loss: 1.266 Test Acc: 0.704
Validation loss decreased (-0.688876 --> -0.703691).  Saving model ...
Epoch: 27 cost time: 0.7918262481689453
Epoch: 27, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.241 Vali Acc: 0.715 Test Loss: 1.241 Test Acc: 0.715
Validation loss decreased (-0.703691 --> -0.714802).  Saving model ...
Epoch: 28 cost time: 0.7959022521972656
Epoch: 28, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.216 Vali Acc: 0.722 Test Loss: 1.216 Test Acc: 0.722
Validation loss decreased (-0.714802 --> -0.722210).  Saving model ...
Epoch: 29 cost time: 0.8387045860290527
Epoch: 29, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.191 Vali Acc: 0.733 Test Loss: 1.191 Test Acc: 0.733
Validation loss decreased (-0.722210 --> -0.733321).  Saving model ...
Epoch: 30 cost time: 0.7485263347625732
Epoch: 30, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.166 Vali Acc: 0.748 Test Loss: 1.166 Test Acc: 0.748
Validation loss decreased (-0.733321 --> -0.748136).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7481481481481481
model parameter : 589958
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3209216594696045
Epoch: 1, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.806 Vali Acc: 0.241 Test Loss: 1.806 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 0.7229235172271729
Epoch: 2, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.784 Vali Acc: 0.270 Test Loss: 1.784 Test Acc: 0.270
Validation loss decreased (-0.240723 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 0.6741154193878174
Epoch: 3, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.769 Vali Acc: 0.278 Test Loss: 1.769 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277760).  Saving model ...
Epoch: 4 cost time: 0.7648236751556396
Epoch: 4, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.760 Vali Acc: 0.278 Test Loss: 1.760 Test Acc: 0.278
Validation loss decreased (-0.277760 --> -0.277760).  Saving model ...
Epoch: 5 cost time: 0.7540662288665771
Epoch: 5, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.748 Vali Acc: 0.289 Test Loss: 1.748 Test Acc: 0.289
Validation loss decreased (-0.277760 --> -0.288871).  Saving model ...
Epoch: 6 cost time: 0.7525360584259033
Epoch: 6, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.734 Vali Acc: 0.300 Test Loss: 1.734 Test Acc: 0.300
Validation loss decreased (-0.288871 --> -0.299983).  Saving model ...
Epoch: 7 cost time: 0.7076306343078613
Epoch: 7, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.718 Vali Acc: 0.315 Test Loss: 1.718 Test Acc: 0.315
Validation loss decreased (-0.299983 --> -0.314798).  Saving model ...
Epoch: 8 cost time: 0.7596940994262695
Epoch: 8, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.701 Vali Acc: 0.322 Test Loss: 1.701 Test Acc: 0.322
Validation loss decreased (-0.314798 --> -0.322205).  Saving model ...
Epoch: 9 cost time: 0.7606885433197021
Epoch: 9, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.683 Vali Acc: 0.333 Test Loss: 1.683 Test Acc: 0.333
Validation loss decreased (-0.322205 --> -0.333317).  Saving model ...
Epoch: 10 cost time: 0.7171947956085205
Epoch: 10, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.663 Vali Acc: 0.341 Test Loss: 1.663 Test Acc: 0.341
Validation loss decreased (-0.333317 --> -0.340724).  Saving model ...
Epoch: 11 cost time: 0.7569351196289062
Epoch: 11, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.642 Vali Acc: 0.356 Test Loss: 1.642 Test Acc: 0.356
Validation loss decreased (-0.340724 --> -0.355539).  Saving model ...
Epoch: 12 cost time: 0.7479860782623291
Epoch: 12, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.620 Vali Acc: 0.359 Test Loss: 1.620 Test Acc: 0.359
Validation loss decreased (-0.355539 --> -0.359243).  Saving model ...
Epoch: 13 cost time: 0.6817278861999512
Epoch: 13, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.597 Vali Acc: 0.396 Test Loss: 1.597 Test Acc: 0.396
Validation loss decreased (-0.359243 --> -0.396280).  Saving model ...
Epoch: 14 cost time: 0.6989443302154541
Epoch: 14, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.573 Vali Acc: 0.415 Test Loss: 1.573 Test Acc: 0.415
Validation loss decreased (-0.396280 --> -0.414799).  Saving model ...
Epoch: 15 cost time: 0.8175530433654785
Epoch: 15, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.549 Vali Acc: 0.433 Test Loss: 1.549 Test Acc: 0.433
Validation loss decreased (-0.414799 --> -0.433318).  Saving model ...
Epoch: 16 cost time: 0.7076761722564697
Epoch: 16, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.524 Vali Acc: 0.452 Test Loss: 1.524 Test Acc: 0.452
Validation loss decreased (-0.433318 --> -0.451837).  Saving model ...
Epoch: 17 cost time: 0.7983477115631104
Epoch: 17, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.498 Vali Acc: 0.474 Test Loss: 1.498 Test Acc: 0.474
Validation loss decreased (-0.451837 --> -0.474059).  Saving model ...
Epoch: 18 cost time: 0.8595554828643799
Epoch: 18, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.471 Vali Acc: 0.507 Test Loss: 1.471 Test Acc: 0.507
Validation loss decreased (-0.474059 --> -0.507393).  Saving model ...
Epoch: 19 cost time: 0.8989808559417725
Epoch: 19, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.444 Vali Acc: 0.530 Test Loss: 1.444 Test Acc: 0.530
Validation loss decreased (-0.507393 --> -0.529615).  Saving model ...
Epoch: 20 cost time: 0.7299354076385498
Epoch: 20, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.417 Vali Acc: 0.574 Test Loss: 1.417 Test Acc: 0.574
Validation loss decreased (-0.529615 --> -0.574060).  Saving model ...
Epoch: 21 cost time: 0.7479357719421387
Epoch: 21, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.389 Vali Acc: 0.607 Test Loss: 1.389 Test Acc: 0.607
Validation loss decreased (-0.574060 --> -0.607394).  Saving model ...
Epoch: 22 cost time: 0.7932021617889404
Epoch: 22, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.362 Vali Acc: 0.641 Test Loss: 1.362 Test Acc: 0.641
Validation loss decreased (-0.607394 --> -0.640727).  Saving model ...
Epoch: 23 cost time: 0.8240160942077637
Epoch: 23, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.333 Vali Acc: 0.659 Test Loss: 1.333 Test Acc: 0.659
Validation loss decreased (-0.640727 --> -0.659246).  Saving model ...
Epoch: 24 cost time: 0.8414950370788574
Epoch: 24, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.305 Vali Acc: 0.674 Test Loss: 1.305 Test Acc: 0.674
Validation loss decreased (-0.659246 --> -0.674061).  Saving model ...
Epoch: 25 cost time: 0.7804450988769531
Epoch: 25, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.277 Vali Acc: 0.693 Test Loss: 1.277 Test Acc: 0.693
Validation loss decreased (-0.674061 --> -0.692580).  Saving model ...
Epoch: 26 cost time: 0.7632026672363281
Epoch: 26, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.249 Vali Acc: 0.722 Test Loss: 1.249 Test Acc: 0.722
Validation loss decreased (-0.692580 --> -0.722210).  Saving model ...
Epoch: 27 cost time: 0.7098488807678223
Epoch: 27, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.220 Vali Acc: 0.741 Test Loss: 1.220 Test Acc: 0.741
Validation loss decreased (-0.722210 --> -0.740729).  Saving model ...
Epoch: 28 cost time: 0.7829351425170898
Epoch: 28, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.192 Vali Acc: 0.767 Test Loss: 1.192 Test Acc: 0.767
Validation loss decreased (-0.740729 --> -0.766655).  Saving model ...
Epoch: 29 cost time: 0.9183752536773682
Epoch: 29, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.165 Vali Acc: 0.793 Test Loss: 1.165 Test Acc: 0.793
Validation loss decreased (-0.766655 --> -0.792581).  Saving model ...
Epoch: 30 cost time: 0.8170361518859863
Epoch: 30, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.137 Vali Acc: 0.807 Test Loss: 1.137 Test Acc: 0.807
Validation loss decreased (-0.792581 --> -0.807396).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8074074074074075
model parameter : 175942
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.424327850341797
Epoch: 1, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.746 Vali Acc: 0.274 Test Loss: 1.746 Test Acc: 0.274
Validation loss decreased (inf --> -0.274057).  Saving model ...
Epoch: 2 cost time: 0.6165487766265869
Epoch: 2, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.729 Vali Acc: 0.278 Test Loss: 1.729 Test Acc: 0.278
Validation loss decreased (-0.274057 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 0.6963398456573486
Epoch: 3, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.717 Vali Acc: 0.285 Test Loss: 1.717 Test Acc: 0.285
Validation loss decreased (-0.277760 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.665395975112915
Epoch: 4, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.709 Vali Acc: 0.285 Test Loss: 1.709 Test Acc: 0.285
Validation loss decreased (-0.285168 --> -0.285168).  Saving model ...
Epoch: 5 cost time: 0.6834580898284912
Epoch: 5, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.699 Vali Acc: 0.285 Test Loss: 1.699 Test Acc: 0.285
Validation loss decreased (-0.285168 --> -0.285168).  Saving model ...
Epoch: 6 cost time: 0.7538163661956787
Epoch: 6, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.688 Vali Acc: 0.289 Test Loss: 1.688 Test Acc: 0.289
Validation loss decreased (-0.285168 --> -0.288872).  Saving model ...
Epoch: 7 cost time: 0.6680169105529785
Epoch: 7, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.675 Vali Acc: 0.296 Test Loss: 1.675 Test Acc: 0.296
Validation loss decreased (-0.288872 --> -0.296280).  Saving model ...
Epoch: 8 cost time: 0.6916024684906006
Epoch: 8, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.660 Vali Acc: 0.300 Test Loss: 1.660 Test Acc: 0.300
Validation loss decreased (-0.296280 --> -0.299983).  Saving model ...
Epoch: 9 cost time: 0.659475564956665
Epoch: 9, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.645 Vali Acc: 0.315 Test Loss: 1.645 Test Acc: 0.315
Validation loss decreased (-0.299983 --> -0.314798).  Saving model ...
Epoch: 10 cost time: 0.7267823219299316
Epoch: 10, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.629 Vali Acc: 0.326 Test Loss: 1.629 Test Acc: 0.326
Validation loss decreased (-0.314798 --> -0.325910).  Saving model ...
Epoch: 11 cost time: 0.6709804534912109
Epoch: 11, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.611 Vali Acc: 0.348 Test Loss: 1.611 Test Acc: 0.348
Validation loss decreased (-0.325910 --> -0.348132).  Saving model ...
Epoch: 12 cost time: 0.7088010311126709
Epoch: 12, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.593 Vali Acc: 0.367 Test Loss: 1.593 Test Acc: 0.367
Validation loss decreased (-0.348132 --> -0.366651).  Saving model ...
Epoch: 13 cost time: 0.6611979007720947
Epoch: 13, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.574 Vali Acc: 0.411 Test Loss: 1.574 Test Acc: 0.411
Validation loss decreased (-0.366651 --> -0.411095).  Saving model ...
Epoch: 14 cost time: 0.6504464149475098
Epoch: 14, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.555 Vali Acc: 0.437 Test Loss: 1.555 Test Acc: 0.437
Validation loss decreased (-0.411095 --> -0.437021).  Saving model ...
Epoch: 15 cost time: 0.7351391315460205
Epoch: 15, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.534 Vali Acc: 0.481 Test Loss: 1.534 Test Acc: 0.481
Validation loss decreased (-0.437021 --> -0.481466).  Saving model ...
Epoch: 16 cost time: 0.6889688968658447
Epoch: 16, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.513 Vali Acc: 0.507 Test Loss: 1.513 Test Acc: 0.507
Validation loss decreased (-0.481466 --> -0.507392).  Saving model ...
Epoch: 17 cost time: 0.7053229808807373
Epoch: 17, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.491 Vali Acc: 0.537 Test Loss: 1.491 Test Acc: 0.537
Validation loss decreased (-0.507392 --> -0.537022).  Saving model ...
Epoch: 18 cost time: 0.7008829116821289
Epoch: 18, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.470 Vali Acc: 0.563 Test Loss: 1.470 Test Acc: 0.563
Validation loss decreased (-0.537022 --> -0.562948).  Saving model ...
Epoch: 19 cost time: 0.6999709606170654
Epoch: 19, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.447 Vali Acc: 0.593 Test Loss: 1.447 Test Acc: 0.593
Validation loss decreased (-0.562948 --> -0.592578).  Saving model ...
Epoch: 20 cost time: 0.7081196308135986
Epoch: 20, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.424 Vali Acc: 0.611 Test Loss: 1.424 Test Acc: 0.611
Validation loss decreased (-0.592578 --> -0.611097).  Saving model ...
Epoch: 21 cost time: 0.6680421829223633
Epoch: 21, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.401 Vali Acc: 0.626 Test Loss: 1.401 Test Acc: 0.626
Validation loss decreased (-0.611097 --> -0.625912).  Saving model ...
Epoch: 22 cost time: 0.633751392364502
Epoch: 22, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.377 Vali Acc: 0.630 Test Loss: 1.377 Test Acc: 0.630
Validation loss decreased (-0.625912 --> -0.629616).  Saving model ...
Epoch: 23 cost time: 0.7280232906341553
Epoch: 23, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.353 Vali Acc: 0.644 Test Loss: 1.353 Test Acc: 0.644
Validation loss decreased (-0.629616 --> -0.644431).  Saving model ...
Epoch: 24 cost time: 0.6294693946838379
Epoch: 24, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.328 Vali Acc: 0.667 Test Loss: 1.328 Test Acc: 0.667
Validation loss decreased (-0.644431 --> -0.666653).  Saving model ...
Epoch: 25 cost time: 0.6009666919708252
Epoch: 25, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.303 Vali Acc: 0.685 Test Loss: 1.303 Test Acc: 0.685
Validation loss decreased (-0.666653 --> -0.685172).  Saving model ...
Epoch: 26 cost time: 0.6642358303070068
Epoch: 26, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.279 Vali Acc: 0.696 Test Loss: 1.279 Test Acc: 0.696
Validation loss decreased (-0.685172 --> -0.696284).  Saving model ...
Epoch: 27 cost time: 0.7860026359558105
Epoch: 27, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.254 Vali Acc: 0.711 Test Loss: 1.254 Test Acc: 0.711
Validation loss decreased (-0.696284 --> -0.711099).  Saving model ...
Epoch: 28 cost time: 0.6228663921356201
Epoch: 28, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.228 Vali Acc: 0.726 Test Loss: 1.228 Test Acc: 0.726
Validation loss decreased (-0.711099 --> -0.725914).  Saving model ...
Epoch: 29 cost time: 0.6496126651763916
Epoch: 29, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.203 Vali Acc: 0.737 Test Loss: 1.203 Test Acc: 0.737
Validation loss decreased (-0.725914 --> -0.737025).  Saving model ...
Epoch: 30 cost time: 0.6988811492919922
Epoch: 30, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.178 Vali Acc: 0.748 Test Loss: 1.178 Test Acc: 0.748
Validation loss decreased (-0.737025 --> -0.748136).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7481481481481481
model parameter : 589958
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.204080104827881
Epoch: 1, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.805 Vali Acc: 0.241 Test Loss: 1.805 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 0.6613092422485352
Epoch: 2, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.783 Vali Acc: 0.270 Test Loss: 1.783 Test Acc: 0.270
Validation loss decreased (-0.240723 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 0.7839055061340332
Epoch: 3, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.768 Vali Acc: 0.278 Test Loss: 1.768 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277760).  Saving model ...
Epoch: 4 cost time: 0.6408231258392334
Epoch: 4, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.759 Vali Acc: 0.278 Test Loss: 1.759 Test Acc: 0.278
Validation loss decreased (-0.277760 --> -0.277760).  Saving model ...
Epoch: 5 cost time: 0.6717081069946289
Epoch: 5, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.747 Vali Acc: 0.289 Test Loss: 1.747 Test Acc: 0.289
Validation loss decreased (-0.277760 --> -0.288871).  Saving model ...
Epoch: 6 cost time: 0.7163546085357666
Epoch: 6, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.734 Vali Acc: 0.300 Test Loss: 1.734 Test Acc: 0.300
Validation loss decreased (-0.288871 --> -0.299983).  Saving model ...
Epoch: 7 cost time: 0.7073831558227539
Epoch: 7, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.718 Vali Acc: 0.315 Test Loss: 1.718 Test Acc: 0.315
Validation loss decreased (-0.299983 --> -0.314798).  Saving model ...
Epoch: 8 cost time: 0.6809530258178711
Epoch: 8, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.701 Vali Acc: 0.322 Test Loss: 1.701 Test Acc: 0.322
Validation loss decreased (-0.314798 --> -0.322205).  Saving model ...
Epoch: 9 cost time: 0.699429988861084
Epoch: 9, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.683 Vali Acc: 0.333 Test Loss: 1.683 Test Acc: 0.333
Validation loss decreased (-0.322205 --> -0.333317).  Saving model ...
Epoch: 10 cost time: 0.8069987297058105
Epoch: 10, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.664 Vali Acc: 0.341 Test Loss: 1.664 Test Acc: 0.341
Validation loss decreased (-0.333317 --> -0.340724).  Saving model ...
Epoch: 11 cost time: 0.642613410949707
Epoch: 11, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.643 Vali Acc: 0.356 Test Loss: 1.643 Test Acc: 0.356
Validation loss decreased (-0.340724 --> -0.355539).  Saving model ...
Epoch: 12 cost time: 0.6571698188781738
Epoch: 12, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.621 Vali Acc: 0.367 Test Loss: 1.621 Test Acc: 0.367
Validation loss decreased (-0.355539 --> -0.366650).  Saving model ...
Epoch: 13 cost time: 0.6588990688323975
Epoch: 13, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.599 Vali Acc: 0.389 Test Loss: 1.599 Test Acc: 0.389
Validation loss decreased (-0.366650 --> -0.388873).  Saving model ...
Epoch: 14 cost time: 0.705641508102417
Epoch: 14, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.576 Vali Acc: 0.411 Test Loss: 1.576 Test Acc: 0.411
Validation loss decreased (-0.388873 --> -0.411095).  Saving model ...
Epoch: 15 cost time: 0.7517914772033691
Epoch: 15, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.552 Vali Acc: 0.426 Test Loss: 1.552 Test Acc: 0.426
Validation loss decreased (-0.411095 --> -0.425910).  Saving model ...
Epoch: 16 cost time: 0.7154755592346191
Epoch: 16, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.527 Vali Acc: 0.448 Test Loss: 1.527 Test Acc: 0.448
Validation loss decreased (-0.425910 --> -0.448133).  Saving model ...
Epoch: 17 cost time: 0.6768290996551514
Epoch: 17, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.502 Vali Acc: 0.470 Test Loss: 1.502 Test Acc: 0.470
Validation loss decreased (-0.448133 --> -0.470355).  Saving model ...
Epoch: 18 cost time: 0.7128055095672607
Epoch: 18, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.476 Vali Acc: 0.496 Test Loss: 1.476 Test Acc: 0.496
Validation loss decreased (-0.470355 --> -0.496282).  Saving model ...
Epoch: 19 cost time: 0.7113819122314453
Epoch: 19, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.450 Vali Acc: 0.522 Test Loss: 1.450 Test Acc: 0.522
Validation loss decreased (-0.496282 --> -0.522208).  Saving model ...
Epoch: 20 cost time: 0.8144145011901855
Epoch: 20, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.423 Vali Acc: 0.563 Test Loss: 1.423 Test Acc: 0.563
Validation loss decreased (-0.522208 --> -0.562949).  Saving model ...
Epoch: 21 cost time: 0.7661442756652832
Epoch: 21, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.396 Vali Acc: 0.593 Test Loss: 1.396 Test Acc: 0.593
Validation loss decreased (-0.562949 --> -0.592579).  Saving model ...
Epoch: 22 cost time: 0.804936408996582
Epoch: 22, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.369 Vali Acc: 0.630 Test Loss: 1.369 Test Acc: 0.630
Validation loss decreased (-0.592579 --> -0.629616).  Saving model ...
Epoch: 23 cost time: 0.6987130641937256
Epoch: 23, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.341 Vali Acc: 0.659 Test Loss: 1.341 Test Acc: 0.659
Validation loss decreased (-0.629616 --> -0.659246).  Saving model ...
Epoch: 24 cost time: 0.7452609539031982
Epoch: 24, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.313 Vali Acc: 0.670 Test Loss: 1.313 Test Acc: 0.670
Validation loss decreased (-0.659246 --> -0.670357).  Saving model ...
Epoch: 25 cost time: 0.7764191627502441
Epoch: 25, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.285 Vali Acc: 0.689 Test Loss: 1.285 Test Acc: 0.689
Validation loss decreased (-0.670357 --> -0.688876).  Saving model ...
Epoch: 26 cost time: 0.8003582954406738
Epoch: 26, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.258 Vali Acc: 0.715 Test Loss: 1.258 Test Acc: 0.715
Validation loss decreased (-0.688876 --> -0.714802).  Saving model ...
Epoch: 27 cost time: 0.7445361614227295
Epoch: 27, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.230 Vali Acc: 0.744 Test Loss: 1.230 Test Acc: 0.744
Validation loss decreased (-0.714802 --> -0.744432).  Saving model ...
Epoch: 28 cost time: 0.7209441661834717
Epoch: 28, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.202 Vali Acc: 0.767 Test Loss: 1.202 Test Acc: 0.767
Validation loss decreased (-0.744432 --> -0.766655).  Saving model ...
Epoch: 29 cost time: 0.785635232925415
Epoch: 29, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.175 Vali Acc: 0.789 Test Loss: 1.175 Test Acc: 0.789
Validation loss decreased (-0.766655 --> -0.788877).  Saving model ...
Epoch: 30 cost time: 0.7606148719787598
Epoch: 30, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.148 Vali Acc: 0.811 Test Loss: 1.148 Test Acc: 0.811
Validation loss decreased (-0.788877 --> -0.811100).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8111111111111111
model parameter : 175942
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.688504219055176
Epoch: 1, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.895 Vali Acc: 0.219 Test Loss: 1.895 Test Acc: 0.219
Validation loss decreased (inf --> -0.218500).  Saving model ...
Epoch: 2 cost time: 0.7925422191619873
Epoch: 2, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.873 Vali Acc: 0.230 Test Loss: 1.873 Test Acc: 0.230
Validation loss decreased (-0.218500 --> -0.229611).  Saving model ...
Epoch: 3 cost time: 0.9073238372802734
Epoch: 3, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.859 Vali Acc: 0.263 Test Loss: 1.859 Test Acc: 0.263
Validation loss decreased (-0.229611 --> -0.262944).  Saving model ...
Epoch: 4 cost time: 0.9662055969238281
Epoch: 4, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.852 Vali Acc: 0.270 Test Loss: 1.852 Test Acc: 0.270
Validation loss decreased (-0.262944 --> -0.270352).  Saving model ...
Epoch: 5 cost time: 0.9018528461456299
Epoch: 5, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.841 Vali Acc: 0.270 Test Loss: 1.841 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270352).  Saving model ...
Epoch: 6 cost time: 0.9332048892974854
Epoch: 6, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.829 Vali Acc: 0.281 Test Loss: 1.829 Test Acc: 0.281
Validation loss decreased (-0.270352 --> -0.281463).  Saving model ...
Epoch: 7 cost time: 0.9202530384063721
Epoch: 7, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.814 Vali Acc: 0.304 Test Loss: 1.814 Test Acc: 0.304
Validation loss decreased (-0.281463 --> -0.303686).  Saving model ...
Epoch: 8 cost time: 0.8959360122680664
Epoch: 8, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.799 Vali Acc: 0.319 Test Loss: 1.799 Test Acc: 0.319
Validation loss decreased (-0.303686 --> -0.318501).  Saving model ...
Epoch: 9 cost time: 0.8614315986633301
Epoch: 9, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.782 Vali Acc: 0.326 Test Loss: 1.782 Test Acc: 0.326
Validation loss decreased (-0.318501 --> -0.325908).  Saving model ...
Epoch: 10 cost time: 0.9165866374969482
Epoch: 10, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.764 Vali Acc: 0.348 Test Loss: 1.764 Test Acc: 0.348
Validation loss decreased (-0.325908 --> -0.348131).  Saving model ...
Epoch: 11 cost time: 0.9188289642333984
Epoch: 11, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.745 Vali Acc: 0.370 Test Loss: 1.745 Test Acc: 0.370
Validation loss decreased (-0.348131 --> -0.370353).  Saving model ...
Epoch: 12 cost time: 0.9786286354064941
Epoch: 12, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.725 Vali Acc: 0.385 Test Loss: 1.725 Test Acc: 0.385
Validation loss decreased (-0.370353 --> -0.385168).  Saving model ...
Epoch: 13 cost time: 0.9441540241241455
Epoch: 13, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.706 Vali Acc: 0.389 Test Loss: 1.706 Test Acc: 0.389
Validation loss decreased (-0.385168 --> -0.388872).  Saving model ...
Epoch: 14 cost time: 0.9061310291290283
Epoch: 14, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.685 Vali Acc: 0.407 Test Loss: 1.685 Test Acc: 0.407
Validation loss decreased (-0.388872 --> -0.407391).  Saving model ...
Epoch: 15 cost time: 0.8373258113861084
Epoch: 15, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.664 Vali Acc: 0.430 Test Loss: 1.664 Test Acc: 0.430
Validation loss decreased (-0.407391 --> -0.429613).  Saving model ...
Epoch: 16 cost time: 0.8575561046600342
Epoch: 16, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.643 Vali Acc: 0.444 Test Loss: 1.643 Test Acc: 0.444
Validation loss decreased (-0.429613 --> -0.444428).  Saving model ...
Epoch: 17 cost time: 0.840770959854126
Epoch: 17, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.621 Vali Acc: 0.463 Test Loss: 1.621 Test Acc: 0.463
Validation loss decreased (-0.444428 --> -0.462947).  Saving model ...
Epoch: 18 cost time: 0.8604855537414551
Epoch: 18, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.599 Vali Acc: 0.481 Test Loss: 1.599 Test Acc: 0.481
Validation loss decreased (-0.462947 --> -0.481465).  Saving model ...
Epoch: 19 cost time: 0.8706576824188232
Epoch: 19, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.577 Vali Acc: 0.511 Test Loss: 1.577 Test Acc: 0.511
Validation loss decreased (-0.481465 --> -0.511095).  Saving model ...
Epoch: 20 cost time: 0.8747081756591797
Epoch: 20, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.554 Vali Acc: 0.530 Test Loss: 1.554 Test Acc: 0.530
Validation loss decreased (-0.511095 --> -0.529614).  Saving model ...
Epoch: 21 cost time: 0.9103944301605225
Epoch: 21, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.531 Vali Acc: 0.541 Test Loss: 1.531 Test Acc: 0.541
Validation loss decreased (-0.529614 --> -0.540725).  Saving model ...
Epoch: 22 cost time: 0.9278242588043213
Epoch: 22, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.508 Vali Acc: 0.556 Test Loss: 1.508 Test Acc: 0.556
Validation loss decreased (-0.540725 --> -0.555540).  Saving model ...
Epoch: 23 cost time: 0.9079058170318604
Epoch: 23, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.485 Vali Acc: 0.559 Test Loss: 1.485 Test Acc: 0.559
Validation loss decreased (-0.555540 --> -0.559244).  Saving model ...
Epoch: 24 cost time: 0.8503358364105225
Epoch: 24, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.461 Vali Acc: 0.570 Test Loss: 1.461 Test Acc: 0.570
Validation loss decreased (-0.559244 --> -0.570356).  Saving model ...
Epoch: 25 cost time: 0.8023979663848877
Epoch: 25, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.437 Vali Acc: 0.600 Test Loss: 1.437 Test Acc: 0.600
Validation loss decreased (-0.570356 --> -0.599986).  Saving model ...
Epoch: 26 cost time: 0.8421344757080078
Epoch: 26, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.414 Vali Acc: 0.619 Test Loss: 1.414 Test Acc: 0.619
Validation loss decreased (-0.599986 --> -0.618504).  Saving model ...
Epoch: 27 cost time: 0.9290707111358643
Epoch: 27, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.391 Vali Acc: 0.626 Test Loss: 1.391 Test Acc: 0.626
Validation loss decreased (-0.618504 --> -0.625912).  Saving model ...
Epoch: 28 cost time: 0.8925611972808838
Epoch: 28, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.367 Vali Acc: 0.633 Test Loss: 1.367 Test Acc: 0.633
Validation loss decreased (-0.625912 --> -0.633320).  Saving model ...
Epoch: 29 cost time: 0.8440165519714355
Epoch: 29, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.344 Vali Acc: 0.644 Test Loss: 1.344 Test Acc: 0.644
Validation loss decreased (-0.633320 --> -0.644431).  Saving model ...
Epoch: 30 cost time: 0.9670135974884033
Epoch: 30, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.321 Vali Acc: 0.667 Test Loss: 1.321 Test Acc: 0.667
Validation loss decreased (-0.644431 --> -0.666653).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6666666666666666
model parameter : 296710
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.62123441696167
Epoch: 1, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.712 Vali Acc: 0.204 Test Loss: 1.712 Test Acc: 0.204
Validation loss decreased (inf --> -0.203687).  Saving model ...
Epoch: 2 cost time: 0.7710554599761963
Epoch: 2, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.696 Vali Acc: 0.230 Test Loss: 1.696 Test Acc: 0.230
Validation loss decreased (-0.203687 --> -0.229613).  Saving model ...
Epoch: 3 cost time: 0.8519620895385742
Epoch: 3, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.686 Vali Acc: 0.244 Test Loss: 1.686 Test Acc: 0.244
Validation loss decreased (-0.229613 --> -0.244428).  Saving model ...
Epoch: 4 cost time: 0.7759182453155518
Epoch: 4, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.679 Vali Acc: 0.256 Test Loss: 1.679 Test Acc: 0.256
Validation loss decreased (-0.244428 --> -0.255539).  Saving model ...
Epoch: 5 cost time: 0.7597994804382324
Epoch: 5, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.670 Vali Acc: 0.270 Test Loss: 1.670 Test Acc: 0.270
Validation loss decreased (-0.255539 --> -0.270354).  Saving model ...
Epoch: 6 cost time: 0.8253345489501953
Epoch: 6, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.659 Vali Acc: 0.296 Test Loss: 1.659 Test Acc: 0.296
Validation loss decreased (-0.270354 --> -0.296280).  Saving model ...
Epoch: 7 cost time: 0.7117440700531006
Epoch: 7, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.647 Vali Acc: 0.315 Test Loss: 1.647 Test Acc: 0.315
Validation loss decreased (-0.296280 --> -0.314798).  Saving model ...
Epoch: 8 cost time: 0.8150815963745117
Epoch: 8, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.633 Vali Acc: 0.344 Test Loss: 1.633 Test Acc: 0.344
Validation loss decreased (-0.314798 --> -0.344428).  Saving model ...
Epoch: 9 cost time: 0.7951822280883789
Epoch: 9, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.618 Vali Acc: 0.378 Test Loss: 1.618 Test Acc: 0.378
Validation loss decreased (-0.344428 --> -0.377762).  Saving model ...
Epoch: 10 cost time: 0.8234672546386719
Epoch: 10, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.603 Vali Acc: 0.411 Test Loss: 1.603 Test Acc: 0.411
Validation loss decreased (-0.377762 --> -0.411095).  Saving model ...
Epoch: 11 cost time: 0.7938113212585449
Epoch: 11, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.586 Vali Acc: 0.444 Test Loss: 1.586 Test Acc: 0.444
Validation loss decreased (-0.411095 --> -0.444429).  Saving model ...
Epoch: 12 cost time: 0.745391845703125
Epoch: 12, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.568 Vali Acc: 0.470 Test Loss: 1.568 Test Acc: 0.470
Validation loss decreased (-0.444429 --> -0.470355).  Saving model ...
Epoch: 13 cost time: 0.7788248062133789
Epoch: 13, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.550 Vali Acc: 0.489 Test Loss: 1.550 Test Acc: 0.489
Validation loss decreased (-0.470355 --> -0.488873).  Saving model ...
Epoch: 14 cost time: 0.8153996467590332
Epoch: 14, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.532 Vali Acc: 0.522 Test Loss: 1.532 Test Acc: 0.522
Validation loss decreased (-0.488873 --> -0.522207).  Saving model ...
Epoch: 15 cost time: 0.8362736701965332
Epoch: 15, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.513 Vali Acc: 0.556 Test Loss: 1.513 Test Acc: 0.556
Validation loss decreased (-0.522207 --> -0.555540).  Saving model ...
Epoch: 16 cost time: 0.8172862529754639
Epoch: 16, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.493 Vali Acc: 0.581 Test Loss: 1.493 Test Acc: 0.581
Validation loss decreased (-0.555540 --> -0.581467).  Saving model ...
Epoch: 17 cost time: 0.8324229717254639
Epoch: 17, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.473 Vali Acc: 0.611 Test Loss: 1.473 Test Acc: 0.611
Validation loss decreased (-0.581467 --> -0.611096).  Saving model ...
Epoch: 18 cost time: 0.7902276515960693
Epoch: 18, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.452 Vali Acc: 0.637 Test Loss: 1.452 Test Acc: 0.637
Validation loss decreased (-0.611096 --> -0.637023).  Saving model ...
Epoch: 19 cost time: 0.7531592845916748
Epoch: 19, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.431 Vali Acc: 0.659 Test Loss: 1.431 Test Acc: 0.659
Validation loss decreased (-0.637023 --> -0.659245).  Saving model ...
Epoch: 20 cost time: 0.8111605644226074
Epoch: 20, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.410 Vali Acc: 0.670 Test Loss: 1.410 Test Acc: 0.670
Validation loss decreased (-0.659245 --> -0.670356).  Saving model ...
Epoch: 21 cost time: 0.7851710319519043
Epoch: 21, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.389 Vali Acc: 0.681 Test Loss: 1.389 Test Acc: 0.681
Validation loss decreased (-0.670356 --> -0.681468).  Saving model ...
Epoch: 22 cost time: 0.7585432529449463
Epoch: 22, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.367 Vali Acc: 0.704 Test Loss: 1.367 Test Acc: 0.704
Validation loss decreased (-0.681468 --> -0.703690).  Saving model ...
Epoch: 23 cost time: 0.798377275466919
Epoch: 23, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.345 Vali Acc: 0.737 Test Loss: 1.345 Test Acc: 0.737
Validation loss decreased (-0.703690 --> -0.737024).  Saving model ...
Epoch: 24 cost time: 0.8239328861236572
Epoch: 24, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.322 Vali Acc: 0.748 Test Loss: 1.322 Test Acc: 0.748
Validation loss decreased (-0.737024 --> -0.748135).  Saving model ...
Epoch: 25 cost time: 0.8212525844573975
Epoch: 25, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.300 Vali Acc: 0.763 Test Loss: 1.300 Test Acc: 0.763
Validation loss decreased (-0.748135 --> -0.762950).  Saving model ...
Epoch: 26 cost time: 0.8057904243469238
Epoch: 26, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.277 Vali Acc: 0.770 Test Loss: 1.277 Test Acc: 0.770
Validation loss decreased (-0.762950 --> -0.770358).  Saving model ...
Epoch: 27 cost time: 0.7561514377593994
Epoch: 27, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.254 Vali Acc: 0.789 Test Loss: 1.254 Test Acc: 0.789
Validation loss decreased (-0.770358 --> -0.788876).  Saving model ...
Epoch: 28 cost time: 0.7757589817047119
Epoch: 28, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.232 Vali Acc: 0.800 Test Loss: 1.232 Test Acc: 0.800
Validation loss decreased (-0.788876 --> -0.799988).  Saving model ...
Epoch: 29 cost time: 0.7158679962158203
Epoch: 29, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.209 Vali Acc: 0.822 Test Loss: 1.209 Test Acc: 0.822
Validation loss decreased (-0.799988 --> -0.822210).  Saving model ...
Epoch: 30 cost time: 0.740912675857544
Epoch: 30, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.186 Vali Acc: 0.822 Test Loss: 1.186 Test Acc: 0.822
Validation loss decreased (-0.822210 --> -0.822210).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8222222222222222
model parameter : 89670
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4976518154144287
Epoch: 1, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.895 Vali Acc: 0.219 Test Loss: 1.895 Test Acc: 0.219
Validation loss decreased (inf --> -0.218500).  Saving model ...
Epoch: 2 cost time: 0.7616713047027588
Epoch: 2, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.873 Vali Acc: 0.230 Test Loss: 1.873 Test Acc: 0.230
Validation loss decreased (-0.218500 --> -0.229611).  Saving model ...
Epoch: 3 cost time: 0.815798282623291
Epoch: 3, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.859 Vali Acc: 0.263 Test Loss: 1.859 Test Acc: 0.263
Validation loss decreased (-0.229611 --> -0.262944).  Saving model ...
Epoch: 4 cost time: 0.7898223400115967
Epoch: 4, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.852 Vali Acc: 0.270 Test Loss: 1.852 Test Acc: 0.270
Validation loss decreased (-0.262944 --> -0.270352).  Saving model ...
Epoch: 5 cost time: 0.7572801113128662
Epoch: 5, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.841 Vali Acc: 0.270 Test Loss: 1.841 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270352).  Saving model ...
Epoch: 6 cost time: 0.7115292549133301
Epoch: 6, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.829 Vali Acc: 0.281 Test Loss: 1.829 Test Acc: 0.281
Validation loss decreased (-0.270352 --> -0.281463).  Saving model ...
Epoch: 7 cost time: 0.827387809753418
Epoch: 7, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.814 Vali Acc: 0.304 Test Loss: 1.814 Test Acc: 0.304
Validation loss decreased (-0.281463 --> -0.303686).  Saving model ...
Epoch: 8 cost time: 0.7667739391326904
Epoch: 8, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.799 Vali Acc: 0.319 Test Loss: 1.799 Test Acc: 0.319
Validation loss decreased (-0.303686 --> -0.318501).  Saving model ...
Epoch: 9 cost time: 0.7452666759490967
Epoch: 9, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.782 Vali Acc: 0.326 Test Loss: 1.782 Test Acc: 0.326
Validation loss decreased (-0.318501 --> -0.325908).  Saving model ...
Epoch: 10 cost time: 0.8215019702911377
Epoch: 10, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.764 Vali Acc: 0.348 Test Loss: 1.764 Test Acc: 0.348
Validation loss decreased (-0.325908 --> -0.348131).  Saving model ...
Epoch: 11 cost time: 0.6959025859832764
Epoch: 11, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.745 Vali Acc: 0.370 Test Loss: 1.745 Test Acc: 0.370
Validation loss decreased (-0.348131 --> -0.370353).  Saving model ...
Epoch: 12 cost time: 0.8032956123352051
Epoch: 12, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.725 Vali Acc: 0.385 Test Loss: 1.725 Test Acc: 0.385
Validation loss decreased (-0.370353 --> -0.385168).  Saving model ...
Epoch: 13 cost time: 0.7050247192382812
Epoch: 13, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.706 Vali Acc: 0.389 Test Loss: 1.706 Test Acc: 0.389
Validation loss decreased (-0.385168 --> -0.388872).  Saving model ...
Epoch: 14 cost time: 0.6909244060516357
Epoch: 14, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.685 Vali Acc: 0.407 Test Loss: 1.685 Test Acc: 0.407
Validation loss decreased (-0.388872 --> -0.407391).  Saving model ...
Epoch: 15 cost time: 0.7100515365600586
Epoch: 15, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.664 Vali Acc: 0.430 Test Loss: 1.664 Test Acc: 0.430
Validation loss decreased (-0.407391 --> -0.429613).  Saving model ...
Epoch: 16 cost time: 0.7836620807647705
Epoch: 16, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.643 Vali Acc: 0.444 Test Loss: 1.643 Test Acc: 0.444
Validation loss decreased (-0.429613 --> -0.444428).  Saving model ...
Epoch: 17 cost time: 0.8322017192840576
Epoch: 17, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.621 Vali Acc: 0.463 Test Loss: 1.621 Test Acc: 0.463
Validation loss decreased (-0.444428 --> -0.462947).  Saving model ...
Epoch: 18 cost time: 0.7680821418762207
Epoch: 18, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.599 Vali Acc: 0.481 Test Loss: 1.599 Test Acc: 0.481
Validation loss decreased (-0.462947 --> -0.481465).  Saving model ...
Epoch: 19 cost time: 0.8841776847839355
Epoch: 19, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.577 Vali Acc: 0.511 Test Loss: 1.577 Test Acc: 0.511
Validation loss decreased (-0.481465 --> -0.511095).  Saving model ...
Epoch: 20 cost time: 0.7747218608856201
Epoch: 20, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.554 Vali Acc: 0.530 Test Loss: 1.554 Test Acc: 0.530
Validation loss decreased (-0.511095 --> -0.529614).  Saving model ...
Epoch: 21 cost time: 0.7412552833557129
Epoch: 21, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.531 Vali Acc: 0.541 Test Loss: 1.531 Test Acc: 0.541
Validation loss decreased (-0.529614 --> -0.540725).  Saving model ...
Epoch: 22 cost time: 0.7779214382171631
Epoch: 22, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.508 Vali Acc: 0.556 Test Loss: 1.508 Test Acc: 0.556
Validation loss decreased (-0.540725 --> -0.555540).  Saving model ...
Epoch: 23 cost time: 0.8172163963317871
Epoch: 23, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.485 Vali Acc: 0.559 Test Loss: 1.485 Test Acc: 0.559
Validation loss decreased (-0.555540 --> -0.559244).  Saving model ...
Epoch: 24 cost time: 0.7649269104003906
Epoch: 24, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.461 Vali Acc: 0.570 Test Loss: 1.461 Test Acc: 0.570
Validation loss decreased (-0.559244 --> -0.570356).  Saving model ...
Epoch: 25 cost time: 0.7975072860717773
Epoch: 25, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.437 Vali Acc: 0.600 Test Loss: 1.437 Test Acc: 0.600
Validation loss decreased (-0.570356 --> -0.599986).  Saving model ...
Epoch: 26 cost time: 0.7689898014068604
Epoch: 26, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.414 Vali Acc: 0.619 Test Loss: 1.414 Test Acc: 0.619
Validation loss decreased (-0.599986 --> -0.618504).  Saving model ...
Epoch: 27 cost time: 0.7816133499145508
Epoch: 27, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.391 Vali Acc: 0.626 Test Loss: 1.391 Test Acc: 0.626
Validation loss decreased (-0.618504 --> -0.625912).  Saving model ...
Epoch: 28 cost time: 0.7740635871887207
Epoch: 28, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.367 Vali Acc: 0.633 Test Loss: 1.367 Test Acc: 0.633
Validation loss decreased (-0.625912 --> -0.633320).  Saving model ...
Epoch: 29 cost time: 0.8978917598724365
Epoch: 29, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.344 Vali Acc: 0.644 Test Loss: 1.344 Test Acc: 0.644
Validation loss decreased (-0.633320 --> -0.644431).  Saving model ...
Epoch: 30 cost time: 0.8175859451293945
Epoch: 30, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.321 Vali Acc: 0.667 Test Loss: 1.321 Test Acc: 0.667
Validation loss decreased (-0.644431 --> -0.666653).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6666666666666666
model parameter : 296710
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5453784465789795
Epoch: 1, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.712 Vali Acc: 0.204 Test Loss: 1.712 Test Acc: 0.204
Validation loss decreased (inf --> -0.203687).  Saving model ...
Epoch: 2 cost time: 0.7716894149780273
Epoch: 2, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.697 Vali Acc: 0.230 Test Loss: 1.697 Test Acc: 0.230
Validation loss decreased (-0.203687 --> -0.229613).  Saving model ...
Epoch: 3 cost time: 0.6984944343566895
Epoch: 3, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.686 Vali Acc: 0.244 Test Loss: 1.686 Test Acc: 0.244
Validation loss decreased (-0.229613 --> -0.244428).  Saving model ...
Epoch: 4 cost time: 0.7451901435852051
Epoch: 4, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.679 Vali Acc: 0.256 Test Loss: 1.679 Test Acc: 0.256
Validation loss decreased (-0.244428 --> -0.255539).  Saving model ...
Epoch: 5 cost time: 0.7637834548950195
Epoch: 5, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.670 Vali Acc: 0.270 Test Loss: 1.670 Test Acc: 0.270
Validation loss decreased (-0.255539 --> -0.270354).  Saving model ...
Epoch: 6 cost time: 0.7617387771606445
Epoch: 6, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.659 Vali Acc: 0.296 Test Loss: 1.659 Test Acc: 0.296
Validation loss decreased (-0.270354 --> -0.296280).  Saving model ...
Epoch: 7 cost time: 0.7968699932098389
Epoch: 7, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.647 Vali Acc: 0.315 Test Loss: 1.647 Test Acc: 0.315
Validation loss decreased (-0.296280 --> -0.314798).  Saving model ...
Epoch: 8 cost time: 0.9048590660095215
Epoch: 8, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.633 Vali Acc: 0.344 Test Loss: 1.633 Test Acc: 0.344
Validation loss decreased (-0.314798 --> -0.344428).  Saving model ...
Epoch: 9 cost time: 0.7459259033203125
Epoch: 9, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.618 Vali Acc: 0.378 Test Loss: 1.618 Test Acc: 0.378
Validation loss decreased (-0.344428 --> -0.377762).  Saving model ...
Epoch: 10 cost time: 0.7919964790344238
Epoch: 10, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.603 Vali Acc: 0.411 Test Loss: 1.603 Test Acc: 0.411
Validation loss decreased (-0.377762 --> -0.411095).  Saving model ...
Epoch: 11 cost time: 0.8056161403656006
Epoch: 11, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.586 Vali Acc: 0.444 Test Loss: 1.586 Test Acc: 0.444
Validation loss decreased (-0.411095 --> -0.444429).  Saving model ...
Epoch: 12 cost time: 0.725471019744873
Epoch: 12, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.569 Vali Acc: 0.470 Test Loss: 1.569 Test Acc: 0.470
Validation loss decreased (-0.444429 --> -0.470355).  Saving model ...
Epoch: 13 cost time: 0.769909143447876
Epoch: 13, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.550 Vali Acc: 0.489 Test Loss: 1.550 Test Acc: 0.489
Validation loss decreased (-0.470355 --> -0.488873).  Saving model ...
Epoch: 14 cost time: 0.8366506099700928
Epoch: 14, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.532 Vali Acc: 0.522 Test Loss: 1.532 Test Acc: 0.522
Validation loss decreased (-0.488873 --> -0.522207).  Saving model ...
Epoch: 15 cost time: 0.7323122024536133
Epoch: 15, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.513 Vali Acc: 0.556 Test Loss: 1.513 Test Acc: 0.556
Validation loss decreased (-0.522207 --> -0.555540).  Saving model ...
Epoch: 16 cost time: 0.767524242401123
Epoch: 16, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.493 Vali Acc: 0.581 Test Loss: 1.493 Test Acc: 0.581
Validation loss decreased (-0.555540 --> -0.581467).  Saving model ...
Epoch: 17 cost time: 0.7832198143005371
Epoch: 17, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.473 Vali Acc: 0.611 Test Loss: 1.473 Test Acc: 0.611
Validation loss decreased (-0.581467 --> -0.611096).  Saving model ...
Epoch: 18 cost time: 0.7278938293457031
Epoch: 18, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.452 Vali Acc: 0.637 Test Loss: 1.452 Test Acc: 0.637
Validation loss decreased (-0.611096 --> -0.637023).  Saving model ...
Epoch: 19 cost time: 0.7397468090057373
Epoch: 19, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.431 Vali Acc: 0.659 Test Loss: 1.431 Test Acc: 0.659
Validation loss decreased (-0.637023 --> -0.659245).  Saving model ...
Epoch: 20 cost time: 0.7913172245025635
Epoch: 20, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.410 Vali Acc: 0.670 Test Loss: 1.410 Test Acc: 0.670
Validation loss decreased (-0.659245 --> -0.670356).  Saving model ...
Epoch: 21 cost time: 0.7065305709838867
Epoch: 21, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.389 Vali Acc: 0.681 Test Loss: 1.389 Test Acc: 0.681
Validation loss decreased (-0.670356 --> -0.681468).  Saving model ...
Epoch: 22 cost time: 0.7476732730865479
Epoch: 22, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.367 Vali Acc: 0.704 Test Loss: 1.367 Test Acc: 0.704
Validation loss decreased (-0.681468 --> -0.703690).  Saving model ...
Epoch: 23 cost time: 0.789691686630249
Epoch: 23, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.345 Vali Acc: 0.737 Test Loss: 1.345 Test Acc: 0.737
Validation loss decreased (-0.703690 --> -0.737024).  Saving model ...
Epoch: 24 cost time: 0.7516393661499023
Epoch: 24, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.322 Vali Acc: 0.748 Test Loss: 1.322 Test Acc: 0.748
Validation loss decreased (-0.737024 --> -0.748135).  Saving model ...
Epoch: 25 cost time: 0.7947425842285156
Epoch: 25, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.300 Vali Acc: 0.763 Test Loss: 1.300 Test Acc: 0.763
Validation loss decreased (-0.748135 --> -0.762950).  Saving model ...
Epoch: 26 cost time: 0.8008830547332764
Epoch: 26, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.277 Vali Acc: 0.770 Test Loss: 1.277 Test Acc: 0.770
Validation loss decreased (-0.762950 --> -0.770358).  Saving model ...
Epoch: 27 cost time: 0.7982897758483887
Epoch: 27, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.254 Vali Acc: 0.789 Test Loss: 1.254 Test Acc: 0.789
Validation loss decreased (-0.770358 --> -0.788876).  Saving model ...
Epoch: 28 cost time: 0.713813304901123
Epoch: 28, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.232 Vali Acc: 0.800 Test Loss: 1.232 Test Acc: 0.800
Validation loss decreased (-0.788876 --> -0.799988).  Saving model ...
Epoch: 29 cost time: 0.674668550491333
Epoch: 29, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.209 Vali Acc: 0.822 Test Loss: 1.209 Test Acc: 0.822
Validation loss decreased (-0.799988 --> -0.822210).  Saving model ...
Epoch: 30 cost time: 0.7816002368927002
Epoch: 30, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.186 Vali Acc: 0.822 Test Loss: 1.186 Test Acc: 0.822
Validation loss decreased (-0.822210 --> -0.822210).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8222222222222222
model parameter : 89670
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.133901596069336
Epoch: 1, Steps: 2 | Train Loss: 1.919 Vali Loss: 1.895 Vali Acc: 0.219 Test Loss: 1.895 Test Acc: 0.219
Validation loss decreased (inf --> -0.218500).  Saving model ...
Epoch: 2 cost time: 0.5547950267791748
Epoch: 2, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.873 Vali Acc: 0.230 Test Loss: 1.873 Test Acc: 0.230
Validation loss decreased (-0.218500 --> -0.229611).  Saving model ...
Epoch: 3 cost time: 0.5588035583496094
Epoch: 3, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.860 Vali Acc: 0.263 Test Loss: 1.860 Test Acc: 0.263
Validation loss decreased (-0.229611 --> -0.262944).  Saving model ...
Epoch: 4 cost time: 0.6162805557250977
Epoch: 4, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.852 Vali Acc: 0.270 Test Loss: 1.852 Test Acc: 0.270
Validation loss decreased (-0.262944 --> -0.270352).  Saving model ...
Epoch: 5 cost time: 0.628159761428833
Epoch: 5, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.842 Vali Acc: 0.270 Test Loss: 1.842 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270352).  Saving model ...
Epoch: 6 cost time: 0.5789210796356201
Epoch: 6, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.829 Vali Acc: 0.281 Test Loss: 1.829 Test Acc: 0.281
Validation loss decreased (-0.270352 --> -0.281463).  Saving model ...
Epoch: 7 cost time: 0.640892505645752
Epoch: 7, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.815 Vali Acc: 0.304 Test Loss: 1.815 Test Acc: 0.304
Validation loss decreased (-0.281463 --> -0.303686).  Saving model ...
Epoch: 8 cost time: 0.602576494216919
Epoch: 8, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.799 Vali Acc: 0.319 Test Loss: 1.799 Test Acc: 0.319
Validation loss decreased (-0.303686 --> -0.318501).  Saving model ...
Epoch: 9 cost time: 0.5766711235046387
Epoch: 9, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.783 Vali Acc: 0.326 Test Loss: 1.783 Test Acc: 0.326
Validation loss decreased (-0.318501 --> -0.325908).  Saving model ...
Epoch: 10 cost time: 0.6495611667633057
Epoch: 10, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.765 Vali Acc: 0.348 Test Loss: 1.765 Test Acc: 0.348
Validation loss decreased (-0.325908 --> -0.348131).  Saving model ...
Epoch: 11 cost time: 0.6150515079498291
Epoch: 11, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.746 Vali Acc: 0.374 Test Loss: 1.746 Test Acc: 0.374
Validation loss decreased (-0.348131 --> -0.374057).  Saving model ...
Epoch: 12 cost time: 0.6183369159698486
Epoch: 12, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.726 Vali Acc: 0.385 Test Loss: 1.726 Test Acc: 0.385
Validation loss decreased (-0.374057 --> -0.385168).  Saving model ...
Epoch: 13 cost time: 0.5822265148162842
Epoch: 13, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.707 Vali Acc: 0.389 Test Loss: 1.707 Test Acc: 0.389
Validation loss decreased (-0.385168 --> -0.388872).  Saving model ...
Epoch: 14 cost time: 0.6240200996398926
Epoch: 14, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.687 Vali Acc: 0.407 Test Loss: 1.687 Test Acc: 0.407
Validation loss decreased (-0.388872 --> -0.407391).  Saving model ...
Epoch: 15 cost time: 0.6370644569396973
Epoch: 15, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.666 Vali Acc: 0.430 Test Loss: 1.666 Test Acc: 0.430
Validation loss decreased (-0.407391 --> -0.429613).  Saving model ...
Epoch: 16 cost time: 0.7502462863922119
Epoch: 16, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.645 Vali Acc: 0.441 Test Loss: 1.645 Test Acc: 0.441
Validation loss decreased (-0.429613 --> -0.440724).  Saving model ...
Epoch: 17 cost time: 0.5873682498931885
Epoch: 17, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.623 Vali Acc: 0.459 Test Loss: 1.623 Test Acc: 0.459
Validation loss decreased (-0.440724 --> -0.459243).  Saving model ...
Epoch: 18 cost time: 0.6162295341491699
Epoch: 18, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.601 Vali Acc: 0.478 Test Loss: 1.601 Test Acc: 0.478
Validation loss decreased (-0.459243 --> -0.477762).  Saving model ...
Epoch: 19 cost time: 0.595350980758667
Epoch: 19, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.579 Vali Acc: 0.504 Test Loss: 1.579 Test Acc: 0.504
Validation loss decreased (-0.477762 --> -0.503688).  Saving model ...
Epoch: 20 cost time: 0.6055901050567627
Epoch: 20, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.556 Vali Acc: 0.530 Test Loss: 1.556 Test Acc: 0.530
Validation loss decreased (-0.503688 --> -0.529614).  Saving model ...
Epoch: 21 cost time: 0.6296839714050293
Epoch: 21, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.534 Vali Acc: 0.537 Test Loss: 1.534 Test Acc: 0.537
Validation loss decreased (-0.529614 --> -0.537022).  Saving model ...
Epoch: 22 cost time: 0.6349513530731201
Epoch: 22, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.510 Vali Acc: 0.548 Test Loss: 1.510 Test Acc: 0.548
Validation loss decreased (-0.537022 --> -0.548133).  Saving model ...
Epoch: 23 cost time: 0.663583517074585
Epoch: 23, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.487 Vali Acc: 0.556 Test Loss: 1.487 Test Acc: 0.556
Validation loss decreased (-0.548133 --> -0.555541).  Saving model ...
Epoch: 24 cost time: 0.6296553611755371
Epoch: 24, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.464 Vali Acc: 0.567 Test Loss: 1.464 Test Acc: 0.567
Validation loss decreased (-0.555541 --> -0.566652).  Saving model ...
Epoch: 25 cost time: 0.627758264541626
Epoch: 25, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.440 Vali Acc: 0.596 Test Loss: 1.440 Test Acc: 0.596
Validation loss decreased (-0.566652 --> -0.596282).  Saving model ...
Epoch: 26 cost time: 0.6025724411010742
Epoch: 26, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.417 Vali Acc: 0.611 Test Loss: 1.417 Test Acc: 0.611
Validation loss decreased (-0.596282 --> -0.611097).  Saving model ...
Epoch: 27 cost time: 0.6117990016937256
Epoch: 27, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.394 Vali Acc: 0.626 Test Loss: 1.394 Test Acc: 0.626
Validation loss decreased (-0.611097 --> -0.625912).  Saving model ...
Epoch: 28 cost time: 0.5946149826049805
Epoch: 28, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.371 Vali Acc: 0.630 Test Loss: 1.371 Test Acc: 0.630
Validation loss decreased (-0.625912 --> -0.629616).  Saving model ...
Epoch: 29 cost time: 0.6338181495666504
Epoch: 29, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.347 Vali Acc: 0.644 Test Loss: 1.347 Test Acc: 0.644
Validation loss decreased (-0.629616 --> -0.644431).  Saving model ...
Epoch: 30 cost time: 0.6573810577392578
Epoch: 30, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.324 Vali Acc: 0.663 Test Loss: 1.324 Test Acc: 0.663
Validation loss decreased (-0.644431 --> -0.662950).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.662962962962963
model parameter : 296710
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.326493740081787
Epoch: 1, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.712 Vali Acc: 0.204 Test Loss: 1.712 Test Acc: 0.204
Validation loss decreased (inf --> -0.203687).  Saving model ...
Epoch: 2 cost time: 0.6041707992553711
Epoch: 2, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.696 Vali Acc: 0.226 Test Loss: 1.696 Test Acc: 0.226
Validation loss decreased (-0.203687 --> -0.225909).  Saving model ...
Epoch: 3 cost time: 0.6159331798553467
Epoch: 3, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.685 Vali Acc: 0.244 Test Loss: 1.685 Test Acc: 0.244
Validation loss decreased (-0.225909 --> -0.244428).  Saving model ...
Epoch: 4 cost time: 0.6508638858795166
Epoch: 4, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.678 Vali Acc: 0.256 Test Loss: 1.678 Test Acc: 0.256
Validation loss decreased (-0.244428 --> -0.255539).  Saving model ...
Epoch: 5 cost time: 0.6355736255645752
Epoch: 5, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.669 Vali Acc: 0.270 Test Loss: 1.669 Test Acc: 0.270
Validation loss decreased (-0.255539 --> -0.270354).  Saving model ...
Epoch: 6 cost time: 0.6597936153411865
Epoch: 6, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.658 Vali Acc: 0.296 Test Loss: 1.658 Test Acc: 0.296
Validation loss decreased (-0.270354 --> -0.296280).  Saving model ...
Epoch: 7 cost time: 0.678142786026001
Epoch: 7, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.646 Vali Acc: 0.315 Test Loss: 1.646 Test Acc: 0.315
Validation loss decreased (-0.296280 --> -0.314798).  Saving model ...
Epoch: 8 cost time: 0.5823338031768799
Epoch: 8, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.633 Vali Acc: 0.348 Test Loss: 1.633 Test Acc: 0.348
Validation loss decreased (-0.314798 --> -0.348132).  Saving model ...
Epoch: 9 cost time: 0.6628732681274414
Epoch: 9, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.618 Vali Acc: 0.378 Test Loss: 1.618 Test Acc: 0.378
Validation loss decreased (-0.348132 --> -0.377762).  Saving model ...
Epoch: 10 cost time: 0.6601734161376953
Epoch: 10, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.602 Vali Acc: 0.407 Test Loss: 1.602 Test Acc: 0.407
Validation loss decreased (-0.377762 --> -0.407391).  Saving model ...
Epoch: 11 cost time: 0.6859850883483887
Epoch: 11, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.586 Vali Acc: 0.444 Test Loss: 1.586 Test Acc: 0.444
Validation loss decreased (-0.407391 --> -0.444429).  Saving model ...
Epoch: 12 cost time: 0.6191461086273193
Epoch: 12, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.568 Vali Acc: 0.470 Test Loss: 1.568 Test Acc: 0.470
Validation loss decreased (-0.444429 --> -0.470355).  Saving model ...
Epoch: 13 cost time: 0.597907304763794
Epoch: 13, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.550 Vali Acc: 0.489 Test Loss: 1.550 Test Acc: 0.489
Validation loss decreased (-0.470355 --> -0.488873).  Saving model ...
Epoch: 14 cost time: 0.652348518371582
Epoch: 14, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.532 Vali Acc: 0.522 Test Loss: 1.532 Test Acc: 0.522
Validation loss decreased (-0.488873 --> -0.522207).  Saving model ...
Epoch: 15 cost time: 0.639634370803833
Epoch: 15, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.513 Vali Acc: 0.556 Test Loss: 1.513 Test Acc: 0.556
Validation loss decreased (-0.522207 --> -0.555540).  Saving model ...
Epoch: 16 cost time: 0.615149736404419
Epoch: 16, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.493 Vali Acc: 0.585 Test Loss: 1.493 Test Acc: 0.585
Validation loss decreased (-0.555540 --> -0.585170).  Saving model ...
Epoch: 17 cost time: 0.6369447708129883
Epoch: 17, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.473 Vali Acc: 0.604 Test Loss: 1.473 Test Acc: 0.604
Validation loss decreased (-0.585170 --> -0.603689).  Saving model ...
Epoch: 18 cost time: 0.6151859760284424
Epoch: 18, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.452 Vali Acc: 0.630 Test Loss: 1.452 Test Acc: 0.630
Validation loss decreased (-0.603689 --> -0.629615).  Saving model ...
Epoch: 19 cost time: 0.6140835285186768
Epoch: 19, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.431 Vali Acc: 0.656 Test Loss: 1.431 Test Acc: 0.656
Validation loss decreased (-0.629615 --> -0.655541).  Saving model ...
Epoch: 20 cost time: 0.656867504119873
Epoch: 20, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.410 Vali Acc: 0.667 Test Loss: 1.410 Test Acc: 0.667
Validation loss decreased (-0.655541 --> -0.666653).  Saving model ...
Epoch: 21 cost time: 0.6044270992279053
Epoch: 21, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.389 Vali Acc: 0.678 Test Loss: 1.389 Test Acc: 0.678
Validation loss decreased (-0.666653 --> -0.677764).  Saving model ...
Epoch: 22 cost time: 0.5665545463562012
Epoch: 22, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.367 Vali Acc: 0.700 Test Loss: 1.367 Test Acc: 0.700
Validation loss decreased (-0.677764 --> -0.699986).  Saving model ...
Epoch: 23 cost time: 0.6872138977050781
Epoch: 23, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.345 Vali Acc: 0.730 Test Loss: 1.345 Test Acc: 0.730
Validation loss decreased (-0.699986 --> -0.729616).  Saving model ...
Epoch: 24 cost time: 0.625523567199707
Epoch: 24, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.322 Vali Acc: 0.737 Test Loss: 1.322 Test Acc: 0.737
Validation loss decreased (-0.729616 --> -0.737024).  Saving model ...
Epoch: 25 cost time: 0.6182992458343506
Epoch: 25, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.300 Vali Acc: 0.759 Test Loss: 1.300 Test Acc: 0.759
Validation loss decreased (-0.737024 --> -0.759246).  Saving model ...
Epoch: 26 cost time: 0.6064841747283936
Epoch: 26, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.277 Vali Acc: 0.770 Test Loss: 1.277 Test Acc: 0.770
Validation loss decreased (-0.759246 --> -0.770358).  Saving model ...
Epoch: 27 cost time: 0.6418321132659912
Epoch: 27, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.254 Vali Acc: 0.785 Test Loss: 1.254 Test Acc: 0.785
Validation loss decreased (-0.770358 --> -0.785173).  Saving model ...
Epoch: 28 cost time: 0.6060619354248047
Epoch: 28, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.232 Vali Acc: 0.796 Test Loss: 1.232 Test Acc: 0.796
Validation loss decreased (-0.785173 --> -0.796284).  Saving model ...
Epoch: 29 cost time: 0.6128771305084229
Epoch: 29, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.209 Vali Acc: 0.822 Test Loss: 1.209 Test Acc: 0.822
Validation loss decreased (-0.796284 --> -0.822210).  Saving model ...
Epoch: 30 cost time: 0.6296815872192383
Epoch: 30, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.186 Vali Acc: 0.822 Test Loss: 1.186 Test Acc: 0.822
Validation loss decreased (-0.822210 --> -0.822210).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8222222222222222
model parameter : 89670
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 6.273534536361694
Epoch: 1, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.839 Vali Acc: 0.219 Test Loss: 1.839 Test Acc: 0.219
Validation loss decreased (inf --> -0.218500).  Saving model ...
Epoch: 2 cost time: 4.727882146835327
Epoch: 2, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.766 Vali Acc: 0.241 Test Loss: 1.766 Test Acc: 0.241
Validation loss decreased (-0.218500 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 4.431914329528809
Epoch: 3, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.674 Vali Acc: 0.315 Test Loss: 1.674 Test Acc: 0.315
Validation loss decreased (-0.240723 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 4.349506378173828
Epoch: 4, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.529 Vali Acc: 0.485 Test Loss: 1.529 Test Acc: 0.485
Validation loss decreased (-0.314798 --> -0.485170).  Saving model ...
Epoch: 5 cost time: 4.292280912399292
Epoch: 5, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.358 Vali Acc: 0.678 Test Loss: 1.358 Test Acc: 0.678
Validation loss decreased (-0.485170 --> -0.677764).  Saving model ...
Epoch: 6 cost time: 3.995418071746826
Epoch: 6, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.176 Vali Acc: 0.726 Test Loss: 1.176 Test Acc: 0.726
Validation loss decreased (-0.677764 --> -0.725914).  Saving model ...
Epoch: 7 cost time: 4.203478097915649
Epoch: 7, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.004 Vali Acc: 0.778 Test Loss: 1.004 Test Acc: 0.778
Validation loss decreased (-0.725914 --> -0.777768).  Saving model ...
Epoch: 8 cost time: 3.9729950428009033
Epoch: 8, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.850 Vali Acc: 0.826 Test Loss: 0.850 Test Acc: 0.826
Validation loss decreased (-0.777768 --> -0.825917).  Saving model ...
Epoch: 9 cost time: 3.927257776260376
Epoch: 9, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.719 Vali Acc: 0.870 Test Loss: 0.719 Test Acc: 0.870
Validation loss decreased (-0.825917 --> -0.870363).  Saving model ...
Epoch: 10 cost time: 4.254410982131958
Epoch: 10, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.611 Vali Acc: 0.904 Test Loss: 0.611 Test Acc: 0.904
Validation loss decreased (-0.870363 --> -0.903698).  Saving model ...
Epoch: 11 cost time: 4.226596117019653
Epoch: 11, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.525 Vali Acc: 0.915 Test Loss: 0.525 Test Acc: 0.915
Validation loss decreased (-0.903698 --> -0.914810).  Saving model ...
Epoch: 12 cost time: 4.483784914016724
Epoch: 12, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.451 Vali Acc: 0.930 Test Loss: 0.451 Test Acc: 0.930
Validation loss decreased (-0.914810 --> -0.929625).  Saving model ...
Epoch: 13 cost time: 4.287370920181274
Epoch: 13, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.390 Vali Acc: 0.922 Test Loss: 0.390 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.516273498535156
Epoch: 14, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.342 Vali Acc: 0.919 Test Loss: 0.342 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.930455207824707
Epoch: 15, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.302540063858032
Epoch: 16, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.277 Vali Acc: 0.926 Test Loss: 0.277 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.110429525375366
Epoch: 17, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.257267236709595
Epoch: 18, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.51000452041626
Epoch: 19, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.2786619663238525
Epoch: 20, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.070488452911377
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.742131471633911
Epoch: 22, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 56289030
model size : 217.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.3037233352661133
Epoch: 1, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.714 Vali Acc: 0.211 Test Loss: 1.714 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 1.7461493015289307
Epoch: 2, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.643 Vali Acc: 0.326 Test Loss: 1.643 Test Acc: 0.326
Validation loss decreased (-0.211094 --> -0.325909).  Saving model ...
Epoch: 3 cost time: 1.6473181247711182
Epoch: 3, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.561 Vali Acc: 0.459 Test Loss: 1.561 Test Acc: 0.459
Validation loss decreased (-0.325909 --> -0.459244).  Saving model ...
Epoch: 4 cost time: 1.6656718254089355
Epoch: 4, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.430 Vali Acc: 0.630 Test Loss: 1.430 Test Acc: 0.630
Validation loss decreased (-0.459244 --> -0.629615).  Saving model ...
Epoch: 5 cost time: 1.7264516353607178
Epoch: 5, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.275 Vali Acc: 0.715 Test Loss: 1.275 Test Acc: 0.715
Validation loss decreased (-0.629615 --> -0.714802).  Saving model ...
Epoch: 6 cost time: 1.652693748474121
Epoch: 6, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.115 Vali Acc: 0.770 Test Loss: 1.115 Test Acc: 0.770
Validation loss decreased (-0.714802 --> -0.770359).  Saving model ...
Epoch: 7 cost time: 1.674612283706665
Epoch: 7, Steps: 2 | Train Loss: 0.937 Vali Loss: 0.960 Vali Acc: 0.807 Test Loss: 0.960 Test Acc: 0.807
Validation loss decreased (-0.770359 --> -0.807398).  Saving model ...
Epoch: 8 cost time: 1.78009033203125
Epoch: 8, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.820 Vali Acc: 0.852 Test Loss: 0.820 Test Acc: 0.852
Validation loss decreased (-0.807398 --> -0.851844).  Saving model ...
Epoch: 9 cost time: 1.7065954208374023
Epoch: 9, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.697 Vali Acc: 0.881 Test Loss: 0.697 Test Acc: 0.881
Validation loss decreased (-0.851844 --> -0.881475).  Saving model ...
Epoch: 10 cost time: 1.5078473091125488
Epoch: 10, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.592 Vali Acc: 0.900 Test Loss: 0.592 Test Acc: 0.900
Validation loss decreased (-0.881475 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 1.610785961151123
Epoch: 11, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.504 Vali Acc: 0.911 Test Loss: 0.504 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.911106).  Saving model ...
Epoch: 12 cost time: 1.6366004943847656
Epoch: 12, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.432 Vali Acc: 0.922 Test Loss: 0.432 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922218).  Saving model ...
Epoch: 13 cost time: 1.5253925323486328
Epoch: 13, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.373 Vali Acc: 0.926 Test Loss: 0.373 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 14 cost time: 1.6183204650878906
Epoch: 14, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.327 Vali Acc: 0.933 Test Loss: 0.327 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 15 cost time: 1.583038330078125
Epoch: 15, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6829349994659424
Epoch: 16, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.268 Vali Acc: 0.919 Test Loss: 0.268 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5553853511810303
Epoch: 17, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.249 Vali Acc: 0.919 Test Loss: 0.249 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.572021722793579
Epoch: 18, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6805360317230225
Epoch: 19, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5344345569610596
Epoch: 20, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6040914058685303
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7867586612701416
Epoch: 22, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 1.631714105606079
Epoch: 23, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 1.5609660148620605
Epoch: 24, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 1.7726249694824219
Epoch: 25, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 1.6484124660491943
Epoch: 26, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 1.6850652694702148
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 1.7083446979522705
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 1.6414647102355957
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 1.6188890933990479
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 16571910
model size : 65.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.685323238372803
Epoch: 1, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.839 Vali Acc: 0.219 Test Loss: 1.839 Test Acc: 0.219
Validation loss decreased (inf --> -0.218500).  Saving model ...
Epoch: 2 cost time: 3.4064013957977295
Epoch: 2, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.766 Vali Acc: 0.241 Test Loss: 1.766 Test Acc: 0.241
Validation loss decreased (-0.218500 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 3.296790599822998
Epoch: 3, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.674 Vali Acc: 0.315 Test Loss: 1.674 Test Acc: 0.315
Validation loss decreased (-0.240723 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 3.3758699893951416
Epoch: 4, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.529 Vali Acc: 0.485 Test Loss: 1.529 Test Acc: 0.485
Validation loss decreased (-0.314798 --> -0.485170).  Saving model ...
Epoch: 5 cost time: 3.4119112491607666
Epoch: 5, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.358 Vali Acc: 0.678 Test Loss: 1.358 Test Acc: 0.678
Validation loss decreased (-0.485170 --> -0.677764).  Saving model ...
Epoch: 6 cost time: 3.0189664363861084
Epoch: 6, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.176 Vali Acc: 0.726 Test Loss: 1.176 Test Acc: 0.726
Validation loss decreased (-0.677764 --> -0.725914).  Saving model ...
Epoch: 7 cost time: 3.2462093830108643
Epoch: 7, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.004 Vali Acc: 0.778 Test Loss: 1.004 Test Acc: 0.778
Validation loss decreased (-0.725914 --> -0.777768).  Saving model ...
Epoch: 8 cost time: 3.318953275680542
Epoch: 8, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.850 Vali Acc: 0.826 Test Loss: 0.850 Test Acc: 0.826
Validation loss decreased (-0.777768 --> -0.825917).  Saving model ...
Epoch: 9 cost time: 3.0770883560180664
Epoch: 9, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.719 Vali Acc: 0.870 Test Loss: 0.719 Test Acc: 0.870
Validation loss decreased (-0.825917 --> -0.870363).  Saving model ...
Epoch: 10 cost time: 3.205674171447754
Epoch: 10, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.611 Vali Acc: 0.904 Test Loss: 0.611 Test Acc: 0.904
Validation loss decreased (-0.870363 --> -0.903698).  Saving model ...
Epoch: 11 cost time: 3.094240665435791
Epoch: 11, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.525 Vali Acc: 0.915 Test Loss: 0.525 Test Acc: 0.915
Validation loss decreased (-0.903698 --> -0.914810).  Saving model ...
Epoch: 12 cost time: 3.217369794845581
Epoch: 12, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.451 Vali Acc: 0.930 Test Loss: 0.451 Test Acc: 0.930
Validation loss decreased (-0.914810 --> -0.929625).  Saving model ...
Epoch: 13 cost time: 2.969367027282715
Epoch: 13, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.390 Vali Acc: 0.922 Test Loss: 0.390 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.33500337600708
Epoch: 14, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.342 Vali Acc: 0.919 Test Loss: 0.342 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.273629903793335
Epoch: 15, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1483771800994873
Epoch: 16, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.277 Vali Acc: 0.926 Test Loss: 0.277 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.243135690689087
Epoch: 17, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.286325216293335
Epoch: 18, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.903421401977539
Epoch: 19, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.974123954772949
Epoch: 20, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.000619888305664
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.0581681728363037
Epoch: 22, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 56289030
model size : 217.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6863298416137695
Epoch: 1, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.714 Vali Acc: 0.211 Test Loss: 1.714 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 1.0726876258850098
Epoch: 2, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.643 Vali Acc: 0.326 Test Loss: 1.643 Test Acc: 0.326
Validation loss decreased (-0.211094 --> -0.325909).  Saving model ...
Epoch: 3 cost time: 1.2349610328674316
Epoch: 3, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.561 Vali Acc: 0.459 Test Loss: 1.561 Test Acc: 0.459
Validation loss decreased (-0.325909 --> -0.459244).  Saving model ...
Epoch: 4 cost time: 1.260909080505371
Epoch: 4, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.430 Vali Acc: 0.630 Test Loss: 1.430 Test Acc: 0.630
Validation loss decreased (-0.459244 --> -0.629615).  Saving model ...
Epoch: 5 cost time: 1.203770399093628
Epoch: 5, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.275 Vali Acc: 0.715 Test Loss: 1.275 Test Acc: 0.715
Validation loss decreased (-0.629615 --> -0.714802).  Saving model ...
Epoch: 6 cost time: 1.3587441444396973
Epoch: 6, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.115 Vali Acc: 0.770 Test Loss: 1.115 Test Acc: 0.770
Validation loss decreased (-0.714802 --> -0.770359).  Saving model ...
Epoch: 7 cost time: 1.22829008102417
Epoch: 7, Steps: 2 | Train Loss: 0.937 Vali Loss: 0.960 Vali Acc: 0.807 Test Loss: 0.960 Test Acc: 0.807
Validation loss decreased (-0.770359 --> -0.807398).  Saving model ...
Epoch: 8 cost time: 1.2513597011566162
Epoch: 8, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.820 Vali Acc: 0.852 Test Loss: 0.820 Test Acc: 0.852
Validation loss decreased (-0.807398 --> -0.851844).  Saving model ...
Epoch: 9 cost time: 1.3231449127197266
Epoch: 9, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.697 Vali Acc: 0.881 Test Loss: 0.697 Test Acc: 0.881
Validation loss decreased (-0.851844 --> -0.881475).  Saving model ...
Epoch: 10 cost time: 1.3602032661437988
Epoch: 10, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.592 Vali Acc: 0.900 Test Loss: 0.592 Test Acc: 0.900
Validation loss decreased (-0.881475 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 1.302015781402588
Epoch: 11, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.504 Vali Acc: 0.911 Test Loss: 0.504 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.911106).  Saving model ...
Epoch: 12 cost time: 1.2884719371795654
Epoch: 12, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.432 Vali Acc: 0.922 Test Loss: 0.432 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922218).  Saving model ...
Epoch: 13 cost time: 1.1848149299621582
Epoch: 13, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.373 Vali Acc: 0.926 Test Loss: 0.373 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 14 cost time: 1.5723471641540527
Epoch: 14, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.327 Vali Acc: 0.933 Test Loss: 0.327 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 15 cost time: 1.4509353637695312
Epoch: 15, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4321985244750977
Epoch: 16, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.268 Vali Acc: 0.919 Test Loss: 0.268 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.434328556060791
Epoch: 17, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.249 Vali Acc: 0.919 Test Loss: 0.249 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3674421310424805
Epoch: 18, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.321627140045166
Epoch: 19, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2784276008605957
Epoch: 20, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.413571834564209
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3143291473388672
Epoch: 22, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 1.4310534000396729
Epoch: 23, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 1.5003364086151123
Epoch: 24, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 1.4081876277923584
Epoch: 25, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 1.36436128616333
Epoch: 26, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 1.450005292892456
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 1.4631242752075195
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 1.3023722171783447
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 1.3567185401916504
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 16571910
model size : 65.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9349958896636963
Epoch: 1, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.839 Vali Acc: 0.219 Test Loss: 1.839 Test Acc: 0.219
Validation loss decreased (inf --> -0.218500).  Saving model ...
Epoch: 2 cost time: 1.3699951171875
Epoch: 2, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.766 Vali Acc: 0.241 Test Loss: 1.766 Test Acc: 0.241
Validation loss decreased (-0.218500 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 1.4589617252349854
Epoch: 3, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.675 Vali Acc: 0.315 Test Loss: 1.675 Test Acc: 0.315
Validation loss decreased (-0.240723 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 1.3977954387664795
Epoch: 4, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.532 Vali Acc: 0.478 Test Loss: 1.532 Test Acc: 0.478
Validation loss decreased (-0.314798 --> -0.477762).  Saving model ...
Epoch: 5 cost time: 1.388108730316162
Epoch: 5, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.364 Vali Acc: 0.674 Test Loss: 1.364 Test Acc: 0.674
Validation loss decreased (-0.477762 --> -0.674060).  Saving model ...
Epoch: 6 cost time: 1.3623995780944824
Epoch: 6, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.183 Vali Acc: 0.726 Test Loss: 1.183 Test Acc: 0.726
Validation loss decreased (-0.674060 --> -0.725914).  Saving model ...
Epoch: 7 cost time: 1.4397544860839844
Epoch: 7, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.012 Vali Acc: 0.781 Test Loss: 1.012 Test Acc: 0.781
Validation loss decreased (-0.725914 --> -0.781471).  Saving model ...
Epoch: 8 cost time: 1.4236247539520264
Epoch: 8, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.857 Vali Acc: 0.822 Test Loss: 0.857 Test Acc: 0.822
Validation loss decreased (-0.781471 --> -0.822214).  Saving model ...
Epoch: 9 cost time: 1.3261146545410156
Epoch: 9, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.725 Vali Acc: 0.870 Test Loss: 0.725 Test Acc: 0.870
Validation loss decreased (-0.822214 --> -0.870363).  Saving model ...
Epoch: 10 cost time: 1.387582778930664
Epoch: 10, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.616 Vali Acc: 0.904 Test Loss: 0.616 Test Acc: 0.904
Validation loss decreased (-0.870363 --> -0.903698).  Saving model ...
Epoch: 11 cost time: 1.367555856704712
Epoch: 11, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.529 Vali Acc: 0.915 Test Loss: 0.529 Test Acc: 0.915
Validation loss decreased (-0.903698 --> -0.914810).  Saving model ...
Epoch: 12 cost time: 1.4023048877716064
Epoch: 12, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.455 Vali Acc: 0.930 Test Loss: 0.455 Test Acc: 0.930
Validation loss decreased (-0.914810 --> -0.929625).  Saving model ...
Epoch: 13 cost time: 1.3009557723999023
Epoch: 13, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.393 Vali Acc: 0.926 Test Loss: 0.393 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4110078811645508
Epoch: 14, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3914377689361572
Epoch: 15, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.307 Vali Acc: 0.922 Test Loss: 0.307 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3078148365020752
Epoch: 16, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929627).  Saving model ...
Epoch: 17 cost time: 1.5023648738861084
Epoch: 17, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4049971103668213
Epoch: 18, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.249 Vali Acc: 0.919 Test Loss: 0.249 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4706473350524902
Epoch: 19, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.237 Vali Acc: 0.919 Test Loss: 0.237 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3917114734649658
Epoch: 20, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.400956153869629
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4528656005859375
Epoch: 22, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.388946533203125
Epoch: 23, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5191559791564941
Epoch: 24, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4254798889160156
Epoch: 25, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.922 Test Loss: 0.195 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5197679996490479
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 56289030
model size : 217.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.31492280960083
Epoch: 1, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.713 Vali Acc: 0.215 Test Loss: 1.713 Test Acc: 0.215
Validation loss decreased (inf --> -0.214798).  Saving model ...
Epoch: 2 cost time: 0.8613071441650391
Epoch: 2, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.642 Vali Acc: 0.326 Test Loss: 1.642 Test Acc: 0.326
Validation loss decreased (-0.214798 --> -0.325910).  Saving model ...
Epoch: 3 cost time: 0.8305511474609375
Epoch: 3, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.561 Vali Acc: 0.459 Test Loss: 1.561 Test Acc: 0.459
Validation loss decreased (-0.325910 --> -0.459244).  Saving model ...
Epoch: 4 cost time: 0.8517353534698486
Epoch: 4, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.432 Vali Acc: 0.630 Test Loss: 1.432 Test Acc: 0.630
Validation loss decreased (-0.459244 --> -0.629615).  Saving model ...
Epoch: 5 cost time: 0.8330614566802979
Epoch: 5, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.279 Vali Acc: 0.711 Test Loss: 1.279 Test Acc: 0.711
Validation loss decreased (-0.629615 --> -0.711098).  Saving model ...
Epoch: 6 cost time: 0.7980175018310547
Epoch: 6, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.120 Vali Acc: 0.770 Test Loss: 1.120 Test Acc: 0.770
Validation loss decreased (-0.711098 --> -0.770359).  Saving model ...
Epoch: 7 cost time: 0.8819506168365479
Epoch: 7, Steps: 2 | Train Loss: 0.945 Vali Loss: 0.966 Vali Acc: 0.807 Test Loss: 0.966 Test Acc: 0.807
Validation loss decreased (-0.770359 --> -0.807398).  Saving model ...
Epoch: 8 cost time: 0.9405848979949951
Epoch: 8, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.826 Vali Acc: 0.856 Test Loss: 0.826 Test Acc: 0.856
Validation loss decreased (-0.807398 --> -0.855547).  Saving model ...
Epoch: 9 cost time: 1.042346715927124
Epoch: 9, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.702 Vali Acc: 0.885 Test Loss: 0.702 Test Acc: 0.885
Validation loss decreased (-0.855547 --> -0.885178).  Saving model ...
Epoch: 10 cost time: 0.9926912784576416
Epoch: 10, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.596 Vali Acc: 0.900 Test Loss: 0.596 Test Acc: 0.900
Validation loss decreased (-0.885178 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 0.964303731918335
Epoch: 11, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.507 Vali Acc: 0.911 Test Loss: 0.507 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.911106).  Saving model ...
Epoch: 12 cost time: 0.9229321479797363
Epoch: 12, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.434 Vali Acc: 0.926 Test Loss: 0.434 Test Acc: 0.926
Validation loss decreased (-0.911106 --> -0.925922).  Saving model ...
Epoch: 13 cost time: 0.9357783794403076
Epoch: 13, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.375 Vali Acc: 0.930 Test Loss: 0.375 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 14 cost time: 0.9677000045776367
Epoch: 14, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.329 Vali Acc: 0.933 Test Loss: 0.329 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 15 cost time: 0.9708607196807861
Epoch: 15, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.295 Vali Acc: 0.926 Test Loss: 0.295 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9419851303100586
Epoch: 16, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.271 Vali Acc: 0.915 Test Loss: 0.271 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9669909477233887
Epoch: 17, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.251 Vali Acc: 0.915 Test Loss: 0.251 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9081943035125732
Epoch: 18, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9616634845733643
Epoch: 19, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.222 Vali Acc: 0.919 Test Loss: 0.222 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9374101161956787
Epoch: 20, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9423680305480957
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9915812015533447
Epoch: 22, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9985077381134033
Epoch: 23, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.9914753437042236
Epoch: 24, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.9723150730133057
Epoch: 25, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 26 cost time: 0.8992083072662354
Epoch: 26, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 27 cost time: 1.0273590087890625
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 28 cost time: 1.0054659843444824
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 29 cost time: 0.8996143341064453
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
Validation loss decreased (-0.933332 --> -0.937035).  Saving model ...
Epoch: 30 cost time: 0.9643335342407227
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 16571910
model size : 65.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.280705690383911
Epoch: 1, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.716 Vali Acc: 0.178 Test Loss: 1.716 Test Acc: 0.178
Validation loss decreased (inf --> -0.177761).  Saving model ...
Epoch: 2 cost time: 2.091623067855835
Epoch: 2, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.647 Vali Acc: 0.267 Test Loss: 1.647 Test Acc: 0.267
Validation loss decreased (-0.177761 --> -0.266650).  Saving model ...
Epoch: 3 cost time: 1.9652247428894043
Epoch: 3, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.567 Vali Acc: 0.363 Test Loss: 1.567 Test Acc: 0.363
Validation loss decreased (-0.266650 --> -0.362947).  Saving model ...
Epoch: 4 cost time: 2.06036114692688
Epoch: 4, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.446 Vali Acc: 0.567 Test Loss: 1.446 Test Acc: 0.567
Validation loss decreased (-0.362947 --> -0.566652).  Saving model ...
Epoch: 5 cost time: 1.9097707271575928
Epoch: 5, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.298 Vali Acc: 0.726 Test Loss: 1.298 Test Acc: 0.726
Validation loss decreased (-0.566652 --> -0.725913).  Saving model ...
Epoch: 6 cost time: 2.0133652687072754
Epoch: 6, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.140 Vali Acc: 0.819 Test Loss: 1.140 Test Acc: 0.819
Validation loss decreased (-0.725913 --> -0.818507).  Saving model ...
Epoch: 7 cost time: 1.9902355670928955
Epoch: 7, Steps: 2 | Train Loss: 0.974 Vali Loss: 0.985 Vali Acc: 0.881 Test Loss: 0.985 Test Acc: 0.881
Validation loss decreased (-0.818507 --> -0.881472).  Saving model ...
Epoch: 8 cost time: 2.0587730407714844
Epoch: 8, Steps: 2 | Train Loss: 0.839 Vali Loss: 0.844 Vali Acc: 0.907 Test Loss: 0.844 Test Acc: 0.907
Validation loss decreased (-0.881472 --> -0.907399).  Saving model ...
Epoch: 9 cost time: 1.9778578281402588
Epoch: 9, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.720 Vali Acc: 0.919 Test Loss: 0.720 Test Acc: 0.919
Validation loss decreased (-0.907399 --> -0.918511).  Saving model ...
Epoch: 10 cost time: 1.8563544750213623
Epoch: 10, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.614 Vali Acc: 0.922 Test Loss: 0.614 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922216).  Saving model ...
Epoch: 11 cost time: 1.9282541275024414
Epoch: 11, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.526 Vali Acc: 0.930 Test Loss: 0.526 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 12 cost time: 1.9315662384033203
Epoch: 12, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.453 Vali Acc: 0.944 Test Loss: 0.453 Test Acc: 0.944
Validation loss decreased (-0.929624 --> -0.944440).  Saving model ...
Epoch: 13 cost time: 1.7067763805389404
Epoch: 13, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.394 Vali Acc: 0.941 Test Loss: 0.394 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8135933876037598
Epoch: 14, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.345 Vali Acc: 0.937 Test Loss: 0.345 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8808870315551758
Epoch: 15, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9143061637878418
Epoch: 16, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5683553218841553
Epoch: 17, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.839148759841919
Epoch: 18, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8666491508483887
Epoch: 19, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9570798873901367
Epoch: 20, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.855652093887329
Epoch: 21, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.0535500049591064
Epoch: 22, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 28171782
model size : 109.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6357853412628174
Epoch: 1, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.900 Vali Acc: 0.233 Test Loss: 1.900 Test Acc: 0.233
Validation loss decreased (inf --> -0.233314).  Saving model ...
Epoch: 2 cost time: 1.018975019454956
Epoch: 2, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.815 Vali Acc: 0.326 Test Loss: 1.815 Test Acc: 0.326
Validation loss decreased (-0.233314 --> -0.325908).  Saving model ...
Epoch: 3 cost time: 1.0122902393341064
Epoch: 3, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.721 Vali Acc: 0.352 Test Loss: 1.721 Test Acc: 0.352
Validation loss decreased (-0.325908 --> -0.351835).  Saving model ...
Epoch: 4 cost time: 1.0030882358551025
Epoch: 4, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.586 Vali Acc: 0.404 Test Loss: 1.586 Test Acc: 0.404
Validation loss decreased (-0.351835 --> -0.403688).  Saving model ...
Epoch: 5 cost time: 1.0713610649108887
Epoch: 5, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.429 Vali Acc: 0.537 Test Loss: 1.429 Test Acc: 0.537
Validation loss decreased (-0.403688 --> -0.537023).  Saving model ...
Epoch: 6 cost time: 1.0899708271026611
Epoch: 6, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.262 Vali Acc: 0.663 Test Loss: 1.262 Test Acc: 0.663
Validation loss decreased (-0.537023 --> -0.662950).  Saving model ...
Epoch: 7 cost time: 1.145641803741455
Epoch: 7, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.094 Vali Acc: 0.796 Test Loss: 1.094 Test Acc: 0.796
Validation loss decreased (-0.662950 --> -0.796285).  Saving model ...
Epoch: 8 cost time: 1.1417016983032227
Epoch: 8, Steps: 2 | Train Loss: 0.916 Vali Loss: 0.936 Vali Acc: 0.856 Test Loss: 0.936 Test Acc: 0.856
Validation loss decreased (-0.796285 --> -0.855546).  Saving model ...
Epoch: 9 cost time: 1.072249174118042
Epoch: 9, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.792 Vali Acc: 0.870 Test Loss: 0.792 Test Acc: 0.870
Validation loss decreased (-0.855546 --> -0.870362).  Saving model ...
Epoch: 10 cost time: 1.0781071186065674
Epoch: 10, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.668 Vali Acc: 0.904 Test Loss: 0.668 Test Acc: 0.904
Validation loss decreased (-0.870362 --> -0.903697).  Saving model ...
Epoch: 11 cost time: 1.0963690280914307
Epoch: 11, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.565 Vali Acc: 0.919 Test Loss: 0.565 Test Acc: 0.919
Validation loss decreased (-0.903697 --> -0.918513).  Saving model ...
Epoch: 12 cost time: 1.1011953353881836
Epoch: 12, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.482 Vali Acc: 0.915 Test Loss: 0.482 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0740115642547607
Epoch: 13, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.412 Vali Acc: 0.919 Test Loss: 0.412 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 14 cost time: 1.0964219570159912
Epoch: 14, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.358 Vali Acc: 0.926 Test Loss: 0.358 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 15 cost time: 1.0660133361816406
Epoch: 15, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0711004734039307
Epoch: 16, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 17 cost time: 0.993201494216919
Epoch: 17, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.261 Vali Acc: 0.926 Test Loss: 0.261 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 18 cost time: 1.0027997493743896
Epoch: 18, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 19 cost time: 0.9775137901306152
Epoch: 19, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 20 cost time: 0.9936368465423584
Epoch: 20, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9816055297851562
Epoch: 21, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0044164657592773
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 1.0237631797790527
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 1.1262528896331787
Epoch: 24, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 1.0677180290222168
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 1.0596213340759277
Epoch: 26, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1188960075378418
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.107100009918213
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0198132991790771
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.999781608581543
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 8312838
model size : 34.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0794594287872314
Epoch: 1, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.716 Vali Acc: 0.178 Test Loss: 1.716 Test Acc: 0.178
Validation loss decreased (inf --> -0.177761).  Saving model ...
Epoch: 2 cost time: 1.5224533081054688
Epoch: 2, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.647 Vali Acc: 0.267 Test Loss: 1.647 Test Acc: 0.267
Validation loss decreased (-0.177761 --> -0.266650).  Saving model ...
Epoch: 3 cost time: 1.4208083152770996
Epoch: 3, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.567 Vali Acc: 0.363 Test Loss: 1.567 Test Acc: 0.363
Validation loss decreased (-0.266650 --> -0.362947).  Saving model ...
Epoch: 4 cost time: 1.5005278587341309
Epoch: 4, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.446 Vali Acc: 0.567 Test Loss: 1.446 Test Acc: 0.567
Validation loss decreased (-0.362947 --> -0.566652).  Saving model ...
Epoch: 5 cost time: 1.508073091506958
Epoch: 5, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.298 Vali Acc: 0.726 Test Loss: 1.298 Test Acc: 0.726
Validation loss decreased (-0.566652 --> -0.725913).  Saving model ...
Epoch: 6 cost time: 1.489516019821167
Epoch: 6, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.140 Vali Acc: 0.819 Test Loss: 1.140 Test Acc: 0.819
Validation loss decreased (-0.725913 --> -0.818507).  Saving model ...
Epoch: 7 cost time: 1.4552180767059326
Epoch: 7, Steps: 2 | Train Loss: 0.974 Vali Loss: 0.985 Vali Acc: 0.881 Test Loss: 0.985 Test Acc: 0.881
Validation loss decreased (-0.818507 --> -0.881472).  Saving model ...
Epoch: 8 cost time: 1.4882712364196777
Epoch: 8, Steps: 2 | Train Loss: 0.839 Vali Loss: 0.844 Vali Acc: 0.907 Test Loss: 0.844 Test Acc: 0.907
Validation loss decreased (-0.881472 --> -0.907399).  Saving model ...
Epoch: 9 cost time: 1.3941614627838135
Epoch: 9, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.720 Vali Acc: 0.919 Test Loss: 0.720 Test Acc: 0.919
Validation loss decreased (-0.907399 --> -0.918511).  Saving model ...
Epoch: 10 cost time: 1.4401609897613525
Epoch: 10, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.614 Vali Acc: 0.922 Test Loss: 0.614 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922216).  Saving model ...
Epoch: 11 cost time: 1.4312803745269775
Epoch: 11, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.526 Vali Acc: 0.930 Test Loss: 0.526 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 12 cost time: 1.551772117614746
Epoch: 12, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.453 Vali Acc: 0.944 Test Loss: 0.453 Test Acc: 0.944
Validation loss decreased (-0.929624 --> -0.944440).  Saving model ...
Epoch: 13 cost time: 1.3542988300323486
Epoch: 13, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.394 Vali Acc: 0.941 Test Loss: 0.394 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4410781860351562
Epoch: 14, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.345 Vali Acc: 0.937 Test Loss: 0.345 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.419006109237671
Epoch: 15, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4409596920013428
Epoch: 16, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4965481758117676
Epoch: 17, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5037226676940918
Epoch: 18, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4874968528747559
Epoch: 19, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.436824083328247
Epoch: 20, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4376473426818848
Epoch: 21, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4108500480651855
Epoch: 22, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 28171782
model size : 109.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.401646137237549
Epoch: 1, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.900 Vali Acc: 0.233 Test Loss: 1.900 Test Acc: 0.233
Validation loss decreased (inf --> -0.233314).  Saving model ...
Epoch: 2 cost time: 0.9274404048919678
Epoch: 2, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.815 Vali Acc: 0.326 Test Loss: 1.815 Test Acc: 0.326
Validation loss decreased (-0.233314 --> -0.325908).  Saving model ...
Epoch: 3 cost time: 0.8469486236572266
Epoch: 3, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.721 Vali Acc: 0.352 Test Loss: 1.721 Test Acc: 0.352
Validation loss decreased (-0.325908 --> -0.351835).  Saving model ...
Epoch: 4 cost time: 0.8208954334259033
Epoch: 4, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.586 Vali Acc: 0.404 Test Loss: 1.586 Test Acc: 0.404
Validation loss decreased (-0.351835 --> -0.403688).  Saving model ...
Epoch: 5 cost time: 0.8412935733795166
Epoch: 5, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.429 Vali Acc: 0.537 Test Loss: 1.429 Test Acc: 0.537
Validation loss decreased (-0.403688 --> -0.537023).  Saving model ...
Epoch: 6 cost time: 0.8830118179321289
Epoch: 6, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.262 Vali Acc: 0.663 Test Loss: 1.262 Test Acc: 0.663
Validation loss decreased (-0.537023 --> -0.662950).  Saving model ...
Epoch: 7 cost time: 0.8707349300384521
Epoch: 7, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.094 Vali Acc: 0.796 Test Loss: 1.094 Test Acc: 0.796
Validation loss decreased (-0.662950 --> -0.796285).  Saving model ...
Epoch: 8 cost time: 0.8070893287658691
Epoch: 8, Steps: 2 | Train Loss: 0.916 Vali Loss: 0.936 Vali Acc: 0.856 Test Loss: 0.936 Test Acc: 0.856
Validation loss decreased (-0.796285 --> -0.855546).  Saving model ...
Epoch: 9 cost time: 1.0492422580718994
Epoch: 9, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.792 Vali Acc: 0.870 Test Loss: 0.792 Test Acc: 0.870
Validation loss decreased (-0.855546 --> -0.870362).  Saving model ...
Epoch: 10 cost time: 0.8511319160461426
Epoch: 10, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.668 Vali Acc: 0.904 Test Loss: 0.668 Test Acc: 0.904
Validation loss decreased (-0.870362 --> -0.903697).  Saving model ...
Epoch: 11 cost time: 0.842867374420166
Epoch: 11, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.565 Vali Acc: 0.919 Test Loss: 0.565 Test Acc: 0.919
Validation loss decreased (-0.903697 --> -0.918513).  Saving model ...
Epoch: 12 cost time: 0.8611602783203125
Epoch: 12, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.482 Vali Acc: 0.915 Test Loss: 0.482 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7818603515625
Epoch: 13, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.412 Vali Acc: 0.919 Test Loss: 0.412 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 14 cost time: 0.8951020240783691
Epoch: 14, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.358 Vali Acc: 0.926 Test Loss: 0.358 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 15 cost time: 0.8795425891876221
Epoch: 15, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8542969226837158
Epoch: 16, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 17 cost time: 0.8799481391906738
Epoch: 17, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.261 Vali Acc: 0.926 Test Loss: 0.261 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 18 cost time: 0.8568925857543945
Epoch: 18, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 19 cost time: 0.8924951553344727
Epoch: 19, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 20 cost time: 0.8299696445465088
Epoch: 20, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8173201084136963
Epoch: 21, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8847670555114746
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.856123685836792
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.777543306350708
Epoch: 24, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.8089118003845215
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.8199288845062256
Epoch: 26, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7861189842224121
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8366076946258545
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8266987800598145
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.856980562210083
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 8312838
model size : 34.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.599937677383423
Epoch: 1, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.717 Vali Acc: 0.178 Test Loss: 1.717 Test Acc: 0.178
Validation loss decreased (inf --> -0.177761).  Saving model ...
Epoch: 2 cost time: 0.9476990699768066
Epoch: 2, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.648 Vali Acc: 0.267 Test Loss: 1.648 Test Acc: 0.267
Validation loss decreased (-0.177761 --> -0.266650).  Saving model ...
Epoch: 3 cost time: 0.9999558925628662
Epoch: 3, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.569 Vali Acc: 0.363 Test Loss: 1.569 Test Acc: 0.363
Validation loss decreased (-0.266650 --> -0.362947).  Saving model ...
Epoch: 4 cost time: 0.9391062259674072
Epoch: 4, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.449 Vali Acc: 0.556 Test Loss: 1.449 Test Acc: 0.556
Validation loss decreased (-0.362947 --> -0.555541).  Saving model ...
Epoch: 5 cost time: 0.9397745132446289
Epoch: 5, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.303 Vali Acc: 0.715 Test Loss: 1.303 Test Acc: 0.715
Validation loss decreased (-0.555541 --> -0.714802).  Saving model ...
Epoch: 6 cost time: 1.0056025981903076
Epoch: 6, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.146 Vali Acc: 0.815 Test Loss: 1.146 Test Acc: 0.815
Validation loss decreased (-0.714802 --> -0.814803).  Saving model ...
Epoch: 7 cost time: 0.9522531032562256
Epoch: 7, Steps: 2 | Train Loss: 0.987 Vali Loss: 0.992 Vali Acc: 0.881 Test Loss: 0.992 Test Acc: 0.881
Validation loss decreased (-0.814803 --> -0.881472).  Saving model ...
Epoch: 8 cost time: 1.0214626789093018
Epoch: 8, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.851 Vali Acc: 0.907 Test Loss: 0.851 Test Acc: 0.907
Validation loss decreased (-0.881472 --> -0.907399).  Saving model ...
Epoch: 9 cost time: 1.0193829536437988
Epoch: 9, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.727 Vali Acc: 0.919 Test Loss: 0.727 Test Acc: 0.919
Validation loss decreased (-0.907399 --> -0.918511).  Saving model ...
Epoch: 10 cost time: 0.9964895248413086
Epoch: 10, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.620 Vali Acc: 0.922 Test Loss: 0.620 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922216).  Saving model ...
Epoch: 11 cost time: 0.9940698146820068
Epoch: 11, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.531 Vali Acc: 0.926 Test Loss: 0.531 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925921).  Saving model ...
Epoch: 12 cost time: 0.9802820682525635
Epoch: 12, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.458 Vali Acc: 0.937 Test Loss: 0.458 Test Acc: 0.937
Validation loss decreased (-0.925921 --> -0.937032).  Saving model ...
Epoch: 13 cost time: 1.01871919631958
Epoch: 13, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.398 Vali Acc: 0.937 Test Loss: 0.398 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 14 cost time: 0.9471108913421631
Epoch: 14, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.349 Vali Acc: 0.933 Test Loss: 0.349 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9693055152893066
Epoch: 15, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.312 Vali Acc: 0.930 Test Loss: 0.312 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0504252910614014
Epoch: 16, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9532997608184814
Epoch: 17, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9364392757415771
Epoch: 18, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8769383430480957
Epoch: 19, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0533466339111328
Epoch: 20, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.067774772644043
Epoch: 21, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.009294033050537
Epoch: 22, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9702572822570801
Epoch: 23, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 28171782
model size : 109.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2932260036468506
Epoch: 1, Steps: 2 | Train Loss: 1.980 Vali Loss: 1.901 Vali Acc: 0.233 Test Loss: 1.901 Test Acc: 0.233
Validation loss decreased (inf --> -0.233314).  Saving model ...
Epoch: 2 cost time: 0.7130353450775146
Epoch: 2, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.816 Vali Acc: 0.326 Test Loss: 1.816 Test Acc: 0.326
Validation loss decreased (-0.233314 --> -0.325908).  Saving model ...
Epoch: 3 cost time: 0.7032244205474854
Epoch: 3, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.723 Vali Acc: 0.352 Test Loss: 1.723 Test Acc: 0.352
Validation loss decreased (-0.325908 --> -0.351835).  Saving model ...
Epoch: 4 cost time: 0.6993799209594727
Epoch: 4, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.590 Vali Acc: 0.393 Test Loss: 1.590 Test Acc: 0.393
Validation loss decreased (-0.351835 --> -0.392577).  Saving model ...
Epoch: 5 cost time: 0.7022442817687988
Epoch: 5, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.434 Vali Acc: 0.533 Test Loss: 1.434 Test Acc: 0.533
Validation loss decreased (-0.392577 --> -0.533319).  Saving model ...
Epoch: 6 cost time: 0.7796220779418945
Epoch: 6, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.268 Vali Acc: 0.652 Test Loss: 1.268 Test Acc: 0.652
Validation loss decreased (-0.533319 --> -0.651839).  Saving model ...
Epoch: 7 cost time: 0.7311482429504395
Epoch: 7, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.102 Vali Acc: 0.785 Test Loss: 1.102 Test Acc: 0.785
Validation loss decreased (-0.651839 --> -0.785174).  Saving model ...
Epoch: 8 cost time: 0.6875262260437012
Epoch: 8, Steps: 2 | Train Loss: 0.936 Vali Loss: 0.945 Vali Acc: 0.852 Test Loss: 0.945 Test Acc: 0.852
Validation loss decreased (-0.785174 --> -0.851842).  Saving model ...
Epoch: 9 cost time: 0.6755504608154297
Epoch: 9, Steps: 2 | Train Loss: 0.748 Vali Loss: 0.801 Vali Acc: 0.863 Test Loss: 0.801 Test Acc: 0.863
Validation loss decreased (-0.851842 --> -0.862955).  Saving model ...
Epoch: 10 cost time: 0.7093260288238525
Epoch: 10, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.676 Vali Acc: 0.904 Test Loss: 0.676 Test Acc: 0.904
Validation loss decreased (-0.862955 --> -0.903697).  Saving model ...
Epoch: 11 cost time: 0.7999765872955322
Epoch: 11, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.572 Vali Acc: 0.919 Test Loss: 0.572 Test Acc: 0.919
Validation loss decreased (-0.903697 --> -0.918513).  Saving model ...
Epoch: 12 cost time: 0.7409584522247314
Epoch: 12, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.487 Vali Acc: 0.915 Test Loss: 0.487 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.738070011138916
Epoch: 13, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.416 Vali Acc: 0.922 Test Loss: 0.416 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922218).  Saving model ...
Epoch: 14 cost time: 0.710674524307251
Epoch: 14, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.361 Vali Acc: 0.926 Test Loss: 0.361 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 15 cost time: 0.7478783130645752
Epoch: 15, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.320 Vali Acc: 0.926 Test Loss: 0.320 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 16 cost time: 0.7279198169708252
Epoch: 16, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 17 cost time: 0.8528366088867188
Epoch: 17, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.263 Vali Acc: 0.926 Test Loss: 0.263 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 18 cost time: 0.7797088623046875
Epoch: 18, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 19 cost time: 0.890383243560791
Epoch: 19, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 20 cost time: 0.7682585716247559
Epoch: 20, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7795541286468506
Epoch: 21, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7726280689239502
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.8247332572937012
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.8121519088745117
Epoch: 24, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.811927080154419
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.7310123443603516
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8045587539672852
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7537639141082764
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.730696439743042
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.774846076965332
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 8312838
model size : 34.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.795944929122925
Epoch: 1, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.683 Vali Acc: 0.348 Test Loss: 1.683 Test Acc: 0.348
Validation loss decreased (inf --> -0.348131).  Saving model ...
Epoch: 2 cost time: 2.0617153644561768
Epoch: 2, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.631 Vali Acc: 0.393 Test Loss: 1.631 Test Acc: 0.393
Validation loss decreased (-0.348131 --> -0.392576).  Saving model ...
Epoch: 3 cost time: 2.28851580619812
Epoch: 3, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.576 Vali Acc: 0.426 Test Loss: 1.576 Test Acc: 0.426
Validation loss decreased (-0.392576 --> -0.425910).  Saving model ...
Epoch: 4 cost time: 2.3892619609832764
Epoch: 4, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.498 Vali Acc: 0.526 Test Loss: 1.498 Test Acc: 0.526
Validation loss decreased (-0.425910 --> -0.525911).  Saving model ...
Epoch: 5 cost time: 2.125797986984253
Epoch: 5, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.401 Vali Acc: 0.667 Test Loss: 1.401 Test Acc: 0.667
Validation loss decreased (-0.525911 --> -0.666653).  Saving model ...
Epoch: 6 cost time: 2.230618953704834
Epoch: 6, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.296 Vali Acc: 0.752 Test Loss: 1.296 Test Acc: 0.752
Validation loss decreased (-0.666653 --> -0.751839).  Saving model ...
Epoch: 7 cost time: 2.20505428314209
Epoch: 7, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.185 Vali Acc: 0.826 Test Loss: 1.185 Test Acc: 0.826
Validation loss decreased (-0.751839 --> -0.825914).  Saving model ...
Epoch: 8 cost time: 2.1735284328460693
Epoch: 8, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.075 Vali Acc: 0.841 Test Loss: 1.075 Test Acc: 0.841
Validation loss decreased (-0.825914 --> -0.840730).  Saving model ...
Epoch: 9 cost time: 2.228273391723633
Epoch: 9, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.969 Vali Acc: 0.863 Test Loss: 0.969 Test Acc: 0.863
Validation loss decreased (-0.840730 --> -0.862953).  Saving model ...
Epoch: 10 cost time: 2.186657190322876
Epoch: 10, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.872 Vali Acc: 0.874 Test Loss: 0.872 Test Acc: 0.874
Validation loss decreased (-0.862953 --> -0.874065).  Saving model ...
Epoch: 11 cost time: 2.1591646671295166
Epoch: 11, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.784 Vali Acc: 0.885 Test Loss: 0.784 Test Acc: 0.885
Validation loss decreased (-0.874065 --> -0.885177).  Saving model ...
Epoch: 12 cost time: 2.3765981197357178
Epoch: 12, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.704 Vali Acc: 0.893 Test Loss: 0.704 Test Acc: 0.893
Validation loss decreased (-0.885177 --> -0.892586).  Saving model ...
Epoch: 13 cost time: 2.085175037384033
Epoch: 13, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.635 Vali Acc: 0.900 Test Loss: 0.635 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 2.2374706268310547
Epoch: 14, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.574 Vali Acc: 0.907 Test Loss: 0.574 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 15 cost time: 2.205282688140869
Epoch: 15, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.517 Vali Acc: 0.915 Test Loss: 0.517 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 16 cost time: 1.977827787399292
Epoch: 16, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.466 Vali Acc: 0.926 Test Loss: 0.466 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925921).  Saving model ...
Epoch: 17 cost time: 2.2103514671325684
Epoch: 17, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.423 Vali Acc: 0.930 Test Loss: 0.423 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 18 cost time: 2.0672402381896973
Epoch: 18, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.383 Vali Acc: 0.933 Test Loss: 0.383 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933330).  Saving model ...
Epoch: 19 cost time: 2.034616708755493
Epoch: 19, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.350 Vali Acc: 0.933 Test Loss: 0.350 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 20 cost time: 1.9323627948760986
Epoch: 20, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.323 Vali Acc: 0.937 Test Loss: 0.323 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 21 cost time: 2.1018142700195312
Epoch: 21, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.302 Vali Acc: 0.937 Test Loss: 0.302 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 22 cost time: 2.044426679611206
Epoch: 22, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.286 Vali Acc: 0.937 Test Loss: 0.286 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 23 cost time: 2.0061333179473877
Epoch: 23, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.063535690307617
Epoch: 24, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.04516863822937
Epoch: 25, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.254 Vali Acc: 0.926 Test Loss: 0.254 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.267076253890991
Epoch: 26, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.076698064804077
Epoch: 27, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1115293502807617
Epoch: 28, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.016007661819458
Epoch: 29, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.212484121322632
Epoch: 30, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 28146822
model size : 108.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.521379232406616
Epoch: 1, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.764 Vali Acc: 0.270 Test Loss: 1.764 Test Acc: 0.270
Validation loss decreased (inf --> -0.270353).  Saving model ...
Epoch: 2 cost time: 1.050854206085205
Epoch: 2, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.708 Vali Acc: 0.333 Test Loss: 1.708 Test Acc: 0.333
Validation loss decreased (-0.270353 --> -0.333316).  Saving model ...
Epoch: 3 cost time: 1.112964391708374
Epoch: 3, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.649 Vali Acc: 0.389 Test Loss: 1.649 Test Acc: 0.389
Validation loss decreased (-0.333316 --> -0.388872).  Saving model ...
Epoch: 4 cost time: 1.0105764865875244
Epoch: 4, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.566 Vali Acc: 0.500 Test Loss: 1.566 Test Acc: 0.500
Validation loss decreased (-0.388872 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 1.1213140487670898
Epoch: 5, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.464 Vali Acc: 0.574 Test Loss: 1.464 Test Acc: 0.574
Validation loss decreased (-0.499984 --> -0.574059).  Saving model ...
Epoch: 6 cost time: 1.2174837589263916
Epoch: 6, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.353 Vali Acc: 0.633 Test Loss: 1.353 Test Acc: 0.633
Validation loss decreased (-0.574059 --> -0.633320).  Saving model ...
Epoch: 7 cost time: 1.207369089126587
Epoch: 7, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.240 Vali Acc: 0.700 Test Loss: 1.240 Test Acc: 0.700
Validation loss decreased (-0.633320 --> -0.699988).  Saving model ...
Epoch: 8 cost time: 1.19185471534729
Epoch: 8, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.127 Vali Acc: 0.785 Test Loss: 1.127 Test Acc: 0.785
Validation loss decreased (-0.699988 --> -0.785174).  Saving model ...
Epoch: 9 cost time: 1.1427035331726074
Epoch: 9, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.020 Vali Acc: 0.830 Test Loss: 1.020 Test Acc: 0.830
Validation loss decreased (-0.785174 --> -0.829619).  Saving model ...
Epoch: 10 cost time: 1.2165226936340332
Epoch: 10, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.921 Vali Acc: 0.870 Test Loss: 0.921 Test Acc: 0.870
Validation loss decreased (-0.829619 --> -0.870361).  Saving model ...
Epoch: 11 cost time: 1.1901957988739014
Epoch: 11, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.830 Vali Acc: 0.885 Test Loss: 0.830 Test Acc: 0.885
Validation loss decreased (-0.870361 --> -0.885177).  Saving model ...
Epoch: 12 cost time: 1.2775235176086426
Epoch: 12, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.745 Vali Acc: 0.904 Test Loss: 0.745 Test Acc: 0.904
Validation loss decreased (-0.885177 --> -0.903696).  Saving model ...
Epoch: 13 cost time: 1.1128740310668945
Epoch: 13, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.670 Vali Acc: 0.907 Test Loss: 0.670 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907401).  Saving model ...
Epoch: 14 cost time: 1.3013522624969482
Epoch: 14, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.602 Vali Acc: 0.900 Test Loss: 0.602 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2066454887390137
Epoch: 15, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.541 Vali Acc: 0.904 Test Loss: 0.541 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2464654445648193
Epoch: 16, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.487 Vali Acc: 0.904 Test Loss: 0.487 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1808409690856934
Epoch: 17, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.439 Vali Acc: 0.904 Test Loss: 0.439 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2581307888031006
Epoch: 18, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.400 Vali Acc: 0.904 Test Loss: 0.400 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1621568202972412
Epoch: 19, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.367 Vali Acc: 0.915 Test Loss: 0.367 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914811).  Saving model ...
Epoch: 20 cost time: 1.2256577014923096
Epoch: 20, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.340 Vali Acc: 0.911 Test Loss: 0.340 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1935112476348877
Epoch: 21, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.317 Vali Acc: 0.915 Test Loss: 0.317 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 22 cost time: 1.2185637950897217
Epoch: 22, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.298 Vali Acc: 0.919 Test Loss: 0.298 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 23 cost time: 1.2495548725128174
Epoch: 23, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.285 Vali Acc: 0.919 Test Loss: 0.285 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 24 cost time: 1.211592197418213
Epoch: 24, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.275 Vali Acc: 0.919 Test Loss: 0.275 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 25 cost time: 1.2332520484924316
Epoch: 25, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.266 Vali Acc: 0.915 Test Loss: 0.266 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2199110984802246
Epoch: 26, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 1.2103044986724854
Epoch: 27, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 1.2511866092681885
Epoch: 28, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 1.139354944229126
Epoch: 29, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 1.2126920223236084
Epoch: 30, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.237 Vali Acc: 0.915 Test Loss: 0.237 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 8287494
model size : 32.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.282975196838379
Epoch: 1, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.683 Vali Acc: 0.348 Test Loss: 1.683 Test Acc: 0.348
Validation loss decreased (inf --> -0.348131).  Saving model ...
Epoch: 2 cost time: 1.4837570190429688
Epoch: 2, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.631 Vali Acc: 0.393 Test Loss: 1.631 Test Acc: 0.393
Validation loss decreased (-0.348131 --> -0.392576).  Saving model ...
Epoch: 3 cost time: 1.531721830368042
Epoch: 3, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.576 Vali Acc: 0.426 Test Loss: 1.576 Test Acc: 0.426
Validation loss decreased (-0.392576 --> -0.425910).  Saving model ...
Epoch: 4 cost time: 1.537229061126709
Epoch: 4, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.498 Vali Acc: 0.526 Test Loss: 1.498 Test Acc: 0.526
Validation loss decreased (-0.425910 --> -0.525911).  Saving model ...
Epoch: 5 cost time: 1.5843095779418945
Epoch: 5, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.401 Vali Acc: 0.667 Test Loss: 1.401 Test Acc: 0.667
Validation loss decreased (-0.525911 --> -0.666653).  Saving model ...
Epoch: 6 cost time: 1.7550454139709473
Epoch: 6, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.296 Vali Acc: 0.752 Test Loss: 1.296 Test Acc: 0.752
Validation loss decreased (-0.666653 --> -0.751839).  Saving model ...
Epoch: 7 cost time: 1.52455472946167
Epoch: 7, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.185 Vali Acc: 0.826 Test Loss: 1.185 Test Acc: 0.826
Validation loss decreased (-0.751839 --> -0.825914).  Saving model ...
Epoch: 8 cost time: 1.7164201736450195
Epoch: 8, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.075 Vali Acc: 0.837 Test Loss: 1.075 Test Acc: 0.837
Validation loss decreased (-0.825914 --> -0.837026).  Saving model ...
Epoch: 9 cost time: 1.832080602645874
Epoch: 9, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.969 Vali Acc: 0.863 Test Loss: 0.969 Test Acc: 0.863
Validation loss decreased (-0.837026 --> -0.862953).  Saving model ...
Epoch: 10 cost time: 1.6667463779449463
Epoch: 10, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.872 Vali Acc: 0.874 Test Loss: 0.872 Test Acc: 0.874
Validation loss decreased (-0.862953 --> -0.874065).  Saving model ...
Epoch: 11 cost time: 1.628519058227539
Epoch: 11, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.784 Vali Acc: 0.885 Test Loss: 0.784 Test Acc: 0.885
Validation loss decreased (-0.874065 --> -0.885177).  Saving model ...
Epoch: 12 cost time: 1.8015055656433105
Epoch: 12, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.704 Vali Acc: 0.893 Test Loss: 0.704 Test Acc: 0.893
Validation loss decreased (-0.885177 --> -0.892586).  Saving model ...
Epoch: 13 cost time: 1.5792710781097412
Epoch: 13, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.635 Vali Acc: 0.900 Test Loss: 0.635 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 1.6832642555236816
Epoch: 14, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.574 Vali Acc: 0.907 Test Loss: 0.574 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 15 cost time: 1.7231457233428955
Epoch: 15, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.517 Vali Acc: 0.915 Test Loss: 0.517 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 16 cost time: 1.59806227684021
Epoch: 16, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.466 Vali Acc: 0.926 Test Loss: 0.466 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925921).  Saving model ...
Epoch: 17 cost time: 1.7006137371063232
Epoch: 17, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.423 Vali Acc: 0.930 Test Loss: 0.423 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 18 cost time: 1.594407320022583
Epoch: 18, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.383 Vali Acc: 0.933 Test Loss: 0.383 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933330).  Saving model ...
Epoch: 19 cost time: 1.6789016723632812
Epoch: 19, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.350 Vali Acc: 0.933 Test Loss: 0.350 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 20 cost time: 1.5243821144104004
Epoch: 20, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.323 Vali Acc: 0.937 Test Loss: 0.323 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 21 cost time: 1.6618471145629883
Epoch: 21, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.302 Vali Acc: 0.937 Test Loss: 0.302 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 22 cost time: 1.635122537612915
Epoch: 22, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.286 Vali Acc: 0.937 Test Loss: 0.286 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 23 cost time: 1.6756296157836914
Epoch: 23, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6874234676361084
Epoch: 24, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6664550304412842
Epoch: 25, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.254 Vali Acc: 0.926 Test Loss: 0.254 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6377689838409424
Epoch: 26, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5832951068878174
Epoch: 27, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5395610332489014
Epoch: 28, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5671272277832031
Epoch: 29, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.578190803527832
Epoch: 30, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 28146822
model size : 108.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5396366119384766
Epoch: 1, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.764 Vali Acc: 0.270 Test Loss: 1.764 Test Acc: 0.270
Validation loss decreased (inf --> -0.270353).  Saving model ...
Epoch: 2 cost time: 0.9003920555114746
Epoch: 2, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.708 Vali Acc: 0.333 Test Loss: 1.708 Test Acc: 0.333
Validation loss decreased (-0.270353 --> -0.333316).  Saving model ...
Epoch: 3 cost time: 1.0197479724884033
Epoch: 3, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.649 Vali Acc: 0.389 Test Loss: 1.649 Test Acc: 0.389
Validation loss decreased (-0.333316 --> -0.388872).  Saving model ...
Epoch: 4 cost time: 0.9406449794769287
Epoch: 4, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.566 Vali Acc: 0.500 Test Loss: 1.566 Test Acc: 0.500
Validation loss decreased (-0.388872 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 0.9142167568206787
Epoch: 5, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.464 Vali Acc: 0.574 Test Loss: 1.464 Test Acc: 0.574
Validation loss decreased (-0.499984 --> -0.574059).  Saving model ...
Epoch: 6 cost time: 1.0082125663757324
Epoch: 6, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.353 Vali Acc: 0.633 Test Loss: 1.353 Test Acc: 0.633
Validation loss decreased (-0.574059 --> -0.633320).  Saving model ...
Epoch: 7 cost time: 0.9806838035583496
Epoch: 7, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.240 Vali Acc: 0.700 Test Loss: 1.240 Test Acc: 0.700
Validation loss decreased (-0.633320 --> -0.699988).  Saving model ...
Epoch: 8 cost time: 1.0053045749664307
Epoch: 8, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.127 Vali Acc: 0.785 Test Loss: 1.127 Test Acc: 0.785
Validation loss decreased (-0.699988 --> -0.785174).  Saving model ...
Epoch: 9 cost time: 0.9734644889831543
Epoch: 9, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.020 Vali Acc: 0.830 Test Loss: 1.020 Test Acc: 0.830
Validation loss decreased (-0.785174 --> -0.829619).  Saving model ...
Epoch: 10 cost time: 1.023993730545044
Epoch: 10, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.921 Vali Acc: 0.870 Test Loss: 0.921 Test Acc: 0.870
Validation loss decreased (-0.829619 --> -0.870361).  Saving model ...
Epoch: 11 cost time: 0.946404218673706
Epoch: 11, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.830 Vali Acc: 0.885 Test Loss: 0.830 Test Acc: 0.885
Validation loss decreased (-0.870361 --> -0.885177).  Saving model ...
Epoch: 12 cost time: 0.9699158668518066
Epoch: 12, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.745 Vali Acc: 0.904 Test Loss: 0.745 Test Acc: 0.904
Validation loss decreased (-0.885177 --> -0.903696).  Saving model ...
Epoch: 13 cost time: 0.8891201019287109
Epoch: 13, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.670 Vali Acc: 0.907 Test Loss: 0.670 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907401).  Saving model ...
Epoch: 14 cost time: 0.8991851806640625
Epoch: 14, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.602 Vali Acc: 0.900 Test Loss: 0.602 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9343805313110352
Epoch: 15, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.541 Vali Acc: 0.904 Test Loss: 0.541 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9355781078338623
Epoch: 16, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.487 Vali Acc: 0.904 Test Loss: 0.487 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0125157833099365
Epoch: 17, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.439 Vali Acc: 0.904 Test Loss: 0.439 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8752191066741943
Epoch: 18, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.400 Vali Acc: 0.904 Test Loss: 0.400 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9388341903686523
Epoch: 19, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.367 Vali Acc: 0.915 Test Loss: 0.367 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914811).  Saving model ...
Epoch: 20 cost time: 0.9088559150695801
Epoch: 20, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.340 Vali Acc: 0.911 Test Loss: 0.340 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9693179130554199
Epoch: 21, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.317 Vali Acc: 0.915 Test Loss: 0.317 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 22 cost time: 0.92120361328125
Epoch: 22, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.298 Vali Acc: 0.919 Test Loss: 0.298 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 23 cost time: 0.9089357852935791
Epoch: 23, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.285 Vali Acc: 0.919 Test Loss: 0.285 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 24 cost time: 1.053492784500122
Epoch: 24, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.275 Vali Acc: 0.919 Test Loss: 0.275 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 25 cost time: 1.0486273765563965
Epoch: 25, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.266 Vali Acc: 0.915 Test Loss: 0.266 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8864338397979736
Epoch: 26, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.9353642463684082
Epoch: 27, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 0.9659030437469482
Epoch: 28, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 0.862990140914917
Epoch: 29, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 0.9663379192352295
Epoch: 30, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.237 Vali Acc: 0.915 Test Loss: 0.237 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 8287494
model size : 32.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4512217044830322
Epoch: 1, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.684 Vali Acc: 0.348 Test Loss: 1.684 Test Acc: 0.348
Validation loss decreased (inf --> -0.348131).  Saving model ...
Epoch: 2 cost time: 0.9492831230163574
Epoch: 2, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.632 Vali Acc: 0.393 Test Loss: 1.632 Test Acc: 0.393
Validation loss decreased (-0.348131 --> -0.392576).  Saving model ...
Epoch: 3 cost time: 0.9735672473907471
Epoch: 3, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.578 Vali Acc: 0.426 Test Loss: 1.578 Test Acc: 0.426
Validation loss decreased (-0.392576 --> -0.425910).  Saving model ...
Epoch: 4 cost time: 0.9804761409759521
Epoch: 4, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.501 Vali Acc: 0.519 Test Loss: 1.501 Test Acc: 0.519
Validation loss decreased (-0.425910 --> -0.518504).  Saving model ...
Epoch: 5 cost time: 1.0186898708343506
Epoch: 5, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.407 Vali Acc: 0.663 Test Loss: 1.407 Test Acc: 0.663
Validation loss decreased (-0.518504 --> -0.662949).  Saving model ...
Epoch: 6 cost time: 1.1397709846496582
Epoch: 6, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.303 Vali Acc: 0.741 Test Loss: 1.303 Test Acc: 0.741
Validation loss decreased (-0.662949 --> -0.740728).  Saving model ...
Epoch: 7 cost time: 1.0382707118988037
Epoch: 7, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.194 Vali Acc: 0.822 Test Loss: 1.194 Test Acc: 0.822
Validation loss decreased (-0.740728 --> -0.822210).  Saving model ...
Epoch: 8 cost time: 1.0194168090820312
Epoch: 8, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.085 Vali Acc: 0.841 Test Loss: 1.085 Test Acc: 0.841
Validation loss decreased (-0.822210 --> -0.840730).  Saving model ...
Epoch: 9 cost time: 1.1118457317352295
Epoch: 9, Steps: 2 | Train Loss: 0.956 Vali Loss: 0.980 Vali Acc: 0.859 Test Loss: 0.980 Test Acc: 0.859
Validation loss decreased (-0.840730 --> -0.859249).  Saving model ...
Epoch: 10 cost time: 1.073951244354248
Epoch: 10, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.883 Vali Acc: 0.870 Test Loss: 0.883 Test Acc: 0.870
Validation loss decreased (-0.859249 --> -0.870362).  Saving model ...
Epoch: 11 cost time: 1.0445220470428467
Epoch: 11, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.793 Vali Acc: 0.885 Test Loss: 0.793 Test Acc: 0.885
Validation loss decreased (-0.870362 --> -0.885177).  Saving model ...
Epoch: 12 cost time: 1.106003761291504
Epoch: 12, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.712 Vali Acc: 0.889 Test Loss: 0.712 Test Acc: 0.889
Validation loss decreased (-0.885177 --> -0.888882).  Saving model ...
Epoch: 13 cost time: 1.0672035217285156
Epoch: 13, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.641 Vali Acc: 0.896 Test Loss: 0.641 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 14 cost time: 1.0604972839355469
Epoch: 14, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.579 Vali Acc: 0.904 Test Loss: 0.579 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 15 cost time: 1.0708825588226318
Epoch: 15, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.521 Vali Acc: 0.915 Test Loss: 0.521 Test Acc: 0.915
Validation loss decreased (-0.903698 --> -0.914810).  Saving model ...
Epoch: 16 cost time: 1.0469481945037842
Epoch: 16, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.470 Vali Acc: 0.922 Test Loss: 0.470 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 17 cost time: 1.1248364448547363
Epoch: 17, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.425 Vali Acc: 0.926 Test Loss: 0.425 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 18 cost time: 1.085637092590332
Epoch: 18, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.385 Vali Acc: 0.930 Test Loss: 0.385 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 19 cost time: 1.2078242301940918
Epoch: 19, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.352 Vali Acc: 0.933 Test Loss: 0.352 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 20 cost time: 1.0475966930389404
Epoch: 20, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.324 Vali Acc: 0.933 Test Loss: 0.324 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 21 cost time: 1.0179457664489746
Epoch: 21, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.303 Vali Acc: 0.933 Test Loss: 0.303 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 22 cost time: 1.0918316841125488
Epoch: 22, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 23 cost time: 1.0398802757263184
Epoch: 23, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 1.034834384918213
Epoch: 24, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.262 Vali Acc: 0.930 Test Loss: 0.262 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0850491523742676
Epoch: 25, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1172571182250977
Epoch: 26, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0102970600128174
Epoch: 27, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.238 Vali Acc: 0.919 Test Loss: 0.238 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9711930751800537
Epoch: 28, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9770417213439941
Epoch: 29, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9538259506225586
Epoch: 30, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 28146822
model size : 108.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2912285327911377
Epoch: 1, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.762 Vali Acc: 0.270 Test Loss: 1.762 Test Acc: 0.270
Validation loss decreased (inf --> -0.270353).  Saving model ...
Epoch: 2 cost time: 0.6929900646209717
Epoch: 2, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.706 Vali Acc: 0.337 Test Loss: 1.706 Test Acc: 0.337
Validation loss decreased (-0.270353 --> -0.337020).  Saving model ...
Epoch: 3 cost time: 0.7800197601318359
Epoch: 3, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.648 Vali Acc: 0.389 Test Loss: 1.648 Test Acc: 0.389
Validation loss decreased (-0.337020 --> -0.388872).  Saving model ...
Epoch: 4 cost time: 0.7213194370269775
Epoch: 4, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.567 Vali Acc: 0.500 Test Loss: 1.567 Test Acc: 0.500
Validation loss decreased (-0.388872 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 0.7415115833282471
Epoch: 5, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.467 Vali Acc: 0.574 Test Loss: 1.467 Test Acc: 0.574
Validation loss decreased (-0.499984 --> -0.574059).  Saving model ...
Epoch: 6 cost time: 0.7099974155426025
Epoch: 6, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.358 Vali Acc: 0.633 Test Loss: 1.358 Test Acc: 0.633
Validation loss decreased (-0.574059 --> -0.633320).  Saving model ...
Epoch: 7 cost time: 0.7566914558410645
Epoch: 7, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.247 Vali Acc: 0.700 Test Loss: 1.247 Test Acc: 0.700
Validation loss decreased (-0.633320 --> -0.699988).  Saving model ...
Epoch: 8 cost time: 0.7044155597686768
Epoch: 8, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.136 Vali Acc: 0.778 Test Loss: 1.136 Test Acc: 0.778
Validation loss decreased (-0.699988 --> -0.777766).  Saving model ...
Epoch: 9 cost time: 0.7657902240753174
Epoch: 9, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.030 Vali Acc: 0.826 Test Loss: 1.030 Test Acc: 0.826
Validation loss decreased (-0.777766 --> -0.825916).  Saving model ...
Epoch: 10 cost time: 0.830453634262085
Epoch: 10, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.931 Vali Acc: 0.870 Test Loss: 0.931 Test Acc: 0.870
Validation loss decreased (-0.825916 --> -0.870361).  Saving model ...
Epoch: 11 cost time: 0.7642269134521484
Epoch: 11, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.839 Vali Acc: 0.881 Test Loss: 0.839 Test Acc: 0.881
Validation loss decreased (-0.870361 --> -0.881473).  Saving model ...
Epoch: 12 cost time: 0.7513668537139893
Epoch: 12, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.753 Vali Acc: 0.904 Test Loss: 0.753 Test Acc: 0.904
Validation loss decreased (-0.881473 --> -0.903696).  Saving model ...
Epoch: 13 cost time: 0.7292916774749756
Epoch: 13, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.677 Vali Acc: 0.904 Test Loss: 0.677 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 14 cost time: 0.684136152267456
Epoch: 14, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.608 Vali Acc: 0.904 Test Loss: 0.608 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903698).  Saving model ...
Epoch: 15 cost time: 0.7445704936981201
Epoch: 15, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.546 Vali Acc: 0.907 Test Loss: 0.546 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 16 cost time: 0.754589319229126
Epoch: 16, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.491 Vali Acc: 0.904 Test Loss: 0.491 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7314753532409668
Epoch: 17, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.444 Vali Acc: 0.907 Test Loss: 0.444 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907403).  Saving model ...
Epoch: 18 cost time: 0.7395727634429932
Epoch: 18, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.405 Vali Acc: 0.907 Test Loss: 0.405 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 19 cost time: 0.6828148365020752
Epoch: 19, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.371 Vali Acc: 0.915 Test Loss: 0.371 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 20 cost time: 0.7868750095367432
Epoch: 20, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.344 Vali Acc: 0.915 Test Loss: 0.344 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 21 cost time: 0.7597372531890869
Epoch: 21, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.320 Vali Acc: 0.919 Test Loss: 0.320 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 22 cost time: 0.8434593677520752
Epoch: 22, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.301 Vali Acc: 0.919 Test Loss: 0.301 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 23 cost time: 0.7835373878479004
Epoch: 23, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 24 cost time: 0.8140888214111328
Epoch: 24, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.278 Vali Acc: 0.919 Test Loss: 0.278 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 25 cost time: 0.88132643699646
Epoch: 25, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 0.7777721881866455
Epoch: 26, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.7159183025360107
Epoch: 27, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 0.7687721252441406
Epoch: 28, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 0.766472339630127
Epoch: 29, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 0.7753782272338867
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 8287494
model size : 32.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.061457633972168
Epoch: 1, Steps: 2 | Train Loss: 2.002 Vali Loss: 2.026 Vali Acc: 0.019 Test Loss: 2.026 Test Acc: 0.019
Validation loss decreased (inf --> -0.018498).  Saving model ...
Epoch: 2 cost time: 1.4604823589324951
Epoch: 2, Steps: 2 | Train Loss: 1.953 Vali Loss: 1.968 Vali Acc: 0.022 Test Loss: 1.968 Test Acc: 0.022
Validation loss decreased (-0.018498 --> -0.022203).  Saving model ...
Epoch: 3 cost time: 1.4927668571472168
Epoch: 3, Steps: 2 | Train Loss: 1.920 Vali Loss: 1.912 Vali Acc: 0.037 Test Loss: 1.912 Test Acc: 0.037
Validation loss decreased (-0.022203 --> -0.037018).  Saving model ...
Epoch: 4 cost time: 1.5076408386230469
Epoch: 4, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.837 Vali Acc: 0.089 Test Loss: 1.837 Test Acc: 0.089
Validation loss decreased (-0.037018 --> -0.088871).  Saving model ...
Epoch: 5 cost time: 1.1721892356872559
Epoch: 5, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.743 Vali Acc: 0.211 Test Loss: 1.743 Test Acc: 0.211
Validation loss decreased (-0.088871 --> -0.211094).  Saving model ...
Epoch: 6 cost time: 1.385486364364624
Epoch: 6, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.634 Vali Acc: 0.356 Test Loss: 1.634 Test Acc: 0.356
Validation loss decreased (-0.211094 --> -0.355539).  Saving model ...
Epoch: 7 cost time: 1.3830809593200684
Epoch: 7, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.517 Vali Acc: 0.507 Test Loss: 1.517 Test Acc: 0.507
Validation loss decreased (-0.355539 --> -0.507392).  Saving model ...
Epoch: 8 cost time: 1.4126269817352295
Epoch: 8, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.395 Vali Acc: 0.611 Test Loss: 1.395 Test Acc: 0.611
Validation loss decreased (-0.507392 --> -0.611097).  Saving model ...
Epoch: 9 cost time: 1.4454147815704346
Epoch: 9, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.275 Vali Acc: 0.689 Test Loss: 1.275 Test Acc: 0.689
Validation loss decreased (-0.611097 --> -0.688876).  Saving model ...
Epoch: 10 cost time: 1.3996872901916504
Epoch: 10, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.157 Vali Acc: 0.770 Test Loss: 1.157 Test Acc: 0.770
Validation loss decreased (-0.688876 --> -0.770359).  Saving model ...
Epoch: 11 cost time: 1.3815248012542725
Epoch: 11, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.045 Vali Acc: 0.815 Test Loss: 1.045 Test Acc: 0.815
Validation loss decreased (-0.770359 --> -0.814804).  Saving model ...
Epoch: 12 cost time: 1.4296505451202393
Epoch: 12, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.937 Vali Acc: 0.830 Test Loss: 0.937 Test Acc: 0.830
Validation loss decreased (-0.814804 --> -0.829620).  Saving model ...
Epoch: 13 cost time: 1.3599236011505127
Epoch: 13, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.841 Vali Acc: 0.863 Test Loss: 0.841 Test Acc: 0.863
Validation loss decreased (-0.829620 --> -0.862955).  Saving model ...
Epoch: 14 cost time: 1.4390056133270264
Epoch: 14, Steps: 2 | Train Loss: 0.640 Vali Loss: 0.752 Vali Acc: 0.878 Test Loss: 0.752 Test Acc: 0.878
Validation loss decreased (-0.862955 --> -0.877770).  Saving model ...
Epoch: 15 cost time: 1.4409294128417969
Epoch: 15, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.670 Vali Acc: 0.904 Test Loss: 0.670 Test Acc: 0.904
Validation loss decreased (-0.877770 --> -0.903697).  Saving model ...
Epoch: 16 cost time: 1.4880046844482422
Epoch: 16, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.595 Vali Acc: 0.911 Test Loss: 0.595 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 17 cost time: 1.5071632862091064
Epoch: 17, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.530 Vali Acc: 0.907 Test Loss: 0.530 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4293103218078613
Epoch: 18, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.475 Vali Acc: 0.926 Test Loss: 0.475 Test Acc: 0.926
Validation loss decreased (-0.911105 --> -0.925921).  Saving model ...
Epoch: 19 cost time: 1.4429211616516113
Epoch: 19, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.430 Vali Acc: 0.922 Test Loss: 0.430 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4049315452575684
Epoch: 20, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.391 Vali Acc: 0.926 Test Loss: 0.391 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 1.4225523471832275
Epoch: 21, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3569762706756592
Epoch: 22, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.331 Vali Acc: 0.915 Test Loss: 0.331 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.336836338043213
Epoch: 23, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2951581478118896
Epoch: 24, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.289 Vali Acc: 0.919 Test Loss: 0.289 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3413004875183105
Epoch: 25, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.274 Vali Acc: 0.919 Test Loss: 0.274 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4026010036468506
Epoch: 26, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4054770469665527
Epoch: 27, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.254 Vali Acc: 0.919 Test Loss: 0.254 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4345002174377441
Epoch: 28, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.248 Vali Acc: 0.919 Test Loss: 0.248 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3578529357910156
Epoch: 29, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.242 Vali Acc: 0.919 Test Loss: 0.242 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3824529647827148
Epoch: 30, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925924).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 14087046
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.461339235305786
Epoch: 1, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.755 Vali Acc: 0.200 Test Loss: 1.755 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.8697519302368164
Epoch: 2, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.705 Vali Acc: 0.226 Test Loss: 1.705 Test Acc: 0.226
Validation loss decreased (-0.199982 --> -0.225909).  Saving model ...
Epoch: 3 cost time: 0.8361518383026123
Epoch: 3, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.659 Vali Acc: 0.289 Test Loss: 1.659 Test Acc: 0.289
Validation loss decreased (-0.225909 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 0.8176882266998291
Epoch: 4, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.599 Vali Acc: 0.359 Test Loss: 1.599 Test Acc: 0.359
Validation loss decreased (-0.288872 --> -0.359243).  Saving model ...
Epoch: 5 cost time: 0.8414771556854248
Epoch: 5, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.523 Vali Acc: 0.544 Test Loss: 1.523 Test Acc: 0.544
Validation loss decreased (-0.359243 --> -0.544429).  Saving model ...
Epoch: 6 cost time: 0.7985336780548096
Epoch: 6, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.436 Vali Acc: 0.626 Test Loss: 1.436 Test Acc: 0.626
Validation loss decreased (-0.544429 --> -0.625912).  Saving model ...
Epoch: 7 cost time: 0.9750180244445801
Epoch: 7, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.341 Vali Acc: 0.663 Test Loss: 1.341 Test Acc: 0.663
Validation loss decreased (-0.625912 --> -0.662950).  Saving model ...
Epoch: 8 cost time: 0.7952470779418945
Epoch: 8, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.244 Vali Acc: 0.719 Test Loss: 1.244 Test Acc: 0.719
Validation loss decreased (-0.662950 --> -0.718506).  Saving model ...
Epoch: 9 cost time: 0.8504409790039062
Epoch: 9, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.144 Vali Acc: 0.744 Test Loss: 1.144 Test Acc: 0.744
Validation loss decreased (-0.718506 --> -0.744433).  Saving model ...
Epoch: 10 cost time: 0.8472447395324707
Epoch: 10, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.047 Vali Acc: 0.785 Test Loss: 1.047 Test Acc: 0.785
Validation loss decreased (-0.744433 --> -0.785175).  Saving model ...
Epoch: 11 cost time: 0.8572521209716797
Epoch: 11, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.955 Vali Acc: 0.822 Test Loss: 0.955 Test Acc: 0.822
Validation loss decreased (-0.785175 --> -0.822213).  Saving model ...
Epoch: 12 cost time: 0.8411195278167725
Epoch: 12, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.869 Vali Acc: 0.856 Test Loss: 0.869 Test Acc: 0.856
Validation loss decreased (-0.822213 --> -0.855547).  Saving model ...
Epoch: 13 cost time: 0.9172983169555664
Epoch: 13, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.788 Vali Acc: 0.863 Test Loss: 0.788 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862955).  Saving model ...
Epoch: 14 cost time: 0.8015375137329102
Epoch: 14, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.715 Vali Acc: 0.881 Test Loss: 0.715 Test Acc: 0.881
Validation loss decreased (-0.862955 --> -0.881474).  Saving model ...
Epoch: 15 cost time: 0.7883453369140625
Epoch: 15, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.647 Vali Acc: 0.881 Test Loss: 0.647 Test Acc: 0.881
Validation loss decreased (-0.881474 --> -0.881475).  Saving model ...
Epoch: 16 cost time: 0.8380472660064697
Epoch: 16, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.584 Vali Acc: 0.893 Test Loss: 0.584 Test Acc: 0.893
Validation loss decreased (-0.881475 --> -0.892587).  Saving model ...
Epoch: 17 cost time: 0.7964718341827393
Epoch: 17, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.528 Vali Acc: 0.904 Test Loss: 0.528 Test Acc: 0.904
Validation loss decreased (-0.892587 --> -0.903698).  Saving model ...
Epoch: 18 cost time: 0.815382719039917
Epoch: 18, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8739044666290283
Epoch: 19, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.436 Vali Acc: 0.904 Test Loss: 0.436 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903699).  Saving model ...
Epoch: 20 cost time: 0.7546885013580322
Epoch: 20, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.400 Vali Acc: 0.907 Test Loss: 0.400 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 21 cost time: 0.8132612705230713
Epoch: 21, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.370 Vali Acc: 0.907 Test Loss: 0.370 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 22 cost time: 0.867708683013916
Epoch: 22, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.346 Vali Acc: 0.907 Test Loss: 0.346 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 23 cost time: 0.8493995666503906
Epoch: 23, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.325 Vali Acc: 0.907 Test Loss: 0.325 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 24 cost time: 0.8308329582214355
Epoch: 24, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.307 Vali Acc: 0.907 Test Loss: 0.307 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 25 cost time: 0.7950937747955322
Epoch: 25, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.293 Vali Acc: 0.904 Test Loss: 0.293 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8014018535614014
Epoch: 26, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.281 Vali Acc: 0.904 Test Loss: 0.281 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8185272216796875
Epoch: 27, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.271 Vali Acc: 0.915 Test Loss: 0.271 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 28 cost time: 0.841559648513794
Epoch: 28, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.263 Vali Acc: 0.915 Test Loss: 0.263 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 29 cost time: 0.7685592174530029
Epoch: 29, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.257 Vali Acc: 0.915 Test Loss: 0.257 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 30 cost time: 0.7700941562652588
Epoch: 30, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 4157190
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.611257553100586
Epoch: 1, Steps: 2 | Train Loss: 2.002 Vali Loss: 2.026 Vali Acc: 0.019 Test Loss: 2.026 Test Acc: 0.019
Validation loss decreased (inf --> -0.018498).  Saving model ...
Epoch: 2 cost time: 0.9907279014587402
Epoch: 2, Steps: 2 | Train Loss: 1.953 Vali Loss: 1.968 Vali Acc: 0.022 Test Loss: 1.968 Test Acc: 0.022
Validation loss decreased (-0.018498 --> -0.022203).  Saving model ...
Epoch: 3 cost time: 1.0044293403625488
Epoch: 3, Steps: 2 | Train Loss: 1.920 Vali Loss: 1.912 Vali Acc: 0.037 Test Loss: 1.912 Test Acc: 0.037
Validation loss decreased (-0.022203 --> -0.037018).  Saving model ...
Epoch: 4 cost time: 1.0001707077026367
Epoch: 4, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.837 Vali Acc: 0.089 Test Loss: 1.837 Test Acc: 0.089
Validation loss decreased (-0.037018 --> -0.088871).  Saving model ...
Epoch: 5 cost time: 1.0418314933776855
Epoch: 5, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.743 Vali Acc: 0.211 Test Loss: 1.743 Test Acc: 0.211
Validation loss decreased (-0.088871 --> -0.211094).  Saving model ...
Epoch: 6 cost time: 1.1698522567749023
Epoch: 6, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.634 Vali Acc: 0.356 Test Loss: 1.634 Test Acc: 0.356
Validation loss decreased (-0.211094 --> -0.355539).  Saving model ...
Epoch: 7 cost time: 1.0902185440063477
Epoch: 7, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.517 Vali Acc: 0.507 Test Loss: 1.517 Test Acc: 0.507
Validation loss decreased (-0.355539 --> -0.507392).  Saving model ...
Epoch: 8 cost time: 1.0301218032836914
Epoch: 8, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.395 Vali Acc: 0.611 Test Loss: 1.395 Test Acc: 0.611
Validation loss decreased (-0.507392 --> -0.611097).  Saving model ...
Epoch: 9 cost time: 1.008364200592041
Epoch: 9, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.275 Vali Acc: 0.689 Test Loss: 1.275 Test Acc: 0.689
Validation loss decreased (-0.611097 --> -0.688876).  Saving model ...
Epoch: 10 cost time: 1.083448886871338
Epoch: 10, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.157 Vali Acc: 0.770 Test Loss: 1.157 Test Acc: 0.770
Validation loss decreased (-0.688876 --> -0.770359).  Saving model ...
Epoch: 11 cost time: 1.067577838897705
Epoch: 11, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.045 Vali Acc: 0.815 Test Loss: 1.045 Test Acc: 0.815
Validation loss decreased (-0.770359 --> -0.814804).  Saving model ...
Epoch: 12 cost time: 1.0544459819793701
Epoch: 12, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.937 Vali Acc: 0.830 Test Loss: 0.937 Test Acc: 0.830
Validation loss decreased (-0.814804 --> -0.829620).  Saving model ...
Epoch: 13 cost time: 1.0403950214385986
Epoch: 13, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.841 Vali Acc: 0.863 Test Loss: 0.841 Test Acc: 0.863
Validation loss decreased (-0.829620 --> -0.862955).  Saving model ...
Epoch: 14 cost time: 1.1166820526123047
Epoch: 14, Steps: 2 | Train Loss: 0.640 Vali Loss: 0.752 Vali Acc: 0.878 Test Loss: 0.752 Test Acc: 0.878
Validation loss decreased (-0.862955 --> -0.877770).  Saving model ...
Epoch: 15 cost time: 0.9778993129730225
Epoch: 15, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.670 Vali Acc: 0.904 Test Loss: 0.670 Test Acc: 0.904
Validation loss decreased (-0.877770 --> -0.903697).  Saving model ...
Epoch: 16 cost time: 1.0677266120910645
Epoch: 16, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.595 Vali Acc: 0.911 Test Loss: 0.595 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 17 cost time: 1.0791337490081787
Epoch: 17, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.530 Vali Acc: 0.907 Test Loss: 0.530 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0589938163757324
Epoch: 18, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.475 Vali Acc: 0.926 Test Loss: 0.475 Test Acc: 0.926
Validation loss decreased (-0.911105 --> -0.925921).  Saving model ...
Epoch: 19 cost time: 1.0585463047027588
Epoch: 19, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.430 Vali Acc: 0.922 Test Loss: 0.430 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9868960380554199
Epoch: 20, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.391 Vali Acc: 0.926 Test Loss: 0.391 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 1.1125495433807373
Epoch: 21, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0278904438018799
Epoch: 22, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.331 Vali Acc: 0.915 Test Loss: 0.331 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.133927345275879
Epoch: 23, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.010169267654419
Epoch: 24, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.289 Vali Acc: 0.919 Test Loss: 0.289 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0119199752807617
Epoch: 25, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.274 Vali Acc: 0.919 Test Loss: 0.274 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0078809261322021
Epoch: 26, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0474095344543457
Epoch: 27, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.254 Vali Acc: 0.919 Test Loss: 0.254 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1182167530059814
Epoch: 28, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.248 Vali Acc: 0.919 Test Loss: 0.248 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0803022384643555
Epoch: 29, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.242 Vali Acc: 0.919 Test Loss: 0.242 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1594936847686768
Epoch: 30, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925924).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 14087046
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5094521045684814
Epoch: 1, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.755 Vali Acc: 0.200 Test Loss: 1.755 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.7170577049255371
Epoch: 2, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.705 Vali Acc: 0.226 Test Loss: 1.705 Test Acc: 0.226
Validation loss decreased (-0.199982 --> -0.225909).  Saving model ...
Epoch: 3 cost time: 0.7361030578613281
Epoch: 3, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.659 Vali Acc: 0.289 Test Loss: 1.659 Test Acc: 0.289
Validation loss decreased (-0.225909 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 0.7551004886627197
Epoch: 4, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.599 Vali Acc: 0.359 Test Loss: 1.599 Test Acc: 0.359
Validation loss decreased (-0.288872 --> -0.359243).  Saving model ...
Epoch: 5 cost time: 0.7381579875946045
Epoch: 5, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.523 Vali Acc: 0.544 Test Loss: 1.523 Test Acc: 0.544
Validation loss decreased (-0.359243 --> -0.544429).  Saving model ...
Epoch: 6 cost time: 0.7307162284851074
Epoch: 6, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.436 Vali Acc: 0.626 Test Loss: 1.436 Test Acc: 0.626
Validation loss decreased (-0.544429 --> -0.625912).  Saving model ...
Epoch: 7 cost time: 0.6949596405029297
Epoch: 7, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.341 Vali Acc: 0.663 Test Loss: 1.341 Test Acc: 0.663
Validation loss decreased (-0.625912 --> -0.662950).  Saving model ...
Epoch: 8 cost time: 0.6679868698120117
Epoch: 8, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.244 Vali Acc: 0.719 Test Loss: 1.244 Test Acc: 0.719
Validation loss decreased (-0.662950 --> -0.718506).  Saving model ...
Epoch: 9 cost time: 0.685110330581665
Epoch: 9, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.144 Vali Acc: 0.744 Test Loss: 1.144 Test Acc: 0.744
Validation loss decreased (-0.718506 --> -0.744433).  Saving model ...
Epoch: 10 cost time: 0.6876213550567627
Epoch: 10, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.047 Vali Acc: 0.785 Test Loss: 1.047 Test Acc: 0.785
Validation loss decreased (-0.744433 --> -0.785175).  Saving model ...
Epoch: 11 cost time: 0.729656457901001
Epoch: 11, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.955 Vali Acc: 0.822 Test Loss: 0.955 Test Acc: 0.822
Validation loss decreased (-0.785175 --> -0.822213).  Saving model ...
Epoch: 12 cost time: 0.7012650966644287
Epoch: 12, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.869 Vali Acc: 0.856 Test Loss: 0.869 Test Acc: 0.856
Validation loss decreased (-0.822213 --> -0.855547).  Saving model ...
Epoch: 13 cost time: 0.7117772102355957
Epoch: 13, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.788 Vali Acc: 0.863 Test Loss: 0.788 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862955).  Saving model ...
Epoch: 14 cost time: 0.7218954563140869
Epoch: 14, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.715 Vali Acc: 0.881 Test Loss: 0.715 Test Acc: 0.881
Validation loss decreased (-0.862955 --> -0.881474).  Saving model ...
Epoch: 15 cost time: 0.6358439922332764
Epoch: 15, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.647 Vali Acc: 0.881 Test Loss: 0.647 Test Acc: 0.881
Validation loss decreased (-0.881474 --> -0.881475).  Saving model ...
Epoch: 16 cost time: 0.7380201816558838
Epoch: 16, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.584 Vali Acc: 0.893 Test Loss: 0.584 Test Acc: 0.893
Validation loss decreased (-0.881475 --> -0.892587).  Saving model ...
Epoch: 17 cost time: 0.7176744937896729
Epoch: 17, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.528 Vali Acc: 0.904 Test Loss: 0.528 Test Acc: 0.904
Validation loss decreased (-0.892587 --> -0.903698).  Saving model ...
Epoch: 18 cost time: 0.6982314586639404
Epoch: 18, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7835378646850586
Epoch: 19, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.436 Vali Acc: 0.904 Test Loss: 0.436 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903699).  Saving model ...
Epoch: 20 cost time: 0.8153800964355469
Epoch: 20, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.400 Vali Acc: 0.907 Test Loss: 0.400 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 21 cost time: 0.7014296054840088
Epoch: 21, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.370 Vali Acc: 0.907 Test Loss: 0.370 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 22 cost time: 0.7254493236541748
Epoch: 22, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.346 Vali Acc: 0.907 Test Loss: 0.346 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 23 cost time: 0.6869235038757324
Epoch: 23, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.325 Vali Acc: 0.907 Test Loss: 0.325 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 24 cost time: 0.757645845413208
Epoch: 24, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.307 Vali Acc: 0.907 Test Loss: 0.307 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 25 cost time: 0.7215087413787842
Epoch: 25, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.293 Vali Acc: 0.904 Test Loss: 0.293 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7123336791992188
Epoch: 26, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.281 Vali Acc: 0.904 Test Loss: 0.281 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7092370986938477
Epoch: 27, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.271 Vali Acc: 0.915 Test Loss: 0.271 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 28 cost time: 0.7575180530548096
Epoch: 28, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.263 Vali Acc: 0.915 Test Loss: 0.263 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 29 cost time: 0.7050893306732178
Epoch: 29, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.257 Vali Acc: 0.915 Test Loss: 0.257 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 30 cost time: 0.6833803653717041
Epoch: 30, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 4157190
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2768874168395996
Epoch: 1, Steps: 2 | Train Loss: 2.000 Vali Loss: 2.026 Vali Acc: 0.019 Test Loss: 2.026 Test Acc: 0.019
Validation loss decreased (inf --> -0.018498).  Saving model ...
Epoch: 2 cost time: 0.7986297607421875
Epoch: 2, Steps: 2 | Train Loss: 1.953 Vali Loss: 1.968 Vali Acc: 0.022 Test Loss: 1.968 Test Acc: 0.022
Validation loss decreased (-0.018498 --> -0.022203).  Saving model ...
Epoch: 3 cost time: 0.7916545867919922
Epoch: 3, Steps: 2 | Train Loss: 1.919 Vali Loss: 1.913 Vali Acc: 0.037 Test Loss: 1.913 Test Acc: 0.037
Validation loss decreased (-0.022203 --> -0.037018).  Saving model ...
Epoch: 4 cost time: 0.7436733245849609
Epoch: 4, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.839 Vali Acc: 0.089 Test Loss: 1.839 Test Acc: 0.089
Validation loss decreased (-0.037018 --> -0.088871).  Saving model ...
Epoch: 5 cost time: 0.9509856700897217
Epoch: 5, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.745 Vali Acc: 0.204 Test Loss: 1.745 Test Acc: 0.204
Validation loss decreased (-0.088871 --> -0.203686).  Saving model ...
Epoch: 6 cost time: 0.847285270690918
Epoch: 6, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.639 Vali Acc: 0.356 Test Loss: 1.639 Test Acc: 0.356
Validation loss decreased (-0.203686 --> -0.355539).  Saving model ...
Epoch: 7 cost time: 0.8672726154327393
Epoch: 7, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.523 Vali Acc: 0.500 Test Loss: 1.523 Test Acc: 0.500
Validation loss decreased (-0.355539 --> -0.499985).  Saving model ...
Epoch: 8 cost time: 0.8876769542694092
Epoch: 8, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.403 Vali Acc: 0.615 Test Loss: 1.403 Test Acc: 0.615
Validation loss decreased (-0.499985 --> -0.614801).  Saving model ...
Epoch: 9 cost time: 0.8855123519897461
Epoch: 9, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.284 Vali Acc: 0.689 Test Loss: 1.284 Test Acc: 0.689
Validation loss decreased (-0.614801 --> -0.688876).  Saving model ...
Epoch: 10 cost time: 0.8143405914306641
Epoch: 10, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.166 Vali Acc: 0.770 Test Loss: 1.166 Test Acc: 0.770
Validation loss decreased (-0.688876 --> -0.770359).  Saving model ...
Epoch: 11 cost time: 1.0008299350738525
Epoch: 11, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.054 Vali Acc: 0.811 Test Loss: 1.054 Test Acc: 0.811
Validation loss decreased (-0.770359 --> -0.811101).  Saving model ...
Epoch: 12 cost time: 0.8272485733032227
Epoch: 12, Steps: 2 | Train Loss: 0.849 Vali Loss: 0.947 Vali Acc: 0.826 Test Loss: 0.947 Test Acc: 0.826
Validation loss decreased (-0.811101 --> -0.825916).  Saving model ...
Epoch: 13 cost time: 0.8810267448425293
Epoch: 13, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.850 Vali Acc: 0.856 Test Loss: 0.850 Test Acc: 0.856
Validation loss decreased (-0.825916 --> -0.855547).  Saving model ...
Epoch: 14 cost time: 0.8833622932434082
Epoch: 14, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.760 Vali Acc: 0.874 Test Loss: 0.760 Test Acc: 0.874
Validation loss decreased (-0.855547 --> -0.874066).  Saving model ...
Epoch: 15 cost time: 0.8629391193389893
Epoch: 15, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.677 Vali Acc: 0.896 Test Loss: 0.677 Test Acc: 0.896
Validation loss decreased (-0.874066 --> -0.896290).  Saving model ...
Epoch: 16 cost time: 0.8859755992889404
Epoch: 16, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.601 Vali Acc: 0.907 Test Loss: 0.601 Test Acc: 0.907
Validation loss decreased (-0.896290 --> -0.907401).  Saving model ...
Epoch: 17 cost time: 0.8537783622741699
Epoch: 17, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.535 Vali Acc: 0.907 Test Loss: 0.535 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 18 cost time: 0.9171490669250488
Epoch: 18, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.479 Vali Acc: 0.915 Test Loss: 0.479 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 19 cost time: 0.9197955131530762
Epoch: 19, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.432 Vali Acc: 0.919 Test Loss: 0.432 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 20 cost time: 0.9392642974853516
Epoch: 20, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 21 cost time: 0.9000663757324219
Epoch: 21, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.360 Vali Acc: 0.915 Test Loss: 0.360 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8606386184692383
Epoch: 22, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.333 Vali Acc: 0.915 Test Loss: 0.333 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8714706897735596
Epoch: 23, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.309 Vali Acc: 0.919 Test Loss: 0.309 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9175386428833008
Epoch: 24, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.290 Vali Acc: 0.915 Test Loss: 0.290 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8461124897003174
Epoch: 25, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.276 Vali Acc: 0.915 Test Loss: 0.276 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8203845024108887
Epoch: 26, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.265 Vali Acc: 0.915 Test Loss: 0.265 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8606483936309814
Epoch: 27, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.257 Vali Acc: 0.915 Test Loss: 0.257 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8745002746582031
Epoch: 28, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.250 Vali Acc: 0.915 Test Loss: 0.250 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8839993476867676
Epoch: 29, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.245 Vali Acc: 0.915 Test Loss: 0.245 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8463916778564453
Epoch: 30, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922220).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 14087046
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1167991161346436
Epoch: 1, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.756 Vali Acc: 0.200 Test Loss: 1.756 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.5750126838684082
Epoch: 2, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.705 Vali Acc: 0.226 Test Loss: 1.705 Test Acc: 0.226
Validation loss decreased (-0.199982 --> -0.225909).  Saving model ...
Epoch: 3 cost time: 0.6920087337493896
Epoch: 3, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.660 Vali Acc: 0.289 Test Loss: 1.660 Test Acc: 0.289
Validation loss decreased (-0.225909 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 0.6589517593383789
Epoch: 4, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.600 Vali Acc: 0.356 Test Loss: 1.600 Test Acc: 0.356
Validation loss decreased (-0.288872 --> -0.355540).  Saving model ...
Epoch: 5 cost time: 0.5706262588500977
Epoch: 5, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.526 Vali Acc: 0.537 Test Loss: 1.526 Test Acc: 0.537
Validation loss decreased (-0.355540 --> -0.537022).  Saving model ...
Epoch: 6 cost time: 0.61728835105896
Epoch: 6, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.439 Vali Acc: 0.619 Test Loss: 1.439 Test Acc: 0.619
Validation loss decreased (-0.537022 --> -0.618504).  Saving model ...
Epoch: 7 cost time: 0.6217536926269531
Epoch: 7, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.346 Vali Acc: 0.656 Test Loss: 1.346 Test Acc: 0.656
Validation loss decreased (-0.618504 --> -0.655542).  Saving model ...
Epoch: 8 cost time: 0.5893161296844482
Epoch: 8, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.249 Vali Acc: 0.715 Test Loss: 1.249 Test Acc: 0.715
Validation loss decreased (-0.655542 --> -0.714802).  Saving model ...
Epoch: 9 cost time: 0.6226136684417725
Epoch: 9, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.150 Vali Acc: 0.741 Test Loss: 1.150 Test Acc: 0.741
Validation loss decreased (-0.714802 --> -0.740729).  Saving model ...
Epoch: 10 cost time: 0.6229524612426758
Epoch: 10, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.053 Vali Acc: 0.781 Test Loss: 1.053 Test Acc: 0.781
Validation loss decreased (-0.740729 --> -0.781471).  Saving model ...
Epoch: 11 cost time: 0.6044800281524658
Epoch: 11, Steps: 2 | Train Loss: 0.852 Vali Loss: 0.961 Vali Acc: 0.822 Test Loss: 0.961 Test Acc: 0.822
Validation loss decreased (-0.781471 --> -0.822213).  Saving model ...
Epoch: 12 cost time: 0.5355541706085205
Epoch: 12, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.874 Vali Acc: 0.848 Test Loss: 0.874 Test Acc: 0.848
Validation loss decreased (-0.822213 --> -0.848139).  Saving model ...
Epoch: 13 cost time: 0.6226820945739746
Epoch: 13, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.793 Vali Acc: 0.856 Test Loss: 0.793 Test Acc: 0.856
Validation loss decreased (-0.848139 --> -0.855548).  Saving model ...
Epoch: 14 cost time: 0.6420464515686035
Epoch: 14, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.720 Vali Acc: 0.878 Test Loss: 0.720 Test Acc: 0.878
Validation loss decreased (-0.855548 --> -0.877771).  Saving model ...
Epoch: 15 cost time: 0.5518877506256104
Epoch: 15, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.651 Vali Acc: 0.885 Test Loss: 0.651 Test Acc: 0.885
Validation loss decreased (-0.877771 --> -0.885179).  Saving model ...
Epoch: 16 cost time: 0.5655515193939209
Epoch: 16, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.588 Vali Acc: 0.896 Test Loss: 0.588 Test Acc: 0.896
Validation loss decreased (-0.885179 --> -0.896290).  Saving model ...
Epoch: 17 cost time: 0.5431828498840332
Epoch: 17, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.531 Vali Acc: 0.904 Test Loss: 0.531 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 18 cost time: 0.6648526191711426
Epoch: 18, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.481 Vali Acc: 0.907 Test Loss: 0.481 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907403).  Saving model ...
Epoch: 19 cost time: 0.5668611526489258
Epoch: 19, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.438 Vali Acc: 0.907 Test Loss: 0.438 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 20 cost time: 0.6564512252807617
Epoch: 20, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.401 Vali Acc: 0.907 Test Loss: 0.401 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 21 cost time: 0.5603909492492676
Epoch: 21, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.371 Vali Acc: 0.907 Test Loss: 0.371 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 22 cost time: 0.5399048328399658
Epoch: 22, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.346 Vali Acc: 0.907 Test Loss: 0.346 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 23 cost time: 0.5974118709564209
Epoch: 23, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.325 Vali Acc: 0.907 Test Loss: 0.325 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 24 cost time: 0.6511330604553223
Epoch: 24, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.308 Vali Acc: 0.907 Test Loss: 0.308 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 25 cost time: 0.606835126876831
Epoch: 25, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.293 Vali Acc: 0.904 Test Loss: 0.293 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.594059944152832
Epoch: 26, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.281 Vali Acc: 0.904 Test Loss: 0.281 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6099941730499268
Epoch: 27, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 28 cost time: 0.66135573387146
Epoch: 28, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.263 Vali Acc: 0.915 Test Loss: 0.263 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 29 cost time: 0.6169824600219727
Epoch: 29, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.256 Vali Acc: 0.919 Test Loss: 0.256 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 30 cost time: 0.5860447883605957
Epoch: 30, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 4157190
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6223068237304688
Epoch: 1, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.809 Vali Acc: 0.244 Test Loss: 1.809 Test Acc: 0.244
Validation loss decreased (inf --> -0.244426).  Saving model ...
Epoch: 2 cost time: 0.980820894241333
Epoch: 2, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.752 Vali Acc: 0.281 Test Loss: 1.752 Test Acc: 0.281
Validation loss decreased (-0.244426 --> -0.281464).  Saving model ...
Epoch: 3 cost time: 1.0703842639923096
Epoch: 3, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.702 Vali Acc: 0.326 Test Loss: 1.702 Test Acc: 0.326
Validation loss decreased (-0.281464 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 1.0245177745819092
Epoch: 4, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.639 Vali Acc: 0.400 Test Loss: 1.639 Test Acc: 0.400
Validation loss decreased (-0.325909 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 1.012199878692627
Epoch: 5, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.562 Vali Acc: 0.481 Test Loss: 1.562 Test Acc: 0.481
Validation loss decreased (-0.399984 --> -0.481466).  Saving model ...
Epoch: 6 cost time: 1.0344812870025635
Epoch: 6, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.474 Vali Acc: 0.596 Test Loss: 1.474 Test Acc: 0.596
Validation loss decreased (-0.481466 --> -0.596282).  Saving model ...
Epoch: 7 cost time: 1.0281195640563965
Epoch: 7, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.379 Vali Acc: 0.659 Test Loss: 1.379 Test Acc: 0.659
Validation loss decreased (-0.596282 --> -0.659245).  Saving model ...
Epoch: 8 cost time: 0.9791858196258545
Epoch: 8, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.280 Vali Acc: 0.733 Test Loss: 1.280 Test Acc: 0.733
Validation loss decreased (-0.659245 --> -0.733321).  Saving model ...
Epoch: 9 cost time: 0.9959278106689453
Epoch: 9, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.181 Vali Acc: 0.796 Test Loss: 1.181 Test Acc: 0.796
Validation loss decreased (-0.733321 --> -0.796284).  Saving model ...
Epoch: 10 cost time: 0.9530701637268066
Epoch: 10, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.085 Vali Acc: 0.837 Test Loss: 1.085 Test Acc: 0.837
Validation loss decreased (-0.796284 --> -0.837026).  Saving model ...
Epoch: 11 cost time: 0.9346849918365479
Epoch: 11, Steps: 2 | Train Loss: 0.937 Vali Loss: 0.993 Vali Acc: 0.852 Test Loss: 0.993 Test Acc: 0.852
Validation loss decreased (-0.837026 --> -0.851842).  Saving model ...
Epoch: 12 cost time: 1.0112345218658447
Epoch: 12, Steps: 2 | Train Loss: 0.864 Vali Loss: 0.906 Vali Acc: 0.874 Test Loss: 0.906 Test Acc: 0.874
Validation loss decreased (-0.851842 --> -0.874065).  Saving model ...
Epoch: 13 cost time: 0.8756961822509766
Epoch: 13, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.824 Vali Acc: 0.904 Test Loss: 0.824 Test Acc: 0.904
Validation loss decreased (-0.874065 --> -0.903695).  Saving model ...
Epoch: 14 cost time: 0.9881956577301025
Epoch: 14, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.747 Vali Acc: 0.915 Test Loss: 0.747 Test Acc: 0.915
Validation loss decreased (-0.903695 --> -0.914807).  Saving model ...
Epoch: 15 cost time: 0.9937617778778076
Epoch: 15, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.678 Vali Acc: 0.930 Test Loss: 0.678 Test Acc: 0.930
Validation loss decreased (-0.914807 --> -0.929623).  Saving model ...
Epoch: 16 cost time: 0.908867597579956
Epoch: 16, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.615 Vali Acc: 0.933 Test Loss: 0.615 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 17 cost time: 0.8652534484863281
Epoch: 17, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.556 Vali Acc: 0.933 Test Loss: 0.556 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 18 cost time: 1.0372529029846191
Epoch: 18, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.502 Vali Acc: 0.944 Test Loss: 0.502 Test Acc: 0.944
Validation loss decreased (-0.933328 --> -0.944439).  Saving model ...
Epoch: 19 cost time: 1.0292747020721436
Epoch: 19, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.454 Vali Acc: 0.937 Test Loss: 0.454 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0221569538116455
Epoch: 20, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.414 Vali Acc: 0.944 Test Loss: 0.414 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 21 cost time: 1.0128397941589355
Epoch: 21, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.379 Vali Acc: 0.941 Test Loss: 0.379 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0160701274871826
Epoch: 22, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.350 Vali Acc: 0.937 Test Loss: 0.350 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0345096588134766
Epoch: 23, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.325 Vali Acc: 0.937 Test Loss: 0.325 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9796974658966064
Epoch: 24, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.303 Vali Acc: 0.937 Test Loss: 0.303 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0044610500335693
Epoch: 25, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.0395379066467285
Epoch: 26, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.022447109222412
Epoch: 27, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 1.0695054531097412
Epoch: 28, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 1.0632009506225586
Epoch: 29, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0117583274841309
Epoch: 30, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.228 Vali Acc: 0.948 Test Loss: 0.228 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 7057158
model size : 28.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3326375484466553
Epoch: 1, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.740 Vali Acc: 0.252 Test Loss: 1.740 Test Acc: 0.252
Validation loss decreased (inf --> -0.251834).  Saving model ...
Epoch: 2 cost time: 0.7094202041625977
Epoch: 2, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.690 Vali Acc: 0.319 Test Loss: 1.690 Test Acc: 0.319
Validation loss decreased (-0.251834 --> -0.318502).  Saving model ...
Epoch: 3 cost time: 0.6888740062713623
Epoch: 3, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.644 Vali Acc: 0.381 Test Loss: 1.644 Test Acc: 0.381
Validation loss decreased (-0.318502 --> -0.381465).  Saving model ...
Epoch: 4 cost time: 0.802377462387085
Epoch: 4, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.586 Vali Acc: 0.430 Test Loss: 1.586 Test Acc: 0.430
Validation loss decreased (-0.381465 --> -0.429614).  Saving model ...
Epoch: 5 cost time: 0.6876616477966309
Epoch: 5, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.512 Vali Acc: 0.519 Test Loss: 1.512 Test Acc: 0.519
Validation loss decreased (-0.429614 --> -0.518503).  Saving model ...
Epoch: 6 cost time: 0.7033896446228027
Epoch: 6, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.427 Vali Acc: 0.593 Test Loss: 1.427 Test Acc: 0.593
Validation loss decreased (-0.518503 --> -0.592578).  Saving model ...
Epoch: 7 cost time: 0.6883881092071533
Epoch: 7, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.336 Vali Acc: 0.656 Test Loss: 1.336 Test Acc: 0.656
Validation loss decreased (-0.592578 --> -0.655542).  Saving model ...
Epoch: 8 cost time: 0.7037754058837891
Epoch: 8, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.241 Vali Acc: 0.707 Test Loss: 1.241 Test Acc: 0.707
Validation loss decreased (-0.655542 --> -0.707395).  Saving model ...
Epoch: 9 cost time: 0.7051634788513184
Epoch: 9, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.145 Vali Acc: 0.774 Test Loss: 1.145 Test Acc: 0.774
Validation loss decreased (-0.707395 --> -0.774063).  Saving model ...
Epoch: 10 cost time: 0.7147932052612305
Epoch: 10, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.048 Vali Acc: 0.833 Test Loss: 1.048 Test Acc: 0.833
Validation loss decreased (-0.774063 --> -0.833323).  Saving model ...
Epoch: 11 cost time: 0.6972794532775879
Epoch: 11, Steps: 2 | Train Loss: 0.897 Vali Loss: 0.957 Vali Acc: 0.867 Test Loss: 0.957 Test Acc: 0.867
Validation loss decreased (-0.833323 --> -0.866657).  Saving model ...
Epoch: 12 cost time: 0.7568774223327637
Epoch: 12, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.869 Vali Acc: 0.896 Test Loss: 0.869 Test Acc: 0.896
Validation loss decreased (-0.866657 --> -0.896288).  Saving model ...
Epoch: 13 cost time: 0.8295586109161377
Epoch: 13, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.786 Vali Acc: 0.907 Test Loss: 0.786 Test Acc: 0.907
Validation loss decreased (-0.896288 --> -0.907400).  Saving model ...
Epoch: 14 cost time: 0.73427414894104
Epoch: 14, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.710 Vali Acc: 0.915 Test Loss: 0.710 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914808).  Saving model ...
Epoch: 15 cost time: 0.7238943576812744
Epoch: 15, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.642 Vali Acc: 0.922 Test Loss: 0.642 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 16 cost time: 0.7034101486206055
Epoch: 16, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.580 Vali Acc: 0.922 Test Loss: 0.580 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 17 cost time: 0.7379846572875977
Epoch: 17, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.527 Vali Acc: 0.930 Test Loss: 0.527 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 18 cost time: 0.7754824161529541
Epoch: 18, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.481 Vali Acc: 0.926 Test Loss: 0.481 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6784605979919434
Epoch: 19, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.440 Vali Acc: 0.926 Test Loss: 0.440 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7114603519439697
Epoch: 20, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.405 Vali Acc: 0.926 Test Loss: 0.405 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.713909387588501
Epoch: 21, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.375 Vali Acc: 0.926 Test Loss: 0.375 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6819543838500977
Epoch: 22, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.350 Vali Acc: 0.930 Test Loss: 0.350 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929626).  Saving model ...
Epoch: 23 cost time: 0.718475341796875
Epoch: 23, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.329 Vali Acc: 0.930 Test Loss: 0.329 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 24 cost time: 0.70408034324646
Epoch: 24, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6952970027923584
Epoch: 25, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.297 Vali Acc: 0.926 Test Loss: 0.297 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.694800853729248
Epoch: 26, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.285 Vali Acc: 0.926 Test Loss: 0.285 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6917054653167725
Epoch: 27, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7521028518676758
Epoch: 28, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6943531036376953
Epoch: 29, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.260 Vali Acc: 0.926 Test Loss: 0.260 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6845598220825195
Epoch: 30, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.254 Vali Acc: 0.926 Test Loss: 0.254 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 2092038
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.225297689437866
Epoch: 1, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.809 Vali Acc: 0.244 Test Loss: 1.809 Test Acc: 0.244
Validation loss decreased (inf --> -0.244426).  Saving model ...
Epoch: 2 cost time: 0.7492983341217041
Epoch: 2, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.752 Vali Acc: 0.281 Test Loss: 1.752 Test Acc: 0.281
Validation loss decreased (-0.244426 --> -0.281464).  Saving model ...
Epoch: 3 cost time: 0.7956850528717041
Epoch: 3, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.702 Vali Acc: 0.326 Test Loss: 1.702 Test Acc: 0.326
Validation loss decreased (-0.281464 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 0.8138842582702637
Epoch: 4, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.639 Vali Acc: 0.400 Test Loss: 1.639 Test Acc: 0.400
Validation loss decreased (-0.325909 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 0.8005495071411133
Epoch: 5, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.562 Vali Acc: 0.481 Test Loss: 1.562 Test Acc: 0.481
Validation loss decreased (-0.399984 --> -0.481466).  Saving model ...
Epoch: 6 cost time: 0.8061380386352539
Epoch: 6, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.474 Vali Acc: 0.596 Test Loss: 1.474 Test Acc: 0.596
Validation loss decreased (-0.481466 --> -0.596282).  Saving model ...
Epoch: 7 cost time: 0.809628963470459
Epoch: 7, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.379 Vali Acc: 0.659 Test Loss: 1.379 Test Acc: 0.659
Validation loss decreased (-0.596282 --> -0.659245).  Saving model ...
Epoch: 8 cost time: 0.8484113216400146
Epoch: 8, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.280 Vali Acc: 0.733 Test Loss: 1.280 Test Acc: 0.733
Validation loss decreased (-0.659245 --> -0.733321).  Saving model ...
Epoch: 9 cost time: 0.838343620300293
Epoch: 9, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.181 Vali Acc: 0.796 Test Loss: 1.181 Test Acc: 0.796
Validation loss decreased (-0.733321 --> -0.796284).  Saving model ...
Epoch: 10 cost time: 0.8727774620056152
Epoch: 10, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.085 Vali Acc: 0.837 Test Loss: 1.085 Test Acc: 0.837
Validation loss decreased (-0.796284 --> -0.837026).  Saving model ...
Epoch: 11 cost time: 0.8605210781097412
Epoch: 11, Steps: 2 | Train Loss: 0.937 Vali Loss: 0.993 Vali Acc: 0.852 Test Loss: 0.993 Test Acc: 0.852
Validation loss decreased (-0.837026 --> -0.851842).  Saving model ...
Epoch: 12 cost time: 0.84623122215271
Epoch: 12, Steps: 2 | Train Loss: 0.864 Vali Loss: 0.906 Vali Acc: 0.874 Test Loss: 0.906 Test Acc: 0.874
Validation loss decreased (-0.851842 --> -0.874065).  Saving model ...
Epoch: 13 cost time: 0.8223414421081543
Epoch: 13, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.824 Vali Acc: 0.904 Test Loss: 0.824 Test Acc: 0.904
Validation loss decreased (-0.874065 --> -0.903695).  Saving model ...
Epoch: 14 cost time: 0.8320631980895996
Epoch: 14, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.747 Vali Acc: 0.915 Test Loss: 0.747 Test Acc: 0.915
Validation loss decreased (-0.903695 --> -0.914807).  Saving model ...
Epoch: 15 cost time: 0.9312465190887451
Epoch: 15, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.678 Vali Acc: 0.930 Test Loss: 0.678 Test Acc: 0.930
Validation loss decreased (-0.914807 --> -0.929623).  Saving model ...
Epoch: 16 cost time: 0.8362212181091309
Epoch: 16, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.615 Vali Acc: 0.933 Test Loss: 0.615 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 17 cost time: 0.8833322525024414
Epoch: 17, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.556 Vali Acc: 0.933 Test Loss: 0.556 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 18 cost time: 0.8493947982788086
Epoch: 18, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.502 Vali Acc: 0.944 Test Loss: 0.502 Test Acc: 0.944
Validation loss decreased (-0.933328 --> -0.944439).  Saving model ...
Epoch: 19 cost time: 0.8629517555236816
Epoch: 19, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.454 Vali Acc: 0.937 Test Loss: 0.454 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8020820617675781
Epoch: 20, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.414 Vali Acc: 0.944 Test Loss: 0.414 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 21 cost time: 0.8022561073303223
Epoch: 21, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.379 Vali Acc: 0.941 Test Loss: 0.379 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8749923706054688
Epoch: 22, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.350 Vali Acc: 0.937 Test Loss: 0.350 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8513247966766357
Epoch: 23, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.325 Vali Acc: 0.937 Test Loss: 0.325 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8581018447875977
Epoch: 24, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.303 Vali Acc: 0.937 Test Loss: 0.303 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9097068309783936
Epoch: 25, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.8842155933380127
Epoch: 26, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.8969604969024658
Epoch: 27, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.8969590663909912
Epoch: 28, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.7813122272491455
Epoch: 29, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7975943088531494
Epoch: 30, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.228 Vali Acc: 0.948 Test Loss: 0.228 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 7057158
model size : 28.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9298253059387207
Epoch: 1, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.740 Vali Acc: 0.252 Test Loss: 1.740 Test Acc: 0.252
Validation loss decreased (inf --> -0.251834).  Saving model ...
Epoch: 2 cost time: 0.6083872318267822
Epoch: 2, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.690 Vali Acc: 0.319 Test Loss: 1.690 Test Acc: 0.319
Validation loss decreased (-0.251834 --> -0.318502).  Saving model ...
Epoch: 3 cost time: 0.5347385406494141
Epoch: 3, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.644 Vali Acc: 0.381 Test Loss: 1.644 Test Acc: 0.381
Validation loss decreased (-0.318502 --> -0.381465).  Saving model ...
Epoch: 4 cost time: 0.552656888961792
Epoch: 4, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.586 Vali Acc: 0.430 Test Loss: 1.586 Test Acc: 0.430
Validation loss decreased (-0.381465 --> -0.429614).  Saving model ...
Epoch: 5 cost time: 0.5366053581237793
Epoch: 5, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.512 Vali Acc: 0.519 Test Loss: 1.512 Test Acc: 0.519
Validation loss decreased (-0.429614 --> -0.518503).  Saving model ...
Epoch: 6 cost time: 0.5787224769592285
Epoch: 6, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.427 Vali Acc: 0.593 Test Loss: 1.427 Test Acc: 0.593
Validation loss decreased (-0.518503 --> -0.592578).  Saving model ...
Epoch: 7 cost time: 0.5880963802337646
Epoch: 7, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.336 Vali Acc: 0.656 Test Loss: 1.336 Test Acc: 0.656
Validation loss decreased (-0.592578 --> -0.655542).  Saving model ...
Epoch: 8 cost time: 0.5770096778869629
Epoch: 8, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.241 Vali Acc: 0.707 Test Loss: 1.241 Test Acc: 0.707
Validation loss decreased (-0.655542 --> -0.707395).  Saving model ...
Epoch: 9 cost time: 0.5348522663116455
Epoch: 9, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.145 Vali Acc: 0.774 Test Loss: 1.145 Test Acc: 0.774
Validation loss decreased (-0.707395 --> -0.774063).  Saving model ...
Epoch: 10 cost time: 0.5807638168334961
Epoch: 10, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.048 Vali Acc: 0.833 Test Loss: 1.048 Test Acc: 0.833
Validation loss decreased (-0.774063 --> -0.833323).  Saving model ...
Epoch: 11 cost time: 0.6750185489654541
Epoch: 11, Steps: 2 | Train Loss: 0.897 Vali Loss: 0.957 Vali Acc: 0.867 Test Loss: 0.957 Test Acc: 0.867
Validation loss decreased (-0.833323 --> -0.866657).  Saving model ...
Epoch: 12 cost time: 0.5831329822540283
Epoch: 12, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.869 Vali Acc: 0.896 Test Loss: 0.869 Test Acc: 0.896
Validation loss decreased (-0.866657 --> -0.896288).  Saving model ...
Epoch: 13 cost time: 0.5957798957824707
Epoch: 13, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.786 Vali Acc: 0.907 Test Loss: 0.786 Test Acc: 0.907
Validation loss decreased (-0.896288 --> -0.907400).  Saving model ...
Epoch: 14 cost time: 0.5499317646026611
Epoch: 14, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.710 Vali Acc: 0.915 Test Loss: 0.710 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914808).  Saving model ...
Epoch: 15 cost time: 0.6127851009368896
Epoch: 15, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.642 Vali Acc: 0.922 Test Loss: 0.642 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 16 cost time: 0.6324057579040527
Epoch: 16, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.580 Vali Acc: 0.922 Test Loss: 0.580 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 17 cost time: 0.5819120407104492
Epoch: 17, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.527 Vali Acc: 0.930 Test Loss: 0.527 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 18 cost time: 0.5817921161651611
Epoch: 18, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.481 Vali Acc: 0.926 Test Loss: 0.481 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5652928352355957
Epoch: 19, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.440 Vali Acc: 0.926 Test Loss: 0.440 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5623559951782227
Epoch: 20, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.405 Vali Acc: 0.926 Test Loss: 0.405 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5377318859100342
Epoch: 21, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.375 Vali Acc: 0.926 Test Loss: 0.375 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5534849166870117
Epoch: 22, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.350 Vali Acc: 0.930 Test Loss: 0.350 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929626).  Saving model ...
Epoch: 23 cost time: 0.5671253204345703
Epoch: 23, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.329 Vali Acc: 0.930 Test Loss: 0.329 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 24 cost time: 0.5410521030426025
Epoch: 24, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5674822330474854
Epoch: 25, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.297 Vali Acc: 0.926 Test Loss: 0.297 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5540239810943604
Epoch: 26, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.285 Vali Acc: 0.926 Test Loss: 0.285 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6226327419281006
Epoch: 27, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5952675342559814
Epoch: 28, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5285959243774414
Epoch: 29, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.260 Vali Acc: 0.926 Test Loss: 0.260 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6132113933563232
Epoch: 30, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.254 Vali Acc: 0.926 Test Loss: 0.254 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 2092038
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2619540691375732
Epoch: 1, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.809 Vali Acc: 0.244 Test Loss: 1.809 Test Acc: 0.244
Validation loss decreased (inf --> -0.244426).  Saving model ...
Epoch: 2 cost time: 0.6273090839385986
Epoch: 2, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.752 Vali Acc: 0.281 Test Loss: 1.752 Test Acc: 0.281
Validation loss decreased (-0.244426 --> -0.281464).  Saving model ...
Epoch: 3 cost time: 0.6541333198547363
Epoch: 3, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.701 Vali Acc: 0.326 Test Loss: 1.701 Test Acc: 0.326
Validation loss decreased (-0.281464 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 0.6180884838104248
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.639 Vali Acc: 0.400 Test Loss: 1.639 Test Acc: 0.400
Validation loss decreased (-0.325909 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 0.6432738304138184
Epoch: 5, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.563 Vali Acc: 0.481 Test Loss: 1.563 Test Acc: 0.481
Validation loss decreased (-0.399984 --> -0.481466).  Saving model ...
Epoch: 6 cost time: 0.577984094619751
Epoch: 6, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.476 Vali Acc: 0.593 Test Loss: 1.476 Test Acc: 0.593
Validation loss decreased (-0.481466 --> -0.592578).  Saving model ...
Epoch: 7 cost time: 0.6312777996063232
Epoch: 7, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.381 Vali Acc: 0.659 Test Loss: 1.381 Test Acc: 0.659
Validation loss decreased (-0.592578 --> -0.659245).  Saving model ...
Epoch: 8 cost time: 0.5513765811920166
Epoch: 8, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.283 Vali Acc: 0.733 Test Loss: 1.283 Test Acc: 0.733
Validation loss decreased (-0.659245 --> -0.733321).  Saving model ...
Epoch: 9 cost time: 0.5969667434692383
Epoch: 9, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.184 Vali Acc: 0.793 Test Loss: 1.184 Test Acc: 0.793
Validation loss decreased (-0.733321 --> -0.792581).  Saving model ...
Epoch: 10 cost time: 0.6179332733154297
Epoch: 10, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.089 Vali Acc: 0.837 Test Loss: 1.089 Test Acc: 0.837
Validation loss decreased (-0.792581 --> -0.837026).  Saving model ...
Epoch: 11 cost time: 0.5811219215393066
Epoch: 11, Steps: 2 | Train Loss: 0.957 Vali Loss: 0.997 Vali Acc: 0.852 Test Loss: 0.997 Test Acc: 0.852
Validation loss decreased (-0.837026 --> -0.851842).  Saving model ...
Epoch: 12 cost time: 0.578542947769165
Epoch: 12, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.910 Vali Acc: 0.878 Test Loss: 0.910 Test Acc: 0.878
Validation loss decreased (-0.851842 --> -0.877769).  Saving model ...
Epoch: 13 cost time: 0.5931594371795654
Epoch: 13, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.827 Vali Acc: 0.904 Test Loss: 0.827 Test Acc: 0.904
Validation loss decreased (-0.877769 --> -0.903695).  Saving model ...
Epoch: 14 cost time: 0.5875060558319092
Epoch: 14, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.751 Vali Acc: 0.919 Test Loss: 0.751 Test Acc: 0.919
Validation loss decreased (-0.903695 --> -0.918511).  Saving model ...
Epoch: 15 cost time: 0.5563359260559082
Epoch: 15, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.681 Vali Acc: 0.930 Test Loss: 0.681 Test Acc: 0.930
Validation loss decreased (-0.918511 --> -0.929623).  Saving model ...
Epoch: 16 cost time: 0.5711853504180908
Epoch: 16, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.618 Vali Acc: 0.933 Test Loss: 0.618 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 17 cost time: 0.5813333988189697
Epoch: 17, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.558 Vali Acc: 0.933 Test Loss: 0.558 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 18 cost time: 0.5794591903686523
Epoch: 18, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.504 Vali Acc: 0.944 Test Loss: 0.504 Test Acc: 0.944
Validation loss decreased (-0.933328 --> -0.944439).  Saving model ...
Epoch: 19 cost time: 0.5937108993530273
Epoch: 19, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.456 Vali Acc: 0.937 Test Loss: 0.456 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.580317497253418
Epoch: 20, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.415 Vali Acc: 0.944 Test Loss: 0.415 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 21 cost time: 0.603945255279541
Epoch: 21, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.381 Vali Acc: 0.941 Test Loss: 0.381 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5743250846862793
Epoch: 22, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.351 Vali Acc: 0.937 Test Loss: 0.351 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5608108043670654
Epoch: 23, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.327 Vali Acc: 0.937 Test Loss: 0.327 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6298332214355469
Epoch: 24, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.305 Vali Acc: 0.937 Test Loss: 0.305 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6293389797210693
Epoch: 25, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6018221378326416
Epoch: 26, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5875499248504639
Epoch: 27, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6306097507476807
Epoch: 28, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.246 Vali Acc: 0.948 Test Loss: 0.246 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.5827507972717285
Epoch: 29, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.5912420749664307
Epoch: 30, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 7057158
model size : 28.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.279170036315918
Epoch: 1, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.739 Vali Acc: 0.252 Test Loss: 1.739 Test Acc: 0.252
Validation loss decreased (inf --> -0.251834).  Saving model ...
Epoch: 2 cost time: 0.5145981311798096
Epoch: 2, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.688 Vali Acc: 0.319 Test Loss: 1.688 Test Acc: 0.319
Validation loss decreased (-0.251834 --> -0.318502).  Saving model ...
Epoch: 3 cost time: 0.5760879516601562
Epoch: 3, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.643 Vali Acc: 0.381 Test Loss: 1.643 Test Acc: 0.381
Validation loss decreased (-0.318502 --> -0.381465).  Saving model ...
Epoch: 4 cost time: 0.49365830421447754
Epoch: 4, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.586 Vali Acc: 0.430 Test Loss: 1.586 Test Acc: 0.430
Validation loss decreased (-0.381465 --> -0.429614).  Saving model ...
Epoch: 5 cost time: 0.5441107749938965
Epoch: 5, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.514 Vali Acc: 0.519 Test Loss: 1.514 Test Acc: 0.519
Validation loss decreased (-0.429614 --> -0.518503).  Saving model ...
Epoch: 6 cost time: 0.5501916408538818
Epoch: 6, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.431 Vali Acc: 0.593 Test Loss: 1.431 Test Acc: 0.593
Validation loss decreased (-0.518503 --> -0.592578).  Saving model ...
Epoch: 7 cost time: 0.5060813426971436
Epoch: 7, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.341 Vali Acc: 0.652 Test Loss: 1.341 Test Acc: 0.652
Validation loss decreased (-0.592578 --> -0.651838).  Saving model ...
Epoch: 8 cost time: 0.5092756748199463
Epoch: 8, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.248 Vali Acc: 0.700 Test Loss: 1.248 Test Acc: 0.700
Validation loss decreased (-0.651838 --> -0.699988).  Saving model ...
Epoch: 9 cost time: 0.575270414352417
Epoch: 9, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.153 Vali Acc: 0.770 Test Loss: 1.153 Test Acc: 0.770
Validation loss decreased (-0.699988 --> -0.770359).  Saving model ...
Epoch: 10 cost time: 0.5763580799102783
Epoch: 10, Steps: 2 | Train Loss: 0.960 Vali Loss: 1.058 Vali Acc: 0.822 Test Loss: 1.058 Test Acc: 0.822
Validation loss decreased (-0.770359 --> -0.822212).  Saving model ...
Epoch: 11 cost time: 0.5963428020477295
Epoch: 11, Steps: 2 | Train Loss: 0.925 Vali Loss: 0.967 Vali Acc: 0.859 Test Loss: 0.967 Test Acc: 0.859
Validation loss decreased (-0.822212 --> -0.859250).  Saving model ...
Epoch: 12 cost time: 0.546799898147583
Epoch: 12, Steps: 2 | Train Loss: 0.781 Vali Loss: 0.879 Vali Acc: 0.889 Test Loss: 0.879 Test Acc: 0.889
Validation loss decreased (-0.859250 --> -0.888880).  Saving model ...
Epoch: 13 cost time: 0.542494535446167
Epoch: 13, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.796 Vali Acc: 0.904 Test Loss: 0.796 Test Acc: 0.904
Validation loss decreased (-0.888880 --> -0.903696).  Saving model ...
Epoch: 14 cost time: 0.6187548637390137
Epoch: 14, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.719 Vali Acc: 0.915 Test Loss: 0.719 Test Acc: 0.915
Validation loss decreased (-0.903696 --> -0.914808).  Saving model ...
Epoch: 15 cost time: 0.5834441184997559
Epoch: 15, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.649 Vali Acc: 0.930 Test Loss: 0.649 Test Acc: 0.930
Validation loss decreased (-0.914808 --> -0.929623).  Saving model ...
Epoch: 16 cost time: 0.5629382133483887
Epoch: 16, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.586 Vali Acc: 0.933 Test Loss: 0.586 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 17 cost time: 0.5482683181762695
Epoch: 17, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.531 Vali Acc: 0.937 Test Loss: 0.531 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937032).  Saving model ...
Epoch: 18 cost time: 0.5545659065246582
Epoch: 18, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.483 Vali Acc: 0.933 Test Loss: 0.483 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5260286331176758
Epoch: 19, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.440 Vali Acc: 0.933 Test Loss: 0.440 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5598690509796143
Epoch: 20, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.403 Vali Acc: 0.937 Test Loss: 0.403 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 21 cost time: 0.6304671764373779
Epoch: 21, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.372 Vali Acc: 0.937 Test Loss: 0.372 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 22 cost time: 0.5709140300750732
Epoch: 22, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.346 Vali Acc: 0.941 Test Loss: 0.346 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 23 cost time: 0.5325636863708496
Epoch: 23, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.324 Vali Acc: 0.941 Test Loss: 0.324 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 24 cost time: 0.5386819839477539
Epoch: 24, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.305 Vali Acc: 0.937 Test Loss: 0.305 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5671646595001221
Epoch: 25, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5013391971588135
Epoch: 26, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5176506042480469
Epoch: 27, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5493066310882568
Epoch: 28, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5612630844116211
Epoch: 29, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5409374237060547
Epoch: 30, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 2092038
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5883476734161377
Epoch: 1, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.750 Vali Acc: 0.348 Test Loss: 1.750 Test Acc: 0.348
Validation loss decreased (inf --> -0.348131).  Saving model ...
Epoch: 2 cost time: 0.9790360927581787
Epoch: 2, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.713 Vali Acc: 0.378 Test Loss: 1.713 Test Acc: 0.378
Validation loss decreased (-0.348131 --> -0.377761).  Saving model ...
Epoch: 3 cost time: 0.9910330772399902
Epoch: 3, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.683 Vali Acc: 0.385 Test Loss: 1.683 Test Acc: 0.385
Validation loss decreased (-0.377761 --> -0.385168).  Saving model ...
Epoch: 4 cost time: 0.9545214176177979
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.648 Vali Acc: 0.419 Test Loss: 1.648 Test Acc: 0.419
Validation loss decreased (-0.385168 --> -0.418502).  Saving model ...
Epoch: 5 cost time: 0.9866070747375488
Epoch: 5, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.604 Vali Acc: 0.444 Test Loss: 1.604 Test Acc: 0.444
Validation loss decreased (-0.418502 --> -0.444428).  Saving model ...
Epoch: 6 cost time: 0.9344832897186279
Epoch: 6, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.553 Vali Acc: 0.496 Test Loss: 1.553 Test Acc: 0.496
Validation loss decreased (-0.444428 --> -0.496281).  Saving model ...
Epoch: 7 cost time: 0.7289800643920898
Epoch: 7, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.496 Vali Acc: 0.559 Test Loss: 1.496 Test Acc: 0.559
Validation loss decreased (-0.496281 --> -0.559244).  Saving model ...
Epoch: 8 cost time: 0.7834920883178711
Epoch: 8, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.435 Vali Acc: 0.607 Test Loss: 1.435 Test Acc: 0.607
Validation loss decreased (-0.559244 --> -0.607393).  Saving model ...
Epoch: 9 cost time: 0.80112624168396
Epoch: 9, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.372 Vali Acc: 0.641 Test Loss: 1.372 Test Acc: 0.641
Validation loss decreased (-0.607393 --> -0.640727).  Saving model ...
Epoch: 10 cost time: 0.8017516136169434
Epoch: 10, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.307 Vali Acc: 0.689 Test Loss: 1.307 Test Acc: 0.689
Validation loss decreased (-0.640727 --> -0.688876).  Saving model ...
Epoch: 11 cost time: 0.9616990089416504
Epoch: 11, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.241 Vali Acc: 0.700 Test Loss: 1.241 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 1.0689806938171387
Epoch: 12, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.175 Vali Acc: 0.737 Test Loss: 1.175 Test Acc: 0.737
Validation loss decreased (-0.699988 --> -0.737025).  Saving model ...
Epoch: 13 cost time: 1.0104844570159912
Epoch: 13, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.109 Vali Acc: 0.756 Test Loss: 1.109 Test Acc: 0.756
Validation loss decreased (-0.737025 --> -0.755544).  Saving model ...
Epoch: 14 cost time: 0.9996762275695801
Epoch: 14, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.045 Vali Acc: 0.793 Test Loss: 1.045 Test Acc: 0.793
Validation loss decreased (-0.755544 --> -0.792582).  Saving model ...
Epoch: 15 cost time: 1.0124924182891846
Epoch: 15, Steps: 2 | Train Loss: 0.911 Vali Loss: 0.982 Vali Acc: 0.804 Test Loss: 0.982 Test Acc: 0.804
Validation loss decreased (-0.792582 --> -0.803694).  Saving model ...
Epoch: 16 cost time: 0.9949262142181396
Epoch: 16, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.920 Vali Acc: 0.830 Test Loss: 0.920 Test Acc: 0.830
Validation loss decreased (-0.803694 --> -0.829620).  Saving model ...
Epoch: 17 cost time: 1.083890438079834
Epoch: 17, Steps: 2 | Train Loss: 0.735 Vali Loss: 0.862 Vali Acc: 0.856 Test Loss: 0.862 Test Acc: 0.856
Validation loss decreased (-0.829620 --> -0.855547).  Saving model ...
Epoch: 18 cost time: 1.0568180084228516
Epoch: 18, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.809 Vali Acc: 0.859 Test Loss: 0.809 Test Acc: 0.859
Validation loss decreased (-0.855547 --> -0.859251).  Saving model ...
Epoch: 19 cost time: 1.01289963722229
Epoch: 19, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.757 Vali Acc: 0.867 Test Loss: 0.757 Test Acc: 0.867
Validation loss decreased (-0.859251 --> -0.866659).  Saving model ...
Epoch: 20 cost time: 0.9669690132141113
Epoch: 20, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.708 Vali Acc: 0.867 Test Loss: 0.708 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866660).  Saving model ...
Epoch: 21 cost time: 0.9432783126831055
Epoch: 21, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.662 Vali Acc: 0.867 Test Loss: 0.662 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 22 cost time: 0.9462385177612305
Epoch: 22, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.618 Vali Acc: 0.878 Test Loss: 0.618 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 0.9680652618408203
Epoch: 23, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.577 Vali Acc: 0.881 Test Loss: 0.577 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 24 cost time: 0.9999747276306152
Epoch: 24, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9362409114837646
Epoch: 25, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.507 Vali Acc: 0.874 Test Loss: 0.507 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.947746992111206
Epoch: 26, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.478 Vali Acc: 0.881 Test Loss: 0.478 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881477).  Saving model ...
Epoch: 27 cost time: 1.0101649761199951
Epoch: 27, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.453 Vali Acc: 0.881 Test Loss: 0.453 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 28 cost time: 0.9726681709289551
Epoch: 28, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.431 Vali Acc: 0.881 Test Loss: 0.431 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 29 cost time: 1.0144128799438477
Epoch: 29, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.411 Vali Acc: 0.881 Test Loss: 0.411 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 30 cost time: 0.935359001159668
Epoch: 30, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.881477 --> -0.888885).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8888888888888888
model parameter : 7044678
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2485039234161377
Epoch: 1, Steps: 2 | Train Loss: 2.093 Vali Loss: 1.992 Vali Acc: 0.104 Test Loss: 1.992 Test Acc: 0.104
Validation loss decreased (inf --> -0.103684).  Saving model ...
Epoch: 2 cost time: 0.6989061832427979
Epoch: 2, Steps: 2 | Train Loss: 2.018 Vali Loss: 1.950 Vali Acc: 0.122 Test Loss: 1.950 Test Acc: 0.122
Validation loss decreased (-0.103684 --> -0.122203).  Saving model ...
Epoch: 3 cost time: 0.6899785995483398
Epoch: 3, Steps: 2 | Train Loss: 1.974 Vali Loss: 1.916 Vali Acc: 0.130 Test Loss: 1.916 Test Acc: 0.130
Validation loss decreased (-0.122203 --> -0.129610).  Saving model ...
Epoch: 4 cost time: 0.7286257743835449
Epoch: 4, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.878 Vali Acc: 0.156 Test Loss: 1.878 Test Acc: 0.156
Validation loss decreased (-0.129610 --> -0.155537).  Saving model ...
Epoch: 5 cost time: 0.7179231643676758
Epoch: 5, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.831 Vali Acc: 0.185 Test Loss: 1.831 Test Acc: 0.185
Validation loss decreased (-0.155537 --> -0.185167).  Saving model ...
Epoch: 6 cost time: 0.7037796974182129
Epoch: 6, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.775 Vali Acc: 0.233 Test Loss: 1.775 Test Acc: 0.233
Validation loss decreased (-0.185167 --> -0.233316).  Saving model ...
Epoch: 7 cost time: 0.7463157176971436
Epoch: 7, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.712 Vali Acc: 0.263 Test Loss: 1.712 Test Acc: 0.263
Validation loss decreased (-0.233316 --> -0.262946).  Saving model ...
Epoch: 8 cost time: 0.7492897510528564
Epoch: 8, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.645 Vali Acc: 0.330 Test Loss: 1.645 Test Acc: 0.330
Validation loss decreased (-0.262946 --> -0.329613).  Saving model ...
Epoch: 9 cost time: 0.7087907791137695
Epoch: 9, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.575 Vali Acc: 0.411 Test Loss: 1.575 Test Acc: 0.411
Validation loss decreased (-0.329613 --> -0.411095).  Saving model ...
Epoch: 10 cost time: 0.6795516014099121
Epoch: 10, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.502 Vali Acc: 0.500 Test Loss: 1.502 Test Acc: 0.500
Validation loss decreased (-0.411095 --> -0.499985).  Saving model ...
Epoch: 11 cost time: 0.7288596630096436
Epoch: 11, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.430 Vali Acc: 0.578 Test Loss: 1.430 Test Acc: 0.578
Validation loss decreased (-0.499985 --> -0.577763).  Saving model ...
Epoch: 12 cost time: 0.7040746212005615
Epoch: 12, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.357 Vali Acc: 0.659 Test Loss: 1.357 Test Acc: 0.659
Validation loss decreased (-0.577763 --> -0.659246).  Saving model ...
Epoch: 13 cost time: 0.6992800235748291
Epoch: 13, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.284 Vali Acc: 0.737 Test Loss: 1.284 Test Acc: 0.737
Validation loss decreased (-0.659246 --> -0.737024).  Saving model ...
Epoch: 14 cost time: 0.6892378330230713
Epoch: 14, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.211 Vali Acc: 0.774 Test Loss: 1.211 Test Acc: 0.774
Validation loss decreased (-0.737024 --> -0.774062).  Saving model ...
Epoch: 15 cost time: 0.702639102935791
Epoch: 15, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.140 Vali Acc: 0.815 Test Loss: 1.140 Test Acc: 0.815
Validation loss decreased (-0.774062 --> -0.814803).  Saving model ...
Epoch: 16 cost time: 0.7197847366333008
Epoch: 16, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.073 Vali Acc: 0.826 Test Loss: 1.073 Test Acc: 0.826
Validation loss decreased (-0.814803 --> -0.825915).  Saving model ...
Epoch: 17 cost time: 0.7514369487762451
Epoch: 17, Steps: 2 | Train Loss: 0.897 Vali Loss: 1.007 Vali Acc: 0.841 Test Loss: 1.007 Test Acc: 0.841
Validation loss decreased (-0.825915 --> -0.840731).  Saving model ...
Epoch: 18 cost time: 0.7308351993560791
Epoch: 18, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.946 Vali Acc: 0.848 Test Loss: 0.946 Test Acc: 0.848
Validation loss decreased (-0.840731 --> -0.848139).  Saving model ...
Epoch: 19 cost time: 0.8143584728240967
Epoch: 19, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.888 Vali Acc: 0.848 Test Loss: 0.888 Test Acc: 0.848
Validation loss decreased (-0.848139 --> -0.848139).  Saving model ...
Epoch: 20 cost time: 0.7304470539093018
Epoch: 20, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.833 Vali Acc: 0.856 Test Loss: 0.833 Test Acc: 0.856
Validation loss decreased (-0.848139 --> -0.855547).  Saving model ...
Epoch: 21 cost time: 0.7124021053314209
Epoch: 21, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.782 Vali Acc: 0.867 Test Loss: 0.782 Test Acc: 0.867
Validation loss decreased (-0.855547 --> -0.866659).  Saving model ...
Epoch: 22 cost time: 0.7097530364990234
Epoch: 22, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.734 Vali Acc: 0.867 Test Loss: 0.734 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 23 cost time: 0.7357285022735596
Epoch: 23, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.688 Vali Acc: 0.867 Test Loss: 0.688 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866660).  Saving model ...
Epoch: 24 cost time: 0.7191579341888428
Epoch: 24, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.647 Vali Acc: 0.870 Test Loss: 0.647 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 25 cost time: 0.7229855060577393
Epoch: 25, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.608 Vali Acc: 0.878 Test Loss: 0.608 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 0.7032201290130615
Epoch: 26, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.573 Vali Acc: 0.885 Test Loss: 0.573 Test Acc: 0.885
Validation loss decreased (-0.877772 --> -0.885179).  Saving model ...
Epoch: 27 cost time: 0.7754428386688232
Epoch: 27, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.541 Vali Acc: 0.885 Test Loss: 0.541 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885180).  Saving model ...
Epoch: 28 cost time: 0.7054634094238281
Epoch: 28, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.513 Vali Acc: 0.889 Test Loss: 0.513 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 29 cost time: 0.7440235614776611
Epoch: 29, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 30 cost time: 0.7079901695251465
Epoch: 30, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.465 Vali Acc: 0.889 Test Loss: 0.465 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8888888888888888
model parameter : 2079366
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.445042610168457
Epoch: 1, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.750 Vali Acc: 0.348 Test Loss: 1.750 Test Acc: 0.348
Validation loss decreased (inf --> -0.348131).  Saving model ...
Epoch: 2 cost time: 0.8095383644104004
Epoch: 2, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.713 Vali Acc: 0.378 Test Loss: 1.713 Test Acc: 0.378
Validation loss decreased (-0.348131 --> -0.377761).  Saving model ...
Epoch: 3 cost time: 0.8242113590240479
Epoch: 3, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.683 Vali Acc: 0.385 Test Loss: 1.683 Test Acc: 0.385
Validation loss decreased (-0.377761 --> -0.385168).  Saving model ...
Epoch: 4 cost time: 0.7658007144927979
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.648 Vali Acc: 0.419 Test Loss: 1.648 Test Acc: 0.419
Validation loss decreased (-0.385168 --> -0.418502).  Saving model ...
Epoch: 5 cost time: 0.809659481048584
Epoch: 5, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.604 Vali Acc: 0.444 Test Loss: 1.604 Test Acc: 0.444
Validation loss decreased (-0.418502 --> -0.444428).  Saving model ...
Epoch: 6 cost time: 0.8751089572906494
Epoch: 6, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.553 Vali Acc: 0.496 Test Loss: 1.553 Test Acc: 0.496
Validation loss decreased (-0.444428 --> -0.496281).  Saving model ...
Epoch: 7 cost time: 0.8224844932556152
Epoch: 7, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.496 Vali Acc: 0.559 Test Loss: 1.496 Test Acc: 0.559
Validation loss decreased (-0.496281 --> -0.559244).  Saving model ...
Epoch: 8 cost time: 0.899543285369873
Epoch: 8, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.435 Vali Acc: 0.607 Test Loss: 1.435 Test Acc: 0.607
Validation loss decreased (-0.559244 --> -0.607393).  Saving model ...
Epoch: 9 cost time: 0.8934047222137451
Epoch: 9, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.372 Vali Acc: 0.641 Test Loss: 1.372 Test Acc: 0.641
Validation loss decreased (-0.607393 --> -0.640727).  Saving model ...
Epoch: 10 cost time: 0.96256422996521
Epoch: 10, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.307 Vali Acc: 0.689 Test Loss: 1.307 Test Acc: 0.689
Validation loss decreased (-0.640727 --> -0.688876).  Saving model ...
Epoch: 11 cost time: 0.8826820850372314
Epoch: 11, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.241 Vali Acc: 0.700 Test Loss: 1.241 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 0.9098696708679199
Epoch: 12, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.175 Vali Acc: 0.737 Test Loss: 1.175 Test Acc: 0.737
Validation loss decreased (-0.699988 --> -0.737025).  Saving model ...
Epoch: 13 cost time: 0.8620681762695312
Epoch: 13, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.109 Vali Acc: 0.756 Test Loss: 1.109 Test Acc: 0.756
Validation loss decreased (-0.737025 --> -0.755544).  Saving model ...
Epoch: 14 cost time: 0.8758068084716797
Epoch: 14, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.045 Vali Acc: 0.793 Test Loss: 1.045 Test Acc: 0.793
Validation loss decreased (-0.755544 --> -0.792582).  Saving model ...
Epoch: 15 cost time: 0.9005575180053711
Epoch: 15, Steps: 2 | Train Loss: 0.911 Vali Loss: 0.982 Vali Acc: 0.804 Test Loss: 0.982 Test Acc: 0.804
Validation loss decreased (-0.792582 --> -0.803694).  Saving model ...
Epoch: 16 cost time: 0.8307013511657715
Epoch: 16, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.920 Vali Acc: 0.830 Test Loss: 0.920 Test Acc: 0.830
Validation loss decreased (-0.803694 --> -0.829620).  Saving model ...
Epoch: 17 cost time: 0.8424506187438965
Epoch: 17, Steps: 2 | Train Loss: 0.735 Vali Loss: 0.862 Vali Acc: 0.856 Test Loss: 0.862 Test Acc: 0.856
Validation loss decreased (-0.829620 --> -0.855547).  Saving model ...
Epoch: 18 cost time: 0.85982346534729
Epoch: 18, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.809 Vali Acc: 0.859 Test Loss: 0.809 Test Acc: 0.859
Validation loss decreased (-0.855547 --> -0.859251).  Saving model ...
Epoch: 19 cost time: 0.8524892330169678
Epoch: 19, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.757 Vali Acc: 0.867 Test Loss: 0.757 Test Acc: 0.867
Validation loss decreased (-0.859251 --> -0.866659).  Saving model ...
Epoch: 20 cost time: 0.8359336853027344
Epoch: 20, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.708 Vali Acc: 0.867 Test Loss: 0.708 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866660).  Saving model ...
Epoch: 21 cost time: 0.8643617630004883
Epoch: 21, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.662 Vali Acc: 0.867 Test Loss: 0.662 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 22 cost time: 0.8958616256713867
Epoch: 22, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.618 Vali Acc: 0.878 Test Loss: 0.618 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 0.8108980655670166
Epoch: 23, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.577 Vali Acc: 0.881 Test Loss: 0.577 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 24 cost time: 0.8361845016479492
Epoch: 24, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7961916923522949
Epoch: 25, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.507 Vali Acc: 0.874 Test Loss: 0.507 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8049623966217041
Epoch: 26, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.478 Vali Acc: 0.881 Test Loss: 0.478 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881477).  Saving model ...
Epoch: 27 cost time: 0.8386077880859375
Epoch: 27, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.453 Vali Acc: 0.881 Test Loss: 0.453 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 28 cost time: 0.8216228485107422
Epoch: 28, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.431 Vali Acc: 0.881 Test Loss: 0.431 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 29 cost time: 0.8090181350708008
Epoch: 29, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.411 Vali Acc: 0.881 Test Loss: 0.411 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 30 cost time: 0.8770368099212646
Epoch: 30, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.881477 --> -0.888885).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8888888888888888
model parameter : 7044678
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1424994468688965
Epoch: 1, Steps: 2 | Train Loss: 2.093 Vali Loss: 1.992 Vali Acc: 0.104 Test Loss: 1.992 Test Acc: 0.104
Validation loss decreased (inf --> -0.103684).  Saving model ...
Epoch: 2 cost time: 0.6061530113220215
Epoch: 2, Steps: 2 | Train Loss: 2.018 Vali Loss: 1.950 Vali Acc: 0.122 Test Loss: 1.950 Test Acc: 0.122
Validation loss decreased (-0.103684 --> -0.122203).  Saving model ...
Epoch: 3 cost time: 0.654106616973877
Epoch: 3, Steps: 2 | Train Loss: 1.974 Vali Loss: 1.916 Vali Acc: 0.130 Test Loss: 1.916 Test Acc: 0.130
Validation loss decreased (-0.122203 --> -0.129610).  Saving model ...
Epoch: 4 cost time: 0.6180334091186523
Epoch: 4, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.878 Vali Acc: 0.156 Test Loss: 1.878 Test Acc: 0.156
Validation loss decreased (-0.129610 --> -0.155537).  Saving model ...
Epoch: 5 cost time: 0.6373269557952881
Epoch: 5, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.831 Vali Acc: 0.185 Test Loss: 1.831 Test Acc: 0.185
Validation loss decreased (-0.155537 --> -0.185167).  Saving model ...
Epoch: 6 cost time: 0.6231927871704102
Epoch: 6, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.775 Vali Acc: 0.233 Test Loss: 1.775 Test Acc: 0.233
Validation loss decreased (-0.185167 --> -0.233316).  Saving model ...
Epoch: 7 cost time: 0.5895087718963623
Epoch: 7, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.712 Vali Acc: 0.263 Test Loss: 1.712 Test Acc: 0.263
Validation loss decreased (-0.233316 --> -0.262946).  Saving model ...
Epoch: 8 cost time: 0.6900472640991211
Epoch: 8, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.645 Vali Acc: 0.330 Test Loss: 1.645 Test Acc: 0.330
Validation loss decreased (-0.262946 --> -0.329613).  Saving model ...
Epoch: 9 cost time: 0.6068589687347412
Epoch: 9, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.575 Vali Acc: 0.411 Test Loss: 1.575 Test Acc: 0.411
Validation loss decreased (-0.329613 --> -0.411095).  Saving model ...
Epoch: 10 cost time: 0.6042063236236572
Epoch: 10, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.502 Vali Acc: 0.500 Test Loss: 1.502 Test Acc: 0.500
Validation loss decreased (-0.411095 --> -0.499985).  Saving model ...
Epoch: 11 cost time: 0.6509542465209961
Epoch: 11, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.430 Vali Acc: 0.578 Test Loss: 1.430 Test Acc: 0.578
Validation loss decreased (-0.499985 --> -0.577763).  Saving model ...
Epoch: 12 cost time: 0.586094856262207
Epoch: 12, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.357 Vali Acc: 0.659 Test Loss: 1.357 Test Acc: 0.659
Validation loss decreased (-0.577763 --> -0.659246).  Saving model ...
Epoch: 13 cost time: 0.6280679702758789
Epoch: 13, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.284 Vali Acc: 0.737 Test Loss: 1.284 Test Acc: 0.737
Validation loss decreased (-0.659246 --> -0.737024).  Saving model ...
Epoch: 14 cost time: 0.6120984554290771
Epoch: 14, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.211 Vali Acc: 0.774 Test Loss: 1.211 Test Acc: 0.774
Validation loss decreased (-0.737024 --> -0.774062).  Saving model ...
Epoch: 15 cost time: 0.6503875255584717
Epoch: 15, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.140 Vali Acc: 0.815 Test Loss: 1.140 Test Acc: 0.815
Validation loss decreased (-0.774062 --> -0.814803).  Saving model ...
Epoch: 16 cost time: 0.6763556003570557
Epoch: 16, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.073 Vali Acc: 0.826 Test Loss: 1.073 Test Acc: 0.826
Validation loss decreased (-0.814803 --> -0.825915).  Saving model ...
Epoch: 17 cost time: 0.6994025707244873
Epoch: 17, Steps: 2 | Train Loss: 0.897 Vali Loss: 1.007 Vali Acc: 0.841 Test Loss: 1.007 Test Acc: 0.841
Validation loss decreased (-0.825915 --> -0.840731).  Saving model ...
Epoch: 18 cost time: 0.6885225772857666
Epoch: 18, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.946 Vali Acc: 0.848 Test Loss: 0.946 Test Acc: 0.848
Validation loss decreased (-0.840731 --> -0.848139).  Saving model ...
Epoch: 19 cost time: 0.7484781742095947
Epoch: 19, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.888 Vali Acc: 0.848 Test Loss: 0.888 Test Acc: 0.848
Validation loss decreased (-0.848139 --> -0.848139).  Saving model ...
Epoch: 20 cost time: 0.6840522289276123
Epoch: 20, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.833 Vali Acc: 0.856 Test Loss: 0.833 Test Acc: 0.856
Validation loss decreased (-0.848139 --> -0.855547).  Saving model ...
Epoch: 21 cost time: 0.6823742389678955
Epoch: 21, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.782 Vali Acc: 0.867 Test Loss: 0.782 Test Acc: 0.867
Validation loss decreased (-0.855547 --> -0.866659).  Saving model ...
Epoch: 22 cost time: 0.7276821136474609
Epoch: 22, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.734 Vali Acc: 0.867 Test Loss: 0.734 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 23 cost time: 0.7544615268707275
Epoch: 23, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.688 Vali Acc: 0.867 Test Loss: 0.688 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866660).  Saving model ...
Epoch: 24 cost time: 0.7320151329040527
Epoch: 24, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.647 Vali Acc: 0.870 Test Loss: 0.647 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 25 cost time: 0.6988694667816162
Epoch: 25, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.608 Vali Acc: 0.878 Test Loss: 0.608 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 0.7224698066711426
Epoch: 26, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.573 Vali Acc: 0.885 Test Loss: 0.573 Test Acc: 0.885
Validation loss decreased (-0.877772 --> -0.885179).  Saving model ...
Epoch: 27 cost time: 0.7361772060394287
Epoch: 27, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.541 Vali Acc: 0.885 Test Loss: 0.541 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885180).  Saving model ...
Epoch: 28 cost time: 0.7681553363800049
Epoch: 28, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.513 Vali Acc: 0.889 Test Loss: 0.513 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 29 cost time: 0.7099204063415527
Epoch: 29, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 30 cost time: 0.7019338607788086
Epoch: 30, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.465 Vali Acc: 0.889 Test Loss: 0.465 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8888888888888888
model parameter : 2079366
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1805500984191895
Epoch: 1, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.750 Vali Acc: 0.348 Test Loss: 1.750 Test Acc: 0.348
Validation loss decreased (inf --> -0.348131).  Saving model ...
Epoch: 2 cost time: 0.6833031177520752
Epoch: 2, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.712 Vali Acc: 0.378 Test Loss: 1.712 Test Acc: 0.378
Validation loss decreased (-0.348131 --> -0.377761).  Saving model ...
Epoch: 3 cost time: 0.6346650123596191
Epoch: 3, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.682 Vali Acc: 0.385 Test Loss: 1.682 Test Acc: 0.385
Validation loss decreased (-0.377761 --> -0.385168).  Saving model ...
Epoch: 4 cost time: 0.6581900119781494
Epoch: 4, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.649 Vali Acc: 0.415 Test Loss: 1.649 Test Acc: 0.415
Validation loss decreased (-0.385168 --> -0.414798).  Saving model ...
Epoch: 5 cost time: 0.6510090827941895
Epoch: 5, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.605 Vali Acc: 0.444 Test Loss: 1.605 Test Acc: 0.444
Validation loss decreased (-0.414798 --> -0.444428).  Saving model ...
Epoch: 6 cost time: 0.6455683708190918
Epoch: 6, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.555 Vali Acc: 0.496 Test Loss: 1.555 Test Acc: 0.496
Validation loss decreased (-0.444428 --> -0.496281).  Saving model ...
Epoch: 7 cost time: 0.6521835327148438
Epoch: 7, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.499 Vali Acc: 0.556 Test Loss: 1.499 Test Acc: 0.556
Validation loss decreased (-0.496281 --> -0.555541).  Saving model ...
Epoch: 8 cost time: 0.6400742530822754
Epoch: 8, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.439 Vali Acc: 0.604 Test Loss: 1.439 Test Acc: 0.604
Validation loss decreased (-0.555541 --> -0.603689).  Saving model ...
Epoch: 9 cost time: 0.6700310707092285
Epoch: 9, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.377 Vali Acc: 0.641 Test Loss: 1.377 Test Acc: 0.641
Validation loss decreased (-0.603689 --> -0.640727).  Saving model ...
Epoch: 10 cost time: 0.6202969551086426
Epoch: 10, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.313 Vali Acc: 0.689 Test Loss: 1.313 Test Acc: 0.689
Validation loss decreased (-0.640727 --> -0.688876).  Saving model ...
Epoch: 11 cost time: 0.6130526065826416
Epoch: 11, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.247 Vali Acc: 0.700 Test Loss: 1.247 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 0.6184840202331543
Epoch: 12, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.182 Vali Acc: 0.733 Test Loss: 1.182 Test Acc: 0.733
Validation loss decreased (-0.699988 --> -0.733322).  Saving model ...
Epoch: 13 cost time: 0.6573402881622314
Epoch: 13, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.117 Vali Acc: 0.756 Test Loss: 1.117 Test Acc: 0.756
Validation loss decreased (-0.733322 --> -0.755544).  Saving model ...
Epoch: 14 cost time: 0.645620584487915
Epoch: 14, Steps: 2 | Train Loss: 1.000 Vali Loss: 1.053 Vali Acc: 0.793 Test Loss: 1.053 Test Acc: 0.793
Validation loss decreased (-0.755544 --> -0.792582).  Saving model ...
Epoch: 15 cost time: 0.6514120101928711
Epoch: 15, Steps: 2 | Train Loss: 0.931 Vali Loss: 0.990 Vali Acc: 0.807 Test Loss: 0.990 Test Acc: 0.807
Validation loss decreased (-0.792582 --> -0.807398).  Saving model ...
Epoch: 16 cost time: 0.6470799446105957
Epoch: 16, Steps: 2 | Train Loss: 0.845 Vali Loss: 0.929 Vali Acc: 0.822 Test Loss: 0.929 Test Acc: 0.822
Validation loss decreased (-0.807398 --> -0.822213).  Saving model ...
Epoch: 17 cost time: 0.6837575435638428
Epoch: 17, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.871 Vali Acc: 0.844 Test Loss: 0.871 Test Acc: 0.844
Validation loss decreased (-0.822213 --> -0.844436).  Saving model ...
Epoch: 18 cost time: 0.6148931980133057
Epoch: 18, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.817 Vali Acc: 0.856 Test Loss: 0.817 Test Acc: 0.856
Validation loss decreased (-0.844436 --> -0.855547).  Saving model ...
Epoch: 19 cost time: 0.6355886459350586
Epoch: 19, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.764 Vali Acc: 0.867 Test Loss: 0.764 Test Acc: 0.867
Validation loss decreased (-0.855547 --> -0.866659).  Saving model ...
Epoch: 20 cost time: 0.7298455238342285
Epoch: 20, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.714 Vali Acc: 0.867 Test Loss: 0.714 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866660).  Saving model ...
Epoch: 21 cost time: 0.6848914623260498
Epoch: 21, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.667 Vali Acc: 0.867 Test Loss: 0.667 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 22 cost time: 0.6892640590667725
Epoch: 22, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.623 Vali Acc: 0.874 Test Loss: 0.623 Test Acc: 0.874
Validation loss decreased (-0.866660 --> -0.874068).  Saving model ...
Epoch: 23 cost time: 0.6599032878875732
Epoch: 23, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.580 Vali Acc: 0.881 Test Loss: 0.580 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 24 cost time: 0.715416669845581
Epoch: 24, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.543 Vali Acc: 0.874 Test Loss: 0.543 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6446499824523926
Epoch: 25, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.509 Vali Acc: 0.874 Test Loss: 0.509 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.676255464553833
Epoch: 26, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.479 Vali Acc: 0.878 Test Loss: 0.479 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6786084175109863
Epoch: 27, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.453 Vali Acc: 0.878 Test Loss: 0.453 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.714810848236084
Epoch: 28, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.431 Vali Acc: 0.878 Test Loss: 0.431 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7861371040344238
Epoch: 29, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.411 Vali Acc: 0.885 Test Loss: 0.411 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885181).  Saving model ...
Epoch: 30 cost time: 0.6947219371795654
Epoch: 30, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
Validation loss decreased (-0.885181 --> -0.888885).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8888888888888888
model parameter : 7044678
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0135645866394043
Epoch: 1, Steps: 2 | Train Loss: 2.096 Vali Loss: 1.992 Vali Acc: 0.104 Test Loss: 1.992 Test Acc: 0.104
Validation loss decreased (inf --> -0.103684).  Saving model ...
Epoch: 2 cost time: 0.6187589168548584
Epoch: 2, Steps: 2 | Train Loss: 2.020 Vali Loss: 1.950 Vali Acc: 0.122 Test Loss: 1.950 Test Acc: 0.122
Validation loss decreased (-0.103684 --> -0.122203).  Saving model ...
Epoch: 3 cost time: 0.5339312553405762
Epoch: 3, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.917 Vali Acc: 0.126 Test Loss: 1.917 Test Acc: 0.126
Validation loss decreased (-0.122203 --> -0.125907).  Saving model ...
Epoch: 4 cost time: 0.5365402698516846
Epoch: 4, Steps: 2 | Train Loss: 1.930 Vali Loss: 1.879 Vali Acc: 0.152 Test Loss: 1.879 Test Acc: 0.152
Validation loss decreased (-0.125907 --> -0.151833).  Saving model ...
Epoch: 5 cost time: 0.5680160522460938
Epoch: 5, Steps: 2 | Train Loss: 1.936 Vali Loss: 1.832 Vali Acc: 0.185 Test Loss: 1.832 Test Acc: 0.185
Validation loss decreased (-0.151833 --> -0.185167).  Saving model ...
Epoch: 6 cost time: 0.5873923301696777
Epoch: 6, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.777 Vali Acc: 0.233 Test Loss: 1.777 Test Acc: 0.233
Validation loss decreased (-0.185167 --> -0.233316).  Saving model ...
Epoch: 7 cost time: 0.6513195037841797
Epoch: 7, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.715 Vali Acc: 0.267 Test Loss: 1.715 Test Acc: 0.267
Validation loss decreased (-0.233316 --> -0.266650).  Saving model ...
Epoch: 8 cost time: 0.5637421607971191
Epoch: 8, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.649 Vali Acc: 0.330 Test Loss: 1.649 Test Acc: 0.330
Validation loss decreased (-0.266650 --> -0.329613).  Saving model ...
Epoch: 9 cost time: 0.5394134521484375
Epoch: 9, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.580 Vali Acc: 0.407 Test Loss: 1.580 Test Acc: 0.407
Validation loss decreased (-0.329613 --> -0.407392).  Saving model ...
Epoch: 10 cost time: 0.5563719272613525
Epoch: 10, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.508 Vali Acc: 0.500 Test Loss: 1.508 Test Acc: 0.500
Validation loss decreased (-0.407392 --> -0.499985).  Saving model ...
Epoch: 11 cost time: 0.6347501277923584
Epoch: 11, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.436 Vali Acc: 0.574 Test Loss: 1.436 Test Acc: 0.574
Validation loss decreased (-0.499985 --> -0.574060).  Saving model ...
Epoch: 12 cost time: 0.5683681964874268
Epoch: 12, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.364 Vali Acc: 0.656 Test Loss: 1.364 Test Acc: 0.656
Validation loss decreased (-0.574060 --> -0.655542).  Saving model ...
Epoch: 13 cost time: 0.5535931587219238
Epoch: 13, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.291 Vali Acc: 0.733 Test Loss: 1.291 Test Acc: 0.733
Validation loss decreased (-0.655542 --> -0.733320).  Saving model ...
Epoch: 14 cost time: 0.5373144149780273
Epoch: 14, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.218 Vali Acc: 0.774 Test Loss: 1.218 Test Acc: 0.774
Validation loss decreased (-0.733320 --> -0.774062).  Saving model ...
Epoch: 15 cost time: 0.530465841293335
Epoch: 15, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.147 Vali Acc: 0.807 Test Loss: 1.147 Test Acc: 0.807
Validation loss decreased (-0.774062 --> -0.807396).  Saving model ...
Epoch: 16 cost time: 0.5106184482574463
Epoch: 16, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.079 Vali Acc: 0.826 Test Loss: 1.079 Test Acc: 0.826
Validation loss decreased (-0.807396 --> -0.825915).  Saving model ...
Epoch: 17 cost time: 0.5620691776275635
Epoch: 17, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.013 Vali Acc: 0.844 Test Loss: 1.013 Test Acc: 0.844
Validation loss decreased (-0.825915 --> -0.844434).  Saving model ...
Epoch: 18 cost time: 0.5774698257446289
Epoch: 18, Steps: 2 | Train Loss: 0.868 Vali Loss: 0.951 Vali Acc: 0.848 Test Loss: 0.951 Test Acc: 0.848
Validation loss decreased (-0.844434 --> -0.848139).  Saving model ...
Epoch: 19 cost time: 0.6506388187408447
Epoch: 19, Steps: 2 | Train Loss: 0.778 Vali Loss: 0.892 Vali Acc: 0.863 Test Loss: 0.892 Test Acc: 0.863
Validation loss decreased (-0.848139 --> -0.862954).  Saving model ...
Epoch: 20 cost time: 0.6932644844055176
Epoch: 20, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.836 Vali Acc: 0.867 Test Loss: 0.836 Test Acc: 0.867
Validation loss decreased (-0.862954 --> -0.866658).  Saving model ...
Epoch: 21 cost time: 0.6227161884307861
Epoch: 21, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.784 Vali Acc: 0.867 Test Loss: 0.784 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866659).  Saving model ...
Epoch: 22 cost time: 0.5906538963317871
Epoch: 22, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.734 Vali Acc: 0.867 Test Loss: 0.734 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 23 cost time: 0.5659632682800293
Epoch: 23, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.688 Vali Acc: 0.870 Test Loss: 0.688 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 24 cost time: 0.5024077892303467
Epoch: 24, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.644 Vali Acc: 0.870 Test Loss: 0.644 Test Acc: 0.870
Validation loss decreased (-0.870363 --> -0.870364).  Saving model ...
Epoch: 25 cost time: 0.5454061031341553
Epoch: 25, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 0.5594747066497803
Epoch: 26, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.568 Vali Acc: 0.885 Test Loss: 0.568 Test Acc: 0.885
Validation loss decreased (-0.877772 --> -0.885180).  Saving model ...
Epoch: 27 cost time: 0.5063729286193848
Epoch: 27, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.536 Vali Acc: 0.881 Test Loss: 0.536 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5187697410583496
Epoch: 28, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.507 Vali Acc: 0.889 Test Loss: 0.507 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 29 cost time: 0.6235711574554443
Epoch: 29, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.481 Vali Acc: 0.893 Test Loss: 0.481 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 30 cost time: 0.5287628173828125
Epoch: 30, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.458 Vali Acc: 0.893 Test Loss: 0.458 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8925925925925926
model parameter : 2079366
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4154319763183594
Epoch: 1, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.722 Vali Acc: 0.344 Test Loss: 1.722 Test Acc: 0.344
Validation loss decreased (inf --> -0.344427).  Saving model ...
Epoch: 2 cost time: 0.7655813694000244
Epoch: 2, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.688 Vali Acc: 0.370 Test Loss: 1.688 Test Acc: 0.370
Validation loss decreased (-0.344427 --> -0.370353).  Saving model ...
Epoch: 3 cost time: 0.7675106525421143
Epoch: 3, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.660 Vali Acc: 0.396 Test Loss: 1.660 Test Acc: 0.396
Validation loss decreased (-0.370353 --> -0.396280).  Saving model ...
Epoch: 4 cost time: 0.7799255847930908
Epoch: 4, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.630 Vali Acc: 0.419 Test Loss: 1.630 Test Acc: 0.419
Validation loss decreased (-0.396280 --> -0.418502).  Saving model ...
Epoch: 5 cost time: 0.7907857894897461
Epoch: 5, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.593 Vali Acc: 0.441 Test Loss: 1.593 Test Acc: 0.441
Validation loss decreased (-0.418502 --> -0.440725).  Saving model ...
Epoch: 6 cost time: 0.7830746173858643
Epoch: 6, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.549 Vali Acc: 0.470 Test Loss: 1.549 Test Acc: 0.470
Validation loss decreased (-0.440725 --> -0.470355).  Saving model ...
Epoch: 7 cost time: 0.7426064014434814
Epoch: 7, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.501 Vali Acc: 0.533 Test Loss: 1.501 Test Acc: 0.533
Validation loss decreased (-0.470355 --> -0.533318).  Saving model ...
Epoch: 8 cost time: 0.7687151432037354
Epoch: 8, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.449 Vali Acc: 0.604 Test Loss: 1.449 Test Acc: 0.604
Validation loss decreased (-0.533318 --> -0.603689).  Saving model ...
Epoch: 9 cost time: 0.8052661418914795
Epoch: 9, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.392 Vali Acc: 0.667 Test Loss: 1.392 Test Acc: 0.667
Validation loss decreased (-0.603689 --> -0.666653).  Saving model ...
Epoch: 10 cost time: 0.7781322002410889
Epoch: 10, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.334 Vali Acc: 0.719 Test Loss: 1.334 Test Acc: 0.719
Validation loss decreased (-0.666653 --> -0.718505).  Saving model ...
Epoch: 11 cost time: 0.8016350269317627
Epoch: 11, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.275 Vali Acc: 0.733 Test Loss: 1.275 Test Acc: 0.733
Validation loss decreased (-0.718505 --> -0.733321).  Saving model ...
Epoch: 12 cost time: 0.7413959503173828
Epoch: 12, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.216 Vali Acc: 0.752 Test Loss: 1.216 Test Acc: 0.752
Validation loss decreased (-0.733321 --> -0.751840).  Saving model ...
Epoch: 13 cost time: 0.7919464111328125
Epoch: 13, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.155 Vali Acc: 0.763 Test Loss: 1.155 Test Acc: 0.763
Validation loss decreased (-0.751840 --> -0.762951).  Saving model ...
Epoch: 14 cost time: 0.8111910820007324
Epoch: 14, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.095 Vali Acc: 0.781 Test Loss: 1.095 Test Acc: 0.781
Validation loss decreased (-0.762951 --> -0.781471).  Saving model ...
Epoch: 15 cost time: 0.7982439994812012
Epoch: 15, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.034 Vali Acc: 0.807 Test Loss: 1.034 Test Acc: 0.807
Validation loss decreased (-0.781471 --> -0.807397).  Saving model ...
Epoch: 16 cost time: 0.8123435974121094
Epoch: 16, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.973 Vali Acc: 0.822 Test Loss: 0.973 Test Acc: 0.822
Validation loss decreased (-0.807397 --> -0.822212).  Saving model ...
Epoch: 17 cost time: 0.8211104869842529
Epoch: 17, Steps: 2 | Train Loss: 0.827 Vali Loss: 0.915 Vali Acc: 0.844 Test Loss: 0.915 Test Acc: 0.844
Validation loss decreased (-0.822212 --> -0.844435).  Saving model ...
Epoch: 18 cost time: 0.8038866519927979
Epoch: 18, Steps: 2 | Train Loss: 0.744 Vali Loss: 0.859 Vali Acc: 0.863 Test Loss: 0.859 Test Acc: 0.863
Validation loss decreased (-0.844435 --> -0.862954).  Saving model ...
Epoch: 19 cost time: 0.793372631072998
Epoch: 19, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.804 Vali Acc: 0.870 Test Loss: 0.804 Test Acc: 0.870
Validation loss decreased (-0.862954 --> -0.870362).  Saving model ...
Epoch: 20 cost time: 0.8161993026733398
Epoch: 20, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.751 Vali Acc: 0.889 Test Loss: 0.751 Test Acc: 0.889
Validation loss decreased (-0.870362 --> -0.888881).  Saving model ...
Epoch: 21 cost time: 0.8255717754364014
Epoch: 21, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.700 Vali Acc: 0.900 Test Loss: 0.700 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.8185687065124512
Epoch: 22, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.651 Vali Acc: 0.904 Test Loss: 0.651 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 23 cost time: 0.7933473587036133
Epoch: 23, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.605 Vali Acc: 0.911 Test Loss: 0.605 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 24 cost time: 0.864429235458374
Epoch: 24, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.563 Vali Acc: 0.919 Test Loss: 0.563 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 25 cost time: 0.8086490631103516
Epoch: 25, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.524 Vali Acc: 0.922 Test Loss: 0.524 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 26 cost time: 0.818333625793457
Epoch: 26, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.489 Vali Acc: 0.926 Test Loss: 0.489 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 27 cost time: 0.8040971755981445
Epoch: 27, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.457 Vali Acc: 0.930 Test Loss: 0.457 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 28 cost time: 0.7770516872406006
Epoch: 28, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.429 Vali Acc: 0.926 Test Loss: 0.429 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7799925804138184
Epoch: 29, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.404 Vali Acc: 0.926 Test Loss: 0.404 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7929158210754395
Epoch: 30, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.382 Vali Acc: 0.922 Test Loss: 0.382 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 3529158
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.485318660736084
Epoch: 1, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.736 Vali Acc: 0.207 Test Loss: 1.736 Test Acc: 0.207
Validation loss decreased (inf --> -0.207390).  Saving model ...
Epoch: 2 cost time: 0.6456577777862549
Epoch: 2, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.702 Vali Acc: 0.222 Test Loss: 1.702 Test Acc: 0.222
Validation loss decreased (-0.207390 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 0.6303975582122803
Epoch: 3, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.675 Vali Acc: 0.263 Test Loss: 1.675 Test Acc: 0.263
Validation loss decreased (-0.222205 --> -0.262946).  Saving model ...
Epoch: 4 cost time: 0.6455700397491455
Epoch: 4, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.645 Vali Acc: 0.300 Test Loss: 1.645 Test Acc: 0.300
Validation loss decreased (-0.262946 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 0.7342238426208496
Epoch: 5, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.608 Vali Acc: 0.359 Test Loss: 1.608 Test Acc: 0.359
Validation loss decreased (-0.299984 --> -0.359243).  Saving model ...
Epoch: 6 cost time: 0.7395956516265869
Epoch: 6, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.564 Vali Acc: 0.463 Test Loss: 1.564 Test Acc: 0.463
Validation loss decreased (-0.359243 --> -0.462947).  Saving model ...
Epoch: 7 cost time: 0.6948223114013672
Epoch: 7, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.515 Vali Acc: 0.537 Test Loss: 1.515 Test Acc: 0.537
Validation loss decreased (-0.462947 --> -0.537022).  Saving model ...
Epoch: 8 cost time: 0.6910862922668457
Epoch: 8, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.462 Vali Acc: 0.619 Test Loss: 1.462 Test Acc: 0.619
Validation loss decreased (-0.537022 --> -0.618504).  Saving model ...
Epoch: 9 cost time: 0.6741437911987305
Epoch: 9, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.406 Vali Acc: 0.678 Test Loss: 1.406 Test Acc: 0.678
Validation loss decreased (-0.618504 --> -0.677764).  Saving model ...
Epoch: 10 cost time: 0.6948626041412354
Epoch: 10, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.346 Vali Acc: 0.744 Test Loss: 1.346 Test Acc: 0.744
Validation loss decreased (-0.677764 --> -0.744431).  Saving model ...
Epoch: 11 cost time: 0.6683783531188965
Epoch: 11, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.285 Vali Acc: 0.800 Test Loss: 1.285 Test Acc: 0.800
Validation loss decreased (-0.744431 --> -0.799987).  Saving model ...
Epoch: 12 cost time: 0.6490139961242676
Epoch: 12, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.223 Vali Acc: 0.830 Test Loss: 1.223 Test Acc: 0.830
Validation loss decreased (-0.799987 --> -0.829617).  Saving model ...
Epoch: 13 cost time: 0.6602973937988281
Epoch: 13, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.161 Vali Acc: 0.852 Test Loss: 1.161 Test Acc: 0.852
Validation loss decreased (-0.829617 --> -0.851840).  Saving model ...
Epoch: 14 cost time: 0.6272280216217041
Epoch: 14, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.099 Vali Acc: 0.856 Test Loss: 1.099 Test Acc: 0.856
Validation loss decreased (-0.851840 --> -0.855545).  Saving model ...
Epoch: 15 cost time: 0.7092959880828857
Epoch: 15, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.037 Vali Acc: 0.856 Test Loss: 1.037 Test Acc: 0.856
Validation loss decreased (-0.855545 --> -0.855545).  Saving model ...
Epoch: 16 cost time: 0.7258408069610596
Epoch: 16, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.978 Vali Acc: 0.859 Test Loss: 0.978 Test Acc: 0.859
Validation loss decreased (-0.855545 --> -0.859249).  Saving model ...
Epoch: 17 cost time: 0.7186224460601807
Epoch: 17, Steps: 2 | Train Loss: 0.847 Vali Loss: 0.920 Vali Acc: 0.870 Test Loss: 0.920 Test Acc: 0.870
Validation loss decreased (-0.859249 --> -0.870361).  Saving model ...
Epoch: 18 cost time: 0.6715242862701416
Epoch: 18, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.863 Vali Acc: 0.874 Test Loss: 0.863 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874065).  Saving model ...
Epoch: 19 cost time: 0.7238054275512695
Epoch: 19, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.809 Vali Acc: 0.893 Test Loss: 0.809 Test Acc: 0.893
Validation loss decreased (-0.874065 --> -0.892584).  Saving model ...
Epoch: 20 cost time: 0.7530996799468994
Epoch: 20, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.758 Vali Acc: 0.904 Test Loss: 0.758 Test Acc: 0.904
Validation loss decreased (-0.892584 --> -0.903696).  Saving model ...
Epoch: 21 cost time: 0.7117624282836914
Epoch: 21, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.710 Vali Acc: 0.911 Test Loss: 0.710 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 22 cost time: 0.6915249824523926
Epoch: 22, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.665 Vali Acc: 0.919 Test Loss: 0.665 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918512).  Saving model ...
Epoch: 23 cost time: 0.7583129405975342
Epoch: 23, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.623 Vali Acc: 0.922 Test Loss: 0.623 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 24 cost time: 0.7521183490753174
Epoch: 24, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.584 Vali Acc: 0.922 Test Loss: 0.584 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 25 cost time: 0.7017669677734375
Epoch: 25, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.548 Vali Acc: 0.922 Test Loss: 0.548 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 26 cost time: 0.7140357494354248
Epoch: 26, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.515 Vali Acc: 0.922 Test Loss: 0.515 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 27 cost time: 0.7218308448791504
Epoch: 27, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.485 Vali Acc: 0.926 Test Loss: 0.485 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 28 cost time: 0.7608253955841064
Epoch: 28, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.458 Vali Acc: 0.922 Test Loss: 0.458 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7131593227386475
Epoch: 29, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.434 Vali Acc: 0.919 Test Loss: 0.434 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7322788238525391
Epoch: 30, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.412 Vali Acc: 0.919 Test Loss: 0.412 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 1046406
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3650033473968506
Epoch: 1, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.722 Vali Acc: 0.344 Test Loss: 1.722 Test Acc: 0.344
Validation loss decreased (inf --> -0.344427).  Saving model ...
Epoch: 2 cost time: 0.7528853416442871
Epoch: 2, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.688 Vali Acc: 0.370 Test Loss: 1.688 Test Acc: 0.370
Validation loss decreased (-0.344427 --> -0.370353).  Saving model ...
Epoch: 3 cost time: 0.7168629169464111
Epoch: 3, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.660 Vali Acc: 0.396 Test Loss: 1.660 Test Acc: 0.396
Validation loss decreased (-0.370353 --> -0.396280).  Saving model ...
Epoch: 4 cost time: 0.7372021675109863
Epoch: 4, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.630 Vali Acc: 0.419 Test Loss: 1.630 Test Acc: 0.419
Validation loss decreased (-0.396280 --> -0.418502).  Saving model ...
Epoch: 5 cost time: 0.7102878093719482
Epoch: 5, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.593 Vali Acc: 0.441 Test Loss: 1.593 Test Acc: 0.441
Validation loss decreased (-0.418502 --> -0.440725).  Saving model ...
Epoch: 6 cost time: 0.733511209487915
Epoch: 6, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.549 Vali Acc: 0.470 Test Loss: 1.549 Test Acc: 0.470
Validation loss decreased (-0.440725 --> -0.470355).  Saving model ...
Epoch: 7 cost time: 0.7620868682861328
Epoch: 7, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.501 Vali Acc: 0.533 Test Loss: 1.501 Test Acc: 0.533
Validation loss decreased (-0.470355 --> -0.533318).  Saving model ...
Epoch: 8 cost time: 0.6643779277801514
Epoch: 8, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.449 Vali Acc: 0.604 Test Loss: 1.449 Test Acc: 0.604
Validation loss decreased (-0.533318 --> -0.603689).  Saving model ...
Epoch: 9 cost time: 0.6931819915771484
Epoch: 9, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.392 Vali Acc: 0.667 Test Loss: 1.392 Test Acc: 0.667
Validation loss decreased (-0.603689 --> -0.666653).  Saving model ...
Epoch: 10 cost time: 0.6877381801605225
Epoch: 10, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.334 Vali Acc: 0.719 Test Loss: 1.334 Test Acc: 0.719
Validation loss decreased (-0.666653 --> -0.718505).  Saving model ...
Epoch: 11 cost time: 0.6535689830780029
Epoch: 11, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.275 Vali Acc: 0.733 Test Loss: 1.275 Test Acc: 0.733
Validation loss decreased (-0.718505 --> -0.733321).  Saving model ...
Epoch: 12 cost time: 0.7307095527648926
Epoch: 12, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.216 Vali Acc: 0.752 Test Loss: 1.216 Test Acc: 0.752
Validation loss decreased (-0.733321 --> -0.751840).  Saving model ...
Epoch: 13 cost time: 0.7470788955688477
Epoch: 13, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.155 Vali Acc: 0.763 Test Loss: 1.155 Test Acc: 0.763
Validation loss decreased (-0.751840 --> -0.762951).  Saving model ...
Epoch: 14 cost time: 0.7861206531524658
Epoch: 14, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.095 Vali Acc: 0.781 Test Loss: 1.095 Test Acc: 0.781
Validation loss decreased (-0.762951 --> -0.781471).  Saving model ...
Epoch: 15 cost time: 0.7773957252502441
Epoch: 15, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.034 Vali Acc: 0.807 Test Loss: 1.034 Test Acc: 0.807
Validation loss decreased (-0.781471 --> -0.807397).  Saving model ...
Epoch: 16 cost time: 0.748894214630127
Epoch: 16, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.973 Vali Acc: 0.822 Test Loss: 0.973 Test Acc: 0.822
Validation loss decreased (-0.807397 --> -0.822212).  Saving model ...
Epoch: 17 cost time: 0.6911091804504395
Epoch: 17, Steps: 2 | Train Loss: 0.827 Vali Loss: 0.915 Vali Acc: 0.844 Test Loss: 0.915 Test Acc: 0.844
Validation loss decreased (-0.822212 --> -0.844435).  Saving model ...
Epoch: 18 cost time: 0.715017557144165
Epoch: 18, Steps: 2 | Train Loss: 0.744 Vali Loss: 0.859 Vali Acc: 0.863 Test Loss: 0.859 Test Acc: 0.863
Validation loss decreased (-0.844435 --> -0.862954).  Saving model ...
Epoch: 19 cost time: 0.7134296894073486
Epoch: 19, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.804 Vali Acc: 0.870 Test Loss: 0.804 Test Acc: 0.870
Validation loss decreased (-0.862954 --> -0.870362).  Saving model ...
Epoch: 20 cost time: 0.7056946754455566
Epoch: 20, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.751 Vali Acc: 0.889 Test Loss: 0.751 Test Acc: 0.889
Validation loss decreased (-0.870362 --> -0.888881).  Saving model ...
Epoch: 21 cost time: 0.7402849197387695
Epoch: 21, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.700 Vali Acc: 0.900 Test Loss: 0.700 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.7054986953735352
Epoch: 22, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.651 Vali Acc: 0.904 Test Loss: 0.651 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 23 cost time: 0.680121660232544
Epoch: 23, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.605 Vali Acc: 0.911 Test Loss: 0.605 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 24 cost time: 0.738149881362915
Epoch: 24, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.563 Vali Acc: 0.919 Test Loss: 0.563 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 25 cost time: 0.7088403701782227
Epoch: 25, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.524 Vali Acc: 0.922 Test Loss: 0.524 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 26 cost time: 0.734778881072998
Epoch: 26, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.489 Vali Acc: 0.926 Test Loss: 0.489 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 27 cost time: 0.7161293029785156
Epoch: 27, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.457 Vali Acc: 0.930 Test Loss: 0.457 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 28 cost time: 0.7054262161254883
Epoch: 28, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.429 Vali Acc: 0.926 Test Loss: 0.429 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6696360111236572
Epoch: 29, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.404 Vali Acc: 0.926 Test Loss: 0.404 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7149865627288818
Epoch: 30, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.382 Vali Acc: 0.922 Test Loss: 0.382 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 3529158
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4532065391540527
Epoch: 1, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.736 Vali Acc: 0.207 Test Loss: 1.736 Test Acc: 0.207
Validation loss decreased (inf --> -0.207390).  Saving model ...
Epoch: 2 cost time: 0.6053712368011475
Epoch: 2, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.702 Vali Acc: 0.222 Test Loss: 1.702 Test Acc: 0.222
Validation loss decreased (-0.207390 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 0.5680148601531982
Epoch: 3, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.675 Vali Acc: 0.263 Test Loss: 1.675 Test Acc: 0.263
Validation loss decreased (-0.222205 --> -0.262946).  Saving model ...
Epoch: 4 cost time: 0.6274571418762207
Epoch: 4, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.645 Vali Acc: 0.300 Test Loss: 1.645 Test Acc: 0.300
Validation loss decreased (-0.262946 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 0.5522341728210449
Epoch: 5, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.608 Vali Acc: 0.359 Test Loss: 1.608 Test Acc: 0.359
Validation loss decreased (-0.299984 --> -0.359243).  Saving model ...
Epoch: 6 cost time: 0.5792267322540283
Epoch: 6, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.564 Vali Acc: 0.463 Test Loss: 1.564 Test Acc: 0.463
Validation loss decreased (-0.359243 --> -0.462947).  Saving model ...
Epoch: 7 cost time: 0.5795993804931641
Epoch: 7, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.515 Vali Acc: 0.537 Test Loss: 1.515 Test Acc: 0.537
Validation loss decreased (-0.462947 --> -0.537022).  Saving model ...
Epoch: 8 cost time: 0.5774755477905273
Epoch: 8, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.462 Vali Acc: 0.619 Test Loss: 1.462 Test Acc: 0.619
Validation loss decreased (-0.537022 --> -0.618504).  Saving model ...
Epoch: 9 cost time: 0.5797450542449951
Epoch: 9, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.406 Vali Acc: 0.678 Test Loss: 1.406 Test Acc: 0.678
Validation loss decreased (-0.618504 --> -0.677764).  Saving model ...
Epoch: 10 cost time: 0.5998697280883789
Epoch: 10, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.346 Vali Acc: 0.744 Test Loss: 1.346 Test Acc: 0.744
Validation loss decreased (-0.677764 --> -0.744431).  Saving model ...
Epoch: 11 cost time: 0.5978851318359375
Epoch: 11, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.285 Vali Acc: 0.800 Test Loss: 1.285 Test Acc: 0.800
Validation loss decreased (-0.744431 --> -0.799987).  Saving model ...
Epoch: 12 cost time: 0.5840396881103516
Epoch: 12, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.223 Vali Acc: 0.830 Test Loss: 1.223 Test Acc: 0.830
Validation loss decreased (-0.799987 --> -0.829617).  Saving model ...
Epoch: 13 cost time: 0.5529899597167969
Epoch: 13, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.161 Vali Acc: 0.852 Test Loss: 1.161 Test Acc: 0.852
Validation loss decreased (-0.829617 --> -0.851840).  Saving model ...
Epoch: 14 cost time: 0.5568881034851074
Epoch: 14, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.099 Vali Acc: 0.856 Test Loss: 1.099 Test Acc: 0.856
Validation loss decreased (-0.851840 --> -0.855545).  Saving model ...
Epoch: 15 cost time: 0.5644824504852295
Epoch: 15, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.037 Vali Acc: 0.856 Test Loss: 1.037 Test Acc: 0.856
Validation loss decreased (-0.855545 --> -0.855545).  Saving model ...
Epoch: 16 cost time: 0.5862488746643066
Epoch: 16, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.978 Vali Acc: 0.859 Test Loss: 0.978 Test Acc: 0.859
Validation loss decreased (-0.855545 --> -0.859249).  Saving model ...
Epoch: 17 cost time: 0.6021473407745361
Epoch: 17, Steps: 2 | Train Loss: 0.847 Vali Loss: 0.920 Vali Acc: 0.870 Test Loss: 0.920 Test Acc: 0.870
Validation loss decreased (-0.859249 --> -0.870361).  Saving model ...
Epoch: 18 cost time: 0.6116740703582764
Epoch: 18, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.863 Vali Acc: 0.874 Test Loss: 0.863 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874065).  Saving model ...
Epoch: 19 cost time: 0.6127774715423584
Epoch: 19, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.809 Vali Acc: 0.893 Test Loss: 0.809 Test Acc: 0.893
Validation loss decreased (-0.874065 --> -0.892584).  Saving model ...
Epoch: 20 cost time: 0.6002259254455566
Epoch: 20, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.758 Vali Acc: 0.904 Test Loss: 0.758 Test Acc: 0.904
Validation loss decreased (-0.892584 --> -0.903696).  Saving model ...
Epoch: 21 cost time: 0.6324293613433838
Epoch: 21, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.710 Vali Acc: 0.911 Test Loss: 0.710 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 22 cost time: 0.5807580947875977
Epoch: 22, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.665 Vali Acc: 0.919 Test Loss: 0.665 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918512).  Saving model ...
Epoch: 23 cost time: 0.6316585540771484
Epoch: 23, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.623 Vali Acc: 0.922 Test Loss: 0.623 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 24 cost time: 0.5786921977996826
Epoch: 24, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.584 Vali Acc: 0.922 Test Loss: 0.584 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 25 cost time: 0.684518575668335
Epoch: 25, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.548 Vali Acc: 0.922 Test Loss: 0.548 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 26 cost time: 0.657822847366333
Epoch: 26, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.515 Vali Acc: 0.922 Test Loss: 0.515 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 27 cost time: 0.6011006832122803
Epoch: 27, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.485 Vali Acc: 0.926 Test Loss: 0.485 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 28 cost time: 0.6951186656951904
Epoch: 28, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.458 Vali Acc: 0.922 Test Loss: 0.458 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6841142177581787
Epoch: 29, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.434 Vali Acc: 0.919 Test Loss: 0.434 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7009015083312988
Epoch: 30, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.412 Vali Acc: 0.919 Test Loss: 0.412 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 1046406
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2461466789245605
Epoch: 1, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.722 Vali Acc: 0.344 Test Loss: 1.722 Test Acc: 0.344
Validation loss decreased (inf --> -0.344427).  Saving model ...
Epoch: 2 cost time: 0.604823112487793
Epoch: 2, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.688 Vali Acc: 0.370 Test Loss: 1.688 Test Acc: 0.370
Validation loss decreased (-0.344427 --> -0.370353).  Saving model ...
Epoch: 3 cost time: 0.5994505882263184
Epoch: 3, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.660 Vali Acc: 0.396 Test Loss: 1.660 Test Acc: 0.396
Validation loss decreased (-0.370353 --> -0.396280).  Saving model ...
Epoch: 4 cost time: 0.6080989837646484
Epoch: 4, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.631 Vali Acc: 0.419 Test Loss: 1.631 Test Acc: 0.419
Validation loss decreased (-0.396280 --> -0.418502).  Saving model ...
Epoch: 5 cost time: 0.609900951385498
Epoch: 5, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.593 Vali Acc: 0.441 Test Loss: 1.593 Test Acc: 0.441
Validation loss decreased (-0.418502 --> -0.440725).  Saving model ...
Epoch: 6 cost time: 0.5854220390319824
Epoch: 6, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.551 Vali Acc: 0.470 Test Loss: 1.551 Test Acc: 0.470
Validation loss decreased (-0.440725 --> -0.470355).  Saving model ...
Epoch: 7 cost time: 0.623457670211792
Epoch: 7, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.503 Vali Acc: 0.530 Test Loss: 1.503 Test Acc: 0.530
Validation loss decreased (-0.470355 --> -0.529615).  Saving model ...
Epoch: 8 cost time: 0.5957753658294678
Epoch: 8, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.451 Vali Acc: 0.600 Test Loss: 1.451 Test Acc: 0.600
Validation loss decreased (-0.529615 --> -0.599985).  Saving model ...
Epoch: 9 cost time: 0.6211264133453369
Epoch: 9, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.395 Vali Acc: 0.663 Test Loss: 1.395 Test Acc: 0.663
Validation loss decreased (-0.599985 --> -0.662949).  Saving model ...
Epoch: 10 cost time: 0.6629452705383301
Epoch: 10, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.337 Vali Acc: 0.711 Test Loss: 1.337 Test Acc: 0.711
Validation loss decreased (-0.662949 --> -0.711098).  Saving model ...
Epoch: 11 cost time: 0.6182808876037598
Epoch: 11, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.279 Vali Acc: 0.733 Test Loss: 1.279 Test Acc: 0.733
Validation loss decreased (-0.711098 --> -0.733321).  Saving model ...
Epoch: 12 cost time: 0.6272261142730713
Epoch: 12, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.220 Vali Acc: 0.752 Test Loss: 1.220 Test Acc: 0.752
Validation loss decreased (-0.733321 --> -0.751840).  Saving model ...
Epoch: 13 cost time: 0.5973577499389648
Epoch: 13, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.159 Vali Acc: 0.763 Test Loss: 1.159 Test Acc: 0.763
Validation loss decreased (-0.751840 --> -0.762951).  Saving model ...
Epoch: 14 cost time: 0.5657398700714111
Epoch: 14, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.099 Vali Acc: 0.785 Test Loss: 1.099 Test Acc: 0.785
Validation loss decreased (-0.762951 --> -0.785174).  Saving model ...
Epoch: 15 cost time: 0.6285727024078369
Epoch: 15, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.038 Vali Acc: 0.804 Test Loss: 1.038 Test Acc: 0.804
Validation loss decreased (-0.785174 --> -0.803693).  Saving model ...
Epoch: 16 cost time: 0.6156291961669922
Epoch: 16, Steps: 2 | Train Loss: 0.922 Vali Loss: 0.978 Vali Acc: 0.819 Test Loss: 0.978 Test Acc: 0.819
Validation loss decreased (-0.803693 --> -0.818509).  Saving model ...
Epoch: 17 cost time: 0.6060540676116943
Epoch: 17, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.919 Vali Acc: 0.841 Test Loss: 0.919 Test Acc: 0.841
Validation loss decreased (-0.818509 --> -0.840732).  Saving model ...
Epoch: 18 cost time: 0.5982246398925781
Epoch: 18, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.863 Vali Acc: 0.856 Test Loss: 0.863 Test Acc: 0.856
Validation loss decreased (-0.840732 --> -0.855547).  Saving model ...
Epoch: 19 cost time: 0.6036341190338135
Epoch: 19, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.808 Vali Acc: 0.863 Test Loss: 0.808 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862955).  Saving model ...
Epoch: 20 cost time: 0.6286897659301758
Epoch: 20, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.754 Vali Acc: 0.878 Test Loss: 0.754 Test Acc: 0.878
Validation loss decreased (-0.862955 --> -0.877770).  Saving model ...
Epoch: 21 cost time: 0.6536951065063477
Epoch: 21, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.702 Vali Acc: 0.900 Test Loss: 0.702 Test Acc: 0.900
Validation loss decreased (-0.877770 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.6181018352508545
Epoch: 22, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.653 Vali Acc: 0.900 Test Loss: 0.653 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 23 cost time: 0.5836548805236816
Epoch: 23, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.607 Vali Acc: 0.907 Test Loss: 0.607 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907401).  Saving model ...
Epoch: 24 cost time: 0.6607601642608643
Epoch: 24, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.564 Vali Acc: 0.915 Test Loss: 0.564 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 25 cost time: 0.5903868675231934
Epoch: 25, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.525 Vali Acc: 0.922 Test Loss: 0.525 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 26 cost time: 0.5594127178192139
Epoch: 26, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.489 Vali Acc: 0.922 Test Loss: 0.489 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 27 cost time: 0.5805783271789551
Epoch: 27, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.457 Vali Acc: 0.926 Test Loss: 0.457 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 28 cost time: 0.5917243957519531
Epoch: 28, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.429 Vali Acc: 0.922 Test Loss: 0.429 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6279263496398926
Epoch: 29, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.404 Vali Acc: 0.926 Test Loss: 0.404 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 30 cost time: 0.5688517093658447
Epoch: 30, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.382 Vali Acc: 0.926 Test Loss: 0.382 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 3529158
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.949028730392456
Epoch: 1, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.736 Vali Acc: 0.200 Test Loss: 1.736 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 0.5038027763366699
Epoch: 2, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.702 Vali Acc: 0.219 Test Loss: 1.702 Test Acc: 0.219
Validation loss decreased (-0.199983 --> -0.218502).  Saving model ...
Epoch: 3 cost time: 0.5154464244842529
Epoch: 3, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.675 Vali Acc: 0.256 Test Loss: 1.675 Test Acc: 0.256
Validation loss decreased (-0.218502 --> -0.255539).  Saving model ...
Epoch: 4 cost time: 0.5119647979736328
Epoch: 4, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.646 Vali Acc: 0.300 Test Loss: 1.646 Test Acc: 0.300
Validation loss decreased (-0.255539 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 0.5221505165100098
Epoch: 5, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.608 Vali Acc: 0.356 Test Loss: 1.608 Test Acc: 0.356
Validation loss decreased (-0.299984 --> -0.355539).  Saving model ...
Epoch: 6 cost time: 0.5441615581512451
Epoch: 6, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.565 Vali Acc: 0.463 Test Loss: 1.565 Test Acc: 0.463
Validation loss decreased (-0.355539 --> -0.462947).  Saving model ...
Epoch: 7 cost time: 0.4897749423980713
Epoch: 7, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.516 Vali Acc: 0.533 Test Loss: 1.516 Test Acc: 0.533
Validation loss decreased (-0.462947 --> -0.533318).  Saving model ...
Epoch: 8 cost time: 0.5156159400939941
Epoch: 8, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.464 Vali Acc: 0.619 Test Loss: 1.464 Test Acc: 0.619
Validation loss decreased (-0.533318 --> -0.618504).  Saving model ...
Epoch: 9 cost time: 0.5307066440582275
Epoch: 9, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.408 Vali Acc: 0.678 Test Loss: 1.408 Test Acc: 0.678
Validation loss decreased (-0.618504 --> -0.677764).  Saving model ...
Epoch: 10 cost time: 0.5080084800720215
Epoch: 10, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.349 Vali Acc: 0.741 Test Loss: 1.349 Test Acc: 0.741
Validation loss decreased (-0.677764 --> -0.740727).  Saving model ...
Epoch: 11 cost time: 0.5565903186798096
Epoch: 11, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.288 Vali Acc: 0.804 Test Loss: 1.288 Test Acc: 0.804
Validation loss decreased (-0.740727 --> -0.803691).  Saving model ...
Epoch: 12 cost time: 0.5059432983398438
Epoch: 12, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.227 Vali Acc: 0.833 Test Loss: 1.227 Test Acc: 0.833
Validation loss decreased (-0.803691 --> -0.833321).  Saving model ...
Epoch: 13 cost time: 0.6840133666992188
Epoch: 13, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.165 Vali Acc: 0.848 Test Loss: 1.165 Test Acc: 0.848
Validation loss decreased (-0.833321 --> -0.848136).  Saving model ...
Epoch: 14 cost time: 0.5335969924926758
Epoch: 14, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.103 Vali Acc: 0.856 Test Loss: 1.103 Test Acc: 0.856
Validation loss decreased (-0.848136 --> -0.855545).  Saving model ...
Epoch: 15 cost time: 0.5992279052734375
Epoch: 15, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.042 Vali Acc: 0.856 Test Loss: 1.042 Test Acc: 0.856
Validation loss decreased (-0.855545 --> -0.855545).  Saving model ...
Epoch: 16 cost time: 0.5289962291717529
Epoch: 16, Steps: 2 | Train Loss: 0.907 Vali Loss: 0.983 Vali Acc: 0.859 Test Loss: 0.983 Test Acc: 0.859
Validation loss decreased (-0.855545 --> -0.859249).  Saving model ...
Epoch: 17 cost time: 0.534780740737915
Epoch: 17, Steps: 2 | Train Loss: 0.861 Vali Loss: 0.925 Vali Acc: 0.867 Test Loss: 0.925 Test Acc: 0.867
Validation loss decreased (-0.859249 --> -0.866657).  Saving model ...
Epoch: 18 cost time: 0.519554853439331
Epoch: 18, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.868 Vali Acc: 0.881 Test Loss: 0.868 Test Acc: 0.881
Validation loss decreased (-0.866657 --> -0.881473).  Saving model ...
Epoch: 19 cost time: 0.5751819610595703
Epoch: 19, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.814 Vali Acc: 0.900 Test Loss: 0.814 Test Acc: 0.900
Validation loss decreased (-0.881473 --> -0.899992).  Saving model ...
Epoch: 20 cost time: 0.6106338500976562
Epoch: 20, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.762 Vali Acc: 0.904 Test Loss: 0.762 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 21 cost time: 0.5974366664886475
Epoch: 21, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.714 Vali Acc: 0.911 Test Loss: 0.714 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 22 cost time: 0.5527143478393555
Epoch: 22, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.669 Vali Acc: 0.919 Test Loss: 0.669 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918512).  Saving model ...
Epoch: 23 cost time: 0.5459496974945068
Epoch: 23, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.626 Vali Acc: 0.922 Test Loss: 0.626 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 24 cost time: 0.6335451602935791
Epoch: 24, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.587 Vali Acc: 0.919 Test Loss: 0.587 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.532120943069458
Epoch: 25, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.550 Vali Acc: 0.922 Test Loss: 0.550 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 26 cost time: 0.5253341197967529
Epoch: 26, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.517 Vali Acc: 0.919 Test Loss: 0.517 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5620555877685547
Epoch: 27, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.487 Vali Acc: 0.922 Test Loss: 0.487 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 28 cost time: 0.5278613567352295
Epoch: 28, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.460 Vali Acc: 0.919 Test Loss: 0.460 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5492737293243408
Epoch: 29, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.435 Vali Acc: 0.915 Test Loss: 0.435 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5428674221038818
Epoch: 30, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.413 Vali Acc: 0.919 Test Loss: 0.413 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 1046406
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5372400283813477
Epoch: 1, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.861 Vali Acc: 0.107 Test Loss: 1.861 Test Acc: 0.107
Validation loss decreased (inf --> -0.107389).  Saving model ...
Epoch: 2 cost time: 0.734149694442749
Epoch: 2, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.823 Vali Acc: 0.126 Test Loss: 1.823 Test Acc: 0.126
Validation loss decreased (-0.107389 --> -0.125908).  Saving model ...
Epoch: 3 cost time: 0.7268435955047607
Epoch: 3, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.794 Vali Acc: 0.148 Test Loss: 1.794 Test Acc: 0.148
Validation loss decreased (-0.125908 --> -0.148130).  Saving model ...
Epoch: 4 cost time: 0.7362892627716064
Epoch: 4, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.764 Vali Acc: 0.170 Test Loss: 1.764 Test Acc: 0.170
Validation loss decreased (-0.148130 --> -0.170353).  Saving model ...
Epoch: 5 cost time: 0.772998571395874
Epoch: 5, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.725 Vali Acc: 0.222 Test Loss: 1.725 Test Acc: 0.222
Validation loss decreased (-0.170353 --> -0.222205).  Saving model ...
Epoch: 6 cost time: 0.7127885818481445
Epoch: 6, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.679 Vali Acc: 0.259 Test Loss: 1.679 Test Acc: 0.259
Validation loss decreased (-0.222205 --> -0.259242).  Saving model ...
Epoch: 7 cost time: 0.7385861873626709
Epoch: 7, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.628 Vali Acc: 0.285 Test Loss: 1.628 Test Acc: 0.285
Validation loss decreased (-0.259242 --> -0.285169).  Saving model ...
Epoch: 8 cost time: 0.7121946811676025
Epoch: 8, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.574 Vali Acc: 0.344 Test Loss: 1.574 Test Acc: 0.344
Validation loss decreased (-0.285169 --> -0.344429).  Saving model ...
Epoch: 9 cost time: 0.7660999298095703
Epoch: 9, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.516 Vali Acc: 0.437 Test Loss: 1.516 Test Acc: 0.437
Validation loss decreased (-0.344429 --> -0.437022).  Saving model ...
Epoch: 10 cost time: 0.7190456390380859
Epoch: 10, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.457 Vali Acc: 0.589 Test Loss: 1.457 Test Acc: 0.589
Validation loss decreased (-0.437022 --> -0.588874).  Saving model ...
Epoch: 11 cost time: 0.7464323043823242
Epoch: 11, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.396 Vali Acc: 0.659 Test Loss: 1.396 Test Acc: 0.659
Validation loss decreased (-0.588874 --> -0.659245).  Saving model ...
Epoch: 12 cost time: 0.7032241821289062
Epoch: 12, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.333 Vali Acc: 0.707 Test Loss: 1.333 Test Acc: 0.707
Validation loss decreased (-0.659245 --> -0.707394).  Saving model ...
Epoch: 13 cost time: 0.7584085464477539
Epoch: 13, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.270 Vali Acc: 0.726 Test Loss: 1.270 Test Acc: 0.726
Validation loss decreased (-0.707394 --> -0.725913).  Saving model ...
Epoch: 14 cost time: 0.7882900238037109
Epoch: 14, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.208 Vali Acc: 0.748 Test Loss: 1.208 Test Acc: 0.748
Validation loss decreased (-0.725913 --> -0.748136).  Saving model ...
Epoch: 15 cost time: 0.75498366355896
Epoch: 15, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.146 Vali Acc: 0.778 Test Loss: 1.146 Test Acc: 0.778
Validation loss decreased (-0.748136 --> -0.777766).  Saving model ...
Epoch: 16 cost time: 0.7447843551635742
Epoch: 16, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.085 Vali Acc: 0.800 Test Loss: 1.085 Test Acc: 0.800
Validation loss decreased (-0.777766 --> -0.799989).  Saving model ...
Epoch: 17 cost time: 0.7473533153533936
Epoch: 17, Steps: 2 | Train Loss: 0.934 Vali Loss: 1.027 Vali Acc: 0.815 Test Loss: 1.027 Test Acc: 0.815
Validation loss decreased (-0.799989 --> -0.814805).  Saving model ...
Epoch: 18 cost time: 0.7596378326416016
Epoch: 18, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.970 Vali Acc: 0.841 Test Loss: 0.970 Test Acc: 0.841
Validation loss decreased (-0.814805 --> -0.840731).  Saving model ...
Epoch: 19 cost time: 0.7346034049987793
Epoch: 19, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.915 Vali Acc: 0.848 Test Loss: 0.915 Test Acc: 0.848
Validation loss decreased (-0.840731 --> -0.848139).  Saving model ...
Epoch: 20 cost time: 0.8094172477722168
Epoch: 20, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.862 Vali Acc: 0.859 Test Loss: 0.862 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859251).  Saving model ...
Epoch: 21 cost time: 0.7491066455841064
Epoch: 21, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.810 Vali Acc: 0.874 Test Loss: 0.810 Test Acc: 0.874
Validation loss decreased (-0.859251 --> -0.874066).  Saving model ...
Epoch: 22 cost time: 0.7322490215301514
Epoch: 22, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.761 Vali Acc: 0.881 Test Loss: 0.761 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881474).  Saving model ...
Epoch: 23 cost time: 0.7185156345367432
Epoch: 23, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.714 Vali Acc: 0.900 Test Loss: 0.714 Test Acc: 0.900
Validation loss decreased (-0.881474 --> -0.899993).  Saving model ...
Epoch: 24 cost time: 0.7916221618652344
Epoch: 24, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.671 Vali Acc: 0.907 Test Loss: 0.671 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907401).  Saving model ...
Epoch: 25 cost time: 0.758636474609375
Epoch: 25, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.630 Vali Acc: 0.911 Test Loss: 0.630 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 26 cost time: 0.8120965957641602
Epoch: 26, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.592 Vali Acc: 0.907 Test Loss: 0.592 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7713110446929932
Epoch: 27, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.556 Vali Acc: 0.907 Test Loss: 0.556 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.746417760848999
Epoch: 28, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.523 Vali Acc: 0.911 Test Loss: 0.523 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911106).  Saving model ...
Epoch: 29 cost time: 0.7364311218261719
Epoch: 29, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.493 Vali Acc: 0.915 Test Loss: 0.493 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 30 cost time: 0.717139720916748
Epoch: 30, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.465 Vali Acc: 0.915 Test Loss: 0.465 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 1771398
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3101613521575928
Epoch: 1, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.867 Vali Acc: 0.119 Test Loss: 1.867 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.6753098964691162
Epoch: 2, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.831 Vali Acc: 0.130 Test Loss: 1.831 Test Acc: 0.130
Validation loss decreased (-0.118500 --> -0.129611).  Saving model ...
Epoch: 3 cost time: 0.6616086959838867
Epoch: 3, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.803 Vali Acc: 0.137 Test Loss: 1.803 Test Acc: 0.137
Validation loss decreased (-0.129611 --> -0.137019).  Saving model ...
Epoch: 4 cost time: 0.6418936252593994
Epoch: 4, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.774 Vali Acc: 0.144 Test Loss: 1.774 Test Acc: 0.144
Validation loss decreased (-0.137019 --> -0.144427).  Saving model ...
Epoch: 5 cost time: 0.6433939933776855
Epoch: 5, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.737 Vali Acc: 0.167 Test Loss: 1.737 Test Acc: 0.167
Validation loss decreased (-0.144427 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 0.6737964153289795
Epoch: 6, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.693 Vali Acc: 0.193 Test Loss: 1.693 Test Acc: 0.193
Validation loss decreased (-0.166649 --> -0.192576).  Saving model ...
Epoch: 7 cost time: 0.6747941970825195
Epoch: 7, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.643 Vali Acc: 0.259 Test Loss: 1.643 Test Acc: 0.259
Validation loss decreased (-0.192576 --> -0.259243).  Saving model ...
Epoch: 8 cost time: 0.6751546859741211
Epoch: 8, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.590 Vali Acc: 0.363 Test Loss: 1.590 Test Acc: 0.363
Validation loss decreased (-0.259243 --> -0.362947).  Saving model ...
Epoch: 9 cost time: 0.6615567207336426
Epoch: 9, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.532 Vali Acc: 0.437 Test Loss: 1.532 Test Acc: 0.437
Validation loss decreased (-0.362947 --> -0.437022).  Saving model ...
Epoch: 10 cost time: 0.6859688758850098
Epoch: 10, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.472 Vali Acc: 0.504 Test Loss: 1.472 Test Acc: 0.504
Validation loss decreased (-0.437022 --> -0.503689).  Saving model ...
Epoch: 11 cost time: 0.6610193252563477
Epoch: 11, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.410 Vali Acc: 0.530 Test Loss: 1.410 Test Acc: 0.530
Validation loss decreased (-0.503689 --> -0.529616).  Saving model ...
Epoch: 12 cost time: 0.6573276519775391
Epoch: 12, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.347 Vali Acc: 0.593 Test Loss: 1.347 Test Acc: 0.593
Validation loss decreased (-0.529616 --> -0.592579).  Saving model ...
Epoch: 13 cost time: 0.632117509841919
Epoch: 13, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.283 Vali Acc: 0.648 Test Loss: 1.283 Test Acc: 0.648
Validation loss decreased (-0.592579 --> -0.648135).  Saving model ...
Epoch: 14 cost time: 0.6833844184875488
Epoch: 14, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.219 Vali Acc: 0.707 Test Loss: 1.219 Test Acc: 0.707
Validation loss decreased (-0.648135 --> -0.707395).  Saving model ...
Epoch: 15 cost time: 0.6891281604766846
Epoch: 15, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.156 Vali Acc: 0.748 Test Loss: 1.156 Test Acc: 0.748
Validation loss decreased (-0.707395 --> -0.748137).  Saving model ...
Epoch: 16 cost time: 0.654010534286499
Epoch: 16, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.094 Vali Acc: 0.774 Test Loss: 1.094 Test Acc: 0.774
Validation loss decreased (-0.748137 --> -0.774063).  Saving model ...
Epoch: 17 cost time: 0.7104787826538086
Epoch: 17, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.035 Vali Acc: 0.804 Test Loss: 1.035 Test Acc: 0.804
Validation loss decreased (-0.774063 --> -0.803693).  Saving model ...
Epoch: 18 cost time: 0.6868739128112793
Epoch: 18, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.976 Vali Acc: 0.807 Test Loss: 0.976 Test Acc: 0.807
Validation loss decreased (-0.803693 --> -0.807398).  Saving model ...
Epoch: 19 cost time: 0.6616771221160889
Epoch: 19, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.920 Vali Acc: 0.822 Test Loss: 0.920 Test Acc: 0.822
Validation loss decreased (-0.807398 --> -0.822213).  Saving model ...
Epoch: 20 cost time: 0.7030029296875
Epoch: 20, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.866 Vali Acc: 0.819 Test Loss: 0.866 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6780433654785156
Epoch: 21, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.815 Vali Acc: 0.833 Test Loss: 0.815 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833325).  Saving model ...
Epoch: 22 cost time: 0.6341228485107422
Epoch: 22, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.766 Vali Acc: 0.844 Test Loss: 0.766 Test Acc: 0.844
Validation loss decreased (-0.833325 --> -0.844437).  Saving model ...
Epoch: 23 cost time: 0.6613421440124512
Epoch: 23, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.721 Vali Acc: 0.863 Test Loss: 0.721 Test Acc: 0.863
Validation loss decreased (-0.844437 --> -0.862956).  Saving model ...
Epoch: 24 cost time: 0.6573412418365479
Epoch: 24, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.679 Vali Acc: 0.867 Test Loss: 0.679 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866660).  Saving model ...
Epoch: 25 cost time: 0.6937398910522461
Epoch: 25, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.640 Vali Acc: 0.870 Test Loss: 0.640 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 26 cost time: 0.6680939197540283
Epoch: 26, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.604 Vali Acc: 0.874 Test Loss: 0.604 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 27 cost time: 0.70530104637146
Epoch: 27, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.571 Vali Acc: 0.881 Test Loss: 0.571 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 28 cost time: 0.655031681060791
Epoch: 28, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.541 Vali Acc: 0.881 Test Loss: 0.541 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 29 cost time: 0.6637306213378906
Epoch: 29, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.514 Vali Acc: 0.893 Test Loss: 0.514 Test Acc: 0.893
Validation loss decreased (-0.881476 --> -0.892587).  Saving model ...
Epoch: 30 cost time: 0.6995165348052979
Epoch: 30, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.490 Vali Acc: 0.896 Test Loss: 0.490 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8962962962962963
model parameter : 529926
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.300621509552002
Epoch: 1, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.861 Vali Acc: 0.107 Test Loss: 1.861 Test Acc: 0.107
Validation loss decreased (inf --> -0.107389).  Saving model ...
Epoch: 2 cost time: 0.6475684642791748
Epoch: 2, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.823 Vali Acc: 0.126 Test Loss: 1.823 Test Acc: 0.126
Validation loss decreased (-0.107389 --> -0.125908).  Saving model ...
Epoch: 3 cost time: 0.6622374057769775
Epoch: 3, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.794 Vali Acc: 0.148 Test Loss: 1.794 Test Acc: 0.148
Validation loss decreased (-0.125908 --> -0.148130).  Saving model ...
Epoch: 4 cost time: 0.7401041984558105
Epoch: 4, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.764 Vali Acc: 0.170 Test Loss: 1.764 Test Acc: 0.170
Validation loss decreased (-0.148130 --> -0.170353).  Saving model ...
Epoch: 5 cost time: 0.793809175491333
Epoch: 5, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.725 Vali Acc: 0.222 Test Loss: 1.725 Test Acc: 0.222
Validation loss decreased (-0.170353 --> -0.222205).  Saving model ...
Epoch: 6 cost time: 0.7437489032745361
Epoch: 6, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.679 Vali Acc: 0.259 Test Loss: 1.679 Test Acc: 0.259
Validation loss decreased (-0.222205 --> -0.259242).  Saving model ...
Epoch: 7 cost time: 0.7041850090026855
Epoch: 7, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.628 Vali Acc: 0.285 Test Loss: 1.628 Test Acc: 0.285
Validation loss decreased (-0.259242 --> -0.285169).  Saving model ...
Epoch: 8 cost time: 0.6854231357574463
Epoch: 8, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.574 Vali Acc: 0.344 Test Loss: 1.574 Test Acc: 0.344
Validation loss decreased (-0.285169 --> -0.344429).  Saving model ...
Epoch: 9 cost time: 0.6796150207519531
Epoch: 9, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.516 Vali Acc: 0.437 Test Loss: 1.516 Test Acc: 0.437
Validation loss decreased (-0.344429 --> -0.437022).  Saving model ...
Epoch: 10 cost time: 0.6694514751434326
Epoch: 10, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.457 Vali Acc: 0.589 Test Loss: 1.457 Test Acc: 0.589
Validation loss decreased (-0.437022 --> -0.588874).  Saving model ...
Epoch: 11 cost time: 0.6656103134155273
Epoch: 11, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.396 Vali Acc: 0.659 Test Loss: 1.396 Test Acc: 0.659
Validation loss decreased (-0.588874 --> -0.659245).  Saving model ...
Epoch: 12 cost time: 0.8349907398223877
Epoch: 12, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.333 Vali Acc: 0.707 Test Loss: 1.333 Test Acc: 0.707
Validation loss decreased (-0.659245 --> -0.707394).  Saving model ...
Epoch: 13 cost time: 0.8672194480895996
Epoch: 13, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.270 Vali Acc: 0.726 Test Loss: 1.270 Test Acc: 0.726
Validation loss decreased (-0.707394 --> -0.725913).  Saving model ...
Epoch: 14 cost time: 0.7288742065429688
Epoch: 14, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.208 Vali Acc: 0.748 Test Loss: 1.208 Test Acc: 0.748
Validation loss decreased (-0.725913 --> -0.748136).  Saving model ...
Epoch: 15 cost time: 0.7899577617645264
Epoch: 15, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.146 Vali Acc: 0.778 Test Loss: 1.146 Test Acc: 0.778
Validation loss decreased (-0.748136 --> -0.777766).  Saving model ...
Epoch: 16 cost time: 0.7169318199157715
Epoch: 16, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.085 Vali Acc: 0.800 Test Loss: 1.085 Test Acc: 0.800
Validation loss decreased (-0.777766 --> -0.799989).  Saving model ...
Epoch: 17 cost time: 0.6936008930206299
Epoch: 17, Steps: 2 | Train Loss: 0.934 Vali Loss: 1.027 Vali Acc: 0.815 Test Loss: 1.027 Test Acc: 0.815
Validation loss decreased (-0.799989 --> -0.814805).  Saving model ...
Epoch: 18 cost time: 0.6626098155975342
Epoch: 18, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.970 Vali Acc: 0.841 Test Loss: 0.970 Test Acc: 0.841
Validation loss decreased (-0.814805 --> -0.840731).  Saving model ...
Epoch: 19 cost time: 0.6483845710754395
Epoch: 19, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.915 Vali Acc: 0.848 Test Loss: 0.915 Test Acc: 0.848
Validation loss decreased (-0.840731 --> -0.848139).  Saving model ...
Epoch: 20 cost time: 0.6814758777618408
Epoch: 20, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.862 Vali Acc: 0.859 Test Loss: 0.862 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859251).  Saving model ...
Epoch: 21 cost time: 0.6661872863769531
Epoch: 21, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.810 Vali Acc: 0.874 Test Loss: 0.810 Test Acc: 0.874
Validation loss decreased (-0.859251 --> -0.874066).  Saving model ...
Epoch: 22 cost time: 0.6332190036773682
Epoch: 22, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.761 Vali Acc: 0.881 Test Loss: 0.761 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881474).  Saving model ...
Epoch: 23 cost time: 0.6376843452453613
Epoch: 23, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.714 Vali Acc: 0.900 Test Loss: 0.714 Test Acc: 0.900
Validation loss decreased (-0.881474 --> -0.899993).  Saving model ...
Epoch: 24 cost time: 0.6450204849243164
Epoch: 24, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.671 Vali Acc: 0.907 Test Loss: 0.671 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907401).  Saving model ...
Epoch: 25 cost time: 0.6021134853363037
Epoch: 25, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.630 Vali Acc: 0.911 Test Loss: 0.630 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 26 cost time: 0.6561751365661621
Epoch: 26, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.592 Vali Acc: 0.907 Test Loss: 0.592 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6616837978363037
Epoch: 27, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.556 Vali Acc: 0.907 Test Loss: 0.556 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6398108005523682
Epoch: 28, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.523 Vali Acc: 0.911 Test Loss: 0.523 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911106).  Saving model ...
Epoch: 29 cost time: 0.7407348155975342
Epoch: 29, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.493 Vali Acc: 0.915 Test Loss: 0.493 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 30 cost time: 0.7018795013427734
Epoch: 30, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.465 Vali Acc: 0.915 Test Loss: 0.465 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 1771398
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0160348415374756
Epoch: 1, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.867 Vali Acc: 0.119 Test Loss: 1.867 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.5641794204711914
Epoch: 2, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.831 Vali Acc: 0.130 Test Loss: 1.831 Test Acc: 0.130
Validation loss decreased (-0.118500 --> -0.129611).  Saving model ...
Epoch: 3 cost time: 0.642357349395752
Epoch: 3, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.803 Vali Acc: 0.137 Test Loss: 1.803 Test Acc: 0.137
Validation loss decreased (-0.129611 --> -0.137019).  Saving model ...
Epoch: 4 cost time: 0.5949914455413818
Epoch: 4, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.774 Vali Acc: 0.144 Test Loss: 1.774 Test Acc: 0.144
Validation loss decreased (-0.137019 --> -0.144427).  Saving model ...
Epoch: 5 cost time: 0.6033682823181152
Epoch: 5, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.737 Vali Acc: 0.167 Test Loss: 1.737 Test Acc: 0.167
Validation loss decreased (-0.144427 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 0.5998826026916504
Epoch: 6, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.693 Vali Acc: 0.193 Test Loss: 1.693 Test Acc: 0.193
Validation loss decreased (-0.166649 --> -0.192576).  Saving model ...
Epoch: 7 cost time: 0.5984563827514648
Epoch: 7, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.643 Vali Acc: 0.259 Test Loss: 1.643 Test Acc: 0.259
Validation loss decreased (-0.192576 --> -0.259243).  Saving model ...
Epoch: 8 cost time: 0.5773441791534424
Epoch: 8, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.590 Vali Acc: 0.363 Test Loss: 1.590 Test Acc: 0.363
Validation loss decreased (-0.259243 --> -0.362947).  Saving model ...
Epoch: 9 cost time: 0.6032798290252686
Epoch: 9, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.532 Vali Acc: 0.437 Test Loss: 1.532 Test Acc: 0.437
Validation loss decreased (-0.362947 --> -0.437022).  Saving model ...
Epoch: 10 cost time: 0.590740442276001
Epoch: 10, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.472 Vali Acc: 0.504 Test Loss: 1.472 Test Acc: 0.504
Validation loss decreased (-0.437022 --> -0.503689).  Saving model ...
Epoch: 11 cost time: 0.6902296543121338
Epoch: 11, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.410 Vali Acc: 0.530 Test Loss: 1.410 Test Acc: 0.530
Validation loss decreased (-0.503689 --> -0.529616).  Saving model ...
Epoch: 12 cost time: 0.6574287414550781
Epoch: 12, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.347 Vali Acc: 0.593 Test Loss: 1.347 Test Acc: 0.593
Validation loss decreased (-0.529616 --> -0.592579).  Saving model ...
Epoch: 13 cost time: 0.6555976867675781
Epoch: 13, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.283 Vali Acc: 0.648 Test Loss: 1.283 Test Acc: 0.648
Validation loss decreased (-0.592579 --> -0.648135).  Saving model ...
Epoch: 14 cost time: 0.6164326667785645
Epoch: 14, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.219 Vali Acc: 0.707 Test Loss: 1.219 Test Acc: 0.707
Validation loss decreased (-0.648135 --> -0.707395).  Saving model ...
Epoch: 15 cost time: 0.6302852630615234
Epoch: 15, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.156 Vali Acc: 0.748 Test Loss: 1.156 Test Acc: 0.748
Validation loss decreased (-0.707395 --> -0.748137).  Saving model ...
Epoch: 16 cost time: 0.5953171253204346
Epoch: 16, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.094 Vali Acc: 0.774 Test Loss: 1.094 Test Acc: 0.774
Validation loss decreased (-0.748137 --> -0.774063).  Saving model ...
Epoch: 17 cost time: 0.6297392845153809
Epoch: 17, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.034 Vali Acc: 0.804 Test Loss: 1.034 Test Acc: 0.804
Validation loss decreased (-0.774063 --> -0.803693).  Saving model ...
Epoch: 18 cost time: 0.7370102405548096
Epoch: 18, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.976 Vali Acc: 0.807 Test Loss: 0.976 Test Acc: 0.807
Validation loss decreased (-0.803693 --> -0.807398).  Saving model ...
Epoch: 19 cost time: 0.6388418674468994
Epoch: 19, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.920 Vali Acc: 0.822 Test Loss: 0.920 Test Acc: 0.822
Validation loss decreased (-0.807398 --> -0.822213).  Saving model ...
Epoch: 20 cost time: 0.6477377414703369
Epoch: 20, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.866 Vali Acc: 0.819 Test Loss: 0.866 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6381750106811523
Epoch: 21, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.814 Vali Acc: 0.833 Test Loss: 0.814 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833325).  Saving model ...
Epoch: 22 cost time: 0.6114358901977539
Epoch: 22, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.766 Vali Acc: 0.844 Test Loss: 0.766 Test Acc: 0.844
Validation loss decreased (-0.833325 --> -0.844437).  Saving model ...
Epoch: 23 cost time: 0.6188981533050537
Epoch: 23, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.721 Vali Acc: 0.863 Test Loss: 0.721 Test Acc: 0.863
Validation loss decreased (-0.844437 --> -0.862956).  Saving model ...
Epoch: 24 cost time: 0.6186094284057617
Epoch: 24, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.679 Vali Acc: 0.867 Test Loss: 0.679 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866660).  Saving model ...
Epoch: 25 cost time: 0.6809797286987305
Epoch: 25, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.640 Vali Acc: 0.870 Test Loss: 0.640 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 26 cost time: 0.6417808532714844
Epoch: 26, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.604 Vali Acc: 0.874 Test Loss: 0.604 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 27 cost time: 0.5905334949493408
Epoch: 27, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.571 Vali Acc: 0.885 Test Loss: 0.571 Test Acc: 0.885
Validation loss decreased (-0.874068 --> -0.885179).  Saving model ...
Epoch: 28 cost time: 0.5868406295776367
Epoch: 28, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.541 Vali Acc: 0.885 Test Loss: 0.541 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885180).  Saving model ...
Epoch: 29 cost time: 0.6232395172119141
Epoch: 29, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.514 Vali Acc: 0.896 Test Loss: 0.514 Test Acc: 0.896
Validation loss decreased (-0.885180 --> -0.896291).  Saving model ...
Epoch: 30 cost time: 0.6263575553894043
Epoch: 30, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.490 Vali Acc: 0.896 Test Loss: 0.490 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8962962962962963
model parameter : 529926
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9791679382324219
Epoch: 1, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.861 Vali Acc: 0.111 Test Loss: 1.861 Test Acc: 0.111
Validation loss decreased (inf --> -0.111093).  Saving model ...
Epoch: 2 cost time: 0.5712728500366211
Epoch: 2, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.824 Vali Acc: 0.126 Test Loss: 1.824 Test Acc: 0.126
Validation loss decreased (-0.111093 --> -0.125908).  Saving model ...
Epoch: 3 cost time: 0.5377442836761475
Epoch: 3, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.795 Vali Acc: 0.148 Test Loss: 1.795 Test Acc: 0.148
Validation loss decreased (-0.125908 --> -0.148130).  Saving model ...
Epoch: 4 cost time: 0.5880651473999023
Epoch: 4, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.764 Vali Acc: 0.167 Test Loss: 1.764 Test Acc: 0.167
Validation loss decreased (-0.148130 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 0.5507183074951172
Epoch: 5, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.726 Vali Acc: 0.207 Test Loss: 1.726 Test Acc: 0.207
Validation loss decreased (-0.166649 --> -0.207390).  Saving model ...
Epoch: 6 cost time: 0.5519754886627197
Epoch: 6, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.681 Vali Acc: 0.256 Test Loss: 1.681 Test Acc: 0.256
Validation loss decreased (-0.207390 --> -0.255539).  Saving model ...
Epoch: 7 cost time: 0.5916669368743896
Epoch: 7, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.631 Vali Acc: 0.281 Test Loss: 1.631 Test Acc: 0.281
Validation loss decreased (-0.255539 --> -0.281465).  Saving model ...
Epoch: 8 cost time: 0.6448068618774414
Epoch: 8, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.577 Vali Acc: 0.337 Test Loss: 1.577 Test Acc: 0.337
Validation loss decreased (-0.281465 --> -0.337021).  Saving model ...
Epoch: 9 cost time: 0.6110193729400635
Epoch: 9, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.520 Vali Acc: 0.437 Test Loss: 1.520 Test Acc: 0.437
Validation loss decreased (-0.337021 --> -0.437022).  Saving model ...
Epoch: 10 cost time: 0.5555682182312012
Epoch: 10, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.461 Vali Acc: 0.593 Test Loss: 1.461 Test Acc: 0.593
Validation loss decreased (-0.437022 --> -0.592578).  Saving model ...
Epoch: 11 cost time: 0.5904529094696045
Epoch: 11, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.400 Vali Acc: 0.663 Test Loss: 1.400 Test Acc: 0.663
Validation loss decreased (-0.592578 --> -0.662949).  Saving model ...
Epoch: 12 cost time: 0.5618526935577393
Epoch: 12, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.338 Vali Acc: 0.707 Test Loss: 1.338 Test Acc: 0.707
Validation loss decreased (-0.662949 --> -0.707394).  Saving model ...
Epoch: 13 cost time: 0.6338827610015869
Epoch: 13, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.276 Vali Acc: 0.726 Test Loss: 1.276 Test Acc: 0.726
Validation loss decreased (-0.707394 --> -0.725913).  Saving model ...
Epoch: 14 cost time: 0.5867366790771484
Epoch: 14, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.214 Vali Acc: 0.744 Test Loss: 1.214 Test Acc: 0.744
Validation loss decreased (-0.725913 --> -0.744432).  Saving model ...
Epoch: 15 cost time: 0.5759742259979248
Epoch: 15, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.152 Vali Acc: 0.774 Test Loss: 1.152 Test Acc: 0.774
Validation loss decreased (-0.744432 --> -0.774063).  Saving model ...
Epoch: 16 cost time: 0.5472722053527832
Epoch: 16, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.092 Vali Acc: 0.796 Test Loss: 1.092 Test Acc: 0.796
Validation loss decreased (-0.774063 --> -0.796285).  Saving model ...
Epoch: 17 cost time: 0.6356196403503418
Epoch: 17, Steps: 2 | Train Loss: 0.953 Vali Loss: 1.033 Vali Acc: 0.815 Test Loss: 1.033 Test Acc: 0.815
Validation loss decreased (-0.796285 --> -0.814804).  Saving model ...
Epoch: 18 cost time: 0.5632481575012207
Epoch: 18, Steps: 2 | Train Loss: 0.923 Vali Loss: 0.976 Vali Acc: 0.837 Test Loss: 0.976 Test Acc: 0.837
Validation loss decreased (-0.814804 --> -0.837027).  Saving model ...
Epoch: 19 cost time: 0.5699999332427979
Epoch: 19, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.921 Vali Acc: 0.856 Test Loss: 0.921 Test Acc: 0.856
Validation loss decreased (-0.837027 --> -0.855546).  Saving model ...
Epoch: 20 cost time: 0.575953483581543
Epoch: 20, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.867 Vali Acc: 0.863 Test Loss: 0.867 Test Acc: 0.863
Validation loss decreased (-0.855546 --> -0.862954).  Saving model ...
Epoch: 21 cost time: 0.5656018257141113
Epoch: 21, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.815 Vali Acc: 0.874 Test Loss: 0.815 Test Acc: 0.874
Validation loss decreased (-0.862954 --> -0.874066).  Saving model ...
Epoch: 22 cost time: 0.6440653800964355
Epoch: 22, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.766 Vali Acc: 0.885 Test Loss: 0.766 Test Acc: 0.885
Validation loss decreased (-0.874066 --> -0.885178).  Saving model ...
Epoch: 23 cost time: 0.5731425285339355
Epoch: 23, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.719 Vali Acc: 0.904 Test Loss: 0.719 Test Acc: 0.904
Validation loss decreased (-0.885178 --> -0.903697).  Saving model ...
Epoch: 24 cost time: 0.5513815879821777
Epoch: 24, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.674 Vali Acc: 0.907 Test Loss: 0.674 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 25 cost time: 0.6046364307403564
Epoch: 25, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.633 Vali Acc: 0.911 Test Loss: 0.633 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 26 cost time: 0.5561673641204834
Epoch: 26, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.594 Vali Acc: 0.907 Test Loss: 0.594 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6458628177642822
Epoch: 27, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.559 Vali Acc: 0.907 Test Loss: 0.559 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5749640464782715
Epoch: 28, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.525 Vali Acc: 0.915 Test Loss: 0.525 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914810).  Saving model ...
Epoch: 29 cost time: 0.5666747093200684
Epoch: 29, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.495 Vali Acc: 0.915 Test Loss: 0.495 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 30 cost time: 0.6220920085906982
Epoch: 30, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.466 Vali Acc: 0.915 Test Loss: 0.466 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 1771398
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0246424674987793
Epoch: 1, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.868 Vali Acc: 0.119 Test Loss: 1.868 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.49181509017944336
Epoch: 2, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.832 Vali Acc: 0.130 Test Loss: 1.832 Test Acc: 0.130
Validation loss decreased (-0.118500 --> -0.129611).  Saving model ...
Epoch: 3 cost time: 0.4636802673339844
Epoch: 3, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.804 Vali Acc: 0.137 Test Loss: 1.804 Test Acc: 0.137
Validation loss decreased (-0.129611 --> -0.137019).  Saving model ...
Epoch: 4 cost time: 0.5861184597015381
Epoch: 4, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.776 Vali Acc: 0.144 Test Loss: 1.776 Test Acc: 0.144
Validation loss decreased (-0.137019 --> -0.144427).  Saving model ...
Epoch: 5 cost time: 0.5264320373535156
Epoch: 5, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.738 Vali Acc: 0.167 Test Loss: 1.738 Test Acc: 0.167
Validation loss decreased (-0.144427 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 0.5290756225585938
Epoch: 6, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.695 Vali Acc: 0.189 Test Loss: 1.695 Test Acc: 0.189
Validation loss decreased (-0.166649 --> -0.188872).  Saving model ...
Epoch: 7 cost time: 0.6392776966094971
Epoch: 7, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.645 Vali Acc: 0.256 Test Loss: 1.645 Test Acc: 0.256
Validation loss decreased (-0.188872 --> -0.255539).  Saving model ...
Epoch: 8 cost time: 0.5030951499938965
Epoch: 8, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.592 Vali Acc: 0.359 Test Loss: 1.592 Test Acc: 0.359
Validation loss decreased (-0.255539 --> -0.359243).  Saving model ...
Epoch: 9 cost time: 0.5215795040130615
Epoch: 9, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.535 Vali Acc: 0.437 Test Loss: 1.535 Test Acc: 0.437
Validation loss decreased (-0.359243 --> -0.437022).  Saving model ...
Epoch: 10 cost time: 0.5310192108154297
Epoch: 10, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.475 Vali Acc: 0.500 Test Loss: 1.475 Test Acc: 0.500
Validation loss decreased (-0.437022 --> -0.499985).  Saving model ...
Epoch: 11 cost time: 0.5085279941558838
Epoch: 11, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.414 Vali Acc: 0.526 Test Loss: 1.414 Test Acc: 0.526
Validation loss decreased (-0.499985 --> -0.525912).  Saving model ...
Epoch: 12 cost time: 0.5171513557434082
Epoch: 12, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.351 Vali Acc: 0.589 Test Loss: 1.351 Test Acc: 0.589
Validation loss decreased (-0.525912 --> -0.588875).  Saving model ...
Epoch: 13 cost time: 0.49589967727661133
Epoch: 13, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.287 Vali Acc: 0.644 Test Loss: 1.287 Test Acc: 0.644
Validation loss decreased (-0.588875 --> -0.644432).  Saving model ...
Epoch: 14 cost time: 0.4986298084259033
Epoch: 14, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.224 Vali Acc: 0.696 Test Loss: 1.224 Test Acc: 0.696
Validation loss decreased (-0.644432 --> -0.696284).  Saving model ...
Epoch: 15 cost time: 0.5187125205993652
Epoch: 15, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.161 Vali Acc: 0.741 Test Loss: 1.161 Test Acc: 0.741
Validation loss decreased (-0.696284 --> -0.740729).  Saving model ...
Epoch: 16 cost time: 0.49623775482177734
Epoch: 16, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.099 Vali Acc: 0.770 Test Loss: 1.099 Test Acc: 0.770
Validation loss decreased (-0.740729 --> -0.770359).  Saving model ...
Epoch: 17 cost time: 0.5049610137939453
Epoch: 17, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.040 Vali Acc: 0.800 Test Loss: 1.040 Test Acc: 0.800
Validation loss decreased (-0.770359 --> -0.799990).  Saving model ...
Epoch: 18 cost time: 0.5358326435089111
Epoch: 18, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.981 Vali Acc: 0.804 Test Loss: 0.981 Test Acc: 0.804
Validation loss decreased (-0.799990 --> -0.803694).  Saving model ...
Epoch: 19 cost time: 0.5257055759429932
Epoch: 19, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.926 Vali Acc: 0.819 Test Loss: 0.926 Test Acc: 0.819
Validation loss decreased (-0.803694 --> -0.818509).  Saving model ...
Epoch: 20 cost time: 0.5266852378845215
Epoch: 20, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.872 Vali Acc: 0.819 Test Loss: 0.872 Test Acc: 0.819
Validation loss decreased (-0.818509 --> -0.818510).  Saving model ...
Epoch: 21 cost time: 0.5398669242858887
Epoch: 21, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.821 Vali Acc: 0.833 Test Loss: 0.821 Test Acc: 0.833
Validation loss decreased (-0.818510 --> -0.833325).  Saving model ...
Epoch: 22 cost time: 0.5940272808074951
Epoch: 22, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.772 Vali Acc: 0.848 Test Loss: 0.772 Test Acc: 0.848
Validation loss decreased (-0.833325 --> -0.848140).  Saving model ...
Epoch: 23 cost time: 0.60451340675354
Epoch: 23, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.727 Vali Acc: 0.863 Test Loss: 0.727 Test Acc: 0.863
Validation loss decreased (-0.848140 --> -0.862956).  Saving model ...
Epoch: 24 cost time: 0.5248961448669434
Epoch: 24, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.685 Vali Acc: 0.867 Test Loss: 0.685 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866660).  Saving model ...
Epoch: 25 cost time: 0.5141069889068604
Epoch: 25, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.646 Vali Acc: 0.870 Test Loss: 0.646 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 26 cost time: 0.5123195648193359
Epoch: 26, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.610 Vali Acc: 0.874 Test Loss: 0.610 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 27 cost time: 0.5262572765350342
Epoch: 27, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.577 Vali Acc: 0.881 Test Loss: 0.577 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 28 cost time: 0.5028138160705566
Epoch: 28, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.547 Vali Acc: 0.881 Test Loss: 0.547 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 29 cost time: 0.5064070224761963
Epoch: 29, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.520 Vali Acc: 0.889 Test Loss: 0.520 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 30 cost time: 0.5274505615234375
Epoch: 30, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.496 Vali Acc: 0.889 Test Loss: 0.496 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8888888888888888
model parameter : 529926
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3564085960388184
Epoch: 1, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.806 Vali Acc: 0.167 Test Loss: 1.806 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.7770073413848877
Epoch: 2, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.779 Vali Acc: 0.167 Test Loss: 1.779 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.7521388530731201
Epoch: 3, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.759 Vali Acc: 0.167 Test Loss: 1.759 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 0.7787928581237793
Epoch: 4, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.741 Vali Acc: 0.170 Test Loss: 1.741 Test Acc: 0.170
Validation loss decreased (-0.166649 --> -0.170353).  Saving model ...
Epoch: 5 cost time: 0.7588448524475098
Epoch: 5, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.717 Vali Acc: 0.181 Test Loss: 1.717 Test Acc: 0.181
Validation loss decreased (-0.170353 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.7561626434326172
Epoch: 6, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.689 Vali Acc: 0.196 Test Loss: 1.689 Test Acc: 0.196
Validation loss decreased (-0.181464 --> -0.196279).  Saving model ...
Epoch: 7 cost time: 0.7535014152526855
Epoch: 7, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.658 Vali Acc: 0.211 Test Loss: 1.658 Test Acc: 0.211
Validation loss decreased (-0.196279 --> -0.211095).  Saving model ...
Epoch: 8 cost time: 0.8143188953399658
Epoch: 8, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.625 Vali Acc: 0.244 Test Loss: 1.625 Test Acc: 0.244
Validation loss decreased (-0.211095 --> -0.244428).  Saving model ...
Epoch: 9 cost time: 0.767348051071167
Epoch: 9, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.589 Vali Acc: 0.296 Test Loss: 1.589 Test Acc: 0.296
Validation loss decreased (-0.244428 --> -0.296280).  Saving model ...
Epoch: 10 cost time: 0.8226666450500488
Epoch: 10, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.551 Vali Acc: 0.407 Test Loss: 1.551 Test Acc: 0.407
Validation loss decreased (-0.296280 --> -0.407392).  Saving model ...
Epoch: 11 cost time: 0.6975100040435791
Epoch: 11, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.512 Vali Acc: 0.493 Test Loss: 1.512 Test Acc: 0.493
Validation loss decreased (-0.407392 --> -0.492577).  Saving model ...
Epoch: 12 cost time: 0.781470775604248
Epoch: 12, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.472 Vali Acc: 0.544 Test Loss: 1.472 Test Acc: 0.544
Validation loss decreased (-0.492577 --> -0.544430).  Saving model ...
Epoch: 13 cost time: 0.7964873313903809
Epoch: 13, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.432 Vali Acc: 0.585 Test Loss: 1.432 Test Acc: 0.585
Validation loss decreased (-0.544430 --> -0.585171).  Saving model ...
Epoch: 14 cost time: 0.7933666706085205
Epoch: 14, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.390 Vali Acc: 0.637 Test Loss: 1.390 Test Acc: 0.637
Validation loss decreased (-0.585171 --> -0.637023).  Saving model ...
Epoch: 15 cost time: 0.7433106899261475
Epoch: 15, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.348 Vali Acc: 0.696 Test Loss: 1.348 Test Acc: 0.696
Validation loss decreased (-0.637023 --> -0.696283).  Saving model ...
Epoch: 16 cost time: 0.754035234451294
Epoch: 16, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.306 Vali Acc: 0.730 Test Loss: 1.306 Test Acc: 0.730
Validation loss decreased (-0.696283 --> -0.729617).  Saving model ...
Epoch: 17 cost time: 0.7071185111999512
Epoch: 17, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.263 Vali Acc: 0.744 Test Loss: 1.263 Test Acc: 0.744
Validation loss decreased (-0.729617 --> -0.744432).  Saving model ...
Epoch: 18 cost time: 0.7740833759307861
Epoch: 18, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.219 Vali Acc: 0.767 Test Loss: 1.219 Test Acc: 0.767
Validation loss decreased (-0.744432 --> -0.766654).  Saving model ...
Epoch: 19 cost time: 0.7740504741668701
Epoch: 19, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.177 Vali Acc: 0.789 Test Loss: 1.177 Test Acc: 0.789
Validation loss decreased (-0.766654 --> -0.788877).  Saving model ...
Epoch: 20 cost time: 0.6969983577728271
Epoch: 20, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.134 Vali Acc: 0.807 Test Loss: 1.134 Test Acc: 0.807
Validation loss decreased (-0.788877 --> -0.807396).  Saving model ...
Epoch: 21 cost time: 0.812342643737793
Epoch: 21, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.092 Vali Acc: 0.811 Test Loss: 1.092 Test Acc: 0.811
Validation loss decreased (-0.807396 --> -0.811100).  Saving model ...
Epoch: 22 cost time: 0.7528374195098877
Epoch: 22, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.050 Vali Acc: 0.826 Test Loss: 1.050 Test Acc: 0.826
Validation loss decreased (-0.811100 --> -0.825915).  Saving model ...
Epoch: 23 cost time: 0.827892541885376
Epoch: 23, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.009 Vali Acc: 0.837 Test Loss: 1.009 Test Acc: 0.837
Validation loss decreased (-0.825915 --> -0.837027).  Saving model ...
Epoch: 24 cost time: 0.7659387588500977
Epoch: 24, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.969 Vali Acc: 0.848 Test Loss: 0.969 Test Acc: 0.848
Validation loss decreased (-0.837027 --> -0.848138).  Saving model ...
Epoch: 25 cost time: 0.7548251152038574
Epoch: 25, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.929 Vali Acc: 0.856 Test Loss: 0.929 Test Acc: 0.856
Validation loss decreased (-0.848138 --> -0.855546).  Saving model ...
Epoch: 26 cost time: 0.749647855758667
Epoch: 26, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.891 Vali Acc: 0.870 Test Loss: 0.891 Test Acc: 0.870
Validation loss decreased (-0.855546 --> -0.870361).  Saving model ...
Epoch: 27 cost time: 0.7448420524597168
Epoch: 27, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.854 Vali Acc: 0.874 Test Loss: 0.854 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874066).  Saving model ...
Epoch: 28 cost time: 0.8187458515167236
Epoch: 28, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.819 Vali Acc: 0.881 Test Loss: 0.819 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881473).  Saving model ...
Epoch: 29 cost time: 0.7600586414337158
Epoch: 29, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.785 Vali Acc: 0.881 Test Loss: 0.785 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881474).  Saving model ...
Epoch: 30 cost time: 0.7914538383483887
Epoch: 30, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.753 Vali Acc: 0.881 Test Loss: 0.753 Test Acc: 0.881
Validation loss decreased (-0.881474 --> -0.881474).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8814814814814815
model parameter : 1765158
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.476374626159668
Epoch: 1, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.829 Vali Acc: 0.100 Test Loss: 1.829 Test Acc: 0.100
Validation loss decreased (inf --> -0.099982).  Saving model ...
Epoch: 2 cost time: 0.6638624668121338
Epoch: 2, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.804 Vali Acc: 0.111 Test Loss: 1.804 Test Acc: 0.111
Validation loss decreased (-0.099982 --> -0.111093).  Saving model ...
Epoch: 3 cost time: 0.6489043235778809
Epoch: 3, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.786 Vali Acc: 0.137 Test Loss: 1.786 Test Acc: 0.137
Validation loss decreased (-0.111093 --> -0.137019).  Saving model ...
Epoch: 4 cost time: 0.6778683662414551
Epoch: 4, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.769 Vali Acc: 0.144 Test Loss: 1.769 Test Acc: 0.144
Validation loss decreased (-0.137019 --> -0.144427).  Saving model ...
Epoch: 5 cost time: 0.6804249286651611
Epoch: 5, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.748 Vali Acc: 0.152 Test Loss: 1.748 Test Acc: 0.152
Validation loss decreased (-0.144427 --> -0.151834).  Saving model ...
Epoch: 6 cost time: 0.6277999877929688
Epoch: 6, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.723 Vali Acc: 0.163 Test Loss: 1.723 Test Acc: 0.163
Validation loss decreased (-0.151834 --> -0.162946).  Saving model ...
Epoch: 7 cost time: 0.5758919715881348
Epoch: 7, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.695 Vali Acc: 0.170 Test Loss: 1.695 Test Acc: 0.170
Validation loss decreased (-0.162946 --> -0.170353).  Saving model ...
Epoch: 8 cost time: 0.6607949733734131
Epoch: 8, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.665 Vali Acc: 0.200 Test Loss: 1.665 Test Acc: 0.200
Validation loss decreased (-0.170353 --> -0.199983).  Saving model ...
Epoch: 9 cost time: 0.627429723739624
Epoch: 9, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.633 Vali Acc: 0.289 Test Loss: 1.633 Test Acc: 0.289
Validation loss decreased (-0.199983 --> -0.288873).  Saving model ...
Epoch: 10 cost time: 0.6823022365570068
Epoch: 10, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.598 Vali Acc: 0.344 Test Loss: 1.598 Test Acc: 0.344
Validation loss decreased (-0.288873 --> -0.344428).  Saving model ...
Epoch: 11 cost time: 0.605933427810669
Epoch: 11, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.562 Vali Acc: 0.400 Test Loss: 1.562 Test Acc: 0.400
Validation loss decreased (-0.344428 --> -0.399984).  Saving model ...
Epoch: 12 cost time: 0.624629020690918
Epoch: 12, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.524 Vali Acc: 0.456 Test Loss: 1.524 Test Acc: 0.456
Validation loss decreased (-0.399984 --> -0.455540).  Saving model ...
Epoch: 13 cost time: 0.6346659660339355
Epoch: 13, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.486 Vali Acc: 0.541 Test Loss: 1.486 Test Acc: 0.541
Validation loss decreased (-0.455540 --> -0.540726).  Saving model ...
Epoch: 14 cost time: 0.646242618560791
Epoch: 14, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.447 Vali Acc: 0.607 Test Loss: 1.447 Test Acc: 0.607
Validation loss decreased (-0.540726 --> -0.607393).  Saving model ...
Epoch: 15 cost time: 0.6796252727508545
Epoch: 15, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.407 Vali Acc: 0.663 Test Loss: 1.407 Test Acc: 0.663
Validation loss decreased (-0.607393 --> -0.662949).  Saving model ...
Epoch: 16 cost time: 0.702674388885498
Epoch: 16, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.367 Vali Acc: 0.678 Test Loss: 1.367 Test Acc: 0.678
Validation loss decreased (-0.662949 --> -0.677764).  Saving model ...
Epoch: 17 cost time: 0.7081418037414551
Epoch: 17, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.326 Vali Acc: 0.715 Test Loss: 1.326 Test Acc: 0.715
Validation loss decreased (-0.677764 --> -0.714802).  Saving model ...
Epoch: 18 cost time: 0.6678485870361328
Epoch: 18, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.284 Vali Acc: 0.737 Test Loss: 1.284 Test Acc: 0.737
Validation loss decreased (-0.714802 --> -0.737024).  Saving model ...
Epoch: 19 cost time: 0.661914587020874
Epoch: 19, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.243 Vali Acc: 0.770 Test Loss: 1.243 Test Acc: 0.770
Validation loss decreased (-0.737024 --> -0.770358).  Saving model ...
Epoch: 20 cost time: 0.6902270317077637
Epoch: 20, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.201 Vali Acc: 0.793 Test Loss: 1.201 Test Acc: 0.793
Validation loss decreased (-0.770358 --> -0.792581).  Saving model ...
Epoch: 21 cost time: 0.7059390544891357
Epoch: 21, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.160 Vali Acc: 0.807 Test Loss: 1.160 Test Acc: 0.807
Validation loss decreased (-0.792581 --> -0.807396).  Saving model ...
Epoch: 22 cost time: 0.6283674240112305
Epoch: 22, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.119 Vali Acc: 0.815 Test Loss: 1.119 Test Acc: 0.815
Validation loss decreased (-0.807396 --> -0.814804).  Saving model ...
Epoch: 23 cost time: 0.6960303783416748
Epoch: 23, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.077 Vali Acc: 0.837 Test Loss: 1.077 Test Acc: 0.837
Validation loss decreased (-0.814804 --> -0.837026).  Saving model ...
Epoch: 24 cost time: 0.7507848739624023
Epoch: 24, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.038 Vali Acc: 0.841 Test Loss: 1.038 Test Acc: 0.841
Validation loss decreased (-0.837026 --> -0.840730).  Saving model ...
Epoch: 25 cost time: 0.652869462966919
Epoch: 25, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.999 Vali Acc: 0.844 Test Loss: 0.999 Test Acc: 0.844
Validation loss decreased (-0.840730 --> -0.844434).  Saving model ...
Epoch: 26 cost time: 0.6773543357849121
Epoch: 26, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.962 Vali Acc: 0.852 Test Loss: 0.962 Test Acc: 0.852
Validation loss decreased (-0.844434 --> -0.851842).  Saving model ...
Epoch: 27 cost time: 0.6581950187683105
Epoch: 27, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.926 Vali Acc: 0.848 Test Loss: 0.926 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6747705936431885
Epoch: 28, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.891 Vali Acc: 0.852 Test Loss: 0.891 Test Acc: 0.852
Validation loss decreased (-0.851842 --> -0.851843).  Saving model ...
Epoch: 29 cost time: 0.7530529499053955
Epoch: 29, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.858 Vali Acc: 0.852 Test Loss: 0.858 Test Acc: 0.852
Validation loss decreased (-0.851843 --> -0.851843).  Saving model ...
Epoch: 30 cost time: 0.6602034568786621
Epoch: 30, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.826 Vali Acc: 0.859 Test Loss: 0.826 Test Acc: 0.859
Validation loss decreased (-0.851843 --> -0.859251).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8592592592592593
model parameter : 523590
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3227131366729736
Epoch: 1, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.806 Vali Acc: 0.167 Test Loss: 1.806 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.6861026287078857
Epoch: 2, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.779 Vali Acc: 0.167 Test Loss: 1.779 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.6918418407440186
Epoch: 3, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.759 Vali Acc: 0.167 Test Loss: 1.759 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 0.6748061180114746
Epoch: 4, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.741 Vali Acc: 0.170 Test Loss: 1.741 Test Acc: 0.170
Validation loss decreased (-0.166649 --> -0.170353).  Saving model ...
Epoch: 5 cost time: 0.6763100624084473
Epoch: 5, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.717 Vali Acc: 0.181 Test Loss: 1.717 Test Acc: 0.181
Validation loss decreased (-0.170353 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.6972501277923584
Epoch: 6, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.689 Vali Acc: 0.196 Test Loss: 1.689 Test Acc: 0.196
Validation loss decreased (-0.181464 --> -0.196279).  Saving model ...
Epoch: 7 cost time: 0.7013757228851318
Epoch: 7, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.658 Vali Acc: 0.211 Test Loss: 1.658 Test Acc: 0.211
Validation loss decreased (-0.196279 --> -0.211095).  Saving model ...
Epoch: 8 cost time: 0.6792633533477783
Epoch: 8, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.625 Vali Acc: 0.244 Test Loss: 1.625 Test Acc: 0.244
Validation loss decreased (-0.211095 --> -0.244428).  Saving model ...
Epoch: 9 cost time: 0.6922237873077393
Epoch: 9, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.589 Vali Acc: 0.296 Test Loss: 1.589 Test Acc: 0.296
Validation loss decreased (-0.244428 --> -0.296280).  Saving model ...
Epoch: 10 cost time: 0.6479270458221436
Epoch: 10, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.551 Vali Acc: 0.407 Test Loss: 1.551 Test Acc: 0.407
Validation loss decreased (-0.296280 --> -0.407392).  Saving model ...
Epoch: 11 cost time: 0.6888015270233154
Epoch: 11, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.512 Vali Acc: 0.493 Test Loss: 1.512 Test Acc: 0.493
Validation loss decreased (-0.407392 --> -0.492577).  Saving model ...
Epoch: 12 cost time: 0.7422034740447998
Epoch: 12, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.472 Vali Acc: 0.544 Test Loss: 1.472 Test Acc: 0.544
Validation loss decreased (-0.492577 --> -0.544430).  Saving model ...
Epoch: 13 cost time: 0.7038438320159912
Epoch: 13, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.432 Vali Acc: 0.585 Test Loss: 1.432 Test Acc: 0.585
Validation loss decreased (-0.544430 --> -0.585171).  Saving model ...
Epoch: 14 cost time: 0.7010452747344971
Epoch: 14, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.390 Vali Acc: 0.637 Test Loss: 1.390 Test Acc: 0.637
Validation loss decreased (-0.585171 --> -0.637023).  Saving model ...
Epoch: 15 cost time: 0.6776409149169922
Epoch: 15, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.348 Vali Acc: 0.696 Test Loss: 1.348 Test Acc: 0.696
Validation loss decreased (-0.637023 --> -0.696283).  Saving model ...
Epoch: 16 cost time: 0.7233865261077881
Epoch: 16, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.306 Vali Acc: 0.730 Test Loss: 1.306 Test Acc: 0.730
Validation loss decreased (-0.696283 --> -0.729617).  Saving model ...
Epoch: 17 cost time: 0.6504435539245605
Epoch: 17, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.263 Vali Acc: 0.744 Test Loss: 1.263 Test Acc: 0.744
Validation loss decreased (-0.729617 --> -0.744432).  Saving model ...
Epoch: 18 cost time: 0.7140793800354004
Epoch: 18, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.219 Vali Acc: 0.767 Test Loss: 1.219 Test Acc: 0.767
Validation loss decreased (-0.744432 --> -0.766654).  Saving model ...
Epoch: 19 cost time: 0.7141485214233398
Epoch: 19, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.177 Vali Acc: 0.789 Test Loss: 1.177 Test Acc: 0.789
Validation loss decreased (-0.766654 --> -0.788877).  Saving model ...
Epoch: 20 cost time: 0.7212448120117188
Epoch: 20, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.134 Vali Acc: 0.807 Test Loss: 1.134 Test Acc: 0.807
Validation loss decreased (-0.788877 --> -0.807396).  Saving model ...
Epoch: 21 cost time: 0.72483229637146
Epoch: 21, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.092 Vali Acc: 0.811 Test Loss: 1.092 Test Acc: 0.811
Validation loss decreased (-0.807396 --> -0.811100).  Saving model ...
Epoch: 22 cost time: 0.6949348449707031
Epoch: 22, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.050 Vali Acc: 0.826 Test Loss: 1.050 Test Acc: 0.826
Validation loss decreased (-0.811100 --> -0.825915).  Saving model ...
Epoch: 23 cost time: 0.7181153297424316
Epoch: 23, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.009 Vali Acc: 0.837 Test Loss: 1.009 Test Acc: 0.837
Validation loss decreased (-0.825915 --> -0.837027).  Saving model ...
Epoch: 24 cost time: 0.729799747467041
Epoch: 24, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.969 Vali Acc: 0.848 Test Loss: 0.969 Test Acc: 0.848
Validation loss decreased (-0.837027 --> -0.848138).  Saving model ...
Epoch: 25 cost time: 0.7176985740661621
Epoch: 25, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.929 Vali Acc: 0.856 Test Loss: 0.929 Test Acc: 0.856
Validation loss decreased (-0.848138 --> -0.855546).  Saving model ...
Epoch: 26 cost time: 0.6932163238525391
Epoch: 26, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.891 Vali Acc: 0.870 Test Loss: 0.891 Test Acc: 0.870
Validation loss decreased (-0.855546 --> -0.870361).  Saving model ...
Epoch: 27 cost time: 0.7541449069976807
Epoch: 27, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.854 Vali Acc: 0.874 Test Loss: 0.854 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874066).  Saving model ...
Epoch: 28 cost time: 0.7111775875091553
Epoch: 28, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.819 Vali Acc: 0.881 Test Loss: 0.819 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881473).  Saving model ...
Epoch: 29 cost time: 0.7379202842712402
Epoch: 29, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.785 Vali Acc: 0.881 Test Loss: 0.785 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881474).  Saving model ...
Epoch: 30 cost time: 0.6981940269470215
Epoch: 30, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.753 Vali Acc: 0.881 Test Loss: 0.753 Test Acc: 0.881
Validation loss decreased (-0.881474 --> -0.881474).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8814814814814815
model parameter : 1765158
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1389882564544678
Epoch: 1, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.829 Vali Acc: 0.100 Test Loss: 1.829 Test Acc: 0.100
Validation loss decreased (inf --> -0.099982).  Saving model ...
Epoch: 2 cost time: 0.5582904815673828
Epoch: 2, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.804 Vali Acc: 0.111 Test Loss: 1.804 Test Acc: 0.111
Validation loss decreased (-0.099982 --> -0.111093).  Saving model ...
Epoch: 3 cost time: 0.5756313800811768
Epoch: 3, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.786 Vali Acc: 0.137 Test Loss: 1.786 Test Acc: 0.137
Validation loss decreased (-0.111093 --> -0.137019).  Saving model ...
Epoch: 4 cost time: 0.6056232452392578
Epoch: 4, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.769 Vali Acc: 0.144 Test Loss: 1.769 Test Acc: 0.144
Validation loss decreased (-0.137019 --> -0.144427).  Saving model ...
Epoch: 5 cost time: 0.681800127029419
Epoch: 5, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.748 Vali Acc: 0.152 Test Loss: 1.748 Test Acc: 0.152
Validation loss decreased (-0.144427 --> -0.151834).  Saving model ...
Epoch: 6 cost time: 0.6097052097320557
Epoch: 6, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.723 Vali Acc: 0.163 Test Loss: 1.723 Test Acc: 0.163
Validation loss decreased (-0.151834 --> -0.162946).  Saving model ...
Epoch: 7 cost time: 0.5755648612976074
Epoch: 7, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.695 Vali Acc: 0.170 Test Loss: 1.695 Test Acc: 0.170
Validation loss decreased (-0.162946 --> -0.170353).  Saving model ...
Epoch: 8 cost time: 0.5759515762329102
Epoch: 8, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.665 Vali Acc: 0.200 Test Loss: 1.665 Test Acc: 0.200
Validation loss decreased (-0.170353 --> -0.199983).  Saving model ...
Epoch: 9 cost time: 0.5877408981323242
Epoch: 9, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.633 Vali Acc: 0.289 Test Loss: 1.633 Test Acc: 0.289
Validation loss decreased (-0.199983 --> -0.288873).  Saving model ...
Epoch: 10 cost time: 0.5788278579711914
Epoch: 10, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.598 Vali Acc: 0.344 Test Loss: 1.598 Test Acc: 0.344
Validation loss decreased (-0.288873 --> -0.344428).  Saving model ...
Epoch: 11 cost time: 0.6128697395324707
Epoch: 11, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.562 Vali Acc: 0.400 Test Loss: 1.562 Test Acc: 0.400
Validation loss decreased (-0.344428 --> -0.399984).  Saving model ...
Epoch: 12 cost time: 0.5808262825012207
Epoch: 12, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.524 Vali Acc: 0.456 Test Loss: 1.524 Test Acc: 0.456
Validation loss decreased (-0.399984 --> -0.455540).  Saving model ...
Epoch: 13 cost time: 0.636929988861084
Epoch: 13, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.486 Vali Acc: 0.541 Test Loss: 1.486 Test Acc: 0.541
Validation loss decreased (-0.455540 --> -0.540726).  Saving model ...
Epoch: 14 cost time: 0.6335301399230957
Epoch: 14, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.447 Vali Acc: 0.607 Test Loss: 1.447 Test Acc: 0.607
Validation loss decreased (-0.540726 --> -0.607393).  Saving model ...
Epoch: 15 cost time: 0.584904670715332
Epoch: 15, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.407 Vali Acc: 0.663 Test Loss: 1.407 Test Acc: 0.663
Validation loss decreased (-0.607393 --> -0.662949).  Saving model ...
Epoch: 16 cost time: 0.5870282649993896
Epoch: 16, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.367 Vali Acc: 0.678 Test Loss: 1.367 Test Acc: 0.678
Validation loss decreased (-0.662949 --> -0.677764).  Saving model ...
Epoch: 17 cost time: 0.5807673931121826
Epoch: 17, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.326 Vali Acc: 0.715 Test Loss: 1.326 Test Acc: 0.715
Validation loss decreased (-0.677764 --> -0.714802).  Saving model ...
Epoch: 18 cost time: 0.5917067527770996
Epoch: 18, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.284 Vali Acc: 0.737 Test Loss: 1.284 Test Acc: 0.737
Validation loss decreased (-0.714802 --> -0.737024).  Saving model ...
Epoch: 19 cost time: 0.5972506999969482
Epoch: 19, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.243 Vali Acc: 0.770 Test Loss: 1.243 Test Acc: 0.770
Validation loss decreased (-0.737024 --> -0.770358).  Saving model ...
Epoch: 20 cost time: 0.6298575401306152
Epoch: 20, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.201 Vali Acc: 0.789 Test Loss: 1.201 Test Acc: 0.789
Validation loss decreased (-0.770358 --> -0.788877).  Saving model ...
Epoch: 21 cost time: 0.6541013717651367
Epoch: 21, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.160 Vali Acc: 0.804 Test Loss: 1.160 Test Acc: 0.804
Validation loss decreased (-0.788877 --> -0.803692).  Saving model ...
Epoch: 22 cost time: 0.6210842132568359
Epoch: 22, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.119 Vali Acc: 0.811 Test Loss: 1.119 Test Acc: 0.811
Validation loss decreased (-0.803692 --> -0.811100).  Saving model ...
Epoch: 23 cost time: 0.5841937065124512
Epoch: 23, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.077 Vali Acc: 0.833 Test Loss: 1.077 Test Acc: 0.833
Validation loss decreased (-0.811100 --> -0.833323).  Saving model ...
Epoch: 24 cost time: 0.5920717716217041
Epoch: 24, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.038 Vali Acc: 0.841 Test Loss: 1.038 Test Acc: 0.841
Validation loss decreased (-0.833323 --> -0.840730).  Saving model ...
Epoch: 25 cost time: 0.6163349151611328
Epoch: 25, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.999 Vali Acc: 0.844 Test Loss: 0.999 Test Acc: 0.844
Validation loss decreased (-0.840730 --> -0.844434).  Saving model ...
Epoch: 26 cost time: 0.6166632175445557
Epoch: 26, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.962 Vali Acc: 0.852 Test Loss: 0.962 Test Acc: 0.852
Validation loss decreased (-0.844434 --> -0.851842).  Saving model ...
Epoch: 27 cost time: 0.6833992004394531
Epoch: 27, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.926 Vali Acc: 0.848 Test Loss: 0.926 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5935347080230713
Epoch: 28, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.891 Vali Acc: 0.852 Test Loss: 0.891 Test Acc: 0.852
Validation loss decreased (-0.851842 --> -0.851843).  Saving model ...
Epoch: 29 cost time: 0.6397688388824463
Epoch: 29, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.858 Vali Acc: 0.852 Test Loss: 0.858 Test Acc: 0.852
Validation loss decreased (-0.851843 --> -0.851843).  Saving model ...
Epoch: 30 cost time: 0.6443641185760498
Epoch: 30, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.826 Vali Acc: 0.859 Test Loss: 0.826 Test Acc: 0.859
Validation loss decreased (-0.851843 --> -0.859251).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8592592592592593
model parameter : 523590
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.995534896850586
Epoch: 1, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.806 Vali Acc: 0.167 Test Loss: 1.806 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.5461938381195068
Epoch: 2, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.779 Vali Acc: 0.167 Test Loss: 1.779 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.5397999286651611
Epoch: 3, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.760 Vali Acc: 0.167 Test Loss: 1.760 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 0.5397210121154785
Epoch: 4, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.741 Vali Acc: 0.170 Test Loss: 1.741 Test Acc: 0.170
Validation loss decreased (-0.166649 --> -0.170353).  Saving model ...
Epoch: 5 cost time: 0.5584638118743896
Epoch: 5, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.717 Vali Acc: 0.181 Test Loss: 1.717 Test Acc: 0.181
Validation loss decreased (-0.170353 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.5492348670959473
Epoch: 6, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.690 Vali Acc: 0.196 Test Loss: 1.690 Test Acc: 0.196
Validation loss decreased (-0.181464 --> -0.196279).  Saving model ...
Epoch: 7 cost time: 0.5639758110046387
Epoch: 7, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.659 Vali Acc: 0.211 Test Loss: 1.659 Test Acc: 0.211
Validation loss decreased (-0.196279 --> -0.211095).  Saving model ...
Epoch: 8 cost time: 0.5431406497955322
Epoch: 8, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.626 Vali Acc: 0.241 Test Loss: 1.626 Test Acc: 0.241
Validation loss decreased (-0.211095 --> -0.240724).  Saving model ...
Epoch: 9 cost time: 0.5643167495727539
Epoch: 9, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.590 Vali Acc: 0.296 Test Loss: 1.590 Test Acc: 0.296
Validation loss decreased (-0.240724 --> -0.296280).  Saving model ...
Epoch: 10 cost time: 0.5556869506835938
Epoch: 10, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.553 Vali Acc: 0.404 Test Loss: 1.553 Test Acc: 0.404
Validation loss decreased (-0.296280 --> -0.403688).  Saving model ...
Epoch: 11 cost time: 0.5652527809143066
Epoch: 11, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.514 Vali Acc: 0.493 Test Loss: 1.514 Test Acc: 0.493
Validation loss decreased (-0.403688 --> -0.492577).  Saving model ...
Epoch: 12 cost time: 0.6108589172363281
Epoch: 12, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.475 Vali Acc: 0.541 Test Loss: 1.475 Test Acc: 0.541
Validation loss decreased (-0.492577 --> -0.540726).  Saving model ...
Epoch: 13 cost time: 0.5782458782196045
Epoch: 13, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.435 Vali Acc: 0.581 Test Loss: 1.435 Test Acc: 0.581
Validation loss decreased (-0.540726 --> -0.581467).  Saving model ...
Epoch: 14 cost time: 0.5850927829742432
Epoch: 14, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.394 Vali Acc: 0.637 Test Loss: 1.394 Test Acc: 0.637
Validation loss decreased (-0.581467 --> -0.637023).  Saving model ...
Epoch: 15 cost time: 0.5972211360931396
Epoch: 15, Steps: 2 | Train Loss: 1.350 Vali Loss: 1.352 Vali Acc: 0.693 Test Loss: 1.352 Test Acc: 0.693
Validation loss decreased (-0.637023 --> -0.692579).  Saving model ...
Epoch: 16 cost time: 0.6023895740509033
Epoch: 16, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.310 Vali Acc: 0.730 Test Loss: 1.310 Test Acc: 0.730
Validation loss decreased (-0.692579 --> -0.729617).  Saving model ...
Epoch: 17 cost time: 0.6216816902160645
Epoch: 17, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.267 Vali Acc: 0.744 Test Loss: 1.267 Test Acc: 0.744
Validation loss decreased (-0.729617 --> -0.744432).  Saving model ...
Epoch: 18 cost time: 0.5811140537261963
Epoch: 18, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.225 Vali Acc: 0.759 Test Loss: 1.225 Test Acc: 0.759
Validation loss decreased (-0.744432 --> -0.759247).  Saving model ...
Epoch: 19 cost time: 0.5893354415893555
Epoch: 19, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.182 Vali Acc: 0.785 Test Loss: 1.182 Test Acc: 0.785
Validation loss decreased (-0.759247 --> -0.785173).  Saving model ...
Epoch: 20 cost time: 0.5888614654541016
Epoch: 20, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.140 Vali Acc: 0.804 Test Loss: 1.140 Test Acc: 0.804
Validation loss decreased (-0.785173 --> -0.803692).  Saving model ...
Epoch: 21 cost time: 0.620011568069458
Epoch: 21, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.098 Vali Acc: 0.811 Test Loss: 1.098 Test Acc: 0.811
Validation loss decreased (-0.803692 --> -0.811100).  Saving model ...
Epoch: 22 cost time: 0.5643455982208252
Epoch: 22, Steps: 2 | Train Loss: 0.950 Vali Loss: 1.056 Vali Acc: 0.819 Test Loss: 1.056 Test Acc: 0.819
Validation loss decreased (-0.811100 --> -0.818508).  Saving model ...
Epoch: 23 cost time: 0.6220822334289551
Epoch: 23, Steps: 2 | Train Loss: 0.926 Vali Loss: 1.015 Vali Acc: 0.841 Test Loss: 1.015 Test Acc: 0.841
Validation loss decreased (-0.818508 --> -0.840731).  Saving model ...
Epoch: 24 cost time: 0.6562931537628174
Epoch: 24, Steps: 2 | Train Loss: 0.863 Vali Loss: 0.975 Vali Acc: 0.856 Test Loss: 0.975 Test Acc: 0.856
Validation loss decreased (-0.840731 --> -0.855546).  Saving model ...
Epoch: 25 cost time: 0.5696640014648438
Epoch: 25, Steps: 2 | Train Loss: 0.804 Vali Loss: 0.935 Vali Acc: 0.856 Test Loss: 0.935 Test Acc: 0.856
Validation loss decreased (-0.855546 --> -0.855546).  Saving model ...
Epoch: 26 cost time: 0.5924067497253418
Epoch: 26, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.897 Vali Acc: 0.870 Test Loss: 0.897 Test Acc: 0.870
Validation loss decreased (-0.855546 --> -0.870361).  Saving model ...
Epoch: 27 cost time: 0.6140193939208984
Epoch: 27, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.859 Vali Acc: 0.874 Test Loss: 0.859 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874065).  Saving model ...
Epoch: 28 cost time: 0.617159366607666
Epoch: 28, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.824 Vali Acc: 0.878 Test Loss: 0.824 Test Acc: 0.878
Validation loss decreased (-0.874065 --> -0.877770).  Saving model ...
Epoch: 29 cost time: 0.5704095363616943
Epoch: 29, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.789 Vali Acc: 0.889 Test Loss: 0.789 Test Acc: 0.889
Validation loss decreased (-0.877770 --> -0.888881).  Saving model ...
Epoch: 30 cost time: 0.5815901756286621
Epoch: 30, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.757 Vali Acc: 0.885 Test Loss: 0.757 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8888888888888888
model parameter : 1765158
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.992849588394165
Epoch: 1, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.827 Vali Acc: 0.100 Test Loss: 1.827 Test Acc: 0.100
Validation loss decreased (inf --> -0.099982).  Saving model ...
Epoch: 2 cost time: 0.5012674331665039
Epoch: 2, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.803 Vali Acc: 0.111 Test Loss: 1.803 Test Acc: 0.111
Validation loss decreased (-0.099982 --> -0.111093).  Saving model ...
Epoch: 3 cost time: 0.5217623710632324
Epoch: 3, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.785 Vali Acc: 0.137 Test Loss: 1.785 Test Acc: 0.137
Validation loss decreased (-0.111093 --> -0.137019).  Saving model ...
Epoch: 4 cost time: 0.5150315761566162
Epoch: 4, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.768 Vali Acc: 0.144 Test Loss: 1.768 Test Acc: 0.144
Validation loss decreased (-0.137019 --> -0.144427).  Saving model ...
Epoch: 5 cost time: 0.5758206844329834
Epoch: 5, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.747 Vali Acc: 0.152 Test Loss: 1.747 Test Acc: 0.152
Validation loss decreased (-0.144427 --> -0.151834).  Saving model ...
Epoch: 6 cost time: 0.543759822845459
Epoch: 6, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.723 Vali Acc: 0.163 Test Loss: 1.723 Test Acc: 0.163
Validation loss decreased (-0.151834 --> -0.162946).  Saving model ...
Epoch: 7 cost time: 0.5428390502929688
Epoch: 7, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.695 Vali Acc: 0.170 Test Loss: 1.695 Test Acc: 0.170
Validation loss decreased (-0.162946 --> -0.170353).  Saving model ...
Epoch: 8 cost time: 0.4843721389770508
Epoch: 8, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.665 Vali Acc: 0.204 Test Loss: 1.665 Test Acc: 0.204
Validation loss decreased (-0.170353 --> -0.203687).  Saving model ...
Epoch: 9 cost time: 0.5609071254730225
Epoch: 9, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.633 Vali Acc: 0.293 Test Loss: 1.633 Test Acc: 0.293
Validation loss decreased (-0.203687 --> -0.292576).  Saving model ...
Epoch: 10 cost time: 0.5370807647705078
Epoch: 10, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.599 Vali Acc: 0.348 Test Loss: 1.599 Test Acc: 0.348
Validation loss decreased (-0.292576 --> -0.348132).  Saving model ...
Epoch: 11 cost time: 0.6047894954681396
Epoch: 11, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.563 Vali Acc: 0.400 Test Loss: 1.563 Test Acc: 0.400
Validation loss decreased (-0.348132 --> -0.399984).  Saving model ...
Epoch: 12 cost time: 0.5825369358062744
Epoch: 12, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.526 Vali Acc: 0.456 Test Loss: 1.526 Test Acc: 0.456
Validation loss decreased (-0.399984 --> -0.455540).  Saving model ...
Epoch: 13 cost time: 0.5690433979034424
Epoch: 13, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.488 Vali Acc: 0.541 Test Loss: 1.488 Test Acc: 0.541
Validation loss decreased (-0.455540 --> -0.540726).  Saving model ...
Epoch: 14 cost time: 0.5469322204589844
Epoch: 14, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.449 Vali Acc: 0.604 Test Loss: 1.449 Test Acc: 0.604
Validation loss decreased (-0.540726 --> -0.603689).  Saving model ...
Epoch: 15 cost time: 0.5531201362609863
Epoch: 15, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.410 Vali Acc: 0.667 Test Loss: 1.410 Test Acc: 0.667
Validation loss decreased (-0.603689 --> -0.666653).  Saving model ...
Epoch: 16 cost time: 0.565169095993042
Epoch: 16, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.370 Vali Acc: 0.674 Test Loss: 1.370 Test Acc: 0.674
Validation loss decreased (-0.666653 --> -0.674060).  Saving model ...
Epoch: 17 cost time: 0.5258138179779053
Epoch: 17, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.329 Vali Acc: 0.715 Test Loss: 1.329 Test Acc: 0.715
Validation loss decreased (-0.674060 --> -0.714802).  Saving model ...
Epoch: 18 cost time: 0.5609266757965088
Epoch: 18, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.288 Vali Acc: 0.730 Test Loss: 1.288 Test Acc: 0.730
Validation loss decreased (-0.714802 --> -0.729617).  Saving model ...
Epoch: 19 cost time: 0.5488114356994629
Epoch: 19, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.247 Vali Acc: 0.759 Test Loss: 1.247 Test Acc: 0.759
Validation loss decreased (-0.729617 --> -0.759247).  Saving model ...
Epoch: 20 cost time: 0.6363415718078613
Epoch: 20, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.206 Vali Acc: 0.785 Test Loss: 1.206 Test Acc: 0.785
Validation loss decreased (-0.759247 --> -0.785173).  Saving model ...
Epoch: 21 cost time: 0.5695433616638184
Epoch: 21, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.165 Vali Acc: 0.796 Test Loss: 1.165 Test Acc: 0.796
Validation loss decreased (-0.785173 --> -0.796285).  Saving model ...
Epoch: 22 cost time: 0.5740907192230225
Epoch: 22, Steps: 2 | Train Loss: 0.990 Vali Loss: 1.124 Vali Acc: 0.811 Test Loss: 1.124 Test Acc: 0.811
Validation loss decreased (-0.796285 --> -0.811100).  Saving model ...
Epoch: 23 cost time: 0.5644357204437256
Epoch: 23, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.084 Vali Acc: 0.833 Test Loss: 1.084 Test Acc: 0.833
Validation loss decreased (-0.811100 --> -0.833322).  Saving model ...
Epoch: 24 cost time: 0.5648598670959473
Epoch: 24, Steps: 2 | Train Loss: 0.914 Vali Loss: 1.044 Vali Acc: 0.841 Test Loss: 1.044 Test Acc: 0.841
Validation loss decreased (-0.833322 --> -0.840730).  Saving model ...
Epoch: 25 cost time: 0.5679023265838623
Epoch: 25, Steps: 2 | Train Loss: 0.871 Vali Loss: 1.005 Vali Acc: 0.841 Test Loss: 1.005 Test Acc: 0.841
Validation loss decreased (-0.840730 --> -0.840731).  Saving model ...
Epoch: 26 cost time: 0.5411942005157471
Epoch: 26, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.968 Vali Acc: 0.841 Test Loss: 0.968 Test Acc: 0.841
Validation loss decreased (-0.840731 --> -0.840731).  Saving model ...
Epoch: 27 cost time: 0.5739583969116211
Epoch: 27, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.932 Vali Acc: 0.837 Test Loss: 0.932 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5534157752990723
Epoch: 28, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.897 Vali Acc: 0.841 Test Loss: 0.897 Test Acc: 0.841
Validation loss decreased (-0.840731 --> -0.840732).  Saving model ...
Epoch: 29 cost time: 0.5365381240844727
Epoch: 29, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.863 Vali Acc: 0.852 Test Loss: 0.863 Test Acc: 0.852
Validation loss decreased (-0.840732 --> -0.851843).  Saving model ...
Epoch: 30 cost time: 0.5896000862121582
Epoch: 30, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.831 Vali Acc: 0.859 Test Loss: 0.831 Test Acc: 0.859
Validation loss decreased (-0.851843 --> -0.859251).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8592592592592593
model parameter : 523590
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3990371227264404
Epoch: 1, Steps: 2 | Train Loss: 2.117 Vali Loss: 2.011 Vali Acc: 0.052 Test Loss: 2.011 Test Acc: 0.052
Validation loss decreased (inf --> -0.051832).  Saving model ...
Epoch: 2 cost time: 0.6708722114562988
Epoch: 2, Steps: 2 | Train Loss: 2.047 Vali Loss: 1.981 Vali Acc: 0.056 Test Loss: 1.981 Test Acc: 0.056
Validation loss decreased (-0.051832 --> -0.055536).  Saving model ...
Epoch: 3 cost time: 0.7039947509765625
Epoch: 3, Steps: 2 | Train Loss: 1.971 Vali Loss: 1.961 Vali Acc: 0.063 Test Loss: 1.961 Test Acc: 0.063
Validation loss decreased (-0.055536 --> -0.062943).  Saving model ...
Epoch: 4 cost time: 0.6203181743621826
Epoch: 4, Steps: 2 | Train Loss: 1.972 Vali Loss: 1.944 Vali Acc: 0.063 Test Loss: 1.944 Test Acc: 0.063
Validation loss decreased (-0.062943 --> -0.062944).  Saving model ...
Epoch: 5 cost time: 0.7038171291351318
Epoch: 5, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.923 Vali Acc: 0.067 Test Loss: 1.923 Test Acc: 0.067
Validation loss decreased (-0.062944 --> -0.066647).  Saving model ...
Epoch: 6 cost time: 0.6660888195037842
Epoch: 6, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.898 Vali Acc: 0.067 Test Loss: 1.898 Test Acc: 0.067
Validation loss decreased (-0.066647 --> -0.066648).  Saving model ...
Epoch: 7 cost time: 0.6755285263061523
Epoch: 7, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.870 Vali Acc: 0.081 Test Loss: 1.870 Test Acc: 0.081
Validation loss decreased (-0.066648 --> -0.081463).  Saving model ...
Epoch: 8 cost time: 0.7187774181365967
Epoch: 8, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.838 Vali Acc: 0.089 Test Loss: 1.838 Test Acc: 0.089
Validation loss decreased (-0.081463 --> -0.088871).  Saving model ...
Epoch: 9 cost time: 0.6192424297332764
Epoch: 9, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.805 Vali Acc: 0.100 Test Loss: 1.805 Test Acc: 0.100
Validation loss decreased (-0.088871 --> -0.099982).  Saving model ...
Epoch: 10 cost time: 0.7143523693084717
Epoch: 10, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.769 Vali Acc: 0.107 Test Loss: 1.769 Test Acc: 0.107
Validation loss decreased (-0.099982 --> -0.107390).  Saving model ...
Epoch: 11 cost time: 0.707744836807251
Epoch: 11, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.731 Vali Acc: 0.126 Test Loss: 1.731 Test Acc: 0.126
Validation loss decreased (-0.107390 --> -0.125909).  Saving model ...
Epoch: 12 cost time: 0.7659008502960205
Epoch: 12, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.692 Vali Acc: 0.181 Test Loss: 1.692 Test Acc: 0.181
Validation loss decreased (-0.125909 --> -0.181465).  Saving model ...
Epoch: 13 cost time: 0.6577663421630859
Epoch: 13, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.651 Vali Acc: 0.244 Test Loss: 1.651 Test Acc: 0.244
Validation loss decreased (-0.181465 --> -0.244428).  Saving model ...
Epoch: 14 cost time: 0.6761765480041504
Epoch: 14, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.610 Vali Acc: 0.319 Test Loss: 1.610 Test Acc: 0.319
Validation loss decreased (-0.244428 --> -0.318502).  Saving model ...
Epoch: 15 cost time: 0.7062768936157227
Epoch: 15, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.567 Vali Acc: 0.378 Test Loss: 1.567 Test Acc: 0.378
Validation loss decreased (-0.318502 --> -0.377762).  Saving model ...
Epoch: 16 cost time: 0.7094738483428955
Epoch: 16, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.523 Vali Acc: 0.456 Test Loss: 1.523 Test Acc: 0.456
Validation loss decreased (-0.377762 --> -0.455540).  Saving model ...
Epoch: 17 cost time: 0.7429099082946777
Epoch: 17, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.477 Vali Acc: 0.519 Test Loss: 1.477 Test Acc: 0.519
Validation loss decreased (-0.455540 --> -0.518504).  Saving model ...
Epoch: 18 cost time: 0.7111847400665283
Epoch: 18, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.431 Vali Acc: 0.567 Test Loss: 1.431 Test Acc: 0.567
Validation loss decreased (-0.518504 --> -0.566652).  Saving model ...
Epoch: 19 cost time: 0.7052156925201416
Epoch: 19, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.385 Vali Acc: 0.600 Test Loss: 1.385 Test Acc: 0.600
Validation loss decreased (-0.566652 --> -0.599986).  Saving model ...
Epoch: 20 cost time: 0.7043523788452148
Epoch: 20, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.338 Vali Acc: 0.652 Test Loss: 1.338 Test Acc: 0.652
Validation loss decreased (-0.599986 --> -0.651838).  Saving model ...
Epoch: 21 cost time: 0.6768341064453125
Epoch: 21, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.290 Vali Acc: 0.700 Test Loss: 1.290 Test Acc: 0.700
Validation loss decreased (-0.651838 --> -0.699987).  Saving model ...
Epoch: 22 cost time: 0.7188940048217773
Epoch: 22, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.243 Vali Acc: 0.741 Test Loss: 1.243 Test Acc: 0.741
Validation loss decreased (-0.699987 --> -0.740728).  Saving model ...
Epoch: 23 cost time: 0.6677522659301758
Epoch: 23, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.197 Vali Acc: 0.774 Test Loss: 1.197 Test Acc: 0.774
Validation loss decreased (-0.740728 --> -0.774062).  Saving model ...
Epoch: 24 cost time: 0.7300505638122559
Epoch: 24, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.152 Vali Acc: 0.800 Test Loss: 1.152 Test Acc: 0.800
Validation loss decreased (-0.774062 --> -0.799988).  Saving model ...
Epoch: 25 cost time: 0.7115495204925537
Epoch: 25, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.107 Vali Acc: 0.815 Test Loss: 1.107 Test Acc: 0.815
Validation loss decreased (-0.799988 --> -0.814804).  Saving model ...
Epoch: 26 cost time: 0.7180914878845215
Epoch: 26, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.063 Vali Acc: 0.826 Test Loss: 1.063 Test Acc: 0.826
Validation loss decreased (-0.814804 --> -0.825915).  Saving model ...
Epoch: 27 cost time: 0.6917555332183838
Epoch: 27, Steps: 2 | Train Loss: 0.856 Vali Loss: 1.020 Vali Acc: 0.841 Test Loss: 1.020 Test Acc: 0.841
Validation loss decreased (-0.825915 --> -0.840731).  Saving model ...
Epoch: 28 cost time: 0.7245340347290039
Epoch: 28, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.977 Vali Acc: 0.863 Test Loss: 0.977 Test Acc: 0.863
Validation loss decreased (-0.840731 --> -0.862953).  Saving model ...
Epoch: 29 cost time: 0.7085089683532715
Epoch: 29, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.936 Vali Acc: 0.878 Test Loss: 0.936 Test Acc: 0.878
Validation loss decreased (-0.862953 --> -0.877768).  Saving model ...
Epoch: 30 cost time: 0.6861124038696289
Epoch: 30, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.897 Vali Acc: 0.885 Test Loss: 0.897 Test Acc: 0.885
Validation loss decreased (-0.877768 --> -0.885176).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 885990
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2120556831359863
Epoch: 1, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.785 Vali Acc: 0.181 Test Loss: 1.785 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 0.5963237285614014
Epoch: 2, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.761 Vali Acc: 0.204 Test Loss: 1.761 Test Acc: 0.204
Validation loss decreased (-0.181464 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.6647732257843018
Epoch: 3, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.745 Vali Acc: 0.230 Test Loss: 1.745 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 0.6517305374145508
Epoch: 4, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.731 Vali Acc: 0.237 Test Loss: 1.731 Test Acc: 0.237
Validation loss decreased (-0.229612 --> -0.237020).  Saving model ...
Epoch: 5 cost time: 0.6487460136413574
Epoch: 5, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.714 Vali Acc: 0.259 Test Loss: 1.714 Test Acc: 0.259
Validation loss decreased (-0.237020 --> -0.259242).  Saving model ...
Epoch: 6 cost time: 0.6264116764068604
Epoch: 6, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.694 Vali Acc: 0.293 Test Loss: 1.694 Test Acc: 0.293
Validation loss decreased (-0.259242 --> -0.292576).  Saving model ...
Epoch: 7 cost time: 0.6190385818481445
Epoch: 7, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.671 Vali Acc: 0.319 Test Loss: 1.671 Test Acc: 0.319
Validation loss decreased (-0.292576 --> -0.318502).  Saving model ...
Epoch: 8 cost time: 0.645540714263916
Epoch: 8, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.646 Vali Acc: 0.341 Test Loss: 1.646 Test Acc: 0.341
Validation loss decreased (-0.318502 --> -0.340724).  Saving model ...
Epoch: 9 cost time: 0.6225926876068115
Epoch: 9, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.619 Vali Acc: 0.374 Test Loss: 1.619 Test Acc: 0.374
Validation loss decreased (-0.340724 --> -0.374058).  Saving model ...
Epoch: 10 cost time: 0.6362483501434326
Epoch: 10, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.590 Vali Acc: 0.400 Test Loss: 1.590 Test Acc: 0.400
Validation loss decreased (-0.374058 --> -0.399984).  Saving model ...
Epoch: 11 cost time: 0.6415107250213623
Epoch: 11, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.560 Vali Acc: 0.433 Test Loss: 1.560 Test Acc: 0.433
Validation loss decreased (-0.399984 --> -0.433318).  Saving model ...
Epoch: 12 cost time: 0.6616160869598389
Epoch: 12, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.528 Vali Acc: 0.470 Test Loss: 1.528 Test Acc: 0.470
Validation loss decreased (-0.433318 --> -0.470355).  Saving model ...
Epoch: 13 cost time: 0.6369030475616455
Epoch: 13, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.495 Vali Acc: 0.530 Test Loss: 1.495 Test Acc: 0.530
Validation loss decreased (-0.470355 --> -0.529615).  Saving model ...
Epoch: 14 cost time: 0.6439714431762695
Epoch: 14, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.461 Vali Acc: 0.604 Test Loss: 1.461 Test Acc: 0.604
Validation loss decreased (-0.529615 --> -0.603689).  Saving model ...
Epoch: 15 cost time: 0.6581542491912842
Epoch: 15, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.427 Vali Acc: 0.648 Test Loss: 1.427 Test Acc: 0.648
Validation loss decreased (-0.603689 --> -0.648134).  Saving model ...
Epoch: 16 cost time: 0.6034340858459473
Epoch: 16, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.393 Vali Acc: 0.693 Test Loss: 1.393 Test Acc: 0.693
Validation loss decreased (-0.648134 --> -0.692579).  Saving model ...
Epoch: 17 cost time: 0.614619255065918
Epoch: 17, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.357 Vali Acc: 0.722 Test Loss: 1.357 Test Acc: 0.722
Validation loss decreased (-0.692579 --> -0.722209).  Saving model ...
Epoch: 18 cost time: 0.6320021152496338
Epoch: 18, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.321 Vali Acc: 0.744 Test Loss: 1.321 Test Acc: 0.744
Validation loss decreased (-0.722209 --> -0.744431).  Saving model ...
Epoch: 19 cost time: 0.6795222759246826
Epoch: 19, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.285 Vali Acc: 0.759 Test Loss: 1.285 Test Acc: 0.759
Validation loss decreased (-0.744431 --> -0.759246).  Saving model ...
Epoch: 20 cost time: 0.6297855377197266
Epoch: 20, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.248 Vali Acc: 0.789 Test Loss: 1.248 Test Acc: 0.789
Validation loss decreased (-0.759246 --> -0.788876).  Saving model ...
Epoch: 21 cost time: 0.6313233375549316
Epoch: 21, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.212 Vali Acc: 0.804 Test Loss: 1.212 Test Acc: 0.804
Validation loss decreased (-0.788876 --> -0.803692).  Saving model ...
Epoch: 22 cost time: 0.6289486885070801
Epoch: 22, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.175 Vali Acc: 0.822 Test Loss: 1.175 Test Acc: 0.822
Validation loss decreased (-0.803692 --> -0.822210).  Saving model ...
Epoch: 23 cost time: 0.6747024059295654
Epoch: 23, Steps: 2 | Train Loss: 0.990 Vali Loss: 1.138 Vali Acc: 0.830 Test Loss: 1.138 Test Acc: 0.830
Validation loss decreased (-0.822210 --> -0.829618).  Saving model ...
Epoch: 24 cost time: 0.62917160987854
Epoch: 24, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.101 Vali Acc: 0.833 Test Loss: 1.101 Test Acc: 0.833
Validation loss decreased (-0.829618 --> -0.833322).  Saving model ...
Epoch: 25 cost time: 0.596043586730957
Epoch: 25, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.065 Vali Acc: 0.848 Test Loss: 1.065 Test Acc: 0.848
Validation loss decreased (-0.833322 --> -0.848138).  Saving model ...
Epoch: 26 cost time: 0.6455988883972168
Epoch: 26, Steps: 2 | Train Loss: 0.912 Vali Loss: 1.028 Vali Acc: 0.856 Test Loss: 1.028 Test Acc: 0.856
Validation loss decreased (-0.848138 --> -0.855545).  Saving model ...
Epoch: 27 cost time: 0.7376346588134766
Epoch: 27, Steps: 2 | Train Loss: 0.891 Vali Loss: 0.992 Vali Acc: 0.859 Test Loss: 0.992 Test Acc: 0.859
Validation loss decreased (-0.855545 --> -0.859249).  Saving model ...
Epoch: 28 cost time: 0.6994574069976807
Epoch: 28, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.957 Vali Acc: 0.867 Test Loss: 0.957 Test Acc: 0.867
Validation loss decreased (-0.859249 --> -0.866657).  Saving model ...
Epoch: 29 cost time: 0.6549668312072754
Epoch: 29, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.923 Vali Acc: 0.878 Test Loss: 0.923 Test Acc: 0.878
Validation loss decreased (-0.866657 --> -0.877769).  Saving model ...
Epoch: 30 cost time: 0.689852237701416
Epoch: 30, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.889 Vali Acc: 0.885 Test Loss: 0.889 Test Acc: 0.885
Validation loss decreased (-0.877769 --> -0.885176).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 265158
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.230581045150757
Epoch: 1, Steps: 2 | Train Loss: 2.117 Vali Loss: 2.011 Vali Acc: 0.052 Test Loss: 2.011 Test Acc: 0.052
Validation loss decreased (inf --> -0.051832).  Saving model ...
Epoch: 2 cost time: 0.6630113124847412
Epoch: 2, Steps: 2 | Train Loss: 2.047 Vali Loss: 1.981 Vali Acc: 0.056 Test Loss: 1.981 Test Acc: 0.056
Validation loss decreased (-0.051832 --> -0.055536).  Saving model ...
Epoch: 3 cost time: 0.6270318031311035
Epoch: 3, Steps: 2 | Train Loss: 1.971 Vali Loss: 1.961 Vali Acc: 0.063 Test Loss: 1.961 Test Acc: 0.063
Validation loss decreased (-0.055536 --> -0.062943).  Saving model ...
Epoch: 4 cost time: 0.6466934680938721
Epoch: 4, Steps: 2 | Train Loss: 1.972 Vali Loss: 1.944 Vali Acc: 0.063 Test Loss: 1.944 Test Acc: 0.063
Validation loss decreased (-0.062943 --> -0.062944).  Saving model ...
Epoch: 5 cost time: 0.6136598587036133
Epoch: 5, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.923 Vali Acc: 0.067 Test Loss: 1.923 Test Acc: 0.067
Validation loss decreased (-0.062944 --> -0.066647).  Saving model ...
Epoch: 6 cost time: 0.5837664604187012
Epoch: 6, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.898 Vali Acc: 0.067 Test Loss: 1.898 Test Acc: 0.067
Validation loss decreased (-0.066647 --> -0.066648).  Saving model ...
Epoch: 7 cost time: 0.6176774501800537
Epoch: 7, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.870 Vali Acc: 0.081 Test Loss: 1.870 Test Acc: 0.081
Validation loss decreased (-0.066648 --> -0.081463).  Saving model ...
Epoch: 8 cost time: 0.6974866390228271
Epoch: 8, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.839 Vali Acc: 0.089 Test Loss: 1.839 Test Acc: 0.089
Validation loss decreased (-0.081463 --> -0.088871).  Saving model ...
Epoch: 9 cost time: 0.6177630424499512
Epoch: 9, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.805 Vali Acc: 0.100 Test Loss: 1.805 Test Acc: 0.100
Validation loss decreased (-0.088871 --> -0.099982).  Saving model ...
Epoch: 10 cost time: 0.6079320907592773
Epoch: 10, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.769 Vali Acc: 0.107 Test Loss: 1.769 Test Acc: 0.107
Validation loss decreased (-0.099982 --> -0.107390).  Saving model ...
Epoch: 11 cost time: 0.5972251892089844
Epoch: 11, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.731 Vali Acc: 0.126 Test Loss: 1.731 Test Acc: 0.126
Validation loss decreased (-0.107390 --> -0.125909).  Saving model ...
Epoch: 12 cost time: 0.6168968677520752
Epoch: 12, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.692 Vali Acc: 0.181 Test Loss: 1.692 Test Acc: 0.181
Validation loss decreased (-0.125909 --> -0.181465).  Saving model ...
Epoch: 13 cost time: 0.6146030426025391
Epoch: 13, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.652 Vali Acc: 0.244 Test Loss: 1.652 Test Acc: 0.244
Validation loss decreased (-0.181465 --> -0.244428).  Saving model ...
Epoch: 14 cost time: 0.6171505451202393
Epoch: 14, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.610 Vali Acc: 0.319 Test Loss: 1.610 Test Acc: 0.319
Validation loss decreased (-0.244428 --> -0.318502).  Saving model ...
Epoch: 15 cost time: 0.6664295196533203
Epoch: 15, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.567 Vali Acc: 0.378 Test Loss: 1.567 Test Acc: 0.378
Validation loss decreased (-0.318502 --> -0.377762).  Saving model ...
Epoch: 16 cost time: 0.6511173248291016
Epoch: 16, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.523 Vali Acc: 0.456 Test Loss: 1.523 Test Acc: 0.456
Validation loss decreased (-0.377762 --> -0.455540).  Saving model ...
Epoch: 17 cost time: 0.7162246704101562
Epoch: 17, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.478 Vali Acc: 0.519 Test Loss: 1.478 Test Acc: 0.519
Validation loss decreased (-0.455540 --> -0.518504).  Saving model ...
Epoch: 18 cost time: 0.6518049240112305
Epoch: 18, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.432 Vali Acc: 0.567 Test Loss: 1.432 Test Acc: 0.567
Validation loss decreased (-0.518504 --> -0.566652).  Saving model ...
Epoch: 19 cost time: 0.6276280879974365
Epoch: 19, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.385 Vali Acc: 0.600 Test Loss: 1.385 Test Acc: 0.600
Validation loss decreased (-0.566652 --> -0.599986).  Saving model ...
Epoch: 20 cost time: 0.6463754177093506
Epoch: 20, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.338 Vali Acc: 0.652 Test Loss: 1.338 Test Acc: 0.652
Validation loss decreased (-0.599986 --> -0.651838).  Saving model ...
Epoch: 21 cost time: 0.6211175918579102
Epoch: 21, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.291 Vali Acc: 0.700 Test Loss: 1.291 Test Acc: 0.700
Validation loss decreased (-0.651838 --> -0.699987).  Saving model ...
Epoch: 22 cost time: 0.6661169528961182
Epoch: 22, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.244 Vali Acc: 0.741 Test Loss: 1.244 Test Acc: 0.741
Validation loss decreased (-0.699987 --> -0.740728).  Saving model ...
Epoch: 23 cost time: 0.6735982894897461
Epoch: 23, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.197 Vali Acc: 0.774 Test Loss: 1.197 Test Acc: 0.774
Validation loss decreased (-0.740728 --> -0.774062).  Saving model ...
Epoch: 24 cost time: 0.6164119243621826
Epoch: 24, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.152 Vali Acc: 0.800 Test Loss: 1.152 Test Acc: 0.800
Validation loss decreased (-0.774062 --> -0.799988).  Saving model ...
Epoch: 25 cost time: 0.6490225791931152
Epoch: 25, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.107 Vali Acc: 0.815 Test Loss: 1.107 Test Acc: 0.815
Validation loss decreased (-0.799988 --> -0.814804).  Saving model ...
Epoch: 26 cost time: 0.6628491878509521
Epoch: 26, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.063 Vali Acc: 0.826 Test Loss: 1.063 Test Acc: 0.826
Validation loss decreased (-0.814804 --> -0.825915).  Saving model ...
Epoch: 27 cost time: 0.6991744041442871
Epoch: 27, Steps: 2 | Train Loss: 0.856 Vali Loss: 1.020 Vali Acc: 0.841 Test Loss: 1.020 Test Acc: 0.841
Validation loss decreased (-0.825915 --> -0.840731).  Saving model ...
Epoch: 28 cost time: 0.668226957321167
Epoch: 28, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.978 Vali Acc: 0.863 Test Loss: 0.978 Test Acc: 0.863
Validation loss decreased (-0.840731 --> -0.862953).  Saving model ...
Epoch: 29 cost time: 0.6487131118774414
Epoch: 29, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.936 Vali Acc: 0.878 Test Loss: 0.936 Test Acc: 0.878
Validation loss decreased (-0.862953 --> -0.877768).  Saving model ...
Epoch: 30 cost time: 0.7243402004241943
Epoch: 30, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.897 Vali Acc: 0.885 Test Loss: 0.897 Test Acc: 0.885
Validation loss decreased (-0.877768 --> -0.885176).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 885990
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.245070219039917
Epoch: 1, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.785 Vali Acc: 0.181 Test Loss: 1.785 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 0.6205563545227051
Epoch: 2, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.762 Vali Acc: 0.204 Test Loss: 1.762 Test Acc: 0.204
Validation loss decreased (-0.181464 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.6085891723632812
Epoch: 3, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.745 Vali Acc: 0.230 Test Loss: 1.745 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 0.6040966510772705
Epoch: 4, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.732 Vali Acc: 0.237 Test Loss: 1.732 Test Acc: 0.237
Validation loss decreased (-0.229612 --> -0.237020).  Saving model ...
Epoch: 5 cost time: 0.6080451011657715
Epoch: 5, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.715 Vali Acc: 0.259 Test Loss: 1.715 Test Acc: 0.259
Validation loss decreased (-0.237020 --> -0.259242).  Saving model ...
Epoch: 6 cost time: 0.6404387950897217
Epoch: 6, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.694 Vali Acc: 0.293 Test Loss: 1.694 Test Acc: 0.293
Validation loss decreased (-0.259242 --> -0.292576).  Saving model ...
Epoch: 7 cost time: 0.5874688625335693
Epoch: 7, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.672 Vali Acc: 0.319 Test Loss: 1.672 Test Acc: 0.319
Validation loss decreased (-0.292576 --> -0.318502).  Saving model ...
Epoch: 8 cost time: 0.6064572334289551
Epoch: 8, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.646 Vali Acc: 0.341 Test Loss: 1.646 Test Acc: 0.341
Validation loss decreased (-0.318502 --> -0.340724).  Saving model ...
Epoch: 9 cost time: 0.6628086566925049
Epoch: 9, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.619 Vali Acc: 0.374 Test Loss: 1.619 Test Acc: 0.374
Validation loss decreased (-0.340724 --> -0.374058).  Saving model ...
Epoch: 10 cost time: 0.6806328296661377
Epoch: 10, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.590 Vali Acc: 0.400 Test Loss: 1.590 Test Acc: 0.400
Validation loss decreased (-0.374058 --> -0.399984).  Saving model ...
Epoch: 11 cost time: 0.6435654163360596
Epoch: 11, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.560 Vali Acc: 0.433 Test Loss: 1.560 Test Acc: 0.433
Validation loss decreased (-0.399984 --> -0.433318).  Saving model ...
Epoch: 12 cost time: 0.7605874538421631
Epoch: 12, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.528 Vali Acc: 0.470 Test Loss: 1.528 Test Acc: 0.470
Validation loss decreased (-0.433318 --> -0.470355).  Saving model ...
Epoch: 13 cost time: 0.6193854808807373
Epoch: 13, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.495 Vali Acc: 0.530 Test Loss: 1.495 Test Acc: 0.530
Validation loss decreased (-0.470355 --> -0.529615).  Saving model ...
Epoch: 14 cost time: 0.6092517375946045
Epoch: 14, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.461 Vali Acc: 0.604 Test Loss: 1.461 Test Acc: 0.604
Validation loss decreased (-0.529615 --> -0.603689).  Saving model ...
Epoch: 15 cost time: 0.5921707153320312
Epoch: 15, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.428 Vali Acc: 0.648 Test Loss: 1.428 Test Acc: 0.648
Validation loss decreased (-0.603689 --> -0.648134).  Saving model ...
Epoch: 16 cost time: 0.5692625045776367
Epoch: 16, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.393 Vali Acc: 0.693 Test Loss: 1.393 Test Acc: 0.693
Validation loss decreased (-0.648134 --> -0.692579).  Saving model ...
Epoch: 17 cost time: 0.5894687175750732
Epoch: 17, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.357 Vali Acc: 0.722 Test Loss: 1.357 Test Acc: 0.722
Validation loss decreased (-0.692579 --> -0.722209).  Saving model ...
Epoch: 18 cost time: 0.6063919067382812
Epoch: 18, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.321 Vali Acc: 0.744 Test Loss: 1.321 Test Acc: 0.744
Validation loss decreased (-0.722209 --> -0.744431).  Saving model ...
Epoch: 19 cost time: 0.6046013832092285
Epoch: 19, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.285 Vali Acc: 0.759 Test Loss: 1.285 Test Acc: 0.759
Validation loss decreased (-0.744431 --> -0.759246).  Saving model ...
Epoch: 20 cost time: 0.637991189956665
Epoch: 20, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.249 Vali Acc: 0.789 Test Loss: 1.249 Test Acc: 0.789
Validation loss decreased (-0.759246 --> -0.788876).  Saving model ...
Epoch: 21 cost time: 0.6015012264251709
Epoch: 21, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.212 Vali Acc: 0.804 Test Loss: 1.212 Test Acc: 0.804
Validation loss decreased (-0.788876 --> -0.803692).  Saving model ...
Epoch: 22 cost time: 0.5875904560089111
Epoch: 22, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.175 Vali Acc: 0.822 Test Loss: 1.175 Test Acc: 0.822
Validation loss decreased (-0.803692 --> -0.822210).  Saving model ...
Epoch: 23 cost time: 0.61454176902771
Epoch: 23, Steps: 2 | Train Loss: 0.990 Vali Loss: 1.138 Vali Acc: 0.830 Test Loss: 1.138 Test Acc: 0.830
Validation loss decreased (-0.822210 --> -0.829618).  Saving model ...
Epoch: 24 cost time: 0.6604194641113281
Epoch: 24, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.102 Vali Acc: 0.833 Test Loss: 1.102 Test Acc: 0.833
Validation loss decreased (-0.829618 --> -0.833322).  Saving model ...
Epoch: 25 cost time: 0.6920797824859619
Epoch: 25, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.065 Vali Acc: 0.848 Test Loss: 1.065 Test Acc: 0.848
Validation loss decreased (-0.833322 --> -0.848137).  Saving model ...
Epoch: 26 cost time: 0.6878085136413574
Epoch: 26, Steps: 2 | Train Loss: 0.912 Vali Loss: 1.029 Vali Acc: 0.856 Test Loss: 1.029 Test Acc: 0.856
Validation loss decreased (-0.848137 --> -0.855545).  Saving model ...
Epoch: 27 cost time: 0.7299127578735352
Epoch: 27, Steps: 2 | Train Loss: 0.891 Vali Loss: 0.993 Vali Acc: 0.859 Test Loss: 0.993 Test Acc: 0.859
Validation loss decreased (-0.855545 --> -0.859249).  Saving model ...
Epoch: 28 cost time: 0.6970887184143066
Epoch: 28, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.958 Vali Acc: 0.867 Test Loss: 0.958 Test Acc: 0.867
Validation loss decreased (-0.859249 --> -0.866657).  Saving model ...
Epoch: 29 cost time: 0.7275040149688721
Epoch: 29, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.923 Vali Acc: 0.878 Test Loss: 0.923 Test Acc: 0.878
Validation loss decreased (-0.866657 --> -0.877769).  Saving model ...
Epoch: 30 cost time: 0.6359500885009766
Epoch: 30, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.890 Vali Acc: 0.885 Test Loss: 0.890 Test Acc: 0.885
Validation loss decreased (-0.877769 --> -0.885176).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 265158
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.204749345779419
Epoch: 1, Steps: 2 | Train Loss: 2.117 Vali Loss: 2.011 Vali Acc: 0.052 Test Loss: 2.011 Test Acc: 0.052
Validation loss decreased (inf --> -0.051832).  Saving model ...
Epoch: 2 cost time: 0.6097397804260254
Epoch: 2, Steps: 2 | Train Loss: 2.047 Vali Loss: 1.982 Vali Acc: 0.056 Test Loss: 1.982 Test Acc: 0.056
Validation loss decreased (-0.051832 --> -0.055536).  Saving model ...
Epoch: 3 cost time: 0.5917816162109375
Epoch: 3, Steps: 2 | Train Loss: 1.971 Vali Loss: 1.961 Vali Acc: 0.063 Test Loss: 1.961 Test Acc: 0.063
Validation loss decreased (-0.055536 --> -0.062943).  Saving model ...
Epoch: 4 cost time: 0.5870778560638428
Epoch: 4, Steps: 2 | Train Loss: 1.972 Vali Loss: 1.945 Vali Acc: 0.063 Test Loss: 1.945 Test Acc: 0.063
Validation loss decreased (-0.062943 --> -0.062944).  Saving model ...
Epoch: 5 cost time: 0.6112382411956787
Epoch: 5, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.923 Vali Acc: 0.067 Test Loss: 1.923 Test Acc: 0.067
Validation loss decreased (-0.062944 --> -0.066647).  Saving model ...
Epoch: 6 cost time: 0.6250975131988525
Epoch: 6, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.898 Vali Acc: 0.067 Test Loss: 1.898 Test Acc: 0.067
Validation loss decreased (-0.066647 --> -0.066648).  Saving model ...
Epoch: 7 cost time: 0.6244795322418213
Epoch: 7, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.871 Vali Acc: 0.078 Test Loss: 1.871 Test Acc: 0.078
Validation loss decreased (-0.066648 --> -0.077759).  Saving model ...
Epoch: 8 cost time: 0.6170496940612793
Epoch: 8, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.840 Vali Acc: 0.089 Test Loss: 1.840 Test Acc: 0.089
Validation loss decreased (-0.077759 --> -0.088870).  Saving model ...
Epoch: 9 cost time: 0.601398229598999
Epoch: 9, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.806 Vali Acc: 0.096 Test Loss: 1.806 Test Acc: 0.096
Validation loss decreased (-0.088870 --> -0.096278).  Saving model ...
Epoch: 10 cost time: 0.5736870765686035
Epoch: 10, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.770 Vali Acc: 0.107 Test Loss: 1.770 Test Acc: 0.107
Validation loss decreased (-0.096278 --> -0.107390).  Saving model ...
Epoch: 11 cost time: 0.5718224048614502
Epoch: 11, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.733 Vali Acc: 0.122 Test Loss: 1.733 Test Acc: 0.122
Validation loss decreased (-0.107390 --> -0.122205).  Saving model ...
Epoch: 12 cost time: 0.5829102993011475
Epoch: 12, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.694 Vali Acc: 0.178 Test Loss: 1.694 Test Acc: 0.178
Validation loss decreased (-0.122205 --> -0.177761).  Saving model ...
Epoch: 13 cost time: 0.6098635196685791
Epoch: 13, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.654 Vali Acc: 0.241 Test Loss: 1.654 Test Acc: 0.241
Validation loss decreased (-0.177761 --> -0.240724).  Saving model ...
Epoch: 14 cost time: 0.559715747833252
Epoch: 14, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.612 Vali Acc: 0.315 Test Loss: 1.612 Test Acc: 0.315
Validation loss decreased (-0.240724 --> -0.314799).  Saving model ...
Epoch: 15 cost time: 0.7041358947753906
Epoch: 15, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.570 Vali Acc: 0.374 Test Loss: 1.570 Test Acc: 0.374
Validation loss decreased (-0.314799 --> -0.374058).  Saving model ...
Epoch: 16 cost time: 0.7156951427459717
Epoch: 16, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.526 Vali Acc: 0.452 Test Loss: 1.526 Test Acc: 0.452
Validation loss decreased (-0.374058 --> -0.451837).  Saving model ...
Epoch: 17 cost time: 0.6771166324615479
Epoch: 17, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.480 Vali Acc: 0.515 Test Loss: 1.480 Test Acc: 0.515
Validation loss decreased (-0.451837 --> -0.514800).  Saving model ...
Epoch: 18 cost time: 0.5973079204559326
Epoch: 18, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.435 Vali Acc: 0.563 Test Loss: 1.435 Test Acc: 0.563
Validation loss decreased (-0.514800 --> -0.562949).  Saving model ...
Epoch: 19 cost time: 0.6520743370056152
Epoch: 19, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.389 Vali Acc: 0.596 Test Loss: 1.389 Test Acc: 0.596
Validation loss decreased (-0.562949 --> -0.596282).  Saving model ...
Epoch: 20 cost time: 0.724292516708374
Epoch: 20, Steps: 2 | Train Loss: 1.264 Vali Loss: 1.342 Vali Acc: 0.648 Test Loss: 1.342 Test Acc: 0.648
Validation loss decreased (-0.596282 --> -0.648135).  Saving model ...
Epoch: 21 cost time: 0.6863913536071777
Epoch: 21, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.294 Vali Acc: 0.689 Test Loss: 1.294 Test Acc: 0.689
Validation loss decreased (-0.648135 --> -0.688876).  Saving model ...
Epoch: 22 cost time: 0.6815264225006104
Epoch: 22, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.247 Vali Acc: 0.741 Test Loss: 1.247 Test Acc: 0.741
Validation loss decreased (-0.688876 --> -0.740728).  Saving model ...
Epoch: 23 cost time: 0.6759738922119141
Epoch: 23, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.201 Vali Acc: 0.774 Test Loss: 1.201 Test Acc: 0.774
Validation loss decreased (-0.740728 --> -0.774062).  Saving model ...
Epoch: 24 cost time: 0.6592936515808105
Epoch: 24, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.156 Vali Acc: 0.804 Test Loss: 1.156 Test Acc: 0.804
Validation loss decreased (-0.774062 --> -0.803692).  Saving model ...
Epoch: 25 cost time: 0.7116024494171143
Epoch: 25, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.112 Vali Acc: 0.815 Test Loss: 1.112 Test Acc: 0.815
Validation loss decreased (-0.803692 --> -0.814804).  Saving model ...
Epoch: 26 cost time: 0.6597580909729004
Epoch: 26, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.067 Vali Acc: 0.822 Test Loss: 1.067 Test Acc: 0.822
Validation loss decreased (-0.814804 --> -0.822212).  Saving model ...
Epoch: 27 cost time: 0.6368846893310547
Epoch: 27, Steps: 2 | Train Loss: 0.863 Vali Loss: 1.024 Vali Acc: 0.844 Test Loss: 1.024 Test Acc: 0.844
Validation loss decreased (-0.822212 --> -0.844434).  Saving model ...
Epoch: 28 cost time: 0.6684353351593018
Epoch: 28, Steps: 2 | Train Loss: 0.855 Vali Loss: 0.982 Vali Acc: 0.863 Test Loss: 0.982 Test Acc: 0.863
Validation loss decreased (-0.844434 --> -0.862953).  Saving model ...
Epoch: 29 cost time: 0.655062198638916
Epoch: 29, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.941 Vali Acc: 0.874 Test Loss: 0.941 Test Acc: 0.874
Validation loss decreased (-0.862953 --> -0.874065).  Saving model ...
Epoch: 30 cost time: 0.7035765647888184
Epoch: 30, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.901 Vali Acc: 0.885 Test Loss: 0.901 Test Acc: 0.885
Validation loss decreased (-0.874065 --> -0.885176).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 885990
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0643997192382812
Epoch: 1, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.787 Vali Acc: 0.181 Test Loss: 1.787 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 0.5467498302459717
Epoch: 2, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.763 Vali Acc: 0.204 Test Loss: 1.763 Test Acc: 0.204
Validation loss decreased (-0.181464 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.5551676750183105
Epoch: 3, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.746 Vali Acc: 0.230 Test Loss: 1.746 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 0.5603594779968262
Epoch: 4, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.733 Vali Acc: 0.237 Test Loss: 1.733 Test Acc: 0.237
Validation loss decreased (-0.229612 --> -0.237020).  Saving model ...
Epoch: 5 cost time: 0.5501682758331299
Epoch: 5, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.716 Vali Acc: 0.256 Test Loss: 1.716 Test Acc: 0.256
Validation loss decreased (-0.237020 --> -0.255538).  Saving model ...
Epoch: 6 cost time: 0.5301673412322998
Epoch: 6, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.696 Vali Acc: 0.293 Test Loss: 1.696 Test Acc: 0.293
Validation loss decreased (-0.255538 --> -0.292576).  Saving model ...
Epoch: 7 cost time: 0.527658224105835
Epoch: 7, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.673 Vali Acc: 0.319 Test Loss: 1.673 Test Acc: 0.319
Validation loss decreased (-0.292576 --> -0.318502).  Saving model ...
Epoch: 8 cost time: 0.516855001449585
Epoch: 8, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.648 Vali Acc: 0.337 Test Loss: 1.648 Test Acc: 0.337
Validation loss decreased (-0.318502 --> -0.337021).  Saving model ...
Epoch: 9 cost time: 0.5337753295898438
Epoch: 9, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.621 Vali Acc: 0.370 Test Loss: 1.621 Test Acc: 0.370
Validation loss decreased (-0.337021 --> -0.370354).  Saving model ...
Epoch: 10 cost time: 0.5237507820129395
Epoch: 10, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.593 Vali Acc: 0.396 Test Loss: 1.593 Test Acc: 0.396
Validation loss decreased (-0.370354 --> -0.396280).  Saving model ...
Epoch: 11 cost time: 0.5438117980957031
Epoch: 11, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.562 Vali Acc: 0.430 Test Loss: 1.562 Test Acc: 0.430
Validation loss decreased (-0.396280 --> -0.429614).  Saving model ...
Epoch: 12 cost time: 0.5449869632720947
Epoch: 12, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.531 Vali Acc: 0.467 Test Loss: 1.531 Test Acc: 0.467
Validation loss decreased (-0.429614 --> -0.466651).  Saving model ...
Epoch: 13 cost time: 0.5652048587799072
Epoch: 13, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.498 Vali Acc: 0.530 Test Loss: 1.498 Test Acc: 0.530
Validation loss decreased (-0.466651 --> -0.529615).  Saving model ...
Epoch: 14 cost time: 0.5499117374420166
Epoch: 14, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.464 Vali Acc: 0.596 Test Loss: 1.464 Test Acc: 0.596
Validation loss decreased (-0.529615 --> -0.596282).  Saving model ...
Epoch: 15 cost time: 0.5641865730285645
Epoch: 15, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.431 Vali Acc: 0.644 Test Loss: 1.431 Test Acc: 0.644
Validation loss decreased (-0.596282 --> -0.644430).  Saving model ...
Epoch: 16 cost time: 0.5812652111053467
Epoch: 16, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.396 Vali Acc: 0.689 Test Loss: 1.396 Test Acc: 0.689
Validation loss decreased (-0.644430 --> -0.688875).  Saving model ...
Epoch: 17 cost time: 0.5775697231292725
Epoch: 17, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.361 Vali Acc: 0.719 Test Loss: 1.361 Test Acc: 0.719
Validation loss decreased (-0.688875 --> -0.718505).  Saving model ...
Epoch: 18 cost time: 0.5698902606964111
Epoch: 18, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.325 Vali Acc: 0.744 Test Loss: 1.325 Test Acc: 0.744
Validation loss decreased (-0.718505 --> -0.744431).  Saving model ...
Epoch: 19 cost time: 0.5771121978759766
Epoch: 19, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.289 Vali Acc: 0.752 Test Loss: 1.289 Test Acc: 0.752
Validation loss decreased (-0.744431 --> -0.751839).  Saving model ...
Epoch: 20 cost time: 0.5617415904998779
Epoch: 20, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.253 Vali Acc: 0.793 Test Loss: 1.253 Test Acc: 0.793
Validation loss decreased (-0.751839 --> -0.792580).  Saving model ...
Epoch: 21 cost time: 0.5885441303253174
Epoch: 21, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.216 Vali Acc: 0.800 Test Loss: 1.216 Test Acc: 0.800
Validation loss decreased (-0.792580 --> -0.799988).  Saving model ...
Epoch: 22 cost time: 0.6231949329376221
Epoch: 22, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.179 Vali Acc: 0.822 Test Loss: 1.179 Test Acc: 0.822
Validation loss decreased (-0.799988 --> -0.822210).  Saving model ...
Epoch: 23 cost time: 0.6011772155761719
Epoch: 23, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.143 Vali Acc: 0.830 Test Loss: 1.143 Test Acc: 0.830
Validation loss decreased (-0.822210 --> -0.829618).  Saving model ...
Epoch: 24 cost time: 0.5579109191894531
Epoch: 24, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.106 Vali Acc: 0.833 Test Loss: 1.106 Test Acc: 0.833
Validation loss decreased (-0.829618 --> -0.833322).  Saving model ...
Epoch: 25 cost time: 0.5419080257415771
Epoch: 25, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.070 Vali Acc: 0.848 Test Loss: 1.070 Test Acc: 0.848
Validation loss decreased (-0.833322 --> -0.848137).  Saving model ...
Epoch: 26 cost time: 0.5417797565460205
Epoch: 26, Steps: 2 | Train Loss: 0.919 Vali Loss: 1.034 Vali Acc: 0.859 Test Loss: 1.034 Test Acc: 0.859
Validation loss decreased (-0.848137 --> -0.859249).  Saving model ...
Epoch: 27 cost time: 0.5856139659881592
Epoch: 27, Steps: 2 | Train Loss: 0.896 Vali Loss: 0.998 Vali Acc: 0.859 Test Loss: 0.998 Test Acc: 0.859
Validation loss decreased (-0.859249 --> -0.859249).  Saving model ...
Epoch: 28 cost time: 0.5543982982635498
Epoch: 28, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.963 Vali Acc: 0.870 Test Loss: 0.963 Test Acc: 0.870
Validation loss decreased (-0.859249 --> -0.870361).  Saving model ...
Epoch: 29 cost time: 0.6209812164306641
Epoch: 29, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.928 Vali Acc: 0.878 Test Loss: 0.928 Test Acc: 0.878
Validation loss decreased (-0.870361 --> -0.877768).  Saving model ...
Epoch: 30 cost time: 0.5850293636322021
Epoch: 30, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.895 Vali Acc: 0.885 Test Loss: 0.895 Test Acc: 0.885
Validation loss decreased (-0.877768 --> -0.885176).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 265158
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5946521759033203
Epoch: 1, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.769 Vali Acc: 0.137 Test Loss: 1.769 Test Acc: 0.137
Validation loss decreased (inf --> -0.137019).  Saving model ...
Epoch: 2 cost time: 0.6945743560791016
Epoch: 2, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.743 Vali Acc: 0.163 Test Loss: 1.743 Test Acc: 0.163
Validation loss decreased (-0.137019 --> -0.162946).  Saving model ...
Epoch: 3 cost time: 0.7377452850341797
Epoch: 3, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.725 Vali Acc: 0.189 Test Loss: 1.725 Test Acc: 0.189
Validation loss decreased (-0.162946 --> -0.188872).  Saving model ...
Epoch: 4 cost time: 0.7059707641601562
Epoch: 4, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.712 Vali Acc: 0.204 Test Loss: 1.712 Test Acc: 0.204
Validation loss decreased (-0.188872 --> -0.203687).  Saving model ...
Epoch: 5 cost time: 0.7377221584320068
Epoch: 5, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.695 Vali Acc: 0.233 Test Loss: 1.695 Test Acc: 0.233
Validation loss decreased (-0.203687 --> -0.233316).  Saving model ...
Epoch: 6 cost time: 0.7306346893310547
Epoch: 6, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.674 Vali Acc: 0.281 Test Loss: 1.674 Test Acc: 0.281
Validation loss decreased (-0.233316 --> -0.281465).  Saving model ...
Epoch: 7 cost time: 0.7138469219207764
Epoch: 7, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.650 Vali Acc: 0.307 Test Loss: 1.650 Test Acc: 0.307
Validation loss decreased (-0.281465 --> -0.307391).  Saving model ...
Epoch: 8 cost time: 0.729985237121582
Epoch: 8, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.625 Vali Acc: 0.333 Test Loss: 1.625 Test Acc: 0.333
Validation loss decreased (-0.307391 --> -0.333317).  Saving model ...
Epoch: 9 cost time: 0.7472891807556152
Epoch: 9, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.597 Vali Acc: 0.400 Test Loss: 1.597 Test Acc: 0.400
Validation loss decreased (-0.333317 --> -0.399984).  Saving model ...
Epoch: 10 cost time: 0.7351062297821045
Epoch: 10, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.567 Vali Acc: 0.433 Test Loss: 1.567 Test Acc: 0.433
Validation loss decreased (-0.399984 --> -0.433318).  Saving model ...
Epoch: 11 cost time: 0.7427480220794678
Epoch: 11, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.535 Vali Acc: 0.511 Test Loss: 1.535 Test Acc: 0.511
Validation loss decreased (-0.433318 --> -0.511096).  Saving model ...
Epoch: 12 cost time: 0.7030785083770752
Epoch: 12, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.502 Vali Acc: 0.567 Test Loss: 1.502 Test Acc: 0.567
Validation loss decreased (-0.511096 --> -0.566652).  Saving model ...
Epoch: 13 cost time: 0.7647361755371094
Epoch: 13, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.468 Vali Acc: 0.604 Test Loss: 1.468 Test Acc: 0.604
Validation loss decreased (-0.566652 --> -0.603689).  Saving model ...
Epoch: 14 cost time: 0.7209534645080566
Epoch: 14, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.433 Vali Acc: 0.633 Test Loss: 1.433 Test Acc: 0.633
Validation loss decreased (-0.603689 --> -0.633319).  Saving model ...
Epoch: 15 cost time: 0.7570383548736572
Epoch: 15, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.397 Vali Acc: 0.667 Test Loss: 1.397 Test Acc: 0.667
Validation loss decreased (-0.633319 --> -0.666653).  Saving model ...
Epoch: 16 cost time: 0.715648889541626
Epoch: 16, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.361 Vali Acc: 0.704 Test Loss: 1.361 Test Acc: 0.704
Validation loss decreased (-0.666653 --> -0.703690).  Saving model ...
Epoch: 17 cost time: 0.7895269393920898
Epoch: 17, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.324 Vali Acc: 0.733 Test Loss: 1.324 Test Acc: 0.733
Validation loss decreased (-0.703690 --> -0.733320).  Saving model ...
Epoch: 18 cost time: 0.7402093410491943
Epoch: 18, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.286 Vali Acc: 0.752 Test Loss: 1.286 Test Acc: 0.752
Validation loss decreased (-0.733320 --> -0.751839).  Saving model ...
Epoch: 19 cost time: 0.713001012802124
Epoch: 19, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.249 Vali Acc: 0.767 Test Loss: 1.249 Test Acc: 0.767
Validation loss decreased (-0.751839 --> -0.766654).  Saving model ...
Epoch: 20 cost time: 0.7331681251525879
Epoch: 20, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.211 Vali Acc: 0.785 Test Loss: 1.211 Test Acc: 0.785
Validation loss decreased (-0.766654 --> -0.785173).  Saving model ...
Epoch: 21 cost time: 0.705188512802124
Epoch: 21, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.174 Vali Acc: 0.793 Test Loss: 1.174 Test Acc: 0.793
Validation loss decreased (-0.785173 --> -0.792581).  Saving model ...
Epoch: 22 cost time: 0.7527914047241211
Epoch: 22, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.136 Vali Acc: 0.800 Test Loss: 1.136 Test Acc: 0.800
Validation loss decreased (-0.792581 --> -0.799989).  Saving model ...
Epoch: 23 cost time: 0.7334089279174805
Epoch: 23, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.098 Vali Acc: 0.819 Test Loss: 1.098 Test Acc: 0.819
Validation loss decreased (-0.799989 --> -0.818508).  Saving model ...
Epoch: 24 cost time: 0.7497267723083496
Epoch: 24, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.061 Vali Acc: 0.833 Test Loss: 1.061 Test Acc: 0.833
Validation loss decreased (-0.818508 --> -0.833323).  Saving model ...
Epoch: 25 cost time: 0.856130838394165
Epoch: 25, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.024 Vali Acc: 0.841 Test Loss: 1.024 Test Acc: 0.841
Validation loss decreased (-0.833323 --> -0.840731).  Saving model ...
Epoch: 26 cost time: 0.8460104465484619
Epoch: 26, Steps: 2 | Train Loss: 0.902 Vali Loss: 0.988 Vali Acc: 0.844 Test Loss: 0.988 Test Acc: 0.844
Validation loss decreased (-0.840731 --> -0.844435).  Saving model ...
Epoch: 27 cost time: 0.8410115242004395
Epoch: 27, Steps: 2 | Train Loss: 0.870 Vali Loss: 0.952 Vali Acc: 0.848 Test Loss: 0.952 Test Acc: 0.848
Validation loss decreased (-0.844435 --> -0.848139).  Saving model ...
Epoch: 28 cost time: 0.89717698097229
Epoch: 28, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.918 Vali Acc: 0.848 Test Loss: 0.918 Test Acc: 0.848
Validation loss decreased (-0.848139 --> -0.848139).  Saving model ...
Epoch: 29 cost time: 0.8378958702087402
Epoch: 29, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.885 Vali Acc: 0.856 Test Loss: 0.885 Test Acc: 0.856
Validation loss decreased (-0.848139 --> -0.855547).  Saving model ...
Epoch: 30 cost time: 0.8514914512634277
Epoch: 30, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.852 Vali Acc: 0.870 Test Loss: 0.852 Test Acc: 0.870
Validation loss decreased (-0.855547 --> -0.870362).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8703703703703703
model parameter : 446406
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3933918476104736
Epoch: 1, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.924 Vali Acc: 0.196 Test Loss: 1.924 Test Acc: 0.196
Validation loss decreased (inf --> -0.196277).  Saving model ...
Epoch: 2 cost time: 0.6392183303833008
Epoch: 2, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.896 Vali Acc: 0.200 Test Loss: 1.896 Test Acc: 0.200
Validation loss decreased (-0.196277 --> -0.199981).  Saving model ...
Epoch: 3 cost time: 0.6445999145507812
Epoch: 3, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.877 Vali Acc: 0.207 Test Loss: 1.877 Test Acc: 0.207
Validation loss decreased (-0.199981 --> -0.207389).  Saving model ...
Epoch: 4 cost time: 0.6985330581665039
Epoch: 4, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.860 Vali Acc: 0.215 Test Loss: 1.860 Test Acc: 0.215
Validation loss decreased (-0.207389 --> -0.214796).  Saving model ...
Epoch: 5 cost time: 0.6395893096923828
Epoch: 5, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.839 Vali Acc: 0.215 Test Loss: 1.839 Test Acc: 0.215
Validation loss decreased (-0.214796 --> -0.214796).  Saving model ...
Epoch: 6 cost time: 0.6540787220001221
Epoch: 6, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.815 Vali Acc: 0.233 Test Loss: 1.815 Test Acc: 0.233
Validation loss decreased (-0.214796 --> -0.233315).  Saving model ...
Epoch: 7 cost time: 0.6631064414978027
Epoch: 7, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.788 Vali Acc: 0.248 Test Loss: 1.788 Test Acc: 0.248
Validation loss decreased (-0.233315 --> -0.248130).  Saving model ...
Epoch: 8 cost time: 0.6624894142150879
Epoch: 8, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.758 Vali Acc: 0.274 Test Loss: 1.758 Test Acc: 0.274
Validation loss decreased (-0.248130 --> -0.274056).  Saving model ...
Epoch: 9 cost time: 0.6102781295776367
Epoch: 9, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.726 Vali Acc: 0.289 Test Loss: 1.726 Test Acc: 0.289
Validation loss decreased (-0.274056 --> -0.288872).  Saving model ...
Epoch: 10 cost time: 0.6427392959594727
Epoch: 10, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.692 Vali Acc: 0.322 Test Loss: 1.692 Test Acc: 0.322
Validation loss decreased (-0.288872 --> -0.322205).  Saving model ...
Epoch: 11 cost time: 0.6139781475067139
Epoch: 11, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.656 Vali Acc: 0.341 Test Loss: 1.656 Test Acc: 0.341
Validation loss decreased (-0.322205 --> -0.340724).  Saving model ...
Epoch: 12 cost time: 0.6768436431884766
Epoch: 12, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.619 Vali Acc: 0.374 Test Loss: 1.619 Test Acc: 0.374
Validation loss decreased (-0.340724 --> -0.374058).  Saving model ...
Epoch: 13 cost time: 0.6380846500396729
Epoch: 13, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.580 Vali Acc: 0.444 Test Loss: 1.580 Test Acc: 0.444
Validation loss decreased (-0.374058 --> -0.444429).  Saving model ...
Epoch: 14 cost time: 0.6066713333129883
Epoch: 14, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.539 Vali Acc: 0.504 Test Loss: 1.539 Test Acc: 0.504
Validation loss decreased (-0.444429 --> -0.503688).  Saving model ...
Epoch: 15 cost time: 0.6392366886138916
Epoch: 15, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.498 Vali Acc: 0.567 Test Loss: 1.498 Test Acc: 0.567
Validation loss decreased (-0.503688 --> -0.566652).  Saving model ...
Epoch: 16 cost time: 0.6001887321472168
Epoch: 16, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.457 Vali Acc: 0.604 Test Loss: 1.457 Test Acc: 0.604
Validation loss decreased (-0.566652 --> -0.603689).  Saving model ...
Epoch: 17 cost time: 0.604536771774292
Epoch: 17, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.414 Vali Acc: 0.633 Test Loss: 1.414 Test Acc: 0.633
Validation loss decreased (-0.603689 --> -0.633319).  Saving model ...
Epoch: 18 cost time: 0.6169390678405762
Epoch: 18, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.371 Vali Acc: 0.659 Test Loss: 1.371 Test Acc: 0.659
Validation loss decreased (-0.633319 --> -0.659246).  Saving model ...
Epoch: 19 cost time: 0.6244893074035645
Epoch: 19, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.327 Vali Acc: 0.674 Test Loss: 1.327 Test Acc: 0.674
Validation loss decreased (-0.659246 --> -0.674061).  Saving model ...
Epoch: 20 cost time: 0.6388814449310303
Epoch: 20, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.285 Vali Acc: 0.681 Test Loss: 1.285 Test Acc: 0.681
Validation loss decreased (-0.674061 --> -0.681469).  Saving model ...
Epoch: 21 cost time: 0.6065487861633301
Epoch: 21, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.242 Vali Acc: 0.707 Test Loss: 1.242 Test Acc: 0.707
Validation loss decreased (-0.681469 --> -0.707395).  Saving model ...
Epoch: 22 cost time: 0.6036231517791748
Epoch: 22, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.199 Vali Acc: 0.722 Test Loss: 1.199 Test Acc: 0.722
Validation loss decreased (-0.707395 --> -0.722210).  Saving model ...
Epoch: 23 cost time: 0.6136589050292969
Epoch: 23, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.156 Vali Acc: 0.726 Test Loss: 1.156 Test Acc: 0.726
Validation loss decreased (-0.722210 --> -0.725914).  Saving model ...
Epoch: 24 cost time: 0.632277250289917
Epoch: 24, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.115 Vali Acc: 0.730 Test Loss: 1.115 Test Acc: 0.730
Validation loss decreased (-0.725914 --> -0.729618).  Saving model ...
Epoch: 25 cost time: 0.666682243347168
Epoch: 25, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.073 Vali Acc: 0.741 Test Loss: 1.073 Test Acc: 0.741
Validation loss decreased (-0.729618 --> -0.740730).  Saving model ...
Epoch: 26 cost time: 0.8056490421295166
Epoch: 26, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.033 Vali Acc: 0.767 Test Loss: 1.033 Test Acc: 0.767
Validation loss decreased (-0.740730 --> -0.766656).  Saving model ...
Epoch: 27 cost time: 0.7316701412200928
Epoch: 27, Steps: 2 | Train Loss: 0.902 Vali Loss: 0.994 Vali Acc: 0.793 Test Loss: 0.994 Test Acc: 0.793
Validation loss decreased (-0.766656 --> -0.792583).  Saving model ...
Epoch: 28 cost time: 0.6443102359771729
Epoch: 28, Steps: 2 | Train Loss: 0.870 Vali Loss: 0.957 Vali Acc: 0.811 Test Loss: 0.957 Test Acc: 0.811
Validation loss decreased (-0.792583 --> -0.811102).  Saving model ...
Epoch: 29 cost time: 0.6971309185028076
Epoch: 29, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.920 Vali Acc: 0.822 Test Loss: 0.920 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822213).  Saving model ...
Epoch: 30 cost time: 0.7064898014068604
Epoch: 30, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.886 Vali Acc: 0.833 Test Loss: 0.886 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833324).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8333333333333334
model parameter : 135942
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5133109092712402
Epoch: 1, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.769 Vali Acc: 0.137 Test Loss: 1.769 Test Acc: 0.137
Validation loss decreased (inf --> -0.137019).  Saving model ...
Epoch: 2 cost time: 0.6368265151977539
Epoch: 2, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.743 Vali Acc: 0.163 Test Loss: 1.743 Test Acc: 0.163
Validation loss decreased (-0.137019 --> -0.162946).  Saving model ...
Epoch: 3 cost time: 0.6180651187896729
Epoch: 3, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.725 Vali Acc: 0.189 Test Loss: 1.725 Test Acc: 0.189
Validation loss decreased (-0.162946 --> -0.188872).  Saving model ...
Epoch: 4 cost time: 0.636132001876831
Epoch: 4, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.712 Vali Acc: 0.204 Test Loss: 1.712 Test Acc: 0.204
Validation loss decreased (-0.188872 --> -0.203687).  Saving model ...
Epoch: 5 cost time: 0.6225781440734863
Epoch: 5, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.695 Vali Acc: 0.233 Test Loss: 1.695 Test Acc: 0.233
Validation loss decreased (-0.203687 --> -0.233316).  Saving model ...
Epoch: 6 cost time: 0.6279785633087158
Epoch: 6, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.674 Vali Acc: 0.281 Test Loss: 1.674 Test Acc: 0.281
Validation loss decreased (-0.233316 --> -0.281465).  Saving model ...
Epoch: 7 cost time: 0.6329047679901123
Epoch: 7, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.650 Vali Acc: 0.307 Test Loss: 1.650 Test Acc: 0.307
Validation loss decreased (-0.281465 --> -0.307391).  Saving model ...
Epoch: 8 cost time: 0.6032388210296631
Epoch: 8, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.625 Vali Acc: 0.333 Test Loss: 1.625 Test Acc: 0.333
Validation loss decreased (-0.307391 --> -0.333317).  Saving model ...
Epoch: 9 cost time: 0.645209789276123
Epoch: 9, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.597 Vali Acc: 0.400 Test Loss: 1.597 Test Acc: 0.400
Validation loss decreased (-0.333317 --> -0.399984).  Saving model ...
Epoch: 10 cost time: 0.6294214725494385
Epoch: 10, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.567 Vali Acc: 0.433 Test Loss: 1.567 Test Acc: 0.433
Validation loss decreased (-0.399984 --> -0.433318).  Saving model ...
Epoch: 11 cost time: 0.667161226272583
Epoch: 11, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.535 Vali Acc: 0.511 Test Loss: 1.535 Test Acc: 0.511
Validation loss decreased (-0.433318 --> -0.511096).  Saving model ...
Epoch: 12 cost time: 0.6656248569488525
Epoch: 12, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.502 Vali Acc: 0.567 Test Loss: 1.502 Test Acc: 0.567
Validation loss decreased (-0.511096 --> -0.566652).  Saving model ...
Epoch: 13 cost time: 0.6231069564819336
Epoch: 13, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.468 Vali Acc: 0.604 Test Loss: 1.468 Test Acc: 0.604
Validation loss decreased (-0.566652 --> -0.603689).  Saving model ...
Epoch: 14 cost time: 0.6892623901367188
Epoch: 14, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.433 Vali Acc: 0.633 Test Loss: 1.433 Test Acc: 0.633
Validation loss decreased (-0.603689 --> -0.633319).  Saving model ...
Epoch: 15 cost time: 0.6527760028839111
Epoch: 15, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.397 Vali Acc: 0.667 Test Loss: 1.397 Test Acc: 0.667
Validation loss decreased (-0.633319 --> -0.666653).  Saving model ...
Epoch: 16 cost time: 0.6442492008209229
Epoch: 16, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.361 Vali Acc: 0.704 Test Loss: 1.361 Test Acc: 0.704
Validation loss decreased (-0.666653 --> -0.703690).  Saving model ...
Epoch: 17 cost time: 0.6588406562805176
Epoch: 17, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.324 Vali Acc: 0.733 Test Loss: 1.324 Test Acc: 0.733
Validation loss decreased (-0.703690 --> -0.733320).  Saving model ...
Epoch: 18 cost time: 0.6405384540557861
Epoch: 18, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.286 Vali Acc: 0.752 Test Loss: 1.286 Test Acc: 0.752
Validation loss decreased (-0.733320 --> -0.751839).  Saving model ...
Epoch: 19 cost time: 0.6557502746582031
Epoch: 19, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.249 Vali Acc: 0.767 Test Loss: 1.249 Test Acc: 0.767
Validation loss decreased (-0.751839 --> -0.766654).  Saving model ...
Epoch: 20 cost time: 0.6048276424407959
Epoch: 20, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.211 Vali Acc: 0.785 Test Loss: 1.211 Test Acc: 0.785
Validation loss decreased (-0.766654 --> -0.785173).  Saving model ...
Epoch: 21 cost time: 0.6209971904754639
Epoch: 21, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.174 Vali Acc: 0.793 Test Loss: 1.174 Test Acc: 0.793
Validation loss decreased (-0.785173 --> -0.792581).  Saving model ...
Epoch: 22 cost time: 0.6209096908569336
Epoch: 22, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.136 Vali Acc: 0.800 Test Loss: 1.136 Test Acc: 0.800
Validation loss decreased (-0.792581 --> -0.799989).  Saving model ...
Epoch: 23 cost time: 0.6450028419494629
Epoch: 23, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.098 Vali Acc: 0.819 Test Loss: 1.098 Test Acc: 0.819
Validation loss decreased (-0.799989 --> -0.818508).  Saving model ...
Epoch: 24 cost time: 0.6255438327789307
Epoch: 24, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.061 Vali Acc: 0.833 Test Loss: 1.061 Test Acc: 0.833
Validation loss decreased (-0.818508 --> -0.833323).  Saving model ...
Epoch: 25 cost time: 0.5939164161682129
Epoch: 25, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.024 Vali Acc: 0.841 Test Loss: 1.024 Test Acc: 0.841
Validation loss decreased (-0.833323 --> -0.840731).  Saving model ...
Epoch: 26 cost time: 0.597956657409668
Epoch: 26, Steps: 2 | Train Loss: 0.902 Vali Loss: 0.988 Vali Acc: 0.844 Test Loss: 0.988 Test Acc: 0.844
Validation loss decreased (-0.840731 --> -0.844435).  Saving model ...
Epoch: 27 cost time: 0.6110589504241943
Epoch: 27, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.952 Vali Acc: 0.848 Test Loss: 0.952 Test Acc: 0.848
Validation loss decreased (-0.844435 --> -0.848139).  Saving model ...
Epoch: 28 cost time: 0.5689847469329834
Epoch: 28, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.918 Vali Acc: 0.848 Test Loss: 0.918 Test Acc: 0.848
Validation loss decreased (-0.848139 --> -0.848139).  Saving model ...
Epoch: 29 cost time: 0.6409955024719238
Epoch: 29, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.885 Vali Acc: 0.856 Test Loss: 0.885 Test Acc: 0.856
Validation loss decreased (-0.848139 --> -0.855547).  Saving model ...
Epoch: 30 cost time: 0.6645278930664062
Epoch: 30, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.852 Vali Acc: 0.870 Test Loss: 0.852 Test Acc: 0.870
Validation loss decreased (-0.855547 --> -0.870362).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8703703703703703
model parameter : 446406
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2272870540618896
Epoch: 1, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.924 Vali Acc: 0.196 Test Loss: 1.924 Test Acc: 0.196
Validation loss decreased (inf --> -0.196277).  Saving model ...
Epoch: 2 cost time: 0.5696158409118652
Epoch: 2, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.896 Vali Acc: 0.200 Test Loss: 1.896 Test Acc: 0.200
Validation loss decreased (-0.196277 --> -0.199981).  Saving model ...
Epoch: 3 cost time: 0.570087194442749
Epoch: 3, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.877 Vali Acc: 0.207 Test Loss: 1.877 Test Acc: 0.207
Validation loss decreased (-0.199981 --> -0.207389).  Saving model ...
Epoch: 4 cost time: 0.6061713695526123
Epoch: 4, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.860 Vali Acc: 0.215 Test Loss: 1.860 Test Acc: 0.215
Validation loss decreased (-0.207389 --> -0.214796).  Saving model ...
Epoch: 5 cost time: 0.6019790172576904
Epoch: 5, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.839 Vali Acc: 0.215 Test Loss: 1.839 Test Acc: 0.215
Validation loss decreased (-0.214796 --> -0.214796).  Saving model ...
Epoch: 6 cost time: 0.5932042598724365
Epoch: 6, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.815 Vali Acc: 0.233 Test Loss: 1.815 Test Acc: 0.233
Validation loss decreased (-0.214796 --> -0.233315).  Saving model ...
Epoch: 7 cost time: 0.607424259185791
Epoch: 7, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.788 Vali Acc: 0.248 Test Loss: 1.788 Test Acc: 0.248
Validation loss decreased (-0.233315 --> -0.248130).  Saving model ...
Epoch: 8 cost time: 0.5894451141357422
Epoch: 8, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.758 Vali Acc: 0.274 Test Loss: 1.758 Test Acc: 0.274
Validation loss decreased (-0.248130 --> -0.274056).  Saving model ...
Epoch: 9 cost time: 0.6034379005432129
Epoch: 9, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.727 Vali Acc: 0.289 Test Loss: 1.727 Test Acc: 0.289
Validation loss decreased (-0.274056 --> -0.288872).  Saving model ...
Epoch: 10 cost time: 0.5920400619506836
Epoch: 10, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.692 Vali Acc: 0.322 Test Loss: 1.692 Test Acc: 0.322
Validation loss decreased (-0.288872 --> -0.322205).  Saving model ...
Epoch: 11 cost time: 0.5745923519134521
Epoch: 11, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.656 Vali Acc: 0.341 Test Loss: 1.656 Test Acc: 0.341
Validation loss decreased (-0.322205 --> -0.340724).  Saving model ...
Epoch: 12 cost time: 0.5964474678039551
Epoch: 12, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.619 Vali Acc: 0.374 Test Loss: 1.619 Test Acc: 0.374
Validation loss decreased (-0.340724 --> -0.374058).  Saving model ...
Epoch: 13 cost time: 0.5741450786590576
Epoch: 13, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.580 Vali Acc: 0.444 Test Loss: 1.580 Test Acc: 0.444
Validation loss decreased (-0.374058 --> -0.444429).  Saving model ...
Epoch: 14 cost time: 0.5936057567596436
Epoch: 14, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.540 Vali Acc: 0.504 Test Loss: 1.540 Test Acc: 0.504
Validation loss decreased (-0.444429 --> -0.503688).  Saving model ...
Epoch: 15 cost time: 0.6049304008483887
Epoch: 15, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.499 Vali Acc: 0.567 Test Loss: 1.499 Test Acc: 0.567
Validation loss decreased (-0.503688 --> -0.566652).  Saving model ...
Epoch: 16 cost time: 0.5817015171051025
Epoch: 16, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.457 Vali Acc: 0.604 Test Loss: 1.457 Test Acc: 0.604
Validation loss decreased (-0.566652 --> -0.603689).  Saving model ...
Epoch: 17 cost time: 0.6064770221710205
Epoch: 17, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.414 Vali Acc: 0.633 Test Loss: 1.414 Test Acc: 0.633
Validation loss decreased (-0.603689 --> -0.633319).  Saving model ...
Epoch: 18 cost time: 0.6053354740142822
Epoch: 18, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.371 Vali Acc: 0.659 Test Loss: 1.371 Test Acc: 0.659
Validation loss decreased (-0.633319 --> -0.659246).  Saving model ...
Epoch: 19 cost time: 0.6586887836456299
Epoch: 19, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.327 Vali Acc: 0.674 Test Loss: 1.327 Test Acc: 0.674
Validation loss decreased (-0.659246 --> -0.674061).  Saving model ...
Epoch: 20 cost time: 0.6147496700286865
Epoch: 20, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.285 Vali Acc: 0.681 Test Loss: 1.285 Test Acc: 0.681
Validation loss decreased (-0.674061 --> -0.681469).  Saving model ...
Epoch: 21 cost time: 0.6229109764099121
Epoch: 21, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.242 Vali Acc: 0.707 Test Loss: 1.242 Test Acc: 0.707
Validation loss decreased (-0.681469 --> -0.707395).  Saving model ...
Epoch: 22 cost time: 0.5966811180114746
Epoch: 22, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.199 Vali Acc: 0.722 Test Loss: 1.199 Test Acc: 0.722
Validation loss decreased (-0.707395 --> -0.722210).  Saving model ...
Epoch: 23 cost time: 0.6070635318756104
Epoch: 23, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.157 Vali Acc: 0.726 Test Loss: 1.157 Test Acc: 0.726
Validation loss decreased (-0.722210 --> -0.725914).  Saving model ...
Epoch: 24 cost time: 0.6198179721832275
Epoch: 24, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.115 Vali Acc: 0.730 Test Loss: 1.115 Test Acc: 0.730
Validation loss decreased (-0.725914 --> -0.729618).  Saving model ...
Epoch: 25 cost time: 0.592219352722168
Epoch: 25, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.074 Vali Acc: 0.741 Test Loss: 1.074 Test Acc: 0.741
Validation loss decreased (-0.729618 --> -0.740730).  Saving model ...
Epoch: 26 cost time: 0.6304662227630615
Epoch: 26, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.033 Vali Acc: 0.767 Test Loss: 1.033 Test Acc: 0.767
Validation loss decreased (-0.740730 --> -0.766656).  Saving model ...
Epoch: 27 cost time: 0.6586086750030518
Epoch: 27, Steps: 2 | Train Loss: 0.902 Vali Loss: 0.994 Vali Acc: 0.793 Test Loss: 0.994 Test Acc: 0.793
Validation loss decreased (-0.766656 --> -0.792583).  Saving model ...
Epoch: 28 cost time: 0.5889651775360107
Epoch: 28, Steps: 2 | Train Loss: 0.870 Vali Loss: 0.957 Vali Acc: 0.811 Test Loss: 0.957 Test Acc: 0.811
Validation loss decreased (-0.792583 --> -0.811102).  Saving model ...
Epoch: 29 cost time: 0.5896992683410645
Epoch: 29, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.921 Vali Acc: 0.822 Test Loss: 0.921 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822213).  Saving model ...
Epoch: 30 cost time: 0.6158485412597656
Epoch: 30, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.886 Vali Acc: 0.833 Test Loss: 0.886 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833324).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8333333333333334
model parameter : 135942
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9925453662872314
Epoch: 1, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.769 Vali Acc: 0.137 Test Loss: 1.769 Test Acc: 0.137
Validation loss decreased (inf --> -0.137019).  Saving model ...
Epoch: 2 cost time: 0.594599723815918
Epoch: 2, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.743 Vali Acc: 0.163 Test Loss: 1.743 Test Acc: 0.163
Validation loss decreased (-0.137019 --> -0.162946).  Saving model ...
Epoch: 3 cost time: 0.5252349376678467
Epoch: 3, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.726 Vali Acc: 0.185 Test Loss: 1.726 Test Acc: 0.185
Validation loss decreased (-0.162946 --> -0.185168).  Saving model ...
Epoch: 4 cost time: 0.5027053356170654
Epoch: 4, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.712 Vali Acc: 0.204 Test Loss: 1.712 Test Acc: 0.204
Validation loss decreased (-0.185168 --> -0.203687).  Saving model ...
Epoch: 5 cost time: 0.5067298412322998
Epoch: 5, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.695 Vali Acc: 0.230 Test Loss: 1.695 Test Acc: 0.230
Validation loss decreased (-0.203687 --> -0.229613).  Saving model ...
Epoch: 6 cost time: 0.5558791160583496
Epoch: 6, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.675 Vali Acc: 0.281 Test Loss: 1.675 Test Acc: 0.281
Validation loss decreased (-0.229613 --> -0.281465).  Saving model ...
Epoch: 7 cost time: 0.5300793647766113
Epoch: 7, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.651 Vali Acc: 0.311 Test Loss: 1.651 Test Acc: 0.311
Validation loss decreased (-0.281465 --> -0.311095).  Saving model ...
Epoch: 8 cost time: 0.5391764640808105
Epoch: 8, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.626 Vali Acc: 0.337 Test Loss: 1.626 Test Acc: 0.337
Validation loss decreased (-0.311095 --> -0.337021).  Saving model ...
Epoch: 9 cost time: 0.5026049613952637
Epoch: 9, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.598 Vali Acc: 0.400 Test Loss: 1.598 Test Acc: 0.400
Validation loss decreased (-0.337021 --> -0.399984).  Saving model ...
Epoch: 10 cost time: 0.5337519645690918
Epoch: 10, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.568 Vali Acc: 0.433 Test Loss: 1.568 Test Acc: 0.433
Validation loss decreased (-0.399984 --> -0.433318).  Saving model ...
Epoch: 11 cost time: 0.5077328681945801
Epoch: 11, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.537 Vali Acc: 0.507 Test Loss: 1.537 Test Acc: 0.507
Validation loss decreased (-0.433318 --> -0.507392).  Saving model ...
Epoch: 12 cost time: 0.5302069187164307
Epoch: 12, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.504 Vali Acc: 0.567 Test Loss: 1.504 Test Acc: 0.567
Validation loss decreased (-0.507392 --> -0.566652).  Saving model ...
Epoch: 13 cost time: 0.5493369102478027
Epoch: 13, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.469 Vali Acc: 0.604 Test Loss: 1.469 Test Acc: 0.604
Validation loss decreased (-0.566652 --> -0.603689).  Saving model ...
Epoch: 14 cost time: 0.5479059219360352
Epoch: 14, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.435 Vali Acc: 0.633 Test Loss: 1.435 Test Acc: 0.633
Validation loss decreased (-0.603689 --> -0.633319).  Saving model ...
Epoch: 15 cost time: 0.507225513458252
Epoch: 15, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.399 Vali Acc: 0.667 Test Loss: 1.399 Test Acc: 0.667
Validation loss decreased (-0.633319 --> -0.666653).  Saving model ...
Epoch: 16 cost time: 0.5034623146057129
Epoch: 16, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.363 Vali Acc: 0.704 Test Loss: 1.363 Test Acc: 0.704
Validation loss decreased (-0.666653 --> -0.703690).  Saving model ...
Epoch: 17 cost time: 0.5064458847045898
Epoch: 17, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.326 Vali Acc: 0.730 Test Loss: 1.326 Test Acc: 0.730
Validation loss decreased (-0.703690 --> -0.729616).  Saving model ...
Epoch: 18 cost time: 0.56740403175354
Epoch: 18, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.288 Vali Acc: 0.752 Test Loss: 1.288 Test Acc: 0.752
Validation loss decreased (-0.729616 --> -0.751839).  Saving model ...
Epoch: 19 cost time: 0.5347375869750977
Epoch: 19, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.251 Vali Acc: 0.767 Test Loss: 1.251 Test Acc: 0.767
Validation loss decreased (-0.751839 --> -0.766654).  Saving model ...
Epoch: 20 cost time: 0.5972445011138916
Epoch: 20, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.214 Vali Acc: 0.785 Test Loss: 1.214 Test Acc: 0.785
Validation loss decreased (-0.766654 --> -0.785173).  Saving model ...
Epoch: 21 cost time: 0.601017951965332
Epoch: 21, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.176 Vali Acc: 0.793 Test Loss: 1.176 Test Acc: 0.793
Validation loss decreased (-0.785173 --> -0.792581).  Saving model ...
Epoch: 22 cost time: 0.5232362747192383
Epoch: 22, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.139 Vali Acc: 0.800 Test Loss: 1.139 Test Acc: 0.800
Validation loss decreased (-0.792581 --> -0.799989).  Saving model ...
Epoch: 23 cost time: 0.49643588066101074
Epoch: 23, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.101 Vali Acc: 0.819 Test Loss: 1.101 Test Acc: 0.819
Validation loss decreased (-0.799989 --> -0.818508).  Saving model ...
Epoch: 24 cost time: 0.5166630744934082
Epoch: 24, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.064 Vali Acc: 0.830 Test Loss: 1.064 Test Acc: 0.830
Validation loss decreased (-0.818508 --> -0.829619).  Saving model ...
Epoch: 25 cost time: 0.5330893993377686
Epoch: 25, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.027 Vali Acc: 0.837 Test Loss: 1.027 Test Acc: 0.837
Validation loss decreased (-0.829619 --> -0.837027).  Saving model ...
Epoch: 26 cost time: 0.5108809471130371
Epoch: 26, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.991 Vali Acc: 0.841 Test Loss: 0.991 Test Acc: 0.841
Validation loss decreased (-0.837027 --> -0.840731).  Saving model ...
Epoch: 27 cost time: 0.5799384117126465
Epoch: 27, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.955 Vali Acc: 0.844 Test Loss: 0.955 Test Acc: 0.844
Validation loss decreased (-0.840731 --> -0.844435).  Saving model ...
Epoch: 28 cost time: 0.5018954277038574
Epoch: 28, Steps: 2 | Train Loss: 0.821 Vali Loss: 0.921 Vali Acc: 0.844 Test Loss: 0.921 Test Acc: 0.844
Validation loss decreased (-0.844435 --> -0.844435).  Saving model ...
Epoch: 29 cost time: 0.5382118225097656
Epoch: 29, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.887 Vali Acc: 0.852 Test Loss: 0.887 Test Acc: 0.852
Validation loss decreased (-0.844435 --> -0.851843).  Saving model ...
Epoch: 30 cost time: 0.5196981430053711
Epoch: 30, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.855 Vali Acc: 0.867 Test Loss: 0.855 Test Acc: 0.867
Validation loss decreased (-0.851843 --> -0.866658).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8666666666666667
model parameter : 446406
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.15986967086792
Epoch: 1, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.924 Vali Acc: 0.196 Test Loss: 1.924 Test Acc: 0.196
Validation loss decreased (inf --> -0.196277).  Saving model ...
Epoch: 2 cost time: 0.5704421997070312
Epoch: 2, Steps: 2 | Train Loss: 1.920 Vali Loss: 1.896 Vali Acc: 0.200 Test Loss: 1.896 Test Acc: 0.200
Validation loss decreased (-0.196277 --> -0.199981).  Saving model ...
Epoch: 3 cost time: 0.6160428524017334
Epoch: 3, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.877 Vali Acc: 0.207 Test Loss: 1.877 Test Acc: 0.207
Validation loss decreased (-0.199981 --> -0.207389).  Saving model ...
Epoch: 4 cost time: 0.5544478893280029
Epoch: 4, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.860 Vali Acc: 0.219 Test Loss: 1.860 Test Acc: 0.219
Validation loss decreased (-0.207389 --> -0.218500).  Saving model ...
Epoch: 5 cost time: 0.5524458885192871
Epoch: 5, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.840 Vali Acc: 0.219 Test Loss: 1.840 Test Acc: 0.219
Validation loss decreased (-0.218500 --> -0.218500).  Saving model ...
Epoch: 6 cost time: 0.4991490840911865
Epoch: 6, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.815 Vali Acc: 0.237 Test Loss: 1.815 Test Acc: 0.237
Validation loss decreased (-0.218500 --> -0.237019).  Saving model ...
Epoch: 7 cost time: 0.5550282001495361
Epoch: 7, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.788 Vali Acc: 0.252 Test Loss: 1.788 Test Acc: 0.252
Validation loss decreased (-0.237019 --> -0.251834).  Saving model ...
Epoch: 8 cost time: 0.5899734497070312
Epoch: 8, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.759 Vali Acc: 0.270 Test Loss: 1.759 Test Acc: 0.270
Validation loss decreased (-0.251834 --> -0.270353).  Saving model ...
Epoch: 9 cost time: 0.5801501274108887
Epoch: 9, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.727 Vali Acc: 0.289 Test Loss: 1.727 Test Acc: 0.289
Validation loss decreased (-0.270353 --> -0.288872).  Saving model ...
Epoch: 10 cost time: 0.5164964199066162
Epoch: 10, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.693 Vali Acc: 0.322 Test Loss: 1.693 Test Acc: 0.322
Validation loss decreased (-0.288872 --> -0.322205).  Saving model ...
Epoch: 11 cost time: 0.5621788501739502
Epoch: 11, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.657 Vali Acc: 0.341 Test Loss: 1.657 Test Acc: 0.341
Validation loss decreased (-0.322205 --> -0.340724).  Saving model ...
Epoch: 12 cost time: 0.5067830085754395
Epoch: 12, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.619 Vali Acc: 0.378 Test Loss: 1.619 Test Acc: 0.378
Validation loss decreased (-0.340724 --> -0.377762).  Saving model ...
Epoch: 13 cost time: 0.5899646282196045
Epoch: 13, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.581 Vali Acc: 0.444 Test Loss: 1.581 Test Acc: 0.444
Validation loss decreased (-0.377762 --> -0.444429).  Saving model ...
Epoch: 14 cost time: 0.5239279270172119
Epoch: 14, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.540 Vali Acc: 0.504 Test Loss: 1.540 Test Acc: 0.504
Validation loss decreased (-0.444429 --> -0.503688).  Saving model ...
Epoch: 15 cost time: 0.5400314331054688
Epoch: 15, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.500 Vali Acc: 0.567 Test Loss: 1.500 Test Acc: 0.567
Validation loss decreased (-0.503688 --> -0.566652).  Saving model ...
Epoch: 16 cost time: 0.5072691440582275
Epoch: 16, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.458 Vali Acc: 0.604 Test Loss: 1.458 Test Acc: 0.604
Validation loss decreased (-0.566652 --> -0.603689).  Saving model ...
Epoch: 17 cost time: 0.5239148139953613
Epoch: 17, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.416 Vali Acc: 0.630 Test Loss: 1.416 Test Acc: 0.630
Validation loss decreased (-0.603689 --> -0.629615).  Saving model ...
Epoch: 18 cost time: 0.579744815826416
Epoch: 18, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.372 Vali Acc: 0.648 Test Loss: 1.372 Test Acc: 0.648
Validation loss decreased (-0.629615 --> -0.648134).  Saving model ...
Epoch: 19 cost time: 0.5199143886566162
Epoch: 19, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.329 Vali Acc: 0.667 Test Loss: 1.329 Test Acc: 0.667
Validation loss decreased (-0.648134 --> -0.666653).  Saving model ...
Epoch: 20 cost time: 0.5319468975067139
Epoch: 20, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.286 Vali Acc: 0.689 Test Loss: 1.286 Test Acc: 0.689
Validation loss decreased (-0.666653 --> -0.688876).  Saving model ...
Epoch: 21 cost time: 0.5896213054656982
Epoch: 21, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.243 Vali Acc: 0.707 Test Loss: 1.243 Test Acc: 0.707
Validation loss decreased (-0.688876 --> -0.707395).  Saving model ...
Epoch: 22 cost time: 0.5196924209594727
Epoch: 22, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.200 Vali Acc: 0.719 Test Loss: 1.200 Test Acc: 0.719
Validation loss decreased (-0.707395 --> -0.718507).  Saving model ...
Epoch: 23 cost time: 0.4959726333618164
Epoch: 23, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.158 Vali Acc: 0.726 Test Loss: 1.158 Test Acc: 0.726
Validation loss decreased (-0.718507 --> -0.725914).  Saving model ...
Epoch: 24 cost time: 0.47685956954956055
Epoch: 24, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.116 Vali Acc: 0.730 Test Loss: 1.116 Test Acc: 0.730
Validation loss decreased (-0.725914 --> -0.729618).  Saving model ...
Epoch: 25 cost time: 0.536318302154541
Epoch: 25, Steps: 2 | Train Loss: 1.000 Vali Loss: 1.075 Vali Acc: 0.741 Test Loss: 1.075 Test Acc: 0.741
Validation loss decreased (-0.729618 --> -0.740730).  Saving model ...
Epoch: 26 cost time: 0.5125560760498047
Epoch: 26, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.034 Vali Acc: 0.767 Test Loss: 1.034 Test Acc: 0.767
Validation loss decreased (-0.740730 --> -0.766656).  Saving model ...
Epoch: 27 cost time: 0.6342034339904785
Epoch: 27, Steps: 2 | Train Loss: 0.907 Vali Loss: 0.996 Vali Acc: 0.785 Test Loss: 0.996 Test Acc: 0.785
Validation loss decreased (-0.766656 --> -0.785175).  Saving model ...
Epoch: 28 cost time: 0.5528354644775391
Epoch: 28, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.958 Vali Acc: 0.807 Test Loss: 0.958 Test Acc: 0.807
Validation loss decreased (-0.785175 --> -0.807398).  Saving model ...
Epoch: 29 cost time: 0.5336086750030518
Epoch: 29, Steps: 2 | Train Loss: 0.870 Vali Loss: 0.921 Vali Acc: 0.819 Test Loss: 0.921 Test Acc: 0.819
Validation loss decreased (-0.807398 --> -0.818509).  Saving model ...
Epoch: 30 cost time: 0.5206010341644287
Epoch: 30, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.887 Vali Acc: 0.830 Test Loss: 0.887 Test Acc: 0.830
Validation loss decreased (-0.818509 --> -0.829621).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8296296296296296
model parameter : 135942
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.473618507385254
Epoch: 1, Steps: 2 | Train Loss: 2.083 Vali Loss: 1.944 Vali Acc: 0.219 Test Loss: 1.944 Test Acc: 0.219
Validation loss decreased (inf --> -0.218499).  Saving model ...
Epoch: 2 cost time: 0.8041026592254639
Epoch: 2, Steps: 2 | Train Loss: 1.983 Vali Loss: 1.926 Vali Acc: 0.226 Test Loss: 1.926 Test Acc: 0.226
Validation loss decreased (-0.218499 --> -0.225907).  Saving model ...
Epoch: 3 cost time: 0.7883048057556152
Epoch: 3, Steps: 2 | Train Loss: 2.002 Vali Loss: 1.914 Vali Acc: 0.241 Test Loss: 1.914 Test Acc: 0.241
Validation loss decreased (-0.225907 --> -0.240722).  Saving model ...
Epoch: 4 cost time: 0.7697944641113281
Epoch: 4, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.906 Vali Acc: 0.248 Test Loss: 1.906 Test Acc: 0.248
Validation loss decreased (-0.240722 --> -0.248129).  Saving model ...
Epoch: 5 cost time: 0.8351013660430908
Epoch: 5, Steps: 2 | Train Loss: 1.987 Vali Loss: 1.895 Vali Acc: 0.259 Test Loss: 1.895 Test Acc: 0.259
Validation loss decreased (-0.248129 --> -0.259240).  Saving model ...
Epoch: 6 cost time: 0.7782506942749023
Epoch: 6, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.883 Vali Acc: 0.270 Test Loss: 1.883 Test Acc: 0.270
Validation loss decreased (-0.259240 --> -0.270352).  Saving model ...
Epoch: 7 cost time: 0.677748441696167
Epoch: 7, Steps: 2 | Train Loss: 1.977 Vali Loss: 1.868 Vali Acc: 0.270 Test Loss: 1.868 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270352).  Saving model ...
Epoch: 8 cost time: 0.7509467601776123
Epoch: 8, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.852 Vali Acc: 0.285 Test Loss: 1.852 Test Acc: 0.285
Validation loss decreased (-0.270352 --> -0.285167).  Saving model ...
Epoch: 9 cost time: 0.8375537395477295
Epoch: 9, Steps: 2 | Train Loss: 1.894 Vali Loss: 1.835 Vali Acc: 0.300 Test Loss: 1.835 Test Acc: 0.300
Validation loss decreased (-0.285167 --> -0.299982).  Saving model ...
Epoch: 10 cost time: 0.7801511287689209
Epoch: 10, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.816 Vali Acc: 0.311 Test Loss: 1.816 Test Acc: 0.311
Validation loss decreased (-0.299982 --> -0.311093).  Saving model ...
Epoch: 11 cost time: 0.7302827835083008
Epoch: 11, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.797 Vali Acc: 0.311 Test Loss: 1.797 Test Acc: 0.311
Validation loss decreased (-0.311093 --> -0.311093).  Saving model ...
Epoch: 12 cost time: 0.729832649230957
Epoch: 12, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.777 Vali Acc: 0.330 Test Loss: 1.777 Test Acc: 0.330
Validation loss decreased (-0.311093 --> -0.329612).  Saving model ...
Epoch: 13 cost time: 0.8365061283111572
Epoch: 13, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.755 Vali Acc: 0.341 Test Loss: 1.755 Test Acc: 0.341
Validation loss decreased (-0.329612 --> -0.340723).  Saving model ...
Epoch: 14 cost time: 0.8340492248535156
Epoch: 14, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.733 Vali Acc: 0.356 Test Loss: 1.733 Test Acc: 0.356
Validation loss decreased (-0.340723 --> -0.355538).  Saving model ...
Epoch: 15 cost time: 0.8373415470123291
Epoch: 15, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.711 Vali Acc: 0.363 Test Loss: 1.711 Test Acc: 0.363
Validation loss decreased (-0.355538 --> -0.362946).  Saving model ...
Epoch: 16 cost time: 0.8144633769989014
Epoch: 16, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.687 Vali Acc: 0.381 Test Loss: 1.687 Test Acc: 0.381
Validation loss decreased (-0.362946 --> -0.381465).  Saving model ...
Epoch: 17 cost time: 0.8725605010986328
Epoch: 17, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.663 Vali Acc: 0.381 Test Loss: 1.663 Test Acc: 0.381
Validation loss decreased (-0.381465 --> -0.381465).  Saving model ...
Epoch: 18 cost time: 0.9000918865203857
Epoch: 18, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.638 Vali Acc: 0.400 Test Loss: 1.638 Test Acc: 0.400
Validation loss decreased (-0.381465 --> -0.399984).  Saving model ...
Epoch: 19 cost time: 0.86358642578125
Epoch: 19, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.613 Vali Acc: 0.415 Test Loss: 1.613 Test Acc: 0.415
Validation loss decreased (-0.399984 --> -0.414799).  Saving model ...
Epoch: 20 cost time: 0.8569469451904297
Epoch: 20, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.588 Vali Acc: 0.444 Test Loss: 1.588 Test Acc: 0.444
Validation loss decreased (-0.414799 --> -0.444429).  Saving model ...
Epoch: 21 cost time: 0.8815569877624512
Epoch: 21, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.562 Vali Acc: 0.456 Test Loss: 1.562 Test Acc: 0.456
Validation loss decreased (-0.444429 --> -0.455540).  Saving model ...
Epoch: 22 cost time: 0.8787219524383545
Epoch: 22, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.536 Vali Acc: 0.485 Test Loss: 1.536 Test Acc: 0.485
Validation loss decreased (-0.455540 --> -0.485170).  Saving model ...
Epoch: 23 cost time: 0.8524236679077148
Epoch: 23, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.508 Vali Acc: 0.544 Test Loss: 1.508 Test Acc: 0.544
Validation loss decreased (-0.485170 --> -0.544429).  Saving model ...
Epoch: 24 cost time: 0.8808193206787109
Epoch: 24, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.481 Vali Acc: 0.570 Test Loss: 1.481 Test Acc: 0.570
Validation loss decreased (-0.544429 --> -0.570356).  Saving model ...
Epoch: 25 cost time: 0.8741672039031982
Epoch: 25, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.453 Vali Acc: 0.604 Test Loss: 1.453 Test Acc: 0.604
Validation loss decreased (-0.570356 --> -0.603689).  Saving model ...
Epoch: 26 cost time: 0.8830089569091797
Epoch: 26, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.424 Vali Acc: 0.630 Test Loss: 1.424 Test Acc: 0.630
Validation loss decreased (-0.603689 --> -0.629615).  Saving model ...
Epoch: 27 cost time: 0.9058048725128174
Epoch: 27, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.396 Vali Acc: 0.648 Test Loss: 1.396 Test Acc: 0.648
Validation loss decreased (-0.629615 --> -0.648134).  Saving model ...
Epoch: 28 cost time: 0.8624978065490723
Epoch: 28, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.366 Vali Acc: 0.670 Test Loss: 1.366 Test Acc: 0.670
Validation loss decreased (-0.648134 --> -0.670357).  Saving model ...
Epoch: 29 cost time: 0.8513240814208984
Epoch: 29, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.337 Vali Acc: 0.681 Test Loss: 1.337 Test Acc: 0.681
Validation loss decreased (-0.670357 --> -0.681468).  Saving model ...
Epoch: 30 cost time: 0.8732354640960693
Epoch: 30, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.308 Vali Acc: 0.689 Test Loss: 1.308 Test Acc: 0.689
Validation loss decreased (-0.681468 --> -0.688876).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6888888888888889
model parameter : 883158
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3274638652801514
Epoch: 1, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.661 Vali Acc: 0.256 Test Loss: 1.661 Test Acc: 0.256
Validation loss decreased (inf --> -0.255539).  Saving model ...
Epoch: 2 cost time: 0.7053651809692383
Epoch: 2, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.643 Vali Acc: 0.270 Test Loss: 1.643 Test Acc: 0.270
Validation loss decreased (-0.255539 --> -0.270354).  Saving model ...
Epoch: 3 cost time: 0.7035443782806396
Epoch: 3, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.631 Vali Acc: 0.281 Test Loss: 1.631 Test Acc: 0.281
Validation loss decreased (-0.270354 --> -0.281465).  Saving model ...
Epoch: 4 cost time: 0.6536550521850586
Epoch: 4, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.623 Vali Acc: 0.289 Test Loss: 1.623 Test Acc: 0.289
Validation loss decreased (-0.281465 --> -0.288873).  Saving model ...
Epoch: 5 cost time: 0.6595103740692139
Epoch: 5, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.613 Vali Acc: 0.307 Test Loss: 1.613 Test Acc: 0.307
Validation loss decreased (-0.288873 --> -0.307391).  Saving model ...
Epoch: 6 cost time: 0.6791722774505615
Epoch: 6, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.601 Vali Acc: 0.319 Test Loss: 1.601 Test Acc: 0.319
Validation loss decreased (-0.307391 --> -0.318503).  Saving model ...
Epoch: 7 cost time: 0.6502590179443359
Epoch: 7, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.588 Vali Acc: 0.352 Test Loss: 1.588 Test Acc: 0.352
Validation loss decreased (-0.318503 --> -0.351836).  Saving model ...
Epoch: 8 cost time: 0.6414635181427002
Epoch: 8, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.573 Vali Acc: 0.363 Test Loss: 1.573 Test Acc: 0.363
Validation loss decreased (-0.351836 --> -0.362947).  Saving model ...
Epoch: 9 cost time: 0.6148624420166016
Epoch: 9, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.557 Vali Acc: 0.389 Test Loss: 1.557 Test Acc: 0.389
Validation loss decreased (-0.362947 --> -0.388873).  Saving model ...
Epoch: 10 cost time: 0.6886684894561768
Epoch: 10, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.540 Vali Acc: 0.411 Test Loss: 1.540 Test Acc: 0.411
Validation loss decreased (-0.388873 --> -0.411096).  Saving model ...
Epoch: 11 cost time: 0.6475298404693604
Epoch: 11, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.522 Vali Acc: 0.433 Test Loss: 1.522 Test Acc: 0.433
Validation loss decreased (-0.411096 --> -0.433318).  Saving model ...
Epoch: 12 cost time: 0.6391966342926025
Epoch: 12, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.503 Vali Acc: 0.456 Test Loss: 1.503 Test Acc: 0.456
Validation loss decreased (-0.433318 --> -0.455541).  Saving model ...
Epoch: 13 cost time: 0.716266393661499
Epoch: 13, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.484 Vali Acc: 0.500 Test Loss: 1.484 Test Acc: 0.500
Validation loss decreased (-0.455541 --> -0.499985).  Saving model ...
Epoch: 14 cost time: 0.6316709518432617
Epoch: 14, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.464 Vali Acc: 0.544 Test Loss: 1.464 Test Acc: 0.544
Validation loss decreased (-0.499985 --> -0.544430).  Saving model ...
Epoch: 15 cost time: 0.6872165203094482
Epoch: 15, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.444 Vali Acc: 0.585 Test Loss: 1.444 Test Acc: 0.585
Validation loss decreased (-0.544430 --> -0.585171).  Saving model ...
Epoch: 16 cost time: 0.7072968482971191
Epoch: 16, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.424 Vali Acc: 0.604 Test Loss: 1.424 Test Acc: 0.604
Validation loss decreased (-0.585171 --> -0.603689).  Saving model ...
Epoch: 17 cost time: 0.7030220031738281
Epoch: 17, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.404 Vali Acc: 0.626 Test Loss: 1.404 Test Acc: 0.626
Validation loss decreased (-0.603689 --> -0.625912).  Saving model ...
Epoch: 18 cost time: 0.6451301574707031
Epoch: 18, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.383 Vali Acc: 0.630 Test Loss: 1.383 Test Acc: 0.630
Validation loss decreased (-0.625912 --> -0.629616).  Saving model ...
Epoch: 19 cost time: 0.706162691116333
Epoch: 19, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.362 Vali Acc: 0.637 Test Loss: 1.362 Test Acc: 0.637
Validation loss decreased (-0.629616 --> -0.637023).  Saving model ...
Epoch: 20 cost time: 0.6947503089904785
Epoch: 20, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.341 Vali Acc: 0.637 Test Loss: 1.341 Test Acc: 0.637
Validation loss decreased (-0.637023 --> -0.637024).  Saving model ...
Epoch: 21 cost time: 0.6315467357635498
Epoch: 21, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.320 Vali Acc: 0.652 Test Loss: 1.320 Test Acc: 0.652
Validation loss decreased (-0.637024 --> -0.651839).  Saving model ...
Epoch: 22 cost time: 0.6881070137023926
Epoch: 22, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.298 Vali Acc: 0.663 Test Loss: 1.298 Test Acc: 0.663
Validation loss decreased (-0.651839 --> -0.662950).  Saving model ...
Epoch: 23 cost time: 0.6540682315826416
Epoch: 23, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.276 Vali Acc: 0.681 Test Loss: 1.276 Test Acc: 0.681
Validation loss decreased (-0.662950 --> -0.681469).  Saving model ...
Epoch: 24 cost time: 0.6938161849975586
Epoch: 24, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.254 Vali Acc: 0.707 Test Loss: 1.254 Test Acc: 0.707
Validation loss decreased (-0.681469 --> -0.707395).  Saving model ...
Epoch: 25 cost time: 0.6782875061035156
Epoch: 25, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.231 Vali Acc: 0.726 Test Loss: 1.231 Test Acc: 0.726
Validation loss decreased (-0.707395 --> -0.725914).  Saving model ...
Epoch: 26 cost time: 0.6965367794036865
Epoch: 26, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.209 Vali Acc: 0.722 Test Loss: 1.209 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6890428066253662
Epoch: 27, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.187 Vali Acc: 0.741 Test Loss: 1.187 Test Acc: 0.741
Validation loss decreased (-0.725914 --> -0.740729).  Saving model ...
Epoch: 28 cost time: 0.6837496757507324
Epoch: 28, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.165 Vali Acc: 0.752 Test Loss: 1.165 Test Acc: 0.752
Validation loss decreased (-0.740729 --> -0.751840).  Saving model ...
Epoch: 29 cost time: 0.7025115489959717
Epoch: 29, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.143 Vali Acc: 0.752 Test Loss: 1.143 Test Acc: 0.752
Validation loss decreased (-0.751840 --> -0.751840).  Saving model ...
Epoch: 30 cost time: 0.7737698554992676
Epoch: 30, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.121 Vali Acc: 0.763 Test Loss: 1.121 Test Acc: 0.763
Validation loss decreased (-0.751840 --> -0.762952).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.762962962962963
model parameter : 262182
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2320332527160645
Epoch: 1, Steps: 2 | Train Loss: 2.083 Vali Loss: 1.944 Vali Acc: 0.219 Test Loss: 1.944 Test Acc: 0.219
Validation loss decreased (inf --> -0.218499).  Saving model ...
Epoch: 2 cost time: 0.6600472927093506
Epoch: 2, Steps: 2 | Train Loss: 1.983 Vali Loss: 1.926 Vali Acc: 0.226 Test Loss: 1.926 Test Acc: 0.226
Validation loss decreased (-0.218499 --> -0.225907).  Saving model ...
Epoch: 3 cost time: 0.7092523574829102
Epoch: 3, Steps: 2 | Train Loss: 2.002 Vali Loss: 1.914 Vali Acc: 0.241 Test Loss: 1.914 Test Acc: 0.241
Validation loss decreased (-0.225907 --> -0.240722).  Saving model ...
Epoch: 4 cost time: 0.6784305572509766
Epoch: 4, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.906 Vali Acc: 0.248 Test Loss: 1.906 Test Acc: 0.248
Validation loss decreased (-0.240722 --> -0.248129).  Saving model ...
Epoch: 5 cost time: 0.6624791622161865
Epoch: 5, Steps: 2 | Train Loss: 1.987 Vali Loss: 1.895 Vali Acc: 0.259 Test Loss: 1.895 Test Acc: 0.259
Validation loss decreased (-0.248129 --> -0.259240).  Saving model ...
Epoch: 6 cost time: 0.6628601551055908
Epoch: 6, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.883 Vali Acc: 0.270 Test Loss: 1.883 Test Acc: 0.270
Validation loss decreased (-0.259240 --> -0.270352).  Saving model ...
Epoch: 7 cost time: 0.6544644832611084
Epoch: 7, Steps: 2 | Train Loss: 1.977 Vali Loss: 1.868 Vali Acc: 0.270 Test Loss: 1.868 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270352).  Saving model ...
Epoch: 8 cost time: 0.6515920162200928
Epoch: 8, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.852 Vali Acc: 0.285 Test Loss: 1.852 Test Acc: 0.285
Validation loss decreased (-0.270352 --> -0.285167).  Saving model ...
Epoch: 9 cost time: 0.6144778728485107
Epoch: 9, Steps: 2 | Train Loss: 1.894 Vali Loss: 1.835 Vali Acc: 0.300 Test Loss: 1.835 Test Acc: 0.300
Validation loss decreased (-0.285167 --> -0.299982).  Saving model ...
Epoch: 10 cost time: 0.6603944301605225
Epoch: 10, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.816 Vali Acc: 0.311 Test Loss: 1.816 Test Acc: 0.311
Validation loss decreased (-0.299982 --> -0.311093).  Saving model ...
Epoch: 11 cost time: 0.6378719806671143
Epoch: 11, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.797 Vali Acc: 0.311 Test Loss: 1.797 Test Acc: 0.311
Validation loss decreased (-0.311093 --> -0.311093).  Saving model ...
Epoch: 12 cost time: 0.6785643100738525
Epoch: 12, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.777 Vali Acc: 0.330 Test Loss: 1.777 Test Acc: 0.330
Validation loss decreased (-0.311093 --> -0.329612).  Saving model ...
Epoch: 13 cost time: 0.6452710628509521
Epoch: 13, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.755 Vali Acc: 0.341 Test Loss: 1.755 Test Acc: 0.341
Validation loss decreased (-0.329612 --> -0.340723).  Saving model ...
Epoch: 14 cost time: 0.6385617256164551
Epoch: 14, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.733 Vali Acc: 0.356 Test Loss: 1.733 Test Acc: 0.356
Validation loss decreased (-0.340723 --> -0.355538).  Saving model ...
Epoch: 15 cost time: 0.6225535869598389
Epoch: 15, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.711 Vali Acc: 0.363 Test Loss: 1.711 Test Acc: 0.363
Validation loss decreased (-0.355538 --> -0.362946).  Saving model ...
Epoch: 16 cost time: 0.6190006732940674
Epoch: 16, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.687 Vali Acc: 0.381 Test Loss: 1.687 Test Acc: 0.381
Validation loss decreased (-0.362946 --> -0.381465).  Saving model ...
Epoch: 17 cost time: 0.6093904972076416
Epoch: 17, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.663 Vali Acc: 0.381 Test Loss: 1.663 Test Acc: 0.381
Validation loss decreased (-0.381465 --> -0.381465).  Saving model ...
Epoch: 18 cost time: 0.6157851219177246
Epoch: 18, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.638 Vali Acc: 0.400 Test Loss: 1.638 Test Acc: 0.400
Validation loss decreased (-0.381465 --> -0.399984).  Saving model ...
Epoch: 19 cost time: 0.6019697189331055
Epoch: 19, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.613 Vali Acc: 0.415 Test Loss: 1.613 Test Acc: 0.415
Validation loss decreased (-0.399984 --> -0.414799).  Saving model ...
Epoch: 20 cost time: 0.659266471862793
Epoch: 20, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.588 Vali Acc: 0.444 Test Loss: 1.588 Test Acc: 0.444
Validation loss decreased (-0.414799 --> -0.444429).  Saving model ...
Epoch: 21 cost time: 0.6346449851989746
Epoch: 21, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.562 Vali Acc: 0.456 Test Loss: 1.562 Test Acc: 0.456
Validation loss decreased (-0.444429 --> -0.455540).  Saving model ...
Epoch: 22 cost time: 0.612790584564209
Epoch: 22, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.536 Vali Acc: 0.485 Test Loss: 1.536 Test Acc: 0.485
Validation loss decreased (-0.455540 --> -0.485170).  Saving model ...
Epoch: 23 cost time: 0.6151101589202881
Epoch: 23, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.508 Vali Acc: 0.544 Test Loss: 1.508 Test Acc: 0.544
Validation loss decreased (-0.485170 --> -0.544429).  Saving model ...
Epoch: 24 cost time: 0.6624448299407959
Epoch: 24, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.481 Vali Acc: 0.570 Test Loss: 1.481 Test Acc: 0.570
Validation loss decreased (-0.544429 --> -0.570356).  Saving model ...
Epoch: 25 cost time: 0.6391644477844238
Epoch: 25, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.453 Vali Acc: 0.604 Test Loss: 1.453 Test Acc: 0.604
Validation loss decreased (-0.570356 --> -0.603689).  Saving model ...
Epoch: 26 cost time: 0.6116275787353516
Epoch: 26, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.424 Vali Acc: 0.630 Test Loss: 1.424 Test Acc: 0.630
Validation loss decreased (-0.603689 --> -0.629615).  Saving model ...
Epoch: 27 cost time: 0.6348254680633545
Epoch: 27, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.396 Vali Acc: 0.648 Test Loss: 1.396 Test Acc: 0.648
Validation loss decreased (-0.629615 --> -0.648134).  Saving model ...
Epoch: 28 cost time: 0.6243093013763428
Epoch: 28, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.366 Vali Acc: 0.670 Test Loss: 1.366 Test Acc: 0.670
Validation loss decreased (-0.648134 --> -0.670357).  Saving model ...
Epoch: 29 cost time: 0.634211540222168
Epoch: 29, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.337 Vali Acc: 0.681 Test Loss: 1.337 Test Acc: 0.681
Validation loss decreased (-0.670357 --> -0.681468).  Saving model ...
Epoch: 30 cost time: 0.6205418109893799
Epoch: 30, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.308 Vali Acc: 0.689 Test Loss: 1.308 Test Acc: 0.689
Validation loss decreased (-0.681468 --> -0.688876).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6888888888888889
model parameter : 883158
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1744611263275146
Epoch: 1, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.661 Vali Acc: 0.256 Test Loss: 1.661 Test Acc: 0.256
Validation loss decreased (inf --> -0.255539).  Saving model ...
Epoch: 2 cost time: 0.5736382007598877
Epoch: 2, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.643 Vali Acc: 0.270 Test Loss: 1.643 Test Acc: 0.270
Validation loss decreased (-0.255539 --> -0.270354).  Saving model ...
Epoch: 3 cost time: 0.5512528419494629
Epoch: 3, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.631 Vali Acc: 0.281 Test Loss: 1.631 Test Acc: 0.281
Validation loss decreased (-0.270354 --> -0.281465).  Saving model ...
Epoch: 4 cost time: 0.6292405128479004
Epoch: 4, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.623 Vali Acc: 0.289 Test Loss: 1.623 Test Acc: 0.289
Validation loss decreased (-0.281465 --> -0.288873).  Saving model ...
Epoch: 5 cost time: 0.60329270362854
Epoch: 5, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.613 Vali Acc: 0.307 Test Loss: 1.613 Test Acc: 0.307
Validation loss decreased (-0.288873 --> -0.307391).  Saving model ...
Epoch: 6 cost time: 0.570932149887085
Epoch: 6, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.601 Vali Acc: 0.319 Test Loss: 1.601 Test Acc: 0.319
Validation loss decreased (-0.307391 --> -0.318503).  Saving model ...
Epoch: 7 cost time: 0.5630314350128174
Epoch: 7, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.588 Vali Acc: 0.352 Test Loss: 1.588 Test Acc: 0.352
Validation loss decreased (-0.318503 --> -0.351836).  Saving model ...
Epoch: 8 cost time: 0.5572094917297363
Epoch: 8, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.573 Vali Acc: 0.363 Test Loss: 1.573 Test Acc: 0.363
Validation loss decreased (-0.351836 --> -0.362947).  Saving model ...
Epoch: 9 cost time: 0.552971601486206
Epoch: 9, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.557 Vali Acc: 0.389 Test Loss: 1.557 Test Acc: 0.389
Validation loss decreased (-0.362947 --> -0.388873).  Saving model ...
Epoch: 10 cost time: 0.5985431671142578
Epoch: 10, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.540 Vali Acc: 0.411 Test Loss: 1.540 Test Acc: 0.411
Validation loss decreased (-0.388873 --> -0.411096).  Saving model ...
Epoch: 11 cost time: 0.5852401256561279
Epoch: 11, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.522 Vali Acc: 0.433 Test Loss: 1.522 Test Acc: 0.433
Validation loss decreased (-0.411096 --> -0.433318).  Saving model ...
Epoch: 12 cost time: 0.5707595348358154
Epoch: 12, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.503 Vali Acc: 0.456 Test Loss: 1.503 Test Acc: 0.456
Validation loss decreased (-0.433318 --> -0.455541).  Saving model ...
Epoch: 13 cost time: 0.5964725017547607
Epoch: 13, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.484 Vali Acc: 0.500 Test Loss: 1.484 Test Acc: 0.500
Validation loss decreased (-0.455541 --> -0.499985).  Saving model ...
Epoch: 14 cost time: 0.6933047771453857
Epoch: 14, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.464 Vali Acc: 0.544 Test Loss: 1.464 Test Acc: 0.544
Validation loss decreased (-0.499985 --> -0.544430).  Saving model ...
Epoch: 15 cost time: 0.6330671310424805
Epoch: 15, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.444 Vali Acc: 0.585 Test Loss: 1.444 Test Acc: 0.585
Validation loss decreased (-0.544430 --> -0.585171).  Saving model ...
Epoch: 16 cost time: 0.5764636993408203
Epoch: 16, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.424 Vali Acc: 0.604 Test Loss: 1.424 Test Acc: 0.604
Validation loss decreased (-0.585171 --> -0.603689).  Saving model ...
Epoch: 17 cost time: 0.5621192455291748
Epoch: 17, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.404 Vali Acc: 0.626 Test Loss: 1.404 Test Acc: 0.626
Validation loss decreased (-0.603689 --> -0.625912).  Saving model ...
Epoch: 18 cost time: 0.6015655994415283
Epoch: 18, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.383 Vali Acc: 0.630 Test Loss: 1.383 Test Acc: 0.630
Validation loss decreased (-0.625912 --> -0.629616).  Saving model ...
Epoch: 19 cost time: 0.5749087333679199
Epoch: 19, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.362 Vali Acc: 0.637 Test Loss: 1.362 Test Acc: 0.637
Validation loss decreased (-0.629616 --> -0.637023).  Saving model ...
Epoch: 20 cost time: 0.5641968250274658
Epoch: 20, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.341 Vali Acc: 0.637 Test Loss: 1.341 Test Acc: 0.637
Validation loss decreased (-0.637023 --> -0.637024).  Saving model ...
Epoch: 21 cost time: 0.6439616680145264
Epoch: 21, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.320 Vali Acc: 0.652 Test Loss: 1.320 Test Acc: 0.652
Validation loss decreased (-0.637024 --> -0.651839).  Saving model ...
Epoch: 22 cost time: 0.5832035541534424
Epoch: 22, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.298 Vali Acc: 0.663 Test Loss: 1.298 Test Acc: 0.663
Validation loss decreased (-0.651839 --> -0.662950).  Saving model ...
Epoch: 23 cost time: 0.5821430683135986
Epoch: 23, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.276 Vali Acc: 0.681 Test Loss: 1.276 Test Acc: 0.681
Validation loss decreased (-0.662950 --> -0.681469).  Saving model ...
Epoch: 24 cost time: 0.6922295093536377
Epoch: 24, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.254 Vali Acc: 0.707 Test Loss: 1.254 Test Acc: 0.707
Validation loss decreased (-0.681469 --> -0.707395).  Saving model ...
Epoch: 25 cost time: 0.6209917068481445
Epoch: 25, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.231 Vali Acc: 0.726 Test Loss: 1.231 Test Acc: 0.726
Validation loss decreased (-0.707395 --> -0.725914).  Saving model ...
Epoch: 26 cost time: 0.6283113956451416
Epoch: 26, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.209 Vali Acc: 0.722 Test Loss: 1.209 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6444787979125977
Epoch: 27, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.187 Vali Acc: 0.741 Test Loss: 1.187 Test Acc: 0.741
Validation loss decreased (-0.725914 --> -0.740729).  Saving model ...
Epoch: 28 cost time: 0.5818867683410645
Epoch: 28, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.165 Vali Acc: 0.752 Test Loss: 1.165 Test Acc: 0.752
Validation loss decreased (-0.740729 --> -0.751840).  Saving model ...
Epoch: 29 cost time: 0.6075294017791748
Epoch: 29, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.143 Vali Acc: 0.752 Test Loss: 1.143 Test Acc: 0.752
Validation loss decreased (-0.751840 --> -0.751840).  Saving model ...
Epoch: 30 cost time: 0.6227879524230957
Epoch: 30, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.121 Vali Acc: 0.763 Test Loss: 1.121 Test Acc: 0.763
Validation loss decreased (-0.751840 --> -0.762952).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.762962962962963
model parameter : 262182
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9409704208374023
Epoch: 1, Steps: 2 | Train Loss: 2.084 Vali Loss: 1.946 Vali Acc: 0.219 Test Loss: 1.946 Test Acc: 0.219
Validation loss decreased (inf --> -0.218499).  Saving model ...
Epoch: 2 cost time: 0.5408656597137451
Epoch: 2, Steps: 2 | Train Loss: 1.985 Vali Loss: 1.928 Vali Acc: 0.226 Test Loss: 1.928 Test Acc: 0.226
Validation loss decreased (-0.218499 --> -0.225907).  Saving model ...
Epoch: 3 cost time: 0.5756802558898926
Epoch: 3, Steps: 2 | Train Loss: 2.003 Vali Loss: 1.915 Vali Acc: 0.241 Test Loss: 1.915 Test Acc: 0.241
Validation loss decreased (-0.225907 --> -0.240722).  Saving model ...
Epoch: 4 cost time: 0.5781476497650146
Epoch: 4, Steps: 2 | Train Loss: 1.972 Vali Loss: 1.908 Vali Acc: 0.248 Test Loss: 1.908 Test Acc: 0.248
Validation loss decreased (-0.240722 --> -0.248129).  Saving model ...
Epoch: 5 cost time: 0.6182937622070312
Epoch: 5, Steps: 2 | Train Loss: 1.990 Vali Loss: 1.898 Vali Acc: 0.259 Test Loss: 1.898 Test Acc: 0.259
Validation loss decreased (-0.248129 --> -0.259240).  Saving model ...
Epoch: 6 cost time: 0.5663769245147705
Epoch: 6, Steps: 2 | Train Loss: 1.933 Vali Loss: 1.885 Vali Acc: 0.270 Test Loss: 1.885 Test Acc: 0.270
Validation loss decreased (-0.259240 --> -0.270352).  Saving model ...
Epoch: 7 cost time: 0.5664675235748291
Epoch: 7, Steps: 2 | Train Loss: 1.984 Vali Loss: 1.871 Vali Acc: 0.270 Test Loss: 1.871 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270352).  Saving model ...
Epoch: 8 cost time: 0.6183719635009766
Epoch: 8, Steps: 2 | Train Loss: 1.936 Vali Loss: 1.856 Vali Acc: 0.285 Test Loss: 1.856 Test Acc: 0.285
Validation loss decreased (-0.270352 --> -0.285167).  Saving model ...
Epoch: 9 cost time: 0.5683553218841553
Epoch: 9, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.839 Vali Acc: 0.300 Test Loss: 1.839 Test Acc: 0.300
Validation loss decreased (-0.285167 --> -0.299982).  Saving model ...
Epoch: 10 cost time: 0.5601785182952881
Epoch: 10, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.821 Vali Acc: 0.311 Test Loss: 1.821 Test Acc: 0.311
Validation loss decreased (-0.299982 --> -0.311093).  Saving model ...
Epoch: 11 cost time: 0.5768167972564697
Epoch: 11, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.803 Vali Acc: 0.311 Test Loss: 1.803 Test Acc: 0.311
Validation loss decreased (-0.311093 --> -0.311093).  Saving model ...
Epoch: 12 cost time: 0.5631694793701172
Epoch: 12, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.783 Vali Acc: 0.330 Test Loss: 1.783 Test Acc: 0.330
Validation loss decreased (-0.311093 --> -0.329612).  Saving model ...
Epoch: 13 cost time: 0.5727875232696533
Epoch: 13, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.763 Vali Acc: 0.341 Test Loss: 1.763 Test Acc: 0.341
Validation loss decreased (-0.329612 --> -0.340723).  Saving model ...
Epoch: 14 cost time: 0.5794413089752197
Epoch: 14, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.741 Vali Acc: 0.356 Test Loss: 1.741 Test Acc: 0.356
Validation loss decreased (-0.340723 --> -0.355538).  Saving model ...
Epoch: 15 cost time: 0.5657167434692383
Epoch: 15, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.719 Vali Acc: 0.367 Test Loss: 1.719 Test Acc: 0.367
Validation loss decreased (-0.355538 --> -0.366649).  Saving model ...
Epoch: 16 cost time: 0.6699998378753662
Epoch: 16, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.696 Vali Acc: 0.370 Test Loss: 1.696 Test Acc: 0.370
Validation loss decreased (-0.366649 --> -0.370353).  Saving model ...
Epoch: 17 cost time: 0.5816991329193115
Epoch: 17, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.673 Vali Acc: 0.370 Test Loss: 1.673 Test Acc: 0.370
Validation loss decreased (-0.370353 --> -0.370354).  Saving model ...
Epoch: 18 cost time: 0.5806939601898193
Epoch: 18, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.649 Vali Acc: 0.381 Test Loss: 1.649 Test Acc: 0.381
Validation loss decreased (-0.370354 --> -0.381465).  Saving model ...
Epoch: 19 cost time: 0.612295389175415
Epoch: 19, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.624 Vali Acc: 0.400 Test Loss: 1.624 Test Acc: 0.400
Validation loss decreased (-0.381465 --> -0.399984).  Saving model ...
Epoch: 20 cost time: 0.6089286804199219
Epoch: 20, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.599 Vali Acc: 0.419 Test Loss: 1.599 Test Acc: 0.419
Validation loss decreased (-0.399984 --> -0.418503).  Saving model ...
Epoch: 21 cost time: 0.5830967426300049
Epoch: 21, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.574 Vali Acc: 0.437 Test Loss: 1.574 Test Acc: 0.437
Validation loss decreased (-0.418503 --> -0.437021).  Saving model ...
Epoch: 22 cost time: 0.5857832431793213
Epoch: 22, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.548 Vali Acc: 0.478 Test Loss: 1.548 Test Acc: 0.478
Validation loss decreased (-0.437021 --> -0.477762).  Saving model ...
Epoch: 23 cost time: 0.5924773216247559
Epoch: 23, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.521 Vali Acc: 0.519 Test Loss: 1.521 Test Acc: 0.519
Validation loss decreased (-0.477762 --> -0.518503).  Saving model ...
Epoch: 24 cost time: 0.6198556423187256
Epoch: 24, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.493 Vali Acc: 0.544 Test Loss: 1.493 Test Acc: 0.544
Validation loss decreased (-0.518503 --> -0.544430).  Saving model ...
Epoch: 25 cost time: 0.5871226787567139
Epoch: 25, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.465 Vali Acc: 0.600 Test Loss: 1.465 Test Acc: 0.600
Validation loss decreased (-0.544430 --> -0.599985).  Saving model ...
Epoch: 26 cost time: 0.6100482940673828
Epoch: 26, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.436 Vali Acc: 0.619 Test Loss: 1.436 Test Acc: 0.619
Validation loss decreased (-0.599985 --> -0.618504).  Saving model ...
Epoch: 27 cost time: 0.6189007759094238
Epoch: 27, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.408 Vali Acc: 0.637 Test Loss: 1.408 Test Acc: 0.637
Validation loss decreased (-0.618504 --> -0.637023).  Saving model ...
Epoch: 28 cost time: 0.5840749740600586
Epoch: 28, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.378 Vali Acc: 0.659 Test Loss: 1.378 Test Acc: 0.659
Validation loss decreased (-0.637023 --> -0.659245).  Saving model ...
Epoch: 29 cost time: 0.6798980236053467
Epoch: 29, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.349 Vali Acc: 0.670 Test Loss: 1.349 Test Acc: 0.670
Validation loss decreased (-0.659245 --> -0.670357).  Saving model ...
Epoch: 30 cost time: 0.581662654876709
Epoch: 30, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.319 Vali Acc: 0.667 Test Loss: 1.319 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6703703703703704
model parameter : 883158
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2509777545928955
Epoch: 1, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.663 Vali Acc: 0.256 Test Loss: 1.663 Test Acc: 0.256
Validation loss decreased (inf --> -0.255539).  Saving model ...
Epoch: 2 cost time: 0.49404025077819824
Epoch: 2, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.644 Vali Acc: 0.270 Test Loss: 1.644 Test Acc: 0.270
Validation loss decreased (-0.255539 --> -0.270354).  Saving model ...
Epoch: 3 cost time: 0.5002057552337646
Epoch: 3, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.633 Vali Acc: 0.281 Test Loss: 1.633 Test Acc: 0.281
Validation loss decreased (-0.270354 --> -0.281465).  Saving model ...
Epoch: 4 cost time: 0.4887206554412842
Epoch: 4, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.625 Vali Acc: 0.289 Test Loss: 1.625 Test Acc: 0.289
Validation loss decreased (-0.281465 --> -0.288873).  Saving model ...
Epoch: 5 cost time: 0.5078744888305664
Epoch: 5, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.615 Vali Acc: 0.307 Test Loss: 1.615 Test Acc: 0.307
Validation loss decreased (-0.288873 --> -0.307391).  Saving model ...
Epoch: 6 cost time: 0.5606889724731445
Epoch: 6, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.603 Vali Acc: 0.315 Test Loss: 1.603 Test Acc: 0.315
Validation loss decreased (-0.307391 --> -0.314799).  Saving model ...
Epoch: 7 cost time: 0.5095937252044678
Epoch: 7, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.590 Vali Acc: 0.344 Test Loss: 1.590 Test Acc: 0.344
Validation loss decreased (-0.314799 --> -0.344429).  Saving model ...
Epoch: 8 cost time: 0.4960920810699463
Epoch: 8, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.575 Vali Acc: 0.359 Test Loss: 1.575 Test Acc: 0.359
Validation loss decreased (-0.344429 --> -0.359244).  Saving model ...
Epoch: 9 cost time: 0.5160338878631592
Epoch: 9, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.559 Vali Acc: 0.389 Test Loss: 1.559 Test Acc: 0.389
Validation loss decreased (-0.359244 --> -0.388873).  Saving model ...
Epoch: 10 cost time: 0.5040125846862793
Epoch: 10, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.543 Vali Acc: 0.415 Test Loss: 1.543 Test Acc: 0.415
Validation loss decreased (-0.388873 --> -0.414799).  Saving model ...
Epoch: 11 cost time: 0.48514676094055176
Epoch: 11, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.525 Vali Acc: 0.433 Test Loss: 1.525 Test Acc: 0.433
Validation loss decreased (-0.414799 --> -0.433318).  Saving model ...
Epoch: 12 cost time: 0.5309240818023682
Epoch: 12, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.506 Vali Acc: 0.456 Test Loss: 1.506 Test Acc: 0.456
Validation loss decreased (-0.433318 --> -0.455540).  Saving model ...
Epoch: 13 cost time: 0.4984464645385742
Epoch: 13, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.487 Vali Acc: 0.500 Test Loss: 1.487 Test Acc: 0.500
Validation loss decreased (-0.455540 --> -0.499985).  Saving model ...
Epoch: 14 cost time: 0.5330519676208496
Epoch: 14, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.468 Vali Acc: 0.533 Test Loss: 1.468 Test Acc: 0.533
Validation loss decreased (-0.499985 --> -0.533319).  Saving model ...
Epoch: 15 cost time: 0.5157556533813477
Epoch: 15, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.448 Vali Acc: 0.567 Test Loss: 1.448 Test Acc: 0.567
Validation loss decreased (-0.533319 --> -0.566652).  Saving model ...
Epoch: 16 cost time: 0.44667840003967285
Epoch: 16, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.428 Vali Acc: 0.585 Test Loss: 1.428 Test Acc: 0.585
Validation loss decreased (-0.566652 --> -0.585171).  Saving model ...
Epoch: 17 cost time: 0.4843888282775879
Epoch: 17, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.408 Vali Acc: 0.611 Test Loss: 1.408 Test Acc: 0.611
Validation loss decreased (-0.585171 --> -0.611097).  Saving model ...
Epoch: 18 cost time: 0.4974238872528076
Epoch: 18, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.388 Vali Acc: 0.622 Test Loss: 1.388 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622208).  Saving model ...
Epoch: 19 cost time: 0.52413010597229
Epoch: 19, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.367 Vali Acc: 0.633 Test Loss: 1.367 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633320).  Saving model ...
Epoch: 20 cost time: 0.483381986618042
Epoch: 20, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.346 Vali Acc: 0.633 Test Loss: 1.346 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 21 cost time: 0.4796934127807617
Epoch: 21, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.325 Vali Acc: 0.644 Test Loss: 1.325 Test Acc: 0.644
Validation loss decreased (-0.633320 --> -0.644431).  Saving model ...
Epoch: 22 cost time: 0.49193310737609863
Epoch: 22, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.304 Vali Acc: 0.663 Test Loss: 1.304 Test Acc: 0.663
Validation loss decreased (-0.644431 --> -0.662950).  Saving model ...
Epoch: 23 cost time: 0.504725456237793
Epoch: 23, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.282 Vali Acc: 0.689 Test Loss: 1.282 Test Acc: 0.689
Validation loss decreased (-0.662950 --> -0.688876).  Saving model ...
Epoch: 24 cost time: 0.4753429889678955
Epoch: 24, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.260 Vali Acc: 0.700 Test Loss: 1.260 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699987).  Saving model ...
Epoch: 25 cost time: 0.5877058506011963
Epoch: 25, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.238 Vali Acc: 0.715 Test Loss: 1.238 Test Acc: 0.715
Validation loss decreased (-0.699987 --> -0.714802).  Saving model ...
Epoch: 26 cost time: 0.5806083679199219
Epoch: 26, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.216 Vali Acc: 0.722 Test Loss: 1.216 Test Acc: 0.722
Validation loss decreased (-0.714802 --> -0.722210).  Saving model ...
Epoch: 27 cost time: 0.5150046348571777
Epoch: 27, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.193 Vali Acc: 0.737 Test Loss: 1.193 Test Acc: 0.737
Validation loss decreased (-0.722210 --> -0.737025).  Saving model ...
Epoch: 28 cost time: 0.49063611030578613
Epoch: 28, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.171 Vali Acc: 0.741 Test Loss: 1.171 Test Acc: 0.741
Validation loss decreased (-0.737025 --> -0.740729).  Saving model ...
Epoch: 29 cost time: 0.5040643215179443
Epoch: 29, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.150 Vali Acc: 0.748 Test Loss: 1.150 Test Acc: 0.748
Validation loss decreased (-0.740729 --> -0.748137).  Saving model ...
Epoch: 30 cost time: 0.503546953201294
Epoch: 30, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.128 Vali Acc: 0.763 Test Loss: 1.128 Test Acc: 0.763
Validation loss decreased (-0.748137 --> -0.762952).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.762962962962963
model parameter : 262182
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4283647537231445
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.768 Vali Acc: 0.189 Test Loss: 1.768 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.7250955104827881
Epoch: 2, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.753 Vali Acc: 0.189 Test Loss: 1.753 Test Acc: 0.189
Validation loss decreased (-0.188871 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.7131528854370117
Epoch: 3, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.743 Vali Acc: 0.204 Test Loss: 1.743 Test Acc: 0.204
Validation loss decreased (-0.188871 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.7064647674560547
Epoch: 4, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.737 Vali Acc: 0.211 Test Loss: 1.737 Test Acc: 0.211
Validation loss decreased (-0.203686 --> -0.211094).  Saving model ...
Epoch: 5 cost time: 0.7113132476806641
Epoch: 5, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.729 Vali Acc: 0.215 Test Loss: 1.729 Test Acc: 0.215
Validation loss decreased (-0.211094 --> -0.214798).  Saving model ...
Epoch: 6 cost time: 0.67759108543396
Epoch: 6, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.719 Vali Acc: 0.237 Test Loss: 1.719 Test Acc: 0.237
Validation loss decreased (-0.214798 --> -0.237020).  Saving model ...
Epoch: 7 cost time: 0.7260482311248779
Epoch: 7, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.708 Vali Acc: 0.256 Test Loss: 1.708 Test Acc: 0.256
Validation loss decreased (-0.237020 --> -0.255538).  Saving model ...
Epoch: 8 cost time: 0.7057077884674072
Epoch: 8, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.696 Vali Acc: 0.274 Test Loss: 1.696 Test Acc: 0.274
Validation loss decreased (-0.255538 --> -0.274057).  Saving model ...
Epoch: 9 cost time: 0.7249162197113037
Epoch: 9, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.683 Vali Acc: 0.300 Test Loss: 1.683 Test Acc: 0.300
Validation loss decreased (-0.274057 --> -0.299983).  Saving model ...
Epoch: 10 cost time: 0.690424919128418
Epoch: 10, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.669 Vali Acc: 0.311 Test Loss: 1.669 Test Acc: 0.311
Validation loss decreased (-0.299983 --> -0.311094).  Saving model ...
Epoch: 11 cost time: 0.8068966865539551
Epoch: 11, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.654 Vali Acc: 0.315 Test Loss: 1.654 Test Acc: 0.315
Validation loss decreased (-0.311094 --> -0.314798).  Saving model ...
Epoch: 12 cost time: 0.684006929397583
Epoch: 12, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.638 Vali Acc: 0.333 Test Loss: 1.638 Test Acc: 0.333
Validation loss decreased (-0.314798 --> -0.333317).  Saving model ...
Epoch: 13 cost time: 0.7614617347717285
Epoch: 13, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.622 Vali Acc: 0.352 Test Loss: 1.622 Test Acc: 0.352
Validation loss decreased (-0.333317 --> -0.351836).  Saving model ...
Epoch: 14 cost time: 0.7617440223693848
Epoch: 14, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.604 Vali Acc: 0.370 Test Loss: 1.604 Test Acc: 0.370
Validation loss decreased (-0.351836 --> -0.370354).  Saving model ...
Epoch: 15 cost time: 0.708315372467041
Epoch: 15, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.586 Vali Acc: 0.378 Test Loss: 1.586 Test Acc: 0.378
Validation loss decreased (-0.370354 --> -0.377762).  Saving model ...
Epoch: 16 cost time: 0.6834063529968262
Epoch: 16, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.568 Vali Acc: 0.419 Test Loss: 1.568 Test Acc: 0.419
Validation loss decreased (-0.377762 --> -0.418503).  Saving model ...
Epoch: 17 cost time: 0.7044248580932617
Epoch: 17, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.548 Vali Acc: 0.470 Test Loss: 1.548 Test Acc: 0.470
Validation loss decreased (-0.418503 --> -0.470355).  Saving model ...
Epoch: 18 cost time: 0.7081060409545898
Epoch: 18, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.528 Vali Acc: 0.507 Test Loss: 1.528 Test Acc: 0.507
Validation loss decreased (-0.470355 --> -0.507392).  Saving model ...
Epoch: 19 cost time: 0.7016112804412842
Epoch: 19, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.508 Vali Acc: 0.548 Test Loss: 1.508 Test Acc: 0.548
Validation loss decreased (-0.507392 --> -0.548133).  Saving model ...
Epoch: 20 cost time: 0.6646287441253662
Epoch: 20, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.487 Vali Acc: 0.611 Test Loss: 1.487 Test Acc: 0.611
Validation loss decreased (-0.548133 --> -0.611096).  Saving model ...
Epoch: 21 cost time: 0.678065299987793
Epoch: 21, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.465 Vali Acc: 0.637 Test Loss: 1.465 Test Acc: 0.637
Validation loss decreased (-0.611096 --> -0.637022).  Saving model ...
Epoch: 22 cost time: 0.683661699295044
Epoch: 22, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.443 Vali Acc: 0.659 Test Loss: 1.443 Test Acc: 0.659
Validation loss decreased (-0.637022 --> -0.659245).  Saving model ...
Epoch: 23 cost time: 0.7367274761199951
Epoch: 23, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.421 Vali Acc: 0.678 Test Loss: 1.421 Test Acc: 0.678
Validation loss decreased (-0.659245 --> -0.677764).  Saving model ...
Epoch: 24 cost time: 0.6965436935424805
Epoch: 24, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.399 Vali Acc: 0.678 Test Loss: 1.399 Test Acc: 0.678
Validation loss decreased (-0.677764 --> -0.677764).  Saving model ...
Epoch: 25 cost time: 0.713402271270752
Epoch: 25, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.376 Vali Acc: 0.693 Test Loss: 1.376 Test Acc: 0.693
Validation loss decreased (-0.677764 --> -0.692579).  Saving model ...
Epoch: 26 cost time: 0.7868847846984863
Epoch: 26, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.353 Vali Acc: 0.700 Test Loss: 1.353 Test Acc: 0.700
Validation loss decreased (-0.692579 --> -0.699986).  Saving model ...
Epoch: 27 cost time: 0.6753263473510742
Epoch: 27, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.330 Vali Acc: 0.707 Test Loss: 1.330 Test Acc: 0.707
Validation loss decreased (-0.699986 --> -0.707394).  Saving model ...
Epoch: 28 cost time: 0.7361247539520264
Epoch: 28, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.306 Vali Acc: 0.719 Test Loss: 1.306 Test Acc: 0.719
Validation loss decreased (-0.707394 --> -0.718505).  Saving model ...
Epoch: 29 cost time: 0.7796244621276855
Epoch: 29, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.283 Vali Acc: 0.726 Test Loss: 1.283 Test Acc: 0.726
Validation loss decreased (-0.718505 --> -0.725913).  Saving model ...
Epoch: 30 cost time: 0.7026658058166504
Epoch: 30, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.259 Vali Acc: 0.737 Test Loss: 1.259 Test Acc: 0.737
Validation loss decreased (-0.725913 --> -0.737024).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.737037037037037
model parameter : 443286
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.293294906616211
Epoch: 1, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.757 Vali Acc: 0.230 Test Loss: 1.757 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.6800930500030518
Epoch: 2, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.741 Vali Acc: 0.259 Test Loss: 1.741 Test Acc: 0.259
Validation loss decreased (-0.229612 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 0.6370289325714111
Epoch: 3, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.730 Vali Acc: 0.281 Test Loss: 1.730 Test Acc: 0.281
Validation loss decreased (-0.259242 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.6201872825622559
Epoch: 4, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.722 Vali Acc: 0.293 Test Loss: 1.722 Test Acc: 0.293
Validation loss decreased (-0.281464 --> -0.292575).  Saving model ...
Epoch: 5 cost time: 0.6504364013671875
Epoch: 5, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.712 Vali Acc: 0.311 Test Loss: 1.712 Test Acc: 0.311
Validation loss decreased (-0.292575 --> -0.311094).  Saving model ...
Epoch: 6 cost time: 0.6474153995513916
Epoch: 6, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.700 Vali Acc: 0.333 Test Loss: 1.700 Test Acc: 0.333
Validation loss decreased (-0.311094 --> -0.333316).  Saving model ...
Epoch: 7 cost time: 0.6563231945037842
Epoch: 7, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.687 Vali Acc: 0.344 Test Loss: 1.687 Test Acc: 0.344
Validation loss decreased (-0.333316 --> -0.344428).  Saving model ...
Epoch: 8 cost time: 0.6347768306732178
Epoch: 8, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.672 Vali Acc: 0.352 Test Loss: 1.672 Test Acc: 0.352
Validation loss decreased (-0.344428 --> -0.351835).  Saving model ...
Epoch: 9 cost time: 0.6395187377929688
Epoch: 9, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.655 Vali Acc: 0.378 Test Loss: 1.655 Test Acc: 0.378
Validation loss decreased (-0.351835 --> -0.377761).  Saving model ...
Epoch: 10 cost time: 0.6901266574859619
Epoch: 10, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.638 Vali Acc: 0.400 Test Loss: 1.638 Test Acc: 0.400
Validation loss decreased (-0.377761 --> -0.399984).  Saving model ...
Epoch: 11 cost time: 0.6406569480895996
Epoch: 11, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.619 Vali Acc: 0.407 Test Loss: 1.619 Test Acc: 0.407
Validation loss decreased (-0.399984 --> -0.407391).  Saving model ...
Epoch: 12 cost time: 0.6440739631652832
Epoch: 12, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.599 Vali Acc: 0.422 Test Loss: 1.599 Test Acc: 0.422
Validation loss decreased (-0.407391 --> -0.422206).  Saving model ...
Epoch: 13 cost time: 0.6829071044921875
Epoch: 13, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.579 Vali Acc: 0.433 Test Loss: 1.579 Test Acc: 0.433
Validation loss decreased (-0.422206 --> -0.433318).  Saving model ...
Epoch: 14 cost time: 0.6417181491851807
Epoch: 14, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.558 Vali Acc: 0.452 Test Loss: 1.558 Test Acc: 0.452
Validation loss decreased (-0.433318 --> -0.451836).  Saving model ...
Epoch: 15 cost time: 0.6677999496459961
Epoch: 15, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.537 Vali Acc: 0.463 Test Loss: 1.537 Test Acc: 0.463
Validation loss decreased (-0.451836 --> -0.462948).  Saving model ...
Epoch: 16 cost time: 0.6995186805725098
Epoch: 16, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.515 Vali Acc: 0.474 Test Loss: 1.515 Test Acc: 0.474
Validation loss decreased (-0.462948 --> -0.474059).  Saving model ...
Epoch: 17 cost time: 0.6316845417022705
Epoch: 17, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.492 Vali Acc: 0.478 Test Loss: 1.492 Test Acc: 0.478
Validation loss decreased (-0.474059 --> -0.477763).  Saving model ...
Epoch: 18 cost time: 0.6440412998199463
Epoch: 18, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.469 Vali Acc: 0.481 Test Loss: 1.469 Test Acc: 0.481
Validation loss decreased (-0.477763 --> -0.481467).  Saving model ...
Epoch: 19 cost time: 0.6522064208984375
Epoch: 19, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.446 Vali Acc: 0.504 Test Loss: 1.446 Test Acc: 0.504
Validation loss decreased (-0.481467 --> -0.503689).  Saving model ...
Epoch: 20 cost time: 0.7168514728546143
Epoch: 20, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.423 Vali Acc: 0.511 Test Loss: 1.423 Test Acc: 0.511
Validation loss decreased (-0.503689 --> -0.511097).  Saving model ...
Epoch: 21 cost time: 0.6559686660766602
Epoch: 21, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.399 Vali Acc: 0.522 Test Loss: 1.399 Test Acc: 0.522
Validation loss decreased (-0.511097 --> -0.522208).  Saving model ...
Epoch: 22 cost time: 0.6972765922546387
Epoch: 22, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.376 Vali Acc: 0.537 Test Loss: 1.376 Test Acc: 0.537
Validation loss decreased (-0.522208 --> -0.537023).  Saving model ...
Epoch: 23 cost time: 0.6848812103271484
Epoch: 23, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.353 Vali Acc: 0.559 Test Loss: 1.353 Test Acc: 0.559
Validation loss decreased (-0.537023 --> -0.559246).  Saving model ...
Epoch: 24 cost time: 0.6648824214935303
Epoch: 24, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.330 Vali Acc: 0.578 Test Loss: 1.330 Test Acc: 0.578
Validation loss decreased (-0.559246 --> -0.577764).  Saving model ...
Epoch: 25 cost time: 0.6633317470550537
Epoch: 25, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.306 Vali Acc: 0.585 Test Loss: 1.306 Test Acc: 0.585
Validation loss decreased (-0.577764 --> -0.585172).  Saving model ...
Epoch: 26 cost time: 0.7013325691223145
Epoch: 26, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.283 Vali Acc: 0.593 Test Loss: 1.283 Test Acc: 0.593
Validation loss decreased (-0.585172 --> -0.592580).  Saving model ...
Epoch: 27 cost time: 0.6705939769744873
Epoch: 27, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.260 Vali Acc: 0.619 Test Loss: 1.260 Test Acc: 0.619
Validation loss decreased (-0.592580 --> -0.618506).  Saving model ...
Epoch: 28 cost time: 0.7004377841949463
Epoch: 28, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.237 Vali Acc: 0.630 Test Loss: 1.237 Test Acc: 0.630
Validation loss decreased (-0.618506 --> -0.629617).  Saving model ...
Epoch: 29 cost time: 0.73264479637146
Epoch: 29, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.215 Vali Acc: 0.648 Test Loss: 1.215 Test Acc: 0.648
Validation loss decreased (-0.629617 --> -0.648136).  Saving model ...
Epoch: 30 cost time: 0.7327055931091309
Epoch: 30, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.192 Vali Acc: 0.670 Test Loss: 1.192 Test Acc: 0.670
Validation loss decreased (-0.648136 --> -0.670358).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6703703703703704
model parameter : 132774
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.409489870071411
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.768 Vali Acc: 0.189 Test Loss: 1.768 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.6515665054321289
Epoch: 2, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.753 Vali Acc: 0.189 Test Loss: 1.753 Test Acc: 0.189
Validation loss decreased (-0.188871 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.6496472358703613
Epoch: 3, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.743 Vali Acc: 0.204 Test Loss: 1.743 Test Acc: 0.204
Validation loss decreased (-0.188871 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.6397604942321777
Epoch: 4, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.737 Vali Acc: 0.211 Test Loss: 1.737 Test Acc: 0.211
Validation loss decreased (-0.203686 --> -0.211094).  Saving model ...
Epoch: 5 cost time: 0.653907060623169
Epoch: 5, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.729 Vali Acc: 0.215 Test Loss: 1.729 Test Acc: 0.215
Validation loss decreased (-0.211094 --> -0.214798).  Saving model ...
Epoch: 6 cost time: 0.6334607601165771
Epoch: 6, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.719 Vali Acc: 0.237 Test Loss: 1.719 Test Acc: 0.237
Validation loss decreased (-0.214798 --> -0.237020).  Saving model ...
Epoch: 7 cost time: 0.7137374877929688
Epoch: 7, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.708 Vali Acc: 0.256 Test Loss: 1.708 Test Acc: 0.256
Validation loss decreased (-0.237020 --> -0.255538).  Saving model ...
Epoch: 8 cost time: 0.6483578681945801
Epoch: 8, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.696 Vali Acc: 0.274 Test Loss: 1.696 Test Acc: 0.274
Validation loss decreased (-0.255538 --> -0.274057).  Saving model ...
Epoch: 9 cost time: 0.628652811050415
Epoch: 9, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.683 Vali Acc: 0.300 Test Loss: 1.683 Test Acc: 0.300
Validation loss decreased (-0.274057 --> -0.299983).  Saving model ...
Epoch: 10 cost time: 0.6234428882598877
Epoch: 10, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.669 Vali Acc: 0.311 Test Loss: 1.669 Test Acc: 0.311
Validation loss decreased (-0.299983 --> -0.311094).  Saving model ...
Epoch: 11 cost time: 0.6383218765258789
Epoch: 11, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.654 Vali Acc: 0.315 Test Loss: 1.654 Test Acc: 0.315
Validation loss decreased (-0.311094 --> -0.314798).  Saving model ...
Epoch: 12 cost time: 0.7250998020172119
Epoch: 12, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.638 Vali Acc: 0.333 Test Loss: 1.638 Test Acc: 0.333
Validation loss decreased (-0.314798 --> -0.333317).  Saving model ...
Epoch: 13 cost time: 0.6065876483917236
Epoch: 13, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.622 Vali Acc: 0.352 Test Loss: 1.622 Test Acc: 0.352
Validation loss decreased (-0.333317 --> -0.351836).  Saving model ...
Epoch: 14 cost time: 0.6101253032684326
Epoch: 14, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.604 Vali Acc: 0.370 Test Loss: 1.604 Test Acc: 0.370
Validation loss decreased (-0.351836 --> -0.370354).  Saving model ...
Epoch: 15 cost time: 0.6396148204803467
Epoch: 15, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.586 Vali Acc: 0.378 Test Loss: 1.586 Test Acc: 0.378
Validation loss decreased (-0.370354 --> -0.377762).  Saving model ...
Epoch: 16 cost time: 0.6010298728942871
Epoch: 16, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.568 Vali Acc: 0.419 Test Loss: 1.568 Test Acc: 0.419
Validation loss decreased (-0.377762 --> -0.418503).  Saving model ...
Epoch: 17 cost time: 0.648301362991333
Epoch: 17, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.548 Vali Acc: 0.470 Test Loss: 1.548 Test Acc: 0.470
Validation loss decreased (-0.418503 --> -0.470355).  Saving model ...
Epoch: 18 cost time: 0.6562221050262451
Epoch: 18, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.528 Vali Acc: 0.507 Test Loss: 1.528 Test Acc: 0.507
Validation loss decreased (-0.470355 --> -0.507392).  Saving model ...
Epoch: 19 cost time: 0.6063575744628906
Epoch: 19, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.508 Vali Acc: 0.548 Test Loss: 1.508 Test Acc: 0.548
Validation loss decreased (-0.507392 --> -0.548133).  Saving model ...
Epoch: 20 cost time: 0.6605048179626465
Epoch: 20, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.487 Vali Acc: 0.611 Test Loss: 1.487 Test Acc: 0.611
Validation loss decreased (-0.548133 --> -0.611096).  Saving model ...
Epoch: 21 cost time: 0.6210930347442627
Epoch: 21, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.465 Vali Acc: 0.637 Test Loss: 1.465 Test Acc: 0.637
Validation loss decreased (-0.611096 --> -0.637022).  Saving model ...
Epoch: 22 cost time: 0.6406874656677246
Epoch: 22, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.443 Vali Acc: 0.659 Test Loss: 1.443 Test Acc: 0.659
Validation loss decreased (-0.637022 --> -0.659245).  Saving model ...
Epoch: 23 cost time: 0.6368060111999512
Epoch: 23, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.421 Vali Acc: 0.678 Test Loss: 1.421 Test Acc: 0.678
Validation loss decreased (-0.659245 --> -0.677764).  Saving model ...
Epoch: 24 cost time: 0.6796743869781494
Epoch: 24, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.399 Vali Acc: 0.678 Test Loss: 1.399 Test Acc: 0.678
Validation loss decreased (-0.677764 --> -0.677764).  Saving model ...
Epoch: 25 cost time: 0.6243743896484375
Epoch: 25, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.376 Vali Acc: 0.693 Test Loss: 1.376 Test Acc: 0.693
Validation loss decreased (-0.677764 --> -0.692579).  Saving model ...
Epoch: 26 cost time: 0.6148576736450195
Epoch: 26, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.353 Vali Acc: 0.700 Test Loss: 1.353 Test Acc: 0.700
Validation loss decreased (-0.692579 --> -0.699986).  Saving model ...
Epoch: 27 cost time: 0.6446266174316406
Epoch: 27, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.330 Vali Acc: 0.707 Test Loss: 1.330 Test Acc: 0.707
Validation loss decreased (-0.699986 --> -0.707394).  Saving model ...
Epoch: 28 cost time: 0.6455364227294922
Epoch: 28, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.306 Vali Acc: 0.719 Test Loss: 1.306 Test Acc: 0.719
Validation loss decreased (-0.707394 --> -0.718505).  Saving model ...
Epoch: 29 cost time: 0.7226583957672119
Epoch: 29, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.283 Vali Acc: 0.726 Test Loss: 1.283 Test Acc: 0.726
Validation loss decreased (-0.718505 --> -0.725913).  Saving model ...
Epoch: 30 cost time: 0.624830961227417
Epoch: 30, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.259 Vali Acc: 0.737 Test Loss: 1.259 Test Acc: 0.737
Validation loss decreased (-0.725913 --> -0.737024).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.737037037037037
model parameter : 443286
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2657158374786377
Epoch: 1, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.757 Vali Acc: 0.230 Test Loss: 1.757 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.6044707298278809
Epoch: 2, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.741 Vali Acc: 0.259 Test Loss: 1.741 Test Acc: 0.259
Validation loss decreased (-0.229612 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 0.6267106533050537
Epoch: 3, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.730 Vali Acc: 0.281 Test Loss: 1.730 Test Acc: 0.281
Validation loss decreased (-0.259242 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.6644954681396484
Epoch: 4, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.722 Vali Acc: 0.293 Test Loss: 1.722 Test Acc: 0.293
Validation loss decreased (-0.281464 --> -0.292575).  Saving model ...
Epoch: 5 cost time: 0.5705492496490479
Epoch: 5, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.712 Vali Acc: 0.311 Test Loss: 1.712 Test Acc: 0.311
Validation loss decreased (-0.292575 --> -0.311094).  Saving model ...
Epoch: 6 cost time: 0.6158380508422852
Epoch: 6, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.700 Vali Acc: 0.333 Test Loss: 1.700 Test Acc: 0.333
Validation loss decreased (-0.311094 --> -0.333316).  Saving model ...
Epoch: 7 cost time: 0.578317403793335
Epoch: 7, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.687 Vali Acc: 0.344 Test Loss: 1.687 Test Acc: 0.344
Validation loss decreased (-0.333316 --> -0.344428).  Saving model ...
Epoch: 8 cost time: 0.5734755992889404
Epoch: 8, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.672 Vali Acc: 0.352 Test Loss: 1.672 Test Acc: 0.352
Validation loss decreased (-0.344428 --> -0.351835).  Saving model ...
Epoch: 9 cost time: 0.5853636264801025
Epoch: 9, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.655 Vali Acc: 0.378 Test Loss: 1.655 Test Acc: 0.378
Validation loss decreased (-0.351835 --> -0.377761).  Saving model ...
Epoch: 10 cost time: 0.5773825645446777
Epoch: 10, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.638 Vali Acc: 0.400 Test Loss: 1.638 Test Acc: 0.400
Validation loss decreased (-0.377761 --> -0.399984).  Saving model ...
Epoch: 11 cost time: 0.6189932823181152
Epoch: 11, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.619 Vali Acc: 0.407 Test Loss: 1.619 Test Acc: 0.407
Validation loss decreased (-0.399984 --> -0.407391).  Saving model ...
Epoch: 12 cost time: 0.5877053737640381
Epoch: 12, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.599 Vali Acc: 0.422 Test Loss: 1.599 Test Acc: 0.422
Validation loss decreased (-0.407391 --> -0.422206).  Saving model ...
Epoch: 13 cost time: 0.5835082530975342
Epoch: 13, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.579 Vali Acc: 0.433 Test Loss: 1.579 Test Acc: 0.433
Validation loss decreased (-0.422206 --> -0.433318).  Saving model ...
Epoch: 14 cost time: 0.6121716499328613
Epoch: 14, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.558 Vali Acc: 0.452 Test Loss: 1.558 Test Acc: 0.452
Validation loss decreased (-0.433318 --> -0.451836).  Saving model ...
Epoch: 15 cost time: 0.5988855361938477
Epoch: 15, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.537 Vali Acc: 0.463 Test Loss: 1.537 Test Acc: 0.463
Validation loss decreased (-0.451836 --> -0.462948).  Saving model ...
Epoch: 16 cost time: 0.5700666904449463
Epoch: 16, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.515 Vali Acc: 0.474 Test Loss: 1.515 Test Acc: 0.474
Validation loss decreased (-0.462948 --> -0.474059).  Saving model ...
Epoch: 17 cost time: 0.6047444343566895
Epoch: 17, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.492 Vali Acc: 0.478 Test Loss: 1.492 Test Acc: 0.478
Validation loss decreased (-0.474059 --> -0.477763).  Saving model ...
Epoch: 18 cost time: 0.5908937454223633
Epoch: 18, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.469 Vali Acc: 0.481 Test Loss: 1.469 Test Acc: 0.481
Validation loss decreased (-0.477763 --> -0.481467).  Saving model ...
Epoch: 19 cost time: 0.6641910076141357
Epoch: 19, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.446 Vali Acc: 0.504 Test Loss: 1.446 Test Acc: 0.504
Validation loss decreased (-0.481467 --> -0.503689).  Saving model ...
Epoch: 20 cost time: 0.6193399429321289
Epoch: 20, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.423 Vali Acc: 0.511 Test Loss: 1.423 Test Acc: 0.511
Validation loss decreased (-0.503689 --> -0.511097).  Saving model ...
Epoch: 21 cost time: 0.6345136165618896
Epoch: 21, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.399 Vali Acc: 0.522 Test Loss: 1.399 Test Acc: 0.522
Validation loss decreased (-0.511097 --> -0.522208).  Saving model ...
Epoch: 22 cost time: 0.6855974197387695
Epoch: 22, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.376 Vali Acc: 0.537 Test Loss: 1.376 Test Acc: 0.537
Validation loss decreased (-0.522208 --> -0.537023).  Saving model ...
Epoch: 23 cost time: 0.6977167129516602
Epoch: 23, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.353 Vali Acc: 0.559 Test Loss: 1.353 Test Acc: 0.559
Validation loss decreased (-0.537023 --> -0.559246).  Saving model ...
Epoch: 24 cost time: 0.588040828704834
Epoch: 24, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.330 Vali Acc: 0.578 Test Loss: 1.330 Test Acc: 0.578
Validation loss decreased (-0.559246 --> -0.577764).  Saving model ...
Epoch: 25 cost time: 0.684175968170166
Epoch: 25, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.306 Vali Acc: 0.585 Test Loss: 1.306 Test Acc: 0.585
Validation loss decreased (-0.577764 --> -0.585172).  Saving model ...
Epoch: 26 cost time: 0.5906434059143066
Epoch: 26, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.283 Vali Acc: 0.593 Test Loss: 1.283 Test Acc: 0.593
Validation loss decreased (-0.585172 --> -0.592580).  Saving model ...
Epoch: 27 cost time: 0.6529209613800049
Epoch: 27, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.260 Vali Acc: 0.619 Test Loss: 1.260 Test Acc: 0.619
Validation loss decreased (-0.592580 --> -0.618506).  Saving model ...
Epoch: 28 cost time: 0.5750124454498291
Epoch: 28, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.237 Vali Acc: 0.630 Test Loss: 1.237 Test Acc: 0.630
Validation loss decreased (-0.618506 --> -0.629617).  Saving model ...
Epoch: 29 cost time: 0.5968341827392578
Epoch: 29, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.215 Vali Acc: 0.648 Test Loss: 1.215 Test Acc: 0.648
Validation loss decreased (-0.629617 --> -0.648136).  Saving model ...
Epoch: 30 cost time: 0.6514637470245361
Epoch: 30, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.192 Vali Acc: 0.670 Test Loss: 1.192 Test Acc: 0.670
Validation loss decreased (-0.648136 --> -0.670358).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6703703703703704
model parameter : 132774
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.252730131149292
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.768 Vali Acc: 0.189 Test Loss: 1.768 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.5612156391143799
Epoch: 2, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.753 Vali Acc: 0.189 Test Loss: 1.753 Test Acc: 0.189
Validation loss decreased (-0.188871 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.5607407093048096
Epoch: 3, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.744 Vali Acc: 0.204 Test Loss: 1.744 Test Acc: 0.204
Validation loss decreased (-0.188871 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.5931394100189209
Epoch: 4, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.738 Vali Acc: 0.211 Test Loss: 1.738 Test Acc: 0.211
Validation loss decreased (-0.203686 --> -0.211094).  Saving model ...
Epoch: 5 cost time: 0.5742342472076416
Epoch: 5, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.730 Vali Acc: 0.215 Test Loss: 1.730 Test Acc: 0.215
Validation loss decreased (-0.211094 --> -0.214798).  Saving model ...
Epoch: 6 cost time: 0.5526199340820312
Epoch: 6, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.721 Vali Acc: 0.237 Test Loss: 1.721 Test Acc: 0.237
Validation loss decreased (-0.214798 --> -0.237020).  Saving model ...
Epoch: 7 cost time: 0.5665154457092285
Epoch: 7, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.710 Vali Acc: 0.252 Test Loss: 1.710 Test Acc: 0.252
Validation loss decreased (-0.237020 --> -0.251835).  Saving model ...
Epoch: 8 cost time: 0.5737400054931641
Epoch: 8, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.698 Vali Acc: 0.267 Test Loss: 1.698 Test Acc: 0.267
Validation loss decreased (-0.251835 --> -0.266650).  Saving model ...
Epoch: 9 cost time: 0.5574362277984619
Epoch: 9, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.686 Vali Acc: 0.289 Test Loss: 1.686 Test Acc: 0.289
Validation loss decreased (-0.266650 --> -0.288872).  Saving model ...
Epoch: 10 cost time: 0.5471446514129639
Epoch: 10, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.672 Vali Acc: 0.296 Test Loss: 1.672 Test Acc: 0.296
Validation loss decreased (-0.288872 --> -0.296280).  Saving model ...
Epoch: 11 cost time: 0.6139235496520996
Epoch: 11, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.658 Vali Acc: 0.307 Test Loss: 1.658 Test Acc: 0.307
Validation loss decreased (-0.296280 --> -0.307391).  Saving model ...
Epoch: 12 cost time: 0.5814061164855957
Epoch: 12, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.643 Vali Acc: 0.333 Test Loss: 1.643 Test Acc: 0.333
Validation loss decreased (-0.307391 --> -0.333317).  Saving model ...
Epoch: 13 cost time: 0.5860927104949951
Epoch: 13, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.627 Vali Acc: 0.352 Test Loss: 1.627 Test Acc: 0.352
Validation loss decreased (-0.333317 --> -0.351836).  Saving model ...
Epoch: 14 cost time: 0.5335607528686523
Epoch: 14, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.610 Vali Acc: 0.370 Test Loss: 1.610 Test Acc: 0.370
Validation loss decreased (-0.351836 --> -0.370354).  Saving model ...
Epoch: 15 cost time: 0.6025791168212891
Epoch: 15, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.593 Vali Acc: 0.378 Test Loss: 1.593 Test Acc: 0.378
Validation loss decreased (-0.370354 --> -0.377762).  Saving model ...
Epoch: 16 cost time: 0.6251144409179688
Epoch: 16, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.575 Vali Acc: 0.419 Test Loss: 1.575 Test Acc: 0.419
Validation loss decreased (-0.377762 --> -0.418503).  Saving model ...
Epoch: 17 cost time: 0.4995076656341553
Epoch: 17, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.556 Vali Acc: 0.463 Test Loss: 1.556 Test Acc: 0.463
Validation loss decreased (-0.418503 --> -0.462947).  Saving model ...
Epoch: 18 cost time: 0.604609489440918
Epoch: 18, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.537 Vali Acc: 0.493 Test Loss: 1.537 Test Acc: 0.493
Validation loss decreased (-0.462947 --> -0.492577).  Saving model ...
Epoch: 19 cost time: 0.5525786876678467
Epoch: 19, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.517 Vali Acc: 0.548 Test Loss: 1.517 Test Acc: 0.548
Validation loss decreased (-0.492577 --> -0.548133).  Saving model ...
Epoch: 20 cost time: 0.5582218170166016
Epoch: 20, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.497 Vali Acc: 0.596 Test Loss: 1.497 Test Acc: 0.596
Validation loss decreased (-0.548133 --> -0.596281).  Saving model ...
Epoch: 21 cost time: 0.5451188087463379
Epoch: 21, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.476 Vali Acc: 0.622 Test Loss: 1.476 Test Acc: 0.622
Validation loss decreased (-0.596281 --> -0.622207).  Saving model ...
Epoch: 22 cost time: 0.6407938003540039
Epoch: 22, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.454 Vali Acc: 0.633 Test Loss: 1.454 Test Acc: 0.633
Validation loss decreased (-0.622207 --> -0.633319).  Saving model ...
Epoch: 23 cost time: 0.5762839317321777
Epoch: 23, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.433 Vali Acc: 0.659 Test Loss: 1.433 Test Acc: 0.659
Validation loss decreased (-0.633319 --> -0.659245).  Saving model ...
Epoch: 24 cost time: 0.5547540187835693
Epoch: 24, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.411 Vali Acc: 0.663 Test Loss: 1.411 Test Acc: 0.663
Validation loss decreased (-0.659245 --> -0.662949).  Saving model ...
Epoch: 25 cost time: 0.6117684841156006
Epoch: 25, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.389 Vali Acc: 0.678 Test Loss: 1.389 Test Acc: 0.678
Validation loss decreased (-0.662949 --> -0.677764).  Saving model ...
Epoch: 26 cost time: 0.5902166366577148
Epoch: 26, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.366 Vali Acc: 0.700 Test Loss: 1.366 Test Acc: 0.700
Validation loss decreased (-0.677764 --> -0.699986).  Saving model ...
Epoch: 27 cost time: 0.6058857440948486
Epoch: 27, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.343 Vali Acc: 0.700 Test Loss: 1.343 Test Acc: 0.700
Validation loss decreased (-0.699986 --> -0.699987).  Saving model ...
Epoch: 28 cost time: 0.5946629047393799
Epoch: 28, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.320 Vali Acc: 0.711 Test Loss: 1.320 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711098).  Saving model ...
Epoch: 29 cost time: 0.563906192779541
Epoch: 29, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.296 Vali Acc: 0.722 Test Loss: 1.296 Test Acc: 0.722
Validation loss decreased (-0.711098 --> -0.722209).  Saving model ...
Epoch: 30 cost time: 0.575610876083374
Epoch: 30, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.273 Vali Acc: 0.730 Test Loss: 1.273 Test Acc: 0.730
Validation loss decreased (-0.722209 --> -0.729617).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7296296296296296
model parameter : 443286
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1526176929473877
Epoch: 1, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.757 Vali Acc: 0.233 Test Loss: 1.757 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 0.505565881729126
Epoch: 2, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.741 Vali Acc: 0.263 Test Loss: 1.741 Test Acc: 0.263
Validation loss decreased (-0.233316 --> -0.262946).  Saving model ...
Epoch: 3 cost time: 0.5231938362121582
Epoch: 3, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.730 Vali Acc: 0.281 Test Loss: 1.730 Test Acc: 0.281
Validation loss decreased (-0.262946 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.5310802459716797
Epoch: 4, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.722 Vali Acc: 0.293 Test Loss: 1.722 Test Acc: 0.293
Validation loss decreased (-0.281464 --> -0.292575).  Saving model ...
Epoch: 5 cost time: 0.5234591960906982
Epoch: 5, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.712 Vali Acc: 0.311 Test Loss: 1.712 Test Acc: 0.311
Validation loss decreased (-0.292575 --> -0.311094).  Saving model ...
Epoch: 6 cost time: 0.5153558254241943
Epoch: 6, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.701 Vali Acc: 0.333 Test Loss: 1.701 Test Acc: 0.333
Validation loss decreased (-0.311094 --> -0.333316).  Saving model ...
Epoch: 7 cost time: 0.5125377178192139
Epoch: 7, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.687 Vali Acc: 0.344 Test Loss: 1.687 Test Acc: 0.344
Validation loss decreased (-0.333316 --> -0.344428).  Saving model ...
Epoch: 8 cost time: 0.5167090892791748
Epoch: 8, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.672 Vali Acc: 0.352 Test Loss: 1.672 Test Acc: 0.352
Validation loss decreased (-0.344428 --> -0.351835).  Saving model ...
Epoch: 9 cost time: 0.5211057662963867
Epoch: 9, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.656 Vali Acc: 0.378 Test Loss: 1.656 Test Acc: 0.378
Validation loss decreased (-0.351835 --> -0.377761).  Saving model ...
Epoch: 10 cost time: 0.5148980617523193
Epoch: 10, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.638 Vali Acc: 0.396 Test Loss: 1.638 Test Acc: 0.396
Validation loss decreased (-0.377761 --> -0.396280).  Saving model ...
Epoch: 11 cost time: 0.5036699771881104
Epoch: 11, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.620 Vali Acc: 0.404 Test Loss: 1.620 Test Acc: 0.404
Validation loss decreased (-0.396280 --> -0.403688).  Saving model ...
Epoch: 12 cost time: 0.49343037605285645
Epoch: 12, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.600 Vali Acc: 0.419 Test Loss: 1.600 Test Acc: 0.419
Validation loss decreased (-0.403688 --> -0.418503).  Saving model ...
Epoch: 13 cost time: 0.5137019157409668
Epoch: 13, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.580 Vali Acc: 0.430 Test Loss: 1.580 Test Acc: 0.430
Validation loss decreased (-0.418503 --> -0.429614).  Saving model ...
Epoch: 14 cost time: 0.5202376842498779
Epoch: 14, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.559 Vali Acc: 0.448 Test Loss: 1.559 Test Acc: 0.448
Validation loss decreased (-0.429614 --> -0.448133).  Saving model ...
Epoch: 15 cost time: 0.5099527835845947
Epoch: 15, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.538 Vali Acc: 0.463 Test Loss: 1.538 Test Acc: 0.463
Validation loss decreased (-0.448133 --> -0.462948).  Saving model ...
Epoch: 16 cost time: 0.4936695098876953
Epoch: 16, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.516 Vali Acc: 0.474 Test Loss: 1.516 Test Acc: 0.474
Validation loss decreased (-0.462948 --> -0.474059).  Saving model ...
Epoch: 17 cost time: 0.4982469081878662
Epoch: 17, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.493 Vali Acc: 0.478 Test Loss: 1.493 Test Acc: 0.478
Validation loss decreased (-0.474059 --> -0.477763).  Saving model ...
Epoch: 18 cost time: 0.49721288681030273
Epoch: 18, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.471 Vali Acc: 0.485 Test Loss: 1.471 Test Acc: 0.485
Validation loss decreased (-0.477763 --> -0.485170).  Saving model ...
Epoch: 19 cost time: 0.49972963333129883
Epoch: 19, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.448 Vali Acc: 0.507 Test Loss: 1.448 Test Acc: 0.507
Validation loss decreased (-0.485170 --> -0.507393).  Saving model ...
Epoch: 20 cost time: 0.4898650646209717
Epoch: 20, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.424 Vali Acc: 0.515 Test Loss: 1.424 Test Acc: 0.515
Validation loss decreased (-0.507393 --> -0.514801).  Saving model ...
Epoch: 21 cost time: 0.5181465148925781
Epoch: 21, Steps: 2 | Train Loss: 1.319 Vali Loss: 1.401 Vali Acc: 0.526 Test Loss: 1.401 Test Acc: 0.526
Validation loss decreased (-0.514801 --> -0.525912).  Saving model ...
Epoch: 22 cost time: 0.5092008113861084
Epoch: 22, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.378 Vali Acc: 0.541 Test Loss: 1.378 Test Acc: 0.541
Validation loss decreased (-0.525912 --> -0.540727).  Saving model ...
Epoch: 23 cost time: 0.5322306156158447
Epoch: 23, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.355 Vali Acc: 0.563 Test Loss: 1.355 Test Acc: 0.563
Validation loss decreased (-0.540727 --> -0.562949).  Saving model ...
Epoch: 24 cost time: 0.5295758247375488
Epoch: 24, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.331 Vali Acc: 0.581 Test Loss: 1.331 Test Acc: 0.581
Validation loss decreased (-0.562949 --> -0.581468).  Saving model ...
Epoch: 25 cost time: 0.534501314163208
Epoch: 25, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.308 Vali Acc: 0.581 Test Loss: 1.308 Test Acc: 0.581
Validation loss decreased (-0.581468 --> -0.581468).  Saving model ...
Epoch: 26 cost time: 0.5569820404052734
Epoch: 26, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.285 Vali Acc: 0.596 Test Loss: 1.285 Test Acc: 0.596
Validation loss decreased (-0.581468 --> -0.596283).  Saving model ...
Epoch: 27 cost time: 0.5409324169158936
Epoch: 27, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.262 Vali Acc: 0.619 Test Loss: 1.262 Test Acc: 0.619
Validation loss decreased (-0.596283 --> -0.618506).  Saving model ...
Epoch: 28 cost time: 0.5496118068695068
Epoch: 28, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.239 Vali Acc: 0.633 Test Loss: 1.239 Test Acc: 0.633
Validation loss decreased (-0.618506 --> -0.633321).  Saving model ...
Epoch: 29 cost time: 0.5249946117401123
Epoch: 29, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.216 Vali Acc: 0.644 Test Loss: 1.216 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644432).  Saving model ...
Epoch: 30 cost time: 0.5459079742431641
Epoch: 30, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.194 Vali Acc: 0.667 Test Loss: 1.194 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666655).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6666666666666666
model parameter : 132774
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.486776113510132
Epoch: 1, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.701 Vali Acc: 0.204 Test Loss: 1.701 Test Acc: 0.204
Validation loss decreased (inf --> -0.203687).  Saving model ...
Epoch: 2 cost time: 0.7358758449554443
Epoch: 2, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.681 Vali Acc: 0.215 Test Loss: 1.681 Test Acc: 0.215
Validation loss decreased (-0.203687 --> -0.214798).  Saving model ...
Epoch: 3 cost time: 0.7387702465057373
Epoch: 3, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.669 Vali Acc: 0.219 Test Loss: 1.669 Test Acc: 0.219
Validation loss decreased (-0.214798 --> -0.218502).  Saving model ...
Epoch: 4 cost time: 0.7300910949707031
Epoch: 4, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.662 Vali Acc: 0.230 Test Loss: 1.662 Test Acc: 0.230
Validation loss decreased (-0.218502 --> -0.229613).  Saving model ...
Epoch: 5 cost time: 0.7349708080291748
Epoch: 5, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.652 Vali Acc: 0.233 Test Loss: 1.652 Test Acc: 0.233
Validation loss decreased (-0.229613 --> -0.233317).  Saving model ...
Epoch: 6 cost time: 0.7132165431976318
Epoch: 6, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.640 Vali Acc: 0.267 Test Loss: 1.640 Test Acc: 0.267
Validation loss decreased (-0.233317 --> -0.266650).  Saving model ...
Epoch: 7 cost time: 0.7553942203521729
Epoch: 7, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.628 Vali Acc: 0.289 Test Loss: 1.628 Test Acc: 0.289
Validation loss decreased (-0.266650 --> -0.288873).  Saving model ...
Epoch: 8 cost time: 0.684455394744873
Epoch: 8, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.613 Vali Acc: 0.315 Test Loss: 1.613 Test Acc: 0.315
Validation loss decreased (-0.288873 --> -0.314799).  Saving model ...
Epoch: 9 cost time: 0.7124090194702148
Epoch: 9, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.598 Vali Acc: 0.337 Test Loss: 1.598 Test Acc: 0.337
Validation loss decreased (-0.314799 --> -0.337021).  Saving model ...
Epoch: 10 cost time: 0.6991779804229736
Epoch: 10, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.582 Vali Acc: 0.363 Test Loss: 1.582 Test Acc: 0.363
Validation loss decreased (-0.337021 --> -0.362947).  Saving model ...
Epoch: 11 cost time: 0.719451904296875
Epoch: 11, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.564 Vali Acc: 0.407 Test Loss: 1.564 Test Acc: 0.407
Validation loss decreased (-0.362947 --> -0.407392).  Saving model ...
Epoch: 12 cost time: 0.7005064487457275
Epoch: 12, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.546 Vali Acc: 0.437 Test Loss: 1.546 Test Acc: 0.437
Validation loss decreased (-0.407392 --> -0.437022).  Saving model ...
Epoch: 13 cost time: 0.696448802947998
Epoch: 13, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.527 Vali Acc: 0.467 Test Loss: 1.527 Test Acc: 0.467
Validation loss decreased (-0.437022 --> -0.466651).  Saving model ...
Epoch: 14 cost time: 0.7070341110229492
Epoch: 14, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.507 Vali Acc: 0.481 Test Loss: 1.507 Test Acc: 0.481
Validation loss decreased (-0.466651 --> -0.481466).  Saving model ...
Epoch: 15 cost time: 0.6944088935852051
Epoch: 15, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.487 Vali Acc: 0.522 Test Loss: 1.487 Test Acc: 0.522
Validation loss decreased (-0.481466 --> -0.522207).  Saving model ...
Epoch: 16 cost time: 0.6827802658081055
Epoch: 16, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.466 Vali Acc: 0.548 Test Loss: 1.466 Test Acc: 0.548
Validation loss decreased (-0.522207 --> -0.548133).  Saving model ...
Epoch: 17 cost time: 0.7088217735290527
Epoch: 17, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.445 Vali Acc: 0.585 Test Loss: 1.445 Test Acc: 0.585
Validation loss decreased (-0.548133 --> -0.585171).  Saving model ...
Epoch: 18 cost time: 0.6389505863189697
Epoch: 18, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.424 Vali Acc: 0.596 Test Loss: 1.424 Test Acc: 0.596
Validation loss decreased (-0.585171 --> -0.596282).  Saving model ...
Epoch: 19 cost time: 0.6645681858062744
Epoch: 19, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.402 Vali Acc: 0.615 Test Loss: 1.402 Test Acc: 0.615
Validation loss decreased (-0.596282 --> -0.614801).  Saving model ...
Epoch: 20 cost time: 0.6702001094818115
Epoch: 20, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.380 Vali Acc: 0.630 Test Loss: 1.380 Test Acc: 0.630
Validation loss decreased (-0.614801 --> -0.629616).  Saving model ...
Epoch: 21 cost time: 0.6927258968353271
Epoch: 21, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.358 Vali Acc: 0.644 Test Loss: 1.358 Test Acc: 0.644
Validation loss decreased (-0.629616 --> -0.644431).  Saving model ...
Epoch: 22 cost time: 0.6757252216339111
Epoch: 22, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.336 Vali Acc: 0.656 Test Loss: 1.336 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655542).  Saving model ...
Epoch: 23 cost time: 0.7186639308929443
Epoch: 23, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.313 Vali Acc: 0.667 Test Loss: 1.313 Test Acc: 0.667
Validation loss decreased (-0.655542 --> -0.666654).  Saving model ...
Epoch: 24 cost time: 0.640871524810791
Epoch: 24, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.291 Vali Acc: 0.689 Test Loss: 1.291 Test Acc: 0.689
Validation loss decreased (-0.666654 --> -0.688876).  Saving model ...
Epoch: 25 cost time: 0.7188284397125244
Epoch: 25, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.268 Vali Acc: 0.693 Test Loss: 1.268 Test Acc: 0.693
Validation loss decreased (-0.688876 --> -0.692580).  Saving model ...
Epoch: 26 cost time: 0.7253768444061279
Epoch: 26, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.246 Vali Acc: 0.693 Test Loss: 1.246 Test Acc: 0.693
Validation loss decreased (-0.692580 --> -0.692580).  Saving model ...
Epoch: 27 cost time: 0.7481868267059326
Epoch: 27, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.223 Vali Acc: 0.719 Test Loss: 1.223 Test Acc: 0.719
Validation loss decreased (-0.692580 --> -0.718506).  Saving model ...
Epoch: 28 cost time: 0.7605893611907959
Epoch: 28, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.201 Vali Acc: 0.737 Test Loss: 1.201 Test Acc: 0.737
Validation loss decreased (-0.718506 --> -0.737025).  Saving model ...
Epoch: 29 cost time: 0.7024252414703369
Epoch: 29, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.180 Vali Acc: 0.748 Test Loss: 1.180 Test Acc: 0.748
Validation loss decreased (-0.737025 --> -0.748136).  Saving model ...
Epoch: 30 cost time: 0.614771842956543
Epoch: 30, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.158 Vali Acc: 0.759 Test Loss: 1.158 Test Acc: 0.759
Validation loss decreased (-0.748136 --> -0.759248).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7592592592592593
model parameter : 223350
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1654951572418213
Epoch: 1, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.752 Vali Acc: 0.196 Test Loss: 1.752 Test Acc: 0.196
Validation loss decreased (inf --> -0.196279).  Saving model ...
Epoch: 2 cost time: 0.6346485614776611
Epoch: 2, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.738 Vali Acc: 0.226 Test Loss: 1.738 Test Acc: 0.226
Validation loss decreased (-0.196279 --> -0.225909).  Saving model ...
Epoch: 3 cost time: 0.6380405426025391
Epoch: 3, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.729 Vali Acc: 0.233 Test Loss: 1.729 Test Acc: 0.233
Validation loss decreased (-0.225909 --> -0.233316).  Saving model ...
Epoch: 4 cost time: 0.6171925067901611
Epoch: 4, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.722 Vali Acc: 0.244 Test Loss: 1.722 Test Acc: 0.244
Validation loss decreased (-0.233316 --> -0.244427).  Saving model ...
Epoch: 5 cost time: 0.6292054653167725
Epoch: 5, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.714 Vali Acc: 0.252 Test Loss: 1.714 Test Acc: 0.252
Validation loss decreased (-0.244427 --> -0.251835).  Saving model ...
Epoch: 6 cost time: 0.6136434078216553
Epoch: 6, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.705 Vali Acc: 0.263 Test Loss: 1.705 Test Acc: 0.263
Validation loss decreased (-0.251835 --> -0.262946).  Saving model ...
Epoch: 7 cost time: 0.6118030548095703
Epoch: 7, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.694 Vali Acc: 0.274 Test Loss: 1.694 Test Acc: 0.274
Validation loss decreased (-0.262946 --> -0.274057).  Saving model ...
Epoch: 8 cost time: 0.6036703586578369
Epoch: 8, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.682 Vali Acc: 0.293 Test Loss: 1.682 Test Acc: 0.293
Validation loss decreased (-0.274057 --> -0.292576).  Saving model ...
Epoch: 9 cost time: 0.6163253784179688
Epoch: 9, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.669 Vali Acc: 0.307 Test Loss: 1.669 Test Acc: 0.307
Validation loss decreased (-0.292576 --> -0.307391).  Saving model ...
Epoch: 10 cost time: 0.6301932334899902
Epoch: 10, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.655 Vali Acc: 0.333 Test Loss: 1.655 Test Acc: 0.333
Validation loss decreased (-0.307391 --> -0.333317).  Saving model ...
Epoch: 11 cost time: 0.6318485736846924
Epoch: 11, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.640 Vali Acc: 0.356 Test Loss: 1.640 Test Acc: 0.356
Validation loss decreased (-0.333317 --> -0.355539).  Saving model ...
Epoch: 12 cost time: 0.6113591194152832
Epoch: 12, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.624 Vali Acc: 0.370 Test Loss: 1.624 Test Acc: 0.370
Validation loss decreased (-0.355539 --> -0.370354).  Saving model ...
Epoch: 13 cost time: 0.6062614917755127
Epoch: 13, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.608 Vali Acc: 0.393 Test Loss: 1.608 Test Acc: 0.393
Validation loss decreased (-0.370354 --> -0.392577).  Saving model ...
Epoch: 14 cost time: 0.5992865562438965
Epoch: 14, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.591 Vali Acc: 0.404 Test Loss: 1.591 Test Acc: 0.404
Validation loss decreased (-0.392577 --> -0.403688).  Saving model ...
Epoch: 15 cost time: 0.607036828994751
Epoch: 15, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.574 Vali Acc: 0.437 Test Loss: 1.574 Test Acc: 0.437
Validation loss decreased (-0.403688 --> -0.437021).  Saving model ...
Epoch: 16 cost time: 0.6220810413360596
Epoch: 16, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.557 Vali Acc: 0.448 Test Loss: 1.557 Test Acc: 0.448
Validation loss decreased (-0.437021 --> -0.448133).  Saving model ...
Epoch: 17 cost time: 0.6371848583221436
Epoch: 17, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.538 Vali Acc: 0.478 Test Loss: 1.538 Test Acc: 0.478
Validation loss decreased (-0.448133 --> -0.477762).  Saving model ...
Epoch: 18 cost time: 0.6177546977996826
Epoch: 18, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.520 Vali Acc: 0.507 Test Loss: 1.520 Test Acc: 0.507
Validation loss decreased (-0.477762 --> -0.507392).  Saving model ...
Epoch: 19 cost time: 0.6210086345672607
Epoch: 19, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.501 Vali Acc: 0.541 Test Loss: 1.501 Test Acc: 0.541
Validation loss decreased (-0.507392 --> -0.540726).  Saving model ...
Epoch: 20 cost time: 0.6488747596740723
Epoch: 20, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.481 Vali Acc: 0.567 Test Loss: 1.481 Test Acc: 0.567
Validation loss decreased (-0.540726 --> -0.566652).  Saving model ...
Epoch: 21 cost time: 0.6065948009490967
Epoch: 21, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.461 Vali Acc: 0.578 Test Loss: 1.461 Test Acc: 0.578
Validation loss decreased (-0.566652 --> -0.577763).  Saving model ...
Epoch: 22 cost time: 0.6079115867614746
Epoch: 22, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.441 Vali Acc: 0.596 Test Loss: 1.441 Test Acc: 0.596
Validation loss decreased (-0.577763 --> -0.596282).  Saving model ...
Epoch: 23 cost time: 0.6143910884857178
Epoch: 23, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.421 Vali Acc: 0.607 Test Loss: 1.421 Test Acc: 0.607
Validation loss decreased (-0.596282 --> -0.607393).  Saving model ...
Epoch: 24 cost time: 0.5974318981170654
Epoch: 24, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.400 Vali Acc: 0.622 Test Loss: 1.400 Test Acc: 0.622
Validation loss decreased (-0.607393 --> -0.622208).  Saving model ...
Epoch: 25 cost time: 0.6034269332885742
Epoch: 25, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.380 Vali Acc: 0.630 Test Loss: 1.380 Test Acc: 0.630
Validation loss decreased (-0.622208 --> -0.629616).  Saving model ...
Epoch: 26 cost time: 0.6154334545135498
Epoch: 26, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.359 Vali Acc: 0.644 Test Loss: 1.359 Test Acc: 0.644
Validation loss decreased (-0.629616 --> -0.644431).  Saving model ...
Epoch: 27 cost time: 0.6231498718261719
Epoch: 27, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.338 Vali Acc: 0.670 Test Loss: 1.338 Test Acc: 0.670
Validation loss decreased (-0.644431 --> -0.670357).  Saving model ...
Epoch: 28 cost time: 0.605487585067749
Epoch: 28, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.317 Vali Acc: 0.700 Test Loss: 1.317 Test Acc: 0.700
Validation loss decreased (-0.670357 --> -0.699987).  Saving model ...
Epoch: 29 cost time: 0.6048111915588379
Epoch: 29, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.295 Vali Acc: 0.715 Test Loss: 1.295 Test Acc: 0.715
Validation loss decreased (-0.699987 --> -0.714802).  Saving model ...
Epoch: 30 cost time: 0.633181095123291
Epoch: 30, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.274 Vali Acc: 0.730 Test Loss: 1.274 Test Acc: 0.730
Validation loss decreased (-0.714802 --> -0.729617).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7296296296296296
model parameter : 68070
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0218820571899414
Epoch: 1, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.701 Vali Acc: 0.204 Test Loss: 1.701 Test Acc: 0.204
Validation loss decreased (inf --> -0.203687).  Saving model ...
Epoch: 2 cost time: 0.5553543567657471
Epoch: 2, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.681 Vali Acc: 0.215 Test Loss: 1.681 Test Acc: 0.215
Validation loss decreased (-0.203687 --> -0.214798).  Saving model ...
Epoch: 3 cost time: 0.5906221866607666
Epoch: 3, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.669 Vali Acc: 0.219 Test Loss: 1.669 Test Acc: 0.219
Validation loss decreased (-0.214798 --> -0.218502).  Saving model ...
Epoch: 4 cost time: 0.5979878902435303
Epoch: 4, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.662 Vali Acc: 0.230 Test Loss: 1.662 Test Acc: 0.230
Validation loss decreased (-0.218502 --> -0.229613).  Saving model ...
Epoch: 5 cost time: 0.5897181034088135
Epoch: 5, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.652 Vali Acc: 0.233 Test Loss: 1.652 Test Acc: 0.233
Validation loss decreased (-0.229613 --> -0.233317).  Saving model ...
Epoch: 6 cost time: 0.6092946529388428
Epoch: 6, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.640 Vali Acc: 0.267 Test Loss: 1.640 Test Acc: 0.267
Validation loss decreased (-0.233317 --> -0.266650).  Saving model ...
Epoch: 7 cost time: 0.5670018196105957
Epoch: 7, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.628 Vali Acc: 0.289 Test Loss: 1.628 Test Acc: 0.289
Validation loss decreased (-0.266650 --> -0.288873).  Saving model ...
Epoch: 8 cost time: 0.5906460285186768
Epoch: 8, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.613 Vali Acc: 0.315 Test Loss: 1.613 Test Acc: 0.315
Validation loss decreased (-0.288873 --> -0.314799).  Saving model ...
Epoch: 9 cost time: 0.5842657089233398
Epoch: 9, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.598 Vali Acc: 0.337 Test Loss: 1.598 Test Acc: 0.337
Validation loss decreased (-0.314799 --> -0.337021).  Saving model ...
Epoch: 10 cost time: 0.5934743881225586
Epoch: 10, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.582 Vali Acc: 0.363 Test Loss: 1.582 Test Acc: 0.363
Validation loss decreased (-0.337021 --> -0.362947).  Saving model ...
Epoch: 11 cost time: 0.6093895435333252
Epoch: 11, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.564 Vali Acc: 0.407 Test Loss: 1.564 Test Acc: 0.407
Validation loss decreased (-0.362947 --> -0.407392).  Saving model ...
Epoch: 12 cost time: 0.6101818084716797
Epoch: 12, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.546 Vali Acc: 0.437 Test Loss: 1.546 Test Acc: 0.437
Validation loss decreased (-0.407392 --> -0.437022).  Saving model ...
Epoch: 13 cost time: 0.626044750213623
Epoch: 13, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.527 Vali Acc: 0.467 Test Loss: 1.527 Test Acc: 0.467
Validation loss decreased (-0.437022 --> -0.466651).  Saving model ...
Epoch: 14 cost time: 0.6453535556793213
Epoch: 14, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.507 Vali Acc: 0.481 Test Loss: 1.507 Test Acc: 0.481
Validation loss decreased (-0.466651 --> -0.481466).  Saving model ...
Epoch: 15 cost time: 0.6402978897094727
Epoch: 15, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.487 Vali Acc: 0.522 Test Loss: 1.487 Test Acc: 0.522
Validation loss decreased (-0.481466 --> -0.522207).  Saving model ...
Epoch: 16 cost time: 0.6054403781890869
Epoch: 16, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.466 Vali Acc: 0.548 Test Loss: 1.466 Test Acc: 0.548
Validation loss decreased (-0.522207 --> -0.548133).  Saving model ...
Epoch: 17 cost time: 0.5947935581207275
Epoch: 17, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.445 Vali Acc: 0.585 Test Loss: 1.445 Test Acc: 0.585
Validation loss decreased (-0.548133 --> -0.585171).  Saving model ...
Epoch: 18 cost time: 0.6030542850494385
Epoch: 18, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.424 Vali Acc: 0.596 Test Loss: 1.424 Test Acc: 0.596
Validation loss decreased (-0.585171 --> -0.596282).  Saving model ...
Epoch: 19 cost time: 0.6097874641418457
Epoch: 19, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.402 Vali Acc: 0.615 Test Loss: 1.402 Test Acc: 0.615
Validation loss decreased (-0.596282 --> -0.614801).  Saving model ...
Epoch: 20 cost time: 0.623497724533081
Epoch: 20, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.380 Vali Acc: 0.630 Test Loss: 1.380 Test Acc: 0.630
Validation loss decreased (-0.614801 --> -0.629616).  Saving model ...
Epoch: 21 cost time: 0.5977845191955566
Epoch: 21, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.358 Vali Acc: 0.644 Test Loss: 1.358 Test Acc: 0.644
Validation loss decreased (-0.629616 --> -0.644431).  Saving model ...
Epoch: 22 cost time: 0.6061496734619141
Epoch: 22, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.336 Vali Acc: 0.656 Test Loss: 1.336 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655542).  Saving model ...
Epoch: 23 cost time: 0.6109919548034668
Epoch: 23, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.313 Vali Acc: 0.667 Test Loss: 1.313 Test Acc: 0.667
Validation loss decreased (-0.655542 --> -0.666654).  Saving model ...
Epoch: 24 cost time: 0.570070743560791
Epoch: 24, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.291 Vali Acc: 0.689 Test Loss: 1.291 Test Acc: 0.689
Validation loss decreased (-0.666654 --> -0.688876).  Saving model ...
Epoch: 25 cost time: 0.6165575981140137
Epoch: 25, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.268 Vali Acc: 0.693 Test Loss: 1.268 Test Acc: 0.693
Validation loss decreased (-0.688876 --> -0.692580).  Saving model ...
Epoch: 26 cost time: 0.6262187957763672
Epoch: 26, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.246 Vali Acc: 0.693 Test Loss: 1.246 Test Acc: 0.693
Validation loss decreased (-0.692580 --> -0.692580).  Saving model ...
Epoch: 27 cost time: 0.5988466739654541
Epoch: 27, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.223 Vali Acc: 0.719 Test Loss: 1.223 Test Acc: 0.719
Validation loss decreased (-0.692580 --> -0.718506).  Saving model ...
Epoch: 28 cost time: 0.6298205852508545
Epoch: 28, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.201 Vali Acc: 0.737 Test Loss: 1.201 Test Acc: 0.737
Validation loss decreased (-0.718506 --> -0.737025).  Saving model ...
Epoch: 29 cost time: 0.6200196743011475
Epoch: 29, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.180 Vali Acc: 0.748 Test Loss: 1.180 Test Acc: 0.748
Validation loss decreased (-0.737025 --> -0.748136).  Saving model ...
Epoch: 30 cost time: 0.6211583614349365
Epoch: 30, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.158 Vali Acc: 0.759 Test Loss: 1.158 Test Acc: 0.759
Validation loss decreased (-0.748136 --> -0.759248).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7592592592592593
model parameter : 223350
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.039518356323242
Epoch: 1, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.752 Vali Acc: 0.196 Test Loss: 1.752 Test Acc: 0.196
Validation loss decreased (inf --> -0.196279).  Saving model ...
Epoch: 2 cost time: 0.6123018264770508
Epoch: 2, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.738 Vali Acc: 0.222 Test Loss: 1.738 Test Acc: 0.222
Validation loss decreased (-0.196279 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 0.5504560470581055
Epoch: 3, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.729 Vali Acc: 0.230 Test Loss: 1.729 Test Acc: 0.230
Validation loss decreased (-0.222205 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 0.5463459491729736
Epoch: 4, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.723 Vali Acc: 0.244 Test Loss: 1.723 Test Acc: 0.244
Validation loss decreased (-0.229612 --> -0.244427).  Saving model ...
Epoch: 5 cost time: 0.5430798530578613
Epoch: 5, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.714 Vali Acc: 0.252 Test Loss: 1.714 Test Acc: 0.252
Validation loss decreased (-0.244427 --> -0.251835).  Saving model ...
Epoch: 6 cost time: 0.5307638645172119
Epoch: 6, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.705 Vali Acc: 0.263 Test Loss: 1.705 Test Acc: 0.263
Validation loss decreased (-0.251835 --> -0.262946).  Saving model ...
Epoch: 7 cost time: 0.53739333152771
Epoch: 7, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.694 Vali Acc: 0.274 Test Loss: 1.694 Test Acc: 0.274
Validation loss decreased (-0.262946 --> -0.274057).  Saving model ...
Epoch: 8 cost time: 0.5548675060272217
Epoch: 8, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.682 Vali Acc: 0.293 Test Loss: 1.682 Test Acc: 0.293
Validation loss decreased (-0.274057 --> -0.292576).  Saving model ...
Epoch: 9 cost time: 0.5346541404724121
Epoch: 9, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.669 Vali Acc: 0.307 Test Loss: 1.669 Test Acc: 0.307
Validation loss decreased (-0.292576 --> -0.307391).  Saving model ...
Epoch: 10 cost time: 0.5882964134216309
Epoch: 10, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.655 Vali Acc: 0.333 Test Loss: 1.655 Test Acc: 0.333
Validation loss decreased (-0.307391 --> -0.333317).  Saving model ...
Epoch: 11 cost time: 0.5663361549377441
Epoch: 11, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.640 Vali Acc: 0.356 Test Loss: 1.640 Test Acc: 0.356
Validation loss decreased (-0.333317 --> -0.355539).  Saving model ...
Epoch: 12 cost time: 0.5397622585296631
Epoch: 12, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.625 Vali Acc: 0.370 Test Loss: 1.625 Test Acc: 0.370
Validation loss decreased (-0.355539 --> -0.370354).  Saving model ...
Epoch: 13 cost time: 0.5282678604125977
Epoch: 13, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.608 Vali Acc: 0.393 Test Loss: 1.608 Test Acc: 0.393
Validation loss decreased (-0.370354 --> -0.392577).  Saving model ...
Epoch: 14 cost time: 0.5182664394378662
Epoch: 14, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.592 Vali Acc: 0.404 Test Loss: 1.592 Test Acc: 0.404
Validation loss decreased (-0.392577 --> -0.403688).  Saving model ...
Epoch: 15 cost time: 0.5406494140625
Epoch: 15, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.574 Vali Acc: 0.437 Test Loss: 1.574 Test Acc: 0.437
Validation loss decreased (-0.403688 --> -0.437021).  Saving model ...
Epoch: 16 cost time: 0.5658524036407471
Epoch: 16, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.557 Vali Acc: 0.448 Test Loss: 1.557 Test Acc: 0.448
Validation loss decreased (-0.437021 --> -0.448133).  Saving model ...
Epoch: 17 cost time: 0.4933638572692871
Epoch: 17, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.538 Vali Acc: 0.478 Test Loss: 1.538 Test Acc: 0.478
Validation loss decreased (-0.448133 --> -0.477762).  Saving model ...
Epoch: 18 cost time: 0.5728788375854492
Epoch: 18, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.520 Vali Acc: 0.507 Test Loss: 1.520 Test Acc: 0.507
Validation loss decreased (-0.477762 --> -0.507392).  Saving model ...
Epoch: 19 cost time: 0.522688627243042
Epoch: 19, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.501 Vali Acc: 0.541 Test Loss: 1.501 Test Acc: 0.541
Validation loss decreased (-0.507392 --> -0.540726).  Saving model ...
Epoch: 20 cost time: 0.5524594783782959
Epoch: 20, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.481 Vali Acc: 0.567 Test Loss: 1.481 Test Acc: 0.567
Validation loss decreased (-0.540726 --> -0.566652).  Saving model ...
Epoch: 21 cost time: 0.5482461452484131
Epoch: 21, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.461 Vali Acc: 0.578 Test Loss: 1.461 Test Acc: 0.578
Validation loss decreased (-0.566652 --> -0.577763).  Saving model ...
Epoch: 22 cost time: 0.579479455947876
Epoch: 22, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.441 Vali Acc: 0.596 Test Loss: 1.441 Test Acc: 0.596
Validation loss decreased (-0.577763 --> -0.596282).  Saving model ...
Epoch: 23 cost time: 0.6169464588165283
Epoch: 23, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.421 Vali Acc: 0.607 Test Loss: 1.421 Test Acc: 0.607
Validation loss decreased (-0.596282 --> -0.607393).  Saving model ...
Epoch: 24 cost time: 0.6343910694122314
Epoch: 24, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.400 Vali Acc: 0.622 Test Loss: 1.400 Test Acc: 0.622
Validation loss decreased (-0.607393 --> -0.622208).  Saving model ...
Epoch: 25 cost time: 0.5629348754882812
Epoch: 25, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.380 Vali Acc: 0.630 Test Loss: 1.380 Test Acc: 0.630
Validation loss decreased (-0.622208 --> -0.629616).  Saving model ...
Epoch: 26 cost time: 0.5805811882019043
Epoch: 26, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.359 Vali Acc: 0.644 Test Loss: 1.359 Test Acc: 0.644
Validation loss decreased (-0.629616 --> -0.644431).  Saving model ...
Epoch: 27 cost time: 0.5511324405670166
Epoch: 27, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.338 Vali Acc: 0.670 Test Loss: 1.338 Test Acc: 0.670
Validation loss decreased (-0.644431 --> -0.670357).  Saving model ...
Epoch: 28 cost time: 0.6536579132080078
Epoch: 28, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.317 Vali Acc: 0.700 Test Loss: 1.317 Test Acc: 0.700
Validation loss decreased (-0.670357 --> -0.699987).  Saving model ...
Epoch: 29 cost time: 0.6057238578796387
Epoch: 29, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.295 Vali Acc: 0.715 Test Loss: 1.295 Test Acc: 0.715
Validation loss decreased (-0.699987 --> -0.714802).  Saving model ...
Epoch: 30 cost time: 0.6671836376190186
Epoch: 30, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.274 Vali Acc: 0.730 Test Loss: 1.274 Test Acc: 0.730
Validation loss decreased (-0.714802 --> -0.729617).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7296296296296296
model parameter : 68070
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.267519474029541
Epoch: 1, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.701 Vali Acc: 0.204 Test Loss: 1.701 Test Acc: 0.204
Validation loss decreased (inf --> -0.203687).  Saving model ...
Epoch: 2 cost time: 0.5448288917541504
Epoch: 2, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.682 Vali Acc: 0.215 Test Loss: 1.682 Test Acc: 0.215
Validation loss decreased (-0.203687 --> -0.214798).  Saving model ...
Epoch: 3 cost time: 0.5453784465789795
Epoch: 3, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.669 Vali Acc: 0.219 Test Loss: 1.669 Test Acc: 0.219
Validation loss decreased (-0.214798 --> -0.218502).  Saving model ...
Epoch: 4 cost time: 0.5294857025146484
Epoch: 4, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.662 Vali Acc: 0.230 Test Loss: 1.662 Test Acc: 0.230
Validation loss decreased (-0.218502 --> -0.229613).  Saving model ...
Epoch: 5 cost time: 0.511894702911377
Epoch: 5, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.652 Vali Acc: 0.233 Test Loss: 1.652 Test Acc: 0.233
Validation loss decreased (-0.229613 --> -0.233317).  Saving model ...
Epoch: 6 cost time: 0.5586457252502441
Epoch: 6, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.641 Vali Acc: 0.267 Test Loss: 1.641 Test Acc: 0.267
Validation loss decreased (-0.233317 --> -0.266650).  Saving model ...
Epoch: 7 cost time: 0.5638020038604736
Epoch: 7, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.628 Vali Acc: 0.289 Test Loss: 1.628 Test Acc: 0.289
Validation loss decreased (-0.266650 --> -0.288873).  Saving model ...
Epoch: 8 cost time: 0.540381908416748
Epoch: 8, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.614 Vali Acc: 0.319 Test Loss: 1.614 Test Acc: 0.319
Validation loss decreased (-0.288873 --> -0.318502).  Saving model ...
Epoch: 9 cost time: 0.518817663192749
Epoch: 9, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.599 Vali Acc: 0.337 Test Loss: 1.599 Test Acc: 0.337
Validation loss decreased (-0.318502 --> -0.337021).  Saving model ...
Epoch: 10 cost time: 0.5019481182098389
Epoch: 10, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.582 Vali Acc: 0.363 Test Loss: 1.582 Test Acc: 0.363
Validation loss decreased (-0.337021 --> -0.362947).  Saving model ...
Epoch: 11 cost time: 0.5168478488922119
Epoch: 11, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.565 Vali Acc: 0.407 Test Loss: 1.565 Test Acc: 0.407
Validation loss decreased (-0.362947 --> -0.407392).  Saving model ...
Epoch: 12 cost time: 0.5616722106933594
Epoch: 12, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.546 Vali Acc: 0.437 Test Loss: 1.546 Test Acc: 0.437
Validation loss decreased (-0.407392 --> -0.437022).  Saving model ...
Epoch: 13 cost time: 0.5500404834747314
Epoch: 13, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.528 Vali Acc: 0.467 Test Loss: 1.528 Test Acc: 0.467
Validation loss decreased (-0.437022 --> -0.466651).  Saving model ...
Epoch: 14 cost time: 0.5224528312683105
Epoch: 14, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.508 Vali Acc: 0.481 Test Loss: 1.508 Test Acc: 0.481
Validation loss decreased (-0.466651 --> -0.481466).  Saving model ...
Epoch: 15 cost time: 0.5485861301422119
Epoch: 15, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.488 Vali Acc: 0.519 Test Loss: 1.488 Test Acc: 0.519
Validation loss decreased (-0.481466 --> -0.518504).  Saving model ...
Epoch: 16 cost time: 0.5761044025421143
Epoch: 16, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.467 Vali Acc: 0.548 Test Loss: 1.467 Test Acc: 0.548
Validation loss decreased (-0.518504 --> -0.548133).  Saving model ...
Epoch: 17 cost time: 0.554332971572876
Epoch: 17, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.446 Vali Acc: 0.585 Test Loss: 1.446 Test Acc: 0.585
Validation loss decreased (-0.548133 --> -0.585171).  Saving model ...
Epoch: 18 cost time: 0.6012358665466309
Epoch: 18, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.425 Vali Acc: 0.593 Test Loss: 1.425 Test Acc: 0.593
Validation loss decreased (-0.585171 --> -0.592578).  Saving model ...
Epoch: 19 cost time: 0.6242082118988037
Epoch: 19, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.403 Vali Acc: 0.611 Test Loss: 1.403 Test Acc: 0.611
Validation loss decreased (-0.592578 --> -0.611097).  Saving model ...
Epoch: 20 cost time: 0.6165223121643066
Epoch: 20, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.381 Vali Acc: 0.626 Test Loss: 1.381 Test Acc: 0.626
Validation loss decreased (-0.611097 --> -0.625912).  Saving model ...
Epoch: 21 cost time: 0.6192665100097656
Epoch: 21, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.359 Vali Acc: 0.637 Test Loss: 1.359 Test Acc: 0.637
Validation loss decreased (-0.625912 --> -0.637023).  Saving model ...
Epoch: 22 cost time: 0.6471395492553711
Epoch: 22, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.337 Vali Acc: 0.652 Test Loss: 1.337 Test Acc: 0.652
Validation loss decreased (-0.637023 --> -0.651838).  Saving model ...
Epoch: 23 cost time: 0.6325864791870117
Epoch: 23, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.314 Vali Acc: 0.663 Test Loss: 1.314 Test Acc: 0.663
Validation loss decreased (-0.651838 --> -0.662950).  Saving model ...
Epoch: 24 cost time: 0.6591529846191406
Epoch: 24, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.292 Vali Acc: 0.685 Test Loss: 1.292 Test Acc: 0.685
Validation loss decreased (-0.662950 --> -0.685172).  Saving model ...
Epoch: 25 cost time: 0.6221930980682373
Epoch: 25, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.269 Vali Acc: 0.693 Test Loss: 1.269 Test Acc: 0.693
Validation loss decreased (-0.685172 --> -0.692580).  Saving model ...
Epoch: 26 cost time: 0.5619430541992188
Epoch: 26, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.247 Vali Acc: 0.693 Test Loss: 1.247 Test Acc: 0.693
Validation loss decreased (-0.692580 --> -0.692580).  Saving model ...
Epoch: 27 cost time: 0.6114814281463623
Epoch: 27, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.225 Vali Acc: 0.719 Test Loss: 1.225 Test Acc: 0.719
Validation loss decreased (-0.692580 --> -0.718506).  Saving model ...
Epoch: 28 cost time: 0.6422710418701172
Epoch: 28, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.203 Vali Acc: 0.737 Test Loss: 1.203 Test Acc: 0.737
Validation loss decreased (-0.718506 --> -0.737025).  Saving model ...
Epoch: 29 cost time: 0.6253488063812256
Epoch: 29, Steps: 2 | Train Loss: 1.083 Vali Loss: 1.181 Vali Acc: 0.748 Test Loss: 1.181 Test Acc: 0.748
Validation loss decreased (-0.737025 --> -0.748136).  Saving model ...
Epoch: 30 cost time: 0.625455379486084
Epoch: 30, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.159 Vali Acc: 0.759 Test Loss: 1.159 Test Acc: 0.759
Validation loss decreased (-0.748136 --> -0.759248).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7592592592592593
model parameter : 223350
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.216522216796875
Epoch: 1, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.752 Vali Acc: 0.196 Test Loss: 1.752 Test Acc: 0.196
Validation loss decreased (inf --> -0.196279).  Saving model ...
Epoch: 2 cost time: 0.6177065372467041
Epoch: 2, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.737 Vali Acc: 0.222 Test Loss: 1.737 Test Acc: 0.222
Validation loss decreased (-0.196279 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 0.5327508449554443
Epoch: 3, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.728 Vali Acc: 0.230 Test Loss: 1.728 Test Acc: 0.230
Validation loss decreased (-0.222205 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 0.5874555110931396
Epoch: 4, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.722 Vali Acc: 0.248 Test Loss: 1.722 Test Acc: 0.248
Validation loss decreased (-0.229612 --> -0.248131).  Saving model ...
Epoch: 5 cost time: 0.5924041271209717
Epoch: 5, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.714 Vali Acc: 0.252 Test Loss: 1.714 Test Acc: 0.252
Validation loss decreased (-0.248131 --> -0.251835).  Saving model ...
Epoch: 6 cost time: 0.5574800968170166
Epoch: 6, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.705 Vali Acc: 0.263 Test Loss: 1.705 Test Acc: 0.263
Validation loss decreased (-0.251835 --> -0.262946).  Saving model ...
Epoch: 7 cost time: 0.5427393913269043
Epoch: 7, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.694 Vali Acc: 0.274 Test Loss: 1.694 Test Acc: 0.274
Validation loss decreased (-0.262946 --> -0.274057).  Saving model ...
Epoch: 8 cost time: 0.500922441482544
Epoch: 8, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.682 Vali Acc: 0.293 Test Loss: 1.682 Test Acc: 0.293
Validation loss decreased (-0.274057 --> -0.292576).  Saving model ...
Epoch: 9 cost time: 0.5879318714141846
Epoch: 9, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.669 Vali Acc: 0.307 Test Loss: 1.669 Test Acc: 0.307
Validation loss decreased (-0.292576 --> -0.307391).  Saving model ...
Epoch: 10 cost time: 0.569364070892334
Epoch: 10, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.655 Vali Acc: 0.333 Test Loss: 1.655 Test Acc: 0.333
Validation loss decreased (-0.307391 --> -0.333317).  Saving model ...
Epoch: 11 cost time: 0.5571813583374023
Epoch: 11, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.640 Vali Acc: 0.359 Test Loss: 1.640 Test Acc: 0.359
Validation loss decreased (-0.333317 --> -0.359243).  Saving model ...
Epoch: 12 cost time: 0.5531175136566162
Epoch: 12, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.625 Vali Acc: 0.370 Test Loss: 1.625 Test Acc: 0.370
Validation loss decreased (-0.359243 --> -0.370354).  Saving model ...
Epoch: 13 cost time: 0.5728893280029297
Epoch: 13, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.609 Vali Acc: 0.389 Test Loss: 1.609 Test Acc: 0.389
Validation loss decreased (-0.370354 --> -0.388873).  Saving model ...
Epoch: 14 cost time: 0.5063543319702148
Epoch: 14, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.592 Vali Acc: 0.400 Test Loss: 1.592 Test Acc: 0.400
Validation loss decreased (-0.388873 --> -0.399984).  Saving model ...
Epoch: 15 cost time: 0.5026829242706299
Epoch: 15, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.575 Vali Acc: 0.433 Test Loss: 1.575 Test Acc: 0.433
Validation loss decreased (-0.399984 --> -0.433318).  Saving model ...
Epoch: 16 cost time: 0.5392816066741943
Epoch: 16, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.557 Vali Acc: 0.448 Test Loss: 1.557 Test Acc: 0.448
Validation loss decreased (-0.433318 --> -0.448133).  Saving model ...
Epoch: 17 cost time: 0.5722494125366211
Epoch: 17, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.539 Vali Acc: 0.478 Test Loss: 1.539 Test Acc: 0.478
Validation loss decreased (-0.448133 --> -0.477762).  Saving model ...
Epoch: 18 cost time: 0.5476133823394775
Epoch: 18, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.521 Vali Acc: 0.511 Test Loss: 1.521 Test Acc: 0.511
Validation loss decreased (-0.477762 --> -0.511096).  Saving model ...
Epoch: 19 cost time: 0.5439410209655762
Epoch: 19, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.502 Vali Acc: 0.541 Test Loss: 1.502 Test Acc: 0.541
Validation loss decreased (-0.511096 --> -0.540726).  Saving model ...
Epoch: 20 cost time: 0.5404536724090576
Epoch: 20, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.482 Vali Acc: 0.556 Test Loss: 1.482 Test Acc: 0.556
Validation loss decreased (-0.540726 --> -0.555541).  Saving model ...
Epoch: 21 cost time: 0.586207389831543
Epoch: 21, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.463 Vali Acc: 0.578 Test Loss: 1.463 Test Acc: 0.578
Validation loss decreased (-0.555541 --> -0.577763).  Saving model ...
Epoch: 22 cost time: 0.6125080585479736
Epoch: 22, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.443 Vali Acc: 0.600 Test Loss: 1.443 Test Acc: 0.600
Validation loss decreased (-0.577763 --> -0.599986).  Saving model ...
Epoch: 23 cost time: 0.5713071823120117
Epoch: 23, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.423 Vali Acc: 0.615 Test Loss: 1.423 Test Acc: 0.615
Validation loss decreased (-0.599986 --> -0.614801).  Saving model ...
Epoch: 24 cost time: 0.5380904674530029
Epoch: 24, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.402 Vali Acc: 0.633 Test Loss: 1.402 Test Acc: 0.633
Validation loss decreased (-0.614801 --> -0.633319).  Saving model ...
Epoch: 25 cost time: 0.5824429988861084
Epoch: 25, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.382 Vali Acc: 0.633 Test Loss: 1.382 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633320).  Saving model ...
Epoch: 26 cost time: 0.5574827194213867
Epoch: 26, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.361 Vali Acc: 0.648 Test Loss: 1.361 Test Acc: 0.648
Validation loss decreased (-0.633320 --> -0.648135).  Saving model ...
Epoch: 27 cost time: 0.6088049411773682
Epoch: 27, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.340 Vali Acc: 0.681 Test Loss: 1.340 Test Acc: 0.681
Validation loss decreased (-0.648135 --> -0.681468).  Saving model ...
Epoch: 28 cost time: 0.5714197158813477
Epoch: 28, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.319 Vali Acc: 0.707 Test Loss: 1.319 Test Acc: 0.707
Validation loss decreased (-0.681468 --> -0.707394).  Saving model ...
Epoch: 29 cost time: 0.5557126998901367
Epoch: 29, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.298 Vali Acc: 0.711 Test Loss: 1.298 Test Acc: 0.711
Validation loss decreased (-0.707394 --> -0.711098).  Saving model ...
Epoch: 30 cost time: 0.5637640953063965
Epoch: 30, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.277 Vali Acc: 0.726 Test Loss: 1.277 Test Acc: 0.726
Validation loss decreased (-0.711098 --> -0.725913).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.725925925925926
model parameter : 68070
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.953247308731079
Epoch: 1, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.801 Vali Acc: 0.204 Test Loss: 1.801 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 2.440364122390747
Epoch: 2, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.720 Vali Acc: 0.230 Test Loss: 1.720 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229612).  Saving model ...
Epoch: 3 cost time: 2.5045721530914307
Epoch: 3, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.631 Vali Acc: 0.300 Test Loss: 1.631 Test Acc: 0.300
Validation loss decreased (-0.229612 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 2.4304144382476807
Epoch: 4, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.501 Vali Acc: 0.470 Test Loss: 1.501 Test Acc: 0.470
Validation loss decreased (-0.299984 --> -0.470355).  Saving model ...
Epoch: 5 cost time: 2.4415640830993652
Epoch: 5, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.347 Vali Acc: 0.656 Test Loss: 1.347 Test Acc: 0.656
Validation loss decreased (-0.470355 --> -0.655542).  Saving model ...
Epoch: 6 cost time: 2.5586740970611572
Epoch: 6, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.185 Vali Acc: 0.759 Test Loss: 1.185 Test Acc: 0.759
Validation loss decreased (-0.655542 --> -0.759247).  Saving model ...
Epoch: 7 cost time: 2.59093976020813
Epoch: 7, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.024 Vali Acc: 0.837 Test Loss: 1.024 Test Acc: 0.837
Validation loss decreased (-0.759247 --> -0.837027).  Saving model ...
Epoch: 8 cost time: 2.6096832752227783
Epoch: 8, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.873 Vali Acc: 0.852 Test Loss: 0.873 Test Acc: 0.852
Validation loss decreased (-0.837027 --> -0.851843).  Saving model ...
Epoch: 9 cost time: 2.6515438556671143
Epoch: 9, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.738 Vali Acc: 0.874 Test Loss: 0.738 Test Acc: 0.874
Validation loss decreased (-0.851843 --> -0.874067).  Saving model ...
Epoch: 10 cost time: 2.577399253845215
Epoch: 10, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.625 Vali Acc: 0.889 Test Loss: 0.625 Test Acc: 0.889
Validation loss decreased (-0.874067 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 2.6200578212738037
Epoch: 11, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.532 Vali Acc: 0.896 Test Loss: 0.532 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 12 cost time: 2.581362724304199
Epoch: 12, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.455 Vali Acc: 0.907 Test Loss: 0.455 Test Acc: 0.907
Validation loss decreased (-0.896291 --> -0.907403).  Saving model ...
Epoch: 13 cost time: 2.445674180984497
Epoch: 13, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.390 Vali Acc: 0.911 Test Loss: 0.390 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 14 cost time: 2.5065882205963135
Epoch: 14, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.340 Vali Acc: 0.919 Test Loss: 0.340 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 15 cost time: 2.30667781829834
Epoch: 15, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 16 cost time: 2.5518856048583984
Epoch: 16, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 17 cost time: 2.539982318878174
Epoch: 17, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.251 Vali Acc: 0.915 Test Loss: 0.251 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5499305725097656
Epoch: 18, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 19 cost time: 2.5989179611206055
Epoch: 19, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 20 cost time: 2.5286195278167725
Epoch: 20, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 21 cost time: 2.596691370010376
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 22 cost time: 2.5907633304595947
Epoch: 22, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 23 cost time: 2.4656994342803955
Epoch: 23, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 24 cost time: 2.421731948852539
Epoch: 24, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 25 cost time: 2.513948917388916
Epoch: 25, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 26 cost time: 2.506021499633789
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 27 cost time: 2.5053281784057617
Epoch: 27, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.388174533843994
Epoch: 28, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.926 Test Loss: 0.198 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.448951005935669
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 30 cost time: 2.4012885093688965
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 37543430
model size : 145.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.480062484741211
Epoch: 1, Steps: 2 | Train Loss: 2.051 Vali Loss: 2.011 Vali Acc: 0.030 Test Loss: 2.011 Test Acc: 0.030
Validation loss decreased (inf --> -0.029610).  Saving model ...
Epoch: 2 cost time: 0.9385178089141846
Epoch: 2, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.930 Vali Acc: 0.093 Test Loss: 1.930 Test Acc: 0.093
Validation loss decreased (-0.029610 --> -0.092573).  Saving model ...
Epoch: 3 cost time: 0.9406516551971436
Epoch: 3, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.840 Vali Acc: 0.159 Test Loss: 1.840 Test Acc: 0.159
Validation loss decreased (-0.092573 --> -0.159241).  Saving model ...
Epoch: 4 cost time: 0.9362916946411133
Epoch: 4, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.707 Vali Acc: 0.307 Test Loss: 1.707 Test Acc: 0.307
Validation loss decreased (-0.159241 --> -0.307390).  Saving model ...
Epoch: 5 cost time: 0.9961285591125488
Epoch: 5, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.544 Vali Acc: 0.474 Test Loss: 1.544 Test Acc: 0.474
Validation loss decreased (-0.307390 --> -0.474059).  Saving model ...
Epoch: 6 cost time: 1.0325887203216553
Epoch: 6, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.367 Vali Acc: 0.648 Test Loss: 1.367 Test Acc: 0.648
Validation loss decreased (-0.474059 --> -0.648134).  Saving model ...
Epoch: 7 cost time: 0.932340145111084
Epoch: 7, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.189 Vali Acc: 0.748 Test Loss: 1.189 Test Acc: 0.748
Validation loss decreased (-0.648134 --> -0.748136).  Saving model ...
Epoch: 8 cost time: 1.0618433952331543
Epoch: 8, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.021 Vali Acc: 0.785 Test Loss: 1.021 Test Acc: 0.785
Validation loss decreased (-0.748136 --> -0.785175).  Saving model ...
Epoch: 9 cost time: 0.9988481998443604
Epoch: 9, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.872 Vali Acc: 0.833 Test Loss: 0.872 Test Acc: 0.833
Validation loss decreased (-0.785175 --> -0.833325).  Saving model ...
Epoch: 10 cost time: 1.085843563079834
Epoch: 10, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.741 Vali Acc: 0.867 Test Loss: 0.741 Test Acc: 0.867
Validation loss decreased (-0.833325 --> -0.866659).  Saving model ...
Epoch: 11 cost time: 1.0153288841247559
Epoch: 11, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.630 Vali Acc: 0.881 Test Loss: 0.630 Test Acc: 0.881
Validation loss decreased (-0.866659 --> -0.881475).  Saving model ...
Epoch: 12 cost time: 1.04233980178833
Epoch: 12, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.537 Vali Acc: 0.904 Test Loss: 0.537 Test Acc: 0.904
Validation loss decreased (-0.881475 --> -0.903698).  Saving model ...
Epoch: 13 cost time: 1.025068998336792
Epoch: 13, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.462 Vali Acc: 0.922 Test Loss: 0.462 Test Acc: 0.922
Validation loss decreased (-0.903698 --> -0.922218).  Saving model ...
Epoch: 14 cost time: 1.0275068283081055
Epoch: 14, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.403 Vali Acc: 0.933 Test Loss: 0.403 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933329).  Saving model ...
Epoch: 15 cost time: 1.0222010612487793
Epoch: 15, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.356 Vali Acc: 0.922 Test Loss: 0.356 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0096893310546875
Epoch: 16, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.323 Vali Acc: 0.915 Test Loss: 0.323 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0122931003570557
Epoch: 17, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.292 Vali Acc: 0.919 Test Loss: 0.292 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9326605796813965
Epoch: 18, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.266 Vali Acc: 0.926 Test Loss: 0.266 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9078619480133057
Epoch: 19, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9357385635375977
Epoch: 20, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.9449372291564941
Epoch: 21, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.952610969543457
Epoch: 22, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9378478527069092
Epoch: 23, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9612095355987549
Epoch: 24, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9642777442932129
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.926 Test Loss: 0.196 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.040511131286621
Epoch: 26, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9949817657470703
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.926 Test Loss: 0.193 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9543037414550781
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.926 Test Loss: 0.191 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0644845962524414
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.926 Test Loss: 0.190 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0439703464508057
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.926 Test Loss: 0.189 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 11065350
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.294210433959961
Epoch: 1, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.801 Vali Acc: 0.204 Test Loss: 1.801 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 1.9403131008148193
Epoch: 2, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.720 Vali Acc: 0.230 Test Loss: 1.720 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229612).  Saving model ...
Epoch: 3 cost time: 1.967207908630371
Epoch: 3, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.631 Vali Acc: 0.300 Test Loss: 1.631 Test Acc: 0.300
Validation loss decreased (-0.229612 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.870107889175415
Epoch: 4, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.501 Vali Acc: 0.470 Test Loss: 1.501 Test Acc: 0.470
Validation loss decreased (-0.299984 --> -0.470355).  Saving model ...
Epoch: 5 cost time: 1.8623690605163574
Epoch: 5, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.347 Vali Acc: 0.656 Test Loss: 1.347 Test Acc: 0.656
Validation loss decreased (-0.470355 --> -0.655542).  Saving model ...
Epoch: 6 cost time: 1.878067970275879
Epoch: 6, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.185 Vali Acc: 0.759 Test Loss: 1.185 Test Acc: 0.759
Validation loss decreased (-0.655542 --> -0.759247).  Saving model ...
Epoch: 7 cost time: 1.7992455959320068
Epoch: 7, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.024 Vali Acc: 0.837 Test Loss: 1.024 Test Acc: 0.837
Validation loss decreased (-0.759247 --> -0.837027).  Saving model ...
Epoch: 8 cost time: 1.9469780921936035
Epoch: 8, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.873 Vali Acc: 0.852 Test Loss: 0.873 Test Acc: 0.852
Validation loss decreased (-0.837027 --> -0.851843).  Saving model ...
Epoch: 9 cost time: 1.9112560749053955
Epoch: 9, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.738 Vali Acc: 0.874 Test Loss: 0.738 Test Acc: 0.874
Validation loss decreased (-0.851843 --> -0.874067).  Saving model ...
Epoch: 10 cost time: 1.9376130104064941
Epoch: 10, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.625 Vali Acc: 0.889 Test Loss: 0.625 Test Acc: 0.889
Validation loss decreased (-0.874067 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 1.879662275314331
Epoch: 11, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.532 Vali Acc: 0.896 Test Loss: 0.532 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 12 cost time: 1.9374310970306396
Epoch: 12, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.455 Vali Acc: 0.907 Test Loss: 0.455 Test Acc: 0.907
Validation loss decreased (-0.896291 --> -0.907403).  Saving model ...
Epoch: 13 cost time: 1.9917552471160889
Epoch: 13, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.390 Vali Acc: 0.911 Test Loss: 0.390 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 14 cost time: 1.9491703510284424
Epoch: 14, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.340 Vali Acc: 0.919 Test Loss: 0.340 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 15 cost time: 1.9196579456329346
Epoch: 15, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 16 cost time: 1.8239095211029053
Epoch: 16, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 17 cost time: 1.8545241355895996
Epoch: 17, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.251 Vali Acc: 0.915 Test Loss: 0.251 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.813147783279419
Epoch: 18, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 19 cost time: 1.8601350784301758
Epoch: 19, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 20 cost time: 1.967890739440918
Epoch: 20, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 21 cost time: 2.0112905502319336
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 22 cost time: 1.955294132232666
Epoch: 22, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 23 cost time: 1.9567220211029053
Epoch: 23, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 24 cost time: 1.9650242328643799
Epoch: 24, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 25 cost time: 1.9861159324645996
Epoch: 25, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 26 cost time: 1.8424599170684814
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 27 cost time: 1.8776028156280518
Epoch: 27, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9339923858642578
Epoch: 28, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.926 Test Loss: 0.198 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8324003219604492
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 30 cost time: 1.8152234554290771
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 37543430
model size : 145.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.406599521636963
Epoch: 1, Steps: 2 | Train Loss: 2.051 Vali Loss: 2.011 Vali Acc: 0.030 Test Loss: 2.011 Test Acc: 0.030
Validation loss decreased (inf --> -0.029610).  Saving model ...
Epoch: 2 cost time: 0.8759002685546875
Epoch: 2, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.930 Vali Acc: 0.093 Test Loss: 1.930 Test Acc: 0.093
Validation loss decreased (-0.029610 --> -0.092573).  Saving model ...
Epoch: 3 cost time: 0.8275821208953857
Epoch: 3, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.840 Vali Acc: 0.159 Test Loss: 1.840 Test Acc: 0.159
Validation loss decreased (-0.092573 --> -0.159241).  Saving model ...
Epoch: 4 cost time: 0.7672839164733887
Epoch: 4, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.707 Vali Acc: 0.307 Test Loss: 1.707 Test Acc: 0.307
Validation loss decreased (-0.159241 --> -0.307390).  Saving model ...
Epoch: 5 cost time: 0.8350062370300293
Epoch: 5, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.544 Vali Acc: 0.474 Test Loss: 1.544 Test Acc: 0.474
Validation loss decreased (-0.307390 --> -0.474059).  Saving model ...
Epoch: 6 cost time: 0.9979379177093506
Epoch: 6, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.367 Vali Acc: 0.648 Test Loss: 1.367 Test Acc: 0.648
Validation loss decreased (-0.474059 --> -0.648134).  Saving model ...
Epoch: 7 cost time: 0.9655508995056152
Epoch: 7, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.189 Vali Acc: 0.748 Test Loss: 1.189 Test Acc: 0.748
Validation loss decreased (-0.648134 --> -0.748136).  Saving model ...
Epoch: 8 cost time: 0.9253103733062744
Epoch: 8, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.021 Vali Acc: 0.785 Test Loss: 1.021 Test Acc: 0.785
Validation loss decreased (-0.748136 --> -0.785175).  Saving model ...
Epoch: 9 cost time: 0.9617936611175537
Epoch: 9, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.872 Vali Acc: 0.833 Test Loss: 0.872 Test Acc: 0.833
Validation loss decreased (-0.785175 --> -0.833325).  Saving model ...
Epoch: 10 cost time: 0.9606809616088867
Epoch: 10, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.741 Vali Acc: 0.867 Test Loss: 0.741 Test Acc: 0.867
Validation loss decreased (-0.833325 --> -0.866659).  Saving model ...
Epoch: 11 cost time: 0.9668912887573242
Epoch: 11, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.630 Vali Acc: 0.881 Test Loss: 0.630 Test Acc: 0.881
Validation loss decreased (-0.866659 --> -0.881475).  Saving model ...
Epoch: 12 cost time: 0.9495909214019775
Epoch: 12, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.537 Vali Acc: 0.904 Test Loss: 0.537 Test Acc: 0.904
Validation loss decreased (-0.881475 --> -0.903698).  Saving model ...
Epoch: 13 cost time: 0.9603054523468018
Epoch: 13, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.462 Vali Acc: 0.922 Test Loss: 0.462 Test Acc: 0.922
Validation loss decreased (-0.903698 --> -0.922218).  Saving model ...
Epoch: 14 cost time: 0.9349520206451416
Epoch: 14, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.403 Vali Acc: 0.933 Test Loss: 0.403 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933329).  Saving model ...
Epoch: 15 cost time: 0.9945082664489746
Epoch: 15, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.356 Vali Acc: 0.922 Test Loss: 0.356 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9532966613769531
Epoch: 16, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.323 Vali Acc: 0.915 Test Loss: 0.323 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9556944370269775
Epoch: 17, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.292 Vali Acc: 0.919 Test Loss: 0.292 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.894139289855957
Epoch: 18, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.266 Vali Acc: 0.926 Test Loss: 0.266 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9169600009918213
Epoch: 19, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9081709384918213
Epoch: 20, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.925879955291748
Epoch: 21, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.875354528427124
Epoch: 22, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9687848091125488
Epoch: 23, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9102895259857178
Epoch: 24, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9932851791381836
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.926 Test Loss: 0.196 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9462666511535645
Epoch: 26, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9634301662445068
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.926 Test Loss: 0.193 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9169304370880127
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.926 Test Loss: 0.191 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.919194221496582
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.926 Test Loss: 0.190 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9175419807434082
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.926 Test Loss: 0.189 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 11065350
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5981125831604004
Epoch: 1, Steps: 2 | Train Loss: 1.961 Vali Loss: 1.801 Vali Acc: 0.204 Test Loss: 1.801 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 1.0201854705810547
Epoch: 2, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.721 Vali Acc: 0.230 Test Loss: 1.721 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229612).  Saving model ...
Epoch: 3 cost time: 1.0817358493804932
Epoch: 3, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.632 Vali Acc: 0.300 Test Loss: 1.632 Test Acc: 0.300
Validation loss decreased (-0.229612 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.0986099243164062
Epoch: 4, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.504 Vali Acc: 0.467 Test Loss: 1.504 Test Acc: 0.467
Validation loss decreased (-0.299984 --> -0.466652).  Saving model ...
Epoch: 5 cost time: 1.024221658706665
Epoch: 5, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.352 Vali Acc: 0.644 Test Loss: 1.352 Test Acc: 0.644
Validation loss decreased (-0.466652 --> -0.644431).  Saving model ...
Epoch: 6 cost time: 1.0410888195037842
Epoch: 6, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.191 Vali Acc: 0.748 Test Loss: 1.191 Test Acc: 0.748
Validation loss decreased (-0.644431 --> -0.748136).  Saving model ...
Epoch: 7 cost time: 1.0824646949768066
Epoch: 7, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.032 Vali Acc: 0.841 Test Loss: 1.032 Test Acc: 0.841
Validation loss decreased (-0.748136 --> -0.840730).  Saving model ...
Epoch: 8 cost time: 1.0183446407318115
Epoch: 8, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.881 Vali Acc: 0.844 Test Loss: 0.881 Test Acc: 0.844
Validation loss decreased (-0.840730 --> -0.844436).  Saving model ...
Epoch: 9 cost time: 1.039583444595337
Epoch: 9, Steps: 2 | Train Loss: 0.735 Vali Loss: 0.745 Vali Acc: 0.878 Test Loss: 0.745 Test Acc: 0.878
Validation loss decreased (-0.844436 --> -0.877770).  Saving model ...
Epoch: 10 cost time: 1.119098424911499
Epoch: 10, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.632 Vali Acc: 0.889 Test Loss: 0.632 Test Acc: 0.889
Validation loss decreased (-0.877770 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 1.0360267162322998
Epoch: 11, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.537 Vali Acc: 0.893 Test Loss: 0.537 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 12 cost time: 1.0647809505462646
Epoch: 12, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.458 Vali Acc: 0.904 Test Loss: 0.458 Test Acc: 0.904
Validation loss decreased (-0.892587 --> -0.903699).  Saving model ...
Epoch: 13 cost time: 1.0378224849700928
Epoch: 13, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.393 Vali Acc: 0.907 Test Loss: 0.393 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 14 cost time: 0.9984304904937744
Epoch: 14, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.342 Vali Acc: 0.915 Test Loss: 0.342 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 15 cost time: 1.0992136001586914
Epoch: 15, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.304 Vali Acc: 0.915 Test Loss: 0.304 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 16 cost time: 0.9994106292724609
Epoch: 16, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.274 Vali Acc: 0.915 Test Loss: 0.274 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 17 cost time: 1.0436811447143555
Epoch: 17, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.253 Vali Acc: 0.915 Test Loss: 0.253 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 18 cost time: 1.0354938507080078
Epoch: 18, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.238 Vali Acc: 0.915 Test Loss: 0.238 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 19 cost time: 0.9863688945770264
Epoch: 19, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.228 Vali Acc: 0.915 Test Loss: 0.228 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914813).  Saving model ...
Epoch: 20 cost time: 0.9781901836395264
Epoch: 20, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.221 Vali Acc: 0.915 Test Loss: 0.221 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 21 cost time: 1.004551887512207
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.919 Test Loss: 0.216 Test Acc: 0.919
Validation loss decreased (-0.914813 --> -0.918516).  Saving model ...
Epoch: 22 cost time: 0.9952871799468994
Epoch: 22, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.9969949722290039
Epoch: 23, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 1.0057604312896729
Epoch: 24, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 1.0008876323699951
Epoch: 25, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 26 cost time: 0.9933958053588867
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 27 cost time: 1.023789644241333
Epoch: 27, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0295372009277344
Epoch: 28, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9723589420318604
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.926 Test Loss: 0.201 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 30 cost time: 1.04020094871521
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.926 Test Loss: 0.199 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 37543430
model size : 145.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.048903703689575
Epoch: 1, Steps: 2 | Train Loss: 2.051 Vali Loss: 2.011 Vali Acc: 0.030 Test Loss: 2.011 Test Acc: 0.030
Validation loss decreased (inf --> -0.029610).  Saving model ...
Epoch: 2 cost time: 0.6594018936157227
Epoch: 2, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.929 Vali Acc: 0.093 Test Loss: 1.929 Test Acc: 0.093
Validation loss decreased (-0.029610 --> -0.092573).  Saving model ...
Epoch: 3 cost time: 0.7106592655181885
Epoch: 3, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.840 Vali Acc: 0.159 Test Loss: 1.840 Test Acc: 0.159
Validation loss decreased (-0.092573 --> -0.159241).  Saving model ...
Epoch: 4 cost time: 0.6827638149261475
Epoch: 4, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.708 Vali Acc: 0.307 Test Loss: 1.708 Test Acc: 0.307
Validation loss decreased (-0.159241 --> -0.307390).  Saving model ...
Epoch: 5 cost time: 0.7195456027984619
Epoch: 5, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.547 Vali Acc: 0.474 Test Loss: 1.547 Test Acc: 0.474
Validation loss decreased (-0.307390 --> -0.474059).  Saving model ...
Epoch: 6 cost time: 0.6945805549621582
Epoch: 6, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.370 Vali Acc: 0.644 Test Loss: 1.370 Test Acc: 0.644
Validation loss decreased (-0.474059 --> -0.644431).  Saving model ...
Epoch: 7 cost time: 0.6837887763977051
Epoch: 7, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.193 Vali Acc: 0.741 Test Loss: 1.193 Test Acc: 0.741
Validation loss decreased (-0.644431 --> -0.740729).  Saving model ...
Epoch: 8 cost time: 0.6790368556976318
Epoch: 8, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.026 Vali Acc: 0.778 Test Loss: 1.026 Test Acc: 0.778
Validation loss decreased (-0.740729 --> -0.777768).  Saving model ...
Epoch: 9 cost time: 0.7403435707092285
Epoch: 9, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.876 Vali Acc: 0.833 Test Loss: 0.876 Test Acc: 0.833
Validation loss decreased (-0.777768 --> -0.833325).  Saving model ...
Epoch: 10 cost time: 0.7260901927947998
Epoch: 10, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.745 Vali Acc: 0.867 Test Loss: 0.745 Test Acc: 0.867
Validation loss decreased (-0.833325 --> -0.866659).  Saving model ...
Epoch: 11 cost time: 0.6860573291778564
Epoch: 11, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.633 Vali Acc: 0.885 Test Loss: 0.633 Test Acc: 0.885
Validation loss decreased (-0.866659 --> -0.885179).  Saving model ...
Epoch: 12 cost time: 0.6544315814971924
Epoch: 12, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.539 Vali Acc: 0.907 Test Loss: 0.539 Test Acc: 0.907
Validation loss decreased (-0.885179 --> -0.907402).  Saving model ...
Epoch: 13 cost time: 0.6613147258758545
Epoch: 13, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.464 Vali Acc: 0.922 Test Loss: 0.464 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922218).  Saving model ...
Epoch: 14 cost time: 0.7057280540466309
Epoch: 14, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.404 Vali Acc: 0.933 Test Loss: 0.404 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933329).  Saving model ...
Epoch: 15 cost time: 0.6733651161193848
Epoch: 15, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.357 Vali Acc: 0.922 Test Loss: 0.357 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6098301410675049
Epoch: 16, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.324 Vali Acc: 0.915 Test Loss: 0.324 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6732699871063232
Epoch: 17, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.293 Vali Acc: 0.919 Test Loss: 0.293 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6517670154571533
Epoch: 18, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.267 Vali Acc: 0.926 Test Loss: 0.267 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6708827018737793
Epoch: 19, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6486766338348389
Epoch: 20, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6770603656768799
Epoch: 21, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6985650062561035
Epoch: 22, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6682367324829102
Epoch: 23, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6739001274108887
Epoch: 24, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 11065350
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9461543560028076
Epoch: 1, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.846 Vali Acc: 0.152 Test Loss: 1.846 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 1.3221046924591064
Epoch: 2, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.771 Vali Acc: 0.219 Test Loss: 1.771 Test Acc: 0.219
Validation loss decreased (-0.151833 --> -0.218501).  Saving model ...
Epoch: 3 cost time: 1.2934064865112305
Epoch: 3, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.690 Vali Acc: 0.337 Test Loss: 1.690 Test Acc: 0.337
Validation loss decreased (-0.218501 --> -0.337020).  Saving model ...
Epoch: 4 cost time: 1.325463056564331
Epoch: 4, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.572 Vali Acc: 0.493 Test Loss: 1.572 Test Acc: 0.493
Validation loss decreased (-0.337020 --> -0.492577).  Saving model ...
Epoch: 5 cost time: 1.3049051761627197
Epoch: 5, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.429 Vali Acc: 0.652 Test Loss: 1.429 Test Acc: 0.652
Validation loss decreased (-0.492577 --> -0.651838).  Saving model ...
Epoch: 6 cost time: 1.310793161392212
Epoch: 6, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.274 Vali Acc: 0.767 Test Loss: 1.274 Test Acc: 0.767
Validation loss decreased (-0.651838 --> -0.766654).  Saving model ...
Epoch: 7 cost time: 1.3158729076385498
Epoch: 7, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.115 Vali Acc: 0.811 Test Loss: 1.115 Test Acc: 0.811
Validation loss decreased (-0.766654 --> -0.811100).  Saving model ...
Epoch: 8 cost time: 1.34969162940979
Epoch: 8, Steps: 2 | Train Loss: 0.897 Vali Loss: 0.962 Vali Acc: 0.859 Test Loss: 0.962 Test Acc: 0.859
Validation loss decreased (-0.811100 --> -0.859250).  Saving model ...
Epoch: 9 cost time: 1.3447999954223633
Epoch: 9, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.824 Vali Acc: 0.885 Test Loss: 0.824 Test Acc: 0.885
Validation loss decreased (-0.859250 --> -0.885177).  Saving model ...
Epoch: 10 cost time: 1.3295562267303467
Epoch: 10, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.703 Vali Acc: 0.896 Test Loss: 0.703 Test Acc: 0.896
Validation loss decreased (-0.885177 --> -0.896289).  Saving model ...
Epoch: 11 cost time: 1.3539996147155762
Epoch: 11, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.599 Vali Acc: 0.900 Test Loss: 0.599 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 1.3004519939422607
Epoch: 12, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.515 Vali Acc: 0.907 Test Loss: 0.515 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 13 cost time: 1.1854662895202637
Epoch: 13, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.445 Vali Acc: 0.926 Test Loss: 0.445 Test Acc: 0.926
Validation loss decreased (-0.907402 --> -0.925921).  Saving model ...
Epoch: 14 cost time: 1.3038337230682373
Epoch: 14, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.391 Vali Acc: 0.922 Test Loss: 0.391 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.267507791519165
Epoch: 15, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.345 Vali Acc: 0.933 Test Loss: 0.345 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933330).  Saving model ...
Epoch: 16 cost time: 1.296701192855835
Epoch: 16, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.308 Vali Acc: 0.933 Test Loss: 0.308 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 17 cost time: 1.237473487854004
Epoch: 17, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2635455131530762
Epoch: 18, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 19 cost time: 1.3094708919525146
Epoch: 19, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 1.288487195968628
Epoch: 20, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 1.2369203567504883
Epoch: 21, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 1.2948670387268066
Epoch: 22, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 1.2854979038238525
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 1.3879568576812744
Epoch: 24, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 1.3247442245483398
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 1.3076975345611572
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 1.3378543853759766
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 1.3275151252746582
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 1.3406968116760254
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 1.3811838626861572
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 18798598
model size : 74.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3759424686431885
Epoch: 1, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.855 Vali Acc: 0.104 Test Loss: 1.855 Test Acc: 0.104
Validation loss decreased (inf --> -0.103685).  Saving model ...
Epoch: 2 cost time: 0.7933719158172607
Epoch: 2, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.776 Vali Acc: 0.167 Test Loss: 1.776 Test Acc: 0.167
Validation loss decreased (-0.103685 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.7858483791351318
Epoch: 3, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.691 Vali Acc: 0.274 Test Loss: 1.691 Test Acc: 0.274
Validation loss decreased (-0.166649 --> -0.274057).  Saving model ...
Epoch: 4 cost time: 0.7625594139099121
Epoch: 4, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.572 Vali Acc: 0.481 Test Loss: 1.572 Test Acc: 0.481
Validation loss decreased (-0.274057 --> -0.481466).  Saving model ...
Epoch: 5 cost time: 0.7777736186981201
Epoch: 5, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.428 Vali Acc: 0.678 Test Loss: 1.428 Test Acc: 0.678
Validation loss decreased (-0.481466 --> -0.677763).  Saving model ...
Epoch: 6 cost time: 0.776742696762085
Epoch: 6, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.272 Vali Acc: 0.778 Test Loss: 1.272 Test Acc: 0.778
Validation loss decreased (-0.677763 --> -0.777765).  Saving model ...
Epoch: 7 cost time: 0.8650569915771484
Epoch: 7, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.116 Vali Acc: 0.852 Test Loss: 1.116 Test Acc: 0.852
Validation loss decreased (-0.777765 --> -0.851841).  Saving model ...
Epoch: 8 cost time: 0.7698562145233154
Epoch: 8, Steps: 2 | Train Loss: 0.948 Vali Loss: 0.968 Vali Acc: 0.867 Test Loss: 0.968 Test Acc: 0.867
Validation loss decreased (-0.851841 --> -0.866657).  Saving model ...
Epoch: 9 cost time: 0.8190085887908936
Epoch: 9, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.834 Vali Acc: 0.900 Test Loss: 0.834 Test Acc: 0.900
Validation loss decreased (-0.866657 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.8182923793792725
Epoch: 10, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.715 Vali Acc: 0.911 Test Loss: 0.715 Test Acc: 0.911
Validation loss decreased (-0.899992 --> -0.911104).  Saving model ...
Epoch: 11 cost time: 0.8155782222747803
Epoch: 11, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.616 Vali Acc: 0.915 Test Loss: 0.616 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914809).  Saving model ...
Epoch: 12 cost time: 0.792090892791748
Epoch: 12, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.530 Vali Acc: 0.915 Test Loss: 0.530 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 13 cost time: 0.806368350982666
Epoch: 13, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.459 Vali Acc: 0.922 Test Loss: 0.459 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 14 cost time: 0.7554473876953125
Epoch: 14, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.400 Vali Acc: 0.926 Test Loss: 0.400 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 15 cost time: 0.7606072425842285
Epoch: 15, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.352 Vali Acc: 0.933 Test Loss: 0.352 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 16 cost time: 0.800546407699585
Epoch: 16, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.314 Vali Acc: 0.933 Test Loss: 0.314 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 17 cost time: 0.8141462802886963
Epoch: 17, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 18 cost time: 0.8040075302124023
Epoch: 18, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.7947177886962891
Epoch: 19, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 20 cost time: 0.7764232158660889
Epoch: 20, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8094644546508789
Epoch: 21, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.757824182510376
Epoch: 22, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8044536113739014
Epoch: 23, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.787933349609375
Epoch: 24, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.7321867942810059
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7579264640808105
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 0.7630975246429443
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 0.8040783405303955
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.7950706481933594
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.786855936050415
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 5559302
model size : 23.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.550130844116211
Epoch: 1, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.846 Vali Acc: 0.152 Test Loss: 1.846 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 0.9074137210845947
Epoch: 2, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.771 Vali Acc: 0.219 Test Loss: 1.771 Test Acc: 0.219
Validation loss decreased (-0.151833 --> -0.218501).  Saving model ...
Epoch: 3 cost time: 0.9858055114746094
Epoch: 3, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.690 Vali Acc: 0.337 Test Loss: 1.690 Test Acc: 0.337
Validation loss decreased (-0.218501 --> -0.337020).  Saving model ...
Epoch: 4 cost time: 0.9587571620941162
Epoch: 4, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.572 Vali Acc: 0.493 Test Loss: 1.572 Test Acc: 0.493
Validation loss decreased (-0.337020 --> -0.492577).  Saving model ...
Epoch: 5 cost time: 1.0299911499023438
Epoch: 5, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.429 Vali Acc: 0.652 Test Loss: 1.429 Test Acc: 0.652
Validation loss decreased (-0.492577 --> -0.651838).  Saving model ...
Epoch: 6 cost time: 1.020308017730713
Epoch: 6, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.274 Vali Acc: 0.767 Test Loss: 1.274 Test Acc: 0.767
Validation loss decreased (-0.651838 --> -0.766654).  Saving model ...
Epoch: 7 cost time: 0.992476224899292
Epoch: 7, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.115 Vali Acc: 0.811 Test Loss: 1.115 Test Acc: 0.811
Validation loss decreased (-0.766654 --> -0.811100).  Saving model ...
Epoch: 8 cost time: 1.010890007019043
Epoch: 8, Steps: 2 | Train Loss: 0.897 Vali Loss: 0.962 Vali Acc: 0.859 Test Loss: 0.962 Test Acc: 0.859
Validation loss decreased (-0.811100 --> -0.859250).  Saving model ...
Epoch: 9 cost time: 0.99546217918396
Epoch: 9, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.824 Vali Acc: 0.885 Test Loss: 0.824 Test Acc: 0.885
Validation loss decreased (-0.859250 --> -0.885177).  Saving model ...
Epoch: 10 cost time: 1.0062472820281982
Epoch: 10, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.703 Vali Acc: 0.896 Test Loss: 0.703 Test Acc: 0.896
Validation loss decreased (-0.885177 --> -0.896289).  Saving model ...
Epoch: 11 cost time: 1.0495600700378418
Epoch: 11, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.599 Vali Acc: 0.900 Test Loss: 0.599 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 1.0345635414123535
Epoch: 12, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.515 Vali Acc: 0.907 Test Loss: 0.515 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 13 cost time: 1.0294263362884521
Epoch: 13, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.445 Vali Acc: 0.926 Test Loss: 0.445 Test Acc: 0.926
Validation loss decreased (-0.907402 --> -0.925921).  Saving model ...
Epoch: 14 cost time: 1.099489450454712
Epoch: 14, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.391 Vali Acc: 0.922 Test Loss: 0.391 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1488757133483887
Epoch: 15, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.345 Vali Acc: 0.933 Test Loss: 0.345 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933330).  Saving model ...
Epoch: 16 cost time: 1.0659520626068115
Epoch: 16, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.308 Vali Acc: 0.933 Test Loss: 0.308 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 17 cost time: 0.996138334274292
Epoch: 17, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.152003526687622
Epoch: 18, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 19 cost time: 1.0382435321807861
Epoch: 19, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 1.04876708984375
Epoch: 20, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 1.0008985996246338
Epoch: 21, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 1.0657341480255127
Epoch: 22, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 1.0081870555877686
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 1.0852389335632324
Epoch: 24, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 1.0528788566589355
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 1.0535650253295898
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 1.0389337539672852
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 1.0025098323822021
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 1.028287649154663
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 1.0478224754333496
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 18798598
model size : 74.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1230602264404297
Epoch: 1, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.855 Vali Acc: 0.104 Test Loss: 1.855 Test Acc: 0.104
Validation loss decreased (inf --> -0.103685).  Saving model ...
Epoch: 2 cost time: 0.6923344135284424
Epoch: 2, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.776 Vali Acc: 0.167 Test Loss: 1.776 Test Acc: 0.167
Validation loss decreased (-0.103685 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.7048184871673584
Epoch: 3, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.691 Vali Acc: 0.274 Test Loss: 1.691 Test Acc: 0.274
Validation loss decreased (-0.166649 --> -0.274057).  Saving model ...
Epoch: 4 cost time: 0.6882526874542236
Epoch: 4, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.572 Vali Acc: 0.481 Test Loss: 1.572 Test Acc: 0.481
Validation loss decreased (-0.274057 --> -0.481466).  Saving model ...
Epoch: 5 cost time: 0.7039332389831543
Epoch: 5, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.428 Vali Acc: 0.678 Test Loss: 1.428 Test Acc: 0.678
Validation loss decreased (-0.481466 --> -0.677763).  Saving model ...
Epoch: 6 cost time: 0.7136461734771729
Epoch: 6, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.272 Vali Acc: 0.778 Test Loss: 1.272 Test Acc: 0.778
Validation loss decreased (-0.677763 --> -0.777765).  Saving model ...
Epoch: 7 cost time: 0.6798782348632812
Epoch: 7, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.116 Vali Acc: 0.852 Test Loss: 1.116 Test Acc: 0.852
Validation loss decreased (-0.777765 --> -0.851841).  Saving model ...
Epoch: 8 cost time: 0.7407538890838623
Epoch: 8, Steps: 2 | Train Loss: 0.948 Vali Loss: 0.968 Vali Acc: 0.867 Test Loss: 0.968 Test Acc: 0.867
Validation loss decreased (-0.851841 --> -0.866657).  Saving model ...
Epoch: 9 cost time: 0.6917672157287598
Epoch: 9, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.834 Vali Acc: 0.900 Test Loss: 0.834 Test Acc: 0.900
Validation loss decreased (-0.866657 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.6924715042114258
Epoch: 10, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.715 Vali Acc: 0.911 Test Loss: 0.715 Test Acc: 0.911
Validation loss decreased (-0.899992 --> -0.911104).  Saving model ...
Epoch: 11 cost time: 0.7289531230926514
Epoch: 11, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.616 Vali Acc: 0.915 Test Loss: 0.616 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914809).  Saving model ...
Epoch: 12 cost time: 0.7087917327880859
Epoch: 12, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.530 Vali Acc: 0.915 Test Loss: 0.530 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 13 cost time: 0.7696728706359863
Epoch: 13, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.459 Vali Acc: 0.922 Test Loss: 0.459 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 14 cost time: 0.6845219135284424
Epoch: 14, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.400 Vali Acc: 0.926 Test Loss: 0.400 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 15 cost time: 0.7121710777282715
Epoch: 15, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.352 Vali Acc: 0.933 Test Loss: 0.352 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 16 cost time: 0.777667760848999
Epoch: 16, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.314 Vali Acc: 0.933 Test Loss: 0.314 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 17 cost time: 0.7078773975372314
Epoch: 17, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 18 cost time: 0.7327663898468018
Epoch: 18, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.7041244506835938
Epoch: 19, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 20 cost time: 0.6804616451263428
Epoch: 20, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6971437931060791
Epoch: 21, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7099061012268066
Epoch: 22, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.701885461807251
Epoch: 23, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7411489486694336
Epoch: 24, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.7253463268280029
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7163619995117188
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 0.7093102931976318
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 0.7956368923187256
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.6795458793640137
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.6954803466796875
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 5559302
model size : 23.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2360262870788574
Epoch: 1, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.845 Vali Acc: 0.152 Test Loss: 1.845 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 0.6974461078643799
Epoch: 2, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.771 Vali Acc: 0.219 Test Loss: 1.771 Test Acc: 0.219
Validation loss decreased (-0.151833 --> -0.218501).  Saving model ...
Epoch: 3 cost time: 0.6935582160949707
Epoch: 3, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.690 Vali Acc: 0.337 Test Loss: 1.690 Test Acc: 0.337
Validation loss decreased (-0.218501 --> -0.337020).  Saving model ...
Epoch: 4 cost time: 0.7147560119628906
Epoch: 4, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.573 Vali Acc: 0.493 Test Loss: 1.573 Test Acc: 0.493
Validation loss decreased (-0.337020 --> -0.492577).  Saving model ...
Epoch: 5 cost time: 0.7447507381439209
Epoch: 5, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.430 Vali Acc: 0.652 Test Loss: 1.430 Test Acc: 0.652
Validation loss decreased (-0.492577 --> -0.651838).  Saving model ...
Epoch: 6 cost time: 0.7218074798583984
Epoch: 6, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.276 Vali Acc: 0.770 Test Loss: 1.276 Test Acc: 0.770
Validation loss decreased (-0.651838 --> -0.770358).  Saving model ...
Epoch: 7 cost time: 0.7426769733428955
Epoch: 7, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.119 Vali Acc: 0.811 Test Loss: 1.119 Test Acc: 0.811
Validation loss decreased (-0.770358 --> -0.811100).  Saving model ...
Epoch: 8 cost time: 0.7719757556915283
Epoch: 8, Steps: 2 | Train Loss: 0.913 Vali Loss: 0.966 Vali Acc: 0.856 Test Loss: 0.966 Test Acc: 0.856
Validation loss decreased (-0.811100 --> -0.855546).  Saving model ...
Epoch: 9 cost time: 0.7562801837921143
Epoch: 9, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.827 Vali Acc: 0.881 Test Loss: 0.827 Test Acc: 0.881
Validation loss decreased (-0.855546 --> -0.881473).  Saving model ...
Epoch: 10 cost time: 0.7100536823272705
Epoch: 10, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.706 Vali Acc: 0.893 Test Loss: 0.706 Test Acc: 0.893
Validation loss decreased (-0.881473 --> -0.892586).  Saving model ...
Epoch: 11 cost time: 0.7823364734649658
Epoch: 11, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.602 Vali Acc: 0.900 Test Loss: 0.602 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.7854387760162354
Epoch: 12, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.517 Vali Acc: 0.907 Test Loss: 0.517 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 13 cost time: 0.8625400066375732
Epoch: 13, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.447 Vali Acc: 0.922 Test Loss: 0.447 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922218).  Saving model ...
Epoch: 14 cost time: 0.853585958480835
Epoch: 14, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.393 Vali Acc: 0.926 Test Loss: 0.393 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 15 cost time: 0.8423688411712646
Epoch: 15, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.346 Vali Acc: 0.937 Test Loss: 0.346 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937034).  Saving model ...
Epoch: 16 cost time: 0.8852579593658447
Epoch: 16, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.308 Vali Acc: 0.937 Test Loss: 0.308 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 17 cost time: 0.8210175037384033
Epoch: 17, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.280 Vali Acc: 0.933 Test Loss: 0.280 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8077194690704346
Epoch: 18, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 19 cost time: 0.8056626319885254
Epoch: 19, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.818026065826416
Epoch: 20, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.8189420700073242
Epoch: 21, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.8270080089569092
Epoch: 22, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.8058037757873535
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.8791124820709229
Epoch: 24, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 0.8508415222167969
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 0.8372893333435059
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.8564553260803223
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.8464217185974121
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.8452785015106201
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.8806846141815186
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 18798598
model size : 74.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2194013595581055
Epoch: 1, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.856 Vali Acc: 0.104 Test Loss: 1.856 Test Acc: 0.104
Validation loss decreased (inf --> -0.103685).  Saving model ...
Epoch: 2 cost time: 0.6602425575256348
Epoch: 2, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.777 Vali Acc: 0.167 Test Loss: 1.777 Test Acc: 0.167
Validation loss decreased (-0.103685 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.6463627815246582
Epoch: 3, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.693 Vali Acc: 0.274 Test Loss: 1.693 Test Acc: 0.274
Validation loss decreased (-0.166649 --> -0.274057).  Saving model ...
Epoch: 4 cost time: 0.6659591197967529
Epoch: 4, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.574 Vali Acc: 0.481 Test Loss: 1.574 Test Acc: 0.481
Validation loss decreased (-0.274057 --> -0.481466).  Saving model ...
Epoch: 5 cost time: 0.6407947540283203
Epoch: 5, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.431 Vali Acc: 0.678 Test Loss: 1.431 Test Acc: 0.678
Validation loss decreased (-0.481466 --> -0.677763).  Saving model ...
Epoch: 6 cost time: 0.6334648132324219
Epoch: 6, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.276 Vali Acc: 0.770 Test Loss: 1.276 Test Acc: 0.770
Validation loss decreased (-0.677763 --> -0.770358).  Saving model ...
Epoch: 7 cost time: 0.6652343273162842
Epoch: 7, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.121 Vali Acc: 0.852 Test Loss: 1.121 Test Acc: 0.852
Validation loss decreased (-0.770358 --> -0.851841).  Saving model ...
Epoch: 8 cost time: 0.6128149032592773
Epoch: 8, Steps: 2 | Train Loss: 0.961 Vali Loss: 0.973 Vali Acc: 0.867 Test Loss: 0.973 Test Acc: 0.867
Validation loss decreased (-0.851841 --> -0.866657).  Saving model ...
Epoch: 9 cost time: 0.5728554725646973
Epoch: 9, Steps: 2 | Train Loss: 0.808 Vali Loss: 0.840 Vali Acc: 0.900 Test Loss: 0.840 Test Acc: 0.900
Validation loss decreased (-0.866657 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.6147608757019043
Epoch: 10, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.720 Vali Acc: 0.911 Test Loss: 0.720 Test Acc: 0.911
Validation loss decreased (-0.899992 --> -0.911104).  Saving model ...
Epoch: 11 cost time: 0.6116046905517578
Epoch: 11, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.620 Vali Acc: 0.915 Test Loss: 0.620 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914809).  Saving model ...
Epoch: 12 cost time: 0.6045980453491211
Epoch: 12, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.534 Vali Acc: 0.911 Test Loss: 0.534 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5543928146362305
Epoch: 13, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.462 Vali Acc: 0.919 Test Loss: 0.462 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918514).  Saving model ...
Epoch: 14 cost time: 0.5489435195922852
Epoch: 14, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.403 Vali Acc: 0.919 Test Loss: 0.403 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 15 cost time: 0.5620007514953613
Epoch: 15, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.354 Vali Acc: 0.930 Test Loss: 0.354 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929626).  Saving model ...
Epoch: 16 cost time: 0.6013262271881104
Epoch: 16, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.316 Vali Acc: 0.930 Test Loss: 0.316 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 17 cost time: 0.5855796337127686
Epoch: 17, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.286 Vali Acc: 0.930 Test Loss: 0.286 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 18 cost time: 0.615015983581543
Epoch: 18, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.6005327701568604
Epoch: 19, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.6310310363769531
Epoch: 20, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5797693729400635
Epoch: 21, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5669474601745605
Epoch: 22, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5993285179138184
Epoch: 23, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5535378456115723
Epoch: 24, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5949082374572754
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 0.6022489070892334
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.6051692962646484
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.5971601009368896
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 0.6147358417510986
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 0.6049268245697021
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 5559302
model size : 23.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.4058401584625244
Epoch: 1, Steps: 2 | Train Loss: 1.977 Vali Loss: 1.844 Vali Acc: 0.115 Test Loss: 1.844 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 1.3899998664855957
Epoch: 2, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.792 Vali Acc: 0.148 Test Loss: 1.792 Test Acc: 0.148
Validation loss decreased (-0.114796 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 1.4208989143371582
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.738 Vali Acc: 0.204 Test Loss: 1.738 Test Acc: 0.204
Validation loss decreased (-0.148130 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 1.2986516952514648
Epoch: 4, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.667 Vali Acc: 0.296 Test Loss: 1.667 Test Acc: 0.296
Validation loss decreased (-0.203686 --> -0.296280).  Saving model ...
Epoch: 5 cost time: 1.263446569442749
Epoch: 5, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.577 Vali Acc: 0.374 Test Loss: 1.577 Test Acc: 0.374
Validation loss decreased (-0.296280 --> -0.374058).  Saving model ...
Epoch: 6 cost time: 1.4146671295166016
Epoch: 6, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.477 Vali Acc: 0.515 Test Loss: 1.477 Test Acc: 0.515
Validation loss decreased (-0.374058 --> -0.514800).  Saving model ...
Epoch: 7 cost time: 1.0904054641723633
Epoch: 7, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.368 Vali Acc: 0.619 Test Loss: 1.368 Test Acc: 0.619
Validation loss decreased (-0.514800 --> -0.618505).  Saving model ...
Epoch: 8 cost time: 1.4169425964355469
Epoch: 8, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.256 Vali Acc: 0.685 Test Loss: 1.256 Test Acc: 0.685
Validation loss decreased (-0.618505 --> -0.685173).  Saving model ...
Epoch: 9 cost time: 1.3236021995544434
Epoch: 9, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.143 Vali Acc: 0.763 Test Loss: 1.143 Test Acc: 0.763
Validation loss decreased (-0.685173 --> -0.762952).  Saving model ...
Epoch: 10 cost time: 1.3090412616729736
Epoch: 10, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.034 Vali Acc: 0.826 Test Loss: 1.034 Test Acc: 0.826
Validation loss decreased (-0.762952 --> -0.825916).  Saving model ...
Epoch: 11 cost time: 1.3884613513946533
Epoch: 11, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.929 Vali Acc: 0.837 Test Loss: 0.929 Test Acc: 0.837
Validation loss decreased (-0.825916 --> -0.837028).  Saving model ...
Epoch: 12 cost time: 1.3793904781341553
Epoch: 12, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.830 Vali Acc: 0.863 Test Loss: 0.830 Test Acc: 0.863
Validation loss decreased (-0.837028 --> -0.862955).  Saving model ...
Epoch: 13 cost time: 1.4247362613677979
Epoch: 13, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.740 Vali Acc: 0.885 Test Loss: 0.740 Test Acc: 0.885
Validation loss decreased (-0.862955 --> -0.885178).  Saving model ...
Epoch: 14 cost time: 1.3742685317993164
Epoch: 14, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.658 Vali Acc: 0.896 Test Loss: 0.658 Test Acc: 0.896
Validation loss decreased (-0.885178 --> -0.896290).  Saving model ...
Epoch: 15 cost time: 1.3735084533691406
Epoch: 15, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.587 Vali Acc: 0.893 Test Loss: 0.587 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3659753799438477
Epoch: 16, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.526 Vali Acc: 0.896 Test Loss: 0.526 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896291).  Saving model ...
Epoch: 17 cost time: 1.364560604095459
Epoch: 17, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.469 Vali Acc: 0.904 Test Loss: 0.469 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 18 cost time: 1.4091062545776367
Epoch: 18, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.420 Vali Acc: 0.915 Test Loss: 0.420 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914811).  Saving model ...
Epoch: 19 cost time: 1.4068243503570557
Epoch: 19, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.376 Vali Acc: 0.930 Test Loss: 0.376 Test Acc: 0.930
Validation loss decreased (-0.914811 --> -0.929626).  Saving model ...
Epoch: 20 cost time: 1.3863258361816406
Epoch: 20, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.340 Vali Acc: 0.930 Test Loss: 0.340 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 21 cost time: 1.3830077648162842
Epoch: 21, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.311 Vali Acc: 0.937 Test Loss: 0.311 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 22 cost time: 1.3982570171356201
Epoch: 22, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 23 cost time: 1.3774123191833496
Epoch: 23, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 24 cost time: 1.3792059421539307
Epoch: 24, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 25 cost time: 1.4009616374969482
Epoch: 25, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3764145374298096
Epoch: 26, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3769867420196533
Epoch: 27, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3919689655303955
Epoch: 28, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4168212413787842
Epoch: 29, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.414862871170044
Epoch: 30, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 18773254
model size : 72.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3864078521728516
Epoch: 1, Steps: 2 | Train Loss: 1.913 Vali Loss: 1.809 Vali Acc: 0.211 Test Loss: 1.809 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.7995123863220215
Epoch: 2, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.758 Vali Acc: 0.285 Test Loss: 1.758 Test Acc: 0.285
Validation loss decreased (-0.211093 --> -0.285168).  Saving model ...
Epoch: 3 cost time: 0.8444390296936035
Epoch: 3, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.707 Vali Acc: 0.330 Test Loss: 1.707 Test Acc: 0.330
Validation loss decreased (-0.285168 --> -0.329613).  Saving model ...
Epoch: 4 cost time: 0.8624780178070068
Epoch: 4, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.639 Vali Acc: 0.415 Test Loss: 1.639 Test Acc: 0.415
Validation loss decreased (-0.329613 --> -0.414798).  Saving model ...
Epoch: 5 cost time: 0.9315176010131836
Epoch: 5, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.553 Vali Acc: 0.452 Test Loss: 1.553 Test Acc: 0.452
Validation loss decreased (-0.414798 --> -0.451836).  Saving model ...
Epoch: 6 cost time: 0.857142448425293
Epoch: 6, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.455 Vali Acc: 0.504 Test Loss: 1.455 Test Acc: 0.504
Validation loss decreased (-0.451836 --> -0.503689).  Saving model ...
Epoch: 7 cost time: 0.8373773097991943
Epoch: 7, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.351 Vali Acc: 0.578 Test Loss: 1.351 Test Acc: 0.578
Validation loss decreased (-0.503689 --> -0.577764).  Saving model ...
Epoch: 8 cost time: 0.8627073764801025
Epoch: 8, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.244 Vali Acc: 0.656 Test Loss: 1.244 Test Acc: 0.656
Validation loss decreased (-0.577764 --> -0.655543).  Saving model ...
Epoch: 9 cost time: 0.8631041049957275
Epoch: 9, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.137 Vali Acc: 0.704 Test Loss: 1.137 Test Acc: 0.704
Validation loss decreased (-0.655543 --> -0.703692).  Saving model ...
Epoch: 10 cost time: 0.8444206714630127
Epoch: 10, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.032 Vali Acc: 0.781 Test Loss: 1.032 Test Acc: 0.781
Validation loss decreased (-0.703692 --> -0.781471).  Saving model ...
Epoch: 11 cost time: 0.9020552635192871
Epoch: 11, Steps: 2 | Train Loss: 0.858 Vali Loss: 0.933 Vali Acc: 0.826 Test Loss: 0.933 Test Acc: 0.826
Validation loss decreased (-0.781471 --> -0.825917).  Saving model ...
Epoch: 12 cost time: 0.8846559524536133
Epoch: 12, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.841 Vali Acc: 0.863 Test Loss: 0.841 Test Acc: 0.863
Validation loss decreased (-0.825917 --> -0.862955).  Saving model ...
Epoch: 13 cost time: 0.8907926082611084
Epoch: 13, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.756 Vali Acc: 0.878 Test Loss: 0.756 Test Acc: 0.878
Validation loss decreased (-0.862955 --> -0.877770).  Saving model ...
Epoch: 14 cost time: 0.8061203956604004
Epoch: 14, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.681 Vali Acc: 0.893 Test Loss: 0.681 Test Acc: 0.893
Validation loss decreased (-0.877770 --> -0.892586).  Saving model ...
Epoch: 15 cost time: 0.8106889724731445
Epoch: 15, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.612 Vali Acc: 0.893 Test Loss: 0.612 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 16 cost time: 0.8460416793823242
Epoch: 16, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.550 Vali Acc: 0.907 Test Loss: 0.550 Test Acc: 0.907
Validation loss decreased (-0.892586 --> -0.907402).  Saving model ...
Epoch: 17 cost time: 0.8792407512664795
Epoch: 17, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.498 Vali Acc: 0.911 Test Loss: 0.498 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 18 cost time: 0.8370978832244873
Epoch: 18, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.453 Vali Acc: 0.911 Test Loss: 0.453 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 19 cost time: 0.8670892715454102
Epoch: 19, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.414 Vali Acc: 0.915 Test Loss: 0.414 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 20 cost time: 0.8054585456848145
Epoch: 20, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.381 Vali Acc: 0.919 Test Loss: 0.381 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 21 cost time: 0.8228373527526855
Epoch: 21, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.353 Vali Acc: 0.926 Test Loss: 0.353 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925922).  Saving model ...
Epoch: 22 cost time: 0.8530476093292236
Epoch: 22, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8241124153137207
Epoch: 23, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.308 Vali Acc: 0.926 Test Loss: 0.308 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 24 cost time: 0.8213508129119873
Epoch: 24, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.290 Vali Acc: 0.926 Test Loss: 0.290 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 25 cost time: 0.873063325881958
Epoch: 25, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.806877851486206
Epoch: 26, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8221445083618164
Epoch: 27, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.256 Vali Acc: 0.926 Test Loss: 0.256 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 28 cost time: 0.8459546566009521
Epoch: 28, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 29 cost time: 0.9137942790985107
Epoch: 29, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 30 cost time: 0.920208215713501
Epoch: 30, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 5533702
model size : 22.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.851278066635132
Epoch: 1, Steps: 2 | Train Loss: 1.977 Vali Loss: 1.844 Vali Acc: 0.115 Test Loss: 1.844 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 1.094473123550415
Epoch: 2, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.792 Vali Acc: 0.148 Test Loss: 1.792 Test Acc: 0.148
Validation loss decreased (-0.114796 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 1.1353139877319336
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.738 Vali Acc: 0.204 Test Loss: 1.738 Test Acc: 0.204
Validation loss decreased (-0.148130 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 1.1525208950042725
Epoch: 4, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.667 Vali Acc: 0.296 Test Loss: 1.667 Test Acc: 0.296
Validation loss decreased (-0.203686 --> -0.296280).  Saving model ...
Epoch: 5 cost time: 1.102884292602539
Epoch: 5, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.577 Vali Acc: 0.374 Test Loss: 1.577 Test Acc: 0.374
Validation loss decreased (-0.296280 --> -0.374058).  Saving model ...
Epoch: 6 cost time: 1.1763784885406494
Epoch: 6, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.477 Vali Acc: 0.515 Test Loss: 1.477 Test Acc: 0.515
Validation loss decreased (-0.374058 --> -0.514800).  Saving model ...
Epoch: 7 cost time: 1.138672113418579
Epoch: 7, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.368 Vali Acc: 0.619 Test Loss: 1.368 Test Acc: 0.619
Validation loss decreased (-0.514800 --> -0.618505).  Saving model ...
Epoch: 8 cost time: 1.1247570514678955
Epoch: 8, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.256 Vali Acc: 0.685 Test Loss: 1.256 Test Acc: 0.685
Validation loss decreased (-0.618505 --> -0.685173).  Saving model ...
Epoch: 9 cost time: 1.1424391269683838
Epoch: 9, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.143 Vali Acc: 0.763 Test Loss: 1.143 Test Acc: 0.763
Validation loss decreased (-0.685173 --> -0.762952).  Saving model ...
Epoch: 10 cost time: 1.1287574768066406
Epoch: 10, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.034 Vali Acc: 0.826 Test Loss: 1.034 Test Acc: 0.826
Validation loss decreased (-0.762952 --> -0.825916).  Saving model ...
Epoch: 11 cost time: 1.1181819438934326
Epoch: 11, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.929 Vali Acc: 0.837 Test Loss: 0.929 Test Acc: 0.837
Validation loss decreased (-0.825916 --> -0.837028).  Saving model ...
Epoch: 12 cost time: 1.1360499858856201
Epoch: 12, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.830 Vali Acc: 0.863 Test Loss: 0.830 Test Acc: 0.863
Validation loss decreased (-0.837028 --> -0.862955).  Saving model ...
Epoch: 13 cost time: 1.1544866561889648
Epoch: 13, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.740 Vali Acc: 0.885 Test Loss: 0.740 Test Acc: 0.885
Validation loss decreased (-0.862955 --> -0.885178).  Saving model ...
Epoch: 14 cost time: 1.1465177536010742
Epoch: 14, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.658 Vali Acc: 0.896 Test Loss: 0.658 Test Acc: 0.896
Validation loss decreased (-0.885178 --> -0.896290).  Saving model ...
Epoch: 15 cost time: 1.1636607646942139
Epoch: 15, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.587 Vali Acc: 0.893 Test Loss: 0.587 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1249377727508545
Epoch: 16, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.526 Vali Acc: 0.896 Test Loss: 0.526 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896291).  Saving model ...
Epoch: 17 cost time: 1.1101694107055664
Epoch: 17, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.469 Vali Acc: 0.904 Test Loss: 0.469 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 18 cost time: 1.120396614074707
Epoch: 18, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.420 Vali Acc: 0.915 Test Loss: 0.420 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914811).  Saving model ...
Epoch: 19 cost time: 1.0326898097991943
Epoch: 19, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.376 Vali Acc: 0.930 Test Loss: 0.376 Test Acc: 0.930
Validation loss decreased (-0.914811 --> -0.929626).  Saving model ...
Epoch: 20 cost time: 1.136840581893921
Epoch: 20, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.340 Vali Acc: 0.930 Test Loss: 0.340 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 21 cost time: 1.1454484462738037
Epoch: 21, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.311 Vali Acc: 0.937 Test Loss: 0.311 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 22 cost time: 1.1512482166290283
Epoch: 22, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 23 cost time: 1.165820837020874
Epoch: 23, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 24 cost time: 1.2219934463500977
Epoch: 24, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 25 cost time: 1.1603960990905762
Epoch: 25, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0940637588500977
Epoch: 26, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1154601573944092
Epoch: 27, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.10225510597229
Epoch: 28, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1203572750091553
Epoch: 29, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0884718894958496
Epoch: 30, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 18773254
model size : 72.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3152809143066406
Epoch: 1, Steps: 2 | Train Loss: 1.913 Vali Loss: 1.809 Vali Acc: 0.211 Test Loss: 1.809 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.7021651268005371
Epoch: 2, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.758 Vali Acc: 0.285 Test Loss: 1.758 Test Acc: 0.285
Validation loss decreased (-0.211093 --> -0.285168).  Saving model ...
Epoch: 3 cost time: 0.7563092708587646
Epoch: 3, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.707 Vali Acc: 0.330 Test Loss: 1.707 Test Acc: 0.330
Validation loss decreased (-0.285168 --> -0.329613).  Saving model ...
Epoch: 4 cost time: 0.6916162967681885
Epoch: 4, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.639 Vali Acc: 0.415 Test Loss: 1.639 Test Acc: 0.415
Validation loss decreased (-0.329613 --> -0.414798).  Saving model ...
Epoch: 5 cost time: 0.6953721046447754
Epoch: 5, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.553 Vali Acc: 0.452 Test Loss: 1.553 Test Acc: 0.452
Validation loss decreased (-0.414798 --> -0.451836).  Saving model ...
Epoch: 6 cost time: 0.6865241527557373
Epoch: 6, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.455 Vali Acc: 0.504 Test Loss: 1.455 Test Acc: 0.504
Validation loss decreased (-0.451836 --> -0.503689).  Saving model ...
Epoch: 7 cost time: 0.6857562065124512
Epoch: 7, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.351 Vali Acc: 0.578 Test Loss: 1.351 Test Acc: 0.578
Validation loss decreased (-0.503689 --> -0.577764).  Saving model ...
Epoch: 8 cost time: 0.6705217361450195
Epoch: 8, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.244 Vali Acc: 0.656 Test Loss: 1.244 Test Acc: 0.656
Validation loss decreased (-0.577764 --> -0.655543).  Saving model ...
Epoch: 9 cost time: 0.8077089786529541
Epoch: 9, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.137 Vali Acc: 0.704 Test Loss: 1.137 Test Acc: 0.704
Validation loss decreased (-0.655543 --> -0.703692).  Saving model ...
Epoch: 10 cost time: 0.5915987491607666
Epoch: 10, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.032 Vali Acc: 0.781 Test Loss: 1.032 Test Acc: 0.781
Validation loss decreased (-0.703692 --> -0.781471).  Saving model ...
Epoch: 11 cost time: 0.6962637901306152
Epoch: 11, Steps: 2 | Train Loss: 0.858 Vali Loss: 0.933 Vali Acc: 0.826 Test Loss: 0.933 Test Acc: 0.826
Validation loss decreased (-0.781471 --> -0.825917).  Saving model ...
Epoch: 12 cost time: 0.704174280166626
Epoch: 12, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.841 Vali Acc: 0.863 Test Loss: 0.841 Test Acc: 0.863
Validation loss decreased (-0.825917 --> -0.862955).  Saving model ...
Epoch: 13 cost time: 0.7380588054656982
Epoch: 13, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.756 Vali Acc: 0.878 Test Loss: 0.756 Test Acc: 0.878
Validation loss decreased (-0.862955 --> -0.877770).  Saving model ...
Epoch: 14 cost time: 0.7055561542510986
Epoch: 14, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.681 Vali Acc: 0.893 Test Loss: 0.681 Test Acc: 0.893
Validation loss decreased (-0.877770 --> -0.892586).  Saving model ...
Epoch: 15 cost time: 0.7358508110046387
Epoch: 15, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.612 Vali Acc: 0.893 Test Loss: 0.612 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 16 cost time: 0.7050034999847412
Epoch: 16, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.550 Vali Acc: 0.907 Test Loss: 0.550 Test Acc: 0.907
Validation loss decreased (-0.892586 --> -0.907402).  Saving model ...
Epoch: 17 cost time: 0.6987268924713135
Epoch: 17, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.498 Vali Acc: 0.911 Test Loss: 0.498 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 18 cost time: 0.7370920181274414
Epoch: 18, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.453 Vali Acc: 0.911 Test Loss: 0.453 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 19 cost time: 0.7241387367248535
Epoch: 19, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.414 Vali Acc: 0.915 Test Loss: 0.414 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 20 cost time: 0.7283036708831787
Epoch: 20, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.381 Vali Acc: 0.919 Test Loss: 0.381 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 21 cost time: 0.7044329643249512
Epoch: 21, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.353 Vali Acc: 0.926 Test Loss: 0.353 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925922).  Saving model ...
Epoch: 22 cost time: 0.7382400035858154
Epoch: 22, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7219028472900391
Epoch: 23, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.308 Vali Acc: 0.926 Test Loss: 0.308 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 24 cost time: 0.7153241634368896
Epoch: 24, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.290 Vali Acc: 0.926 Test Loss: 0.290 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 25 cost time: 0.74619460105896
Epoch: 25, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7174668312072754
Epoch: 26, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6997146606445312
Epoch: 27, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.256 Vali Acc: 0.926 Test Loss: 0.256 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 28 cost time: 0.7401952743530273
Epoch: 28, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 29 cost time: 0.6979386806488037
Epoch: 29, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 30 cost time: 0.719752311706543
Epoch: 30, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 5533702
model size : 22.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2472007274627686
Epoch: 1, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.843 Vali Acc: 0.115 Test Loss: 1.843 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 0.7767417430877686
Epoch: 2, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.791 Vali Acc: 0.148 Test Loss: 1.791 Test Acc: 0.148
Validation loss decreased (-0.114796 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 0.8165569305419922
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.739 Vali Acc: 0.207 Test Loss: 1.739 Test Acc: 0.207
Validation loss decreased (-0.148130 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.8234820365905762
Epoch: 4, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.668 Vali Acc: 0.296 Test Loss: 1.668 Test Acc: 0.296
Validation loss decreased (-0.207390 --> -0.296280).  Saving model ...
Epoch: 5 cost time: 0.7857997417449951
Epoch: 5, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.581 Vali Acc: 0.370 Test Loss: 1.581 Test Acc: 0.370
Validation loss decreased (-0.296280 --> -0.370355).  Saving model ...
Epoch: 6 cost time: 0.7518002986907959
Epoch: 6, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.483 Vali Acc: 0.504 Test Loss: 1.483 Test Acc: 0.504
Validation loss decreased (-0.370355 --> -0.503689).  Saving model ...
Epoch: 7 cost time: 0.8218262195587158
Epoch: 7, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.376 Vali Acc: 0.611 Test Loss: 1.376 Test Acc: 0.611
Validation loss decreased (-0.503689 --> -0.611097).  Saving model ...
Epoch: 8 cost time: 0.8161611557006836
Epoch: 8, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.266 Vali Acc: 0.685 Test Loss: 1.266 Test Acc: 0.685
Validation loss decreased (-0.611097 --> -0.685173).  Saving model ...
Epoch: 9 cost time: 0.798922061920166
Epoch: 9, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.154 Vali Acc: 0.763 Test Loss: 1.154 Test Acc: 0.763
Validation loss decreased (-0.685173 --> -0.762951).  Saving model ...
Epoch: 10 cost time: 0.837273120880127
Epoch: 10, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.045 Vali Acc: 0.826 Test Loss: 1.045 Test Acc: 0.826
Validation loss decreased (-0.762951 --> -0.825915).  Saving model ...
Epoch: 11 cost time: 0.7784454822540283
Epoch: 11, Steps: 2 | Train Loss: 0.924 Vali Loss: 0.941 Vali Acc: 0.833 Test Loss: 0.941 Test Acc: 0.833
Validation loss decreased (-0.825915 --> -0.833324).  Saving model ...
Epoch: 12 cost time: 0.7624523639678955
Epoch: 12, Steps: 2 | Train Loss: 0.791 Vali Loss: 0.841 Vali Acc: 0.867 Test Loss: 0.841 Test Acc: 0.867
Validation loss decreased (-0.833324 --> -0.866658).  Saving model ...
Epoch: 13 cost time: 0.7348601818084717
Epoch: 13, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.749 Vali Acc: 0.885 Test Loss: 0.749 Test Acc: 0.885
Validation loss decreased (-0.866658 --> -0.885178).  Saving model ...
Epoch: 14 cost time: 0.7878520488739014
Epoch: 14, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.667 Vali Acc: 0.900 Test Loss: 0.667 Test Acc: 0.900
Validation loss decreased (-0.885178 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 0.8192522525787354
Epoch: 15, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.594 Vali Acc: 0.896 Test Loss: 0.594 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7778050899505615
Epoch: 16, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.532 Vali Acc: 0.896 Test Loss: 0.532 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8070764541625977
Epoch: 17, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.474 Vali Acc: 0.904 Test Loss: 0.474 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903699).  Saving model ...
Epoch: 18 cost time: 0.7804737091064453
Epoch: 18, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.424 Vali Acc: 0.915 Test Loss: 0.424 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914811).  Saving model ...
Epoch: 19 cost time: 0.7926335334777832
Epoch: 19, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.380 Vali Acc: 0.933 Test Loss: 0.380 Test Acc: 0.933
Validation loss decreased (-0.914811 --> -0.933330).  Saving model ...
Epoch: 20 cost time: 0.8412079811096191
Epoch: 20, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.343 Vali Acc: 0.933 Test Loss: 0.343 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 21 cost time: 0.8286221027374268
Epoch: 21, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.313 Vali Acc: 0.937 Test Loss: 0.313 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 22 cost time: 0.8278374671936035
Epoch: 22, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.289 Vali Acc: 0.941 Test Loss: 0.289 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 23 cost time: 0.7818028926849365
Epoch: 23, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7716495990753174
Epoch: 24, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8044910430908203
Epoch: 25, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7531216144561768
Epoch: 26, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7987525463104248
Epoch: 27, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7793385982513428
Epoch: 28, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7845561504364014
Epoch: 29, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7907288074493408
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 18773254
model size : 72.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0727734565734863
Epoch: 1, Steps: 2 | Train Loss: 1.914 Vali Loss: 1.809 Vali Acc: 0.211 Test Loss: 1.809 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.6105749607086182
Epoch: 2, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.758 Vali Acc: 0.285 Test Loss: 1.758 Test Acc: 0.285
Validation loss decreased (-0.211093 --> -0.285168).  Saving model ...
Epoch: 3 cost time: 0.6237294673919678
Epoch: 3, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.708 Vali Acc: 0.330 Test Loss: 1.708 Test Acc: 0.330
Validation loss decreased (-0.285168 --> -0.329613).  Saving model ...
Epoch: 4 cost time: 0.5936815738677979
Epoch: 4, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.640 Vali Acc: 0.415 Test Loss: 1.640 Test Acc: 0.415
Validation loss decreased (-0.329613 --> -0.414798).  Saving model ...
Epoch: 5 cost time: 0.6294779777526855
Epoch: 5, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.555 Vali Acc: 0.452 Test Loss: 1.555 Test Acc: 0.452
Validation loss decreased (-0.414798 --> -0.451836).  Saving model ...
Epoch: 6 cost time: 0.571997880935669
Epoch: 6, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.458 Vali Acc: 0.504 Test Loss: 1.458 Test Acc: 0.504
Validation loss decreased (-0.451836 --> -0.503689).  Saving model ...
Epoch: 7 cost time: 0.5778543949127197
Epoch: 7, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.356 Vali Acc: 0.563 Test Loss: 1.356 Test Acc: 0.563
Validation loss decreased (-0.503689 --> -0.562949).  Saving model ...
Epoch: 8 cost time: 0.5625214576721191
Epoch: 8, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.250 Vali Acc: 0.644 Test Loss: 1.250 Test Acc: 0.644
Validation loss decreased (-0.562949 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 0.5967929363250732
Epoch: 9, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.144 Vali Acc: 0.696 Test Loss: 1.144 Test Acc: 0.696
Validation loss decreased (-0.644432 --> -0.696285).  Saving model ...
Epoch: 10 cost time: 0.46779584884643555
Epoch: 10, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.040 Vali Acc: 0.781 Test Loss: 1.040 Test Acc: 0.781
Validation loss decreased (-0.696285 --> -0.781471).  Saving model ...
Epoch: 11 cost time: 0.5992319583892822
Epoch: 11, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.941 Vali Acc: 0.826 Test Loss: 0.941 Test Acc: 0.826
Validation loss decreased (-0.781471 --> -0.825917).  Saving model ...
Epoch: 12 cost time: 0.6033062934875488
Epoch: 12, Steps: 2 | Train Loss: 0.791 Vali Loss: 0.849 Vali Acc: 0.867 Test Loss: 0.849 Test Acc: 0.867
Validation loss decreased (-0.825917 --> -0.866658).  Saving model ...
Epoch: 13 cost time: 0.5932247638702393
Epoch: 13, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.763 Vali Acc: 0.881 Test Loss: 0.763 Test Acc: 0.881
Validation loss decreased (-0.866658 --> -0.881474).  Saving model ...
Epoch: 14 cost time: 0.5855293273925781
Epoch: 14, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.687 Vali Acc: 0.893 Test Loss: 0.687 Test Acc: 0.893
Validation loss decreased (-0.881474 --> -0.892586).  Saving model ...
Epoch: 15 cost time: 0.5775632858276367
Epoch: 15, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.617 Vali Acc: 0.896 Test Loss: 0.617 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 16 cost time: 0.6864864826202393
Epoch: 16, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.554 Vali Acc: 0.907 Test Loss: 0.554 Test Acc: 0.907
Validation loss decreased (-0.896290 --> -0.907402).  Saving model ...
Epoch: 17 cost time: 0.6732110977172852
Epoch: 17, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.502 Vali Acc: 0.911 Test Loss: 0.502 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 18 cost time: 0.7508575916290283
Epoch: 18, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.456 Vali Acc: 0.911 Test Loss: 0.456 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 19 cost time: 0.6588547229766846
Epoch: 19, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.416 Vali Acc: 0.915 Test Loss: 0.416 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 20 cost time: 0.6670851707458496
Epoch: 20, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.383 Vali Acc: 0.915 Test Loss: 0.383 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 21 cost time: 0.6843340396881104
Epoch: 21, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.355 Vali Acc: 0.922 Test Loss: 0.355 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 0.6911325454711914
Epoch: 22, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 23 cost time: 0.7147922515869141
Epoch: 23, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 24 cost time: 0.6991846561431885
Epoch: 24, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.292 Vali Acc: 0.926 Test Loss: 0.292 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 25 cost time: 0.7915534973144531
Epoch: 25, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7282352447509766
Epoch: 26, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7225286960601807
Epoch: 27, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.258 Vali Acc: 0.926 Test Loss: 0.258 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 28 cost time: 0.6851065158843994
Epoch: 28, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 29 cost time: 0.7247252464294434
Epoch: 29, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 30 cost time: 0.7018282413482666
Epoch: 30, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.241 Vali Acc: 0.926 Test Loss: 0.241 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 5533702
model size : 22.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7004880905151367
Epoch: 1, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.790 Vali Acc: 0.230 Test Loss: 1.790 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 1.0021774768829346
Epoch: 2, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.735 Vali Acc: 0.296 Test Loss: 1.735 Test Acc: 0.296
Validation loss decreased (-0.229612 --> -0.296279).  Saving model ...
Epoch: 3 cost time: 1.0381593704223633
Epoch: 3, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.683 Vali Acc: 0.341 Test Loss: 1.683 Test Acc: 0.341
Validation loss decreased (-0.296279 --> -0.340724).  Saving model ...
Epoch: 4 cost time: 1.0597758293151855
Epoch: 4, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.618 Vali Acc: 0.470 Test Loss: 1.618 Test Acc: 0.470
Validation loss decreased (-0.340724 --> -0.470354).  Saving model ...
Epoch: 5 cost time: 0.998767614364624
Epoch: 5, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.537 Vali Acc: 0.537 Test Loss: 1.537 Test Acc: 0.537
Validation loss decreased (-0.470354 --> -0.537022).  Saving model ...
Epoch: 6 cost time: 1.0325846672058105
Epoch: 6, Steps: 2 | Train Loss: 1.424 Vali Loss: 1.445 Vali Acc: 0.633 Test Loss: 1.445 Test Acc: 0.633
Validation loss decreased (-0.537022 --> -0.633319).  Saving model ...
Epoch: 7 cost time: 1.0396173000335693
Epoch: 7, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.349 Vali Acc: 0.685 Test Loss: 1.349 Test Acc: 0.685
Validation loss decreased (-0.633319 --> -0.685172).  Saving model ...
Epoch: 8 cost time: 1.1000216007232666
Epoch: 8, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.252 Vali Acc: 0.737 Test Loss: 1.252 Test Acc: 0.737
Validation loss decreased (-0.685172 --> -0.737025).  Saving model ...
Epoch: 9 cost time: 1.066584587097168
Epoch: 9, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.155 Vali Acc: 0.778 Test Loss: 1.155 Test Acc: 0.778
Validation loss decreased (-0.737025 --> -0.777766).  Saving model ...
Epoch: 10 cost time: 1.0662150382995605
Epoch: 10, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.060 Vali Acc: 0.793 Test Loss: 1.060 Test Acc: 0.793
Validation loss decreased (-0.777766 --> -0.792582).  Saving model ...
Epoch: 11 cost time: 1.0217339992523193
Epoch: 11, Steps: 2 | Train Loss: 0.882 Vali Loss: 0.967 Vali Acc: 0.822 Test Loss: 0.967 Test Acc: 0.822
Validation loss decreased (-0.792582 --> -0.822213).  Saving model ...
Epoch: 12 cost time: 1.0344579219818115
Epoch: 12, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.881 Vali Acc: 0.848 Test Loss: 0.881 Test Acc: 0.848
Validation loss decreased (-0.822213 --> -0.848139).  Saving model ...
Epoch: 13 cost time: 1.0514767169952393
Epoch: 13, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.799 Vali Acc: 0.859 Test Loss: 0.799 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859251).  Saving model ...
Epoch: 14 cost time: 1.026625156402588
Epoch: 14, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.725 Vali Acc: 0.885 Test Loss: 0.725 Test Acc: 0.885
Validation loss decreased (-0.859251 --> -0.885178).  Saving model ...
Epoch: 15 cost time: 1.0080235004425049
Epoch: 15, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.658 Vali Acc: 0.893 Test Loss: 0.658 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 16 cost time: 1.0005838871002197
Epoch: 16, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.599 Vali Acc: 0.893 Test Loss: 0.599 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892587).  Saving model ...
Epoch: 17 cost time: 1.0224668979644775
Epoch: 17, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.547 Vali Acc: 0.896 Test Loss: 0.547 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 18 cost time: 0.9992992877960205
Epoch: 18, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.502 Vali Acc: 0.896 Test Loss: 0.502 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 19 cost time: 1.0013539791107178
Epoch: 19, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.464 Vali Acc: 0.896 Test Loss: 0.464 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896292).  Saving model ...
Epoch: 20 cost time: 1.0329797267913818
Epoch: 20, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.432 Vali Acc: 0.904 Test Loss: 0.432 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903699).  Saving model ...
Epoch: 21 cost time: 1.026606559753418
Epoch: 21, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.402 Vali Acc: 0.915 Test Loss: 0.402 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914811).  Saving model ...
Epoch: 22 cost time: 1.070432186126709
Epoch: 22, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.375 Vali Acc: 0.911 Test Loss: 0.375 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1133711338043213
Epoch: 23, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.351 Vali Acc: 0.911 Test Loss: 0.351 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0219781398773193
Epoch: 24, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.330 Vali Acc: 0.919 Test Loss: 0.330 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 25 cost time: 1.0452892780303955
Epoch: 25, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.312 Vali Acc: 0.922 Test Loss: 0.312 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 26 cost time: 1.048051357269287
Epoch: 26, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0722298622131348
Epoch: 27, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0151996612548828
Epoch: 28, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.273 Vali Acc: 0.915 Test Loss: 0.273 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0517168045043945
Epoch: 29, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.264 Vali Acc: 0.915 Test Loss: 0.264 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0162816047668457
Epoch: 30, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 9400070
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.157771348953247
Epoch: 1, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.797 Vali Acc: 0.193 Test Loss: 1.797 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.6911332607269287
Epoch: 2, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.745 Vali Acc: 0.237 Test Loss: 1.745 Test Acc: 0.237
Validation loss decreased (-0.192575 --> -0.237020).  Saving model ...
Epoch: 3 cost time: 0.6411597728729248
Epoch: 3, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.696 Vali Acc: 0.307 Test Loss: 1.696 Test Acc: 0.307
Validation loss decreased (-0.237020 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 0.657789945602417
Epoch: 4, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.635 Vali Acc: 0.396 Test Loss: 1.635 Test Acc: 0.396
Validation loss decreased (-0.307390 --> -0.396280).  Saving model ...
Epoch: 5 cost time: 0.6464025974273682
Epoch: 5, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.557 Vali Acc: 0.493 Test Loss: 1.557 Test Acc: 0.493
Validation loss decreased (-0.396280 --> -0.492577).  Saving model ...
Epoch: 6 cost time: 0.64554762840271
Epoch: 6, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.468 Vali Acc: 0.578 Test Loss: 1.468 Test Acc: 0.578
Validation loss decreased (-0.492577 --> -0.577763).  Saving model ...
Epoch: 7 cost time: 0.6605572700500488
Epoch: 7, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.371 Vali Acc: 0.681 Test Loss: 1.371 Test Acc: 0.681
Validation loss decreased (-0.577763 --> -0.681468).  Saving model ...
Epoch: 8 cost time: 0.6832883358001709
Epoch: 8, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.270 Vali Acc: 0.756 Test Loss: 1.270 Test Acc: 0.756
Validation loss decreased (-0.681468 --> -0.755543).  Saving model ...
Epoch: 9 cost time: 0.6595096588134766
Epoch: 9, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.168 Vali Acc: 0.804 Test Loss: 1.168 Test Acc: 0.804
Validation loss decreased (-0.755543 --> -0.803692).  Saving model ...
Epoch: 10 cost time: 0.6505889892578125
Epoch: 10, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.066 Vali Acc: 0.852 Test Loss: 1.066 Test Acc: 0.852
Validation loss decreased (-0.803692 --> -0.851841).  Saving model ...
Epoch: 11 cost time: 0.6343333721160889
Epoch: 11, Steps: 2 | Train Loss: 0.948 Vali Loss: 0.968 Vali Acc: 0.889 Test Loss: 0.968 Test Acc: 0.889
Validation loss decreased (-0.851841 --> -0.888879).  Saving model ...
Epoch: 12 cost time: 0.6523382663726807
Epoch: 12, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.876 Vali Acc: 0.930 Test Loss: 0.876 Test Acc: 0.930
Validation loss decreased (-0.888879 --> -0.929621).  Saving model ...
Epoch: 13 cost time: 0.6890275478363037
Epoch: 13, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.793 Vali Acc: 0.930 Test Loss: 0.793 Test Acc: 0.930
Validation loss decreased (-0.929621 --> -0.929622).  Saving model ...
Epoch: 14 cost time: 0.7076454162597656
Epoch: 14, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.716 Vali Acc: 0.937 Test Loss: 0.716 Test Acc: 0.937
Validation loss decreased (-0.929622 --> -0.937030).  Saving model ...
Epoch: 15 cost time: 0.646686315536499
Epoch: 15, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.647 Vali Acc: 0.937 Test Loss: 0.647 Test Acc: 0.937
Validation loss decreased (-0.937030 --> -0.937031).  Saving model ...
Epoch: 16 cost time: 0.6799628734588623
Epoch: 16, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.583 Vali Acc: 0.941 Test Loss: 0.583 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 17 cost time: 0.6802318096160889
Epoch: 17, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.526 Vali Acc: 0.937 Test Loss: 0.526 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6828634738922119
Epoch: 18, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.476 Vali Acc: 0.933 Test Loss: 0.476 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6298680305480957
Epoch: 19, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.433 Vali Acc: 0.933 Test Loss: 0.433 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.676816463470459
Epoch: 20, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.394 Vali Acc: 0.937 Test Loss: 0.394 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6467511653900146
Epoch: 21, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.363 Vali Acc: 0.933 Test Loss: 0.363 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7095427513122559
Epoch: 22, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.336 Vali Acc: 0.930 Test Loss: 0.336 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6943979263305664
Epoch: 23, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.314 Vali Acc: 0.930 Test Loss: 0.314 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6949489116668701
Epoch: 24, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6426699161529541
Epoch: 25, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7042431831359863
Epoch: 26, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 2780166
model size : 11.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5657269954681396
Epoch: 1, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.790 Vali Acc: 0.230 Test Loss: 1.790 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.8126804828643799
Epoch: 2, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.735 Vali Acc: 0.296 Test Loss: 1.735 Test Acc: 0.296
Validation loss decreased (-0.229612 --> -0.296279).  Saving model ...
Epoch: 3 cost time: 0.8189444541931152
Epoch: 3, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.683 Vali Acc: 0.341 Test Loss: 1.683 Test Acc: 0.341
Validation loss decreased (-0.296279 --> -0.340724).  Saving model ...
Epoch: 4 cost time: 0.8213357925415039
Epoch: 4, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.618 Vali Acc: 0.470 Test Loss: 1.618 Test Acc: 0.470
Validation loss decreased (-0.340724 --> -0.470354).  Saving model ...
Epoch: 5 cost time: 0.8560998439788818
Epoch: 5, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.537 Vali Acc: 0.537 Test Loss: 1.537 Test Acc: 0.537
Validation loss decreased (-0.470354 --> -0.537022).  Saving model ...
Epoch: 6 cost time: 0.8419058322906494
Epoch: 6, Steps: 2 | Train Loss: 1.424 Vali Loss: 1.445 Vali Acc: 0.633 Test Loss: 1.445 Test Acc: 0.633
Validation loss decreased (-0.537022 --> -0.633319).  Saving model ...
Epoch: 7 cost time: 0.8492586612701416
Epoch: 7, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.349 Vali Acc: 0.685 Test Loss: 1.349 Test Acc: 0.685
Validation loss decreased (-0.633319 --> -0.685172).  Saving model ...
Epoch: 8 cost time: 0.8538784980773926
Epoch: 8, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.252 Vali Acc: 0.737 Test Loss: 1.252 Test Acc: 0.737
Validation loss decreased (-0.685172 --> -0.737025).  Saving model ...
Epoch: 9 cost time: 0.8418295383453369
Epoch: 9, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.155 Vali Acc: 0.778 Test Loss: 1.155 Test Acc: 0.778
Validation loss decreased (-0.737025 --> -0.777766).  Saving model ...
Epoch: 10 cost time: 0.8104598522186279
Epoch: 10, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.060 Vali Acc: 0.793 Test Loss: 1.060 Test Acc: 0.793
Validation loss decreased (-0.777766 --> -0.792582).  Saving model ...
Epoch: 11 cost time: 0.821054220199585
Epoch: 11, Steps: 2 | Train Loss: 0.882 Vali Loss: 0.967 Vali Acc: 0.822 Test Loss: 0.967 Test Acc: 0.822
Validation loss decreased (-0.792582 --> -0.822213).  Saving model ...
Epoch: 12 cost time: 0.8531203269958496
Epoch: 12, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.881 Vali Acc: 0.848 Test Loss: 0.881 Test Acc: 0.848
Validation loss decreased (-0.822213 --> -0.848139).  Saving model ...
Epoch: 13 cost time: 0.8251612186431885
Epoch: 13, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.799 Vali Acc: 0.859 Test Loss: 0.799 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859251).  Saving model ...
Epoch: 14 cost time: 0.779308557510376
Epoch: 14, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.725 Vali Acc: 0.885 Test Loss: 0.725 Test Acc: 0.885
Validation loss decreased (-0.859251 --> -0.885178).  Saving model ...
Epoch: 15 cost time: 0.793168306350708
Epoch: 15, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.658 Vali Acc: 0.893 Test Loss: 0.658 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 16 cost time: 0.7907209396362305
Epoch: 16, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.599 Vali Acc: 0.893 Test Loss: 0.599 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892587).  Saving model ...
Epoch: 17 cost time: 0.801478385925293
Epoch: 17, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.547 Vali Acc: 0.896 Test Loss: 0.547 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 18 cost time: 0.8031914234161377
Epoch: 18, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.502 Vali Acc: 0.896 Test Loss: 0.502 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 19 cost time: 0.8290162086486816
Epoch: 19, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.464 Vali Acc: 0.896 Test Loss: 0.464 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896292).  Saving model ...
Epoch: 20 cost time: 0.8308641910552979
Epoch: 20, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.432 Vali Acc: 0.904 Test Loss: 0.432 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903699).  Saving model ...
Epoch: 21 cost time: 0.790705680847168
Epoch: 21, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.402 Vali Acc: 0.915 Test Loss: 0.402 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914811).  Saving model ...
Epoch: 22 cost time: 0.819892168045044
Epoch: 22, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.375 Vali Acc: 0.911 Test Loss: 0.375 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.800919771194458
Epoch: 23, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.351 Vali Acc: 0.911 Test Loss: 0.351 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7882897853851318
Epoch: 24, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.330 Vali Acc: 0.919 Test Loss: 0.330 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 25 cost time: 0.8393025398254395
Epoch: 25, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.312 Vali Acc: 0.922 Test Loss: 0.312 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 26 cost time: 0.8086247444152832
Epoch: 26, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8182034492492676
Epoch: 27, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.790203332901001
Epoch: 28, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.273 Vali Acc: 0.915 Test Loss: 0.273 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8229281902313232
Epoch: 29, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.264 Vali Acc: 0.915 Test Loss: 0.264 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7886769771575928
Epoch: 30, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 9400070
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2461698055267334
Epoch: 1, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.797 Vali Acc: 0.193 Test Loss: 1.797 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.6050965785980225
Epoch: 2, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.745 Vali Acc: 0.237 Test Loss: 1.745 Test Acc: 0.237
Validation loss decreased (-0.192575 --> -0.237020).  Saving model ...
Epoch: 3 cost time: 0.5954046249389648
Epoch: 3, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.696 Vali Acc: 0.307 Test Loss: 1.696 Test Acc: 0.307
Validation loss decreased (-0.237020 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 0.5979006290435791
Epoch: 4, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.635 Vali Acc: 0.396 Test Loss: 1.635 Test Acc: 0.396
Validation loss decreased (-0.307390 --> -0.396280).  Saving model ...
Epoch: 5 cost time: 0.5704536437988281
Epoch: 5, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.557 Vali Acc: 0.493 Test Loss: 1.557 Test Acc: 0.493
Validation loss decreased (-0.396280 --> -0.492577).  Saving model ...
Epoch: 6 cost time: 0.5922896862030029
Epoch: 6, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.468 Vali Acc: 0.578 Test Loss: 1.468 Test Acc: 0.578
Validation loss decreased (-0.492577 --> -0.577763).  Saving model ...
Epoch: 7 cost time: 0.5884232521057129
Epoch: 7, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.371 Vali Acc: 0.681 Test Loss: 1.371 Test Acc: 0.681
Validation loss decreased (-0.577763 --> -0.681468).  Saving model ...
Epoch: 8 cost time: 0.6124134063720703
Epoch: 8, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.270 Vali Acc: 0.756 Test Loss: 1.270 Test Acc: 0.756
Validation loss decreased (-0.681468 --> -0.755543).  Saving model ...
Epoch: 9 cost time: 0.6183712482452393
Epoch: 9, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.168 Vali Acc: 0.804 Test Loss: 1.168 Test Acc: 0.804
Validation loss decreased (-0.755543 --> -0.803692).  Saving model ...
Epoch: 10 cost time: 0.6088123321533203
Epoch: 10, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.066 Vali Acc: 0.852 Test Loss: 1.066 Test Acc: 0.852
Validation loss decreased (-0.803692 --> -0.851841).  Saving model ...
Epoch: 11 cost time: 0.5890681743621826
Epoch: 11, Steps: 2 | Train Loss: 0.948 Vali Loss: 0.968 Vali Acc: 0.889 Test Loss: 0.968 Test Acc: 0.889
Validation loss decreased (-0.851841 --> -0.888879).  Saving model ...
Epoch: 12 cost time: 0.5888574123382568
Epoch: 12, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.876 Vali Acc: 0.930 Test Loss: 0.876 Test Acc: 0.930
Validation loss decreased (-0.888879 --> -0.929621).  Saving model ...
Epoch: 13 cost time: 0.6349220275878906
Epoch: 13, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.793 Vali Acc: 0.930 Test Loss: 0.793 Test Acc: 0.930
Validation loss decreased (-0.929621 --> -0.929622).  Saving model ...
Epoch: 14 cost time: 0.6101734638214111
Epoch: 14, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.716 Vali Acc: 0.937 Test Loss: 0.716 Test Acc: 0.937
Validation loss decreased (-0.929622 --> -0.937030).  Saving model ...
Epoch: 15 cost time: 0.5927109718322754
Epoch: 15, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.647 Vali Acc: 0.937 Test Loss: 0.647 Test Acc: 0.937
Validation loss decreased (-0.937030 --> -0.937031).  Saving model ...
Epoch: 16 cost time: 0.6191155910491943
Epoch: 16, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.583 Vali Acc: 0.941 Test Loss: 0.583 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 17 cost time: 0.6120791435241699
Epoch: 17, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.526 Vali Acc: 0.937 Test Loss: 0.526 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6035196781158447
Epoch: 18, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.476 Vali Acc: 0.933 Test Loss: 0.476 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6108229160308838
Epoch: 19, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.433 Vali Acc: 0.933 Test Loss: 0.433 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5691611766815186
Epoch: 20, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.394 Vali Acc: 0.937 Test Loss: 0.394 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5945758819580078
Epoch: 21, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.363 Vali Acc: 0.933 Test Loss: 0.363 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6233606338500977
Epoch: 22, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.336 Vali Acc: 0.930 Test Loss: 0.336 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6165263652801514
Epoch: 23, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.314 Vali Acc: 0.930 Test Loss: 0.314 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6526262760162354
Epoch: 24, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6571025848388672
Epoch: 25, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.582366943359375
Epoch: 26, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 2780166
model size : 11.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2887465953826904
Epoch: 1, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.789 Vali Acc: 0.230 Test Loss: 1.789 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.5862023830413818
Epoch: 2, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.734 Vali Acc: 0.296 Test Loss: 1.734 Test Acc: 0.296
Validation loss decreased (-0.229612 --> -0.296279).  Saving model ...
Epoch: 3 cost time: 0.6370124816894531
Epoch: 3, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.683 Vali Acc: 0.341 Test Loss: 1.683 Test Acc: 0.341
Validation loss decreased (-0.296279 --> -0.340724).  Saving model ...
Epoch: 4 cost time: 0.6067204475402832
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.618 Vali Acc: 0.463 Test Loss: 1.618 Test Acc: 0.463
Validation loss decreased (-0.340724 --> -0.462947).  Saving model ...
Epoch: 5 cost time: 0.6772465705871582
Epoch: 5, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.537 Vali Acc: 0.537 Test Loss: 1.537 Test Acc: 0.537
Validation loss decreased (-0.462947 --> -0.537022).  Saving model ...
Epoch: 6 cost time: 0.6251039505004883
Epoch: 6, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.447 Vali Acc: 0.633 Test Loss: 1.447 Test Acc: 0.633
Validation loss decreased (-0.537022 --> -0.633319).  Saving model ...
Epoch: 7 cost time: 0.6678023338317871
Epoch: 7, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.351 Vali Acc: 0.681 Test Loss: 1.351 Test Acc: 0.681
Validation loss decreased (-0.633319 --> -0.681468).  Saving model ...
Epoch: 8 cost time: 0.6470291614532471
Epoch: 8, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.254 Vali Acc: 0.737 Test Loss: 1.254 Test Acc: 0.737
Validation loss decreased (-0.681468 --> -0.737024).  Saving model ...
Epoch: 9 cost time: 0.6564464569091797
Epoch: 9, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.158 Vali Acc: 0.778 Test Loss: 1.158 Test Acc: 0.778
Validation loss decreased (-0.737024 --> -0.777766).  Saving model ...
Epoch: 10 cost time: 0.6490039825439453
Epoch: 10, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.064 Vali Acc: 0.793 Test Loss: 1.064 Test Acc: 0.793
Validation loss decreased (-0.777766 --> -0.792582).  Saving model ...
Epoch: 11 cost time: 0.6426088809967041
Epoch: 11, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.971 Vali Acc: 0.822 Test Loss: 0.971 Test Acc: 0.822
Validation loss decreased (-0.792582 --> -0.822213).  Saving model ...
Epoch: 12 cost time: 0.6568644046783447
Epoch: 12, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.885 Vali Acc: 0.841 Test Loss: 0.885 Test Acc: 0.841
Validation loss decreased (-0.822213 --> -0.840732).  Saving model ...
Epoch: 13 cost time: 0.6363940238952637
Epoch: 13, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.802 Vali Acc: 0.867 Test Loss: 0.802 Test Acc: 0.867
Validation loss decreased (-0.840732 --> -0.866659).  Saving model ...
Epoch: 14 cost time: 0.6838486194610596
Epoch: 14, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.728 Vali Acc: 0.878 Test Loss: 0.728 Test Acc: 0.878
Validation loss decreased (-0.866659 --> -0.877770).  Saving model ...
Epoch: 15 cost time: 0.6442873477935791
Epoch: 15, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.661 Vali Acc: 0.893 Test Loss: 0.661 Test Acc: 0.893
Validation loss decreased (-0.877770 --> -0.892586).  Saving model ...
Epoch: 16 cost time: 0.6180472373962402
Epoch: 16, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.601 Vali Acc: 0.893 Test Loss: 0.601 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892587).  Saving model ...
Epoch: 17 cost time: 0.6423816680908203
Epoch: 17, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.549 Vali Acc: 0.900 Test Loss: 0.549 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.6028308868408203
Epoch: 18, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.504 Vali Acc: 0.900 Test Loss: 0.504 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 0.6682488918304443
Epoch: 19, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.6218812465667725
Epoch: 20, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.433 Vali Acc: 0.907 Test Loss: 0.433 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907403).  Saving model ...
Epoch: 21 cost time: 0.6481385231018066
Epoch: 21, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.403 Vali Acc: 0.915 Test Loss: 0.403 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 22 cost time: 0.6292576789855957
Epoch: 22, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.376 Vali Acc: 0.911 Test Loss: 0.376 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6415367126464844
Epoch: 23, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.352 Vali Acc: 0.911 Test Loss: 0.352 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7096762657165527
Epoch: 24, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.331 Vali Acc: 0.922 Test Loss: 0.331 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 25 cost time: 0.6042490005493164
Epoch: 25, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.313 Vali Acc: 0.922 Test Loss: 0.313 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 26 cost time: 0.6311149597167969
Epoch: 26, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.299 Vali Acc: 0.919 Test Loss: 0.299 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6111576557159424
Epoch: 27, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.285 Vali Acc: 0.915 Test Loss: 0.285 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6490254402160645
Epoch: 28, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.274 Vali Acc: 0.915 Test Loss: 0.274 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6453819274902344
Epoch: 29, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6254451274871826
Epoch: 30, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.258 Vali Acc: 0.915 Test Loss: 0.258 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 9400070
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.107179641723633
Epoch: 1, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.797 Vali Acc: 0.193 Test Loss: 1.797 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.5404655933380127
Epoch: 2, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.745 Vali Acc: 0.241 Test Loss: 1.745 Test Acc: 0.241
Validation loss decreased (-0.192575 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 0.608738899230957
Epoch: 3, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.697 Vali Acc: 0.315 Test Loss: 1.697 Test Acc: 0.315
Validation loss decreased (-0.240723 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 0.5661683082580566
Epoch: 4, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.636 Vali Acc: 0.400 Test Loss: 1.636 Test Acc: 0.400
Validation loss decreased (-0.314798 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 0.5096638202667236
Epoch: 5, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.559 Vali Acc: 0.496 Test Loss: 1.559 Test Acc: 0.496
Validation loss decreased (-0.399984 --> -0.496281).  Saving model ...
Epoch: 6 cost time: 0.5123116970062256
Epoch: 6, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.471 Vali Acc: 0.578 Test Loss: 1.471 Test Acc: 0.578
Validation loss decreased (-0.496281 --> -0.577763).  Saving model ...
Epoch: 7 cost time: 0.5373032093048096
Epoch: 7, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.375 Vali Acc: 0.678 Test Loss: 1.375 Test Acc: 0.678
Validation loss decreased (-0.577763 --> -0.677764).  Saving model ...
Epoch: 8 cost time: 0.5299551486968994
Epoch: 8, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.275 Vali Acc: 0.748 Test Loss: 1.275 Test Acc: 0.748
Validation loss decreased (-0.677764 --> -0.748135).  Saving model ...
Epoch: 9 cost time: 0.5487117767333984
Epoch: 9, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.174 Vali Acc: 0.804 Test Loss: 1.174 Test Acc: 0.804
Validation loss decreased (-0.748135 --> -0.803692).  Saving model ...
Epoch: 10 cost time: 0.5405125617980957
Epoch: 10, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.072 Vali Acc: 0.848 Test Loss: 1.072 Test Acc: 0.848
Validation loss decreased (-0.803692 --> -0.848137).  Saving model ...
Epoch: 11 cost time: 0.5521285533905029
Epoch: 11, Steps: 2 | Train Loss: 0.961 Vali Loss: 0.975 Vali Acc: 0.885 Test Loss: 0.975 Test Acc: 0.885
Validation loss decreased (-0.848137 --> -0.885175).  Saving model ...
Epoch: 12 cost time: 0.5142025947570801
Epoch: 12, Steps: 2 | Train Loss: 0.833 Vali Loss: 0.883 Vali Acc: 0.926 Test Loss: 0.883 Test Acc: 0.926
Validation loss decreased (-0.885175 --> -0.925917).  Saving model ...
Epoch: 13 cost time: 0.5388147830963135
Epoch: 13, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.799 Vali Acc: 0.922 Test Loss: 0.799 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5315134525299072
Epoch: 14, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.723 Vali Acc: 0.933 Test Loss: 0.723 Test Acc: 0.933
Validation loss decreased (-0.925917 --> -0.933326).  Saving model ...
Epoch: 15 cost time: 0.5487947463989258
Epoch: 15, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.652 Vali Acc: 0.937 Test Loss: 0.652 Test Acc: 0.937
Validation loss decreased (-0.933326 --> -0.937031).  Saving model ...
Epoch: 16 cost time: 0.5250170230865479
Epoch: 16, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.588 Vali Acc: 0.933 Test Loss: 0.588 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5132656097412109
Epoch: 17, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.531 Vali Acc: 0.933 Test Loss: 0.531 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.543419599533081
Epoch: 18, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.481 Vali Acc: 0.930 Test Loss: 0.481 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5679240226745605
Epoch: 19, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.437 Vali Acc: 0.930 Test Loss: 0.437 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5710718631744385
Epoch: 20, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.398 Vali Acc: 0.933 Test Loss: 0.398 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5437076091766357
Epoch: 21, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.367 Vali Acc: 0.933 Test Loss: 0.367 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5226864814758301
Epoch: 22, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.340 Vali Acc: 0.930 Test Loss: 0.340 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5520060062408447
Epoch: 23, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.317 Vali Acc: 0.930 Test Loss: 0.317 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.49677300453186035
Epoch: 24, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.298 Vali Acc: 0.930 Test Loss: 0.298 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.49131178855895996
Epoch: 25, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 2780166
model size : 11.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.347250461578369
Epoch: 1, Steps: 2 | Train Loss: 1.914 Vali Loss: 1.808 Vali Acc: 0.204 Test Loss: 1.808 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.7707476615905762
Epoch: 2, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.756 Vali Acc: 0.252 Test Loss: 1.756 Test Acc: 0.252
Validation loss decreased (-0.203686 --> -0.251834).  Saving model ...
Epoch: 3 cost time: 0.8409037590026855
Epoch: 3, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.710 Vali Acc: 0.278 Test Loss: 1.710 Test Acc: 0.278
Validation loss decreased (-0.251834 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 0.8010938167572021
Epoch: 4, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.654 Vali Acc: 0.341 Test Loss: 1.654 Test Acc: 0.341
Validation loss decreased (-0.277761 --> -0.340724).  Saving model ...
Epoch: 5 cost time: 0.7855236530303955
Epoch: 5, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.584 Vali Acc: 0.385 Test Loss: 1.584 Test Acc: 0.385
Validation loss decreased (-0.340724 --> -0.385169).  Saving model ...
Epoch: 6 cost time: 0.8462100028991699
Epoch: 6, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.503 Vali Acc: 0.489 Test Loss: 1.503 Test Acc: 0.489
Validation loss decreased (-0.385169 --> -0.488874).  Saving model ...
Epoch: 7 cost time: 0.8138911724090576
Epoch: 7, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.415 Vali Acc: 0.578 Test Loss: 1.415 Test Acc: 0.578
Validation loss decreased (-0.488874 --> -0.577764).  Saving model ...
Epoch: 8 cost time: 0.7713007926940918
Epoch: 8, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.324 Vali Acc: 0.648 Test Loss: 1.324 Test Acc: 0.648
Validation loss decreased (-0.577764 --> -0.648135).  Saving model ...
Epoch: 9 cost time: 0.8256683349609375
Epoch: 9, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.232 Vali Acc: 0.719 Test Loss: 1.232 Test Acc: 0.719
Validation loss decreased (-0.648135 --> -0.718506).  Saving model ...
Epoch: 10 cost time: 0.8146331310272217
Epoch: 10, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.139 Vali Acc: 0.770 Test Loss: 1.139 Test Acc: 0.770
Validation loss decreased (-0.718506 --> -0.770359).  Saving model ...
Epoch: 11 cost time: 0.7687830924987793
Epoch: 11, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.048 Vali Acc: 0.830 Test Loss: 1.048 Test Acc: 0.830
Validation loss decreased (-0.770359 --> -0.829619).  Saving model ...
Epoch: 12 cost time: 0.8042230606079102
Epoch: 12, Steps: 2 | Train Loss: 0.864 Vali Loss: 0.961 Vali Acc: 0.852 Test Loss: 0.961 Test Acc: 0.852
Validation loss decreased (-0.829619 --> -0.851842).  Saving model ...
Epoch: 13 cost time: 0.8145809173583984
Epoch: 13, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.880 Vali Acc: 0.867 Test Loss: 0.880 Test Acc: 0.867
Validation loss decreased (-0.851842 --> -0.866658).  Saving model ...
Epoch: 14 cost time: 0.8252122402191162
Epoch: 14, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.805 Vali Acc: 0.874 Test Loss: 0.805 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874066).  Saving model ...
Epoch: 15 cost time: 0.7930872440338135
Epoch: 15, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.734 Vali Acc: 0.889 Test Loss: 0.734 Test Acc: 0.889
Validation loss decreased (-0.874066 --> -0.888882).  Saving model ...
Epoch: 16 cost time: 0.754155158996582
Epoch: 16, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.670 Vali Acc: 0.896 Test Loss: 0.670 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 17 cost time: 0.7889611721038818
Epoch: 17, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.612 Vali Acc: 0.900 Test Loss: 0.612 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 0.8484232425689697
Epoch: 18, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.559 Vali Acc: 0.900 Test Loss: 0.559 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 0.8065652847290039
Epoch: 19, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.511 Vali Acc: 0.904 Test Loss: 0.511 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903699).  Saving model ...
Epoch: 20 cost time: 0.8091745376586914
Epoch: 20, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.469 Vali Acc: 0.911 Test Loss: 0.469 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911106).  Saving model ...
Epoch: 21 cost time: 0.8424804210662842
Epoch: 21, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.432 Vali Acc: 0.911 Test Loss: 0.432 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 22 cost time: 0.8705317974090576
Epoch: 22, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.399 Vali Acc: 0.911 Test Loss: 0.399 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 23 cost time: 0.8464102745056152
Epoch: 23, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.371 Vali Acc: 0.915 Test Loss: 0.371 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 24 cost time: 0.8742787837982178
Epoch: 24, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.346 Vali Acc: 0.915 Test Loss: 0.346 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 25 cost time: 0.7994692325592041
Epoch: 25, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.326 Vali Acc: 0.915 Test Loss: 0.326 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 26 cost time: 0.8626232147216797
Epoch: 26, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8379499912261963
Epoch: 27, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.294 Vali Acc: 0.919 Test Loss: 0.294 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 28 cost time: 0.8099112510681152
Epoch: 28, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925923).  Saving model ...
Epoch: 29 cost time: 0.8306803703308105
Epoch: 29, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.275 Vali Acc: 0.915 Test Loss: 0.275 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8272290229797363
Epoch: 30, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.268 Vali Acc: 0.919 Test Loss: 0.268 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 4713478
model size : 19.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.117629289627075
Epoch: 1, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.785 Vali Acc: 0.178 Test Loss: 1.785 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.6187336444854736
Epoch: 2, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.738 Vali Acc: 0.200 Test Loss: 1.738 Test Acc: 0.200
Validation loss decreased (-0.177760 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 0.6468617916107178
Epoch: 3, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.695 Vali Acc: 0.237 Test Loss: 1.695 Test Acc: 0.237
Validation loss decreased (-0.199983 --> -0.237020).  Saving model ...
Epoch: 4 cost time: 0.6078197956085205
Epoch: 4, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.641 Vali Acc: 0.333 Test Loss: 1.641 Test Acc: 0.333
Validation loss decreased (-0.237020 --> -0.333317).  Saving model ...
Epoch: 5 cost time: 0.6287524700164795
Epoch: 5, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.574 Vali Acc: 0.426 Test Loss: 1.574 Test Acc: 0.426
Validation loss decreased (-0.333317 --> -0.425910).  Saving model ...
Epoch: 6 cost time: 0.6250793933868408
Epoch: 6, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.495 Vali Acc: 0.570 Test Loss: 1.495 Test Acc: 0.570
Validation loss decreased (-0.425910 --> -0.570355).  Saving model ...
Epoch: 7 cost time: 0.6266891956329346
Epoch: 7, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.409 Vali Acc: 0.652 Test Loss: 1.409 Test Acc: 0.652
Validation loss decreased (-0.570355 --> -0.651838).  Saving model ...
Epoch: 8 cost time: 0.5883152484893799
Epoch: 8, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.319 Vali Acc: 0.711 Test Loss: 1.319 Test Acc: 0.711
Validation loss decreased (-0.651838 --> -0.711098).  Saving model ...
Epoch: 9 cost time: 0.6287591457366943
Epoch: 9, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.225 Vali Acc: 0.767 Test Loss: 1.225 Test Acc: 0.767
Validation loss decreased (-0.711098 --> -0.766654).  Saving model ...
Epoch: 10 cost time: 0.614999532699585
Epoch: 10, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.133 Vali Acc: 0.815 Test Loss: 1.133 Test Acc: 0.815
Validation loss decreased (-0.766654 --> -0.814803).  Saving model ...
Epoch: 11 cost time: 0.6451027393341064
Epoch: 11, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.041 Vali Acc: 0.844 Test Loss: 1.041 Test Acc: 0.844
Validation loss decreased (-0.814803 --> -0.844434).  Saving model ...
Epoch: 12 cost time: 0.6370911598205566
Epoch: 12, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.956 Vali Acc: 0.856 Test Loss: 0.956 Test Acc: 0.856
Validation loss decreased (-0.844434 --> -0.855546).  Saving model ...
Epoch: 13 cost time: 0.639333963394165
Epoch: 13, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.876 Vali Acc: 0.867 Test Loss: 0.876 Test Acc: 0.867
Validation loss decreased (-0.855546 --> -0.866658).  Saving model ...
Epoch: 14 cost time: 0.7115893363952637
Epoch: 14, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.802 Vali Acc: 0.885 Test Loss: 0.802 Test Acc: 0.885
Validation loss decreased (-0.866658 --> -0.885177).  Saving model ...
Epoch: 15 cost time: 0.585662841796875
Epoch: 15, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.734 Vali Acc: 0.896 Test Loss: 0.734 Test Acc: 0.896
Validation loss decreased (-0.885177 --> -0.896289).  Saving model ...
Epoch: 16 cost time: 0.6448748111724854
Epoch: 16, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.670 Vali Acc: 0.896 Test Loss: 0.670 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896290).  Saving model ...
Epoch: 17 cost time: 0.6031818389892578
Epoch: 17, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.614 Vali Acc: 0.904 Test Loss: 0.614 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 18 cost time: 0.6502916812896729
Epoch: 18, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.562 Vali Acc: 0.911 Test Loss: 0.562 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911105).  Saving model ...
Epoch: 19 cost time: 0.6119179725646973
Epoch: 19, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.518 Vali Acc: 0.915 Test Loss: 0.518 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914810).  Saving model ...
Epoch: 20 cost time: 0.6475832462310791
Epoch: 20, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.479 Vali Acc: 0.915 Test Loss: 0.479 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 21 cost time: 0.6238555908203125
Epoch: 21, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.443 Vali Acc: 0.915 Test Loss: 0.443 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 22 cost time: 0.6484897136688232
Epoch: 22, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.412 Vali Acc: 0.915 Test Loss: 0.412 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 23 cost time: 0.6226601600646973
Epoch: 23, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.384 Vali Acc: 0.915 Test Loss: 0.384 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 24 cost time: 0.6259722709655762
Epoch: 24, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.360 Vali Acc: 0.915 Test Loss: 0.360 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 25 cost time: 0.6301348209381104
Epoch: 25, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.341 Vali Acc: 0.907 Test Loss: 0.341 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6269261837005615
Epoch: 26, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6557223796844482
Epoch: 27, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.311 Vali Acc: 0.907 Test Loss: 0.311 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6801481246948242
Epoch: 28, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.298 Vali Acc: 0.907 Test Loss: 0.298 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6721506118774414
Epoch: 29, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7670741081237793
Epoch: 30, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.277 Vali Acc: 0.907 Test Loss: 0.277 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 1403398
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.441131353378296
Epoch: 1, Steps: 2 | Train Loss: 1.914 Vali Loss: 1.808 Vali Acc: 0.204 Test Loss: 1.808 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.6600711345672607
Epoch: 2, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.756 Vali Acc: 0.252 Test Loss: 1.756 Test Acc: 0.252
Validation loss decreased (-0.203686 --> -0.251834).  Saving model ...
Epoch: 3 cost time: 0.6586990356445312
Epoch: 3, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.710 Vali Acc: 0.278 Test Loss: 1.710 Test Acc: 0.278
Validation loss decreased (-0.251834 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 0.6944222450256348
Epoch: 4, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.654 Vali Acc: 0.341 Test Loss: 1.654 Test Acc: 0.341
Validation loss decreased (-0.277761 --> -0.340724).  Saving model ...
Epoch: 5 cost time: 0.6683392524719238
Epoch: 5, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.584 Vali Acc: 0.385 Test Loss: 1.584 Test Acc: 0.385
Validation loss decreased (-0.340724 --> -0.385169).  Saving model ...
Epoch: 6 cost time: 0.7151672840118408
Epoch: 6, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.503 Vali Acc: 0.489 Test Loss: 1.503 Test Acc: 0.489
Validation loss decreased (-0.385169 --> -0.488874).  Saving model ...
Epoch: 7 cost time: 0.7033030986785889
Epoch: 7, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.415 Vali Acc: 0.578 Test Loss: 1.415 Test Acc: 0.578
Validation loss decreased (-0.488874 --> -0.577764).  Saving model ...
Epoch: 8 cost time: 0.7156691551208496
Epoch: 8, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.324 Vali Acc: 0.648 Test Loss: 1.324 Test Acc: 0.648
Validation loss decreased (-0.577764 --> -0.648135).  Saving model ...
Epoch: 9 cost time: 0.689793586730957
Epoch: 9, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.232 Vali Acc: 0.719 Test Loss: 1.232 Test Acc: 0.719
Validation loss decreased (-0.648135 --> -0.718506).  Saving model ...
Epoch: 10 cost time: 0.6568291187286377
Epoch: 10, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.139 Vali Acc: 0.770 Test Loss: 1.139 Test Acc: 0.770
Validation loss decreased (-0.718506 --> -0.770359).  Saving model ...
Epoch: 11 cost time: 0.7279624938964844
Epoch: 11, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.048 Vali Acc: 0.830 Test Loss: 1.048 Test Acc: 0.830
Validation loss decreased (-0.770359 --> -0.829619).  Saving model ...
Epoch: 12 cost time: 0.7184290885925293
Epoch: 12, Steps: 2 | Train Loss: 0.864 Vali Loss: 0.961 Vali Acc: 0.852 Test Loss: 0.961 Test Acc: 0.852
Validation loss decreased (-0.829619 --> -0.851842).  Saving model ...
Epoch: 13 cost time: 0.7123785018920898
Epoch: 13, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.880 Vali Acc: 0.867 Test Loss: 0.880 Test Acc: 0.867
Validation loss decreased (-0.851842 --> -0.866658).  Saving model ...
Epoch: 14 cost time: 0.7025513648986816
Epoch: 14, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.805 Vali Acc: 0.874 Test Loss: 0.805 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874066).  Saving model ...
Epoch: 15 cost time: 0.7384920120239258
Epoch: 15, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.734 Vali Acc: 0.889 Test Loss: 0.734 Test Acc: 0.889
Validation loss decreased (-0.874066 --> -0.888882).  Saving model ...
Epoch: 16 cost time: 0.6519687175750732
Epoch: 16, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.670 Vali Acc: 0.896 Test Loss: 0.670 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 17 cost time: 0.7124004364013672
Epoch: 17, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.612 Vali Acc: 0.900 Test Loss: 0.612 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 0.747744083404541
Epoch: 18, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.559 Vali Acc: 0.900 Test Loss: 0.559 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 0.694326639175415
Epoch: 19, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.511 Vali Acc: 0.904 Test Loss: 0.511 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903699).  Saving model ...
Epoch: 20 cost time: 0.8385598659515381
Epoch: 20, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.469 Vali Acc: 0.911 Test Loss: 0.469 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911106).  Saving model ...
Epoch: 21 cost time: 0.7370283603668213
Epoch: 21, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.432 Vali Acc: 0.911 Test Loss: 0.432 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 22 cost time: 0.7249798774719238
Epoch: 22, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.399 Vali Acc: 0.911 Test Loss: 0.399 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 23 cost time: 0.6385233402252197
Epoch: 23, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.371 Vali Acc: 0.915 Test Loss: 0.371 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 24 cost time: 0.5501904487609863
Epoch: 24, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.346 Vali Acc: 0.915 Test Loss: 0.346 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 25 cost time: 0.6389377117156982
Epoch: 25, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.326 Vali Acc: 0.915 Test Loss: 0.326 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 26 cost time: 0.625607967376709
Epoch: 26, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.64101243019104
Epoch: 27, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.294 Vali Acc: 0.919 Test Loss: 0.294 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 28 cost time: 0.7060885429382324
Epoch: 28, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925923).  Saving model ...
Epoch: 29 cost time: 0.7244784832000732
Epoch: 29, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.275 Vali Acc: 0.915 Test Loss: 0.275 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.654456615447998
Epoch: 30, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.268 Vali Acc: 0.919 Test Loss: 0.268 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 4713478
model size : 19.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.058683156967163
Epoch: 1, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.785 Vali Acc: 0.178 Test Loss: 1.785 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.5375118255615234
Epoch: 2, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.738 Vali Acc: 0.200 Test Loss: 1.738 Test Acc: 0.200
Validation loss decreased (-0.177760 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 0.55375075340271
Epoch: 3, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.695 Vali Acc: 0.237 Test Loss: 1.695 Test Acc: 0.237
Validation loss decreased (-0.199983 --> -0.237020).  Saving model ...
Epoch: 4 cost time: 0.5449709892272949
Epoch: 4, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.641 Vali Acc: 0.333 Test Loss: 1.641 Test Acc: 0.333
Validation loss decreased (-0.237020 --> -0.333317).  Saving model ...
Epoch: 5 cost time: 0.5946357250213623
Epoch: 5, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.574 Vali Acc: 0.426 Test Loss: 1.574 Test Acc: 0.426
Validation loss decreased (-0.333317 --> -0.425910).  Saving model ...
Epoch: 6 cost time: 0.5395379066467285
Epoch: 6, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.495 Vali Acc: 0.570 Test Loss: 1.495 Test Acc: 0.570
Validation loss decreased (-0.425910 --> -0.570355).  Saving model ...
Epoch: 7 cost time: 0.5748612880706787
Epoch: 7, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.409 Vali Acc: 0.652 Test Loss: 1.409 Test Acc: 0.652
Validation loss decreased (-0.570355 --> -0.651838).  Saving model ...
Epoch: 8 cost time: 0.5184903144836426
Epoch: 8, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.319 Vali Acc: 0.711 Test Loss: 1.319 Test Acc: 0.711
Validation loss decreased (-0.651838 --> -0.711098).  Saving model ...
Epoch: 9 cost time: 0.48813390731811523
Epoch: 9, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.225 Vali Acc: 0.767 Test Loss: 1.225 Test Acc: 0.767
Validation loss decreased (-0.711098 --> -0.766654).  Saving model ...
Epoch: 10 cost time: 0.5310232639312744
Epoch: 10, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.133 Vali Acc: 0.815 Test Loss: 1.133 Test Acc: 0.815
Validation loss decreased (-0.766654 --> -0.814803).  Saving model ...
Epoch: 11 cost time: 0.556894063949585
Epoch: 11, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.041 Vali Acc: 0.844 Test Loss: 1.041 Test Acc: 0.844
Validation loss decreased (-0.814803 --> -0.844434).  Saving model ...
Epoch: 12 cost time: 0.509770393371582
Epoch: 12, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.956 Vali Acc: 0.856 Test Loss: 0.956 Test Acc: 0.856
Validation loss decreased (-0.844434 --> -0.855546).  Saving model ...
Epoch: 13 cost time: 0.5058162212371826
Epoch: 13, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.876 Vali Acc: 0.867 Test Loss: 0.876 Test Acc: 0.867
Validation loss decreased (-0.855546 --> -0.866658).  Saving model ...
Epoch: 14 cost time: 0.514700174331665
Epoch: 14, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.802 Vali Acc: 0.885 Test Loss: 0.802 Test Acc: 0.885
Validation loss decreased (-0.866658 --> -0.885177).  Saving model ...
Epoch: 15 cost time: 0.538517951965332
Epoch: 15, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.734 Vali Acc: 0.896 Test Loss: 0.734 Test Acc: 0.896
Validation loss decreased (-0.885177 --> -0.896289).  Saving model ...
Epoch: 16 cost time: 0.5336391925811768
Epoch: 16, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.670 Vali Acc: 0.896 Test Loss: 0.670 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896290).  Saving model ...
Epoch: 17 cost time: 0.5241074562072754
Epoch: 17, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.614 Vali Acc: 0.904 Test Loss: 0.614 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 18 cost time: 0.5379014015197754
Epoch: 18, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.562 Vali Acc: 0.911 Test Loss: 0.562 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911105).  Saving model ...
Epoch: 19 cost time: 0.5412187576293945
Epoch: 19, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.518 Vali Acc: 0.915 Test Loss: 0.518 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914810).  Saving model ...
Epoch: 20 cost time: 0.5001285076141357
Epoch: 20, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.479 Vali Acc: 0.915 Test Loss: 0.479 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 21 cost time: 0.47748255729675293
Epoch: 21, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.443 Vali Acc: 0.915 Test Loss: 0.443 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 22 cost time: 0.5311264991760254
Epoch: 22, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.412 Vali Acc: 0.915 Test Loss: 0.412 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 23 cost time: 0.5176489353179932
Epoch: 23, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.384 Vali Acc: 0.915 Test Loss: 0.384 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 24 cost time: 0.5038011074066162
Epoch: 24, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.360 Vali Acc: 0.915 Test Loss: 0.360 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 25 cost time: 0.4897897243499756
Epoch: 25, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.341 Vali Acc: 0.907 Test Loss: 0.341 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4708075523376465
Epoch: 26, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4901316165924072
Epoch: 27, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.311 Vali Acc: 0.907 Test Loss: 0.311 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5067658424377441
Epoch: 28, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.298 Vali Acc: 0.907 Test Loss: 0.298 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.48735833168029785
Epoch: 29, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5311315059661865
Epoch: 30, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.277 Vali Acc: 0.907 Test Loss: 0.277 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 1403398
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9757404327392578
Epoch: 1, Steps: 2 | Train Loss: 1.913 Vali Loss: 1.808 Vali Acc: 0.204 Test Loss: 1.808 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.6291904449462891
Epoch: 2, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.756 Vali Acc: 0.248 Test Loss: 1.756 Test Acc: 0.248
Validation loss decreased (-0.203686 --> -0.248131).  Saving model ...
Epoch: 3 cost time: 0.6159114837646484
Epoch: 3, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.710 Vali Acc: 0.285 Test Loss: 1.710 Test Acc: 0.285
Validation loss decreased (-0.248131 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.5686004161834717
Epoch: 4, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.654 Vali Acc: 0.337 Test Loss: 1.654 Test Acc: 0.337
Validation loss decreased (-0.285168 --> -0.337020).  Saving model ...
Epoch: 5 cost time: 0.5547919273376465
Epoch: 5, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.584 Vali Acc: 0.385 Test Loss: 1.584 Test Acc: 0.385
Validation loss decreased (-0.337020 --> -0.385169).  Saving model ...
Epoch: 6 cost time: 0.5741374492645264
Epoch: 6, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.504 Vali Acc: 0.489 Test Loss: 1.504 Test Acc: 0.489
Validation loss decreased (-0.385169 --> -0.488874).  Saving model ...
Epoch: 7 cost time: 0.5500757694244385
Epoch: 7, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.417 Vali Acc: 0.574 Test Loss: 1.417 Test Acc: 0.574
Validation loss decreased (-0.488874 --> -0.574060).  Saving model ...
Epoch: 8 cost time: 0.5799593925476074
Epoch: 8, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.327 Vali Acc: 0.641 Test Loss: 1.327 Test Acc: 0.641
Validation loss decreased (-0.574060 --> -0.640727).  Saving model ...
Epoch: 9 cost time: 0.5710701942443848
Epoch: 9, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.235 Vali Acc: 0.715 Test Loss: 1.235 Test Acc: 0.715
Validation loss decreased (-0.640727 --> -0.714802).  Saving model ...
Epoch: 10 cost time: 0.5963985919952393
Epoch: 10, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.143 Vali Acc: 0.770 Test Loss: 1.143 Test Acc: 0.770
Validation loss decreased (-0.714802 --> -0.770359).  Saving model ...
Epoch: 11 cost time: 0.6363615989685059
Epoch: 11, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.053 Vali Acc: 0.833 Test Loss: 1.053 Test Acc: 0.833
Validation loss decreased (-0.770359 --> -0.833323).  Saving model ...
Epoch: 12 cost time: 0.5758490562438965
Epoch: 12, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.966 Vali Acc: 0.852 Test Loss: 0.966 Test Acc: 0.852
Validation loss decreased (-0.833323 --> -0.851842).  Saving model ...
Epoch: 13 cost time: 0.6212711334228516
Epoch: 13, Steps: 2 | Train Loss: 0.833 Vali Loss: 0.885 Vali Acc: 0.867 Test Loss: 0.885 Test Acc: 0.867
Validation loss decreased (-0.851842 --> -0.866658).  Saving model ...
Epoch: 14 cost time: 0.6093869209289551
Epoch: 14, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.810 Vali Acc: 0.878 Test Loss: 0.810 Test Acc: 0.878
Validation loss decreased (-0.866658 --> -0.877770).  Saving model ...
Epoch: 15 cost time: 0.6169774532318115
Epoch: 15, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.739 Vali Acc: 0.889 Test Loss: 0.739 Test Acc: 0.889
Validation loss decreased (-0.877770 --> -0.888882).  Saving model ...
Epoch: 16 cost time: 0.6562116146087646
Epoch: 16, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.675 Vali Acc: 0.896 Test Loss: 0.675 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 17 cost time: 0.7012937068939209
Epoch: 17, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.617 Vali Acc: 0.900 Test Loss: 0.617 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 0.7404208183288574
Epoch: 18, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 0.677727222442627
Epoch: 19, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.515 Vali Acc: 0.904 Test Loss: 0.515 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903699).  Saving model ...
Epoch: 20 cost time: 0.6442732810974121
Epoch: 20, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.472 Vali Acc: 0.911 Test Loss: 0.472 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911106).  Saving model ...
Epoch: 21 cost time: 0.591163158416748
Epoch: 21, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.435 Vali Acc: 0.907 Test Loss: 0.435 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6084589958190918
Epoch: 22, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.402 Vali Acc: 0.911 Test Loss: 0.402 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 23 cost time: 0.6910741329193115
Epoch: 23, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.373 Vali Acc: 0.915 Test Loss: 0.373 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 24 cost time: 0.5816078186035156
Epoch: 24, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.349 Vali Acc: 0.915 Test Loss: 0.349 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 25 cost time: 0.5950450897216797
Epoch: 25, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.327 Vali Acc: 0.915 Test Loss: 0.327 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 26 cost time: 0.7224588394165039
Epoch: 26, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.310 Vali Acc: 0.915 Test Loss: 0.310 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 27 cost time: 0.6603498458862305
Epoch: 27, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.296 Vali Acc: 0.919 Test Loss: 0.296 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 28 cost time: 0.6762750148773193
Epoch: 28, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922219).  Saving model ...
Epoch: 29 cost time: 0.5951082706451416
Epoch: 29, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6539525985717773
Epoch: 30, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 4713478
model size : 19.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.899294376373291
Epoch: 1, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.786 Vali Acc: 0.178 Test Loss: 1.786 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.4491100311279297
Epoch: 2, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.739 Vali Acc: 0.204 Test Loss: 1.739 Test Acc: 0.204
Validation loss decreased (-0.177760 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.42468714714050293
Epoch: 3, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.696 Vali Acc: 0.237 Test Loss: 1.696 Test Acc: 0.237
Validation loss decreased (-0.203686 --> -0.237020).  Saving model ...
Epoch: 4 cost time: 0.5679712295532227
Epoch: 4, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.642 Vali Acc: 0.330 Test Loss: 1.642 Test Acc: 0.330
Validation loss decreased (-0.237020 --> -0.329613).  Saving model ...
Epoch: 5 cost time: 0.44269514083862305
Epoch: 5, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.576 Vali Acc: 0.426 Test Loss: 1.576 Test Acc: 0.426
Validation loss decreased (-0.329613 --> -0.425910).  Saving model ...
Epoch: 6 cost time: 0.4649538993835449
Epoch: 6, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.497 Vali Acc: 0.567 Test Loss: 1.497 Test Acc: 0.567
Validation loss decreased (-0.425910 --> -0.566652).  Saving model ...
Epoch: 7 cost time: 0.41677141189575195
Epoch: 7, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.412 Vali Acc: 0.648 Test Loss: 1.412 Test Acc: 0.648
Validation loss decreased (-0.566652 --> -0.648134).  Saving model ...
Epoch: 8 cost time: 0.4295976161956787
Epoch: 8, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.322 Vali Acc: 0.711 Test Loss: 1.322 Test Acc: 0.711
Validation loss decreased (-0.648134 --> -0.711098).  Saving model ...
Epoch: 9 cost time: 0.44390368461608887
Epoch: 9, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.229 Vali Acc: 0.767 Test Loss: 1.229 Test Acc: 0.767
Validation loss decreased (-0.711098 --> -0.766654).  Saving model ...
Epoch: 10 cost time: 0.4715414047241211
Epoch: 10, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.136 Vali Acc: 0.815 Test Loss: 1.136 Test Acc: 0.815
Validation loss decreased (-0.766654 --> -0.814803).  Saving model ...
Epoch: 11 cost time: 0.42740964889526367
Epoch: 11, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.045 Vali Acc: 0.844 Test Loss: 1.045 Test Acc: 0.844
Validation loss decreased (-0.814803 --> -0.844434).  Saving model ...
Epoch: 12 cost time: 0.4191744327545166
Epoch: 12, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.960 Vali Acc: 0.856 Test Loss: 0.960 Test Acc: 0.856
Validation loss decreased (-0.844434 --> -0.855546).  Saving model ...
Epoch: 13 cost time: 0.44236135482788086
Epoch: 13, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.880 Vali Acc: 0.863 Test Loss: 0.880 Test Acc: 0.863
Validation loss decreased (-0.855546 --> -0.862954).  Saving model ...
Epoch: 14 cost time: 0.46942996978759766
Epoch: 14, Steps: 2 | Train Loss: 0.716 Vali Loss: 0.806 Vali Acc: 0.881 Test Loss: 0.806 Test Acc: 0.881
Validation loss decreased (-0.862954 --> -0.881473).  Saving model ...
Epoch: 15 cost time: 0.4302027225494385
Epoch: 15, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.737 Vali Acc: 0.893 Test Loss: 0.737 Test Acc: 0.893
Validation loss decreased (-0.881473 --> -0.892585).  Saving model ...
Epoch: 16 cost time: 0.42546606063842773
Epoch: 16, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.674 Vali Acc: 0.893 Test Loss: 0.674 Test Acc: 0.893
Validation loss decreased (-0.892585 --> -0.892586).  Saving model ...
Epoch: 17 cost time: 0.4196934700012207
Epoch: 17, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.617 Vali Acc: 0.904 Test Loss: 0.617 Test Acc: 0.904
Validation loss decreased (-0.892586 --> -0.903698).  Saving model ...
Epoch: 18 cost time: 0.4706735610961914
Epoch: 18, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.565 Vali Acc: 0.911 Test Loss: 0.565 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911105).  Saving model ...
Epoch: 19 cost time: 0.42494678497314453
Epoch: 19, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.521 Vali Acc: 0.915 Test Loss: 0.521 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914810).  Saving model ...
Epoch: 20 cost time: 0.44403624534606934
Epoch: 20, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.482 Vali Acc: 0.915 Test Loss: 0.482 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 21 cost time: 0.4869508743286133
Epoch: 21, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.446 Vali Acc: 0.915 Test Loss: 0.446 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 22 cost time: 0.45247673988342285
Epoch: 22, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.415 Vali Acc: 0.915 Test Loss: 0.415 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 23 cost time: 0.4417881965637207
Epoch: 23, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.387 Vali Acc: 0.911 Test Loss: 0.387 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.43195366859436035
Epoch: 24, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.363 Vali Acc: 0.911 Test Loss: 0.363 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.48326826095581055
Epoch: 25, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.343 Vali Acc: 0.907 Test Loss: 0.343 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4626460075378418
Epoch: 26, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.328 Vali Acc: 0.907 Test Loss: 0.328 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.44502878189086914
Epoch: 27, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.314 Vali Acc: 0.907 Test Loss: 0.314 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.44153571128845215
Epoch: 28, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.301 Vali Acc: 0.904 Test Loss: 0.301 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.43685102462768555
Epoch: 29, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.289 Vali Acc: 0.907 Test Loss: 0.289 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4337151050567627
Epoch: 30, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.280 Vali Acc: 0.907 Test Loss: 0.280 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 1403398
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.337794303894043
Epoch: 1, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.809 Vali Acc: 0.300 Test Loss: 1.809 Test Acc: 0.300
Validation loss decreased (inf --> -0.299982).  Saving model ...
Epoch: 2 cost time: 0.7499861717224121
Epoch: 2, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.773 Vali Acc: 0.322 Test Loss: 1.773 Test Acc: 0.322
Validation loss decreased (-0.299982 --> -0.322204).  Saving model ...
Epoch: 3 cost time: 0.7125492095947266
Epoch: 3, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.742 Vali Acc: 0.333 Test Loss: 1.742 Test Acc: 0.333
Validation loss decreased (-0.322204 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 0.7486116886138916
Epoch: 4, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.708 Vali Acc: 0.367 Test Loss: 1.708 Test Acc: 0.367
Validation loss decreased (-0.333316 --> -0.366650).  Saving model ...
Epoch: 5 cost time: 0.74017333984375
Epoch: 5, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.664 Vali Acc: 0.396 Test Loss: 1.664 Test Acc: 0.396
Validation loss decreased (-0.366650 --> -0.396280).  Saving model ...
Epoch: 6 cost time: 0.7254815101623535
Epoch: 6, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.614 Vali Acc: 0.437 Test Loss: 1.614 Test Acc: 0.437
Validation loss decreased (-0.396280 --> -0.437021).  Saving model ...
Epoch: 7 cost time: 0.6471495628356934
Epoch: 7, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.559 Vali Acc: 0.500 Test Loss: 1.559 Test Acc: 0.500
Validation loss decreased (-0.437021 --> -0.499984).  Saving model ...
Epoch: 8 cost time: 0.6812357902526855
Epoch: 8, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.499 Vali Acc: 0.589 Test Loss: 1.499 Test Acc: 0.589
Validation loss decreased (-0.499984 --> -0.588874).  Saving model ...
Epoch: 9 cost time: 0.6359503269195557
Epoch: 9, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.437 Vali Acc: 0.659 Test Loss: 1.437 Test Acc: 0.659
Validation loss decreased (-0.588874 --> -0.659245).  Saving model ...
Epoch: 10 cost time: 0.7094690799713135
Epoch: 10, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.371 Vali Acc: 0.737 Test Loss: 1.371 Test Acc: 0.737
Validation loss decreased (-0.659245 --> -0.737023).  Saving model ...
Epoch: 11 cost time: 0.7257263660430908
Epoch: 11, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.305 Vali Acc: 0.741 Test Loss: 1.305 Test Acc: 0.741
Validation loss decreased (-0.737023 --> -0.740728).  Saving model ...
Epoch: 12 cost time: 0.7490973472595215
Epoch: 12, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.237 Vali Acc: 0.767 Test Loss: 1.237 Test Acc: 0.767
Validation loss decreased (-0.740728 --> -0.766654).  Saving model ...
Epoch: 13 cost time: 0.8123326301574707
Epoch: 13, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.169 Vali Acc: 0.800 Test Loss: 1.169 Test Acc: 0.800
Validation loss decreased (-0.766654 --> -0.799988).  Saving model ...
Epoch: 14 cost time: 0.7349932193756104
Epoch: 14, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.102 Vali Acc: 0.815 Test Loss: 1.102 Test Acc: 0.815
Validation loss decreased (-0.799988 --> -0.814804).  Saving model ...
Epoch: 15 cost time: 0.7493422031402588
Epoch: 15, Steps: 2 | Train Loss: 0.943 Vali Loss: 1.037 Vali Acc: 0.830 Test Loss: 1.037 Test Acc: 0.830
Validation loss decreased (-0.814804 --> -0.829619).  Saving model ...
Epoch: 16 cost time: 0.7292225360870361
Epoch: 16, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.972 Vali Acc: 0.833 Test Loss: 0.972 Test Acc: 0.833
Validation loss decreased (-0.829619 --> -0.833324).  Saving model ...
Epoch: 17 cost time: 0.7378618717193604
Epoch: 17, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.910 Vali Acc: 0.848 Test Loss: 0.910 Test Acc: 0.848
Validation loss decreased (-0.833324 --> -0.848139).  Saving model ...
Epoch: 18 cost time: 0.7707922458648682
Epoch: 18, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.849 Vali Acc: 0.870 Test Loss: 0.849 Test Acc: 0.870
Validation loss decreased (-0.848139 --> -0.870362).  Saving model ...
Epoch: 19 cost time: 0.7876222133636475
Epoch: 19, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.794 Vali Acc: 0.874 Test Loss: 0.794 Test Acc: 0.874
Validation loss decreased (-0.870362 --> -0.874066).  Saving model ...
Epoch: 20 cost time: 0.7450623512268066
Epoch: 20, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.742 Vali Acc: 0.874 Test Loss: 0.742 Test Acc: 0.874
Validation loss decreased (-0.874066 --> -0.874067).  Saving model ...
Epoch: 21 cost time: 0.7540569305419922
Epoch: 21, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.694 Vali Acc: 0.896 Test Loss: 0.694 Test Acc: 0.896
Validation loss decreased (-0.874067 --> -0.896289).  Saving model ...
Epoch: 22 cost time: 0.7596032619476318
Epoch: 22, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.648 Vali Acc: 0.896 Test Loss: 0.648 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896290).  Saving model ...
Epoch: 23 cost time: 0.7577066421508789
Epoch: 23, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.608 Vali Acc: 0.900 Test Loss: 0.608 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.7641348838806152
Epoch: 24, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.570 Vali Acc: 0.907 Test Loss: 0.570 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 25 cost time: 0.7776517868041992
Epoch: 25, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.536 Vali Acc: 0.911 Test Loss: 0.536 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 26 cost time: 0.7549576759338379
Epoch: 26, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.505 Vali Acc: 0.915 Test Loss: 0.505 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 27 cost time: 0.7453227043151855
Epoch: 27, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.477 Vali Acc: 0.911 Test Loss: 0.477 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7502894401550293
Epoch: 28, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.453 Vali Acc: 0.907 Test Loss: 0.453 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.781580924987793
Epoch: 29, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.432 Vali Acc: 0.907 Test Loss: 0.432 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7100145816802979
Epoch: 30, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.413 Vali Acc: 0.907 Test Loss: 0.413 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 4700806
model size : 18.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1949892044067383
Epoch: 1, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.744 Vali Acc: 0.330 Test Loss: 1.744 Test Acc: 0.330
Validation loss decreased (inf --> -0.329612).  Saving model ...
Epoch: 2 cost time: 0.5861058235168457
Epoch: 2, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.704 Vali Acc: 0.381 Test Loss: 1.704 Test Acc: 0.381
Validation loss decreased (-0.329612 --> -0.381464).  Saving model ...
Epoch: 3 cost time: 0.5611412525177002
Epoch: 3, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.672 Vali Acc: 0.415 Test Loss: 1.672 Test Acc: 0.415
Validation loss decreased (-0.381464 --> -0.414798).  Saving model ...
Epoch: 4 cost time: 0.5877034664154053
Epoch: 4, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.638 Vali Acc: 0.437 Test Loss: 1.638 Test Acc: 0.437
Validation loss decreased (-0.414798 --> -0.437021).  Saving model ...
Epoch: 5 cost time: 0.5862007141113281
Epoch: 5, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.595 Vali Acc: 0.470 Test Loss: 1.595 Test Acc: 0.470
Validation loss decreased (-0.437021 --> -0.470354).  Saving model ...
Epoch: 6 cost time: 0.5721385478973389
Epoch: 6, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.544 Vali Acc: 0.522 Test Loss: 1.544 Test Acc: 0.522
Validation loss decreased (-0.470354 --> -0.522207).  Saving model ...
Epoch: 7 cost time: 0.5916364192962646
Epoch: 7, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.489 Vali Acc: 0.567 Test Loss: 1.489 Test Acc: 0.567
Validation loss decreased (-0.522207 --> -0.566652).  Saving model ...
Epoch: 8 cost time: 0.5742893218994141
Epoch: 8, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.429 Vali Acc: 0.604 Test Loss: 1.429 Test Acc: 0.604
Validation loss decreased (-0.566652 --> -0.603689).  Saving model ...
Epoch: 9 cost time: 0.5886952877044678
Epoch: 9, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.366 Vali Acc: 0.637 Test Loss: 1.366 Test Acc: 0.637
Validation loss decreased (-0.603689 --> -0.637023).  Saving model ...
Epoch: 10 cost time: 0.6096203327178955
Epoch: 10, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.301 Vali Acc: 0.667 Test Loss: 1.301 Test Acc: 0.667
Validation loss decreased (-0.637023 --> -0.666654).  Saving model ...
Epoch: 11 cost time: 0.5887093544006348
Epoch: 11, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.236 Vali Acc: 0.707 Test Loss: 1.236 Test Acc: 0.707
Validation loss decreased (-0.666654 --> -0.707395).  Saving model ...
Epoch: 12 cost time: 0.5685060024261475
Epoch: 12, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.169 Vali Acc: 0.733 Test Loss: 1.169 Test Acc: 0.733
Validation loss decreased (-0.707395 --> -0.733322).  Saving model ...
Epoch: 13 cost time: 0.5822927951812744
Epoch: 13, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.103 Vali Acc: 0.767 Test Loss: 1.103 Test Acc: 0.767
Validation loss decreased (-0.733322 --> -0.766656).  Saving model ...
Epoch: 14 cost time: 0.6350479125976562
Epoch: 14, Steps: 2 | Train Loss: 0.931 Vali Loss: 1.038 Vali Acc: 0.815 Test Loss: 1.038 Test Acc: 0.815
Validation loss decreased (-0.766656 --> -0.814804).  Saving model ...
Epoch: 15 cost time: 0.6067581176757812
Epoch: 15, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.975 Vali Acc: 0.822 Test Loss: 0.975 Test Acc: 0.822
Validation loss decreased (-0.814804 --> -0.822212).  Saving model ...
Epoch: 16 cost time: 0.6080858707427979
Epoch: 16, Steps: 2 | Train Loss: 0.821 Vali Loss: 0.916 Vali Acc: 0.844 Test Loss: 0.916 Test Acc: 0.844
Validation loss decreased (-0.822212 --> -0.844435).  Saving model ...
Epoch: 17 cost time: 0.5956103801727295
Epoch: 17, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.860 Vali Acc: 0.863 Test Loss: 0.860 Test Acc: 0.863
Validation loss decreased (-0.844435 --> -0.862954).  Saving model ...
Epoch: 18 cost time: 0.6065173149108887
Epoch: 18, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.806 Vali Acc: 0.870 Test Loss: 0.806 Test Acc: 0.870
Validation loss decreased (-0.862954 --> -0.870362).  Saving model ...
Epoch: 19 cost time: 0.5788986682891846
Epoch: 19, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.755 Vali Acc: 0.885 Test Loss: 0.755 Test Acc: 0.885
Validation loss decreased (-0.870362 --> -0.885178).  Saving model ...
Epoch: 20 cost time: 0.6570546627044678
Epoch: 20, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.706 Vali Acc: 0.893 Test Loss: 0.706 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 21 cost time: 0.5804693698883057
Epoch: 21, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.661 Vali Acc: 0.889 Test Loss: 0.661 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6012542247772217
Epoch: 22, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.619 Vali Acc: 0.893 Test Loss: 0.619 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 23 cost time: 0.5827176570892334
Epoch: 23, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.582 Vali Acc: 0.893 Test Loss: 0.582 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892587).  Saving model ...
Epoch: 24 cost time: 0.5986511707305908
Epoch: 24, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.547 Vali Acc: 0.896 Test Loss: 0.547 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 25 cost time: 0.5879166126251221
Epoch: 25, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.580763578414917
Epoch: 26, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.5887265205383301
Epoch: 27, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.461 Vali Acc: 0.904 Test Loss: 0.461 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 28 cost time: 0.5878491401672363
Epoch: 28, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.439 Vali Acc: 0.907 Test Loss: 0.439 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 29 cost time: 0.6152548789978027
Epoch: 29, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.419 Vali Acc: 0.907 Test Loss: 0.419 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 30 cost time: 0.6033687591552734
Epoch: 30, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.401 Vali Acc: 0.907 Test Loss: 0.401 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 1390598
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.238109588623047
Epoch: 1, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.809 Vali Acc: 0.300 Test Loss: 1.809 Test Acc: 0.300
Validation loss decreased (inf --> -0.299982).  Saving model ...
Epoch: 2 cost time: 0.679840087890625
Epoch: 2, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.773 Vali Acc: 0.322 Test Loss: 1.773 Test Acc: 0.322
Validation loss decreased (-0.299982 --> -0.322204).  Saving model ...
Epoch: 3 cost time: 0.6717584133148193
Epoch: 3, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.742 Vali Acc: 0.333 Test Loss: 1.742 Test Acc: 0.333
Validation loss decreased (-0.322204 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 0.6701254844665527
Epoch: 4, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.708 Vali Acc: 0.367 Test Loss: 1.708 Test Acc: 0.367
Validation loss decreased (-0.333316 --> -0.366650).  Saving model ...
Epoch: 5 cost time: 0.6619586944580078
Epoch: 5, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.664 Vali Acc: 0.396 Test Loss: 1.664 Test Acc: 0.396
Validation loss decreased (-0.366650 --> -0.396280).  Saving model ...
Epoch: 6 cost time: 0.6481366157531738
Epoch: 6, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.614 Vali Acc: 0.437 Test Loss: 1.614 Test Acc: 0.437
Validation loss decreased (-0.396280 --> -0.437021).  Saving model ...
Epoch: 7 cost time: 0.6479949951171875
Epoch: 7, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.559 Vali Acc: 0.500 Test Loss: 1.559 Test Acc: 0.500
Validation loss decreased (-0.437021 --> -0.499984).  Saving model ...
Epoch: 8 cost time: 0.603940486907959
Epoch: 8, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.499 Vali Acc: 0.589 Test Loss: 1.499 Test Acc: 0.589
Validation loss decreased (-0.499984 --> -0.588874).  Saving model ...
Epoch: 9 cost time: 0.6122446060180664
Epoch: 9, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.437 Vali Acc: 0.659 Test Loss: 1.437 Test Acc: 0.659
Validation loss decreased (-0.588874 --> -0.659245).  Saving model ...
Epoch: 10 cost time: 0.6831238269805908
Epoch: 10, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.371 Vali Acc: 0.737 Test Loss: 1.371 Test Acc: 0.737
Validation loss decreased (-0.659245 --> -0.737023).  Saving model ...
Epoch: 11 cost time: 0.6356565952301025
Epoch: 11, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.305 Vali Acc: 0.741 Test Loss: 1.305 Test Acc: 0.741
Validation loss decreased (-0.737023 --> -0.740728).  Saving model ...
Epoch: 12 cost time: 0.6706337928771973
Epoch: 12, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.237 Vali Acc: 0.767 Test Loss: 1.237 Test Acc: 0.767
Validation loss decreased (-0.740728 --> -0.766654).  Saving model ...
Epoch: 13 cost time: 0.6387100219726562
Epoch: 13, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.169 Vali Acc: 0.800 Test Loss: 1.169 Test Acc: 0.800
Validation loss decreased (-0.766654 --> -0.799988).  Saving model ...
Epoch: 14 cost time: 0.6197314262390137
Epoch: 14, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.102 Vali Acc: 0.815 Test Loss: 1.102 Test Acc: 0.815
Validation loss decreased (-0.799988 --> -0.814804).  Saving model ...
Epoch: 15 cost time: 0.5688457489013672
Epoch: 15, Steps: 2 | Train Loss: 0.943 Vali Loss: 1.037 Vali Acc: 0.830 Test Loss: 1.037 Test Acc: 0.830
Validation loss decreased (-0.814804 --> -0.829619).  Saving model ...
Epoch: 16 cost time: 0.6231708526611328
Epoch: 16, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.972 Vali Acc: 0.833 Test Loss: 0.972 Test Acc: 0.833
Validation loss decreased (-0.829619 --> -0.833324).  Saving model ...
Epoch: 17 cost time: 0.6013524532318115
Epoch: 17, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.910 Vali Acc: 0.848 Test Loss: 0.910 Test Acc: 0.848
Validation loss decreased (-0.833324 --> -0.848139).  Saving model ...
Epoch: 18 cost time: 0.683441162109375
Epoch: 18, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.849 Vali Acc: 0.870 Test Loss: 0.849 Test Acc: 0.870
Validation loss decreased (-0.848139 --> -0.870362).  Saving model ...
Epoch: 19 cost time: 0.6168193817138672
Epoch: 19, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.794 Vali Acc: 0.874 Test Loss: 0.794 Test Acc: 0.874
Validation loss decreased (-0.870362 --> -0.874066).  Saving model ...
Epoch: 20 cost time: 0.6734914779663086
Epoch: 20, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.742 Vali Acc: 0.874 Test Loss: 0.742 Test Acc: 0.874
Validation loss decreased (-0.874066 --> -0.874067).  Saving model ...
Epoch: 21 cost time: 0.6641108989715576
Epoch: 21, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.694 Vali Acc: 0.896 Test Loss: 0.694 Test Acc: 0.896
Validation loss decreased (-0.874067 --> -0.896289).  Saving model ...
Epoch: 22 cost time: 0.648745059967041
Epoch: 22, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.648 Vali Acc: 0.896 Test Loss: 0.648 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896290).  Saving model ...
Epoch: 23 cost time: 0.6513988971710205
Epoch: 23, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.608 Vali Acc: 0.900 Test Loss: 0.608 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.673969030380249
Epoch: 24, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.570 Vali Acc: 0.907 Test Loss: 0.570 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 25 cost time: 0.6314165592193604
Epoch: 25, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.536 Vali Acc: 0.911 Test Loss: 0.536 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 26 cost time: 0.6479060649871826
Epoch: 26, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.505 Vali Acc: 0.915 Test Loss: 0.505 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 27 cost time: 0.6684765815734863
Epoch: 27, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.477 Vali Acc: 0.911 Test Loss: 0.477 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6452016830444336
Epoch: 28, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.453 Vali Acc: 0.907 Test Loss: 0.453 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.688065767288208
Epoch: 29, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.432 Vali Acc: 0.907 Test Loss: 0.432 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6470005512237549
Epoch: 30, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.413 Vali Acc: 0.907 Test Loss: 0.413 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 4700806
model size : 18.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0852763652801514
Epoch: 1, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.744 Vali Acc: 0.330 Test Loss: 1.744 Test Acc: 0.330
Validation loss decreased (inf --> -0.329612).  Saving model ...
Epoch: 2 cost time: 0.5548074245452881
Epoch: 2, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.704 Vali Acc: 0.381 Test Loss: 1.704 Test Acc: 0.381
Validation loss decreased (-0.329612 --> -0.381464).  Saving model ...
Epoch: 3 cost time: 0.533332109451294
Epoch: 3, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.672 Vali Acc: 0.415 Test Loss: 1.672 Test Acc: 0.415
Validation loss decreased (-0.381464 --> -0.414798).  Saving model ...
Epoch: 4 cost time: 0.5788846015930176
Epoch: 4, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.638 Vali Acc: 0.437 Test Loss: 1.638 Test Acc: 0.437
Validation loss decreased (-0.414798 --> -0.437021).  Saving model ...
Epoch: 5 cost time: 0.5746464729309082
Epoch: 5, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.595 Vali Acc: 0.470 Test Loss: 1.595 Test Acc: 0.470
Validation loss decreased (-0.437021 --> -0.470354).  Saving model ...
Epoch: 6 cost time: 0.5648224353790283
Epoch: 6, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.544 Vali Acc: 0.522 Test Loss: 1.544 Test Acc: 0.522
Validation loss decreased (-0.470354 --> -0.522207).  Saving model ...
Epoch: 7 cost time: 0.5313906669616699
Epoch: 7, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.489 Vali Acc: 0.567 Test Loss: 1.489 Test Acc: 0.567
Validation loss decreased (-0.522207 --> -0.566652).  Saving model ...
Epoch: 8 cost time: 0.5903184413909912
Epoch: 8, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.429 Vali Acc: 0.604 Test Loss: 1.429 Test Acc: 0.604
Validation loss decreased (-0.566652 --> -0.603689).  Saving model ...
Epoch: 9 cost time: 0.5740053653717041
Epoch: 9, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.366 Vali Acc: 0.637 Test Loss: 1.366 Test Acc: 0.637
Validation loss decreased (-0.603689 --> -0.637023).  Saving model ...
Epoch: 10 cost time: 0.582317590713501
Epoch: 10, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.301 Vali Acc: 0.667 Test Loss: 1.301 Test Acc: 0.667
Validation loss decreased (-0.637023 --> -0.666654).  Saving model ...
Epoch: 11 cost time: 0.6171016693115234
Epoch: 11, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.236 Vali Acc: 0.707 Test Loss: 1.236 Test Acc: 0.707
Validation loss decreased (-0.666654 --> -0.707395).  Saving model ...
Epoch: 12 cost time: 0.5645039081573486
Epoch: 12, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.169 Vali Acc: 0.733 Test Loss: 1.169 Test Acc: 0.733
Validation loss decreased (-0.707395 --> -0.733322).  Saving model ...
Epoch: 13 cost time: 0.578324556350708
Epoch: 13, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.103 Vali Acc: 0.767 Test Loss: 1.103 Test Acc: 0.767
Validation loss decreased (-0.733322 --> -0.766656).  Saving model ...
Epoch: 14 cost time: 0.5408987998962402
Epoch: 14, Steps: 2 | Train Loss: 0.931 Vali Loss: 1.038 Vali Acc: 0.815 Test Loss: 1.038 Test Acc: 0.815
Validation loss decreased (-0.766656 --> -0.814804).  Saving model ...
Epoch: 15 cost time: 0.5657355785369873
Epoch: 15, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.975 Vali Acc: 0.822 Test Loss: 0.975 Test Acc: 0.822
Validation loss decreased (-0.814804 --> -0.822212).  Saving model ...
Epoch: 16 cost time: 0.5653955936431885
Epoch: 16, Steps: 2 | Train Loss: 0.821 Vali Loss: 0.916 Vali Acc: 0.844 Test Loss: 0.916 Test Acc: 0.844
Validation loss decreased (-0.822212 --> -0.844435).  Saving model ...
Epoch: 17 cost time: 0.5296421051025391
Epoch: 17, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.860 Vali Acc: 0.863 Test Loss: 0.860 Test Acc: 0.863
Validation loss decreased (-0.844435 --> -0.862954).  Saving model ...
Epoch: 18 cost time: 0.5456380844116211
Epoch: 18, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.806 Vali Acc: 0.870 Test Loss: 0.806 Test Acc: 0.870
Validation loss decreased (-0.862954 --> -0.870362).  Saving model ...
Epoch: 19 cost time: 0.5925648212432861
Epoch: 19, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.755 Vali Acc: 0.885 Test Loss: 0.755 Test Acc: 0.885
Validation loss decreased (-0.870362 --> -0.885178).  Saving model ...
Epoch: 20 cost time: 0.5542373657226562
Epoch: 20, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.706 Vali Acc: 0.893 Test Loss: 0.706 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 21 cost time: 0.508946418762207
Epoch: 21, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.661 Vali Acc: 0.889 Test Loss: 0.661 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5563795566558838
Epoch: 22, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.619 Vali Acc: 0.893 Test Loss: 0.619 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 23 cost time: 0.5394866466522217
Epoch: 23, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.582 Vali Acc: 0.893 Test Loss: 0.582 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892587).  Saving model ...
Epoch: 24 cost time: 0.5301570892333984
Epoch: 24, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.547 Vali Acc: 0.896 Test Loss: 0.547 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 25 cost time: 0.5673937797546387
Epoch: 25, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.5472476482391357
Epoch: 26, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.5693137645721436
Epoch: 27, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.461 Vali Acc: 0.904 Test Loss: 0.461 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 28 cost time: 0.5563883781433105
Epoch: 28, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.439 Vali Acc: 0.907 Test Loss: 0.439 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 29 cost time: 0.5395627021789551
Epoch: 29, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.419 Vali Acc: 0.907 Test Loss: 0.419 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 30 cost time: 0.5399761199951172
Epoch: 30, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.401 Vali Acc: 0.907 Test Loss: 0.401 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 1390598
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.043003559112549
Epoch: 1, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.808 Vali Acc: 0.304 Test Loss: 1.808 Test Acc: 0.304
Validation loss decreased (inf --> -0.303686).  Saving model ...
Epoch: 2 cost time: 0.555992603302002
Epoch: 2, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.772 Vali Acc: 0.326 Test Loss: 1.772 Test Acc: 0.326
Validation loss decreased (-0.303686 --> -0.325908).  Saving model ...
Epoch: 3 cost time: 0.58062744140625
Epoch: 3, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.742 Vali Acc: 0.341 Test Loss: 1.742 Test Acc: 0.341
Validation loss decreased (-0.325908 --> -0.340723).  Saving model ...
Epoch: 4 cost time: 0.5912737846374512
Epoch: 4, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.709 Vali Acc: 0.363 Test Loss: 1.709 Test Acc: 0.363
Validation loss decreased (-0.340723 --> -0.362946).  Saving model ...
Epoch: 5 cost time: 0.5728073120117188
Epoch: 5, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.666 Vali Acc: 0.396 Test Loss: 1.666 Test Acc: 0.396
Validation loss decreased (-0.362946 --> -0.396280).  Saving model ...
Epoch: 6 cost time: 0.5456676483154297
Epoch: 6, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.617 Vali Acc: 0.430 Test Loss: 1.617 Test Acc: 0.430
Validation loss decreased (-0.396280 --> -0.429613).  Saving model ...
Epoch: 7 cost time: 0.5714676380157471
Epoch: 7, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.562 Vali Acc: 0.493 Test Loss: 1.562 Test Acc: 0.493
Validation loss decreased (-0.429613 --> -0.492577).  Saving model ...
Epoch: 8 cost time: 0.5433282852172852
Epoch: 8, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.504 Vali Acc: 0.578 Test Loss: 1.504 Test Acc: 0.578
Validation loss decreased (-0.492577 --> -0.577763).  Saving model ...
Epoch: 9 cost time: 0.5663690567016602
Epoch: 9, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.443 Vali Acc: 0.656 Test Loss: 1.443 Test Acc: 0.656
Validation loss decreased (-0.577763 --> -0.655541).  Saving model ...
Epoch: 10 cost time: 0.6155796051025391
Epoch: 10, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.379 Vali Acc: 0.726 Test Loss: 1.379 Test Acc: 0.726
Validation loss decreased (-0.655541 --> -0.725912).  Saving model ...
Epoch: 11 cost time: 0.5827953815460205
Epoch: 11, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.313 Vali Acc: 0.737 Test Loss: 1.313 Test Acc: 0.737
Validation loss decreased (-0.725912 --> -0.737024).  Saving model ...
Epoch: 12 cost time: 0.5851662158966064
Epoch: 12, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.246 Vali Acc: 0.774 Test Loss: 1.246 Test Acc: 0.774
Validation loss decreased (-0.737024 --> -0.774062).  Saving model ...
Epoch: 13 cost time: 0.5780289173126221
Epoch: 13, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.179 Vali Acc: 0.800 Test Loss: 1.179 Test Acc: 0.800
Validation loss decreased (-0.774062 --> -0.799988).  Saving model ...
Epoch: 14 cost time: 0.5821681022644043
Epoch: 14, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.114 Vali Acc: 0.819 Test Loss: 1.114 Test Acc: 0.819
Validation loss decreased (-0.799988 --> -0.818507).  Saving model ...
Epoch: 15 cost time: 0.5461792945861816
Epoch: 15, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.049 Vali Acc: 0.833 Test Loss: 1.049 Test Acc: 0.833
Validation loss decreased (-0.818507 --> -0.833323).  Saving model ...
Epoch: 16 cost time: 0.5626399517059326
Epoch: 16, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.985 Vali Acc: 0.833 Test Loss: 0.985 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833323).  Saving model ...
Epoch: 17 cost time: 0.5809154510498047
Epoch: 17, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.923 Vali Acc: 0.844 Test Loss: 0.923 Test Acc: 0.844
Validation loss decreased (-0.833323 --> -0.844435).  Saving model ...
Epoch: 18 cost time: 0.6062967777252197
Epoch: 18, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.862 Vali Acc: 0.867 Test Loss: 0.862 Test Acc: 0.867
Validation loss decreased (-0.844435 --> -0.866658).  Saving model ...
Epoch: 19 cost time: 0.5534031391143799
Epoch: 19, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.807 Vali Acc: 0.881 Test Loss: 0.807 Test Acc: 0.881
Validation loss decreased (-0.866658 --> -0.881473).  Saving model ...
Epoch: 20 cost time: 0.5788848400115967
Epoch: 20, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.756 Vali Acc: 0.878 Test Loss: 0.756 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5634524822235107
Epoch: 21, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.707 Vali Acc: 0.900 Test Loss: 0.707 Test Acc: 0.900
Validation loss decreased (-0.881473 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.5868000984191895
Epoch: 22, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.661 Vali Acc: 0.915 Test Loss: 0.661 Test Acc: 0.915
Validation loss decreased (-0.899993 --> -0.914808).  Saving model ...
Epoch: 23 cost time: 0.5740211009979248
Epoch: 23, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.620 Vali Acc: 0.904 Test Loss: 0.620 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5552241802215576
Epoch: 24, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.582 Vali Acc: 0.907 Test Loss: 0.582 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5749080181121826
Epoch: 25, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.548 Vali Acc: 0.907 Test Loss: 0.548 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5580103397369385
Epoch: 26, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.516 Vali Acc: 0.911 Test Loss: 0.516 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5989305973052979
Epoch: 27, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.487 Vali Acc: 0.915 Test Loss: 0.487 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914810).  Saving model ...
Epoch: 28 cost time: 0.5764162540435791
Epoch: 28, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.461 Vali Acc: 0.915 Test Loss: 0.461 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 29 cost time: 0.6271109580993652
Epoch: 29, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.438 Vali Acc: 0.919 Test Loss: 0.438 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 30 cost time: 0.5517735481262207
Epoch: 30, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.417 Vali Acc: 0.919 Test Loss: 0.417 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 4700806
model size : 18.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8456926345825195
Epoch: 1, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.745 Vali Acc: 0.330 Test Loss: 1.745 Test Acc: 0.330
Validation loss decreased (inf --> -0.329612).  Saving model ...
Epoch: 2 cost time: 0.488206148147583
Epoch: 2, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.705 Vali Acc: 0.381 Test Loss: 1.705 Test Acc: 0.381
Validation loss decreased (-0.329612 --> -0.381464).  Saving model ...
Epoch: 3 cost time: 0.47088623046875
Epoch: 3, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.673 Vali Acc: 0.415 Test Loss: 1.673 Test Acc: 0.415
Validation loss decreased (-0.381464 --> -0.414798).  Saving model ...
Epoch: 4 cost time: 0.5130372047424316
Epoch: 4, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.639 Vali Acc: 0.437 Test Loss: 1.639 Test Acc: 0.437
Validation loss decreased (-0.414798 --> -0.437021).  Saving model ...
Epoch: 5 cost time: 0.4605553150177002
Epoch: 5, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.597 Vali Acc: 0.470 Test Loss: 1.597 Test Acc: 0.470
Validation loss decreased (-0.437021 --> -0.470354).  Saving model ...
Epoch: 6 cost time: 0.4704747200012207
Epoch: 6, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.548 Vali Acc: 0.507 Test Loss: 1.548 Test Acc: 0.507
Validation loss decreased (-0.470354 --> -0.507392).  Saving model ...
Epoch: 7 cost time: 0.47679901123046875
Epoch: 7, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.493 Vali Acc: 0.563 Test Loss: 1.493 Test Acc: 0.563
Validation loss decreased (-0.507392 --> -0.562948).  Saving model ...
Epoch: 8 cost time: 0.4934043884277344
Epoch: 8, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.435 Vali Acc: 0.604 Test Loss: 1.435 Test Acc: 0.604
Validation loss decreased (-0.562948 --> -0.603689).  Saving model ...
Epoch: 9 cost time: 0.5033719539642334
Epoch: 9, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.373 Vali Acc: 0.633 Test Loss: 1.373 Test Acc: 0.633
Validation loss decreased (-0.603689 --> -0.633320).  Saving model ...
Epoch: 10 cost time: 0.45632123947143555
Epoch: 10, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.309 Vali Acc: 0.667 Test Loss: 1.309 Test Acc: 0.667
Validation loss decreased (-0.633320 --> -0.666654).  Saving model ...
Epoch: 11 cost time: 0.48444104194641113
Epoch: 11, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.244 Vali Acc: 0.700 Test Loss: 1.244 Test Acc: 0.700
Validation loss decreased (-0.666654 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 0.46056580543518066
Epoch: 12, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.179 Vali Acc: 0.730 Test Loss: 1.179 Test Acc: 0.730
Validation loss decreased (-0.699988 --> -0.729618).  Saving model ...
Epoch: 13 cost time: 0.4670233726501465
Epoch: 13, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.114 Vali Acc: 0.763 Test Loss: 1.114 Test Acc: 0.763
Validation loss decreased (-0.729618 --> -0.762952).  Saving model ...
Epoch: 14 cost time: 0.45297861099243164
Epoch: 14, Steps: 2 | Train Loss: 0.941 Vali Loss: 1.050 Vali Acc: 0.807 Test Loss: 1.050 Test Acc: 0.807
Validation loss decreased (-0.762952 --> -0.807397).  Saving model ...
Epoch: 15 cost time: 0.4381241798400879
Epoch: 15, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.988 Vali Acc: 0.819 Test Loss: 0.988 Test Acc: 0.819
Validation loss decreased (-0.807397 --> -0.818509).  Saving model ...
Epoch: 16 cost time: 0.46126794815063477
Epoch: 16, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.928 Vali Acc: 0.844 Test Loss: 0.928 Test Acc: 0.844
Validation loss decreased (-0.818509 --> -0.844435).  Saving model ...
Epoch: 17 cost time: 0.4796304702758789
Epoch: 17, Steps: 2 | Train Loss: 0.742 Vali Loss: 0.872 Vali Acc: 0.859 Test Loss: 0.872 Test Acc: 0.859
Validation loss decreased (-0.844435 --> -0.859251).  Saving model ...
Epoch: 18 cost time: 0.4720182418823242
Epoch: 18, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.818 Vali Acc: 0.867 Test Loss: 0.818 Test Acc: 0.867
Validation loss decreased (-0.859251 --> -0.866658).  Saving model ...
Epoch: 19 cost time: 0.4950575828552246
Epoch: 19, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.767 Vali Acc: 0.885 Test Loss: 0.767 Test Acc: 0.885
Validation loss decreased (-0.866658 --> -0.885178).  Saving model ...
Epoch: 20 cost time: 0.4562547206878662
Epoch: 20, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.718 Vali Acc: 0.889 Test Loss: 0.718 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888882).  Saving model ...
Epoch: 21 cost time: 0.44518232345581055
Epoch: 21, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.672 Vali Acc: 0.893 Test Loss: 0.672 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892586).  Saving model ...
Epoch: 22 cost time: 0.455402135848999
Epoch: 22, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.630 Vali Acc: 0.893 Test Loss: 0.630 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 23 cost time: 0.4392843246459961
Epoch: 23, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.591 Vali Acc: 0.900 Test Loss: 0.591 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.44994282722473145
Epoch: 24, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.555 Vali Acc: 0.900 Test Loss: 0.555 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.5021712779998779
Epoch: 25, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.523 Vali Acc: 0.900 Test Loss: 0.523 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.503197431564331
Epoch: 26, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.493 Vali Acc: 0.900 Test Loss: 0.493 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.500891923904419
Epoch: 27, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.466 Vali Acc: 0.904 Test Loss: 0.466 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 28 cost time: 0.46941232681274414
Epoch: 28, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.443 Vali Acc: 0.907 Test Loss: 0.443 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 29 cost time: 0.4817671775817871
Epoch: 29, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.422 Vali Acc: 0.907 Test Loss: 0.422 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 30 cost time: 0.4748528003692627
Epoch: 30, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.404 Vali Acc: 0.907 Test Loss: 0.404 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 1390598
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1981756687164307
Epoch: 1, Steps: 2 | Train Loss: 1.996 Vali Loss: 1.858 Vali Acc: 0.148 Test Loss: 1.858 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.6419851779937744
Epoch: 2, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.824 Vali Acc: 0.196 Test Loss: 1.824 Test Acc: 0.196
Validation loss decreased (-0.148130 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.6483616828918457
Epoch: 3, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.794 Vali Acc: 0.226 Test Loss: 1.794 Test Acc: 0.226
Validation loss decreased (-0.196278 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.6666748523712158
Epoch: 4, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.763 Vali Acc: 0.278 Test Loss: 1.763 Test Acc: 0.278
Validation loss decreased (-0.225908 --> -0.277760).  Saving model ...
Epoch: 5 cost time: 0.621190071105957
Epoch: 5, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.723 Vali Acc: 0.348 Test Loss: 1.723 Test Acc: 0.348
Validation loss decreased (-0.277760 --> -0.348131).  Saving model ...
Epoch: 6 cost time: 0.6243922710418701
Epoch: 6, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.676 Vali Acc: 0.415 Test Loss: 1.676 Test Acc: 0.415
Validation loss decreased (-0.348131 --> -0.414798).  Saving model ...
Epoch: 7 cost time: 0.7112643718719482
Epoch: 7, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.626 Vali Acc: 0.478 Test Loss: 1.626 Test Acc: 0.478
Validation loss decreased (-0.414798 --> -0.477762).  Saving model ...
Epoch: 8 cost time: 0.6570854187011719
Epoch: 8, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.571 Vali Acc: 0.537 Test Loss: 1.571 Test Acc: 0.537
Validation loss decreased (-0.477762 --> -0.537021).  Saving model ...
Epoch: 9 cost time: 0.6013898849487305
Epoch: 9, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.514 Vali Acc: 0.581 Test Loss: 1.514 Test Acc: 0.581
Validation loss decreased (-0.537021 --> -0.581466).  Saving model ...
Epoch: 10 cost time: 0.6236486434936523
Epoch: 10, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.454 Vali Acc: 0.596 Test Loss: 1.454 Test Acc: 0.596
Validation loss decreased (-0.581466 --> -0.596282).  Saving model ...
Epoch: 11 cost time: 0.6151168346405029
Epoch: 11, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.393 Vali Acc: 0.626 Test Loss: 1.393 Test Acc: 0.626
Validation loss decreased (-0.596282 --> -0.625912).  Saving model ...
Epoch: 12 cost time: 0.6075069904327393
Epoch: 12, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.330 Vali Acc: 0.644 Test Loss: 1.330 Test Acc: 0.644
Validation loss decreased (-0.625912 --> -0.644431).  Saving model ...
Epoch: 13 cost time: 0.6110577583312988
Epoch: 13, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.267 Vali Acc: 0.656 Test Loss: 1.267 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655543).  Saving model ...
Epoch: 14 cost time: 0.6110315322875977
Epoch: 14, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.205 Vali Acc: 0.667 Test Loss: 1.205 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666655).  Saving model ...
Epoch: 15 cost time: 0.685211181640625
Epoch: 15, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.144 Vali Acc: 0.674 Test Loss: 1.144 Test Acc: 0.674
Validation loss decreased (-0.666655 --> -0.674063).  Saving model ...
Epoch: 16 cost time: 0.6025934219360352
Epoch: 16, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.085 Vali Acc: 0.711 Test Loss: 1.085 Test Acc: 0.711
Validation loss decreased (-0.674063 --> -0.711100).  Saving model ...
Epoch: 17 cost time: 0.5824613571166992
Epoch: 17, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.026 Vali Acc: 0.748 Test Loss: 1.026 Test Acc: 0.748
Validation loss decreased (-0.711100 --> -0.748138).  Saving model ...
Epoch: 18 cost time: 0.6787989139556885
Epoch: 18, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.969 Vali Acc: 0.770 Test Loss: 0.969 Test Acc: 0.770
Validation loss decreased (-0.748138 --> -0.770361).  Saving model ...
Epoch: 19 cost time: 0.6156206130981445
Epoch: 19, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.912 Vali Acc: 0.793 Test Loss: 0.912 Test Acc: 0.793
Validation loss decreased (-0.770361 --> -0.792583).  Saving model ...
Epoch: 20 cost time: 0.6739037036895752
Epoch: 20, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.860 Vali Acc: 0.800 Test Loss: 0.860 Test Acc: 0.800
Validation loss decreased (-0.792583 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 0.5929994583129883
Epoch: 21, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.808 Vali Acc: 0.811 Test Loss: 0.808 Test Acc: 0.811
Validation loss decreased (-0.799991 --> -0.811103).  Saving model ...
Epoch: 22 cost time: 0.6600744724273682
Epoch: 22, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.757 Vali Acc: 0.826 Test Loss: 0.757 Test Acc: 0.826
Validation loss decreased (-0.811103 --> -0.825918).  Saving model ...
Epoch: 23 cost time: 0.6075963973999023
Epoch: 23, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.709 Vali Acc: 0.841 Test Loss: 0.709 Test Acc: 0.841
Validation loss decreased (-0.825918 --> -0.840734).  Saving model ...
Epoch: 24 cost time: 0.6257154941558838
Epoch: 24, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.663 Vali Acc: 0.863 Test Loss: 0.663 Test Acc: 0.863
Validation loss decreased (-0.840734 --> -0.862956).  Saving model ...
Epoch: 25 cost time: 0.6184618473052979
Epoch: 25, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.620 Vali Acc: 0.859 Test Loss: 0.620 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6226985454559326
Epoch: 26, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.579 Vali Acc: 0.859 Test Loss: 0.579 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.654233455657959
Epoch: 27, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.542 Vali Acc: 0.859 Test Loss: 0.542 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6273634433746338
Epoch: 28, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866662).  Saving model ...
Epoch: 29 cost time: 0.7171306610107422
Epoch: 29, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.476 Vali Acc: 0.878 Test Loss: 0.476 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 30 cost time: 0.627962589263916
Epoch: 30, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.447 Vali Acc: 0.878 Test Loss: 0.447 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8777777777777778
model parameter : 2357126
model size : 9.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1910173892974854
Epoch: 1, Steps: 2 | Train Loss: 1.950 Vali Loss: 1.893 Vali Acc: 0.174 Test Loss: 1.893 Test Acc: 0.174
Validation loss decreased (inf --> -0.174055).  Saving model ...
Epoch: 2 cost time: 0.4919474124908447
Epoch: 2, Steps: 2 | Train Loss: 1.947 Vali Loss: 1.857 Vali Acc: 0.181 Test Loss: 1.857 Test Acc: 0.181
Validation loss decreased (-0.174055 --> -0.181463).  Saving model ...
Epoch: 3 cost time: 0.5174875259399414
Epoch: 3, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.827 Vali Acc: 0.193 Test Loss: 1.827 Test Acc: 0.193
Validation loss decreased (-0.181463 --> -0.192574).  Saving model ...
Epoch: 4 cost time: 0.5036895275115967
Epoch: 4, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.797 Vali Acc: 0.211 Test Loss: 1.797 Test Acc: 0.211
Validation loss decreased (-0.192574 --> -0.211093).  Saving model ...
Epoch: 5 cost time: 0.540123701095581
Epoch: 5, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.759 Vali Acc: 0.230 Test Loss: 1.759 Test Acc: 0.230
Validation loss decreased (-0.211093 --> -0.229612).  Saving model ...
Epoch: 6 cost time: 0.5819425582885742
Epoch: 6, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.714 Vali Acc: 0.252 Test Loss: 1.714 Test Acc: 0.252
Validation loss decreased (-0.229612 --> -0.251835).  Saving model ...
Epoch: 7 cost time: 0.5383327007293701
Epoch: 7, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.665 Vali Acc: 0.304 Test Loss: 1.665 Test Acc: 0.304
Validation loss decreased (-0.251835 --> -0.303687).  Saving model ...
Epoch: 8 cost time: 0.5173816680908203
Epoch: 8, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.612 Vali Acc: 0.389 Test Loss: 1.612 Test Acc: 0.389
Validation loss decreased (-0.303687 --> -0.388873).  Saving model ...
Epoch: 9 cost time: 0.5316381454467773
Epoch: 9, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.556 Vali Acc: 0.467 Test Loss: 1.556 Test Acc: 0.467
Validation loss decreased (-0.388873 --> -0.466651).  Saving model ...
Epoch: 10 cost time: 0.5368657112121582
Epoch: 10, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.497 Vali Acc: 0.507 Test Loss: 1.497 Test Acc: 0.507
Validation loss decreased (-0.466651 --> -0.507392).  Saving model ...
Epoch: 11 cost time: 0.5219721794128418
Epoch: 11, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.437 Vali Acc: 0.574 Test Loss: 1.437 Test Acc: 0.574
Validation loss decreased (-0.507392 --> -0.574060).  Saving model ...
Epoch: 12 cost time: 0.5406923294067383
Epoch: 12, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.375 Vali Acc: 0.637 Test Loss: 1.375 Test Acc: 0.637
Validation loss decreased (-0.574060 --> -0.637023).  Saving model ...
Epoch: 13 cost time: 0.5254251956939697
Epoch: 13, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.313 Vali Acc: 0.696 Test Loss: 1.313 Test Acc: 0.696
Validation loss decreased (-0.637023 --> -0.696283).  Saving model ...
Epoch: 14 cost time: 0.618840217590332
Epoch: 14, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.249 Vali Acc: 0.752 Test Loss: 1.249 Test Acc: 0.752
Validation loss decreased (-0.696283 --> -0.751839).  Saving model ...
Epoch: 15 cost time: 0.49620914459228516
Epoch: 15, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.187 Vali Acc: 0.793 Test Loss: 1.187 Test Acc: 0.793
Validation loss decreased (-0.751839 --> -0.792581).  Saving model ...
Epoch: 16 cost time: 0.5247159004211426
Epoch: 16, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.125 Vali Acc: 0.815 Test Loss: 1.125 Test Acc: 0.815
Validation loss decreased (-0.792581 --> -0.814804).  Saving model ...
Epoch: 17 cost time: 0.5051381587982178
Epoch: 17, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.065 Vali Acc: 0.841 Test Loss: 1.065 Test Acc: 0.841
Validation loss decreased (-0.814804 --> -0.840730).  Saving model ...
Epoch: 18 cost time: 0.5081987380981445
Epoch: 18, Steps: 2 | Train Loss: 0.857 Vali Loss: 1.007 Vali Acc: 0.856 Test Loss: 1.007 Test Acc: 0.856
Validation loss decreased (-0.840730 --> -0.855545).  Saving model ...
Epoch: 19 cost time: 0.49503087997436523
Epoch: 19, Steps: 2 | Train Loss: 0.840 Vali Loss: 0.950 Vali Acc: 0.859 Test Loss: 0.950 Test Acc: 0.859
Validation loss decreased (-0.855545 --> -0.859250).  Saving model ...
Epoch: 20 cost time: 0.5028073787689209
Epoch: 20, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.896 Vali Acc: 0.859 Test Loss: 0.896 Test Acc: 0.859
Validation loss decreased (-0.859250 --> -0.859250).  Saving model ...
Epoch: 21 cost time: 0.5174565315246582
Epoch: 21, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.845 Vali Acc: 0.874 Test Loss: 0.845 Test Acc: 0.874
Validation loss decreased (-0.859250 --> -0.874066).  Saving model ...
Epoch: 22 cost time: 0.5018970966339111
Epoch: 22, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.797 Vali Acc: 0.881 Test Loss: 0.797 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881474).  Saving model ...
Epoch: 23 cost time: 0.48966336250305176
Epoch: 23, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.751 Vali Acc: 0.893 Test Loss: 0.751 Test Acc: 0.893
Validation loss decreased (-0.881474 --> -0.892585).  Saving model ...
Epoch: 24 cost time: 0.496898889541626
Epoch: 24, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.708 Vali Acc: 0.893 Test Loss: 0.708 Test Acc: 0.893
Validation loss decreased (-0.892585 --> -0.892586).  Saving model ...
Epoch: 25 cost time: 0.5062344074249268
Epoch: 25, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.668 Vali Acc: 0.907 Test Loss: 0.668 Test Acc: 0.907
Validation loss decreased (-0.892586 --> -0.907401).  Saving model ...
Epoch: 26 cost time: 0.5265297889709473
Epoch: 26, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.631 Vali Acc: 0.904 Test Loss: 0.631 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5085227489471436
Epoch: 27, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.598 Vali Acc: 0.900 Test Loss: 0.598 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5388889312744141
Epoch: 28, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.567 Vali Acc: 0.904 Test Loss: 0.567 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5204217433929443
Epoch: 29, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.538 Vali Acc: 0.907 Test Loss: 0.538 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 30 cost time: 0.529017448425293
Epoch: 30, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.513 Vali Acc: 0.907 Test Loss: 0.513 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 701958
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.02131724357605
Epoch: 1, Steps: 2 | Train Loss: 1.996 Vali Loss: 1.858 Vali Acc: 0.148 Test Loss: 1.858 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.537182092666626
Epoch: 2, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.824 Vali Acc: 0.196 Test Loss: 1.824 Test Acc: 0.196
Validation loss decreased (-0.148130 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.570685625076294
Epoch: 3, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.794 Vali Acc: 0.226 Test Loss: 1.794 Test Acc: 0.226
Validation loss decreased (-0.196278 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.5712437629699707
Epoch: 4, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.763 Vali Acc: 0.278 Test Loss: 1.763 Test Acc: 0.278
Validation loss decreased (-0.225908 --> -0.277760).  Saving model ...
Epoch: 5 cost time: 0.5764963626861572
Epoch: 5, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.723 Vali Acc: 0.348 Test Loss: 1.723 Test Acc: 0.348
Validation loss decreased (-0.277760 --> -0.348131).  Saving model ...
Epoch: 6 cost time: 0.6064739227294922
Epoch: 6, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.676 Vali Acc: 0.415 Test Loss: 1.676 Test Acc: 0.415
Validation loss decreased (-0.348131 --> -0.414798).  Saving model ...
Epoch: 7 cost time: 0.6251158714294434
Epoch: 7, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.626 Vali Acc: 0.478 Test Loss: 1.626 Test Acc: 0.478
Validation loss decreased (-0.414798 --> -0.477762).  Saving model ...
Epoch: 8 cost time: 0.5626215934753418
Epoch: 8, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.571 Vali Acc: 0.537 Test Loss: 1.571 Test Acc: 0.537
Validation loss decreased (-0.477762 --> -0.537021).  Saving model ...
Epoch: 9 cost time: 0.5949482917785645
Epoch: 9, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.514 Vali Acc: 0.581 Test Loss: 1.514 Test Acc: 0.581
Validation loss decreased (-0.537021 --> -0.581466).  Saving model ...
Epoch: 10 cost time: 0.5879590511322021
Epoch: 10, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.454 Vali Acc: 0.596 Test Loss: 1.454 Test Acc: 0.596
Validation loss decreased (-0.581466 --> -0.596282).  Saving model ...
Epoch: 11 cost time: 0.5958414077758789
Epoch: 11, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.393 Vali Acc: 0.626 Test Loss: 1.393 Test Acc: 0.626
Validation loss decreased (-0.596282 --> -0.625912).  Saving model ...
Epoch: 12 cost time: 0.661792516708374
Epoch: 12, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.330 Vali Acc: 0.644 Test Loss: 1.330 Test Acc: 0.644
Validation loss decreased (-0.625912 --> -0.644431).  Saving model ...
Epoch: 13 cost time: 0.5501866340637207
Epoch: 13, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.267 Vali Acc: 0.656 Test Loss: 1.267 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655543).  Saving model ...
Epoch: 14 cost time: 0.6111741065979004
Epoch: 14, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.205 Vali Acc: 0.667 Test Loss: 1.205 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666655).  Saving model ...
Epoch: 15 cost time: 0.6061944961547852
Epoch: 15, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.144 Vali Acc: 0.674 Test Loss: 1.144 Test Acc: 0.674
Validation loss decreased (-0.666655 --> -0.674063).  Saving model ...
Epoch: 16 cost time: 0.5695319175720215
Epoch: 16, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.085 Vali Acc: 0.711 Test Loss: 1.085 Test Acc: 0.711
Validation loss decreased (-0.674063 --> -0.711100).  Saving model ...
Epoch: 17 cost time: 0.6893157958984375
Epoch: 17, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.026 Vali Acc: 0.748 Test Loss: 1.026 Test Acc: 0.748
Validation loss decreased (-0.711100 --> -0.748138).  Saving model ...
Epoch: 18 cost time: 0.5759406089782715
Epoch: 18, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.969 Vali Acc: 0.770 Test Loss: 0.969 Test Acc: 0.770
Validation loss decreased (-0.748138 --> -0.770361).  Saving model ...
Epoch: 19 cost time: 0.6063106060028076
Epoch: 19, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.912 Vali Acc: 0.793 Test Loss: 0.912 Test Acc: 0.793
Validation loss decreased (-0.770361 --> -0.792583).  Saving model ...
Epoch: 20 cost time: 0.6003499031066895
Epoch: 20, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.860 Vali Acc: 0.800 Test Loss: 0.860 Test Acc: 0.800
Validation loss decreased (-0.792583 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 0.6083223819732666
Epoch: 21, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.808 Vali Acc: 0.811 Test Loss: 0.808 Test Acc: 0.811
Validation loss decreased (-0.799991 --> -0.811103).  Saving model ...
Epoch: 22 cost time: 0.585486650466919
Epoch: 22, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.757 Vali Acc: 0.826 Test Loss: 0.757 Test Acc: 0.826
Validation loss decreased (-0.811103 --> -0.825918).  Saving model ...
Epoch: 23 cost time: 0.5422747135162354
Epoch: 23, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.709 Vali Acc: 0.841 Test Loss: 0.709 Test Acc: 0.841
Validation loss decreased (-0.825918 --> -0.840734).  Saving model ...
Epoch: 24 cost time: 0.5812990665435791
Epoch: 24, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.663 Vali Acc: 0.863 Test Loss: 0.663 Test Acc: 0.863
Validation loss decreased (-0.840734 --> -0.862956).  Saving model ...
Epoch: 25 cost time: 0.6548879146575928
Epoch: 25, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.620 Vali Acc: 0.859 Test Loss: 0.620 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.630408525466919
Epoch: 26, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.579 Vali Acc: 0.859 Test Loss: 0.579 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5871574878692627
Epoch: 27, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.542 Vali Acc: 0.859 Test Loss: 0.542 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6799807548522949
Epoch: 28, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866662).  Saving model ...
Epoch: 29 cost time: 0.6665644645690918
Epoch: 29, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.476 Vali Acc: 0.878 Test Loss: 0.476 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 30 cost time: 0.560713529586792
Epoch: 30, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.447 Vali Acc: 0.878 Test Loss: 0.447 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8777777777777778
model parameter : 2357126
model size : 9.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.274036407470703
Epoch: 1, Steps: 2 | Train Loss: 1.950 Vali Loss: 1.893 Vali Acc: 0.174 Test Loss: 1.893 Test Acc: 0.174
Validation loss decreased (inf --> -0.174055).  Saving model ...
Epoch: 2 cost time: 0.4795043468475342
Epoch: 2, Steps: 2 | Train Loss: 1.947 Vali Loss: 1.857 Vali Acc: 0.181 Test Loss: 1.857 Test Acc: 0.181
Validation loss decreased (-0.174055 --> -0.181463).  Saving model ...
Epoch: 3 cost time: 0.5238046646118164
Epoch: 3, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.827 Vali Acc: 0.193 Test Loss: 1.827 Test Acc: 0.193
Validation loss decreased (-0.181463 --> -0.192574).  Saving model ...
Epoch: 4 cost time: 0.5050458908081055
Epoch: 4, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.797 Vali Acc: 0.211 Test Loss: 1.797 Test Acc: 0.211
Validation loss decreased (-0.192574 --> -0.211093).  Saving model ...
Epoch: 5 cost time: 0.5812714099884033
Epoch: 5, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.759 Vali Acc: 0.230 Test Loss: 1.759 Test Acc: 0.230
Validation loss decreased (-0.211093 --> -0.229612).  Saving model ...
Epoch: 6 cost time: 0.5362544059753418
Epoch: 6, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.714 Vali Acc: 0.252 Test Loss: 1.714 Test Acc: 0.252
Validation loss decreased (-0.229612 --> -0.251835).  Saving model ...
Epoch: 7 cost time: 0.6270718574523926
Epoch: 7, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.665 Vali Acc: 0.304 Test Loss: 1.665 Test Acc: 0.304
Validation loss decreased (-0.251835 --> -0.303687).  Saving model ...
Epoch: 8 cost time: 0.589188814163208
Epoch: 8, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.612 Vali Acc: 0.389 Test Loss: 1.612 Test Acc: 0.389
Validation loss decreased (-0.303687 --> -0.388873).  Saving model ...
Epoch: 9 cost time: 0.5656344890594482
Epoch: 9, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.556 Vali Acc: 0.467 Test Loss: 1.556 Test Acc: 0.467
Validation loss decreased (-0.388873 --> -0.466651).  Saving model ...
Epoch: 10 cost time: 0.5446312427520752
Epoch: 10, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.497 Vali Acc: 0.507 Test Loss: 1.497 Test Acc: 0.507
Validation loss decreased (-0.466651 --> -0.507392).  Saving model ...
Epoch: 11 cost time: 0.5323631763458252
Epoch: 11, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.437 Vali Acc: 0.574 Test Loss: 1.437 Test Acc: 0.574
Validation loss decreased (-0.507392 --> -0.574060).  Saving model ...
Epoch: 12 cost time: 0.5224952697753906
Epoch: 12, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.375 Vali Acc: 0.637 Test Loss: 1.375 Test Acc: 0.637
Validation loss decreased (-0.574060 --> -0.637023).  Saving model ...
Epoch: 13 cost time: 0.6188626289367676
Epoch: 13, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.313 Vali Acc: 0.696 Test Loss: 1.313 Test Acc: 0.696
Validation loss decreased (-0.637023 --> -0.696283).  Saving model ...
Epoch: 14 cost time: 0.5489544868469238
Epoch: 14, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.249 Vali Acc: 0.752 Test Loss: 1.249 Test Acc: 0.752
Validation loss decreased (-0.696283 --> -0.751839).  Saving model ...
Epoch: 15 cost time: 0.5257112979888916
Epoch: 15, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.187 Vali Acc: 0.793 Test Loss: 1.187 Test Acc: 0.793
Validation loss decreased (-0.751839 --> -0.792581).  Saving model ...
Epoch: 16 cost time: 0.5442845821380615
Epoch: 16, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.125 Vali Acc: 0.815 Test Loss: 1.125 Test Acc: 0.815
Validation loss decreased (-0.792581 --> -0.814804).  Saving model ...
Epoch: 17 cost time: 0.5444545745849609
Epoch: 17, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.065 Vali Acc: 0.841 Test Loss: 1.065 Test Acc: 0.841
Validation loss decreased (-0.814804 --> -0.840730).  Saving model ...
Epoch: 18 cost time: 0.502830982208252
Epoch: 18, Steps: 2 | Train Loss: 0.857 Vali Loss: 1.007 Vali Acc: 0.856 Test Loss: 1.007 Test Acc: 0.856
Validation loss decreased (-0.840730 --> -0.855545).  Saving model ...
Epoch: 19 cost time: 0.533247709274292
Epoch: 19, Steps: 2 | Train Loss: 0.840 Vali Loss: 0.950 Vali Acc: 0.859 Test Loss: 0.950 Test Acc: 0.859
Validation loss decreased (-0.855545 --> -0.859250).  Saving model ...
Epoch: 20 cost time: 0.5290868282318115
Epoch: 20, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.896 Vali Acc: 0.859 Test Loss: 0.896 Test Acc: 0.859
Validation loss decreased (-0.859250 --> -0.859250).  Saving model ...
Epoch: 21 cost time: 0.5370526313781738
Epoch: 21, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.845 Vali Acc: 0.874 Test Loss: 0.845 Test Acc: 0.874
Validation loss decreased (-0.859250 --> -0.874066).  Saving model ...
Epoch: 22 cost time: 0.6005063056945801
Epoch: 22, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.797 Vali Acc: 0.881 Test Loss: 0.797 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881474).  Saving model ...
Epoch: 23 cost time: 0.5632777214050293
Epoch: 23, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.751 Vali Acc: 0.893 Test Loss: 0.751 Test Acc: 0.893
Validation loss decreased (-0.881474 --> -0.892585).  Saving model ...
Epoch: 24 cost time: 0.501760721206665
Epoch: 24, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.708 Vali Acc: 0.893 Test Loss: 0.708 Test Acc: 0.893
Validation loss decreased (-0.892585 --> -0.892586).  Saving model ...
Epoch: 25 cost time: 0.5294125080108643
Epoch: 25, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.668 Vali Acc: 0.907 Test Loss: 0.668 Test Acc: 0.907
Validation loss decreased (-0.892586 --> -0.907401).  Saving model ...
Epoch: 26 cost time: 0.5055832862854004
Epoch: 26, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.631 Vali Acc: 0.904 Test Loss: 0.631 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5176141262054443
Epoch: 27, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.598 Vali Acc: 0.900 Test Loss: 0.598 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.605994701385498
Epoch: 28, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.567 Vali Acc: 0.904 Test Loss: 0.567 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5385415554046631
Epoch: 29, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.538 Vali Acc: 0.907 Test Loss: 0.538 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 30 cost time: 0.5359485149383545
Epoch: 30, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.513 Vali Acc: 0.907 Test Loss: 0.513 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 701958
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.930593490600586
Epoch: 1, Steps: 2 | Train Loss: 1.996 Vali Loss: 1.858 Vali Acc: 0.152 Test Loss: 1.858 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 0.540473461151123
Epoch: 2, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.824 Vali Acc: 0.200 Test Loss: 1.824 Test Acc: 0.200
Validation loss decreased (-0.151833 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.5309691429138184
Epoch: 3, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.794 Vali Acc: 0.226 Test Loss: 1.794 Test Acc: 0.226
Validation loss decreased (-0.199982 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.5436065196990967
Epoch: 4, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.763 Vali Acc: 0.278 Test Loss: 1.763 Test Acc: 0.278
Validation loss decreased (-0.225908 --> -0.277760).  Saving model ...
Epoch: 5 cost time: 0.5260148048400879
Epoch: 5, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.724 Vali Acc: 0.348 Test Loss: 1.724 Test Acc: 0.348
Validation loss decreased (-0.277760 --> -0.348131).  Saving model ...
Epoch: 6 cost time: 0.5745680332183838
Epoch: 6, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.678 Vali Acc: 0.415 Test Loss: 1.678 Test Acc: 0.415
Validation loss decreased (-0.348131 --> -0.414798).  Saving model ...
Epoch: 7 cost time: 0.5566360950469971
Epoch: 7, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.627 Vali Acc: 0.474 Test Loss: 1.627 Test Acc: 0.474
Validation loss decreased (-0.414798 --> -0.474058).  Saving model ...
Epoch: 8 cost time: 0.5949678421020508
Epoch: 8, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.573 Vali Acc: 0.530 Test Loss: 1.573 Test Acc: 0.530
Validation loss decreased (-0.474058 --> -0.529614).  Saving model ...
Epoch: 9 cost time: 0.5209076404571533
Epoch: 9, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.516 Vali Acc: 0.581 Test Loss: 1.516 Test Acc: 0.581
Validation loss decreased (-0.529614 --> -0.581466).  Saving model ...
Epoch: 10 cost time: 0.547274112701416
Epoch: 10, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.457 Vali Acc: 0.596 Test Loss: 1.457 Test Acc: 0.596
Validation loss decreased (-0.581466 --> -0.596282).  Saving model ...
Epoch: 11 cost time: 0.5326011180877686
Epoch: 11, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.396 Vali Acc: 0.626 Test Loss: 1.396 Test Acc: 0.626
Validation loss decreased (-0.596282 --> -0.625912).  Saving model ...
Epoch: 12 cost time: 0.5256385803222656
Epoch: 12, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.334 Vali Acc: 0.641 Test Loss: 1.334 Test Acc: 0.641
Validation loss decreased (-0.625912 --> -0.640727).  Saving model ...
Epoch: 13 cost time: 0.5518693923950195
Epoch: 13, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.271 Vali Acc: 0.656 Test Loss: 1.271 Test Acc: 0.656
Validation loss decreased (-0.640727 --> -0.655543).  Saving model ...
Epoch: 14 cost time: 0.5011930465698242
Epoch: 14, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.209 Vali Acc: 0.659 Test Loss: 1.209 Test Acc: 0.659
Validation loss decreased (-0.655543 --> -0.659247).  Saving model ...
Epoch: 15 cost time: 0.5555713176727295
Epoch: 15, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.148 Vali Acc: 0.674 Test Loss: 1.148 Test Acc: 0.674
Validation loss decreased (-0.659247 --> -0.674063).  Saving model ...
Epoch: 16 cost time: 0.5338950157165527
Epoch: 16, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.089 Vali Acc: 0.711 Test Loss: 1.089 Test Acc: 0.711
Validation loss decreased (-0.674063 --> -0.711100).  Saving model ...
Epoch: 17 cost time: 0.5488758087158203
Epoch: 17, Steps: 2 | Train Loss: 0.999 Vali Loss: 1.031 Vali Acc: 0.744 Test Loss: 1.031 Test Acc: 0.744
Validation loss decreased (-0.711100 --> -0.744434).  Saving model ...
Epoch: 18 cost time: 0.519554853439331
Epoch: 18, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.973 Vali Acc: 0.770 Test Loss: 0.973 Test Acc: 0.770
Validation loss decreased (-0.744434 --> -0.770361).  Saving model ...
Epoch: 19 cost time: 0.5535635948181152
Epoch: 19, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.917 Vali Acc: 0.793 Test Loss: 0.917 Test Acc: 0.793
Validation loss decreased (-0.770361 --> -0.792583).  Saving model ...
Epoch: 20 cost time: 0.5948760509490967
Epoch: 20, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.864 Vali Acc: 0.800 Test Loss: 0.864 Test Acc: 0.800
Validation loss decreased (-0.792583 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 0.5473899841308594
Epoch: 21, Steps: 2 | Train Loss: 0.744 Vali Loss: 0.811 Vali Acc: 0.811 Test Loss: 0.811 Test Acc: 0.811
Validation loss decreased (-0.799991 --> -0.811103).  Saving model ...
Epoch: 22 cost time: 0.5454206466674805
Epoch: 22, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.760 Vali Acc: 0.826 Test Loss: 0.760 Test Acc: 0.826
Validation loss decreased (-0.811103 --> -0.825918).  Saving model ...
Epoch: 23 cost time: 0.5744850635528564
Epoch: 23, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.712 Vali Acc: 0.841 Test Loss: 0.712 Test Acc: 0.841
Validation loss decreased (-0.825918 --> -0.840734).  Saving model ...
Epoch: 24 cost time: 0.5316934585571289
Epoch: 24, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.665 Vali Acc: 0.863 Test Loss: 0.665 Test Acc: 0.863
Validation loss decreased (-0.840734 --> -0.862956).  Saving model ...
Epoch: 25 cost time: 0.5571365356445312
Epoch: 25, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.622 Vali Acc: 0.859 Test Loss: 0.622 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6432642936706543
Epoch: 26, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.581 Vali Acc: 0.863 Test Loss: 0.581 Test Acc: 0.863
Validation loss decreased (-0.862956 --> -0.862957).  Saving model ...
Epoch: 27 cost time: 0.5471129417419434
Epoch: 27, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.544 Vali Acc: 0.859 Test Loss: 0.544 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5358302593231201
Epoch: 28, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
Validation loss decreased (-0.862957 --> -0.866662).  Saving model ...
Epoch: 29 cost time: 0.5586693286895752
Epoch: 29, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.478 Vali Acc: 0.878 Test Loss: 0.478 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 30 cost time: 0.5419442653656006
Epoch: 30, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.449 Vali Acc: 0.878 Test Loss: 0.449 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8777777777777778
model parameter : 2357126
model size : 9.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0009381771087646
Epoch: 1, Steps: 2 | Train Loss: 1.942 Vali Loss: 1.891 Vali Acc: 0.174 Test Loss: 1.891 Test Acc: 0.174
Validation loss decreased (inf --> -0.174055).  Saving model ...
Epoch: 2 cost time: 0.49453210830688477
Epoch: 2, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.854 Vali Acc: 0.181 Test Loss: 1.854 Test Acc: 0.181
Validation loss decreased (-0.174055 --> -0.181463).  Saving model ...
Epoch: 3 cost time: 0.4970431327819824
Epoch: 3, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.825 Vali Acc: 0.196 Test Loss: 1.825 Test Acc: 0.196
Validation loss decreased (-0.181463 --> -0.196278).  Saving model ...
Epoch: 4 cost time: 0.522423505783081
Epoch: 4, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.795 Vali Acc: 0.215 Test Loss: 1.795 Test Acc: 0.215
Validation loss decreased (-0.196278 --> -0.214797).  Saving model ...
Epoch: 5 cost time: 0.5120806694030762
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.758 Vali Acc: 0.233 Test Loss: 1.758 Test Acc: 0.233
Validation loss decreased (-0.214797 --> -0.233316).  Saving model ...
Epoch: 6 cost time: 0.4682960510253906
Epoch: 6, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.713 Vali Acc: 0.256 Test Loss: 1.713 Test Acc: 0.256
Validation loss decreased (-0.233316 --> -0.255538).  Saving model ...
Epoch: 7 cost time: 0.4796736240386963
Epoch: 7, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.664 Vali Acc: 0.304 Test Loss: 1.664 Test Acc: 0.304
Validation loss decreased (-0.255538 --> -0.303687).  Saving model ...
Epoch: 8 cost time: 0.5249810218811035
Epoch: 8, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.612 Vali Acc: 0.389 Test Loss: 1.612 Test Acc: 0.389
Validation loss decreased (-0.303687 --> -0.388873).  Saving model ...
Epoch: 9 cost time: 0.4996986389160156
Epoch: 9, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.556 Vali Acc: 0.459 Test Loss: 1.556 Test Acc: 0.459
Validation loss decreased (-0.388873 --> -0.459244).  Saving model ...
Epoch: 10 cost time: 0.4791128635406494
Epoch: 10, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.498 Vali Acc: 0.511 Test Loss: 1.498 Test Acc: 0.511
Validation loss decreased (-0.459244 --> -0.511096).  Saving model ...
Epoch: 11 cost time: 0.49202489852905273
Epoch: 11, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.438 Vali Acc: 0.581 Test Loss: 1.438 Test Acc: 0.581
Validation loss decreased (-0.511096 --> -0.581467).  Saving model ...
Epoch: 12 cost time: 0.4691274166107178
Epoch: 12, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.377 Vali Acc: 0.644 Test Loss: 1.377 Test Acc: 0.644
Validation loss decreased (-0.581467 --> -0.644431).  Saving model ...
Epoch: 13 cost time: 0.5350077152252197
Epoch: 13, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.315 Vali Acc: 0.696 Test Loss: 1.315 Test Acc: 0.696
Validation loss decreased (-0.644431 --> -0.696283).  Saving model ...
Epoch: 14 cost time: 0.5338008403778076
Epoch: 14, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.252 Vali Acc: 0.748 Test Loss: 1.252 Test Acc: 0.748
Validation loss decreased (-0.696283 --> -0.748136).  Saving model ...
Epoch: 15 cost time: 0.5439577102661133
Epoch: 15, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.190 Vali Acc: 0.796 Test Loss: 1.190 Test Acc: 0.796
Validation loss decreased (-0.748136 --> -0.796284).  Saving model ...
Epoch: 16 cost time: 0.5132389068603516
Epoch: 16, Steps: 2 | Train Loss: 1.045 Vali Loss: 1.129 Vali Acc: 0.815 Test Loss: 1.129 Test Acc: 0.815
Validation loss decreased (-0.796284 --> -0.814804).  Saving model ...
Epoch: 17 cost time: 0.5619370937347412
Epoch: 17, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.069 Vali Acc: 0.833 Test Loss: 1.069 Test Acc: 0.833
Validation loss decreased (-0.814804 --> -0.833323).  Saving model ...
Epoch: 18 cost time: 0.5213303565979004
Epoch: 18, Steps: 2 | Train Loss: 0.879 Vali Loss: 1.011 Vali Acc: 0.852 Test Loss: 1.011 Test Acc: 0.852
Validation loss decreased (-0.833323 --> -0.851842).  Saving model ...
Epoch: 19 cost time: 0.48732876777648926
Epoch: 19, Steps: 2 | Train Loss: 0.858 Vali Loss: 0.955 Vali Acc: 0.856 Test Loss: 0.955 Test Acc: 0.856
Validation loss decreased (-0.851842 --> -0.855546).  Saving model ...
Epoch: 20 cost time: 0.562650203704834
Epoch: 20, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.901 Vali Acc: 0.859 Test Loss: 0.901 Test Acc: 0.859
Validation loss decreased (-0.855546 --> -0.859250).  Saving model ...
Epoch: 21 cost time: 0.5432143211364746
Epoch: 21, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.849 Vali Acc: 0.870 Test Loss: 0.849 Test Acc: 0.870
Validation loss decreased (-0.859250 --> -0.870362).  Saving model ...
Epoch: 22 cost time: 0.4960904121398926
Epoch: 22, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.801 Vali Acc: 0.885 Test Loss: 0.801 Test Acc: 0.885
Validation loss decreased (-0.870362 --> -0.885177).  Saving model ...
Epoch: 23 cost time: 0.48233485221862793
Epoch: 23, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.755 Vali Acc: 0.893 Test Loss: 0.755 Test Acc: 0.893
Validation loss decreased (-0.885177 --> -0.892585).  Saving model ...
Epoch: 24 cost time: 0.631568431854248
Epoch: 24, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.711 Vali Acc: 0.893 Test Loss: 0.711 Test Acc: 0.893
Validation loss decreased (-0.892585 --> -0.892585).  Saving model ...
Epoch: 25 cost time: 0.5328545570373535
Epoch: 25, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.670 Vali Acc: 0.911 Test Loss: 0.670 Test Acc: 0.911
Validation loss decreased (-0.892585 --> -0.911104).  Saving model ...
Epoch: 26 cost time: 0.5237412452697754
Epoch: 26, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.633 Vali Acc: 0.907 Test Loss: 0.633 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5359385013580322
Epoch: 27, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.599 Vali Acc: 0.904 Test Loss: 0.599 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5257947444915771
Epoch: 28, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.567 Vali Acc: 0.904 Test Loss: 0.567 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.514819860458374
Epoch: 29, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.539 Vali Acc: 0.907 Test Loss: 0.539 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5374288558959961
Epoch: 30, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.513 Vali Acc: 0.911 Test Loss: 0.513 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911106).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9111111111111111
model parameter : 701958
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2326035499572754
Epoch: 1, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.757 Vali Acc: 0.359 Test Loss: 1.757 Test Acc: 0.359
Validation loss decreased (inf --> -0.359242).  Saving model ...
Epoch: 2 cost time: 0.5872092247009277
Epoch: 2, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.723 Vali Acc: 0.374 Test Loss: 1.723 Test Acc: 0.374
Validation loss decreased (-0.359242 --> -0.374057).  Saving model ...
Epoch: 3 cost time: 0.6383750438690186
Epoch: 3, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.696 Vali Acc: 0.385 Test Loss: 1.696 Test Acc: 0.385
Validation loss decreased (-0.374057 --> -0.385168).  Saving model ...
Epoch: 4 cost time: 0.5815525054931641
Epoch: 4, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.669 Vali Acc: 0.404 Test Loss: 1.669 Test Acc: 0.404
Validation loss decreased (-0.385168 --> -0.403687).  Saving model ...
Epoch: 5 cost time: 0.6292986869812012
Epoch: 5, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.634 Vali Acc: 0.419 Test Loss: 1.634 Test Acc: 0.419
Validation loss decreased (-0.403687 --> -0.418502).  Saving model ...
Epoch: 6 cost time: 0.5753490924835205
Epoch: 6, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.593 Vali Acc: 0.441 Test Loss: 1.593 Test Acc: 0.441
Validation loss decreased (-0.418502 --> -0.440725).  Saving model ...
Epoch: 7 cost time: 0.5738604068756104
Epoch: 7, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.548 Vali Acc: 0.470 Test Loss: 1.548 Test Acc: 0.470
Validation loss decreased (-0.440725 --> -0.470355).  Saving model ...
Epoch: 8 cost time: 0.6239972114562988
Epoch: 8, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.499 Vali Acc: 0.507 Test Loss: 1.499 Test Acc: 0.507
Validation loss decreased (-0.470355 --> -0.507392).  Saving model ...
Epoch: 9 cost time: 0.6553969383239746
Epoch: 9, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.447 Vali Acc: 0.552 Test Loss: 1.447 Test Acc: 0.552
Validation loss decreased (-0.507392 --> -0.551837).  Saving model ...
Epoch: 10 cost time: 0.6234877109527588
Epoch: 10, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.394 Vali Acc: 0.585 Test Loss: 1.394 Test Acc: 0.585
Validation loss decreased (-0.551837 --> -0.585171).  Saving model ...
Epoch: 11 cost time: 0.7050385475158691
Epoch: 11, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.339 Vali Acc: 0.619 Test Loss: 1.339 Test Acc: 0.619
Validation loss decreased (-0.585171 --> -0.618505).  Saving model ...
Epoch: 12 cost time: 0.620959997177124
Epoch: 12, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.283 Vali Acc: 0.656 Test Loss: 1.283 Test Acc: 0.656
Validation loss decreased (-0.618505 --> -0.655543).  Saving model ...
Epoch: 13 cost time: 0.6006574630737305
Epoch: 13, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.225 Vali Acc: 0.681 Test Loss: 1.225 Test Acc: 0.681
Validation loss decreased (-0.655543 --> -0.681469).  Saving model ...
Epoch: 14 cost time: 0.6057884693145752
Epoch: 14, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.168 Vali Acc: 0.715 Test Loss: 1.168 Test Acc: 0.715
Validation loss decreased (-0.681469 --> -0.714803).  Saving model ...
Epoch: 15 cost time: 0.5709280967712402
Epoch: 15, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.111 Vali Acc: 0.741 Test Loss: 1.111 Test Acc: 0.741
Validation loss decreased (-0.714803 --> -0.740730).  Saving model ...
Epoch: 16 cost time: 0.6769804954528809
Epoch: 16, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.055 Vali Acc: 0.774 Test Loss: 1.055 Test Acc: 0.774
Validation loss decreased (-0.740730 --> -0.774064).  Saving model ...
Epoch: 17 cost time: 0.6026721000671387
Epoch: 17, Steps: 2 | Train Loss: 0.882 Vali Loss: 1.002 Vali Acc: 0.789 Test Loss: 1.002 Test Acc: 0.789
Validation loss decreased (-0.774064 --> -0.788879).  Saving model ...
Epoch: 18 cost time: 0.5523757934570312
Epoch: 18, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.950 Vali Acc: 0.815 Test Loss: 0.950 Test Acc: 0.815
Validation loss decreased (-0.788879 --> -0.814805).  Saving model ...
Epoch: 19 cost time: 0.7000043392181396
Epoch: 19, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.900 Vali Acc: 0.822 Test Loss: 0.900 Test Acc: 0.822
Validation loss decreased (-0.814805 --> -0.822213).  Saving model ...
Epoch: 20 cost time: 0.5742313861846924
Epoch: 20, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.851 Vali Acc: 0.837 Test Loss: 0.851 Test Acc: 0.837
Validation loss decreased (-0.822213 --> -0.837029).  Saving model ...
Epoch: 21 cost time: 0.5996973514556885
Epoch: 21, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.804 Vali Acc: 0.837 Test Loss: 0.804 Test Acc: 0.837
Validation loss decreased (-0.837029 --> -0.837029).  Saving model ...
Epoch: 22 cost time: 0.5695888996124268
Epoch: 22, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.759 Vali Acc: 0.852 Test Loss: 0.759 Test Acc: 0.852
Validation loss decreased (-0.837029 --> -0.851844).  Saving model ...
Epoch: 23 cost time: 0.7000677585601807
Epoch: 23, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.716 Vali Acc: 0.870 Test Loss: 0.716 Test Acc: 0.870
Validation loss decreased (-0.851844 --> -0.870363).  Saving model ...
Epoch: 24 cost time: 0.604968786239624
Epoch: 24, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.677 Vali Acc: 0.885 Test Loss: 0.677 Test Acc: 0.885
Validation loss decreased (-0.870363 --> -0.885178).  Saving model ...
Epoch: 25 cost time: 0.5968997478485107
Epoch: 25, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.641 Vali Acc: 0.881 Test Loss: 0.641 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5715410709381104
Epoch: 26, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.607 Vali Acc: 0.885 Test Loss: 0.607 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885179).  Saving model ...
Epoch: 27 cost time: 0.5780856609344482
Epoch: 27, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.577 Vali Acc: 0.885 Test Loss: 0.577 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885179).  Saving model ...
Epoch: 28 cost time: 0.5707294940948486
Epoch: 28, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.549 Vali Acc: 0.889 Test Loss: 0.549 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 29 cost time: 0.6108777523040771
Epoch: 29, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.523 Vali Acc: 0.896 Test Loss: 0.523 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 30 cost time: 0.5937325954437256
Epoch: 30, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.500 Vali Acc: 0.904 Test Loss: 0.500 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 1185286
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.159925937652588
Epoch: 1, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.558 Vali Acc: 0.493 Test Loss: 1.558 Test Acc: 0.493
Validation loss decreased (inf --> -0.492577).  Saving model ...
Epoch: 2 cost time: 0.5243234634399414
Epoch: 2, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.525 Vali Acc: 0.559 Test Loss: 1.525 Test Acc: 0.559
Validation loss decreased (-0.492577 --> -0.559244).  Saving model ...
Epoch: 3 cost time: 0.5589821338653564
Epoch: 3, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.499 Vali Acc: 0.589 Test Loss: 1.499 Test Acc: 0.589
Validation loss decreased (-0.559244 --> -0.588874).  Saving model ...
Epoch: 4 cost time: 0.5279297828674316
Epoch: 4, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.475 Vali Acc: 0.626 Test Loss: 1.475 Test Acc: 0.626
Validation loss decreased (-0.588874 --> -0.625911).  Saving model ...
Epoch: 5 cost time: 0.5571048259735107
Epoch: 5, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.443 Vali Acc: 0.663 Test Loss: 1.443 Test Acc: 0.663
Validation loss decreased (-0.625911 --> -0.662949).  Saving model ...
Epoch: 6 cost time: 0.5723443031311035
Epoch: 6, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.406 Vali Acc: 0.700 Test Loss: 1.406 Test Acc: 0.700
Validation loss decreased (-0.662949 --> -0.699986).  Saving model ...
Epoch: 7 cost time: 0.5340256690979004
Epoch: 7, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.365 Vali Acc: 0.733 Test Loss: 1.365 Test Acc: 0.733
Validation loss decreased (-0.699986 --> -0.733320).  Saving model ...
Epoch: 8 cost time: 0.5228369235992432
Epoch: 8, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.320 Vali Acc: 0.748 Test Loss: 1.320 Test Acc: 0.748
Validation loss decreased (-0.733320 --> -0.748135).  Saving model ...
Epoch: 9 cost time: 0.5161788463592529
Epoch: 9, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.274 Vali Acc: 0.767 Test Loss: 1.274 Test Acc: 0.767
Validation loss decreased (-0.748135 --> -0.766654).  Saving model ...
Epoch: 10 cost time: 0.5224895477294922
Epoch: 10, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.226 Vali Acc: 0.796 Test Loss: 1.226 Test Acc: 0.796
Validation loss decreased (-0.766654 --> -0.796284).  Saving model ...
Epoch: 11 cost time: 0.5274863243103027
Epoch: 11, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.177 Vali Acc: 0.811 Test Loss: 1.177 Test Acc: 0.811
Validation loss decreased (-0.796284 --> -0.811099).  Saving model ...
Epoch: 12 cost time: 0.5135202407836914
Epoch: 12, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.129 Vali Acc: 0.819 Test Loss: 1.129 Test Acc: 0.819
Validation loss decreased (-0.811099 --> -0.818507).  Saving model ...
Epoch: 13 cost time: 0.5545845031738281
Epoch: 13, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.081 Vali Acc: 0.841 Test Loss: 1.081 Test Acc: 0.841
Validation loss decreased (-0.818507 --> -0.840730).  Saving model ...
Epoch: 14 cost time: 0.5564243793487549
Epoch: 14, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.032 Vali Acc: 0.856 Test Loss: 1.032 Test Acc: 0.856
Validation loss decreased (-0.840730 --> -0.855545).  Saving model ...
Epoch: 15 cost time: 0.5539202690124512
Epoch: 15, Steps: 2 | Train Loss: 0.960 Vali Loss: 0.984 Vali Acc: 0.870 Test Loss: 0.984 Test Acc: 0.870
Validation loss decreased (-0.855545 --> -0.870361).  Saving model ...
Epoch: 16 cost time: 0.5350606441497803
Epoch: 16, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.936 Vali Acc: 0.874 Test Loss: 0.936 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874065).  Saving model ...
Epoch: 17 cost time: 0.5315864086151123
Epoch: 17, Steps: 2 | Train Loss: 0.832 Vali Loss: 0.890 Vali Acc: 0.893 Test Loss: 0.890 Test Acc: 0.893
Validation loss decreased (-0.874065 --> -0.892584).  Saving model ...
Epoch: 18 cost time: 0.527489185333252
Epoch: 18, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.844 Vali Acc: 0.904 Test Loss: 0.844 Test Acc: 0.904
Validation loss decreased (-0.892584 --> -0.903695).  Saving model ...
Epoch: 19 cost time: 0.5377926826477051
Epoch: 19, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.800 Vali Acc: 0.919 Test Loss: 0.800 Test Acc: 0.919
Validation loss decreased (-0.903695 --> -0.918511).  Saving model ...
Epoch: 20 cost time: 0.5503063201904297
Epoch: 20, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.759 Vali Acc: 0.926 Test Loss: 0.759 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925918).  Saving model ...
Epoch: 21 cost time: 0.5396015644073486
Epoch: 21, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.719 Vali Acc: 0.930 Test Loss: 0.719 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929622).  Saving model ...
Epoch: 22 cost time: 0.5437374114990234
Epoch: 22, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.682 Vali Acc: 0.941 Test Loss: 0.682 Test Acc: 0.941
Validation loss decreased (-0.929622 --> -0.940734).  Saving model ...
Epoch: 23 cost time: 0.5149531364440918
Epoch: 23, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.645 Vali Acc: 0.941 Test Loss: 0.645 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940734).  Saving model ...
Epoch: 24 cost time: 0.520317792892456
Epoch: 24, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.611 Vali Acc: 0.944 Test Loss: 0.611 Test Acc: 0.944
Validation loss decreased (-0.940734 --> -0.944438).  Saving model ...
Epoch: 25 cost time: 0.5388903617858887
Epoch: 25, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.579 Vali Acc: 0.944 Test Loss: 0.579 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944439).  Saving model ...
Epoch: 26 cost time: 0.5989787578582764
Epoch: 26, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.550 Vali Acc: 0.944 Test Loss: 0.550 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 27 cost time: 0.5364775657653809
Epoch: 27, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.522 Vali Acc: 0.944 Test Loss: 0.522 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 28 cost time: 0.5362672805786133
Epoch: 28, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.496 Vali Acc: 0.944 Test Loss: 0.496 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 29 cost time: 0.5156154632568359
Epoch: 29, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.473 Vali Acc: 0.944 Test Loss: 0.473 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 30 cost time: 0.509437084197998
Epoch: 30, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.452 Vali Acc: 0.948 Test Loss: 0.452 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 357638
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1613521575927734
Epoch: 1, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.757 Vali Acc: 0.359 Test Loss: 1.757 Test Acc: 0.359
Validation loss decreased (inf --> -0.359242).  Saving model ...
Epoch: 2 cost time: 0.6315231323242188
Epoch: 2, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.723 Vali Acc: 0.374 Test Loss: 1.723 Test Acc: 0.374
Validation loss decreased (-0.359242 --> -0.374057).  Saving model ...
Epoch: 3 cost time: 0.5799448490142822
Epoch: 3, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.696 Vali Acc: 0.385 Test Loss: 1.696 Test Acc: 0.385
Validation loss decreased (-0.374057 --> -0.385168).  Saving model ...
Epoch: 4 cost time: 0.6022915840148926
Epoch: 4, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.669 Vali Acc: 0.404 Test Loss: 1.669 Test Acc: 0.404
Validation loss decreased (-0.385168 --> -0.403687).  Saving model ...
Epoch: 5 cost time: 0.637763261795044
Epoch: 5, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.634 Vali Acc: 0.419 Test Loss: 1.634 Test Acc: 0.419
Validation loss decreased (-0.403687 --> -0.418502).  Saving model ...
Epoch: 6 cost time: 0.5660910606384277
Epoch: 6, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.593 Vali Acc: 0.441 Test Loss: 1.593 Test Acc: 0.441
Validation loss decreased (-0.418502 --> -0.440725).  Saving model ...
Epoch: 7 cost time: 0.645057201385498
Epoch: 7, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.548 Vali Acc: 0.470 Test Loss: 1.548 Test Acc: 0.470
Validation loss decreased (-0.440725 --> -0.470355).  Saving model ...
Epoch: 8 cost time: 0.5854270458221436
Epoch: 8, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.499 Vali Acc: 0.507 Test Loss: 1.499 Test Acc: 0.507
Validation loss decreased (-0.470355 --> -0.507392).  Saving model ...
Epoch: 9 cost time: 0.5723080635070801
Epoch: 9, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.447 Vali Acc: 0.552 Test Loss: 1.447 Test Acc: 0.552
Validation loss decreased (-0.507392 --> -0.551837).  Saving model ...
Epoch: 10 cost time: 0.6195080280303955
Epoch: 10, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.394 Vali Acc: 0.585 Test Loss: 1.394 Test Acc: 0.585
Validation loss decreased (-0.551837 --> -0.585171).  Saving model ...
Epoch: 11 cost time: 0.5883216857910156
Epoch: 11, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.339 Vali Acc: 0.619 Test Loss: 1.339 Test Acc: 0.619
Validation loss decreased (-0.585171 --> -0.618505).  Saving model ...
Epoch: 12 cost time: 0.572502613067627
Epoch: 12, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.283 Vali Acc: 0.656 Test Loss: 1.283 Test Acc: 0.656
Validation loss decreased (-0.618505 --> -0.655543).  Saving model ...
Epoch: 13 cost time: 0.6319797039031982
Epoch: 13, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.225 Vali Acc: 0.681 Test Loss: 1.225 Test Acc: 0.681
Validation loss decreased (-0.655543 --> -0.681469).  Saving model ...
Epoch: 14 cost time: 0.6845846176147461
Epoch: 14, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.168 Vali Acc: 0.715 Test Loss: 1.168 Test Acc: 0.715
Validation loss decreased (-0.681469 --> -0.714803).  Saving model ...
Epoch: 15 cost time: 0.5822982788085938
Epoch: 15, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.111 Vali Acc: 0.741 Test Loss: 1.111 Test Acc: 0.741
Validation loss decreased (-0.714803 --> -0.740730).  Saving model ...
Epoch: 16 cost time: 0.5899934768676758
Epoch: 16, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.055 Vali Acc: 0.774 Test Loss: 1.055 Test Acc: 0.774
Validation loss decreased (-0.740730 --> -0.774064).  Saving model ...
Epoch: 17 cost time: 0.611785888671875
Epoch: 17, Steps: 2 | Train Loss: 0.882 Vali Loss: 1.002 Vali Acc: 0.789 Test Loss: 1.002 Test Acc: 0.789
Validation loss decreased (-0.774064 --> -0.788879).  Saving model ...
Epoch: 18 cost time: 0.6269042491912842
Epoch: 18, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.950 Vali Acc: 0.815 Test Loss: 0.950 Test Acc: 0.815
Validation loss decreased (-0.788879 --> -0.814805).  Saving model ...
Epoch: 19 cost time: 0.6168749332427979
Epoch: 19, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.900 Vali Acc: 0.822 Test Loss: 0.900 Test Acc: 0.822
Validation loss decreased (-0.814805 --> -0.822213).  Saving model ...
Epoch: 20 cost time: 0.6465063095092773
Epoch: 20, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.851 Vali Acc: 0.837 Test Loss: 0.851 Test Acc: 0.837
Validation loss decreased (-0.822213 --> -0.837029).  Saving model ...
Epoch: 21 cost time: 0.6119372844696045
Epoch: 21, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.804 Vali Acc: 0.837 Test Loss: 0.804 Test Acc: 0.837
Validation loss decreased (-0.837029 --> -0.837029).  Saving model ...
Epoch: 22 cost time: 0.6293764114379883
Epoch: 22, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.759 Vali Acc: 0.852 Test Loss: 0.759 Test Acc: 0.852
Validation loss decreased (-0.837029 --> -0.851844).  Saving model ...
Epoch: 23 cost time: 0.6239144802093506
Epoch: 23, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.716 Vali Acc: 0.870 Test Loss: 0.716 Test Acc: 0.870
Validation loss decreased (-0.851844 --> -0.870363).  Saving model ...
Epoch: 24 cost time: 0.5979328155517578
Epoch: 24, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.677 Vali Acc: 0.885 Test Loss: 0.677 Test Acc: 0.885
Validation loss decreased (-0.870363 --> -0.885178).  Saving model ...
Epoch: 25 cost time: 0.6186976432800293
Epoch: 25, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.641 Vali Acc: 0.881 Test Loss: 0.641 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6366353034973145
Epoch: 26, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.607 Vali Acc: 0.885 Test Loss: 0.607 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885179).  Saving model ...
Epoch: 27 cost time: 0.6514167785644531
Epoch: 27, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.577 Vali Acc: 0.885 Test Loss: 0.577 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885179).  Saving model ...
Epoch: 28 cost time: 0.6205060482025146
Epoch: 28, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.549 Vali Acc: 0.889 Test Loss: 0.549 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 29 cost time: 0.657665491104126
Epoch: 29, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.523 Vali Acc: 0.896 Test Loss: 0.523 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 30 cost time: 0.5820107460021973
Epoch: 30, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.500 Vali Acc: 0.904 Test Loss: 0.500 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 1185286
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.025646448135376
Epoch: 1, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.558 Vali Acc: 0.493 Test Loss: 1.558 Test Acc: 0.493
Validation loss decreased (inf --> -0.492577).  Saving model ...
Epoch: 2 cost time: 0.4909234046936035
Epoch: 2, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.525 Vali Acc: 0.559 Test Loss: 1.525 Test Acc: 0.559
Validation loss decreased (-0.492577 --> -0.559244).  Saving model ...
Epoch: 3 cost time: 0.5207746028900146
Epoch: 3, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.499 Vali Acc: 0.589 Test Loss: 1.499 Test Acc: 0.589
Validation loss decreased (-0.559244 --> -0.588874).  Saving model ...
Epoch: 4 cost time: 0.4838688373565674
Epoch: 4, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.475 Vali Acc: 0.626 Test Loss: 1.475 Test Acc: 0.626
Validation loss decreased (-0.588874 --> -0.625911).  Saving model ...
Epoch: 5 cost time: 0.4687011241912842
Epoch: 5, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.443 Vali Acc: 0.663 Test Loss: 1.443 Test Acc: 0.663
Validation loss decreased (-0.625911 --> -0.662949).  Saving model ...
Epoch: 6 cost time: 0.47924351692199707
Epoch: 6, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.406 Vali Acc: 0.700 Test Loss: 1.406 Test Acc: 0.700
Validation loss decreased (-0.662949 --> -0.699986).  Saving model ...
Epoch: 7 cost time: 0.47724080085754395
Epoch: 7, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.365 Vali Acc: 0.733 Test Loss: 1.365 Test Acc: 0.733
Validation loss decreased (-0.699986 --> -0.733320).  Saving model ...
Epoch: 8 cost time: 0.434506893157959
Epoch: 8, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.320 Vali Acc: 0.748 Test Loss: 1.320 Test Acc: 0.748
Validation loss decreased (-0.733320 --> -0.748135).  Saving model ...
Epoch: 9 cost time: 0.4776792526245117
Epoch: 9, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.274 Vali Acc: 0.767 Test Loss: 1.274 Test Acc: 0.767
Validation loss decreased (-0.748135 --> -0.766654).  Saving model ...
Epoch: 10 cost time: 0.5228679180145264
Epoch: 10, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.226 Vali Acc: 0.796 Test Loss: 1.226 Test Acc: 0.796
Validation loss decreased (-0.766654 --> -0.796284).  Saving model ...
Epoch: 11 cost time: 0.48000144958496094
Epoch: 11, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.177 Vali Acc: 0.811 Test Loss: 1.177 Test Acc: 0.811
Validation loss decreased (-0.796284 --> -0.811099).  Saving model ...
Epoch: 12 cost time: 0.4928603172302246
Epoch: 12, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.129 Vali Acc: 0.819 Test Loss: 1.129 Test Acc: 0.819
Validation loss decreased (-0.811099 --> -0.818507).  Saving model ...
Epoch: 13 cost time: 0.5058009624481201
Epoch: 13, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.081 Vali Acc: 0.841 Test Loss: 1.081 Test Acc: 0.841
Validation loss decreased (-0.818507 --> -0.840730).  Saving model ...
Epoch: 14 cost time: 0.5259668827056885
Epoch: 14, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.032 Vali Acc: 0.856 Test Loss: 1.032 Test Acc: 0.856
Validation loss decreased (-0.840730 --> -0.855545).  Saving model ...
Epoch: 15 cost time: 0.4966771602630615
Epoch: 15, Steps: 2 | Train Loss: 0.960 Vali Loss: 0.984 Vali Acc: 0.870 Test Loss: 0.984 Test Acc: 0.870
Validation loss decreased (-0.855545 --> -0.870361).  Saving model ...
Epoch: 16 cost time: 0.42626070976257324
Epoch: 16, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.936 Vali Acc: 0.874 Test Loss: 0.936 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874065).  Saving model ...
Epoch: 17 cost time: 0.538323163986206
Epoch: 17, Steps: 2 | Train Loss: 0.832 Vali Loss: 0.890 Vali Acc: 0.893 Test Loss: 0.890 Test Acc: 0.893
Validation loss decreased (-0.874065 --> -0.892584).  Saving model ...
Epoch: 18 cost time: 0.5078117847442627
Epoch: 18, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.844 Vali Acc: 0.904 Test Loss: 0.844 Test Acc: 0.904
Validation loss decreased (-0.892584 --> -0.903695).  Saving model ...
Epoch: 19 cost time: 0.4903380870819092
Epoch: 19, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.800 Vali Acc: 0.919 Test Loss: 0.800 Test Acc: 0.919
Validation loss decreased (-0.903695 --> -0.918511).  Saving model ...
Epoch: 20 cost time: 0.5684213638305664
Epoch: 20, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.759 Vali Acc: 0.926 Test Loss: 0.759 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925918).  Saving model ...
Epoch: 21 cost time: 0.49102258682250977
Epoch: 21, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.719 Vali Acc: 0.930 Test Loss: 0.719 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929622).  Saving model ...
Epoch: 22 cost time: 0.46520447731018066
Epoch: 22, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.682 Vali Acc: 0.941 Test Loss: 0.682 Test Acc: 0.941
Validation loss decreased (-0.929622 --> -0.940734).  Saving model ...
Epoch: 23 cost time: 0.4799227714538574
Epoch: 23, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.645 Vali Acc: 0.941 Test Loss: 0.645 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940734).  Saving model ...
Epoch: 24 cost time: 0.5063352584838867
Epoch: 24, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.611 Vali Acc: 0.944 Test Loss: 0.611 Test Acc: 0.944
Validation loss decreased (-0.940734 --> -0.944438).  Saving model ...
Epoch: 25 cost time: 0.4923064708709717
Epoch: 25, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.579 Vali Acc: 0.944 Test Loss: 0.579 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944439).  Saving model ...
Epoch: 26 cost time: 0.475327730178833
Epoch: 26, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.550 Vali Acc: 0.944 Test Loss: 0.550 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 27 cost time: 0.4674339294433594
Epoch: 27, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.522 Vali Acc: 0.944 Test Loss: 0.522 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 28 cost time: 0.5027456283569336
Epoch: 28, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.496 Vali Acc: 0.944 Test Loss: 0.496 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 29 cost time: 0.5309407711029053
Epoch: 29, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.473 Vali Acc: 0.944 Test Loss: 0.473 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 30 cost time: 0.5289826393127441
Epoch: 30, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.452 Vali Acc: 0.948 Test Loss: 0.452 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 357638
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9103214740753174
Epoch: 1, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.757 Vali Acc: 0.359 Test Loss: 1.757 Test Acc: 0.359
Validation loss decreased (inf --> -0.359242).  Saving model ...
Epoch: 2 cost time: 0.47131896018981934
Epoch: 2, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.722 Vali Acc: 0.374 Test Loss: 1.722 Test Acc: 0.374
Validation loss decreased (-0.359242 --> -0.374057).  Saving model ...
Epoch: 3 cost time: 0.46692562103271484
Epoch: 3, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.695 Vali Acc: 0.385 Test Loss: 1.695 Test Acc: 0.385
Validation loss decreased (-0.374057 --> -0.385168).  Saving model ...
Epoch: 4 cost time: 0.450467586517334
Epoch: 4, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.668 Vali Acc: 0.404 Test Loss: 1.668 Test Acc: 0.404
Validation loss decreased (-0.385168 --> -0.403687).  Saving model ...
Epoch: 5 cost time: 0.4510490894317627
Epoch: 5, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.634 Vali Acc: 0.419 Test Loss: 1.634 Test Acc: 0.419
Validation loss decreased (-0.403687 --> -0.418502).  Saving model ...
Epoch: 6 cost time: 0.46572399139404297
Epoch: 6, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.594 Vali Acc: 0.441 Test Loss: 1.594 Test Acc: 0.441
Validation loss decreased (-0.418502 --> -0.440725).  Saving model ...
Epoch: 7 cost time: 0.4678623676300049
Epoch: 7, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.549 Vali Acc: 0.470 Test Loss: 1.549 Test Acc: 0.470
Validation loss decreased (-0.440725 --> -0.470355).  Saving model ...
Epoch: 8 cost time: 0.4463968276977539
Epoch: 8, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.501 Vali Acc: 0.500 Test Loss: 1.501 Test Acc: 0.500
Validation loss decreased (-0.470355 --> -0.499985).  Saving model ...
Epoch: 9 cost time: 0.42901062965393066
Epoch: 9, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.450 Vali Acc: 0.548 Test Loss: 1.450 Test Acc: 0.548
Validation loss decreased (-0.499985 --> -0.548134).  Saving model ...
Epoch: 10 cost time: 0.44929051399230957
Epoch: 10, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.396 Vali Acc: 0.570 Test Loss: 1.396 Test Acc: 0.570
Validation loss decreased (-0.548134 --> -0.570356).  Saving model ...
Epoch: 11 cost time: 0.4406473636627197
Epoch: 11, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.342 Vali Acc: 0.611 Test Loss: 1.342 Test Acc: 0.611
Validation loss decreased (-0.570356 --> -0.611098).  Saving model ...
Epoch: 12 cost time: 0.431567907333374
Epoch: 12, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.286 Vali Acc: 0.652 Test Loss: 1.286 Test Acc: 0.652
Validation loss decreased (-0.611098 --> -0.651839).  Saving model ...
Epoch: 13 cost time: 0.4745349884033203
Epoch: 13, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.230 Vali Acc: 0.678 Test Loss: 1.230 Test Acc: 0.678
Validation loss decreased (-0.651839 --> -0.677765).  Saving model ...
Epoch: 14 cost time: 0.4540364742279053
Epoch: 14, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.173 Vali Acc: 0.719 Test Loss: 1.173 Test Acc: 0.719
Validation loss decreased (-0.677765 --> -0.718507).  Saving model ...
Epoch: 15 cost time: 0.43384861946105957
Epoch: 15, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.116 Vali Acc: 0.744 Test Loss: 1.116 Test Acc: 0.744
Validation loss decreased (-0.718507 --> -0.744433).  Saving model ...
Epoch: 16 cost time: 0.4784832000732422
Epoch: 16, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.061 Vali Acc: 0.770 Test Loss: 1.061 Test Acc: 0.770
Validation loss decreased (-0.744433 --> -0.770360).  Saving model ...
Epoch: 17 cost time: 0.4649069309234619
Epoch: 17, Steps: 2 | Train Loss: 0.894 Vali Loss: 1.008 Vali Acc: 0.778 Test Loss: 1.008 Test Acc: 0.778
Validation loss decreased (-0.770360 --> -0.777768).  Saving model ...
Epoch: 18 cost time: 0.4694638252258301
Epoch: 18, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.956 Vali Acc: 0.811 Test Loss: 0.956 Test Acc: 0.811
Validation loss decreased (-0.777768 --> -0.811102).  Saving model ...
Epoch: 19 cost time: 0.46895337104797363
Epoch: 19, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.906 Vali Acc: 0.826 Test Loss: 0.906 Test Acc: 0.826
Validation loss decreased (-0.811102 --> -0.825917).  Saving model ...
Epoch: 20 cost time: 0.5306272506713867
Epoch: 20, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.857 Vali Acc: 0.833 Test Loss: 0.857 Test Acc: 0.833
Validation loss decreased (-0.825917 --> -0.833325).  Saving model ...
Epoch: 21 cost time: 0.5002717971801758
Epoch: 21, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.810 Vali Acc: 0.833 Test Loss: 0.810 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833325).  Saving model ...
Epoch: 22 cost time: 0.47756123542785645
Epoch: 22, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.765 Vali Acc: 0.841 Test Loss: 0.765 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840733).  Saving model ...
Epoch: 23 cost time: 0.481783390045166
Epoch: 23, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.722 Vali Acc: 0.870 Test Loss: 0.722 Test Acc: 0.870
Validation loss decreased (-0.840733 --> -0.870363).  Saving model ...
Epoch: 24 cost time: 0.45232105255126953
Epoch: 24, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.682 Vali Acc: 0.885 Test Loss: 0.682 Test Acc: 0.885
Validation loss decreased (-0.870363 --> -0.885178).  Saving model ...
Epoch: 25 cost time: 0.4817037582397461
Epoch: 25, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.646 Vali Acc: 0.885 Test Loss: 0.646 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885179).  Saving model ...
Epoch: 26 cost time: 0.455981969833374
Epoch: 26, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.612 Vali Acc: 0.889 Test Loss: 0.612 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 27 cost time: 0.4538097381591797
Epoch: 27, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.581 Vali Acc: 0.893 Test Loss: 0.581 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 28 cost time: 0.461437463760376
Epoch: 28, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.553 Vali Acc: 0.896 Test Loss: 0.553 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 29 cost time: 0.48555588722229004
Epoch: 29, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.528 Vali Acc: 0.896 Test Loss: 0.528 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 30 cost time: 0.47887682914733887
Epoch: 30, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.505 Vali Acc: 0.900 Test Loss: 0.505 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 1185286
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.006561756134033
Epoch: 1, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.558 Vali Acc: 0.493 Test Loss: 1.558 Test Acc: 0.493
Validation loss decreased (inf --> -0.492577).  Saving model ...
Epoch: 2 cost time: 0.47900962829589844
Epoch: 2, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.524 Vali Acc: 0.552 Test Loss: 1.524 Test Acc: 0.552
Validation loss decreased (-0.492577 --> -0.551837).  Saving model ...
Epoch: 3 cost time: 0.44608235359191895
Epoch: 3, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.499 Vali Acc: 0.585 Test Loss: 1.499 Test Acc: 0.585
Validation loss decreased (-0.551837 --> -0.585170).  Saving model ...
Epoch: 4 cost time: 0.4394347667694092
Epoch: 4, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.474 Vali Acc: 0.626 Test Loss: 1.474 Test Acc: 0.626
Validation loss decreased (-0.585170 --> -0.625911).  Saving model ...
Epoch: 5 cost time: 0.45031237602233887
Epoch: 5, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.443 Vali Acc: 0.663 Test Loss: 1.443 Test Acc: 0.663
Validation loss decreased (-0.625911 --> -0.662949).  Saving model ...
Epoch: 6 cost time: 0.4585444927215576
Epoch: 6, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.406 Vali Acc: 0.700 Test Loss: 1.406 Test Acc: 0.700
Validation loss decreased (-0.662949 --> -0.699986).  Saving model ...
Epoch: 7 cost time: 0.4158303737640381
Epoch: 7, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.364 Vali Acc: 0.730 Test Loss: 1.364 Test Acc: 0.730
Validation loss decreased (-0.699986 --> -0.729616).  Saving model ...
Epoch: 8 cost time: 0.4594595432281494
Epoch: 8, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.320 Vali Acc: 0.748 Test Loss: 1.320 Test Acc: 0.748
Validation loss decreased (-0.729616 --> -0.748135).  Saving model ...
Epoch: 9 cost time: 0.46248579025268555
Epoch: 9, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.274 Vali Acc: 0.767 Test Loss: 1.274 Test Acc: 0.767
Validation loss decreased (-0.748135 --> -0.766654).  Saving model ...
Epoch: 10 cost time: 0.47238993644714355
Epoch: 10, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.226 Vali Acc: 0.796 Test Loss: 1.226 Test Acc: 0.796
Validation loss decreased (-0.766654 --> -0.796284).  Saving model ...
Epoch: 11 cost time: 0.4592766761779785
Epoch: 11, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.178 Vali Acc: 0.811 Test Loss: 1.178 Test Acc: 0.811
Validation loss decreased (-0.796284 --> -0.811099).  Saving model ...
Epoch: 12 cost time: 0.4502086639404297
Epoch: 12, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.130 Vali Acc: 0.819 Test Loss: 1.130 Test Acc: 0.819
Validation loss decreased (-0.811099 --> -0.818507).  Saving model ...
Epoch: 13 cost time: 0.4443991184234619
Epoch: 13, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.081 Vali Acc: 0.837 Test Loss: 1.081 Test Acc: 0.837
Validation loss decreased (-0.818507 --> -0.837026).  Saving model ...
Epoch: 14 cost time: 0.4552154541015625
Epoch: 14, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.033 Vali Acc: 0.852 Test Loss: 1.033 Test Acc: 0.852
Validation loss decreased (-0.837026 --> -0.851842).  Saving model ...
Epoch: 15 cost time: 0.4668607711791992
Epoch: 15, Steps: 2 | Train Loss: 0.968 Vali Loss: 0.985 Vali Acc: 0.870 Test Loss: 0.985 Test Acc: 0.870
Validation loss decreased (-0.851842 --> -0.870361).  Saving model ...
Epoch: 16 cost time: 0.45697450637817383
Epoch: 16, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.937 Vali Acc: 0.874 Test Loss: 0.937 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874065).  Saving model ...
Epoch: 17 cost time: 0.4618346691131592
Epoch: 17, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.891 Vali Acc: 0.889 Test Loss: 0.891 Test Acc: 0.889
Validation loss decreased (-0.874065 --> -0.888880).  Saving model ...
Epoch: 18 cost time: 0.4862992763519287
Epoch: 18, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.845 Vali Acc: 0.904 Test Loss: 0.845 Test Acc: 0.904
Validation loss decreased (-0.888880 --> -0.903695).  Saving model ...
Epoch: 19 cost time: 0.46250224113464355
Epoch: 19, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.801 Vali Acc: 0.915 Test Loss: 0.801 Test Acc: 0.915
Validation loss decreased (-0.903695 --> -0.914807).  Saving model ...
Epoch: 20 cost time: 0.42314672470092773
Epoch: 20, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.760 Vali Acc: 0.926 Test Loss: 0.760 Test Acc: 0.926
Validation loss decreased (-0.914807 --> -0.925918).  Saving model ...
Epoch: 21 cost time: 0.43619370460510254
Epoch: 21, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.720 Vali Acc: 0.930 Test Loss: 0.720 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929622).  Saving model ...
Epoch: 22 cost time: 0.45560526847839355
Epoch: 22, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.682 Vali Acc: 0.941 Test Loss: 0.682 Test Acc: 0.941
Validation loss decreased (-0.929622 --> -0.940734).  Saving model ...
Epoch: 23 cost time: 0.48713231086730957
Epoch: 23, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.646 Vali Acc: 0.941 Test Loss: 0.646 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940734).  Saving model ...
Epoch: 24 cost time: 0.4744453430175781
Epoch: 24, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.612 Vali Acc: 0.944 Test Loss: 0.612 Test Acc: 0.944
Validation loss decreased (-0.940734 --> -0.944438).  Saving model ...
Epoch: 25 cost time: 0.493269681930542
Epoch: 25, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.580 Vali Acc: 0.944 Test Loss: 0.580 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944439).  Saving model ...
Epoch: 26 cost time: 0.47156405448913574
Epoch: 26, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.550 Vali Acc: 0.944 Test Loss: 0.550 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 27 cost time: 0.45473718643188477
Epoch: 27, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.522 Vali Acc: 0.944 Test Loss: 0.522 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 28 cost time: 0.49070191383361816
Epoch: 28, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.496 Vali Acc: 0.944 Test Loss: 0.496 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 29 cost time: 0.5033867359161377
Epoch: 29, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.473 Vali Acc: 0.944 Test Loss: 0.473 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 30 cost time: 0.4944119453430176
Epoch: 30, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.452 Vali Acc: 0.948 Test Loss: 0.452 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 357638
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.288153886795044
Epoch: 1, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.938 Vali Acc: 0.148 Test Loss: 1.938 Test Acc: 0.148
Validation loss decreased (inf --> -0.148129).  Saving model ...
Epoch: 2 cost time: 0.6293463706970215
Epoch: 2, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.907 Vali Acc: 0.152 Test Loss: 1.907 Test Acc: 0.152
Validation loss decreased (-0.148129 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 0.6635663509368896
Epoch: 3, Steps: 2 | Train Loss: 1.957 Vali Loss: 1.886 Vali Acc: 0.163 Test Loss: 1.886 Test Acc: 0.163
Validation loss decreased (-0.151833 --> -0.162944).  Saving model ...
Epoch: 4 cost time: 0.6969242095947266
Epoch: 4, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.870 Vali Acc: 0.167 Test Loss: 1.870 Test Acc: 0.167
Validation loss decreased (-0.162944 --> -0.166648).  Saving model ...
Epoch: 5 cost time: 0.6184782981872559
Epoch: 5, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.849 Vali Acc: 0.163 Test Loss: 1.849 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6287167072296143
Epoch: 6, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.825 Vali Acc: 0.170 Test Loss: 1.825 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170352).  Saving model ...
Epoch: 7 cost time: 0.6803305149078369
Epoch: 7, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.797 Vali Acc: 0.178 Test Loss: 1.797 Test Acc: 0.178
Validation loss decreased (-0.170352 --> -0.177760).  Saving model ...
Epoch: 8 cost time: 0.6359777450561523
Epoch: 8, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.767 Vali Acc: 0.196 Test Loss: 1.767 Test Acc: 0.196
Validation loss decreased (-0.177760 --> -0.196279).  Saving model ...
Epoch: 9 cost time: 0.6391482353210449
Epoch: 9, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.736 Vali Acc: 0.219 Test Loss: 1.736 Test Acc: 0.219
Validation loss decreased (-0.196279 --> -0.218501).  Saving model ...
Epoch: 10 cost time: 0.6351046562194824
Epoch: 10, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.703 Vali Acc: 0.256 Test Loss: 1.703 Test Acc: 0.256
Validation loss decreased (-0.218501 --> -0.255539).  Saving model ...
Epoch: 11 cost time: 0.6303679943084717
Epoch: 11, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.668 Vali Acc: 0.289 Test Loss: 1.668 Test Acc: 0.289
Validation loss decreased (-0.255539 --> -0.288872).  Saving model ...
Epoch: 12 cost time: 0.6318528652191162
Epoch: 12, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.632 Vali Acc: 0.319 Test Loss: 1.632 Test Acc: 0.319
Validation loss decreased (-0.288872 --> -0.318502).  Saving model ...
Epoch: 13 cost time: 0.617063045501709
Epoch: 13, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.594 Vali Acc: 0.363 Test Loss: 1.594 Test Acc: 0.363
Validation loss decreased (-0.318502 --> -0.362947).  Saving model ...
Epoch: 14 cost time: 0.633084774017334
Epoch: 14, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.555 Vali Acc: 0.396 Test Loss: 1.555 Test Acc: 0.396
Validation loss decreased (-0.362947 --> -0.396281).  Saving model ...
Epoch: 15 cost time: 0.6494958400726318
Epoch: 15, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.515 Vali Acc: 0.459 Test Loss: 1.515 Test Acc: 0.459
Validation loss decreased (-0.396281 --> -0.459244).  Saving model ...
Epoch: 16 cost time: 0.6145265102386475
Epoch: 16, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.474 Vali Acc: 0.504 Test Loss: 1.474 Test Acc: 0.504
Validation loss decreased (-0.459244 --> -0.503689).  Saving model ...
Epoch: 17 cost time: 0.6202781200408936
Epoch: 17, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.433 Vali Acc: 0.548 Test Loss: 1.433 Test Acc: 0.548
Validation loss decreased (-0.503689 --> -0.548134).  Saving model ...
Epoch: 18 cost time: 0.6289548873901367
Epoch: 18, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.391 Vali Acc: 0.570 Test Loss: 1.391 Test Acc: 0.570
Validation loss decreased (-0.548134 --> -0.570356).  Saving model ...
Epoch: 19 cost time: 0.7061333656311035
Epoch: 19, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.349 Vali Acc: 0.607 Test Loss: 1.349 Test Acc: 0.607
Validation loss decreased (-0.570356 --> -0.607394).  Saving model ...
Epoch: 20 cost time: 0.7724599838256836
Epoch: 20, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.307 Vali Acc: 0.633 Test Loss: 1.307 Test Acc: 0.633
Validation loss decreased (-0.607394 --> -0.633320).  Saving model ...
Epoch: 21 cost time: 0.6131930351257324
Epoch: 21, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.266 Vali Acc: 0.667 Test Loss: 1.266 Test Acc: 0.667
Validation loss decreased (-0.633320 --> -0.666654).  Saving model ...
Epoch: 22 cost time: 0.6484079360961914
Epoch: 22, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.224 Vali Acc: 0.696 Test Loss: 1.224 Test Acc: 0.696
Validation loss decreased (-0.666654 --> -0.696284).  Saving model ...
Epoch: 23 cost time: 0.6396543979644775
Epoch: 23, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.182 Vali Acc: 0.700 Test Loss: 1.182 Test Acc: 0.700
Validation loss decreased (-0.696284 --> -0.699988).  Saving model ...
Epoch: 24 cost time: 0.6200740337371826
Epoch: 24, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.140 Vali Acc: 0.719 Test Loss: 1.140 Test Acc: 0.719
Validation loss decreased (-0.699988 --> -0.718507).  Saving model ...
Epoch: 25 cost time: 0.6491556167602539
Epoch: 25, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.099 Vali Acc: 0.733 Test Loss: 1.099 Test Acc: 0.733
Validation loss decreased (-0.718507 --> -0.733322).  Saving model ...
Epoch: 26 cost time: 0.6766917705535889
Epoch: 26, Steps: 2 | Train Loss: 0.931 Vali Loss: 1.058 Vali Acc: 0.744 Test Loss: 1.058 Test Acc: 0.744
Validation loss decreased (-0.733322 --> -0.744434).  Saving model ...
Epoch: 27 cost time: 0.7077021598815918
Epoch: 27, Steps: 2 | Train Loss: 0.885 Vali Loss: 1.017 Vali Acc: 0.767 Test Loss: 1.017 Test Acc: 0.767
Validation loss decreased (-0.744434 --> -0.766656).  Saving model ...
Epoch: 28 cost time: 0.6296529769897461
Epoch: 28, Steps: 2 | Train Loss: 0.870 Vali Loss: 0.978 Vali Acc: 0.781 Test Loss: 0.978 Test Acc: 0.781
Validation loss decreased (-0.766656 --> -0.781472).  Saving model ...
Epoch: 29 cost time: 0.642401933670044
Epoch: 29, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.939 Vali Acc: 0.796 Test Loss: 0.939 Test Acc: 0.796
Validation loss decreased (-0.781472 --> -0.796287).  Saving model ...
Epoch: 30 cost time: 0.6404972076416016
Epoch: 30, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.901 Vali Acc: 0.807 Test Loss: 0.901 Test Acc: 0.807
Validation loss decreased (-0.796287 --> -0.807398).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8074074074074075
model parameter : 1178950
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3508222103118896
Epoch: 1, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.820 Vali Acc: 0.119 Test Loss: 1.820 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.6119627952575684
Epoch: 2, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.795 Vali Acc: 0.141 Test Loss: 1.795 Test Acc: 0.141
Validation loss decreased (-0.118500 --> -0.140723).  Saving model ...
Epoch: 3 cost time: 0.5593838691711426
Epoch: 3, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.777 Vali Acc: 0.152 Test Loss: 1.777 Test Acc: 0.152
Validation loss decreased (-0.140723 --> -0.151834).  Saving model ...
Epoch: 4 cost time: 0.5926501750946045
Epoch: 4, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.762 Vali Acc: 0.163 Test Loss: 1.762 Test Acc: 0.163
Validation loss decreased (-0.151834 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 0.5653207302093506
Epoch: 5, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.742 Vali Acc: 0.181 Test Loss: 1.742 Test Acc: 0.181
Validation loss decreased (-0.162945 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.5604119300842285
Epoch: 6, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.719 Vali Acc: 0.200 Test Loss: 1.719 Test Acc: 0.200
Validation loss decreased (-0.181464 --> -0.199983).  Saving model ...
Epoch: 7 cost time: 0.545233964920044
Epoch: 7, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.693 Vali Acc: 0.230 Test Loss: 1.693 Test Acc: 0.230
Validation loss decreased (-0.199983 --> -0.229613).  Saving model ...
Epoch: 8 cost time: 0.5900843143463135
Epoch: 8, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.664 Vali Acc: 0.278 Test Loss: 1.664 Test Acc: 0.278
Validation loss decreased (-0.229613 --> -0.277761).  Saving model ...
Epoch: 9 cost time: 0.5647430419921875
Epoch: 9, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.633 Vali Acc: 0.296 Test Loss: 1.633 Test Acc: 0.296
Validation loss decreased (-0.277761 --> -0.296280).  Saving model ...
Epoch: 10 cost time: 0.5815222263336182
Epoch: 10, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.601 Vali Acc: 0.344 Test Loss: 1.601 Test Acc: 0.344
Validation loss decreased (-0.296280 --> -0.344428).  Saving model ...
Epoch: 11 cost time: 0.6314902305603027
Epoch: 11, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.567 Vali Acc: 0.411 Test Loss: 1.567 Test Acc: 0.411
Validation loss decreased (-0.344428 --> -0.411095).  Saving model ...
Epoch: 12 cost time: 0.5767116546630859
Epoch: 12, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.532 Vali Acc: 0.485 Test Loss: 1.532 Test Acc: 0.485
Validation loss decreased (-0.411095 --> -0.485170).  Saving model ...
Epoch: 13 cost time: 0.5942440032958984
Epoch: 13, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.496 Vali Acc: 0.533 Test Loss: 1.496 Test Acc: 0.533
Validation loss decreased (-0.485170 --> -0.533318).  Saving model ...
Epoch: 14 cost time: 0.6059718132019043
Epoch: 14, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.459 Vali Acc: 0.567 Test Loss: 1.459 Test Acc: 0.567
Validation loss decreased (-0.533318 --> -0.566652).  Saving model ...
Epoch: 15 cost time: 0.5841927528381348
Epoch: 15, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.420 Vali Acc: 0.596 Test Loss: 1.420 Test Acc: 0.596
Validation loss decreased (-0.566652 --> -0.596282).  Saving model ...
Epoch: 16 cost time: 0.5645394325256348
Epoch: 16, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.381 Vali Acc: 0.641 Test Loss: 1.381 Test Acc: 0.641
Validation loss decreased (-0.596282 --> -0.640727).  Saving model ...
Epoch: 17 cost time: 0.6126933097839355
Epoch: 17, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.340 Vali Acc: 0.678 Test Loss: 1.340 Test Acc: 0.678
Validation loss decreased (-0.640727 --> -0.677764).  Saving model ...
Epoch: 18 cost time: 0.6740748882293701
Epoch: 18, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.300 Vali Acc: 0.689 Test Loss: 1.300 Test Acc: 0.689
Validation loss decreased (-0.677764 --> -0.688876).  Saving model ...
Epoch: 19 cost time: 0.6181190013885498
Epoch: 19, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.260 Vali Acc: 0.704 Test Loss: 1.260 Test Acc: 0.704
Validation loss decreased (-0.688876 --> -0.703691).  Saving model ...
Epoch: 20 cost time: 0.6076211929321289
Epoch: 20, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.220 Vali Acc: 0.715 Test Loss: 1.220 Test Acc: 0.715
Validation loss decreased (-0.703691 --> -0.714803).  Saving model ...
Epoch: 21 cost time: 0.5985713005065918
Epoch: 21, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.180 Vali Acc: 0.744 Test Loss: 1.180 Test Acc: 0.744
Validation loss decreased (-0.714803 --> -0.744433).  Saving model ...
Epoch: 22 cost time: 0.6198287010192871
Epoch: 22, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.140 Vali Acc: 0.759 Test Loss: 1.140 Test Acc: 0.759
Validation loss decreased (-0.744433 --> -0.759248).  Saving model ...
Epoch: 23 cost time: 0.5337667465209961
Epoch: 23, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.101 Vali Acc: 0.770 Test Loss: 1.101 Test Acc: 0.770
Validation loss decreased (-0.759248 --> -0.770359).  Saving model ...
Epoch: 24 cost time: 0.5823850631713867
Epoch: 24, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.062 Vali Acc: 0.774 Test Loss: 1.062 Test Acc: 0.774
Validation loss decreased (-0.770359 --> -0.774063).  Saving model ...
Epoch: 25 cost time: 0.5914468765258789
Epoch: 25, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.023 Vali Acc: 0.778 Test Loss: 1.023 Test Acc: 0.778
Validation loss decreased (-0.774063 --> -0.777768).  Saving model ...
Epoch: 26 cost time: 0.5678715705871582
Epoch: 26, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.985 Vali Acc: 0.785 Test Loss: 0.985 Test Acc: 0.785
Validation loss decreased (-0.777768 --> -0.785175).  Saving model ...
Epoch: 27 cost time: 0.5841751098632812
Epoch: 27, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.949 Vali Acc: 0.800 Test Loss: 0.949 Test Acc: 0.800
Validation loss decreased (-0.785175 --> -0.799991).  Saving model ...
Epoch: 28 cost time: 0.5929837226867676
Epoch: 28, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.913 Vali Acc: 0.807 Test Loss: 0.913 Test Acc: 0.807
Validation loss decreased (-0.799991 --> -0.807398).  Saving model ...
Epoch: 29 cost time: 0.6131598949432373
Epoch: 29, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.879 Vali Acc: 0.796 Test Loss: 0.879 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6193721294403076
Epoch: 30, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.847 Vali Acc: 0.807 Test Loss: 0.847 Test Acc: 0.807
Validation loss decreased (-0.807398 --> -0.807399).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8074074074074075
model parameter : 351238
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2405130863189697
Epoch: 1, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.938 Vali Acc: 0.148 Test Loss: 1.938 Test Acc: 0.148
Validation loss decreased (inf --> -0.148129).  Saving model ...
Epoch: 2 cost time: 0.573434591293335
Epoch: 2, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.907 Vali Acc: 0.152 Test Loss: 1.907 Test Acc: 0.152
Validation loss decreased (-0.148129 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 0.5610713958740234
Epoch: 3, Steps: 2 | Train Loss: 1.957 Vali Loss: 1.886 Vali Acc: 0.163 Test Loss: 1.886 Test Acc: 0.163
Validation loss decreased (-0.151833 --> -0.162944).  Saving model ...
Epoch: 4 cost time: 0.5982491970062256
Epoch: 4, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.870 Vali Acc: 0.167 Test Loss: 1.870 Test Acc: 0.167
Validation loss decreased (-0.162944 --> -0.166648).  Saving model ...
Epoch: 5 cost time: 0.5728926658630371
Epoch: 5, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.849 Vali Acc: 0.163 Test Loss: 1.849 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5761990547180176
Epoch: 6, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.825 Vali Acc: 0.170 Test Loss: 1.825 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170352).  Saving model ...
Epoch: 7 cost time: 0.5941801071166992
Epoch: 7, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.797 Vali Acc: 0.178 Test Loss: 1.797 Test Acc: 0.178
Validation loss decreased (-0.170352 --> -0.177760).  Saving model ...
Epoch: 8 cost time: 0.5744688510894775
Epoch: 8, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.768 Vali Acc: 0.196 Test Loss: 1.768 Test Acc: 0.196
Validation loss decreased (-0.177760 --> -0.196279).  Saving model ...
Epoch: 9 cost time: 0.5995943546295166
Epoch: 9, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.736 Vali Acc: 0.219 Test Loss: 1.736 Test Acc: 0.219
Validation loss decreased (-0.196279 --> -0.218501).  Saving model ...
Epoch: 10 cost time: 0.6456756591796875
Epoch: 10, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.703 Vali Acc: 0.256 Test Loss: 1.703 Test Acc: 0.256
Validation loss decreased (-0.218501 --> -0.255539).  Saving model ...
Epoch: 11 cost time: 0.5750603675842285
Epoch: 11, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.668 Vali Acc: 0.289 Test Loss: 1.668 Test Acc: 0.289
Validation loss decreased (-0.255539 --> -0.288872).  Saving model ...
Epoch: 12 cost time: 0.5912435054779053
Epoch: 12, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.632 Vali Acc: 0.319 Test Loss: 1.632 Test Acc: 0.319
Validation loss decreased (-0.288872 --> -0.318502).  Saving model ...
Epoch: 13 cost time: 0.604938268661499
Epoch: 13, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.595 Vali Acc: 0.363 Test Loss: 1.595 Test Acc: 0.363
Validation loss decreased (-0.318502 --> -0.362947).  Saving model ...
Epoch: 14 cost time: 0.6053140163421631
Epoch: 14, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.556 Vali Acc: 0.396 Test Loss: 1.556 Test Acc: 0.396
Validation loss decreased (-0.362947 --> -0.396281).  Saving model ...
Epoch: 15 cost time: 0.5897889137268066
Epoch: 15, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.516 Vali Acc: 0.459 Test Loss: 1.516 Test Acc: 0.459
Validation loss decreased (-0.396281 --> -0.459244).  Saving model ...
Epoch: 16 cost time: 0.6076257228851318
Epoch: 16, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.475 Vali Acc: 0.500 Test Loss: 1.475 Test Acc: 0.500
Validation loss decreased (-0.459244 --> -0.499985).  Saving model ...
Epoch: 17 cost time: 0.5949203968048096
Epoch: 17, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.433 Vali Acc: 0.548 Test Loss: 1.433 Test Acc: 0.548
Validation loss decreased (-0.499985 --> -0.548134).  Saving model ...
Epoch: 18 cost time: 0.619457483291626
Epoch: 18, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.392 Vali Acc: 0.574 Test Loss: 1.392 Test Acc: 0.574
Validation loss decreased (-0.548134 --> -0.574060).  Saving model ...
Epoch: 19 cost time: 0.5930967330932617
Epoch: 19, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.350 Vali Acc: 0.607 Test Loss: 1.350 Test Acc: 0.607
Validation loss decreased (-0.574060 --> -0.607394).  Saving model ...
Epoch: 20 cost time: 0.5713770389556885
Epoch: 20, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.308 Vali Acc: 0.633 Test Loss: 1.308 Test Acc: 0.633
Validation loss decreased (-0.607394 --> -0.633320).  Saving model ...
Epoch: 21 cost time: 0.6003015041351318
Epoch: 21, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.266 Vali Acc: 0.667 Test Loss: 1.266 Test Acc: 0.667
Validation loss decreased (-0.633320 --> -0.666654).  Saving model ...
Epoch: 22 cost time: 0.5937850475311279
Epoch: 22, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.225 Vali Acc: 0.696 Test Loss: 1.225 Test Acc: 0.696
Validation loss decreased (-0.666654 --> -0.696284).  Saving model ...
Epoch: 23 cost time: 0.6230778694152832
Epoch: 23, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.183 Vali Acc: 0.700 Test Loss: 1.183 Test Acc: 0.700
Validation loss decreased (-0.696284 --> -0.699988).  Saving model ...
Epoch: 24 cost time: 0.5776944160461426
Epoch: 24, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.141 Vali Acc: 0.719 Test Loss: 1.141 Test Acc: 0.719
Validation loss decreased (-0.699988 --> -0.718507).  Saving model ...
Epoch: 25 cost time: 0.5895135402679443
Epoch: 25, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.100 Vali Acc: 0.733 Test Loss: 1.100 Test Acc: 0.733
Validation loss decreased (-0.718507 --> -0.733322).  Saving model ...
Epoch: 26 cost time: 0.575225830078125
Epoch: 26, Steps: 2 | Train Loss: 0.931 Vali Loss: 1.059 Vali Acc: 0.744 Test Loss: 1.059 Test Acc: 0.744
Validation loss decreased (-0.733322 --> -0.744434).  Saving model ...
Epoch: 27 cost time: 0.5654840469360352
Epoch: 27, Steps: 2 | Train Loss: 0.885 Vali Loss: 1.018 Vali Acc: 0.763 Test Loss: 1.018 Test Acc: 0.763
Validation loss decreased (-0.744434 --> -0.762953).  Saving model ...
Epoch: 28 cost time: 0.5936164855957031
Epoch: 28, Steps: 2 | Train Loss: 0.870 Vali Loss: 0.979 Vali Acc: 0.774 Test Loss: 0.979 Test Acc: 0.774
Validation loss decreased (-0.762953 --> -0.774064).  Saving model ...
Epoch: 29 cost time: 0.5762045383453369
Epoch: 29, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.940 Vali Acc: 0.796 Test Loss: 0.940 Test Acc: 0.796
Validation loss decreased (-0.774064 --> -0.796287).  Saving model ...
Epoch: 30 cost time: 0.6026954650878906
Epoch: 30, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.902 Vali Acc: 0.804 Test Loss: 0.902 Test Acc: 0.804
Validation loss decreased (-0.796287 --> -0.803695).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8037037037037037
model parameter : 1178950
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.132963180541992
Epoch: 1, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.820 Vali Acc: 0.119 Test Loss: 1.820 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.5104243755340576
Epoch: 2, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.795 Vali Acc: 0.141 Test Loss: 1.795 Test Acc: 0.141
Validation loss decreased (-0.118500 --> -0.140723).  Saving model ...
Epoch: 3 cost time: 0.4762892723083496
Epoch: 3, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.777 Vali Acc: 0.152 Test Loss: 1.777 Test Acc: 0.152
Validation loss decreased (-0.140723 --> -0.151834).  Saving model ...
Epoch: 4 cost time: 0.4811973571777344
Epoch: 4, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.762 Vali Acc: 0.163 Test Loss: 1.762 Test Acc: 0.163
Validation loss decreased (-0.151834 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 0.5088229179382324
Epoch: 5, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.742 Vali Acc: 0.181 Test Loss: 1.742 Test Acc: 0.181
Validation loss decreased (-0.162945 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.5223522186279297
Epoch: 6, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.719 Vali Acc: 0.200 Test Loss: 1.719 Test Acc: 0.200
Validation loss decreased (-0.181464 --> -0.199983).  Saving model ...
Epoch: 7 cost time: 0.5048189163208008
Epoch: 7, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.692 Vali Acc: 0.230 Test Loss: 1.692 Test Acc: 0.230
Validation loss decreased (-0.199983 --> -0.229613).  Saving model ...
Epoch: 8 cost time: 0.5158767700195312
Epoch: 8, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.664 Vali Acc: 0.278 Test Loss: 1.664 Test Acc: 0.278
Validation loss decreased (-0.229613 --> -0.277761).  Saving model ...
Epoch: 9 cost time: 0.5037169456481934
Epoch: 9, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.633 Vali Acc: 0.296 Test Loss: 1.633 Test Acc: 0.296
Validation loss decreased (-0.277761 --> -0.296280).  Saving model ...
Epoch: 10 cost time: 0.4870319366455078
Epoch: 10, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.601 Vali Acc: 0.344 Test Loss: 1.601 Test Acc: 0.344
Validation loss decreased (-0.296280 --> -0.344428).  Saving model ...
Epoch: 11 cost time: 0.5217635631561279
Epoch: 11, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.567 Vali Acc: 0.411 Test Loss: 1.567 Test Acc: 0.411
Validation loss decreased (-0.344428 --> -0.411095).  Saving model ...
Epoch: 12 cost time: 0.5029518604278564
Epoch: 12, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.532 Vali Acc: 0.489 Test Loss: 1.532 Test Acc: 0.489
Validation loss decreased (-0.411095 --> -0.488874).  Saving model ...
Epoch: 13 cost time: 0.4798140525817871
Epoch: 13, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.496 Vali Acc: 0.533 Test Loss: 1.496 Test Acc: 0.533
Validation loss decreased (-0.488874 --> -0.533318).  Saving model ...
Epoch: 14 cost time: 0.489513635635376
Epoch: 14, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.458 Vali Acc: 0.567 Test Loss: 1.458 Test Acc: 0.567
Validation loss decreased (-0.533318 --> -0.566652).  Saving model ...
Epoch: 15 cost time: 0.46979331970214844
Epoch: 15, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.420 Vali Acc: 0.596 Test Loss: 1.420 Test Acc: 0.596
Validation loss decreased (-0.566652 --> -0.596282).  Saving model ...
Epoch: 16 cost time: 0.47527647018432617
Epoch: 16, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.380 Vali Acc: 0.641 Test Loss: 1.380 Test Acc: 0.641
Validation loss decreased (-0.596282 --> -0.640727).  Saving model ...
Epoch: 17 cost time: 0.5535492897033691
Epoch: 17, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.340 Vali Acc: 0.678 Test Loss: 1.340 Test Acc: 0.678
Validation loss decreased (-0.640727 --> -0.677764).  Saving model ...
Epoch: 18 cost time: 0.5547738075256348
Epoch: 18, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.300 Vali Acc: 0.689 Test Loss: 1.300 Test Acc: 0.689
Validation loss decreased (-0.677764 --> -0.688876).  Saving model ...
Epoch: 19 cost time: 0.5645453929901123
Epoch: 19, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.260 Vali Acc: 0.704 Test Loss: 1.260 Test Acc: 0.704
Validation loss decreased (-0.688876 --> -0.703691).  Saving model ...
Epoch: 20 cost time: 0.6028742790222168
Epoch: 20, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.220 Vali Acc: 0.715 Test Loss: 1.220 Test Acc: 0.715
Validation loss decreased (-0.703691 --> -0.714803).  Saving model ...
Epoch: 21 cost time: 0.5618655681610107
Epoch: 21, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.180 Vali Acc: 0.744 Test Loss: 1.180 Test Acc: 0.744
Validation loss decreased (-0.714803 --> -0.744433).  Saving model ...
Epoch: 22 cost time: 0.5435876846313477
Epoch: 22, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.140 Vali Acc: 0.759 Test Loss: 1.140 Test Acc: 0.759
Validation loss decreased (-0.744433 --> -0.759248).  Saving model ...
Epoch: 23 cost time: 0.6026301383972168
Epoch: 23, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.101 Vali Acc: 0.770 Test Loss: 1.101 Test Acc: 0.770
Validation loss decreased (-0.759248 --> -0.770359).  Saving model ...
Epoch: 24 cost time: 0.5919420719146729
Epoch: 24, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.062 Vali Acc: 0.774 Test Loss: 1.062 Test Acc: 0.774
Validation loss decreased (-0.770359 --> -0.774063).  Saving model ...
Epoch: 25 cost time: 0.6265339851379395
Epoch: 25, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.024 Vali Acc: 0.778 Test Loss: 1.024 Test Acc: 0.778
Validation loss decreased (-0.774063 --> -0.777768).  Saving model ...
Epoch: 26 cost time: 0.5288276672363281
Epoch: 26, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.986 Vali Acc: 0.785 Test Loss: 0.986 Test Acc: 0.785
Validation loss decreased (-0.777768 --> -0.785175).  Saving model ...
Epoch: 27 cost time: 0.5834605693817139
Epoch: 27, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.949 Vali Acc: 0.800 Test Loss: 0.949 Test Acc: 0.800
Validation loss decreased (-0.785175 --> -0.799991).  Saving model ...
Epoch: 28 cost time: 0.4979875087738037
Epoch: 28, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.914 Vali Acc: 0.807 Test Loss: 0.914 Test Acc: 0.807
Validation loss decreased (-0.799991 --> -0.807398).  Saving model ...
Epoch: 29 cost time: 0.5165677070617676
Epoch: 29, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.880 Vali Acc: 0.800 Test Loss: 0.880 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5926687717437744
Epoch: 30, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.847 Vali Acc: 0.807 Test Loss: 0.847 Test Acc: 0.807
Validation loss decreased (-0.807398 --> -0.807399).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8074074074074075
model parameter : 351238
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.942582368850708
Epoch: 1, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.938 Vali Acc: 0.148 Test Loss: 1.938 Test Acc: 0.148
Validation loss decreased (inf --> -0.148129).  Saving model ...
Epoch: 2 cost time: 0.5204663276672363
Epoch: 2, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.907 Vali Acc: 0.152 Test Loss: 1.907 Test Acc: 0.152
Validation loss decreased (-0.148129 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 0.5032558441162109
Epoch: 3, Steps: 2 | Train Loss: 1.958 Vali Loss: 1.887 Vali Acc: 0.163 Test Loss: 1.887 Test Acc: 0.163
Validation loss decreased (-0.151833 --> -0.162944).  Saving model ...
Epoch: 4 cost time: 0.5145132541656494
Epoch: 4, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.871 Vali Acc: 0.167 Test Loss: 1.871 Test Acc: 0.167
Validation loss decreased (-0.162944 --> -0.166648).  Saving model ...
Epoch: 5 cost time: 0.5398831367492676
Epoch: 5, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.850 Vali Acc: 0.163 Test Loss: 1.850 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.48040318489074707
Epoch: 6, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.826 Vali Acc: 0.170 Test Loss: 1.826 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170352).  Saving model ...
Epoch: 7 cost time: 0.5050945281982422
Epoch: 7, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.799 Vali Acc: 0.178 Test Loss: 1.799 Test Acc: 0.178
Validation loss decreased (-0.170352 --> -0.177760).  Saving model ...
Epoch: 8 cost time: 0.4994359016418457
Epoch: 8, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.769 Vali Acc: 0.196 Test Loss: 1.769 Test Acc: 0.196
Validation loss decreased (-0.177760 --> -0.196279).  Saving model ...
Epoch: 9 cost time: 0.5206995010375977
Epoch: 9, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.738 Vali Acc: 0.219 Test Loss: 1.738 Test Acc: 0.219
Validation loss decreased (-0.196279 --> -0.218501).  Saving model ...
Epoch: 10 cost time: 0.5347049236297607
Epoch: 10, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.705 Vali Acc: 0.256 Test Loss: 1.705 Test Acc: 0.256
Validation loss decreased (-0.218501 --> -0.255539).  Saving model ...
Epoch: 11 cost time: 0.4953804016113281
Epoch: 11, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.671 Vali Acc: 0.289 Test Loss: 1.671 Test Acc: 0.289
Validation loss decreased (-0.255539 --> -0.288872).  Saving model ...
Epoch: 12 cost time: 0.4920816421508789
Epoch: 12, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.635 Vali Acc: 0.315 Test Loss: 1.635 Test Acc: 0.315
Validation loss decreased (-0.288872 --> -0.314798).  Saving model ...
Epoch: 13 cost time: 0.4985346794128418
Epoch: 13, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.598 Vali Acc: 0.359 Test Loss: 1.598 Test Acc: 0.359
Validation loss decreased (-0.314798 --> -0.359243).  Saving model ...
Epoch: 14 cost time: 0.49344921112060547
Epoch: 14, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.559 Vali Acc: 0.396 Test Loss: 1.559 Test Acc: 0.396
Validation loss decreased (-0.359243 --> -0.396281).  Saving model ...
Epoch: 15 cost time: 0.4979841709136963
Epoch: 15, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.519 Vali Acc: 0.456 Test Loss: 1.519 Test Acc: 0.456
Validation loss decreased (-0.396281 --> -0.455540).  Saving model ...
Epoch: 16 cost time: 0.504908561706543
Epoch: 16, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.479 Vali Acc: 0.496 Test Loss: 1.479 Test Acc: 0.496
Validation loss decreased (-0.455540 --> -0.496282).  Saving model ...
Epoch: 17 cost time: 0.5418808460235596
Epoch: 17, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.437 Vali Acc: 0.541 Test Loss: 1.437 Test Acc: 0.541
Validation loss decreased (-0.496282 --> -0.540726).  Saving model ...
Epoch: 18 cost time: 0.48802733421325684
Epoch: 18, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.396 Vali Acc: 0.570 Test Loss: 1.396 Test Acc: 0.570
Validation loss decreased (-0.540726 --> -0.570356).  Saving model ...
Epoch: 19 cost time: 0.5069928169250488
Epoch: 19, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.355 Vali Acc: 0.604 Test Loss: 1.355 Test Acc: 0.604
Validation loss decreased (-0.570356 --> -0.603690).  Saving model ...
Epoch: 20 cost time: 0.49189186096191406
Epoch: 20, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.313 Vali Acc: 0.626 Test Loss: 1.313 Test Acc: 0.626
Validation loss decreased (-0.603690 --> -0.625913).  Saving model ...
Epoch: 21 cost time: 0.49538683891296387
Epoch: 21, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.272 Vali Acc: 0.663 Test Loss: 1.272 Test Acc: 0.663
Validation loss decreased (-0.625913 --> -0.662950).  Saving model ...
Epoch: 22 cost time: 0.4985692501068115
Epoch: 22, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.230 Vali Acc: 0.693 Test Loss: 1.230 Test Acc: 0.693
Validation loss decreased (-0.662950 --> -0.692580).  Saving model ...
Epoch: 23 cost time: 0.4951043128967285
Epoch: 23, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.189 Vali Acc: 0.696 Test Loss: 1.189 Test Acc: 0.696
Validation loss decreased (-0.692580 --> -0.696284).  Saving model ...
Epoch: 24 cost time: 0.5218555927276611
Epoch: 24, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.147 Vali Acc: 0.719 Test Loss: 1.147 Test Acc: 0.719
Validation loss decreased (-0.696284 --> -0.718507).  Saving model ...
Epoch: 25 cost time: 0.49351930618286133
Epoch: 25, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.106 Vali Acc: 0.730 Test Loss: 1.106 Test Acc: 0.730
Validation loss decreased (-0.718507 --> -0.729619).  Saving model ...
Epoch: 26 cost time: 0.44113898277282715
Epoch: 26, Steps: 2 | Train Loss: 0.943 Vali Loss: 1.065 Vali Acc: 0.741 Test Loss: 1.065 Test Acc: 0.741
Validation loss decreased (-0.729619 --> -0.740730).  Saving model ...
Epoch: 27 cost time: 0.4891171455383301
Epoch: 27, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.025 Vali Acc: 0.759 Test Loss: 1.025 Test Acc: 0.759
Validation loss decreased (-0.740730 --> -0.759249).  Saving model ...
Epoch: 28 cost time: 0.496016263961792
Epoch: 28, Steps: 2 | Train Loss: 0.882 Vali Loss: 0.985 Vali Acc: 0.778 Test Loss: 0.985 Test Acc: 0.778
Validation loss decreased (-0.759249 --> -0.777768).  Saving model ...
Epoch: 29 cost time: 0.47624683380126953
Epoch: 29, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.946 Vali Acc: 0.789 Test Loss: 0.946 Test Acc: 0.789
Validation loss decreased (-0.777768 --> -0.788879).  Saving model ...
Epoch: 30 cost time: 0.6032102108001709
Epoch: 30, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.908 Vali Acc: 0.800 Test Loss: 0.908 Test Acc: 0.800
Validation loss decreased (-0.788879 --> -0.799991).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8
model parameter : 1178950
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9845190048217773
Epoch: 1, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.820 Vali Acc: 0.115 Test Loss: 1.820 Test Acc: 0.115
Validation loss decreased (inf --> -0.114797).  Saving model ...
Epoch: 2 cost time: 0.5069820880889893
Epoch: 2, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.795 Vali Acc: 0.144 Test Loss: 1.795 Test Acc: 0.144
Validation loss decreased (-0.114797 --> -0.144426).  Saving model ...
Epoch: 3 cost time: 0.44884276390075684
Epoch: 3, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.777 Vali Acc: 0.152 Test Loss: 1.777 Test Acc: 0.152
Validation loss decreased (-0.144426 --> -0.151834).  Saving model ...
Epoch: 4 cost time: 0.44890761375427246
Epoch: 4, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.762 Vali Acc: 0.163 Test Loss: 1.762 Test Acc: 0.163
Validation loss decreased (-0.151834 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 0.46498823165893555
Epoch: 5, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.742 Vali Acc: 0.181 Test Loss: 1.742 Test Acc: 0.181
Validation loss decreased (-0.162945 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.4588322639465332
Epoch: 6, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.719 Vali Acc: 0.200 Test Loss: 1.719 Test Acc: 0.200
Validation loss decreased (-0.181464 --> -0.199983).  Saving model ...
Epoch: 7 cost time: 0.44120216369628906
Epoch: 7, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.693 Vali Acc: 0.222 Test Loss: 1.693 Test Acc: 0.222
Validation loss decreased (-0.199983 --> -0.222205).  Saving model ...
Epoch: 8 cost time: 0.44859766960144043
Epoch: 8, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.664 Vali Acc: 0.270 Test Loss: 1.664 Test Acc: 0.270
Validation loss decreased (-0.222205 --> -0.270354).  Saving model ...
Epoch: 9 cost time: 0.4091811180114746
Epoch: 9, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.634 Vali Acc: 0.293 Test Loss: 1.634 Test Acc: 0.293
Validation loss decreased (-0.270354 --> -0.292576).  Saving model ...
Epoch: 10 cost time: 0.44864439964294434
Epoch: 10, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.602 Vali Acc: 0.337 Test Loss: 1.602 Test Acc: 0.337
Validation loss decreased (-0.292576 --> -0.337021).  Saving model ...
Epoch: 11 cost time: 0.4368288516998291
Epoch: 11, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.569 Vali Acc: 0.411 Test Loss: 1.569 Test Acc: 0.411
Validation loss decreased (-0.337021 --> -0.411095).  Saving model ...
Epoch: 12 cost time: 0.43082475662231445
Epoch: 12, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.534 Vali Acc: 0.485 Test Loss: 1.534 Test Acc: 0.485
Validation loss decreased (-0.411095 --> -0.485170).  Saving model ...
Epoch: 13 cost time: 0.4280374050140381
Epoch: 13, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.498 Vali Acc: 0.533 Test Loss: 1.498 Test Acc: 0.533
Validation loss decreased (-0.485170 --> -0.533318).  Saving model ...
Epoch: 14 cost time: 0.46837496757507324
Epoch: 14, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.461 Vali Acc: 0.563 Test Loss: 1.461 Test Acc: 0.563
Validation loss decreased (-0.533318 --> -0.562948).  Saving model ...
Epoch: 15 cost time: 0.4254748821258545
Epoch: 15, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.423 Vali Acc: 0.596 Test Loss: 1.423 Test Acc: 0.596
Validation loss decreased (-0.562948 --> -0.596282).  Saving model ...
Epoch: 16 cost time: 0.41693663597106934
Epoch: 16, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.384 Vali Acc: 0.641 Test Loss: 1.384 Test Acc: 0.641
Validation loss decreased (-0.596282 --> -0.640727).  Saving model ...
Epoch: 17 cost time: 0.43444013595581055
Epoch: 17, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.344 Vali Acc: 0.678 Test Loss: 1.344 Test Acc: 0.678
Validation loss decreased (-0.640727 --> -0.677764).  Saving model ...
Epoch: 18 cost time: 0.4437546730041504
Epoch: 18, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.304 Vali Acc: 0.685 Test Loss: 1.304 Test Acc: 0.685
Validation loss decreased (-0.677764 --> -0.685172).  Saving model ...
Epoch: 19 cost time: 0.44768738746643066
Epoch: 19, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.265 Vali Acc: 0.707 Test Loss: 1.265 Test Acc: 0.707
Validation loss decreased (-0.685172 --> -0.707395).  Saving model ...
Epoch: 20 cost time: 0.42034339904785156
Epoch: 20, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.225 Vali Acc: 0.719 Test Loss: 1.225 Test Acc: 0.719
Validation loss decreased (-0.707395 --> -0.718506).  Saving model ...
Epoch: 21 cost time: 0.4390544891357422
Epoch: 21, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.185 Vali Acc: 0.744 Test Loss: 1.185 Test Acc: 0.744
Validation loss decreased (-0.718506 --> -0.744433).  Saving model ...
Epoch: 22 cost time: 0.4207777976989746
Epoch: 22, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.145 Vali Acc: 0.759 Test Loss: 1.145 Test Acc: 0.759
Validation loss decreased (-0.744433 --> -0.759248).  Saving model ...
Epoch: 23 cost time: 0.48352837562561035
Epoch: 23, Steps: 2 | Train Loss: 0.970 Vali Loss: 1.106 Vali Acc: 0.770 Test Loss: 1.106 Test Acc: 0.770
Validation loss decreased (-0.759248 --> -0.770359).  Saving model ...
Epoch: 24 cost time: 0.4636189937591553
Epoch: 24, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.067 Vali Acc: 0.770 Test Loss: 1.067 Test Acc: 0.770
Validation loss decreased (-0.770359 --> -0.770360).  Saving model ...
Epoch: 25 cost time: 0.4156520366668701
Epoch: 25, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.028 Vali Acc: 0.785 Test Loss: 1.028 Test Acc: 0.785
Validation loss decreased (-0.770360 --> -0.785175).  Saving model ...
Epoch: 26 cost time: 0.4727175235748291
Epoch: 26, Steps: 2 | Train Loss: 0.907 Vali Loss: 0.990 Vali Acc: 0.785 Test Loss: 0.990 Test Acc: 0.785
Validation loss decreased (-0.785175 --> -0.785175).  Saving model ...
Epoch: 27 cost time: 0.4221761226654053
Epoch: 27, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.953 Vali Acc: 0.796 Test Loss: 0.953 Test Acc: 0.796
Validation loss decreased (-0.785175 --> -0.796287).  Saving model ...
Epoch: 28 cost time: 0.4263114929199219
Epoch: 28, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.917 Vali Acc: 0.804 Test Loss: 0.917 Test Acc: 0.804
Validation loss decreased (-0.796287 --> -0.803695).  Saving model ...
Epoch: 29 cost time: 0.43816685676574707
Epoch: 29, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.883 Vali Acc: 0.804 Test Loss: 0.883 Test Acc: 0.804
Validation loss decreased (-0.803695 --> -0.803695).  Saving model ...
Epoch: 30 cost time: 0.43665361404418945
Epoch: 30, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.849 Vali Acc: 0.804 Test Loss: 0.849 Test Acc: 0.804
Validation loss decreased (-0.803695 --> -0.803695).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8037037037037037
model parameter : 351238
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1464309692382812
Epoch: 1, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.901 Vali Acc: 0.137 Test Loss: 1.901 Test Acc: 0.137
Validation loss decreased (inf --> -0.137018).  Saving model ...
Epoch: 2 cost time: 0.5565183162689209
Epoch: 2, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.871 Vali Acc: 0.159 Test Loss: 1.871 Test Acc: 0.159
Validation loss decreased (-0.137018 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 0.5651180744171143
Epoch: 3, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.851 Vali Acc: 0.178 Test Loss: 1.851 Test Acc: 0.178
Validation loss decreased (-0.159241 --> -0.177759).  Saving model ...
Epoch: 4 cost time: 0.5877346992492676
Epoch: 4, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.836 Vali Acc: 0.196 Test Loss: 1.836 Test Acc: 0.196
Validation loss decreased (-0.177759 --> -0.196278).  Saving model ...
Epoch: 5 cost time: 0.6296203136444092
Epoch: 5, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.816 Vali Acc: 0.219 Test Loss: 1.816 Test Acc: 0.219
Validation loss decreased (-0.196278 --> -0.218500).  Saving model ...
Epoch: 6 cost time: 0.599916934967041
Epoch: 6, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.793 Vali Acc: 0.226 Test Loss: 1.793 Test Acc: 0.226
Validation loss decreased (-0.218500 --> -0.225908).  Saving model ...
Epoch: 7 cost time: 0.6063117980957031
Epoch: 7, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.767 Vali Acc: 0.285 Test Loss: 1.767 Test Acc: 0.285
Validation loss decreased (-0.225908 --> -0.285168).  Saving model ...
Epoch: 8 cost time: 0.6087603569030762
Epoch: 8, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.738 Vali Acc: 0.319 Test Loss: 1.738 Test Acc: 0.319
Validation loss decreased (-0.285168 --> -0.318501).  Saving model ...
Epoch: 9 cost time: 0.5988631248474121
Epoch: 9, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.707 Vali Acc: 0.367 Test Loss: 1.707 Test Acc: 0.367
Validation loss decreased (-0.318501 --> -0.366650).  Saving model ...
Epoch: 10 cost time: 0.5781769752502441
Epoch: 10, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.674 Vali Acc: 0.422 Test Loss: 1.674 Test Acc: 0.422
Validation loss decreased (-0.366650 --> -0.422205).  Saving model ...
Epoch: 11 cost time: 0.5897727012634277
Epoch: 11, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.639 Vali Acc: 0.448 Test Loss: 1.639 Test Acc: 0.448
Validation loss decreased (-0.422205 --> -0.448132).  Saving model ...
Epoch: 12 cost time: 0.5874907970428467
Epoch: 12, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.603 Vali Acc: 0.500 Test Loss: 1.603 Test Acc: 0.500
Validation loss decreased (-0.448132 --> -0.499984).  Saving model ...
Epoch: 13 cost time: 0.5971043109893799
Epoch: 13, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.565 Vali Acc: 0.541 Test Loss: 1.565 Test Acc: 0.541
Validation loss decreased (-0.499984 --> -0.540725).  Saving model ...
Epoch: 14 cost time: 0.6289875507354736
Epoch: 14, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.526 Vali Acc: 0.578 Test Loss: 1.526 Test Acc: 0.578
Validation loss decreased (-0.540725 --> -0.577763).  Saving model ...
Epoch: 15 cost time: 0.6027951240539551
Epoch: 15, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.486 Vali Acc: 0.593 Test Loss: 1.486 Test Acc: 0.593
Validation loss decreased (-0.577763 --> -0.592578).  Saving model ...
Epoch: 16 cost time: 0.6083884239196777
Epoch: 16, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.445 Vali Acc: 0.615 Test Loss: 1.445 Test Acc: 0.615
Validation loss decreased (-0.592578 --> -0.614800).  Saving model ...
Epoch: 17 cost time: 0.589531421661377
Epoch: 17, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.404 Vali Acc: 0.641 Test Loss: 1.404 Test Acc: 0.641
Validation loss decreased (-0.614800 --> -0.640727).  Saving model ...
Epoch: 18 cost time: 0.5720186233520508
Epoch: 18, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.364 Vali Acc: 0.659 Test Loss: 1.364 Test Acc: 0.659
Validation loss decreased (-0.640727 --> -0.659246).  Saving model ...
Epoch: 19 cost time: 0.6083459854125977
Epoch: 19, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.323 Vali Acc: 0.670 Test Loss: 1.323 Test Acc: 0.670
Validation loss decreased (-0.659246 --> -0.670357).  Saving model ...
Epoch: 20 cost time: 0.6619951725006104
Epoch: 20, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.281 Vali Acc: 0.681 Test Loss: 1.281 Test Acc: 0.681
Validation loss decreased (-0.670357 --> -0.681469).  Saving model ...
Epoch: 21 cost time: 0.5797555446624756
Epoch: 21, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.239 Vali Acc: 0.711 Test Loss: 1.239 Test Acc: 0.711
Validation loss decreased (-0.681469 --> -0.711099).  Saving model ...
Epoch: 22 cost time: 0.6278152465820312
Epoch: 22, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.198 Vali Acc: 0.726 Test Loss: 1.198 Test Acc: 0.726
Validation loss decreased (-0.711099 --> -0.725914).  Saving model ...
Epoch: 23 cost time: 0.6303977966308594
Epoch: 23, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.158 Vali Acc: 0.748 Test Loss: 1.158 Test Acc: 0.748
Validation loss decreased (-0.725914 --> -0.748137).  Saving model ...
Epoch: 24 cost time: 0.6186733245849609
Epoch: 24, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.117 Vali Acc: 0.770 Test Loss: 1.117 Test Acc: 0.770
Validation loss decreased (-0.748137 --> -0.770359).  Saving model ...
Epoch: 25 cost time: 0.6205189228057861
Epoch: 25, Steps: 2 | Train Loss: 0.903 Vali Loss: 1.076 Vali Acc: 0.785 Test Loss: 1.076 Test Acc: 0.785
Validation loss decreased (-0.770359 --> -0.785174).  Saving model ...
Epoch: 26 cost time: 0.6619062423706055
Epoch: 26, Steps: 2 | Train Loss: 0.892 Vali Loss: 1.037 Vali Acc: 0.785 Test Loss: 1.037 Test Acc: 0.785
Validation loss decreased (-0.785174 --> -0.785175).  Saving model ...
Epoch: 27 cost time: 0.6098999977111816
Epoch: 27, Steps: 2 | Train Loss: 0.882 Vali Loss: 0.998 Vali Acc: 0.793 Test Loss: 0.998 Test Acc: 0.793
Validation loss decreased (-0.785175 --> -0.792583).  Saving model ...
Epoch: 28 cost time: 0.5922574996948242
Epoch: 28, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.960 Vali Acc: 0.800 Test Loss: 0.960 Test Acc: 0.800
Validation loss decreased (-0.792583 --> -0.799990).  Saving model ...
Epoch: 29 cost time: 0.646561861038208
Epoch: 29, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.923 Vali Acc: 0.807 Test Loss: 0.923 Test Acc: 0.807
Validation loss decreased (-0.799990 --> -0.807398).  Saving model ...
Epoch: 30 cost time: 0.5888845920562744
Epoch: 30, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.887 Vali Acc: 0.815 Test Loss: 0.887 Test Acc: 0.815
Validation loss decreased (-0.807398 --> -0.814806).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8148148148148148
model parameter : 592838
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0986616611480713
Epoch: 1, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.848 Vali Acc: 0.115 Test Loss: 1.848 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 0.5467319488525391
Epoch: 2, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.822 Vali Acc: 0.115 Test Loss: 1.822 Test Acc: 0.115
Validation loss decreased (-0.114796 --> -0.114797).  Saving model ...
Epoch: 3 cost time: 0.5660927295684814
Epoch: 3, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.804 Vali Acc: 0.122 Test Loss: 1.804 Test Acc: 0.122
Validation loss decreased (-0.114797 --> -0.122204).  Saving model ...
Epoch: 4 cost time: 0.5731523036956787
Epoch: 4, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.790 Vali Acc: 0.122 Test Loss: 1.790 Test Acc: 0.122
Validation loss decreased (-0.122204 --> -0.122204).  Saving model ...
Epoch: 5 cost time: 0.541093111038208
Epoch: 5, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.773 Vali Acc: 0.119 Test Loss: 1.773 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5770950317382812
Epoch: 6, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.752 Vali Acc: 0.119 Test Loss: 1.752 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5589871406555176
Epoch: 7, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.728 Vali Acc: 0.126 Test Loss: 1.728 Test Acc: 0.126
Validation loss decreased (-0.122204 --> -0.125909).  Saving model ...
Epoch: 8 cost time: 0.5782713890075684
Epoch: 8, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.703 Vali Acc: 0.126 Test Loss: 1.703 Test Acc: 0.126
Validation loss decreased (-0.125909 --> -0.125909).  Saving model ...
Epoch: 9 cost time: 0.5670440196990967
Epoch: 9, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.675 Vali Acc: 0.141 Test Loss: 1.675 Test Acc: 0.141
Validation loss decreased (-0.125909 --> -0.140724).  Saving model ...
Epoch: 10 cost time: 0.5850563049316406
Epoch: 10, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.646 Vali Acc: 0.174 Test Loss: 1.646 Test Acc: 0.174
Validation loss decreased (-0.140724 --> -0.174058).  Saving model ...
Epoch: 11 cost time: 0.5819616317749023
Epoch: 11, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.615 Vali Acc: 0.207 Test Loss: 1.615 Test Acc: 0.207
Validation loss decreased (-0.174058 --> -0.207391).  Saving model ...
Epoch: 12 cost time: 0.5190722942352295
Epoch: 12, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.583 Vali Acc: 0.289 Test Loss: 1.583 Test Acc: 0.289
Validation loss decreased (-0.207391 --> -0.288873).  Saving model ...
Epoch: 13 cost time: 0.5134954452514648
Epoch: 13, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.549 Vali Acc: 0.378 Test Loss: 1.549 Test Acc: 0.378
Validation loss decreased (-0.288873 --> -0.377762).  Saving model ...
Epoch: 14 cost time: 0.558119535446167
Epoch: 14, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.513 Vali Acc: 0.441 Test Loss: 1.513 Test Acc: 0.441
Validation loss decreased (-0.377762 --> -0.440726).  Saving model ...
Epoch: 15 cost time: 0.5357580184936523
Epoch: 15, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.477 Vali Acc: 0.504 Test Loss: 1.477 Test Acc: 0.504
Validation loss decreased (-0.440726 --> -0.503689).  Saving model ...
Epoch: 16 cost time: 0.535841703414917
Epoch: 16, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.440 Vali Acc: 0.589 Test Loss: 1.440 Test Acc: 0.589
Validation loss decreased (-0.503689 --> -0.588874).  Saving model ...
Epoch: 17 cost time: 0.550173282623291
Epoch: 17, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.403 Vali Acc: 0.670 Test Loss: 1.403 Test Acc: 0.670
Validation loss decreased (-0.588874 --> -0.670356).  Saving model ...
Epoch: 18 cost time: 0.5736114978790283
Epoch: 18, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.365 Vali Acc: 0.722 Test Loss: 1.365 Test Acc: 0.722
Validation loss decreased (-0.670356 --> -0.722209).  Saving model ...
Epoch: 19 cost time: 0.5753536224365234
Epoch: 19, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.326 Vali Acc: 0.752 Test Loss: 1.326 Test Acc: 0.752
Validation loss decreased (-0.722209 --> -0.751839).  Saving model ...
Epoch: 20 cost time: 0.541783332824707
Epoch: 20, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.288 Vali Acc: 0.778 Test Loss: 1.288 Test Acc: 0.778
Validation loss decreased (-0.751839 --> -0.777765).  Saving model ...
Epoch: 21 cost time: 0.5749695301055908
Epoch: 21, Steps: 2 | Train Loss: 1.204 Vali Loss: 1.248 Vali Acc: 0.811 Test Loss: 1.248 Test Acc: 0.811
Validation loss decreased (-0.777765 --> -0.811099).  Saving model ...
Epoch: 22 cost time: 0.5636565685272217
Epoch: 22, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.209 Vali Acc: 0.822 Test Loss: 1.209 Test Acc: 0.822
Validation loss decreased (-0.811099 --> -0.822210).  Saving model ...
Epoch: 23 cost time: 0.6256210803985596
Epoch: 23, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.170 Vali Acc: 0.852 Test Loss: 1.170 Test Acc: 0.852
Validation loss decreased (-0.822210 --> -0.851840).  Saving model ...
Epoch: 24 cost time: 0.564488410949707
Epoch: 24, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.131 Vali Acc: 0.859 Test Loss: 1.131 Test Acc: 0.859
Validation loss decreased (-0.851840 --> -0.859248).  Saving model ...
Epoch: 25 cost time: 0.6797919273376465
Epoch: 25, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.091 Vali Acc: 0.874 Test Loss: 1.091 Test Acc: 0.874
Validation loss decreased (-0.859248 --> -0.874063).  Saving model ...
Epoch: 26 cost time: 0.6412475109100342
Epoch: 26, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.052 Vali Acc: 0.878 Test Loss: 1.052 Test Acc: 0.878
Validation loss decreased (-0.874063 --> -0.877767).  Saving model ...
Epoch: 27 cost time: 0.6417481899261475
Epoch: 27, Steps: 2 | Train Loss: 0.930 Vali Loss: 1.014 Vali Acc: 0.878 Test Loss: 1.014 Test Acc: 0.878
Validation loss decreased (-0.877767 --> -0.877768).  Saving model ...
Epoch: 28 cost time: 0.6574497222900391
Epoch: 28, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.977 Vali Acc: 0.889 Test Loss: 0.977 Test Acc: 0.889
Validation loss decreased (-0.877768 --> -0.888879).  Saving model ...
Epoch: 29 cost time: 0.6722457408905029
Epoch: 29, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.940 Vali Acc: 0.896 Test Loss: 0.940 Test Acc: 0.896
Validation loss decreased (-0.888879 --> -0.896287).  Saving model ...
Epoch: 30 cost time: 0.667567253112793
Epoch: 30, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.903 Vali Acc: 0.904 Test Loss: 0.903 Test Acc: 0.904
Validation loss decreased (-0.896287 --> -0.903695).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 178950
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2509138584136963
Epoch: 1, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.901 Vali Acc: 0.137 Test Loss: 1.901 Test Acc: 0.137
Validation loss decreased (inf --> -0.137018).  Saving model ...
Epoch: 2 cost time: 0.5153868198394775
Epoch: 2, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.871 Vali Acc: 0.159 Test Loss: 1.871 Test Acc: 0.159
Validation loss decreased (-0.137018 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 0.517667293548584
Epoch: 3, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.851 Vali Acc: 0.178 Test Loss: 1.851 Test Acc: 0.178
Validation loss decreased (-0.159241 --> -0.177759).  Saving model ...
Epoch: 4 cost time: 0.4944417476654053
Epoch: 4, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.836 Vali Acc: 0.196 Test Loss: 1.836 Test Acc: 0.196
Validation loss decreased (-0.177759 --> -0.196278).  Saving model ...
Epoch: 5 cost time: 0.5308194160461426
Epoch: 5, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.816 Vali Acc: 0.219 Test Loss: 1.816 Test Acc: 0.219
Validation loss decreased (-0.196278 --> -0.218500).  Saving model ...
Epoch: 6 cost time: 0.5238122940063477
Epoch: 6, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.793 Vali Acc: 0.226 Test Loss: 1.793 Test Acc: 0.226
Validation loss decreased (-0.218500 --> -0.225908).  Saving model ...
Epoch: 7 cost time: 0.5408463478088379
Epoch: 7, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.767 Vali Acc: 0.285 Test Loss: 1.767 Test Acc: 0.285
Validation loss decreased (-0.225908 --> -0.285168).  Saving model ...
Epoch: 8 cost time: 0.5436251163482666
Epoch: 8, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.738 Vali Acc: 0.319 Test Loss: 1.738 Test Acc: 0.319
Validation loss decreased (-0.285168 --> -0.318501).  Saving model ...
Epoch: 9 cost time: 0.5580852031707764
Epoch: 9, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.707 Vali Acc: 0.367 Test Loss: 1.707 Test Acc: 0.367
Validation loss decreased (-0.318501 --> -0.366650).  Saving model ...
Epoch: 10 cost time: 0.5109386444091797
Epoch: 10, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.674 Vali Acc: 0.422 Test Loss: 1.674 Test Acc: 0.422
Validation loss decreased (-0.366650 --> -0.422205).  Saving model ...
Epoch: 11 cost time: 0.5154364109039307
Epoch: 11, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.639 Vali Acc: 0.448 Test Loss: 1.639 Test Acc: 0.448
Validation loss decreased (-0.422205 --> -0.448132).  Saving model ...
Epoch: 12 cost time: 0.4912567138671875
Epoch: 12, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.603 Vali Acc: 0.500 Test Loss: 1.603 Test Acc: 0.500
Validation loss decreased (-0.448132 --> -0.499984).  Saving model ...
Epoch: 13 cost time: 0.5099697113037109
Epoch: 13, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.565 Vali Acc: 0.541 Test Loss: 1.565 Test Acc: 0.541
Validation loss decreased (-0.499984 --> -0.540725).  Saving model ...
Epoch: 14 cost time: 0.5101454257965088
Epoch: 14, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.526 Vali Acc: 0.578 Test Loss: 1.526 Test Acc: 0.578
Validation loss decreased (-0.540725 --> -0.577763).  Saving model ...
Epoch: 15 cost time: 0.5472664833068848
Epoch: 15, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.486 Vali Acc: 0.593 Test Loss: 1.486 Test Acc: 0.593
Validation loss decreased (-0.577763 --> -0.592578).  Saving model ...
Epoch: 16 cost time: 0.5057013034820557
Epoch: 16, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.445 Vali Acc: 0.615 Test Loss: 1.445 Test Acc: 0.615
Validation loss decreased (-0.592578 --> -0.614800).  Saving model ...
Epoch: 17 cost time: 0.5640285015106201
Epoch: 17, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.404 Vali Acc: 0.641 Test Loss: 1.404 Test Acc: 0.641
Validation loss decreased (-0.614800 --> -0.640727).  Saving model ...
Epoch: 18 cost time: 0.49825048446655273
Epoch: 18, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.364 Vali Acc: 0.659 Test Loss: 1.364 Test Acc: 0.659
Validation loss decreased (-0.640727 --> -0.659246).  Saving model ...
Epoch: 19 cost time: 0.5422658920288086
Epoch: 19, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.323 Vali Acc: 0.670 Test Loss: 1.323 Test Acc: 0.670
Validation loss decreased (-0.659246 --> -0.670357).  Saving model ...
Epoch: 20 cost time: 0.5350432395935059
Epoch: 20, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.281 Vali Acc: 0.681 Test Loss: 1.281 Test Acc: 0.681
Validation loss decreased (-0.670357 --> -0.681469).  Saving model ...
Epoch: 21 cost time: 0.5042510032653809
Epoch: 21, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.239 Vali Acc: 0.711 Test Loss: 1.239 Test Acc: 0.711
Validation loss decreased (-0.681469 --> -0.711099).  Saving model ...
Epoch: 22 cost time: 0.5076265335083008
Epoch: 22, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.198 Vali Acc: 0.726 Test Loss: 1.198 Test Acc: 0.726
Validation loss decreased (-0.711099 --> -0.725914).  Saving model ...
Epoch: 23 cost time: 0.5147767066955566
Epoch: 23, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.158 Vali Acc: 0.748 Test Loss: 1.158 Test Acc: 0.748
Validation loss decreased (-0.725914 --> -0.748137).  Saving model ...
Epoch: 24 cost time: 0.4933044910430908
Epoch: 24, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.117 Vali Acc: 0.770 Test Loss: 1.117 Test Acc: 0.770
Validation loss decreased (-0.748137 --> -0.770359).  Saving model ...
Epoch: 25 cost time: 0.4975454807281494
Epoch: 25, Steps: 2 | Train Loss: 0.903 Vali Loss: 1.076 Vali Acc: 0.785 Test Loss: 1.076 Test Acc: 0.785
Validation loss decreased (-0.770359 --> -0.785174).  Saving model ...
Epoch: 26 cost time: 0.5235309600830078
Epoch: 26, Steps: 2 | Train Loss: 0.892 Vali Loss: 1.037 Vali Acc: 0.785 Test Loss: 1.037 Test Acc: 0.785
Validation loss decreased (-0.785174 --> -0.785175).  Saving model ...
Epoch: 27 cost time: 0.49450111389160156
Epoch: 27, Steps: 2 | Train Loss: 0.882 Vali Loss: 0.998 Vali Acc: 0.793 Test Loss: 0.998 Test Acc: 0.793
Validation loss decreased (-0.785175 --> -0.792583).  Saving model ...
Epoch: 28 cost time: 0.5081965923309326
Epoch: 28, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.960 Vali Acc: 0.800 Test Loss: 0.960 Test Acc: 0.800
Validation loss decreased (-0.792583 --> -0.799990).  Saving model ...
Epoch: 29 cost time: 0.5266718864440918
Epoch: 29, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.923 Vali Acc: 0.807 Test Loss: 0.923 Test Acc: 0.807
Validation loss decreased (-0.799990 --> -0.807398).  Saving model ...
Epoch: 30 cost time: 0.5503082275390625
Epoch: 30, Steps: 2 | Train Loss: 0.752 Vali Loss: 0.887 Vali Acc: 0.815 Test Loss: 0.887 Test Acc: 0.815
Validation loss decreased (-0.807398 --> -0.814806).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8148148148148148
model parameter : 592838
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.097104549407959
Epoch: 1, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.848 Vali Acc: 0.115 Test Loss: 1.848 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 0.49831080436706543
Epoch: 2, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.822 Vali Acc: 0.115 Test Loss: 1.822 Test Acc: 0.115
Validation loss decreased (-0.114796 --> -0.114797).  Saving model ...
Epoch: 3 cost time: 0.4629247188568115
Epoch: 3, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.804 Vali Acc: 0.122 Test Loss: 1.804 Test Acc: 0.122
Validation loss decreased (-0.114797 --> -0.122204).  Saving model ...
Epoch: 4 cost time: 0.5535843372344971
Epoch: 4, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.790 Vali Acc: 0.122 Test Loss: 1.790 Test Acc: 0.122
Validation loss decreased (-0.122204 --> -0.122204).  Saving model ...
Epoch: 5 cost time: 0.5084257125854492
Epoch: 5, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.772 Vali Acc: 0.119 Test Loss: 1.772 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.49745845794677734
Epoch: 6, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.752 Vali Acc: 0.119 Test Loss: 1.752 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5467321872711182
Epoch: 7, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.728 Vali Acc: 0.126 Test Loss: 1.728 Test Acc: 0.126
Validation loss decreased (-0.122204 --> -0.125909).  Saving model ...
Epoch: 8 cost time: 0.5329349040985107
Epoch: 8, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.703 Vali Acc: 0.126 Test Loss: 1.703 Test Acc: 0.126
Validation loss decreased (-0.125909 --> -0.125909).  Saving model ...
Epoch: 9 cost time: 0.49222517013549805
Epoch: 9, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.675 Vali Acc: 0.141 Test Loss: 1.675 Test Acc: 0.141
Validation loss decreased (-0.125909 --> -0.140724).  Saving model ...
Epoch: 10 cost time: 0.4772496223449707
Epoch: 10, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.646 Vali Acc: 0.174 Test Loss: 1.646 Test Acc: 0.174
Validation loss decreased (-0.140724 --> -0.174058).  Saving model ...
Epoch: 11 cost time: 0.4763169288635254
Epoch: 11, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.615 Vali Acc: 0.207 Test Loss: 1.615 Test Acc: 0.207
Validation loss decreased (-0.174058 --> -0.207391).  Saving model ...
Epoch: 12 cost time: 0.6007206439971924
Epoch: 12, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.582 Vali Acc: 0.289 Test Loss: 1.582 Test Acc: 0.289
Validation loss decreased (-0.207391 --> -0.288873).  Saving model ...
Epoch: 13 cost time: 0.5158796310424805
Epoch: 13, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.549 Vali Acc: 0.378 Test Loss: 1.549 Test Acc: 0.378
Validation loss decreased (-0.288873 --> -0.377762).  Saving model ...
Epoch: 14 cost time: 0.5402200222015381
Epoch: 14, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.513 Vali Acc: 0.441 Test Loss: 1.513 Test Acc: 0.441
Validation loss decreased (-0.377762 --> -0.440726).  Saving model ...
Epoch: 15 cost time: 0.5048015117645264
Epoch: 15, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.477 Vali Acc: 0.504 Test Loss: 1.477 Test Acc: 0.504
Validation loss decreased (-0.440726 --> -0.503689).  Saving model ...
Epoch: 16 cost time: 0.5103986263275146
Epoch: 16, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.440 Vali Acc: 0.589 Test Loss: 1.440 Test Acc: 0.589
Validation loss decreased (-0.503689 --> -0.588874).  Saving model ...
Epoch: 17 cost time: 0.5123350620269775
Epoch: 17, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.403 Vali Acc: 0.670 Test Loss: 1.403 Test Acc: 0.670
Validation loss decreased (-0.588874 --> -0.670356).  Saving model ...
Epoch: 18 cost time: 0.49529027938842773
Epoch: 18, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.365 Vali Acc: 0.722 Test Loss: 1.365 Test Acc: 0.722
Validation loss decreased (-0.670356 --> -0.722209).  Saving model ...
Epoch: 19 cost time: 0.49823856353759766
Epoch: 19, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.326 Vali Acc: 0.752 Test Loss: 1.326 Test Acc: 0.752
Validation loss decreased (-0.722209 --> -0.751839).  Saving model ...
Epoch: 20 cost time: 0.4587271213531494
Epoch: 20, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.287 Vali Acc: 0.778 Test Loss: 1.287 Test Acc: 0.778
Validation loss decreased (-0.751839 --> -0.777765).  Saving model ...
Epoch: 21 cost time: 0.5238265991210938
Epoch: 21, Steps: 2 | Train Loss: 1.204 Vali Loss: 1.248 Vali Acc: 0.811 Test Loss: 1.248 Test Acc: 0.811
Validation loss decreased (-0.777765 --> -0.811099).  Saving model ...
Epoch: 22 cost time: 0.47254180908203125
Epoch: 22, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.208 Vali Acc: 0.822 Test Loss: 1.208 Test Acc: 0.822
Validation loss decreased (-0.811099 --> -0.822210).  Saving model ...
Epoch: 23 cost time: 0.5021853446960449
Epoch: 23, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.170 Vali Acc: 0.852 Test Loss: 1.170 Test Acc: 0.852
Validation loss decreased (-0.822210 --> -0.851840).  Saving model ...
Epoch: 24 cost time: 0.5223596096038818
Epoch: 24, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.130 Vali Acc: 0.859 Test Loss: 1.130 Test Acc: 0.859
Validation loss decreased (-0.851840 --> -0.859248).  Saving model ...
Epoch: 25 cost time: 0.492692232131958
Epoch: 25, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.091 Vali Acc: 0.874 Test Loss: 1.091 Test Acc: 0.874
Validation loss decreased (-0.859248 --> -0.874063).  Saving model ...
Epoch: 26 cost time: 0.5424416065216064
Epoch: 26, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.052 Vali Acc: 0.878 Test Loss: 1.052 Test Acc: 0.878
Validation loss decreased (-0.874063 --> -0.877767).  Saving model ...
Epoch: 27 cost time: 0.49481630325317383
Epoch: 27, Steps: 2 | Train Loss: 0.930 Vali Loss: 1.014 Vali Acc: 0.878 Test Loss: 1.014 Test Acc: 0.878
Validation loss decreased (-0.877767 --> -0.877768).  Saving model ...
Epoch: 28 cost time: 0.5434985160827637
Epoch: 28, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.977 Vali Acc: 0.889 Test Loss: 0.977 Test Acc: 0.889
Validation loss decreased (-0.877768 --> -0.888879).  Saving model ...
Epoch: 29 cost time: 0.5586516857147217
Epoch: 29, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.940 Vali Acc: 0.896 Test Loss: 0.940 Test Acc: 0.896
Validation loss decreased (-0.888879 --> -0.896287).  Saving model ...
Epoch: 30 cost time: 0.4990570545196533
Epoch: 30, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.903 Vali Acc: 0.904 Test Loss: 0.903 Test Acc: 0.904
Validation loss decreased (-0.896287 --> -0.903695).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 178950
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0155279636383057
Epoch: 1, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.901 Vali Acc: 0.137 Test Loss: 1.901 Test Acc: 0.137
Validation loss decreased (inf --> -0.137018).  Saving model ...
Epoch: 2 cost time: 0.4875795841217041
Epoch: 2, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.872 Vali Acc: 0.163 Test Loss: 1.872 Test Acc: 0.163
Validation loss decreased (-0.137018 --> -0.162944).  Saving model ...
Epoch: 3 cost time: 0.4858548641204834
Epoch: 3, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.852 Vali Acc: 0.178 Test Loss: 1.852 Test Acc: 0.178
Validation loss decreased (-0.162944 --> -0.177759).  Saving model ...
Epoch: 4 cost time: 0.5023527145385742
Epoch: 4, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.837 Vali Acc: 0.196 Test Loss: 1.837 Test Acc: 0.196
Validation loss decreased (-0.177759 --> -0.196278).  Saving model ...
Epoch: 5 cost time: 0.4579613208770752
Epoch: 5, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.817 Vali Acc: 0.219 Test Loss: 1.817 Test Acc: 0.219
Validation loss decreased (-0.196278 --> -0.218500).  Saving model ...
Epoch: 6 cost time: 0.4539957046508789
Epoch: 6, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.794 Vali Acc: 0.226 Test Loss: 1.794 Test Acc: 0.226
Validation loss decreased (-0.218500 --> -0.225908).  Saving model ...
Epoch: 7 cost time: 0.4726755619049072
Epoch: 7, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.768 Vali Acc: 0.285 Test Loss: 1.768 Test Acc: 0.285
Validation loss decreased (-0.225908 --> -0.285168).  Saving model ...
Epoch: 8 cost time: 0.4783785343170166
Epoch: 8, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.739 Vali Acc: 0.319 Test Loss: 1.739 Test Acc: 0.319
Validation loss decreased (-0.285168 --> -0.318501).  Saving model ...
Epoch: 9 cost time: 0.4614121913909912
Epoch: 9, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.708 Vali Acc: 0.370 Test Loss: 1.708 Test Acc: 0.370
Validation loss decreased (-0.318501 --> -0.370353).  Saving model ...
Epoch: 10 cost time: 0.45646071434020996
Epoch: 10, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.676 Vali Acc: 0.422 Test Loss: 1.676 Test Acc: 0.422
Validation loss decreased (-0.370353 --> -0.422205).  Saving model ...
Epoch: 11 cost time: 0.503584623336792
Epoch: 11, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.641 Vali Acc: 0.448 Test Loss: 1.641 Test Acc: 0.448
Validation loss decreased (-0.422205 --> -0.448132).  Saving model ...
Epoch: 12 cost time: 0.47344017028808594
Epoch: 12, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.605 Vali Acc: 0.500 Test Loss: 1.605 Test Acc: 0.500
Validation loss decreased (-0.448132 --> -0.499984).  Saving model ...
Epoch: 13 cost time: 0.4482002258300781
Epoch: 13, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.568 Vali Acc: 0.537 Test Loss: 1.568 Test Acc: 0.537
Validation loss decreased (-0.499984 --> -0.537021).  Saving model ...
Epoch: 14 cost time: 0.49338555335998535
Epoch: 14, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.529 Vali Acc: 0.574 Test Loss: 1.529 Test Acc: 0.574
Validation loss decreased (-0.537021 --> -0.574059).  Saving model ...
Epoch: 15 cost time: 0.48627328872680664
Epoch: 15, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.489 Vali Acc: 0.589 Test Loss: 1.489 Test Acc: 0.589
Validation loss decreased (-0.574059 --> -0.588874).  Saving model ...
Epoch: 16 cost time: 0.49353909492492676
Epoch: 16, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.449 Vali Acc: 0.611 Test Loss: 1.449 Test Acc: 0.611
Validation loss decreased (-0.588874 --> -0.611097).  Saving model ...
Epoch: 17 cost time: 0.5004210472106934
Epoch: 17, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.408 Vali Acc: 0.633 Test Loss: 1.408 Test Acc: 0.633
Validation loss decreased (-0.611097 --> -0.633319).  Saving model ...
Epoch: 18 cost time: 0.49640607833862305
Epoch: 18, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.368 Vali Acc: 0.656 Test Loss: 1.368 Test Acc: 0.656
Validation loss decreased (-0.633319 --> -0.655542).  Saving model ...
Epoch: 19 cost time: 0.5269207954406738
Epoch: 19, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.327 Vali Acc: 0.667 Test Loss: 1.327 Test Acc: 0.667
Validation loss decreased (-0.655542 --> -0.666653).  Saving model ...
Epoch: 20 cost time: 0.5000913143157959
Epoch: 20, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.286 Vali Acc: 0.681 Test Loss: 1.286 Test Acc: 0.681
Validation loss decreased (-0.666653 --> -0.681469).  Saving model ...
Epoch: 21 cost time: 0.5194835662841797
Epoch: 21, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.244 Vali Acc: 0.704 Test Loss: 1.244 Test Acc: 0.704
Validation loss decreased (-0.681469 --> -0.703691).  Saving model ...
Epoch: 22 cost time: 0.523362398147583
Epoch: 22, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.203 Vali Acc: 0.719 Test Loss: 1.203 Test Acc: 0.719
Validation loss decreased (-0.703691 --> -0.718506).  Saving model ...
Epoch: 23 cost time: 0.47211360931396484
Epoch: 23, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.164 Vali Acc: 0.744 Test Loss: 1.164 Test Acc: 0.744
Validation loss decreased (-0.718506 --> -0.744433).  Saving model ...
Epoch: 24 cost time: 0.5032081604003906
Epoch: 24, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.123 Vali Acc: 0.767 Test Loss: 1.123 Test Acc: 0.767
Validation loss decreased (-0.744433 --> -0.766655).  Saving model ...
Epoch: 25 cost time: 0.454601526260376
Epoch: 25, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.083 Vali Acc: 0.781 Test Loss: 1.083 Test Acc: 0.781
Validation loss decreased (-0.766655 --> -0.781471).  Saving model ...
Epoch: 26 cost time: 0.49285268783569336
Epoch: 26, Steps: 2 | Train Loss: 0.908 Vali Loss: 1.044 Vali Acc: 0.785 Test Loss: 1.044 Test Acc: 0.785
Validation loss decreased (-0.781471 --> -0.785175).  Saving model ...
Epoch: 27 cost time: 0.4929313659667969
Epoch: 27, Steps: 2 | Train Loss: 0.902 Vali Loss: 1.005 Vali Acc: 0.789 Test Loss: 1.005 Test Acc: 0.789
Validation loss decreased (-0.785175 --> -0.788879).  Saving model ...
Epoch: 28 cost time: 0.5230875015258789
Epoch: 28, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.967 Vali Acc: 0.793 Test Loss: 0.967 Test Acc: 0.793
Validation loss decreased (-0.788879 --> -0.792583).  Saving model ...
Epoch: 29 cost time: 0.4651188850402832
Epoch: 29, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.930 Vali Acc: 0.807 Test Loss: 0.930 Test Acc: 0.807
Validation loss decreased (-0.792583 --> -0.807398).  Saving model ...
Epoch: 30 cost time: 0.48876166343688965
Epoch: 30, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.894 Vali Acc: 0.811 Test Loss: 0.894 Test Acc: 0.811
Validation loss decreased (-0.807398 --> -0.811102).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8111111111111111
model parameter : 592838
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9404497146606445
Epoch: 1, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.848 Vali Acc: 0.115 Test Loss: 1.848 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 0.4433465003967285
Epoch: 2, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.822 Vali Acc: 0.115 Test Loss: 1.822 Test Acc: 0.115
Validation loss decreased (-0.114796 --> -0.114797).  Saving model ...
Epoch: 3 cost time: 0.499769926071167
Epoch: 3, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.804 Vali Acc: 0.122 Test Loss: 1.804 Test Acc: 0.122
Validation loss decreased (-0.114797 --> -0.122204).  Saving model ...
Epoch: 4 cost time: 0.5207860469818115
Epoch: 4, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.790 Vali Acc: 0.122 Test Loss: 1.790 Test Acc: 0.122
Validation loss decreased (-0.122204 --> -0.122204).  Saving model ...
Epoch: 5 cost time: 0.4709634780883789
Epoch: 5, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.772 Vali Acc: 0.122 Test Loss: 1.772 Test Acc: 0.122
Validation loss decreased (-0.122204 --> -0.122204).  Saving model ...
Epoch: 6 cost time: 0.43412256240844727
Epoch: 6, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.752 Vali Acc: 0.122 Test Loss: 1.752 Test Acc: 0.122
Validation loss decreased (-0.122204 --> -0.122205).  Saving model ...
Epoch: 7 cost time: 0.4455873966217041
Epoch: 7, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.728 Vali Acc: 0.126 Test Loss: 1.728 Test Acc: 0.126
Validation loss decreased (-0.122205 --> -0.125909).  Saving model ...
Epoch: 8 cost time: 0.47182464599609375
Epoch: 8, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.703 Vali Acc: 0.126 Test Loss: 1.703 Test Acc: 0.126
Validation loss decreased (-0.125909 --> -0.125909).  Saving model ...
Epoch: 9 cost time: 0.46315717697143555
Epoch: 9, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.675 Vali Acc: 0.141 Test Loss: 1.675 Test Acc: 0.141
Validation loss decreased (-0.125909 --> -0.140724).  Saving model ...
Epoch: 10 cost time: 0.4240293502807617
Epoch: 10, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.646 Vali Acc: 0.174 Test Loss: 1.646 Test Acc: 0.174
Validation loss decreased (-0.140724 --> -0.174058).  Saving model ...
Epoch: 11 cost time: 0.43505430221557617
Epoch: 11, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.615 Vali Acc: 0.204 Test Loss: 1.615 Test Acc: 0.204
Validation loss decreased (-0.174058 --> -0.203688).  Saving model ...
Epoch: 12 cost time: 0.43485522270202637
Epoch: 12, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.583 Vali Acc: 0.285 Test Loss: 1.583 Test Acc: 0.285
Validation loss decreased (-0.203688 --> -0.285169).  Saving model ...
Epoch: 13 cost time: 0.45145440101623535
Epoch: 13, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.549 Vali Acc: 0.378 Test Loss: 1.549 Test Acc: 0.378
Validation loss decreased (-0.285169 --> -0.377762).  Saving model ...
Epoch: 14 cost time: 0.4604990482330322
Epoch: 14, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.514 Vali Acc: 0.441 Test Loss: 1.514 Test Acc: 0.441
Validation loss decreased (-0.377762 --> -0.440726).  Saving model ...
Epoch: 15 cost time: 0.4317450523376465
Epoch: 15, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.477 Vali Acc: 0.504 Test Loss: 1.477 Test Acc: 0.504
Validation loss decreased (-0.440726 --> -0.503689).  Saving model ...
Epoch: 16 cost time: 0.45798802375793457
Epoch: 16, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.440 Vali Acc: 0.589 Test Loss: 1.440 Test Acc: 0.589
Validation loss decreased (-0.503689 --> -0.588874).  Saving model ...
Epoch: 17 cost time: 0.4385993480682373
Epoch: 17, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.403 Vali Acc: 0.670 Test Loss: 1.403 Test Acc: 0.670
Validation loss decreased (-0.588874 --> -0.670356).  Saving model ...
Epoch: 18 cost time: 0.4521048069000244
Epoch: 18, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.365 Vali Acc: 0.722 Test Loss: 1.365 Test Acc: 0.722
Validation loss decreased (-0.670356 --> -0.722209).  Saving model ...
Epoch: 19 cost time: 0.4927668571472168
Epoch: 19, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.327 Vali Acc: 0.752 Test Loss: 1.327 Test Acc: 0.752
Validation loss decreased (-0.722209 --> -0.751839).  Saving model ...
Epoch: 20 cost time: 0.4526479244232178
Epoch: 20, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.288 Vali Acc: 0.778 Test Loss: 1.288 Test Acc: 0.778
Validation loss decreased (-0.751839 --> -0.777765).  Saving model ...
Epoch: 21 cost time: 0.4209623336791992
Epoch: 21, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.249 Vali Acc: 0.811 Test Loss: 1.249 Test Acc: 0.811
Validation loss decreased (-0.777765 --> -0.811099).  Saving model ...
Epoch: 22 cost time: 0.4448661804199219
Epoch: 22, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.210 Vali Acc: 0.822 Test Loss: 1.210 Test Acc: 0.822
Validation loss decreased (-0.811099 --> -0.822210).  Saving model ...
Epoch: 23 cost time: 0.43755316734313965
Epoch: 23, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.171 Vali Acc: 0.852 Test Loss: 1.171 Test Acc: 0.852
Validation loss decreased (-0.822210 --> -0.851840).  Saving model ...
Epoch: 24 cost time: 0.44762587547302246
Epoch: 24, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.132 Vali Acc: 0.859 Test Loss: 1.132 Test Acc: 0.859
Validation loss decreased (-0.851840 --> -0.859248).  Saving model ...
Epoch: 25 cost time: 0.46704840660095215
Epoch: 25, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.093 Vali Acc: 0.874 Test Loss: 1.093 Test Acc: 0.874
Validation loss decreased (-0.859248 --> -0.874063).  Saving model ...
Epoch: 26 cost time: 0.4356038570404053
Epoch: 26, Steps: 2 | Train Loss: 0.966 Vali Loss: 1.054 Vali Acc: 0.878 Test Loss: 1.054 Test Acc: 0.878
Validation loss decreased (-0.874063 --> -0.877767).  Saving model ...
Epoch: 27 cost time: 0.4222097396850586
Epoch: 27, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.016 Vali Acc: 0.878 Test Loss: 1.016 Test Acc: 0.878
Validation loss decreased (-0.877767 --> -0.877768).  Saving model ...
Epoch: 28 cost time: 0.46625781059265137
Epoch: 28, Steps: 2 | Train Loss: 0.855 Vali Loss: 0.979 Vali Acc: 0.889 Test Loss: 0.979 Test Acc: 0.889
Validation loss decreased (-0.877768 --> -0.888879).  Saving model ...
Epoch: 29 cost time: 0.46896958351135254
Epoch: 29, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.942 Vali Acc: 0.896 Test Loss: 0.942 Test Acc: 0.896
Validation loss decreased (-0.888879 --> -0.896287).  Saving model ...
Epoch: 30 cost time: 0.44377875328063965
Epoch: 30, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.906 Vali Acc: 0.904 Test Loss: 0.906 Test Acc: 0.904
Validation loss decreased (-0.896287 --> -0.903695).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 178950
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0744028091430664
Epoch: 1, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.926 Vali Acc: 0.078 Test Loss: 1.926 Test Acc: 0.078
Validation loss decreased (inf --> -0.077759).  Saving model ...
Epoch: 2 cost time: 0.5547544956207275
Epoch: 2, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.899 Vali Acc: 0.089 Test Loss: 1.899 Test Acc: 0.089
Validation loss decreased (-0.077759 --> -0.088870).  Saving model ...
Epoch: 3 cost time: 0.5234057903289795
Epoch: 3, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.881 Vali Acc: 0.093 Test Loss: 1.881 Test Acc: 0.093
Validation loss decreased (-0.088870 --> -0.092574).  Saving model ...
Epoch: 4 cost time: 0.5448126792907715
Epoch: 4, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.866 Vali Acc: 0.096 Test Loss: 1.866 Test Acc: 0.096
Validation loss decreased (-0.092574 --> -0.096278).  Saving model ...
Epoch: 5 cost time: 0.6084933280944824
Epoch: 5, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.848 Vali Acc: 0.100 Test Loss: 1.848 Test Acc: 0.100
Validation loss decreased (-0.096278 --> -0.099982).  Saving model ...
Epoch: 6 cost time: 0.5598232746124268
Epoch: 6, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.826 Vali Acc: 0.133 Test Loss: 1.826 Test Acc: 0.133
Validation loss decreased (-0.099982 --> -0.133315).  Saving model ...
Epoch: 7 cost time: 0.5690312385559082
Epoch: 7, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.801 Vali Acc: 0.156 Test Loss: 1.801 Test Acc: 0.156
Validation loss decreased (-0.133315 --> -0.155538).  Saving model ...
Epoch: 8 cost time: 0.5621199607849121
Epoch: 8, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.773 Vali Acc: 0.181 Test Loss: 1.773 Test Acc: 0.181
Validation loss decreased (-0.155538 --> -0.181464).  Saving model ...
Epoch: 9 cost time: 0.5477304458618164
Epoch: 9, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.743 Vali Acc: 0.226 Test Loss: 1.743 Test Acc: 0.226
Validation loss decreased (-0.181464 --> -0.225908).  Saving model ...
Epoch: 10 cost time: 0.5692822933197021
Epoch: 10, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.711 Vali Acc: 0.241 Test Loss: 1.711 Test Acc: 0.241
Validation loss decreased (-0.225908 --> -0.240724).  Saving model ...
Epoch: 11 cost time: 0.5910813808441162
Epoch: 11, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.678 Vali Acc: 0.289 Test Loss: 1.678 Test Acc: 0.289
Validation loss decreased (-0.240724 --> -0.288872).  Saving model ...
Epoch: 12 cost time: 0.6523129940032959
Epoch: 12, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.645 Vali Acc: 0.330 Test Loss: 1.645 Test Acc: 0.330
Validation loss decreased (-0.288872 --> -0.329613).  Saving model ...
Epoch: 13 cost time: 0.5630433559417725
Epoch: 13, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.610 Vali Acc: 0.378 Test Loss: 1.610 Test Acc: 0.378
Validation loss decreased (-0.329613 --> -0.377762).  Saving model ...
Epoch: 14 cost time: 0.668999195098877
Epoch: 14, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.574 Vali Acc: 0.430 Test Loss: 1.574 Test Acc: 0.430
Validation loss decreased (-0.377762 --> -0.429614).  Saving model ...
Epoch: 15 cost time: 0.5668962001800537
Epoch: 15, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.537 Vali Acc: 0.519 Test Loss: 1.537 Test Acc: 0.519
Validation loss decreased (-0.429614 --> -0.518503).  Saving model ...
Epoch: 16 cost time: 0.6043734550476074
Epoch: 16, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.500 Vali Acc: 0.607 Test Loss: 1.500 Test Acc: 0.607
Validation loss decreased (-0.518503 --> -0.607392).  Saving model ...
Epoch: 17 cost time: 0.5846493244171143
Epoch: 17, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.463 Vali Acc: 0.663 Test Loss: 1.463 Test Acc: 0.663
Validation loss decreased (-0.607392 --> -0.662948).  Saving model ...
Epoch: 18 cost time: 0.609595775604248
Epoch: 18, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.425 Vali Acc: 0.700 Test Loss: 1.425 Test Acc: 0.700
Validation loss decreased (-0.662948 --> -0.699986).  Saving model ...
Epoch: 19 cost time: 0.5854065418243408
Epoch: 19, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.388 Vali Acc: 0.715 Test Loss: 1.388 Test Acc: 0.715
Validation loss decreased (-0.699986 --> -0.714801).  Saving model ...
Epoch: 20 cost time: 0.5953128337860107
Epoch: 20, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.350 Vali Acc: 0.733 Test Loss: 1.350 Test Acc: 0.733
Validation loss decreased (-0.714801 --> -0.733320).  Saving model ...
Epoch: 21 cost time: 0.6393535137176514
Epoch: 21, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.312 Vali Acc: 0.748 Test Loss: 1.312 Test Acc: 0.748
Validation loss decreased (-0.733320 --> -0.748135).  Saving model ...
Epoch: 22 cost time: 0.5594158172607422
Epoch: 22, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.273 Vali Acc: 0.763 Test Loss: 1.273 Test Acc: 0.763
Validation loss decreased (-0.748135 --> -0.762950).  Saving model ...
Epoch: 23 cost time: 0.6116428375244141
Epoch: 23, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.236 Vali Acc: 0.785 Test Loss: 1.236 Test Acc: 0.785
Validation loss decreased (-0.762950 --> -0.785173).  Saving model ...
Epoch: 24 cost time: 0.5926952362060547
Epoch: 24, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.198 Vali Acc: 0.804 Test Loss: 1.198 Test Acc: 0.804
Validation loss decreased (-0.785173 --> -0.803692).  Saving model ...
Epoch: 25 cost time: 0.57912278175354
Epoch: 25, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.160 Vali Acc: 0.807 Test Loss: 1.160 Test Acc: 0.807
Validation loss decreased (-0.803692 --> -0.807396).  Saving model ...
Epoch: 26 cost time: 0.5766820907592773
Epoch: 26, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.123 Vali Acc: 0.822 Test Loss: 1.123 Test Acc: 0.822
Validation loss decreased (-0.807396 --> -0.822211).  Saving model ...
Epoch: 27 cost time: 0.5883076190948486
Epoch: 27, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.087 Vali Acc: 0.833 Test Loss: 1.087 Test Acc: 0.833
Validation loss decreased (-0.822211 --> -0.833322).  Saving model ...
Epoch: 28 cost time: 0.5645642280578613
Epoch: 28, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.052 Vali Acc: 0.844 Test Loss: 1.052 Test Acc: 0.844
Validation loss decreased (-0.833322 --> -0.844434).  Saving model ...
Epoch: 29 cost time: 0.5970771312713623
Epoch: 29, Steps: 2 | Train Loss: 0.895 Vali Loss: 1.017 Vali Acc: 0.856 Test Loss: 1.017 Test Acc: 0.856
Validation loss decreased (-0.844434 --> -0.855545).  Saving model ...
Epoch: 30 cost time: 0.5816211700439453
Epoch: 30, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.983 Vali Acc: 0.863 Test Loss: 0.983 Test Acc: 0.863
Validation loss decreased (-0.855545 --> -0.862953).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8629629629629629
model parameter : 299782
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9556007385253906
Epoch: 1, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.860 Vali Acc: 0.126 Test Loss: 1.860 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 0.6157748699188232
Epoch: 2, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.831 Vali Acc: 0.148 Test Loss: 1.831 Test Acc: 0.148
Validation loss decreased (-0.125907 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 0.5190479755401611
Epoch: 3, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.812 Vali Acc: 0.163 Test Loss: 1.812 Test Acc: 0.163
Validation loss decreased (-0.148130 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 0.5304388999938965
Epoch: 4, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.798 Vali Acc: 0.170 Test Loss: 1.798 Test Acc: 0.170
Validation loss decreased (-0.162945 --> -0.170352).  Saving model ...
Epoch: 5 cost time: 0.5257663726806641
Epoch: 5, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.779 Vali Acc: 0.178 Test Loss: 1.779 Test Acc: 0.178
Validation loss decreased (-0.170352 --> -0.177760).  Saving model ...
Epoch: 6 cost time: 0.5531530380249023
Epoch: 6, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.756 Vali Acc: 0.185 Test Loss: 1.756 Test Acc: 0.185
Validation loss decreased (-0.177760 --> -0.185168).  Saving model ...
Epoch: 7 cost time: 0.5809230804443359
Epoch: 7, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.731 Vali Acc: 0.204 Test Loss: 1.731 Test Acc: 0.204
Validation loss decreased (-0.185168 --> -0.203686).  Saving model ...
Epoch: 8 cost time: 0.5325491428375244
Epoch: 8, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.703 Vali Acc: 0.230 Test Loss: 1.703 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229613).  Saving model ...
Epoch: 9 cost time: 0.5182633399963379
Epoch: 9, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.672 Vali Acc: 0.267 Test Loss: 1.672 Test Acc: 0.267
Validation loss decreased (-0.229613 --> -0.266650).  Saving model ...
Epoch: 10 cost time: 0.5343925952911377
Epoch: 10, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.640 Vali Acc: 0.307 Test Loss: 1.640 Test Acc: 0.307
Validation loss decreased (-0.266650 --> -0.307391).  Saving model ...
Epoch: 11 cost time: 0.5146734714508057
Epoch: 11, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.605 Vali Acc: 0.341 Test Loss: 1.605 Test Acc: 0.341
Validation loss decreased (-0.307391 --> -0.340725).  Saving model ...
Epoch: 12 cost time: 0.5948801040649414
Epoch: 12, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.570 Vali Acc: 0.385 Test Loss: 1.570 Test Acc: 0.385
Validation loss decreased (-0.340725 --> -0.385169).  Saving model ...
Epoch: 13 cost time: 0.5417947769165039
Epoch: 13, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.533 Vali Acc: 0.411 Test Loss: 1.533 Test Acc: 0.411
Validation loss decreased (-0.385169 --> -0.411096).  Saving model ...
Epoch: 14 cost time: 0.5024950504302979
Epoch: 14, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.495 Vali Acc: 0.467 Test Loss: 1.495 Test Acc: 0.467
Validation loss decreased (-0.411096 --> -0.466652).  Saving model ...
Epoch: 15 cost time: 0.5268056392669678
Epoch: 15, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.456 Vali Acc: 0.507 Test Loss: 1.456 Test Acc: 0.507
Validation loss decreased (-0.466652 --> -0.507393).  Saving model ...
Epoch: 16 cost time: 0.6074297428131104
Epoch: 16, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.417 Vali Acc: 0.563 Test Loss: 1.417 Test Acc: 0.563
Validation loss decreased (-0.507393 --> -0.562949).  Saving model ...
Epoch: 17 cost time: 0.5484292507171631
Epoch: 17, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.377 Vali Acc: 0.626 Test Loss: 1.377 Test Acc: 0.626
Validation loss decreased (-0.562949 --> -0.625912).  Saving model ...
Epoch: 18 cost time: 0.5405099391937256
Epoch: 18, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.337 Vali Acc: 0.670 Test Loss: 1.337 Test Acc: 0.670
Validation loss decreased (-0.625912 --> -0.670357).  Saving model ...
Epoch: 19 cost time: 0.5514717102050781
Epoch: 19, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.296 Vali Acc: 0.711 Test Loss: 1.296 Test Acc: 0.711
Validation loss decreased (-0.670357 --> -0.711098).  Saving model ...
Epoch: 20 cost time: 0.5299055576324463
Epoch: 20, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.256 Vali Acc: 0.748 Test Loss: 1.256 Test Acc: 0.748
Validation loss decreased (-0.711098 --> -0.748136).  Saving model ...
Epoch: 21 cost time: 0.5292775630950928
Epoch: 21, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.216 Vali Acc: 0.770 Test Loss: 1.216 Test Acc: 0.770
Validation loss decreased (-0.748136 --> -0.770358).  Saving model ...
Epoch: 22 cost time: 0.5282070636749268
Epoch: 22, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.175 Vali Acc: 0.800 Test Loss: 1.175 Test Acc: 0.800
Validation loss decreased (-0.770358 --> -0.799988).  Saving model ...
Epoch: 23 cost time: 0.5226364135742188
Epoch: 23, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.135 Vali Acc: 0.811 Test Loss: 1.135 Test Acc: 0.811
Validation loss decreased (-0.799988 --> -0.811100).  Saving model ...
Epoch: 24 cost time: 0.5192456245422363
Epoch: 24, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.096 Vali Acc: 0.826 Test Loss: 1.096 Test Acc: 0.826
Validation loss decreased (-0.811100 --> -0.825915).  Saving model ...
Epoch: 25 cost time: 0.5482590198516846
Epoch: 25, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.057 Vali Acc: 0.833 Test Loss: 1.057 Test Acc: 0.833
Validation loss decreased (-0.825915 --> -0.833323).  Saving model ...
Epoch: 26 cost time: 0.5712761878967285
Epoch: 26, Steps: 2 | Train Loss: 0.882 Vali Loss: 1.019 Vali Acc: 0.837 Test Loss: 1.019 Test Acc: 0.837
Validation loss decreased (-0.833323 --> -0.837027).  Saving model ...
Epoch: 27 cost time: 0.5240573883056641
Epoch: 27, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.982 Vali Acc: 0.852 Test Loss: 0.982 Test Acc: 0.852
Validation loss decreased (-0.837027 --> -0.851842).  Saving model ...
Epoch: 28 cost time: 0.5043234825134277
Epoch: 28, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.946 Vali Acc: 0.859 Test Loss: 0.946 Test Acc: 0.859
Validation loss decreased (-0.851842 --> -0.859250).  Saving model ...
Epoch: 29 cost time: 0.607677698135376
Epoch: 29, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.911 Vali Acc: 0.867 Test Loss: 0.911 Test Acc: 0.867
Validation loss decreased (-0.859250 --> -0.866658).  Saving model ...
Epoch: 30 cost time: 0.5195786952972412
Epoch: 30, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.878 Vali Acc: 0.867 Test Loss: 0.878 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8666666666666667
model parameter : 92806
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0459470748901367
Epoch: 1, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.926 Vali Acc: 0.078 Test Loss: 1.926 Test Acc: 0.078
Validation loss decreased (inf --> -0.077759).  Saving model ...
Epoch: 2 cost time: 0.493743896484375
Epoch: 2, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.899 Vali Acc: 0.089 Test Loss: 1.899 Test Acc: 0.089
Validation loss decreased (-0.077759 --> -0.088870).  Saving model ...
Epoch: 3 cost time: 0.5065579414367676
Epoch: 3, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.881 Vali Acc: 0.093 Test Loss: 1.881 Test Acc: 0.093
Validation loss decreased (-0.088870 --> -0.092574).  Saving model ...
Epoch: 4 cost time: 0.5804443359375
Epoch: 4, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.866 Vali Acc: 0.096 Test Loss: 1.866 Test Acc: 0.096
Validation loss decreased (-0.092574 --> -0.096278).  Saving model ...
Epoch: 5 cost time: 0.5451693534851074
Epoch: 5, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.848 Vali Acc: 0.100 Test Loss: 1.848 Test Acc: 0.100
Validation loss decreased (-0.096278 --> -0.099982).  Saving model ...
Epoch: 6 cost time: 0.5262703895568848
Epoch: 6, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.826 Vali Acc: 0.133 Test Loss: 1.826 Test Acc: 0.133
Validation loss decreased (-0.099982 --> -0.133315).  Saving model ...
Epoch: 7 cost time: 0.5742006301879883
Epoch: 7, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.801 Vali Acc: 0.156 Test Loss: 1.801 Test Acc: 0.156
Validation loss decreased (-0.133315 --> -0.155538).  Saving model ...
Epoch: 8 cost time: 0.6378269195556641
Epoch: 8, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.773 Vali Acc: 0.181 Test Loss: 1.773 Test Acc: 0.181
Validation loss decreased (-0.155538 --> -0.181464).  Saving model ...
Epoch: 9 cost time: 0.5457959175109863
Epoch: 9, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.743 Vali Acc: 0.226 Test Loss: 1.743 Test Acc: 0.226
Validation loss decreased (-0.181464 --> -0.225908).  Saving model ...
Epoch: 10 cost time: 0.5230920314788818
Epoch: 10, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.711 Vali Acc: 0.241 Test Loss: 1.711 Test Acc: 0.241
Validation loss decreased (-0.225908 --> -0.240724).  Saving model ...
Epoch: 11 cost time: 0.5438189506530762
Epoch: 11, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.678 Vali Acc: 0.289 Test Loss: 1.678 Test Acc: 0.289
Validation loss decreased (-0.240724 --> -0.288872).  Saving model ...
Epoch: 12 cost time: 0.5072658061981201
Epoch: 12, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.645 Vali Acc: 0.330 Test Loss: 1.645 Test Acc: 0.330
Validation loss decreased (-0.288872 --> -0.329613).  Saving model ...
Epoch: 13 cost time: 0.522691011428833
Epoch: 13, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.610 Vali Acc: 0.378 Test Loss: 1.610 Test Acc: 0.378
Validation loss decreased (-0.329613 --> -0.377762).  Saving model ...
Epoch: 14 cost time: 0.5171220302581787
Epoch: 14, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.574 Vali Acc: 0.430 Test Loss: 1.574 Test Acc: 0.430
Validation loss decreased (-0.377762 --> -0.429614).  Saving model ...
Epoch: 15 cost time: 0.5334336757659912
Epoch: 15, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.537 Vali Acc: 0.519 Test Loss: 1.537 Test Acc: 0.519
Validation loss decreased (-0.429614 --> -0.518503).  Saving model ...
Epoch: 16 cost time: 0.5372521877288818
Epoch: 16, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.500 Vali Acc: 0.607 Test Loss: 1.500 Test Acc: 0.607
Validation loss decreased (-0.518503 --> -0.607392).  Saving model ...
Epoch: 17 cost time: 0.5490531921386719
Epoch: 17, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.463 Vali Acc: 0.663 Test Loss: 1.463 Test Acc: 0.663
Validation loss decreased (-0.607392 --> -0.662948).  Saving model ...
Epoch: 18 cost time: 0.5374422073364258
Epoch: 18, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.425 Vali Acc: 0.700 Test Loss: 1.425 Test Acc: 0.700
Validation loss decreased (-0.662948 --> -0.699986).  Saving model ...
Epoch: 19 cost time: 0.562922477722168
Epoch: 19, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.388 Vali Acc: 0.715 Test Loss: 1.388 Test Acc: 0.715
Validation loss decreased (-0.699986 --> -0.714801).  Saving model ...
Epoch: 20 cost time: 0.4982287883758545
Epoch: 20, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.350 Vali Acc: 0.733 Test Loss: 1.350 Test Acc: 0.733
Validation loss decreased (-0.714801 --> -0.733320).  Saving model ...
Epoch: 21 cost time: 0.527601957321167
Epoch: 21, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.312 Vali Acc: 0.748 Test Loss: 1.312 Test Acc: 0.748
Validation loss decreased (-0.733320 --> -0.748135).  Saving model ...
Epoch: 22 cost time: 0.5231895446777344
Epoch: 22, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.273 Vali Acc: 0.763 Test Loss: 1.273 Test Acc: 0.763
Validation loss decreased (-0.748135 --> -0.762950).  Saving model ...
Epoch: 23 cost time: 0.5222084522247314
Epoch: 23, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.236 Vali Acc: 0.785 Test Loss: 1.236 Test Acc: 0.785
Validation loss decreased (-0.762950 --> -0.785173).  Saving model ...
Epoch: 24 cost time: 0.5319533348083496
Epoch: 24, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.198 Vali Acc: 0.804 Test Loss: 1.198 Test Acc: 0.804
Validation loss decreased (-0.785173 --> -0.803692).  Saving model ...
Epoch: 25 cost time: 0.5586564540863037
Epoch: 25, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.160 Vali Acc: 0.807 Test Loss: 1.160 Test Acc: 0.807
Validation loss decreased (-0.803692 --> -0.807396).  Saving model ...
Epoch: 26 cost time: 0.5344593524932861
Epoch: 26, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.123 Vali Acc: 0.822 Test Loss: 1.123 Test Acc: 0.822
Validation loss decreased (-0.807396 --> -0.822211).  Saving model ...
Epoch: 27 cost time: 0.5376193523406982
Epoch: 27, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.087 Vali Acc: 0.833 Test Loss: 1.087 Test Acc: 0.833
Validation loss decreased (-0.822211 --> -0.833322).  Saving model ...
Epoch: 28 cost time: 0.5547103881835938
Epoch: 28, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.052 Vali Acc: 0.844 Test Loss: 1.052 Test Acc: 0.844
Validation loss decreased (-0.833322 --> -0.844434).  Saving model ...
Epoch: 29 cost time: 0.5237691402435303
Epoch: 29, Steps: 2 | Train Loss: 0.895 Vali Loss: 1.017 Vali Acc: 0.856 Test Loss: 1.017 Test Acc: 0.856
Validation loss decreased (-0.844434 --> -0.855545).  Saving model ...
Epoch: 30 cost time: 0.531484842300415
Epoch: 30, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.983 Vali Acc: 0.863 Test Loss: 0.983 Test Acc: 0.863
Validation loss decreased (-0.855545 --> -0.862953).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8629629629629629
model parameter : 299782
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8779771327972412
Epoch: 1, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.860 Vali Acc: 0.126 Test Loss: 1.860 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 0.5188968181610107
Epoch: 2, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.831 Vali Acc: 0.148 Test Loss: 1.831 Test Acc: 0.148
Validation loss decreased (-0.125907 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 0.5055391788482666
Epoch: 3, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.812 Vali Acc: 0.163 Test Loss: 1.812 Test Acc: 0.163
Validation loss decreased (-0.148130 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 0.5194673538208008
Epoch: 4, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.798 Vali Acc: 0.170 Test Loss: 1.798 Test Acc: 0.170
Validation loss decreased (-0.162945 --> -0.170352).  Saving model ...
Epoch: 5 cost time: 0.5123677253723145
Epoch: 5, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.779 Vali Acc: 0.178 Test Loss: 1.779 Test Acc: 0.178
Validation loss decreased (-0.170352 --> -0.177760).  Saving model ...
Epoch: 6 cost time: 0.5237061977386475
Epoch: 6, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.756 Vali Acc: 0.185 Test Loss: 1.756 Test Acc: 0.185
Validation loss decreased (-0.177760 --> -0.185168).  Saving model ...
Epoch: 7 cost time: 0.5216689109802246
Epoch: 7, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.731 Vali Acc: 0.204 Test Loss: 1.731 Test Acc: 0.204
Validation loss decreased (-0.185168 --> -0.203686).  Saving model ...
Epoch: 8 cost time: 0.5075371265411377
Epoch: 8, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.703 Vali Acc: 0.230 Test Loss: 1.703 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229613).  Saving model ...
Epoch: 9 cost time: 0.5994415283203125
Epoch: 9, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.672 Vali Acc: 0.267 Test Loss: 1.672 Test Acc: 0.267
Validation loss decreased (-0.229613 --> -0.266650).  Saving model ...
Epoch: 10 cost time: 0.5119118690490723
Epoch: 10, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.640 Vali Acc: 0.307 Test Loss: 1.640 Test Acc: 0.307
Validation loss decreased (-0.266650 --> -0.307391).  Saving model ...
Epoch: 11 cost time: 0.5599219799041748
Epoch: 11, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.605 Vali Acc: 0.341 Test Loss: 1.605 Test Acc: 0.341
Validation loss decreased (-0.307391 --> -0.340725).  Saving model ...
Epoch: 12 cost time: 0.5215847492218018
Epoch: 12, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.570 Vali Acc: 0.385 Test Loss: 1.570 Test Acc: 0.385
Validation loss decreased (-0.340725 --> -0.385169).  Saving model ...
Epoch: 13 cost time: 0.5136682987213135
Epoch: 13, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.533 Vali Acc: 0.411 Test Loss: 1.533 Test Acc: 0.411
Validation loss decreased (-0.385169 --> -0.411096).  Saving model ...
Epoch: 14 cost time: 0.584618330001831
Epoch: 14, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.495 Vali Acc: 0.467 Test Loss: 1.495 Test Acc: 0.467
Validation loss decreased (-0.411096 --> -0.466652).  Saving model ...
Epoch: 15 cost time: 0.5350008010864258
Epoch: 15, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.456 Vali Acc: 0.507 Test Loss: 1.456 Test Acc: 0.507
Validation loss decreased (-0.466652 --> -0.507393).  Saving model ...
Epoch: 16 cost time: 0.501314640045166
Epoch: 16, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.417 Vali Acc: 0.563 Test Loss: 1.417 Test Acc: 0.563
Validation loss decreased (-0.507393 --> -0.562949).  Saving model ...
Epoch: 17 cost time: 0.510789155960083
Epoch: 17, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.377 Vali Acc: 0.626 Test Loss: 1.377 Test Acc: 0.626
Validation loss decreased (-0.562949 --> -0.625912).  Saving model ...
Epoch: 18 cost time: 0.49218034744262695
Epoch: 18, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.337 Vali Acc: 0.670 Test Loss: 1.337 Test Acc: 0.670
Validation loss decreased (-0.625912 --> -0.670357).  Saving model ...
Epoch: 19 cost time: 0.5348234176635742
Epoch: 19, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.296 Vali Acc: 0.711 Test Loss: 1.296 Test Acc: 0.711
Validation loss decreased (-0.670357 --> -0.711098).  Saving model ...
Epoch: 20 cost time: 0.5587871074676514
Epoch: 20, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.256 Vali Acc: 0.748 Test Loss: 1.256 Test Acc: 0.748
Validation loss decreased (-0.711098 --> -0.748136).  Saving model ...
Epoch: 21 cost time: 0.5796706676483154
Epoch: 21, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.216 Vali Acc: 0.770 Test Loss: 1.216 Test Acc: 0.770
Validation loss decreased (-0.748136 --> -0.770358).  Saving model ...
Epoch: 22 cost time: 0.5427920818328857
Epoch: 22, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.175 Vali Acc: 0.800 Test Loss: 1.175 Test Acc: 0.800
Validation loss decreased (-0.770358 --> -0.799988).  Saving model ...
Epoch: 23 cost time: 0.6037304401397705
Epoch: 23, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.135 Vali Acc: 0.811 Test Loss: 1.135 Test Acc: 0.811
Validation loss decreased (-0.799988 --> -0.811100).  Saving model ...
Epoch: 24 cost time: 0.5609838962554932
Epoch: 24, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.096 Vali Acc: 0.826 Test Loss: 1.096 Test Acc: 0.826
Validation loss decreased (-0.811100 --> -0.825915).  Saving model ...
Epoch: 25 cost time: 0.5365314483642578
Epoch: 25, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.057 Vali Acc: 0.833 Test Loss: 1.057 Test Acc: 0.833
Validation loss decreased (-0.825915 --> -0.833323).  Saving model ...
Epoch: 26 cost time: 0.5291550159454346
Epoch: 26, Steps: 2 | Train Loss: 0.882 Vali Loss: 1.019 Vali Acc: 0.837 Test Loss: 1.019 Test Acc: 0.837
Validation loss decreased (-0.833323 --> -0.837027).  Saving model ...
Epoch: 27 cost time: 0.56087327003479
Epoch: 27, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.982 Vali Acc: 0.852 Test Loss: 0.982 Test Acc: 0.852
Validation loss decreased (-0.837027 --> -0.851842).  Saving model ...
Epoch: 28 cost time: 0.5543346405029297
Epoch: 28, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.946 Vali Acc: 0.859 Test Loss: 0.946 Test Acc: 0.859
Validation loss decreased (-0.851842 --> -0.859250).  Saving model ...
Epoch: 29 cost time: 0.5616757869720459
Epoch: 29, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.911 Vali Acc: 0.867 Test Loss: 0.911 Test Acc: 0.867
Validation loss decreased (-0.859250 --> -0.866658).  Saving model ...
Epoch: 30 cost time: 0.5471513271331787
Epoch: 30, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.878 Vali Acc: 0.867 Test Loss: 0.878 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8666666666666667
model parameter : 92806
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0300498008728027
Epoch: 1, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.926 Vali Acc: 0.078 Test Loss: 1.926 Test Acc: 0.078
Validation loss decreased (inf --> -0.077759).  Saving model ...
Epoch: 2 cost time: 0.4617159366607666
Epoch: 2, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.899 Vali Acc: 0.085 Test Loss: 1.899 Test Acc: 0.085
Validation loss decreased (-0.077759 --> -0.085166).  Saving model ...
Epoch: 3 cost time: 0.48555636405944824
Epoch: 3, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.881 Vali Acc: 0.089 Test Loss: 1.881 Test Acc: 0.089
Validation loss decreased (-0.085166 --> -0.088870).  Saving model ...
Epoch: 4 cost time: 0.4723019599914551
Epoch: 4, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.867 Vali Acc: 0.093 Test Loss: 1.867 Test Acc: 0.093
Validation loss decreased (-0.088870 --> -0.092574).  Saving model ...
Epoch: 5 cost time: 0.4920492172241211
Epoch: 5, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.848 Vali Acc: 0.100 Test Loss: 1.848 Test Acc: 0.100
Validation loss decreased (-0.092574 --> -0.099982).  Saving model ...
Epoch: 6 cost time: 0.47629261016845703
Epoch: 6, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.826 Vali Acc: 0.126 Test Loss: 1.826 Test Acc: 0.126
Validation loss decreased (-0.099982 --> -0.125908).  Saving model ...
Epoch: 7 cost time: 0.48633646965026855
Epoch: 7, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.801 Vali Acc: 0.156 Test Loss: 1.801 Test Acc: 0.156
Validation loss decreased (-0.125908 --> -0.155538).  Saving model ...
Epoch: 8 cost time: 0.47788000106811523
Epoch: 8, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.773 Vali Acc: 0.181 Test Loss: 1.773 Test Acc: 0.181
Validation loss decreased (-0.155538 --> -0.181464).  Saving model ...
Epoch: 9 cost time: 0.5144839286804199
Epoch: 9, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.743 Vali Acc: 0.222 Test Loss: 1.743 Test Acc: 0.222
Validation loss decreased (-0.181464 --> -0.222205).  Saving model ...
Epoch: 10 cost time: 0.5405793190002441
Epoch: 10, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.711 Vali Acc: 0.241 Test Loss: 1.711 Test Acc: 0.241
Validation loss decreased (-0.222205 --> -0.240724).  Saving model ...
Epoch: 11 cost time: 0.560931921005249
Epoch: 11, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.679 Vali Acc: 0.289 Test Loss: 1.679 Test Acc: 0.289
Validation loss decreased (-0.240724 --> -0.288872).  Saving model ...
Epoch: 12 cost time: 0.5026919841766357
Epoch: 12, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.645 Vali Acc: 0.330 Test Loss: 1.645 Test Acc: 0.330
Validation loss decreased (-0.288872 --> -0.329613).  Saving model ...
Epoch: 13 cost time: 0.4794299602508545
Epoch: 13, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.611 Vali Acc: 0.378 Test Loss: 1.611 Test Acc: 0.378
Validation loss decreased (-0.329613 --> -0.377762).  Saving model ...
Epoch: 14 cost time: 0.48366546630859375
Epoch: 14, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.575 Vali Acc: 0.430 Test Loss: 1.575 Test Acc: 0.430
Validation loss decreased (-0.377762 --> -0.429614).  Saving model ...
Epoch: 15 cost time: 0.48537158966064453
Epoch: 15, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.538 Vali Acc: 0.519 Test Loss: 1.538 Test Acc: 0.519
Validation loss decreased (-0.429614 --> -0.518503).  Saving model ...
Epoch: 16 cost time: 0.5036952495574951
Epoch: 16, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.501 Vali Acc: 0.607 Test Loss: 1.501 Test Acc: 0.607
Validation loss decreased (-0.518503 --> -0.607392).  Saving model ...
Epoch: 17 cost time: 0.46489620208740234
Epoch: 17, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.464 Vali Acc: 0.663 Test Loss: 1.464 Test Acc: 0.663
Validation loss decreased (-0.607392 --> -0.662948).  Saving model ...
Epoch: 18 cost time: 0.5009334087371826
Epoch: 18, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.426 Vali Acc: 0.696 Test Loss: 1.426 Test Acc: 0.696
Validation loss decreased (-0.662948 --> -0.696282).  Saving model ...
Epoch: 19 cost time: 0.4827744960784912
Epoch: 19, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.389 Vali Acc: 0.715 Test Loss: 1.389 Test Acc: 0.715
Validation loss decreased (-0.696282 --> -0.714801).  Saving model ...
Epoch: 20 cost time: 0.4642784595489502
Epoch: 20, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.351 Vali Acc: 0.730 Test Loss: 1.351 Test Acc: 0.730
Validation loss decreased (-0.714801 --> -0.729616).  Saving model ...
Epoch: 21 cost time: 0.48262763023376465
Epoch: 21, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.313 Vali Acc: 0.744 Test Loss: 1.313 Test Acc: 0.744
Validation loss decreased (-0.729616 --> -0.744431).  Saving model ...
Epoch: 22 cost time: 0.5173490047454834
Epoch: 22, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.275 Vali Acc: 0.763 Test Loss: 1.275 Test Acc: 0.763
Validation loss decreased (-0.744431 --> -0.762950).  Saving model ...
Epoch: 23 cost time: 0.4893348217010498
Epoch: 23, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.237 Vali Acc: 0.785 Test Loss: 1.237 Test Acc: 0.785
Validation loss decreased (-0.762950 --> -0.785173).  Saving model ...
Epoch: 24 cost time: 0.5034749507904053
Epoch: 24, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.200 Vali Acc: 0.804 Test Loss: 1.200 Test Acc: 0.804
Validation loss decreased (-0.785173 --> -0.803692).  Saving model ...
Epoch: 25 cost time: 0.5338242053985596
Epoch: 25, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.162 Vali Acc: 0.811 Test Loss: 1.162 Test Acc: 0.811
Validation loss decreased (-0.803692 --> -0.811099).  Saving model ...
Epoch: 26 cost time: 0.47873854637145996
Epoch: 26, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.125 Vali Acc: 0.826 Test Loss: 1.125 Test Acc: 0.826
Validation loss decreased (-0.811099 --> -0.825915).  Saving model ...
Epoch: 27 cost time: 0.47388577461242676
Epoch: 27, Steps: 2 | Train Loss: 1.000 Vali Loss: 1.089 Vali Acc: 0.830 Test Loss: 1.089 Test Acc: 0.830
Validation loss decreased (-0.825915 --> -0.829619).  Saving model ...
Epoch: 28 cost time: 0.49776721000671387
Epoch: 28, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.054 Vali Acc: 0.844 Test Loss: 1.054 Test Acc: 0.844
Validation loss decreased (-0.829619 --> -0.844434).  Saving model ...
Epoch: 29 cost time: 0.4967231750488281
Epoch: 29, Steps: 2 | Train Loss: 0.901 Vali Loss: 1.019 Vali Acc: 0.856 Test Loss: 1.019 Test Acc: 0.856
Validation loss decreased (-0.844434 --> -0.855545).  Saving model ...
Epoch: 30 cost time: 0.4912900924682617
Epoch: 30, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.985 Vali Acc: 0.863 Test Loss: 0.985 Test Acc: 0.863
Validation loss decreased (-0.855545 --> -0.862953).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8629629629629629
model parameter : 299782
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1082684993743896
Epoch: 1, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.860 Vali Acc: 0.126 Test Loss: 1.860 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 0.4574885368347168
Epoch: 2, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.831 Vali Acc: 0.148 Test Loss: 1.831 Test Acc: 0.148
Validation loss decreased (-0.125907 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 0.5005600452423096
Epoch: 3, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.812 Vali Acc: 0.163 Test Loss: 1.812 Test Acc: 0.163
Validation loss decreased (-0.148130 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 0.5431718826293945
Epoch: 4, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.797 Vali Acc: 0.170 Test Loss: 1.797 Test Acc: 0.170
Validation loss decreased (-0.162945 --> -0.170352).  Saving model ...
Epoch: 5 cost time: 0.4826838970184326
Epoch: 5, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.779 Vali Acc: 0.178 Test Loss: 1.779 Test Acc: 0.178
Validation loss decreased (-0.170352 --> -0.177760).  Saving model ...
Epoch: 6 cost time: 0.47056031227111816
Epoch: 6, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.756 Vali Acc: 0.189 Test Loss: 1.756 Test Acc: 0.189
Validation loss decreased (-0.177760 --> -0.188871).  Saving model ...
Epoch: 7 cost time: 0.49581384658813477
Epoch: 7, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.731 Vali Acc: 0.204 Test Loss: 1.731 Test Acc: 0.204
Validation loss decreased (-0.188871 --> -0.203686).  Saving model ...
Epoch: 8 cost time: 0.49976110458374023
Epoch: 8, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.703 Vali Acc: 0.230 Test Loss: 1.703 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229613).  Saving model ...
Epoch: 9 cost time: 0.451216459274292
Epoch: 9, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.672 Vali Acc: 0.267 Test Loss: 1.672 Test Acc: 0.267
Validation loss decreased (-0.229613 --> -0.266650).  Saving model ...
Epoch: 10 cost time: 0.5255885124206543
Epoch: 10, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.640 Vali Acc: 0.307 Test Loss: 1.640 Test Acc: 0.307
Validation loss decreased (-0.266650 --> -0.307391).  Saving model ...
Epoch: 11 cost time: 0.49831390380859375
Epoch: 11, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.606 Vali Acc: 0.341 Test Loss: 1.606 Test Acc: 0.341
Validation loss decreased (-0.307391 --> -0.340725).  Saving model ...
Epoch: 12 cost time: 0.4906771183013916
Epoch: 12, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.570 Vali Acc: 0.385 Test Loss: 1.570 Test Acc: 0.385
Validation loss decreased (-0.340725 --> -0.385169).  Saving model ...
Epoch: 13 cost time: 0.4866342544555664
Epoch: 13, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.533 Vali Acc: 0.411 Test Loss: 1.533 Test Acc: 0.411
Validation loss decreased (-0.385169 --> -0.411096).  Saving model ...
Epoch: 14 cost time: 0.499453067779541
Epoch: 14, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.496 Vali Acc: 0.467 Test Loss: 1.496 Test Acc: 0.467
Validation loss decreased (-0.411096 --> -0.466652).  Saving model ...
Epoch: 15 cost time: 0.5202803611755371
Epoch: 15, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.457 Vali Acc: 0.511 Test Loss: 1.457 Test Acc: 0.511
Validation loss decreased (-0.466652 --> -0.511097).  Saving model ...
Epoch: 16 cost time: 0.45438122749328613
Epoch: 16, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.418 Vali Acc: 0.559 Test Loss: 1.418 Test Acc: 0.559
Validation loss decreased (-0.511097 --> -0.559245).  Saving model ...
Epoch: 17 cost time: 0.51371169090271
Epoch: 17, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.378 Vali Acc: 0.630 Test Loss: 1.378 Test Acc: 0.630
Validation loss decreased (-0.559245 --> -0.629616).  Saving model ...
Epoch: 18 cost time: 0.49385499954223633
Epoch: 18, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.338 Vali Acc: 0.674 Test Loss: 1.338 Test Acc: 0.674
Validation loss decreased (-0.629616 --> -0.674061).  Saving model ...
Epoch: 19 cost time: 0.47305965423583984
Epoch: 19, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.297 Vali Acc: 0.711 Test Loss: 1.297 Test Acc: 0.711
Validation loss decreased (-0.674061 --> -0.711098).  Saving model ...
Epoch: 20 cost time: 0.49913859367370605
Epoch: 20, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.257 Vali Acc: 0.748 Test Loss: 1.257 Test Acc: 0.748
Validation loss decreased (-0.711098 --> -0.748136).  Saving model ...
Epoch: 21 cost time: 0.5159680843353271
Epoch: 21, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.217 Vali Acc: 0.770 Test Loss: 1.217 Test Acc: 0.770
Validation loss decreased (-0.748136 --> -0.770358).  Saving model ...
Epoch: 22 cost time: 0.46355748176574707
Epoch: 22, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.177 Vali Acc: 0.800 Test Loss: 1.177 Test Acc: 0.800
Validation loss decreased (-0.770358 --> -0.799988).  Saving model ...
Epoch: 23 cost time: 0.45029163360595703
Epoch: 23, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.137 Vali Acc: 0.811 Test Loss: 1.137 Test Acc: 0.811
Validation loss decreased (-0.799988 --> -0.811100).  Saving model ...
Epoch: 24 cost time: 0.4816768169403076
Epoch: 24, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.097 Vali Acc: 0.826 Test Loss: 1.097 Test Acc: 0.826
Validation loss decreased (-0.811100 --> -0.825915).  Saving model ...
Epoch: 25 cost time: 0.4512314796447754
Epoch: 25, Steps: 2 | Train Loss: 0.910 Vali Loss: 1.059 Vali Acc: 0.837 Test Loss: 1.059 Test Acc: 0.837
Validation loss decreased (-0.825915 --> -0.837026).  Saving model ...
Epoch: 26 cost time: 0.4781014919281006
Epoch: 26, Steps: 2 | Train Loss: 0.886 Vali Loss: 1.021 Vali Acc: 0.841 Test Loss: 1.021 Test Acc: 0.841
Validation loss decreased (-0.837026 --> -0.840731).  Saving model ...
Epoch: 27 cost time: 0.5179989337921143
Epoch: 27, Steps: 2 | Train Loss: 0.845 Vali Loss: 0.984 Vali Acc: 0.852 Test Loss: 0.984 Test Acc: 0.852
Validation loss decreased (-0.840731 --> -0.851842).  Saving model ...
Epoch: 28 cost time: 0.576042890548706
Epoch: 28, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.948 Vali Acc: 0.859 Test Loss: 0.948 Test Acc: 0.859
Validation loss decreased (-0.851842 --> -0.859250).  Saving model ...
Epoch: 29 cost time: 0.5071051120758057
Epoch: 29, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.913 Vali Acc: 0.867 Test Loss: 0.913 Test Acc: 0.867
Validation loss decreased (-0.859250 --> -0.866658).  Saving model ...
Epoch: 30 cost time: 0.4952538013458252
Epoch: 30, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.879 Vali Acc: 0.867 Test Loss: 0.879 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8666666666666667
model parameter : 92806
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.342740297317505
Epoch: 1, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.731 Vali Acc: 0.170 Test Loss: 1.731 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.5391488075256348
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.710 Vali Acc: 0.181 Test Loss: 1.710 Test Acc: 0.181
Validation loss decreased (-0.170353 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.5884354114532471
Epoch: 3, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.697 Vali Acc: 0.181 Test Loss: 1.697 Test Acc: 0.181
Validation loss decreased (-0.181464 --> -0.181465).  Saving model ...
Epoch: 4 cost time: 0.5775997638702393
Epoch: 4, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.689 Vali Acc: 0.185 Test Loss: 1.689 Test Acc: 0.185
Validation loss decreased (-0.181465 --> -0.185168).  Saving model ...
Epoch: 5 cost time: 0.6119217872619629
Epoch: 5, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.678 Vali Acc: 0.193 Test Loss: 1.678 Test Acc: 0.193
Validation loss decreased (-0.185168 --> -0.192576).  Saving model ...
Epoch: 6 cost time: 0.6035668849945068
Epoch: 6, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.666 Vali Acc: 0.219 Test Loss: 1.666 Test Acc: 0.219
Validation loss decreased (-0.192576 --> -0.218502).  Saving model ...
Epoch: 7 cost time: 0.5893161296844482
Epoch: 7, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.652 Vali Acc: 0.222 Test Loss: 1.652 Test Acc: 0.222
Validation loss decreased (-0.218502 --> -0.222206).  Saving model ...
Epoch: 8 cost time: 0.5994770526885986
Epoch: 8, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.636 Vali Acc: 0.237 Test Loss: 1.636 Test Acc: 0.237
Validation loss decreased (-0.222206 --> -0.237021).  Saving model ...
Epoch: 9 cost time: 0.5699810981750488
Epoch: 9, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.619 Vali Acc: 0.259 Test Loss: 1.619 Test Acc: 0.259
Validation loss decreased (-0.237021 --> -0.259243).  Saving model ...
Epoch: 10 cost time: 0.5677752494812012
Epoch: 10, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.601 Vali Acc: 0.293 Test Loss: 1.601 Test Acc: 0.293
Validation loss decreased (-0.259243 --> -0.292577).  Saving model ...
Epoch: 11 cost time: 0.5723834037780762
Epoch: 11, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.581 Vali Acc: 0.322 Test Loss: 1.581 Test Acc: 0.322
Validation loss decreased (-0.292577 --> -0.322206).  Saving model ...
Epoch: 12 cost time: 0.6255536079406738
Epoch: 12, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.561 Vali Acc: 0.352 Test Loss: 1.561 Test Acc: 0.352
Validation loss decreased (-0.322206 --> -0.351836).  Saving model ...
Epoch: 13 cost time: 0.6003155708312988
Epoch: 13, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.541 Vali Acc: 0.407 Test Loss: 1.541 Test Acc: 0.407
Validation loss decreased (-0.351836 --> -0.407392).  Saving model ...
Epoch: 14 cost time: 0.5956244468688965
Epoch: 14, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.519 Vali Acc: 0.481 Test Loss: 1.519 Test Acc: 0.481
Validation loss decreased (-0.407392 --> -0.481466).  Saving model ...
Epoch: 15 cost time: 0.574772834777832
Epoch: 15, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.497 Vali Acc: 0.533 Test Loss: 1.497 Test Acc: 0.533
Validation loss decreased (-0.481466 --> -0.533318).  Saving model ...
Epoch: 16 cost time: 0.6425950527191162
Epoch: 16, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.475 Vali Acc: 0.581 Test Loss: 1.475 Test Acc: 0.581
Validation loss decreased (-0.533318 --> -0.581467).  Saving model ...
Epoch: 17 cost time: 0.6117260456085205
Epoch: 17, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.452 Vali Acc: 0.604 Test Loss: 1.452 Test Acc: 0.604
Validation loss decreased (-0.581467 --> -0.603689).  Saving model ...
Epoch: 18 cost time: 0.6187326908111572
Epoch: 18, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.428 Vali Acc: 0.630 Test Loss: 1.428 Test Acc: 0.630
Validation loss decreased (-0.603689 --> -0.629615).  Saving model ...
Epoch: 19 cost time: 0.5824809074401855
Epoch: 19, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.405 Vali Acc: 0.644 Test Loss: 1.405 Test Acc: 0.644
Validation loss decreased (-0.629615 --> -0.644430).  Saving model ...
Epoch: 20 cost time: 0.5807456970214844
Epoch: 20, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.382 Vali Acc: 0.678 Test Loss: 1.382 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677764).  Saving model ...
Epoch: 21 cost time: 0.5434925556182861
Epoch: 21, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.359 Vali Acc: 0.685 Test Loss: 1.359 Test Acc: 0.685
Validation loss decreased (-0.677764 --> -0.685172).  Saving model ...
Epoch: 22 cost time: 0.5652151107788086
Epoch: 22, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.335 Vali Acc: 0.696 Test Loss: 1.335 Test Acc: 0.696
Validation loss decreased (-0.685172 --> -0.696283).  Saving model ...
Epoch: 23 cost time: 0.5830779075622559
Epoch: 23, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.311 Vali Acc: 0.711 Test Loss: 1.311 Test Acc: 0.711
Validation loss decreased (-0.696283 --> -0.711098).  Saving model ...
Epoch: 24 cost time: 0.5789744853973389
Epoch: 24, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.287 Vali Acc: 0.719 Test Loss: 1.287 Test Acc: 0.719
Validation loss decreased (-0.711098 --> -0.718506).  Saving model ...
Epoch: 25 cost time: 0.6517493724822998
Epoch: 25, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.263 Vali Acc: 0.733 Test Loss: 1.263 Test Acc: 0.733
Validation loss decreased (-0.718506 --> -0.733321).  Saving model ...
Epoch: 26 cost time: 0.6173486709594727
Epoch: 26, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.239 Vali Acc: 0.741 Test Loss: 1.239 Test Acc: 0.741
Validation loss decreased (-0.733321 --> -0.740728).  Saving model ...
Epoch: 27 cost time: 0.6966865062713623
Epoch: 27, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.214 Vali Acc: 0.748 Test Loss: 1.214 Test Acc: 0.748
Validation loss decreased (-0.740728 --> -0.748136).  Saving model ...
Epoch: 28 cost time: 0.6046276092529297
Epoch: 28, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.189 Vali Acc: 0.778 Test Loss: 1.189 Test Acc: 0.778
Validation loss decreased (-0.748136 --> -0.777766).  Saving model ...
Epoch: 29 cost time: 0.6807079315185547
Epoch: 29, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.165 Vali Acc: 0.778 Test Loss: 1.165 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777766).  Saving model ...
Epoch: 30 cost time: 0.7279672622680664
Epoch: 30, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.140 Vali Acc: 0.789 Test Loss: 1.140 Test Acc: 0.789
Validation loss decreased (-0.777766 --> -0.788877).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7888888888888889
model parameter : 589862
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3136537075042725
Epoch: 1, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.824 Vali Acc: 0.196 Test Loss: 1.824 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.5555267333984375
Epoch: 2, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.805 Vali Acc: 0.207 Test Loss: 1.805 Test Acc: 0.207
Validation loss decreased (-0.196278 --> -0.207389).  Saving model ...
Epoch: 3 cost time: 0.5919065475463867
Epoch: 3, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.793 Vali Acc: 0.226 Test Loss: 1.793 Test Acc: 0.226
Validation loss decreased (-0.207389 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.612431526184082
Epoch: 4, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.784 Vali Acc: 0.230 Test Loss: 1.784 Test Acc: 0.230
Validation loss decreased (-0.225908 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.5386173725128174
Epoch: 5, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.772 Vali Acc: 0.241 Test Loss: 1.772 Test Acc: 0.241
Validation loss decreased (-0.229612 --> -0.240723).  Saving model ...
Epoch: 6 cost time: 0.6165735721588135
Epoch: 6, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.759 Vali Acc: 0.252 Test Loss: 1.759 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251834).  Saving model ...
Epoch: 7 cost time: 0.6265788078308105
Epoch: 7, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.743 Vali Acc: 0.252 Test Loss: 1.743 Test Acc: 0.252
Validation loss decreased (-0.251834 --> -0.251834).  Saving model ...
Epoch: 8 cost time: 0.5982804298400879
Epoch: 8, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.726 Vali Acc: 0.263 Test Loss: 1.726 Test Acc: 0.263
Validation loss decreased (-0.251834 --> -0.262946).  Saving model ...
Epoch: 9 cost time: 0.6223232746124268
Epoch: 9, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.708 Vali Acc: 0.270 Test Loss: 1.708 Test Acc: 0.270
Validation loss decreased (-0.262946 --> -0.270353).  Saving model ...
Epoch: 10 cost time: 0.6174488067626953
Epoch: 10, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.688 Vali Acc: 0.278 Test Loss: 1.688 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277761).  Saving model ...
Epoch: 11 cost time: 0.5751242637634277
Epoch: 11, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.668 Vali Acc: 0.304 Test Loss: 1.668 Test Acc: 0.304
Validation loss decreased (-0.277761 --> -0.303687).  Saving model ...
Epoch: 12 cost time: 0.5563530921936035
Epoch: 12, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.646 Vali Acc: 0.337 Test Loss: 1.646 Test Acc: 0.337
Validation loss decreased (-0.303687 --> -0.337021).  Saving model ...
Epoch: 13 cost time: 0.5858175754547119
Epoch: 13, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.624 Vali Acc: 0.367 Test Loss: 1.624 Test Acc: 0.367
Validation loss decreased (-0.337021 --> -0.366650).  Saving model ...
Epoch: 14 cost time: 0.5465476512908936
Epoch: 14, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.601 Vali Acc: 0.404 Test Loss: 1.601 Test Acc: 0.404
Validation loss decreased (-0.366650 --> -0.403688).  Saving model ...
Epoch: 15 cost time: 0.5439403057098389
Epoch: 15, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.578 Vali Acc: 0.426 Test Loss: 1.578 Test Acc: 0.426
Validation loss decreased (-0.403688 --> -0.425910).  Saving model ...
Epoch: 16 cost time: 0.581993579864502
Epoch: 16, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.554 Vali Acc: 0.433 Test Loss: 1.554 Test Acc: 0.433
Validation loss decreased (-0.425910 --> -0.433318).  Saving model ...
Epoch: 17 cost time: 0.6118640899658203
Epoch: 17, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.531 Vali Acc: 0.467 Test Loss: 1.531 Test Acc: 0.467
Validation loss decreased (-0.433318 --> -0.466651).  Saving model ...
Epoch: 18 cost time: 0.5693225860595703
Epoch: 18, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.506 Vali Acc: 0.481 Test Loss: 1.506 Test Acc: 0.481
Validation loss decreased (-0.466651 --> -0.481466).  Saving model ...
Epoch: 19 cost time: 0.5691244602203369
Epoch: 19, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.482 Vali Acc: 0.511 Test Loss: 1.482 Test Acc: 0.511
Validation loss decreased (-0.481466 --> -0.511096).  Saving model ...
Epoch: 20 cost time: 0.5463292598724365
Epoch: 20, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.457 Vali Acc: 0.559 Test Loss: 1.457 Test Acc: 0.559
Validation loss decreased (-0.511096 --> -0.559245).  Saving model ...
Epoch: 21 cost time: 0.5577020645141602
Epoch: 21, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.432 Vali Acc: 0.600 Test Loss: 1.432 Test Acc: 0.600
Validation loss decreased (-0.559245 --> -0.599986).  Saving model ...
Epoch: 22 cost time: 0.5668926239013672
Epoch: 22, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.407 Vali Acc: 0.619 Test Loss: 1.407 Test Acc: 0.619
Validation loss decreased (-0.599986 --> -0.618504).  Saving model ...
Epoch: 23 cost time: 0.5551962852478027
Epoch: 23, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.382 Vali Acc: 0.633 Test Loss: 1.382 Test Acc: 0.633
Validation loss decreased (-0.618504 --> -0.633320).  Saving model ...
Epoch: 24 cost time: 0.566032886505127
Epoch: 24, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.356 Vali Acc: 0.648 Test Loss: 1.356 Test Acc: 0.648
Validation loss decreased (-0.633320 --> -0.648135).  Saving model ...
Epoch: 25 cost time: 0.5811281204223633
Epoch: 25, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.331 Vali Acc: 0.663 Test Loss: 1.331 Test Acc: 0.663
Validation loss decreased (-0.648135 --> -0.662950).  Saving model ...
Epoch: 26 cost time: 0.5470306873321533
Epoch: 26, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.305 Vali Acc: 0.689 Test Loss: 1.305 Test Acc: 0.689
Validation loss decreased (-0.662950 --> -0.688876).  Saving model ...
Epoch: 27 cost time: 0.4987509250640869
Epoch: 27, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.280 Vali Acc: 0.704 Test Loss: 1.280 Test Acc: 0.704
Validation loss decreased (-0.688876 --> -0.703691).  Saving model ...
Epoch: 28 cost time: 0.5569961071014404
Epoch: 28, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.254 Vali Acc: 0.711 Test Loss: 1.254 Test Acc: 0.711
Validation loss decreased (-0.703691 --> -0.711099).  Saving model ...
Epoch: 29 cost time: 0.5357425212860107
Epoch: 29, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.229 Vali Acc: 0.726 Test Loss: 1.229 Test Acc: 0.726
Validation loss decreased (-0.711099 --> -0.725914).  Saving model ...
Epoch: 30 cost time: 0.5366475582122803
Epoch: 30, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.203 Vali Acc: 0.741 Test Loss: 1.203 Test Acc: 0.741
Validation loss decreased (-0.725914 --> -0.740729).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7407407407407407
model parameter : 175878
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0393221378326416
Epoch: 1, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.731 Vali Acc: 0.170 Test Loss: 1.731 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.5396914482116699
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.710 Vali Acc: 0.181 Test Loss: 1.710 Test Acc: 0.181
Validation loss decreased (-0.170353 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.6481409072875977
Epoch: 3, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.697 Vali Acc: 0.181 Test Loss: 1.697 Test Acc: 0.181
Validation loss decreased (-0.181464 --> -0.181465).  Saving model ...
Epoch: 4 cost time: 0.5402250289916992
Epoch: 4, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.689 Vali Acc: 0.185 Test Loss: 1.689 Test Acc: 0.185
Validation loss decreased (-0.181465 --> -0.185168).  Saving model ...
Epoch: 5 cost time: 0.5726938247680664
Epoch: 5, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.678 Vali Acc: 0.193 Test Loss: 1.678 Test Acc: 0.193
Validation loss decreased (-0.185168 --> -0.192576).  Saving model ...
Epoch: 6 cost time: 0.5489034652709961
Epoch: 6, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.666 Vali Acc: 0.219 Test Loss: 1.666 Test Acc: 0.219
Validation loss decreased (-0.192576 --> -0.218502).  Saving model ...
Epoch: 7 cost time: 0.5885415077209473
Epoch: 7, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.652 Vali Acc: 0.222 Test Loss: 1.652 Test Acc: 0.222
Validation loss decreased (-0.218502 --> -0.222206).  Saving model ...
Epoch: 8 cost time: 0.5792686939239502
Epoch: 8, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.636 Vali Acc: 0.237 Test Loss: 1.636 Test Acc: 0.237
Validation loss decreased (-0.222206 --> -0.237021).  Saving model ...
Epoch: 9 cost time: 0.5608465671539307
Epoch: 9, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.619 Vali Acc: 0.259 Test Loss: 1.619 Test Acc: 0.259
Validation loss decreased (-0.237021 --> -0.259243).  Saving model ...
Epoch: 10 cost time: 0.5548121929168701
Epoch: 10, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.601 Vali Acc: 0.293 Test Loss: 1.601 Test Acc: 0.293
Validation loss decreased (-0.259243 --> -0.292577).  Saving model ...
Epoch: 11 cost time: 0.5261003971099854
Epoch: 11, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.582 Vali Acc: 0.322 Test Loss: 1.582 Test Acc: 0.322
Validation loss decreased (-0.292577 --> -0.322206).  Saving model ...
Epoch: 12 cost time: 0.558549165725708
Epoch: 12, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.562 Vali Acc: 0.352 Test Loss: 1.562 Test Acc: 0.352
Validation loss decreased (-0.322206 --> -0.351836).  Saving model ...
Epoch: 13 cost time: 0.5548696517944336
Epoch: 13, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.541 Vali Acc: 0.407 Test Loss: 1.541 Test Acc: 0.407
Validation loss decreased (-0.351836 --> -0.407392).  Saving model ...
Epoch: 14 cost time: 0.6042780876159668
Epoch: 14, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.519 Vali Acc: 0.481 Test Loss: 1.519 Test Acc: 0.481
Validation loss decreased (-0.407392 --> -0.481466).  Saving model ...
Epoch: 15 cost time: 0.5576469898223877
Epoch: 15, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.497 Vali Acc: 0.533 Test Loss: 1.497 Test Acc: 0.533
Validation loss decreased (-0.481466 --> -0.533318).  Saving model ...
Epoch: 16 cost time: 0.5438446998596191
Epoch: 16, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.475 Vali Acc: 0.581 Test Loss: 1.475 Test Acc: 0.581
Validation loss decreased (-0.533318 --> -0.581467).  Saving model ...
Epoch: 17 cost time: 0.5351049900054932
Epoch: 17, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.452 Vali Acc: 0.604 Test Loss: 1.452 Test Acc: 0.604
Validation loss decreased (-0.581467 --> -0.603689).  Saving model ...
Epoch: 18 cost time: 0.5744554996490479
Epoch: 18, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.429 Vali Acc: 0.630 Test Loss: 1.429 Test Acc: 0.630
Validation loss decreased (-0.603689 --> -0.629615).  Saving model ...
Epoch: 19 cost time: 0.5806481838226318
Epoch: 19, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.406 Vali Acc: 0.644 Test Loss: 1.406 Test Acc: 0.644
Validation loss decreased (-0.629615 --> -0.644430).  Saving model ...
Epoch: 20 cost time: 0.543342113494873
Epoch: 20, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.382 Vali Acc: 0.678 Test Loss: 1.382 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677764).  Saving model ...
Epoch: 21 cost time: 0.6189813613891602
Epoch: 21, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.359 Vali Acc: 0.685 Test Loss: 1.359 Test Acc: 0.685
Validation loss decreased (-0.677764 --> -0.685172).  Saving model ...
Epoch: 22 cost time: 0.5500404834747314
Epoch: 22, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.335 Vali Acc: 0.696 Test Loss: 1.335 Test Acc: 0.696
Validation loss decreased (-0.685172 --> -0.696283).  Saving model ...
Epoch: 23 cost time: 0.5297548770904541
Epoch: 23, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.312 Vali Acc: 0.711 Test Loss: 1.312 Test Acc: 0.711
Validation loss decreased (-0.696283 --> -0.711098).  Saving model ...
Epoch: 24 cost time: 0.551074743270874
Epoch: 24, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.288 Vali Acc: 0.719 Test Loss: 1.288 Test Acc: 0.719
Validation loss decreased (-0.711098 --> -0.718506).  Saving model ...
Epoch: 25 cost time: 0.5837492942810059
Epoch: 25, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.264 Vali Acc: 0.730 Test Loss: 1.264 Test Acc: 0.730
Validation loss decreased (-0.718506 --> -0.729617).  Saving model ...
Epoch: 26 cost time: 0.6036813259124756
Epoch: 26, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.239 Vali Acc: 0.737 Test Loss: 1.239 Test Acc: 0.737
Validation loss decreased (-0.729617 --> -0.737025).  Saving model ...
Epoch: 27 cost time: 0.5520153045654297
Epoch: 27, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.214 Vali Acc: 0.744 Test Loss: 1.214 Test Acc: 0.744
Validation loss decreased (-0.737025 --> -0.744432).  Saving model ...
Epoch: 28 cost time: 0.5664913654327393
Epoch: 28, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.190 Vali Acc: 0.774 Test Loss: 1.190 Test Acc: 0.774
Validation loss decreased (-0.744432 --> -0.774062).  Saving model ...
Epoch: 29 cost time: 0.5430653095245361
Epoch: 29, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.165 Vali Acc: 0.774 Test Loss: 1.165 Test Acc: 0.774
Validation loss decreased (-0.774062 --> -0.774062).  Saving model ...
Epoch: 30 cost time: 0.6648950576782227
Epoch: 30, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.141 Vali Acc: 0.785 Test Loss: 1.141 Test Acc: 0.785
Validation loss decreased (-0.774062 --> -0.785174).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7851851851851852
model parameter : 589862
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0568716526031494
Epoch: 1, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.824 Vali Acc: 0.196 Test Loss: 1.824 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.4723639488220215
Epoch: 2, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.805 Vali Acc: 0.207 Test Loss: 1.805 Test Acc: 0.207
Validation loss decreased (-0.196278 --> -0.207389).  Saving model ...
Epoch: 3 cost time: 0.486020565032959
Epoch: 3, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.793 Vali Acc: 0.226 Test Loss: 1.793 Test Acc: 0.226
Validation loss decreased (-0.207389 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.5115783214569092
Epoch: 4, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.784 Vali Acc: 0.230 Test Loss: 1.784 Test Acc: 0.230
Validation loss decreased (-0.225908 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.5524320602416992
Epoch: 5, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.772 Vali Acc: 0.241 Test Loss: 1.772 Test Acc: 0.241
Validation loss decreased (-0.229612 --> -0.240723).  Saving model ...
Epoch: 6 cost time: 0.4991941452026367
Epoch: 6, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.759 Vali Acc: 0.252 Test Loss: 1.759 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251834).  Saving model ...
Epoch: 7 cost time: 0.5177888870239258
Epoch: 7, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.743 Vali Acc: 0.252 Test Loss: 1.743 Test Acc: 0.252
Validation loss decreased (-0.251834 --> -0.251834).  Saving model ...
Epoch: 8 cost time: 0.48853635787963867
Epoch: 8, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.726 Vali Acc: 0.263 Test Loss: 1.726 Test Acc: 0.263
Validation loss decreased (-0.251834 --> -0.262946).  Saving model ...
Epoch: 9 cost time: 0.4661123752593994
Epoch: 9, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.708 Vali Acc: 0.270 Test Loss: 1.708 Test Acc: 0.270
Validation loss decreased (-0.262946 --> -0.270353).  Saving model ...
Epoch: 10 cost time: 0.4890859127044678
Epoch: 10, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.688 Vali Acc: 0.278 Test Loss: 1.688 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277761).  Saving model ...
Epoch: 11 cost time: 0.5000529289245605
Epoch: 11, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.668 Vali Acc: 0.304 Test Loss: 1.668 Test Acc: 0.304
Validation loss decreased (-0.277761 --> -0.303687).  Saving model ...
Epoch: 12 cost time: 0.5144035816192627
Epoch: 12, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.646 Vali Acc: 0.337 Test Loss: 1.646 Test Acc: 0.337
Validation loss decreased (-0.303687 --> -0.337021).  Saving model ...
Epoch: 13 cost time: 0.5096657276153564
Epoch: 13, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.624 Vali Acc: 0.367 Test Loss: 1.624 Test Acc: 0.367
Validation loss decreased (-0.337021 --> -0.366650).  Saving model ...
Epoch: 14 cost time: 0.4638071060180664
Epoch: 14, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.601 Vali Acc: 0.404 Test Loss: 1.601 Test Acc: 0.404
Validation loss decreased (-0.366650 --> -0.403688).  Saving model ...
Epoch: 15 cost time: 0.5274481773376465
Epoch: 15, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.578 Vali Acc: 0.426 Test Loss: 1.578 Test Acc: 0.426
Validation loss decreased (-0.403688 --> -0.425910).  Saving model ...
Epoch: 16 cost time: 0.4824984073638916
Epoch: 16, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.554 Vali Acc: 0.433 Test Loss: 1.554 Test Acc: 0.433
Validation loss decreased (-0.425910 --> -0.433318).  Saving model ...
Epoch: 17 cost time: 0.4861459732055664
Epoch: 17, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.531 Vali Acc: 0.467 Test Loss: 1.531 Test Acc: 0.467
Validation loss decreased (-0.433318 --> -0.466651).  Saving model ...
Epoch: 18 cost time: 0.4844851493835449
Epoch: 18, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.506 Vali Acc: 0.481 Test Loss: 1.506 Test Acc: 0.481
Validation loss decreased (-0.466651 --> -0.481466).  Saving model ...
Epoch: 19 cost time: 0.4829730987548828
Epoch: 19, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.482 Vali Acc: 0.511 Test Loss: 1.482 Test Acc: 0.511
Validation loss decreased (-0.481466 --> -0.511096).  Saving model ...
Epoch: 20 cost time: 0.5012352466583252
Epoch: 20, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.457 Vali Acc: 0.559 Test Loss: 1.457 Test Acc: 0.559
Validation loss decreased (-0.511096 --> -0.559245).  Saving model ...
Epoch: 21 cost time: 0.5146925449371338
Epoch: 21, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.432 Vali Acc: 0.600 Test Loss: 1.432 Test Acc: 0.600
Validation loss decreased (-0.559245 --> -0.599986).  Saving model ...
Epoch: 22 cost time: 0.47118401527404785
Epoch: 22, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.407 Vali Acc: 0.619 Test Loss: 1.407 Test Acc: 0.619
Validation loss decreased (-0.599986 --> -0.618504).  Saving model ...
Epoch: 23 cost time: 0.5233099460601807
Epoch: 23, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.382 Vali Acc: 0.633 Test Loss: 1.382 Test Acc: 0.633
Validation loss decreased (-0.618504 --> -0.633320).  Saving model ...
Epoch: 24 cost time: 0.5001742839813232
Epoch: 24, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.356 Vali Acc: 0.648 Test Loss: 1.356 Test Acc: 0.648
Validation loss decreased (-0.633320 --> -0.648135).  Saving model ...
Epoch: 25 cost time: 0.5310142040252686
Epoch: 25, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.331 Vali Acc: 0.663 Test Loss: 1.331 Test Acc: 0.663
Validation loss decreased (-0.648135 --> -0.662950).  Saving model ...
Epoch: 26 cost time: 0.5624067783355713
Epoch: 26, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.305 Vali Acc: 0.689 Test Loss: 1.305 Test Acc: 0.689
Validation loss decreased (-0.662950 --> -0.688876).  Saving model ...
Epoch: 27 cost time: 0.4929323196411133
Epoch: 27, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.280 Vali Acc: 0.704 Test Loss: 1.280 Test Acc: 0.704
Validation loss decreased (-0.688876 --> -0.703691).  Saving model ...
Epoch: 28 cost time: 0.5040841102600098
Epoch: 28, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.254 Vali Acc: 0.711 Test Loss: 1.254 Test Acc: 0.711
Validation loss decreased (-0.703691 --> -0.711099).  Saving model ...
Epoch: 29 cost time: 0.5781364440917969
Epoch: 29, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.229 Vali Acc: 0.726 Test Loss: 1.229 Test Acc: 0.726
Validation loss decreased (-0.711099 --> -0.725914).  Saving model ...
Epoch: 30 cost time: 0.4792056083679199
Epoch: 30, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.203 Vali Acc: 0.741 Test Loss: 1.203 Test Acc: 0.741
Validation loss decreased (-0.725914 --> -0.740729).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7407407407407407
model parameter : 175878
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0745811462402344
Epoch: 1, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.729 Vali Acc: 0.170 Test Loss: 1.729 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.48883819580078125
Epoch: 2, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.709 Vali Acc: 0.181 Test Loss: 1.709 Test Acc: 0.181
Validation loss decreased (-0.170353 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.5356142520904541
Epoch: 3, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.696 Vali Acc: 0.181 Test Loss: 1.696 Test Acc: 0.181
Validation loss decreased (-0.181464 --> -0.181465).  Saving model ...
Epoch: 4 cost time: 0.47491002082824707
Epoch: 4, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.688 Vali Acc: 0.185 Test Loss: 1.688 Test Acc: 0.185
Validation loss decreased (-0.181465 --> -0.185168).  Saving model ...
Epoch: 5 cost time: 0.4636988639831543
Epoch: 5, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.677 Vali Acc: 0.193 Test Loss: 1.677 Test Acc: 0.193
Validation loss decreased (-0.185168 --> -0.192576).  Saving model ...
Epoch: 6 cost time: 0.5397090911865234
Epoch: 6, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.665 Vali Acc: 0.219 Test Loss: 1.665 Test Acc: 0.219
Validation loss decreased (-0.192576 --> -0.218502).  Saving model ...
Epoch: 7 cost time: 0.5479395389556885
Epoch: 7, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.651 Vali Acc: 0.222 Test Loss: 1.651 Test Acc: 0.222
Validation loss decreased (-0.218502 --> -0.222206).  Saving model ...
Epoch: 8 cost time: 0.4499495029449463
Epoch: 8, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.635 Vali Acc: 0.237 Test Loss: 1.635 Test Acc: 0.237
Validation loss decreased (-0.222206 --> -0.237021).  Saving model ...
Epoch: 9 cost time: 0.4791998863220215
Epoch: 9, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.618 Vali Acc: 0.259 Test Loss: 1.618 Test Acc: 0.259
Validation loss decreased (-0.237021 --> -0.259243).  Saving model ...
Epoch: 10 cost time: 0.46090245246887207
Epoch: 10, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.600 Vali Acc: 0.296 Test Loss: 1.600 Test Acc: 0.296
Validation loss decreased (-0.259243 --> -0.296280).  Saving model ...
Epoch: 11 cost time: 0.4823265075683594
Epoch: 11, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.581 Vali Acc: 0.322 Test Loss: 1.581 Test Acc: 0.322
Validation loss decreased (-0.296280 --> -0.322206).  Saving model ...
Epoch: 12 cost time: 0.4883391857147217
Epoch: 12, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.561 Vali Acc: 0.348 Test Loss: 1.561 Test Acc: 0.348
Validation loss decreased (-0.322206 --> -0.348133).  Saving model ...
Epoch: 13 cost time: 0.4851417541503906
Epoch: 13, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.541 Vali Acc: 0.404 Test Loss: 1.541 Test Acc: 0.404
Validation loss decreased (-0.348133 --> -0.403688).  Saving model ...
Epoch: 14 cost time: 0.4699223041534424
Epoch: 14, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.520 Vali Acc: 0.470 Test Loss: 1.520 Test Acc: 0.470
Validation loss decreased (-0.403688 --> -0.470355).  Saving model ...
Epoch: 15 cost time: 0.4604027271270752
Epoch: 15, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.498 Vali Acc: 0.526 Test Loss: 1.498 Test Acc: 0.526
Validation loss decreased (-0.470355 --> -0.525911).  Saving model ...
Epoch: 16 cost time: 0.49445581436157227
Epoch: 16, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.476 Vali Acc: 0.570 Test Loss: 1.476 Test Acc: 0.570
Validation loss decreased (-0.525911 --> -0.570356).  Saving model ...
Epoch: 17 cost time: 0.46152520179748535
Epoch: 17, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.453 Vali Acc: 0.596 Test Loss: 1.453 Test Acc: 0.596
Validation loss decreased (-0.570356 --> -0.596282).  Saving model ...
Epoch: 18 cost time: 0.46598196029663086
Epoch: 18, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.430 Vali Acc: 0.619 Test Loss: 1.430 Test Acc: 0.619
Validation loss decreased (-0.596282 --> -0.618504).  Saving model ...
Epoch: 19 cost time: 0.46952223777770996
Epoch: 19, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.407 Vali Acc: 0.641 Test Loss: 1.407 Test Acc: 0.641
Validation loss decreased (-0.618504 --> -0.640727).  Saving model ...
Epoch: 20 cost time: 0.48412418365478516
Epoch: 20, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.384 Vali Acc: 0.674 Test Loss: 1.384 Test Acc: 0.674
Validation loss decreased (-0.640727 --> -0.674060).  Saving model ...
Epoch: 21 cost time: 0.47026753425598145
Epoch: 21, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.361 Vali Acc: 0.678 Test Loss: 1.361 Test Acc: 0.678
Validation loss decreased (-0.674060 --> -0.677764).  Saving model ...
Epoch: 22 cost time: 0.46094489097595215
Epoch: 22, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.338 Vali Acc: 0.689 Test Loss: 1.338 Test Acc: 0.689
Validation loss decreased (-0.677764 --> -0.688876).  Saving model ...
Epoch: 23 cost time: 0.5239520072937012
Epoch: 23, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.315 Vali Acc: 0.707 Test Loss: 1.315 Test Acc: 0.707
Validation loss decreased (-0.688876 --> -0.707394).  Saving model ...
Epoch: 24 cost time: 0.5533401966094971
Epoch: 24, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.291 Vali Acc: 0.715 Test Loss: 1.291 Test Acc: 0.715
Validation loss decreased (-0.707394 --> -0.714802).  Saving model ...
Epoch: 25 cost time: 0.5145347118377686
Epoch: 25, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.268 Vali Acc: 0.722 Test Loss: 1.268 Test Acc: 0.722
Validation loss decreased (-0.714802 --> -0.722210).  Saving model ...
Epoch: 26 cost time: 0.5237033367156982
Epoch: 26, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.244 Vali Acc: 0.733 Test Loss: 1.244 Test Acc: 0.733
Validation loss decreased (-0.722210 --> -0.733321).  Saving model ...
Epoch: 27 cost time: 0.5432474613189697
Epoch: 27, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.219 Vali Acc: 0.748 Test Loss: 1.219 Test Acc: 0.748
Validation loss decreased (-0.733321 --> -0.748136).  Saving model ...
Epoch: 28 cost time: 0.5193734169006348
Epoch: 28, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.195 Vali Acc: 0.767 Test Loss: 1.195 Test Acc: 0.767
Validation loss decreased (-0.748136 --> -0.766655).  Saving model ...
Epoch: 29 cost time: 0.523613452911377
Epoch: 29, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.171 Vali Acc: 0.778 Test Loss: 1.171 Test Acc: 0.778
Validation loss decreased (-0.766655 --> -0.777766).  Saving model ...
Epoch: 30 cost time: 0.523043155670166
Epoch: 30, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.147 Vali Acc: 0.785 Test Loss: 1.147 Test Acc: 0.785
Validation loss decreased (-0.777766 --> -0.785174).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7851851851851852
model parameter : 589862
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8731606006622314
Epoch: 1, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.825 Vali Acc: 0.193 Test Loss: 1.825 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 0.48436641693115234
Epoch: 2, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.806 Vali Acc: 0.207 Test Loss: 1.806 Test Acc: 0.207
Validation loss decreased (-0.192574 --> -0.207389).  Saving model ...
Epoch: 3 cost time: 0.4570808410644531
Epoch: 3, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.793 Vali Acc: 0.222 Test Loss: 1.793 Test Acc: 0.222
Validation loss decreased (-0.207389 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 0.47272396087646484
Epoch: 4, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.784 Vali Acc: 0.230 Test Loss: 1.784 Test Acc: 0.230
Validation loss decreased (-0.222204 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.4556562900543213
Epoch: 5, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.773 Vali Acc: 0.241 Test Loss: 1.773 Test Acc: 0.241
Validation loss decreased (-0.229612 --> -0.240723).  Saving model ...
Epoch: 6 cost time: 0.520188570022583
Epoch: 6, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.760 Vali Acc: 0.252 Test Loss: 1.760 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251834).  Saving model ...
Epoch: 7 cost time: 0.4915618896484375
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.744 Vali Acc: 0.252 Test Loss: 1.744 Test Acc: 0.252
Validation loss decreased (-0.251834 --> -0.251834).  Saving model ...
Epoch: 8 cost time: 0.554828405380249
Epoch: 8, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.727 Vali Acc: 0.263 Test Loss: 1.727 Test Acc: 0.263
Validation loss decreased (-0.251834 --> -0.262946).  Saving model ...
Epoch: 9 cost time: 0.5196876525878906
Epoch: 9, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.709 Vali Acc: 0.270 Test Loss: 1.709 Test Acc: 0.270
Validation loss decreased (-0.262946 --> -0.270353).  Saving model ...
Epoch: 10 cost time: 0.5679938793182373
Epoch: 10, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.690 Vali Acc: 0.278 Test Loss: 1.690 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277761).  Saving model ...
Epoch: 11 cost time: 0.5377569198608398
Epoch: 11, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.669 Vali Acc: 0.304 Test Loss: 1.669 Test Acc: 0.304
Validation loss decreased (-0.277761 --> -0.303687).  Saving model ...
Epoch: 12 cost time: 0.49754929542541504
Epoch: 12, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.648 Vali Acc: 0.337 Test Loss: 1.648 Test Acc: 0.337
Validation loss decreased (-0.303687 --> -0.337021).  Saving model ...
Epoch: 13 cost time: 0.46752071380615234
Epoch: 13, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.626 Vali Acc: 0.367 Test Loss: 1.626 Test Acc: 0.367
Validation loss decreased (-0.337021 --> -0.366650).  Saving model ...
Epoch: 14 cost time: 0.5298097133636475
Epoch: 14, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.603 Vali Acc: 0.404 Test Loss: 1.603 Test Acc: 0.404
Validation loss decreased (-0.366650 --> -0.403688).  Saving model ...
Epoch: 15 cost time: 0.5028538703918457
Epoch: 15, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.580 Vali Acc: 0.426 Test Loss: 1.580 Test Acc: 0.426
Validation loss decreased (-0.403688 --> -0.425910).  Saving model ...
Epoch: 16 cost time: 0.5153729915618896
Epoch: 16, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.557 Vali Acc: 0.433 Test Loss: 1.557 Test Acc: 0.433
Validation loss decreased (-0.425910 --> -0.433318).  Saving model ...
Epoch: 17 cost time: 0.4866509437561035
Epoch: 17, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.533 Vali Acc: 0.467 Test Loss: 1.533 Test Acc: 0.467
Validation loss decreased (-0.433318 --> -0.466651).  Saving model ...
Epoch: 18 cost time: 0.5421469211578369
Epoch: 18, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.509 Vali Acc: 0.485 Test Loss: 1.509 Test Acc: 0.485
Validation loss decreased (-0.466651 --> -0.485170).  Saving model ...
Epoch: 19 cost time: 0.488905668258667
Epoch: 19, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.485 Vali Acc: 0.507 Test Loss: 1.485 Test Acc: 0.507
Validation loss decreased (-0.485170 --> -0.507393).  Saving model ...
Epoch: 20 cost time: 0.5011157989501953
Epoch: 20, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.461 Vali Acc: 0.556 Test Loss: 1.461 Test Acc: 0.556
Validation loss decreased (-0.507393 --> -0.555541).  Saving model ...
Epoch: 21 cost time: 0.4744131565093994
Epoch: 21, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.436 Vali Acc: 0.593 Test Loss: 1.436 Test Acc: 0.593
Validation loss decreased (-0.555541 --> -0.592578).  Saving model ...
Epoch: 22 cost time: 0.4651505947113037
Epoch: 22, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.411 Vali Acc: 0.611 Test Loss: 1.411 Test Acc: 0.611
Validation loss decreased (-0.592578 --> -0.611097).  Saving model ...
Epoch: 23 cost time: 0.4969029426574707
Epoch: 23, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.386 Vali Acc: 0.630 Test Loss: 1.386 Test Acc: 0.630
Validation loss decreased (-0.611097 --> -0.629616).  Saving model ...
Epoch: 24 cost time: 0.5583446025848389
Epoch: 24, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.360 Vali Acc: 0.641 Test Loss: 1.360 Test Acc: 0.641
Validation loss decreased (-0.629616 --> -0.640727).  Saving model ...
Epoch: 25 cost time: 0.5117363929748535
Epoch: 25, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.335 Vali Acc: 0.659 Test Loss: 1.335 Test Acc: 0.659
Validation loss decreased (-0.640727 --> -0.659246).  Saving model ...
Epoch: 26 cost time: 0.5486228466033936
Epoch: 26, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.310 Vali Acc: 0.681 Test Loss: 1.310 Test Acc: 0.681
Validation loss decreased (-0.659246 --> -0.681468).  Saving model ...
Epoch: 27 cost time: 0.475919246673584
Epoch: 27, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.284 Vali Acc: 0.696 Test Loss: 1.284 Test Acc: 0.696
Validation loss decreased (-0.681468 --> -0.696283).  Saving model ...
Epoch: 28 cost time: 0.4844670295715332
Epoch: 28, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.259 Vali Acc: 0.700 Test Loss: 1.259 Test Acc: 0.700
Validation loss decreased (-0.696283 --> -0.699987).  Saving model ...
Epoch: 29 cost time: 0.5147624015808105
Epoch: 29, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.233 Vali Acc: 0.711 Test Loss: 1.233 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711099).  Saving model ...
Epoch: 30 cost time: 0.5134580135345459
Epoch: 30, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.208 Vali Acc: 0.730 Test Loss: 1.208 Test Acc: 0.730
Validation loss decreased (-0.711099 --> -0.729618).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7296296296296296
model parameter : 175878
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2262210845947266
Epoch: 1, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.781 Vali Acc: 0.215 Test Loss: 1.781 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.5951790809631348
Epoch: 2, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.761 Vali Acc: 0.219 Test Loss: 1.761 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218501).  Saving model ...
Epoch: 3 cost time: 0.6009669303894043
Epoch: 3, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.748 Vali Acc: 0.226 Test Loss: 1.748 Test Acc: 0.226
Validation loss decreased (-0.218501 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.6718933582305908
Epoch: 4, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.740 Vali Acc: 0.230 Test Loss: 1.740 Test Acc: 0.230
Validation loss decreased (-0.225908 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.6223957538604736
Epoch: 5, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.730 Vali Acc: 0.241 Test Loss: 1.730 Test Acc: 0.241
Validation loss decreased (-0.229612 --> -0.240723).  Saving model ...
Epoch: 6 cost time: 0.5627603530883789
Epoch: 6, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.718 Vali Acc: 0.252 Test Loss: 1.718 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251835).  Saving model ...
Epoch: 7 cost time: 0.565516471862793
Epoch: 7, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.704 Vali Acc: 0.263 Test Loss: 1.704 Test Acc: 0.263
Validation loss decreased (-0.251835 --> -0.262946).  Saving model ...
Epoch: 8 cost time: 0.6117007732391357
Epoch: 8, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.689 Vali Acc: 0.281 Test Loss: 1.689 Test Acc: 0.281
Validation loss decreased (-0.262946 --> -0.281465).  Saving model ...
Epoch: 9 cost time: 0.5928244590759277
Epoch: 9, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.673 Vali Acc: 0.311 Test Loss: 1.673 Test Acc: 0.311
Validation loss decreased (-0.281465 --> -0.311094).  Saving model ...
Epoch: 10 cost time: 0.5432798862457275
Epoch: 10, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.655 Vali Acc: 0.344 Test Loss: 1.655 Test Acc: 0.344
Validation loss decreased (-0.311094 --> -0.344428).  Saving model ...
Epoch: 11 cost time: 0.6190681457519531
Epoch: 11, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.637 Vali Acc: 0.352 Test Loss: 1.637 Test Acc: 0.352
Validation loss decreased (-0.344428 --> -0.351835).  Saving model ...
Epoch: 12 cost time: 0.5706677436828613
Epoch: 12, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.618 Vali Acc: 0.378 Test Loss: 1.618 Test Acc: 0.378
Validation loss decreased (-0.351835 --> -0.377762).  Saving model ...
Epoch: 13 cost time: 0.5984468460083008
Epoch: 13, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.598 Vali Acc: 0.404 Test Loss: 1.598 Test Acc: 0.404
Validation loss decreased (-0.377762 --> -0.403688).  Saving model ...
Epoch: 14 cost time: 0.6098463535308838
Epoch: 14, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.577 Vali Acc: 0.415 Test Loss: 1.577 Test Acc: 0.415
Validation loss decreased (-0.403688 --> -0.414799).  Saving model ...
Epoch: 15 cost time: 0.5574924945831299
Epoch: 15, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.556 Vali Acc: 0.441 Test Loss: 1.556 Test Acc: 0.441
Validation loss decreased (-0.414799 --> -0.440725).  Saving model ...
Epoch: 16 cost time: 0.6123347282409668
Epoch: 16, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.535 Vali Acc: 0.470 Test Loss: 1.535 Test Acc: 0.470
Validation loss decreased (-0.440725 --> -0.470355).  Saving model ...
Epoch: 17 cost time: 0.5487892627716064
Epoch: 17, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.513 Vali Acc: 0.493 Test Loss: 1.513 Test Acc: 0.493
Validation loss decreased (-0.470355 --> -0.492577).  Saving model ...
Epoch: 18 cost time: 0.6153864860534668
Epoch: 18, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.490 Vali Acc: 0.504 Test Loss: 1.490 Test Acc: 0.504
Validation loss decreased (-0.492577 --> -0.503689).  Saving model ...
Epoch: 19 cost time: 0.5992059707641602
Epoch: 19, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.467 Vali Acc: 0.533 Test Loss: 1.467 Test Acc: 0.533
Validation loss decreased (-0.503689 --> -0.533319).  Saving model ...
Epoch: 20 cost time: 0.6104001998901367
Epoch: 20, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.444 Vali Acc: 0.548 Test Loss: 1.444 Test Acc: 0.548
Validation loss decreased (-0.533319 --> -0.548134).  Saving model ...
Epoch: 21 cost time: 0.5722129344940186
Epoch: 21, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.421 Vali Acc: 0.578 Test Loss: 1.421 Test Acc: 0.578
Validation loss decreased (-0.548134 --> -0.577764).  Saving model ...
Epoch: 22 cost time: 0.5946922302246094
Epoch: 22, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.398 Vali Acc: 0.600 Test Loss: 1.398 Test Acc: 0.600
Validation loss decreased (-0.577764 --> -0.599986).  Saving model ...
Epoch: 23 cost time: 0.6096043586730957
Epoch: 23, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.374 Vali Acc: 0.607 Test Loss: 1.374 Test Acc: 0.607
Validation loss decreased (-0.599986 --> -0.607394).  Saving model ...
Epoch: 24 cost time: 0.6038134098052979
Epoch: 24, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.351 Vali Acc: 0.630 Test Loss: 1.351 Test Acc: 0.630
Validation loss decreased (-0.607394 --> -0.629616).  Saving model ...
Epoch: 25 cost time: 0.561011791229248
Epoch: 25, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.328 Vali Acc: 0.641 Test Loss: 1.328 Test Acc: 0.641
Validation loss decreased (-0.629616 --> -0.640727).  Saving model ...
Epoch: 26 cost time: 0.6149523258209229
Epoch: 26, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.306 Vali Acc: 0.663 Test Loss: 1.306 Test Acc: 0.663
Validation loss decreased (-0.640727 --> -0.662950).  Saving model ...
Epoch: 27 cost time: 0.5908634662628174
Epoch: 27, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.284 Vali Acc: 0.678 Test Loss: 1.284 Test Acc: 0.678
Validation loss decreased (-0.662950 --> -0.677765).  Saving model ...
Epoch: 28 cost time: 0.6394045352935791
Epoch: 28, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.262 Vali Acc: 0.700 Test Loss: 1.262 Test Acc: 0.700
Validation loss decreased (-0.677765 --> -0.699987).  Saving model ...
Epoch: 29 cost time: 0.6078271865844727
Epoch: 29, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.240 Vali Acc: 0.711 Test Loss: 1.240 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711099).  Saving model ...
Epoch: 30 cost time: 0.6304712295532227
Epoch: 30, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.218 Vali Acc: 0.730 Test Loss: 1.218 Test Acc: 0.730
Validation loss decreased (-0.711099 --> -0.729617).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7296296296296296
model parameter : 296614
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3005921840667725
Epoch: 1, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.845 Vali Acc: 0.163 Test Loss: 1.845 Test Acc: 0.163
Validation loss decreased (inf --> -0.162945).  Saving model ...
Epoch: 2 cost time: 0.5744202136993408
Epoch: 2, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.825 Vali Acc: 0.167 Test Loss: 1.825 Test Acc: 0.167
Validation loss decreased (-0.162945 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.5458452701568604
Epoch: 3, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.814 Vali Acc: 0.178 Test Loss: 1.814 Test Acc: 0.178
Validation loss decreased (-0.166648 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 0.557560920715332
Epoch: 4, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.806 Vali Acc: 0.185 Test Loss: 1.806 Test Acc: 0.185
Validation loss decreased (-0.177760 --> -0.185167).  Saving model ...
Epoch: 5 cost time: 0.5627994537353516
Epoch: 5, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.796 Vali Acc: 0.204 Test Loss: 1.796 Test Acc: 0.204
Validation loss decreased (-0.185167 --> -0.203686).  Saving model ...
Epoch: 6 cost time: 0.5965712070465088
Epoch: 6, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.784 Vali Acc: 0.219 Test Loss: 1.784 Test Acc: 0.219
Validation loss decreased (-0.203686 --> -0.218501).  Saving model ...
Epoch: 7 cost time: 0.5865373611450195
Epoch: 7, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.770 Vali Acc: 0.222 Test Loss: 1.770 Test Acc: 0.222
Validation loss decreased (-0.218501 --> -0.222205).  Saving model ...
Epoch: 8 cost time: 0.561924934387207
Epoch: 8, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.755 Vali Acc: 0.226 Test Loss: 1.755 Test Acc: 0.226
Validation loss decreased (-0.222205 --> -0.225908).  Saving model ...
Epoch: 9 cost time: 0.574692964553833
Epoch: 9, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.739 Vali Acc: 0.237 Test Loss: 1.739 Test Acc: 0.237
Validation loss decreased (-0.225908 --> -0.237020).  Saving model ...
Epoch: 10 cost time: 0.6114377975463867
Epoch: 10, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.722 Vali Acc: 0.256 Test Loss: 1.722 Test Acc: 0.256
Validation loss decreased (-0.237020 --> -0.255538).  Saving model ...
Epoch: 11 cost time: 0.5168569087982178
Epoch: 11, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.703 Vali Acc: 0.259 Test Loss: 1.703 Test Acc: 0.259
Validation loss decreased (-0.255538 --> -0.259242).  Saving model ...
Epoch: 12 cost time: 0.5317442417144775
Epoch: 12, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.684 Vali Acc: 0.278 Test Loss: 1.684 Test Acc: 0.278
Validation loss decreased (-0.259242 --> -0.277761).  Saving model ...
Epoch: 13 cost time: 0.5737900733947754
Epoch: 13, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.663 Vali Acc: 0.293 Test Loss: 1.663 Test Acc: 0.293
Validation loss decreased (-0.277761 --> -0.292576).  Saving model ...
Epoch: 14 cost time: 0.5455808639526367
Epoch: 14, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.642 Vali Acc: 0.333 Test Loss: 1.642 Test Acc: 0.333
Validation loss decreased (-0.292576 --> -0.333317).  Saving model ...
Epoch: 15 cost time: 0.5445594787597656
Epoch: 15, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.619 Vali Acc: 0.378 Test Loss: 1.619 Test Acc: 0.378
Validation loss decreased (-0.333317 --> -0.377762).  Saving model ...
Epoch: 16 cost time: 0.5484287738800049
Epoch: 16, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.596 Vali Acc: 0.441 Test Loss: 1.596 Test Acc: 0.441
Validation loss decreased (-0.377762 --> -0.440725).  Saving model ...
Epoch: 17 cost time: 0.5481865406036377
Epoch: 17, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.573 Vali Acc: 0.493 Test Loss: 1.573 Test Acc: 0.493
Validation loss decreased (-0.440725 --> -0.492577).  Saving model ...
Epoch: 18 cost time: 0.5281710624694824
Epoch: 18, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.549 Vali Acc: 0.515 Test Loss: 1.549 Test Acc: 0.515
Validation loss decreased (-0.492577 --> -0.514799).  Saving model ...
Epoch: 19 cost time: 0.5660548210144043
Epoch: 19, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.524 Vali Acc: 0.548 Test Loss: 1.524 Test Acc: 0.548
Validation loss decreased (-0.514799 --> -0.548133).  Saving model ...
Epoch: 20 cost time: 0.5686788558959961
Epoch: 20, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.499 Vali Acc: 0.570 Test Loss: 1.499 Test Acc: 0.570
Validation loss decreased (-0.548133 --> -0.570355).  Saving model ...
Epoch: 21 cost time: 0.5753068923950195
Epoch: 21, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.474 Vali Acc: 0.596 Test Loss: 1.474 Test Acc: 0.596
Validation loss decreased (-0.570355 --> -0.596282).  Saving model ...
Epoch: 22 cost time: 0.5626261234283447
Epoch: 22, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.449 Vali Acc: 0.622 Test Loss: 1.449 Test Acc: 0.622
Validation loss decreased (-0.596282 --> -0.622208).  Saving model ...
Epoch: 23 cost time: 0.5759057998657227
Epoch: 23, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.424 Vali Acc: 0.633 Test Loss: 1.424 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633319).  Saving model ...
Epoch: 24 cost time: 0.5705423355102539
Epoch: 24, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.398 Vali Acc: 0.656 Test Loss: 1.398 Test Acc: 0.656
Validation loss decreased (-0.633319 --> -0.655542).  Saving model ...
Epoch: 25 cost time: 0.5439443588256836
Epoch: 25, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.373 Vali Acc: 0.663 Test Loss: 1.373 Test Acc: 0.663
Validation loss decreased (-0.655542 --> -0.662949).  Saving model ...
Epoch: 26 cost time: 0.5352659225463867
Epoch: 26, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.347 Vali Acc: 0.681 Test Loss: 1.347 Test Acc: 0.681
Validation loss decreased (-0.662949 --> -0.681468).  Saving model ...
Epoch: 27 cost time: 0.5853447914123535
Epoch: 27, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.321 Vali Acc: 0.696 Test Loss: 1.321 Test Acc: 0.696
Validation loss decreased (-0.681468 --> -0.696283).  Saving model ...
Epoch: 28 cost time: 0.6703510284423828
Epoch: 28, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.296 Vali Acc: 0.711 Test Loss: 1.296 Test Acc: 0.711
Validation loss decreased (-0.696283 --> -0.711098).  Saving model ...
Epoch: 29 cost time: 0.5423445701599121
Epoch: 29, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.270 Vali Acc: 0.719 Test Loss: 1.270 Test Acc: 0.719
Validation loss decreased (-0.711098 --> -0.718506).  Saving model ...
Epoch: 30 cost time: 0.5804657936096191
Epoch: 30, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.245 Vali Acc: 0.730 Test Loss: 1.245 Test Acc: 0.730
Validation loss decreased (-0.718506 --> -0.729617).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7296296296296296
model parameter : 89606
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2171850204467773
Epoch: 1, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.781 Vali Acc: 0.215 Test Loss: 1.781 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.6119263172149658
Epoch: 2, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.761 Vali Acc: 0.219 Test Loss: 1.761 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218501).  Saving model ...
Epoch: 3 cost time: 0.6087336540222168
Epoch: 3, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.748 Vali Acc: 0.226 Test Loss: 1.748 Test Acc: 0.226
Validation loss decreased (-0.218501 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.6269357204437256
Epoch: 4, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.740 Vali Acc: 0.230 Test Loss: 1.740 Test Acc: 0.230
Validation loss decreased (-0.225908 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.5957291126251221
Epoch: 5, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.730 Vali Acc: 0.241 Test Loss: 1.730 Test Acc: 0.241
Validation loss decreased (-0.229612 --> -0.240723).  Saving model ...
Epoch: 6 cost time: 0.5914945602416992
Epoch: 6, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.718 Vali Acc: 0.252 Test Loss: 1.718 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251835).  Saving model ...
Epoch: 7 cost time: 0.5689918994903564
Epoch: 7, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.704 Vali Acc: 0.263 Test Loss: 1.704 Test Acc: 0.263
Validation loss decreased (-0.251835 --> -0.262946).  Saving model ...
Epoch: 8 cost time: 0.5891191959381104
Epoch: 8, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.689 Vali Acc: 0.281 Test Loss: 1.689 Test Acc: 0.281
Validation loss decreased (-0.262946 --> -0.281465).  Saving model ...
Epoch: 9 cost time: 0.5536563396453857
Epoch: 9, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.673 Vali Acc: 0.311 Test Loss: 1.673 Test Acc: 0.311
Validation loss decreased (-0.281465 --> -0.311094).  Saving model ...
Epoch: 10 cost time: 0.5784742832183838
Epoch: 10, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.655 Vali Acc: 0.344 Test Loss: 1.655 Test Acc: 0.344
Validation loss decreased (-0.311094 --> -0.344428).  Saving model ...
Epoch: 11 cost time: 0.582280158996582
Epoch: 11, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.637 Vali Acc: 0.352 Test Loss: 1.637 Test Acc: 0.352
Validation loss decreased (-0.344428 --> -0.351835).  Saving model ...
Epoch: 12 cost time: 0.5552480220794678
Epoch: 12, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.618 Vali Acc: 0.378 Test Loss: 1.618 Test Acc: 0.378
Validation loss decreased (-0.351835 --> -0.377762).  Saving model ...
Epoch: 13 cost time: 0.6130449771881104
Epoch: 13, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.598 Vali Acc: 0.404 Test Loss: 1.598 Test Acc: 0.404
Validation loss decreased (-0.377762 --> -0.403688).  Saving model ...
Epoch: 14 cost time: 0.6139633655548096
Epoch: 14, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.577 Vali Acc: 0.415 Test Loss: 1.577 Test Acc: 0.415
Validation loss decreased (-0.403688 --> -0.414799).  Saving model ...
Epoch: 15 cost time: 0.607602596282959
Epoch: 15, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.556 Vali Acc: 0.441 Test Loss: 1.556 Test Acc: 0.441
Validation loss decreased (-0.414799 --> -0.440725).  Saving model ...
Epoch: 16 cost time: 0.6442596912384033
Epoch: 16, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.535 Vali Acc: 0.470 Test Loss: 1.535 Test Acc: 0.470
Validation loss decreased (-0.440725 --> -0.470355).  Saving model ...
Epoch: 17 cost time: 0.6559281349182129
Epoch: 17, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.512 Vali Acc: 0.493 Test Loss: 1.512 Test Acc: 0.493
Validation loss decreased (-0.470355 --> -0.492577).  Saving model ...
Epoch: 18 cost time: 0.6470699310302734
Epoch: 18, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.490 Vali Acc: 0.504 Test Loss: 1.490 Test Acc: 0.504
Validation loss decreased (-0.492577 --> -0.503689).  Saving model ...
Epoch: 19 cost time: 0.6455338001251221
Epoch: 19, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.467 Vali Acc: 0.533 Test Loss: 1.467 Test Acc: 0.533
Validation loss decreased (-0.503689 --> -0.533319).  Saving model ...
Epoch: 20 cost time: 0.6340367794036865
Epoch: 20, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.444 Vali Acc: 0.548 Test Loss: 1.444 Test Acc: 0.548
Validation loss decreased (-0.533319 --> -0.548134).  Saving model ...
Epoch: 21 cost time: 0.5812942981719971
Epoch: 21, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.421 Vali Acc: 0.578 Test Loss: 1.421 Test Acc: 0.578
Validation loss decreased (-0.548134 --> -0.577764).  Saving model ...
Epoch: 22 cost time: 0.5830545425415039
Epoch: 22, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.397 Vali Acc: 0.600 Test Loss: 1.397 Test Acc: 0.600
Validation loss decreased (-0.577764 --> -0.599986).  Saving model ...
Epoch: 23 cost time: 0.6347618103027344
Epoch: 23, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.374 Vali Acc: 0.607 Test Loss: 1.374 Test Acc: 0.607
Validation loss decreased (-0.599986 --> -0.607394).  Saving model ...
Epoch: 24 cost time: 0.5620636940002441
Epoch: 24, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.351 Vali Acc: 0.630 Test Loss: 1.351 Test Acc: 0.630
Validation loss decreased (-0.607394 --> -0.629616).  Saving model ...
Epoch: 25 cost time: 0.6443884372711182
Epoch: 25, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.328 Vali Acc: 0.641 Test Loss: 1.328 Test Acc: 0.641
Validation loss decreased (-0.629616 --> -0.640727).  Saving model ...
Epoch: 26 cost time: 0.6010100841522217
Epoch: 26, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.306 Vali Acc: 0.659 Test Loss: 1.306 Test Acc: 0.659
Validation loss decreased (-0.640727 --> -0.659246).  Saving model ...
Epoch: 27 cost time: 0.5832362174987793
Epoch: 27, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.283 Vali Acc: 0.678 Test Loss: 1.283 Test Acc: 0.678
Validation loss decreased (-0.659246 --> -0.677765).  Saving model ...
Epoch: 28 cost time: 0.5722196102142334
Epoch: 28, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.261 Vali Acc: 0.700 Test Loss: 1.261 Test Acc: 0.700
Validation loss decreased (-0.677765 --> -0.699987).  Saving model ...
Epoch: 29 cost time: 0.5656075477600098
Epoch: 29, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.240 Vali Acc: 0.711 Test Loss: 1.240 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711099).  Saving model ...
Epoch: 30 cost time: 0.5504717826843262
Epoch: 30, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.218 Vali Acc: 0.730 Test Loss: 1.218 Test Acc: 0.730
Validation loss decreased (-0.711099 --> -0.729617).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7296296296296296
model parameter : 296614
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2138845920562744
Epoch: 1, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.845 Vali Acc: 0.163 Test Loss: 1.845 Test Acc: 0.163
Validation loss decreased (inf --> -0.162945).  Saving model ...
Epoch: 2 cost time: 0.4791090488433838
Epoch: 2, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.826 Vali Acc: 0.167 Test Loss: 1.826 Test Acc: 0.167
Validation loss decreased (-0.162945 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.5129485130310059
Epoch: 3, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.814 Vali Acc: 0.178 Test Loss: 1.814 Test Acc: 0.178
Validation loss decreased (-0.166648 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 0.49648284912109375
Epoch: 4, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.806 Vali Acc: 0.185 Test Loss: 1.806 Test Acc: 0.185
Validation loss decreased (-0.177760 --> -0.185167).  Saving model ...
Epoch: 5 cost time: 0.5134339332580566
Epoch: 5, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.796 Vali Acc: 0.204 Test Loss: 1.796 Test Acc: 0.204
Validation loss decreased (-0.185167 --> -0.203686).  Saving model ...
Epoch: 6 cost time: 0.49822998046875
Epoch: 6, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.784 Vali Acc: 0.219 Test Loss: 1.784 Test Acc: 0.219
Validation loss decreased (-0.203686 --> -0.218501).  Saving model ...
Epoch: 7 cost time: 0.5092709064483643
Epoch: 7, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.771 Vali Acc: 0.222 Test Loss: 1.771 Test Acc: 0.222
Validation loss decreased (-0.218501 --> -0.222205).  Saving model ...
Epoch: 8 cost time: 0.5306754112243652
Epoch: 8, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.756 Vali Acc: 0.226 Test Loss: 1.756 Test Acc: 0.226
Validation loss decreased (-0.222205 --> -0.225908).  Saving model ...
Epoch: 9 cost time: 0.4929966926574707
Epoch: 9, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.739 Vali Acc: 0.237 Test Loss: 1.739 Test Acc: 0.237
Validation loss decreased (-0.225908 --> -0.237020).  Saving model ...
Epoch: 10 cost time: 0.5029029846191406
Epoch: 10, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.722 Vali Acc: 0.256 Test Loss: 1.722 Test Acc: 0.256
Validation loss decreased (-0.237020 --> -0.255538).  Saving model ...
Epoch: 11 cost time: 0.5128037929534912
Epoch: 11, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.703 Vali Acc: 0.259 Test Loss: 1.703 Test Acc: 0.259
Validation loss decreased (-0.255538 --> -0.259242).  Saving model ...
Epoch: 12 cost time: 0.5239934921264648
Epoch: 12, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.684 Vali Acc: 0.278 Test Loss: 1.684 Test Acc: 0.278
Validation loss decreased (-0.259242 --> -0.277761).  Saving model ...
Epoch: 13 cost time: 0.4998161792755127
Epoch: 13, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.663 Vali Acc: 0.293 Test Loss: 1.663 Test Acc: 0.293
Validation loss decreased (-0.277761 --> -0.292576).  Saving model ...
Epoch: 14 cost time: 0.5164589881896973
Epoch: 14, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.642 Vali Acc: 0.333 Test Loss: 1.642 Test Acc: 0.333
Validation loss decreased (-0.292576 --> -0.333317).  Saving model ...
Epoch: 15 cost time: 0.5073163509368896
Epoch: 15, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.620 Vali Acc: 0.378 Test Loss: 1.620 Test Acc: 0.378
Validation loss decreased (-0.333317 --> -0.377762).  Saving model ...
Epoch: 16 cost time: 0.4723680019378662
Epoch: 16, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.597 Vali Acc: 0.441 Test Loss: 1.597 Test Acc: 0.441
Validation loss decreased (-0.377762 --> -0.440725).  Saving model ...
Epoch: 17 cost time: 0.4871072769165039
Epoch: 17, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.573 Vali Acc: 0.493 Test Loss: 1.573 Test Acc: 0.493
Validation loss decreased (-0.440725 --> -0.492577).  Saving model ...
Epoch: 18 cost time: 0.4646177291870117
Epoch: 18, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.549 Vali Acc: 0.515 Test Loss: 1.549 Test Acc: 0.515
Validation loss decreased (-0.492577 --> -0.514799).  Saving model ...
Epoch: 19 cost time: 0.5221352577209473
Epoch: 19, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.525 Vali Acc: 0.548 Test Loss: 1.525 Test Acc: 0.548
Validation loss decreased (-0.514799 --> -0.548133).  Saving model ...
Epoch: 20 cost time: 0.528454065322876
Epoch: 20, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.500 Vali Acc: 0.570 Test Loss: 1.500 Test Acc: 0.570
Validation loss decreased (-0.548133 --> -0.570355).  Saving model ...
Epoch: 21 cost time: 0.5102767944335938
Epoch: 21, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.475 Vali Acc: 0.596 Test Loss: 1.475 Test Acc: 0.596
Validation loss decreased (-0.570355 --> -0.596282).  Saving model ...
Epoch: 22 cost time: 0.5102016925811768
Epoch: 22, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.450 Vali Acc: 0.622 Test Loss: 1.450 Test Acc: 0.622
Validation loss decreased (-0.596282 --> -0.622208).  Saving model ...
Epoch: 23 cost time: 0.4979383945465088
Epoch: 23, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.424 Vali Acc: 0.633 Test Loss: 1.424 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633319).  Saving model ...
Epoch: 24 cost time: 0.4834742546081543
Epoch: 24, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.399 Vali Acc: 0.656 Test Loss: 1.399 Test Acc: 0.656
Validation loss decreased (-0.633319 --> -0.655542).  Saving model ...
Epoch: 25 cost time: 0.516514778137207
Epoch: 25, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.373 Vali Acc: 0.663 Test Loss: 1.373 Test Acc: 0.663
Validation loss decreased (-0.655542 --> -0.662949).  Saving model ...
Epoch: 26 cost time: 0.5442845821380615
Epoch: 26, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.347 Vali Acc: 0.681 Test Loss: 1.347 Test Acc: 0.681
Validation loss decreased (-0.662949 --> -0.681468).  Saving model ...
Epoch: 27 cost time: 0.4771392345428467
Epoch: 27, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.322 Vali Acc: 0.696 Test Loss: 1.322 Test Acc: 0.696
Validation loss decreased (-0.681468 --> -0.696283).  Saving model ...
Epoch: 28 cost time: 0.5219442844390869
Epoch: 28, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.296 Vali Acc: 0.711 Test Loss: 1.296 Test Acc: 0.711
Validation loss decreased (-0.696283 --> -0.711098).  Saving model ...
Epoch: 29 cost time: 0.5119435787200928
Epoch: 29, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.271 Vali Acc: 0.719 Test Loss: 1.271 Test Acc: 0.719
Validation loss decreased (-0.711098 --> -0.718506).  Saving model ...
Epoch: 30 cost time: 0.482572078704834
Epoch: 30, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.245 Vali Acc: 0.730 Test Loss: 1.245 Test Acc: 0.730
Validation loss decreased (-0.718506 --> -0.729617).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7296296296296296
model parameter : 89606
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0275213718414307
Epoch: 1, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.782 Vali Acc: 0.215 Test Loss: 1.782 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.5284857749938965
Epoch: 2, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.762 Vali Acc: 0.219 Test Loss: 1.762 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218501).  Saving model ...
Epoch: 3 cost time: 0.47249603271484375
Epoch: 3, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.749 Vali Acc: 0.222 Test Loss: 1.749 Test Acc: 0.222
Validation loss decreased (-0.218501 --> -0.222205).  Saving model ...
Epoch: 4 cost time: 0.5015151500701904
Epoch: 4, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.741 Vali Acc: 0.226 Test Loss: 1.741 Test Acc: 0.226
Validation loss decreased (-0.222205 --> -0.225909).  Saving model ...
Epoch: 5 cost time: 0.4828917980194092
Epoch: 5, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.731 Vali Acc: 0.241 Test Loss: 1.731 Test Acc: 0.241
Validation loss decreased (-0.225909 --> -0.240723).  Saving model ...
Epoch: 6 cost time: 0.48949146270751953
Epoch: 6, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.719 Vali Acc: 0.252 Test Loss: 1.719 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251835).  Saving model ...
Epoch: 7 cost time: 0.4492042064666748
Epoch: 7, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.705 Vali Acc: 0.263 Test Loss: 1.705 Test Acc: 0.263
Validation loss decreased (-0.251835 --> -0.262946).  Saving model ...
Epoch: 8 cost time: 0.48163414001464844
Epoch: 8, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.691 Vali Acc: 0.281 Test Loss: 1.691 Test Acc: 0.281
Validation loss decreased (-0.262946 --> -0.281465).  Saving model ...
Epoch: 9 cost time: 0.5569086074829102
Epoch: 9, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.675 Vali Acc: 0.307 Test Loss: 1.675 Test Acc: 0.307
Validation loss decreased (-0.281465 --> -0.307391).  Saving model ...
Epoch: 10 cost time: 0.4575638771057129
Epoch: 10, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.657 Vali Acc: 0.341 Test Loss: 1.657 Test Acc: 0.341
Validation loss decreased (-0.307391 --> -0.340724).  Saving model ...
Epoch: 11 cost time: 0.4893772602081299
Epoch: 11, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.639 Vali Acc: 0.348 Test Loss: 1.639 Test Acc: 0.348
Validation loss decreased (-0.340724 --> -0.348132).  Saving model ...
Epoch: 12 cost time: 0.49016308784484863
Epoch: 12, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.620 Vali Acc: 0.370 Test Loss: 1.620 Test Acc: 0.370
Validation loss decreased (-0.348132 --> -0.370354).  Saving model ...
Epoch: 13 cost time: 0.45089006423950195
Epoch: 13, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.601 Vali Acc: 0.393 Test Loss: 1.601 Test Acc: 0.393
Validation loss decreased (-0.370354 --> -0.392577).  Saving model ...
Epoch: 14 cost time: 0.47730374336242676
Epoch: 14, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.581 Vali Acc: 0.407 Test Loss: 1.581 Test Acc: 0.407
Validation loss decreased (-0.392577 --> -0.407392).  Saving model ...
Epoch: 15 cost time: 0.5345914363861084
Epoch: 15, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.560 Vali Acc: 0.444 Test Loss: 1.560 Test Acc: 0.444
Validation loss decreased (-0.407392 --> -0.444429).  Saving model ...
Epoch: 16 cost time: 0.4869523048400879
Epoch: 16, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.539 Vali Acc: 0.467 Test Loss: 1.539 Test Acc: 0.467
Validation loss decreased (-0.444429 --> -0.466651).  Saving model ...
Epoch: 17 cost time: 0.45851802825927734
Epoch: 17, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.517 Vali Acc: 0.489 Test Loss: 1.517 Test Acc: 0.489
Validation loss decreased (-0.466651 --> -0.488874).  Saving model ...
Epoch: 18 cost time: 0.5077500343322754
Epoch: 18, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.495 Vali Acc: 0.496 Test Loss: 1.495 Test Acc: 0.496
Validation loss decreased (-0.488874 --> -0.496281).  Saving model ...
Epoch: 19 cost time: 0.45725059509277344
Epoch: 19, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.472 Vali Acc: 0.526 Test Loss: 1.472 Test Acc: 0.526
Validation loss decreased (-0.496281 --> -0.525911).  Saving model ...
Epoch: 20 cost time: 0.4733119010925293
Epoch: 20, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.450 Vali Acc: 0.537 Test Loss: 1.450 Test Acc: 0.537
Validation loss decreased (-0.525911 --> -0.537023).  Saving model ...
Epoch: 21 cost time: 0.43619418144226074
Epoch: 21, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.427 Vali Acc: 0.563 Test Loss: 1.427 Test Acc: 0.563
Validation loss decreased (-0.537023 --> -0.562949).  Saving model ...
Epoch: 22 cost time: 0.45409178733825684
Epoch: 22, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.404 Vali Acc: 0.585 Test Loss: 1.404 Test Acc: 0.585
Validation loss decreased (-0.562949 --> -0.585171).  Saving model ...
Epoch: 23 cost time: 0.4959568977355957
Epoch: 23, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.381 Vali Acc: 0.600 Test Loss: 1.381 Test Acc: 0.600
Validation loss decreased (-0.585171 --> -0.599986).  Saving model ...
Epoch: 24 cost time: 0.5099472999572754
Epoch: 24, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.359 Vali Acc: 0.611 Test Loss: 1.359 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611098).  Saving model ...
Epoch: 25 cost time: 0.47739434242248535
Epoch: 25, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.336 Vali Acc: 0.626 Test Loss: 1.336 Test Acc: 0.626
Validation loss decreased (-0.611098 --> -0.625913).  Saving model ...
Epoch: 26 cost time: 0.48612236976623535
Epoch: 26, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.314 Vali Acc: 0.648 Test Loss: 1.314 Test Acc: 0.648
Validation loss decreased (-0.625913 --> -0.648135).  Saving model ...
Epoch: 27 cost time: 0.4718949794769287
Epoch: 27, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.292 Vali Acc: 0.670 Test Loss: 1.292 Test Acc: 0.670
Validation loss decreased (-0.648135 --> -0.670357).  Saving model ...
Epoch: 28 cost time: 0.5090246200561523
Epoch: 28, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.271 Vali Acc: 0.681 Test Loss: 1.271 Test Acc: 0.681
Validation loss decreased (-0.670357 --> -0.681469).  Saving model ...
Epoch: 29 cost time: 0.4568498134613037
Epoch: 29, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.250 Vali Acc: 0.693 Test Loss: 1.250 Test Acc: 0.693
Validation loss decreased (-0.681469 --> -0.692580).  Saving model ...
Epoch: 30 cost time: 0.4364197254180908
Epoch: 30, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.229 Vali Acc: 0.704 Test Loss: 1.229 Test Acc: 0.704
Validation loss decreased (-0.692580 --> -0.703691).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7037037037037037
model parameter : 296614
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8930299282073975
Epoch: 1, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.846 Vali Acc: 0.159 Test Loss: 1.846 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 0.5408501625061035
Epoch: 2, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.826 Vali Acc: 0.167 Test Loss: 1.826 Test Acc: 0.167
Validation loss decreased (-0.159241 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.4624288082122803
Epoch: 3, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.814 Vali Acc: 0.174 Test Loss: 1.814 Test Acc: 0.174
Validation loss decreased (-0.166648 --> -0.174056).  Saving model ...
Epoch: 4 cost time: 0.4913315773010254
Epoch: 4, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.807 Vali Acc: 0.181 Test Loss: 1.807 Test Acc: 0.181
Validation loss decreased (-0.174056 --> -0.181463).  Saving model ...
Epoch: 5 cost time: 0.4653794765472412
Epoch: 5, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.797 Vali Acc: 0.200 Test Loss: 1.797 Test Acc: 0.200
Validation loss decreased (-0.181463 --> -0.199982).  Saving model ...
Epoch: 6 cost time: 0.47179341316223145
Epoch: 6, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.785 Vali Acc: 0.215 Test Loss: 1.785 Test Acc: 0.215
Validation loss decreased (-0.199982 --> -0.214797).  Saving model ...
Epoch: 7 cost time: 0.4729602336883545
Epoch: 7, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.771 Vali Acc: 0.219 Test Loss: 1.771 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218501).  Saving model ...
Epoch: 8 cost time: 0.4535999298095703
Epoch: 8, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.757 Vali Acc: 0.222 Test Loss: 1.757 Test Acc: 0.222
Validation loss decreased (-0.218501 --> -0.222205).  Saving model ...
Epoch: 9 cost time: 0.48526787757873535
Epoch: 9, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.740 Vali Acc: 0.233 Test Loss: 1.740 Test Acc: 0.233
Validation loss decreased (-0.222205 --> -0.233316).  Saving model ...
Epoch: 10 cost time: 0.4844970703125
Epoch: 10, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.723 Vali Acc: 0.252 Test Loss: 1.723 Test Acc: 0.252
Validation loss decreased (-0.233316 --> -0.251835).  Saving model ...
Epoch: 11 cost time: 0.461153507232666
Epoch: 11, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.704 Vali Acc: 0.256 Test Loss: 1.704 Test Acc: 0.256
Validation loss decreased (-0.251835 --> -0.255539).  Saving model ...
Epoch: 12 cost time: 0.43161797523498535
Epoch: 12, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.685 Vali Acc: 0.278 Test Loss: 1.685 Test Acc: 0.278
Validation loss decreased (-0.255539 --> -0.277761).  Saving model ...
Epoch: 13 cost time: 0.4528310298919678
Epoch: 13, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.664 Vali Acc: 0.293 Test Loss: 1.664 Test Acc: 0.293
Validation loss decreased (-0.277761 --> -0.292576).  Saving model ...
Epoch: 14 cost time: 0.47493934631347656
Epoch: 14, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.643 Vali Acc: 0.333 Test Loss: 1.643 Test Acc: 0.333
Validation loss decreased (-0.292576 --> -0.333317).  Saving model ...
Epoch: 15 cost time: 0.46099042892456055
Epoch: 15, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.621 Vali Acc: 0.378 Test Loss: 1.621 Test Acc: 0.378
Validation loss decreased (-0.333317 --> -0.377762).  Saving model ...
Epoch: 16 cost time: 0.4932117462158203
Epoch: 16, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.598 Vali Acc: 0.441 Test Loss: 1.598 Test Acc: 0.441
Validation loss decreased (-0.377762 --> -0.440725).  Saving model ...
Epoch: 17 cost time: 0.4476590156555176
Epoch: 17, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.575 Vali Acc: 0.489 Test Loss: 1.575 Test Acc: 0.489
Validation loss decreased (-0.440725 --> -0.488873).  Saving model ...
Epoch: 18 cost time: 0.4565155506134033
Epoch: 18, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.551 Vali Acc: 0.511 Test Loss: 1.551 Test Acc: 0.511
Validation loss decreased (-0.488873 --> -0.511096).  Saving model ...
Epoch: 19 cost time: 0.4753572940826416
Epoch: 19, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.526 Vali Acc: 0.548 Test Loss: 1.526 Test Acc: 0.548
Validation loss decreased (-0.511096 --> -0.548133).  Saving model ...
Epoch: 20 cost time: 0.45015621185302734
Epoch: 20, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.501 Vali Acc: 0.570 Test Loss: 1.501 Test Acc: 0.570
Validation loss decreased (-0.548133 --> -0.570355).  Saving model ...
Epoch: 21 cost time: 0.4679069519042969
Epoch: 21, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.476 Vali Acc: 0.596 Test Loss: 1.476 Test Acc: 0.596
Validation loss decreased (-0.570355 --> -0.596282).  Saving model ...
Epoch: 22 cost time: 0.4696331024169922
Epoch: 22, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.451 Vali Acc: 0.622 Test Loss: 1.451 Test Acc: 0.622
Validation loss decreased (-0.596282 --> -0.622208).  Saving model ...
Epoch: 23 cost time: 0.5217621326446533
Epoch: 23, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.426 Vali Acc: 0.633 Test Loss: 1.426 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633319).  Saving model ...
Epoch: 24 cost time: 0.4346630573272705
Epoch: 24, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.401 Vali Acc: 0.648 Test Loss: 1.401 Test Acc: 0.648
Validation loss decreased (-0.633319 --> -0.648134).  Saving model ...
Epoch: 25 cost time: 0.48265981674194336
Epoch: 25, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.375 Vali Acc: 0.656 Test Loss: 1.375 Test Acc: 0.656
Validation loss decreased (-0.648134 --> -0.655542).  Saving model ...
Epoch: 26 cost time: 0.44806766510009766
Epoch: 26, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.349 Vali Acc: 0.678 Test Loss: 1.349 Test Acc: 0.678
Validation loss decreased (-0.655542 --> -0.677764).  Saving model ...
Epoch: 27 cost time: 0.47974348068237305
Epoch: 27, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.323 Vali Acc: 0.696 Test Loss: 1.323 Test Acc: 0.696
Validation loss decreased (-0.677764 --> -0.696283).  Saving model ...
Epoch: 28 cost time: 0.44349074363708496
Epoch: 28, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.298 Vali Acc: 0.707 Test Loss: 1.298 Test Acc: 0.707
Validation loss decreased (-0.696283 --> -0.707394).  Saving model ...
Epoch: 29 cost time: 0.4637298583984375
Epoch: 29, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.273 Vali Acc: 0.715 Test Loss: 1.273 Test Acc: 0.715
Validation loss decreased (-0.707394 --> -0.714802).  Saving model ...
Epoch: 30 cost time: 0.47520899772644043
Epoch: 30, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.247 Vali Acc: 0.730 Test Loss: 1.247 Test Acc: 0.730
Validation loss decreased (-0.714802 --> -0.729617).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7296296296296296
model parameter : 89606
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.168764352798462
Epoch: 1, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.761 Vali Acc: 0.311 Test Loss: 1.761 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 0.5369827747344971
Epoch: 2, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.742 Vali Acc: 0.315 Test Loss: 1.742 Test Acc: 0.315
Validation loss decreased (-0.311094 --> -0.314797).  Saving model ...
Epoch: 3 cost time: 0.5995545387268066
Epoch: 3, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.730 Vali Acc: 0.322 Test Loss: 1.730 Test Acc: 0.322
Validation loss decreased (-0.314797 --> -0.322205).  Saving model ...
Epoch: 4 cost time: 0.5352203845977783
Epoch: 4, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.723 Vali Acc: 0.337 Test Loss: 1.723 Test Acc: 0.337
Validation loss decreased (-0.322205 --> -0.337020).  Saving model ...
Epoch: 5 cost time: 0.5365455150604248
Epoch: 5, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.714 Vali Acc: 0.341 Test Loss: 1.714 Test Acc: 0.341
Validation loss decreased (-0.337020 --> -0.340724).  Saving model ...
Epoch: 6 cost time: 0.583592414855957
Epoch: 6, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.702 Vali Acc: 0.344 Test Loss: 1.702 Test Acc: 0.344
Validation loss decreased (-0.340724 --> -0.344427).  Saving model ...
Epoch: 7 cost time: 0.644463300704956
Epoch: 7, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.690 Vali Acc: 0.344 Test Loss: 1.690 Test Acc: 0.344
Validation loss decreased (-0.344427 --> -0.344428).  Saving model ...
Epoch: 8 cost time: 0.60105299949646
Epoch: 8, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.676 Vali Acc: 0.356 Test Loss: 1.676 Test Acc: 0.356
Validation loss decreased (-0.344428 --> -0.355539).  Saving model ...
Epoch: 9 cost time: 0.5981290340423584
Epoch: 9, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.661 Vali Acc: 0.359 Test Loss: 1.661 Test Acc: 0.359
Validation loss decreased (-0.355539 --> -0.359243).  Saving model ...
Epoch: 10 cost time: 0.5821301937103271
Epoch: 10, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.645 Vali Acc: 0.359 Test Loss: 1.645 Test Acc: 0.359
Validation loss decreased (-0.359243 --> -0.359243).  Saving model ...
Epoch: 11 cost time: 0.5771827697753906
Epoch: 11, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.628 Vali Acc: 0.363 Test Loss: 1.628 Test Acc: 0.363
Validation loss decreased (-0.359243 --> -0.362947).  Saving model ...
Epoch: 12 cost time: 0.5751500129699707
Epoch: 12, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.611 Vali Acc: 0.363 Test Loss: 1.611 Test Acc: 0.363
Validation loss decreased (-0.362947 --> -0.362947).  Saving model ...
Epoch: 13 cost time: 0.5953214168548584
Epoch: 13, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.593 Vali Acc: 0.363 Test Loss: 1.593 Test Acc: 0.363
Validation loss decreased (-0.362947 --> -0.362947).  Saving model ...
Epoch: 14 cost time: 0.5680093765258789
Epoch: 14, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.574 Vali Acc: 0.367 Test Loss: 1.574 Test Acc: 0.367
Validation loss decreased (-0.362947 --> -0.366651).  Saving model ...
Epoch: 15 cost time: 0.5817656517028809
Epoch: 15, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.555 Vali Acc: 0.367 Test Loss: 1.555 Test Acc: 0.367
Validation loss decreased (-0.366651 --> -0.366651).  Saving model ...
Epoch: 16 cost time: 0.5853278636932373
Epoch: 16, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.536 Vali Acc: 0.393 Test Loss: 1.536 Test Acc: 0.393
Validation loss decreased (-0.366651 --> -0.392577).  Saving model ...
Epoch: 17 cost time: 0.604550838470459
Epoch: 17, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.516 Vali Acc: 0.411 Test Loss: 1.516 Test Acc: 0.411
Validation loss decreased (-0.392577 --> -0.411096).  Saving model ...
Epoch: 18 cost time: 0.5963091850280762
Epoch: 18, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.496 Vali Acc: 0.422 Test Loss: 1.496 Test Acc: 0.422
Validation loss decreased (-0.411096 --> -0.422207).  Saving model ...
Epoch: 19 cost time: 0.5802352428436279
Epoch: 19, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.475 Vali Acc: 0.430 Test Loss: 1.475 Test Acc: 0.430
Validation loss decreased (-0.422207 --> -0.429615).  Saving model ...
Epoch: 20 cost time: 0.5791425704956055
Epoch: 20, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.455 Vali Acc: 0.456 Test Loss: 1.455 Test Acc: 0.456
Validation loss decreased (-0.429615 --> -0.455541).  Saving model ...
Epoch: 21 cost time: 0.5865607261657715
Epoch: 21, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.435 Vali Acc: 0.474 Test Loss: 1.435 Test Acc: 0.474
Validation loss decreased (-0.455541 --> -0.474060).  Saving model ...
Epoch: 22 cost time: 0.5953326225280762
Epoch: 22, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.414 Vali Acc: 0.493 Test Loss: 1.414 Test Acc: 0.493
Validation loss decreased (-0.474060 --> -0.492578).  Saving model ...
Epoch: 23 cost time: 0.582103967666626
Epoch: 23, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.393 Vali Acc: 0.515 Test Loss: 1.393 Test Acc: 0.515
Validation loss decreased (-0.492578 --> -0.514801).  Saving model ...
Epoch: 24 cost time: 0.5806457996368408
Epoch: 24, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.372 Vali Acc: 0.544 Test Loss: 1.372 Test Acc: 0.544
Validation loss decreased (-0.514801 --> -0.544431).  Saving model ...
Epoch: 25 cost time: 0.5813424587249756
Epoch: 25, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.352 Vali Acc: 0.570 Test Loss: 1.352 Test Acc: 0.570
Validation loss decreased (-0.544431 --> -0.570357).  Saving model ...
Epoch: 26 cost time: 0.6017825603485107
Epoch: 26, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.331 Vali Acc: 0.596 Test Loss: 1.331 Test Acc: 0.596
Validation loss decreased (-0.570357 --> -0.596283).  Saving model ...
Epoch: 27 cost time: 0.6193478107452393
Epoch: 27, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.310 Vali Acc: 0.622 Test Loss: 1.310 Test Acc: 0.622
Validation loss decreased (-0.596283 --> -0.622209).  Saving model ...
Epoch: 28 cost time: 0.565272331237793
Epoch: 28, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.290 Vali Acc: 0.633 Test Loss: 1.290 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633320).  Saving model ...
Epoch: 29 cost time: 0.5951104164123535
Epoch: 29, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.270 Vali Acc: 0.644 Test Loss: 1.270 Test Acc: 0.644
Validation loss decreased (-0.633320 --> -0.644432).  Saving model ...
Epoch: 30 cost time: 0.5905604362487793
Epoch: 30, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.249 Vali Acc: 0.652 Test Loss: 1.249 Test Acc: 0.652
Validation loss decreased (-0.644432 --> -0.651839).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6518518518518519
model parameter : 149990
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1594901084899902
Epoch: 1, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.855 Vali Acc: 0.281 Test Loss: 1.855 Test Acc: 0.281
Validation loss decreased (inf --> -0.281463).  Saving model ...
Epoch: 2 cost time: 0.5563695430755615
Epoch: 2, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.836 Vali Acc: 0.285 Test Loss: 1.836 Test Acc: 0.285
Validation loss decreased (-0.281463 --> -0.285167).  Saving model ...
Epoch: 3 cost time: 0.5848736763000488
Epoch: 3, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.825 Vali Acc: 0.300 Test Loss: 1.825 Test Acc: 0.300
Validation loss decreased (-0.285167 --> -0.299982).  Saving model ...
Epoch: 4 cost time: 0.5326495170593262
Epoch: 4, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.819 Vali Acc: 0.307 Test Loss: 1.819 Test Acc: 0.307
Validation loss decreased (-0.299982 --> -0.307389).  Saving model ...
Epoch: 5 cost time: 0.5609307289123535
Epoch: 5, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.810 Vali Acc: 0.315 Test Loss: 1.810 Test Acc: 0.315
Validation loss decreased (-0.307389 --> -0.314797).  Saving model ...
Epoch: 6 cost time: 0.5100302696228027
Epoch: 6, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.800 Vali Acc: 0.330 Test Loss: 1.800 Test Acc: 0.330
Validation loss decreased (-0.314797 --> -0.329612).  Saving model ...
Epoch: 7 cost time: 0.5535712242126465
Epoch: 7, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.789 Vali Acc: 0.333 Test Loss: 1.789 Test Acc: 0.333
Validation loss decreased (-0.329612 --> -0.333315).  Saving model ...
Epoch: 8 cost time: 0.5413672924041748
Epoch: 8, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.776 Vali Acc: 0.337 Test Loss: 1.776 Test Acc: 0.337
Validation loss decreased (-0.333315 --> -0.337019).  Saving model ...
Epoch: 9 cost time: 0.5978765487670898
Epoch: 9, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.762 Vali Acc: 0.344 Test Loss: 1.762 Test Acc: 0.344
Validation loss decreased (-0.337019 --> -0.344427).  Saving model ...
Epoch: 10 cost time: 0.5238912105560303
Epoch: 10, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.748 Vali Acc: 0.348 Test Loss: 1.748 Test Acc: 0.348
Validation loss decreased (-0.344427 --> -0.348131).  Saving model ...
Epoch: 11 cost time: 0.5273704528808594
Epoch: 11, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.733 Vali Acc: 0.359 Test Loss: 1.733 Test Acc: 0.359
Validation loss decreased (-0.348131 --> -0.359242).  Saving model ...
Epoch: 12 cost time: 0.5506746768951416
Epoch: 12, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.716 Vali Acc: 0.370 Test Loss: 1.716 Test Acc: 0.370
Validation loss decreased (-0.359242 --> -0.370353).  Saving model ...
Epoch: 13 cost time: 0.5401973724365234
Epoch: 13, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.700 Vali Acc: 0.381 Test Loss: 1.700 Test Acc: 0.381
Validation loss decreased (-0.370353 --> -0.381464).  Saving model ...
Epoch: 14 cost time: 0.5328583717346191
Epoch: 14, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.683 Vali Acc: 0.385 Test Loss: 1.683 Test Acc: 0.385
Validation loss decreased (-0.381464 --> -0.385168).  Saving model ...
Epoch: 15 cost time: 0.5751304626464844
Epoch: 15, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.665 Vali Acc: 0.393 Test Loss: 1.665 Test Acc: 0.393
Validation loss decreased (-0.385168 --> -0.392576).  Saving model ...
Epoch: 16 cost time: 0.5169985294342041
Epoch: 16, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.646 Vali Acc: 0.415 Test Loss: 1.646 Test Acc: 0.415
Validation loss decreased (-0.392576 --> -0.414798).  Saving model ...
Epoch: 17 cost time: 0.5004372596740723
Epoch: 17, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.627 Vali Acc: 0.426 Test Loss: 1.627 Test Acc: 0.426
Validation loss decreased (-0.414798 --> -0.425910).  Saving model ...
Epoch: 18 cost time: 0.5586037635803223
Epoch: 18, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.607 Vali Acc: 0.444 Test Loss: 1.607 Test Acc: 0.444
Validation loss decreased (-0.425910 --> -0.444428).  Saving model ...
Epoch: 19 cost time: 0.5415654182434082
Epoch: 19, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.587 Vali Acc: 0.474 Test Loss: 1.587 Test Acc: 0.474
Validation loss decreased (-0.444428 --> -0.474058).  Saving model ...
Epoch: 20 cost time: 0.5271844863891602
Epoch: 20, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.567 Vali Acc: 0.478 Test Loss: 1.567 Test Acc: 0.478
Validation loss decreased (-0.474058 --> -0.477762).  Saving model ...
Epoch: 21 cost time: 0.5254635810852051
Epoch: 21, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.546 Vali Acc: 0.485 Test Loss: 1.546 Test Acc: 0.485
Validation loss decreased (-0.477762 --> -0.485170).  Saving model ...
Epoch: 22 cost time: 0.5388054847717285
Epoch: 22, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.526 Vali Acc: 0.493 Test Loss: 1.526 Test Acc: 0.493
Validation loss decreased (-0.485170 --> -0.492577).  Saving model ...
Epoch: 23 cost time: 0.5485801696777344
Epoch: 23, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.505 Vali Acc: 0.504 Test Loss: 1.505 Test Acc: 0.504
Validation loss decreased (-0.492577 --> -0.503689).  Saving model ...
Epoch: 24 cost time: 0.6119585037231445
Epoch: 24, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.484 Vali Acc: 0.515 Test Loss: 1.484 Test Acc: 0.515
Validation loss decreased (-0.503689 --> -0.514800).  Saving model ...
Epoch: 25 cost time: 0.5573229789733887
Epoch: 25, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.462 Vali Acc: 0.515 Test Loss: 1.462 Test Acc: 0.515
Validation loss decreased (-0.514800 --> -0.514800).  Saving model ...
Epoch: 26 cost time: 0.6018490791320801
Epoch: 26, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.440 Vali Acc: 0.537 Test Loss: 1.440 Test Acc: 0.537
Validation loss decreased (-0.514800 --> -0.537023).  Saving model ...
Epoch: 27 cost time: 0.5405571460723877
Epoch: 27, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.419 Vali Acc: 0.559 Test Loss: 1.419 Test Acc: 0.559
Validation loss decreased (-0.537023 --> -0.559245).  Saving model ...
Epoch: 28 cost time: 0.5261788368225098
Epoch: 28, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.397 Vali Acc: 0.578 Test Loss: 1.397 Test Acc: 0.578
Validation loss decreased (-0.559245 --> -0.577764).  Saving model ...
Epoch: 29 cost time: 0.5575740337371826
Epoch: 29, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.375 Vali Acc: 0.615 Test Loss: 1.375 Test Acc: 0.615
Validation loss decreased (-0.577764 --> -0.614801).  Saving model ...
Epoch: 30 cost time: 0.5422766208648682
Epoch: 30, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.352 Vali Acc: 0.630 Test Loss: 1.352 Test Acc: 0.630
Validation loss decreased (-0.614801 --> -0.629616).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6296296296296297
model parameter : 46470
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2161076068878174
Epoch: 1, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.761 Vali Acc: 0.311 Test Loss: 1.761 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 0.5828959941864014
Epoch: 2, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.742 Vali Acc: 0.315 Test Loss: 1.742 Test Acc: 0.315
Validation loss decreased (-0.311094 --> -0.314797).  Saving model ...
Epoch: 3 cost time: 0.549572229385376
Epoch: 3, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.730 Vali Acc: 0.322 Test Loss: 1.730 Test Acc: 0.322
Validation loss decreased (-0.314797 --> -0.322205).  Saving model ...
Epoch: 4 cost time: 0.5755207538604736
Epoch: 4, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.723 Vali Acc: 0.337 Test Loss: 1.723 Test Acc: 0.337
Validation loss decreased (-0.322205 --> -0.337020).  Saving model ...
Epoch: 5 cost time: 0.5555715560913086
Epoch: 5, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.714 Vali Acc: 0.341 Test Loss: 1.714 Test Acc: 0.341
Validation loss decreased (-0.337020 --> -0.340724).  Saving model ...
Epoch: 6 cost time: 0.531402587890625
Epoch: 6, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.702 Vali Acc: 0.344 Test Loss: 1.702 Test Acc: 0.344
Validation loss decreased (-0.340724 --> -0.344427).  Saving model ...
Epoch: 7 cost time: 0.5564000606536865
Epoch: 7, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.690 Vali Acc: 0.344 Test Loss: 1.690 Test Acc: 0.344
Validation loss decreased (-0.344427 --> -0.344428).  Saving model ...
Epoch: 8 cost time: 0.6057441234588623
Epoch: 8, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.676 Vali Acc: 0.356 Test Loss: 1.676 Test Acc: 0.356
Validation loss decreased (-0.344428 --> -0.355539).  Saving model ...
Epoch: 9 cost time: 0.5501844882965088
Epoch: 9, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.661 Vali Acc: 0.359 Test Loss: 1.661 Test Acc: 0.359
Validation loss decreased (-0.355539 --> -0.359243).  Saving model ...
Epoch: 10 cost time: 0.5990488529205322
Epoch: 10, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.645 Vali Acc: 0.359 Test Loss: 1.645 Test Acc: 0.359
Validation loss decreased (-0.359243 --> -0.359243).  Saving model ...
Epoch: 11 cost time: 0.5506527423858643
Epoch: 11, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.628 Vali Acc: 0.363 Test Loss: 1.628 Test Acc: 0.363
Validation loss decreased (-0.359243 --> -0.362947).  Saving model ...
Epoch: 12 cost time: 0.5294253826141357
Epoch: 12, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.611 Vali Acc: 0.363 Test Loss: 1.611 Test Acc: 0.363
Validation loss decreased (-0.362947 --> -0.362947).  Saving model ...
Epoch: 13 cost time: 0.5427210330963135
Epoch: 13, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.593 Vali Acc: 0.363 Test Loss: 1.593 Test Acc: 0.363
Validation loss decreased (-0.362947 --> -0.362947).  Saving model ...
Epoch: 14 cost time: 0.5355966091156006
Epoch: 14, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.574 Vali Acc: 0.367 Test Loss: 1.574 Test Acc: 0.367
Validation loss decreased (-0.362947 --> -0.366651).  Saving model ...
Epoch: 15 cost time: 0.6175239086151123
Epoch: 15, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.555 Vali Acc: 0.367 Test Loss: 1.555 Test Acc: 0.367
Validation loss decreased (-0.366651 --> -0.366651).  Saving model ...
Epoch: 16 cost time: 0.6336867809295654
Epoch: 16, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.536 Vali Acc: 0.393 Test Loss: 1.536 Test Acc: 0.393
Validation loss decreased (-0.366651 --> -0.392577).  Saving model ...
Epoch: 17 cost time: 0.6107637882232666
Epoch: 17, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.516 Vali Acc: 0.411 Test Loss: 1.516 Test Acc: 0.411
Validation loss decreased (-0.392577 --> -0.411096).  Saving model ...
Epoch: 18 cost time: 0.5562894344329834
Epoch: 18, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.496 Vali Acc: 0.422 Test Loss: 1.496 Test Acc: 0.422
Validation loss decreased (-0.411096 --> -0.422207).  Saving model ...
Epoch: 19 cost time: 0.554795503616333
Epoch: 19, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.475 Vali Acc: 0.430 Test Loss: 1.475 Test Acc: 0.430
Validation loss decreased (-0.422207 --> -0.429615).  Saving model ...
Epoch: 20 cost time: 0.5773990154266357
Epoch: 20, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.455 Vali Acc: 0.456 Test Loss: 1.455 Test Acc: 0.456
Validation loss decreased (-0.429615 --> -0.455541).  Saving model ...
Epoch: 21 cost time: 0.5642485618591309
Epoch: 21, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.435 Vali Acc: 0.474 Test Loss: 1.435 Test Acc: 0.474
Validation loss decreased (-0.455541 --> -0.474060).  Saving model ...
Epoch: 22 cost time: 0.5395302772521973
Epoch: 22, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.414 Vali Acc: 0.493 Test Loss: 1.414 Test Acc: 0.493
Validation loss decreased (-0.474060 --> -0.492578).  Saving model ...
Epoch: 23 cost time: 0.5763013362884521
Epoch: 23, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.393 Vali Acc: 0.515 Test Loss: 1.393 Test Acc: 0.515
Validation loss decreased (-0.492578 --> -0.514801).  Saving model ...
Epoch: 24 cost time: 0.5582089424133301
Epoch: 24, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.372 Vali Acc: 0.544 Test Loss: 1.372 Test Acc: 0.544
Validation loss decreased (-0.514801 --> -0.544431).  Saving model ...
Epoch: 25 cost time: 0.5574924945831299
Epoch: 25, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.352 Vali Acc: 0.570 Test Loss: 1.352 Test Acc: 0.570
Validation loss decreased (-0.544431 --> -0.570357).  Saving model ...
Epoch: 26 cost time: 0.6260569095611572
Epoch: 26, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.331 Vali Acc: 0.596 Test Loss: 1.331 Test Acc: 0.596
Validation loss decreased (-0.570357 --> -0.596283).  Saving model ...
Epoch: 27 cost time: 0.5996818542480469
Epoch: 27, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.310 Vali Acc: 0.622 Test Loss: 1.310 Test Acc: 0.622
Validation loss decreased (-0.596283 --> -0.622209).  Saving model ...
Epoch: 28 cost time: 0.5296354293823242
Epoch: 28, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.290 Vali Acc: 0.633 Test Loss: 1.290 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633320).  Saving model ...
Epoch: 29 cost time: 0.5313847064971924
Epoch: 29, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.270 Vali Acc: 0.644 Test Loss: 1.270 Test Acc: 0.644
Validation loss decreased (-0.633320 --> -0.644432).  Saving model ...
Epoch: 30 cost time: 0.5368473529815674
Epoch: 30, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.249 Vali Acc: 0.652 Test Loss: 1.249 Test Acc: 0.652
Validation loss decreased (-0.644432 --> -0.651839).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6518518518518519
model parameter : 149990
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0072808265686035
Epoch: 1, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.855 Vali Acc: 0.281 Test Loss: 1.855 Test Acc: 0.281
Validation loss decreased (inf --> -0.281463).  Saving model ...
Epoch: 2 cost time: 0.5107340812683105
Epoch: 2, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.836 Vali Acc: 0.285 Test Loss: 1.836 Test Acc: 0.285
Validation loss decreased (-0.281463 --> -0.285167).  Saving model ...
Epoch: 3 cost time: 0.5057108402252197
Epoch: 3, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.825 Vali Acc: 0.300 Test Loss: 1.825 Test Acc: 0.300
Validation loss decreased (-0.285167 --> -0.299982).  Saving model ...
Epoch: 4 cost time: 0.534156322479248
Epoch: 4, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.819 Vali Acc: 0.307 Test Loss: 1.819 Test Acc: 0.307
Validation loss decreased (-0.299982 --> -0.307389).  Saving model ...
Epoch: 5 cost time: 0.5384776592254639
Epoch: 5, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.810 Vali Acc: 0.315 Test Loss: 1.810 Test Acc: 0.315
Validation loss decreased (-0.307389 --> -0.314797).  Saving model ...
Epoch: 6 cost time: 0.509324312210083
Epoch: 6, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.800 Vali Acc: 0.330 Test Loss: 1.800 Test Acc: 0.330
Validation loss decreased (-0.314797 --> -0.329612).  Saving model ...
Epoch: 7 cost time: 0.48847532272338867
Epoch: 7, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.789 Vali Acc: 0.333 Test Loss: 1.789 Test Acc: 0.333
Validation loss decreased (-0.329612 --> -0.333315).  Saving model ...
Epoch: 8 cost time: 0.5022549629211426
Epoch: 8, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.776 Vali Acc: 0.337 Test Loss: 1.776 Test Acc: 0.337
Validation loss decreased (-0.333315 --> -0.337019).  Saving model ...
Epoch: 9 cost time: 0.5620660781860352
Epoch: 9, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.762 Vali Acc: 0.344 Test Loss: 1.762 Test Acc: 0.344
Validation loss decreased (-0.337019 --> -0.344427).  Saving model ...
Epoch: 10 cost time: 0.5248289108276367
Epoch: 10, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.748 Vali Acc: 0.348 Test Loss: 1.748 Test Acc: 0.348
Validation loss decreased (-0.344427 --> -0.348131).  Saving model ...
Epoch: 11 cost time: 0.511925220489502
Epoch: 11, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.733 Vali Acc: 0.359 Test Loss: 1.733 Test Acc: 0.359
Validation loss decreased (-0.348131 --> -0.359242).  Saving model ...
Epoch: 12 cost time: 0.5334157943725586
Epoch: 12, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.716 Vali Acc: 0.370 Test Loss: 1.716 Test Acc: 0.370
Validation loss decreased (-0.359242 --> -0.370353).  Saving model ...
Epoch: 13 cost time: 0.597402811050415
Epoch: 13, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.700 Vali Acc: 0.381 Test Loss: 1.700 Test Acc: 0.381
Validation loss decreased (-0.370353 --> -0.381464).  Saving model ...
Epoch: 14 cost time: 0.5280702114105225
Epoch: 14, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.683 Vali Acc: 0.385 Test Loss: 1.683 Test Acc: 0.385
Validation loss decreased (-0.381464 --> -0.385168).  Saving model ...
Epoch: 15 cost time: 0.5873491764068604
Epoch: 15, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.665 Vali Acc: 0.393 Test Loss: 1.665 Test Acc: 0.393
Validation loss decreased (-0.385168 --> -0.392576).  Saving model ...
Epoch: 16 cost time: 0.6058540344238281
Epoch: 16, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.646 Vali Acc: 0.415 Test Loss: 1.646 Test Acc: 0.415
Validation loss decreased (-0.392576 --> -0.414798).  Saving model ...
Epoch: 17 cost time: 0.5408523082733154
Epoch: 17, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.627 Vali Acc: 0.426 Test Loss: 1.627 Test Acc: 0.426
Validation loss decreased (-0.414798 --> -0.425910).  Saving model ...
Epoch: 18 cost time: 0.516782283782959
Epoch: 18, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.607 Vali Acc: 0.444 Test Loss: 1.607 Test Acc: 0.444
Validation loss decreased (-0.425910 --> -0.444428).  Saving model ...
Epoch: 19 cost time: 0.5356245040893555
Epoch: 19, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.587 Vali Acc: 0.474 Test Loss: 1.587 Test Acc: 0.474
Validation loss decreased (-0.444428 --> -0.474058).  Saving model ...
Epoch: 20 cost time: 0.5489122867584229
Epoch: 20, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.567 Vali Acc: 0.478 Test Loss: 1.567 Test Acc: 0.478
Validation loss decreased (-0.474058 --> -0.477762).  Saving model ...
Epoch: 21 cost time: 0.5221896171569824
Epoch: 21, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.546 Vali Acc: 0.485 Test Loss: 1.546 Test Acc: 0.485
Validation loss decreased (-0.477762 --> -0.485170).  Saving model ...
Epoch: 22 cost time: 0.5672123432159424
Epoch: 22, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.526 Vali Acc: 0.493 Test Loss: 1.526 Test Acc: 0.493
Validation loss decreased (-0.485170 --> -0.492577).  Saving model ...
Epoch: 23 cost time: 0.526902437210083
Epoch: 23, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.505 Vali Acc: 0.504 Test Loss: 1.505 Test Acc: 0.504
Validation loss decreased (-0.492577 --> -0.503689).  Saving model ...
Epoch: 24 cost time: 0.5731825828552246
Epoch: 24, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.484 Vali Acc: 0.515 Test Loss: 1.484 Test Acc: 0.515
Validation loss decreased (-0.503689 --> -0.514800).  Saving model ...
Epoch: 25 cost time: 0.5481064319610596
Epoch: 25, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.462 Vali Acc: 0.515 Test Loss: 1.462 Test Acc: 0.515
Validation loss decreased (-0.514800 --> -0.514800).  Saving model ...
Epoch: 26 cost time: 0.564415454864502
Epoch: 26, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.440 Vali Acc: 0.537 Test Loss: 1.440 Test Acc: 0.537
Validation loss decreased (-0.514800 --> -0.537023).  Saving model ...
Epoch: 27 cost time: 0.5668082237243652
Epoch: 27, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.419 Vali Acc: 0.559 Test Loss: 1.419 Test Acc: 0.559
Validation loss decreased (-0.537023 --> -0.559245).  Saving model ...
Epoch: 28 cost time: 0.5182662010192871
Epoch: 28, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.397 Vali Acc: 0.578 Test Loss: 1.397 Test Acc: 0.578
Validation loss decreased (-0.559245 --> -0.577764).  Saving model ...
Epoch: 29 cost time: 0.4978668689727783
Epoch: 29, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.375 Vali Acc: 0.615 Test Loss: 1.375 Test Acc: 0.615
Validation loss decreased (-0.577764 --> -0.614801).  Saving model ...
Epoch: 30 cost time: 0.5578880310058594
Epoch: 30, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.352 Vali Acc: 0.630 Test Loss: 1.352 Test Acc: 0.630
Validation loss decreased (-0.614801 --> -0.629616).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6296296296296297
model parameter : 46470
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2467446327209473
Epoch: 1, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.761 Vali Acc: 0.307 Test Loss: 1.761 Test Acc: 0.307
Validation loss decreased (inf --> -0.307390).  Saving model ...
Epoch: 2 cost time: 0.5398476123809814
Epoch: 2, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.742 Vali Acc: 0.311 Test Loss: 1.742 Test Acc: 0.311
Validation loss decreased (-0.307390 --> -0.311094).  Saving model ...
Epoch: 3 cost time: 0.5074541568756104
Epoch: 3, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.730 Vali Acc: 0.319 Test Loss: 1.730 Test Acc: 0.319
Validation loss decreased (-0.311094 --> -0.318501).  Saving model ...
Epoch: 4 cost time: 0.5157835483551025
Epoch: 4, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.723 Vali Acc: 0.333 Test Loss: 1.723 Test Acc: 0.333
Validation loss decreased (-0.318501 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 0.5367841720581055
Epoch: 5, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.714 Vali Acc: 0.337 Test Loss: 1.714 Test Acc: 0.337
Validation loss decreased (-0.333316 --> -0.337020).  Saving model ...
Epoch: 6 cost time: 0.53047776222229
Epoch: 6, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.703 Vali Acc: 0.344 Test Loss: 1.703 Test Acc: 0.344
Validation loss decreased (-0.337020 --> -0.344427).  Saving model ...
Epoch: 7 cost time: 0.5230858325958252
Epoch: 7, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.690 Vali Acc: 0.344 Test Loss: 1.690 Test Acc: 0.344
Validation loss decreased (-0.344427 --> -0.344428).  Saving model ...
Epoch: 8 cost time: 0.6088550090789795
Epoch: 8, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.676 Vali Acc: 0.356 Test Loss: 1.676 Test Acc: 0.356
Validation loss decreased (-0.344428 --> -0.355539).  Saving model ...
Epoch: 9 cost time: 0.5038087368011475
Epoch: 9, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.661 Vali Acc: 0.359 Test Loss: 1.661 Test Acc: 0.359
Validation loss decreased (-0.355539 --> -0.359243).  Saving model ...
Epoch: 10 cost time: 0.5177061557769775
Epoch: 10, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.646 Vali Acc: 0.359 Test Loss: 1.646 Test Acc: 0.359
Validation loss decreased (-0.359243 --> -0.359243).  Saving model ...
Epoch: 11 cost time: 0.514197826385498
Epoch: 11, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.629 Vali Acc: 0.363 Test Loss: 1.629 Test Acc: 0.363
Validation loss decreased (-0.359243 --> -0.362947).  Saving model ...
Epoch: 12 cost time: 0.5324821472167969
Epoch: 12, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.611 Vali Acc: 0.363 Test Loss: 1.611 Test Acc: 0.363
Validation loss decreased (-0.362947 --> -0.362947).  Saving model ...
Epoch: 13 cost time: 0.5061874389648438
Epoch: 13, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.593 Vali Acc: 0.363 Test Loss: 1.593 Test Acc: 0.363
Validation loss decreased (-0.362947 --> -0.362947).  Saving model ...
Epoch: 14 cost time: 0.5574517250061035
Epoch: 14, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.575 Vali Acc: 0.363 Test Loss: 1.575 Test Acc: 0.363
Validation loss decreased (-0.362947 --> -0.362947).  Saving model ...
Epoch: 15 cost time: 0.5324406623840332
Epoch: 15, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.556 Vali Acc: 0.367 Test Loss: 1.556 Test Acc: 0.367
Validation loss decreased (-0.362947 --> -0.366651).  Saving model ...
Epoch: 16 cost time: 0.514026403427124
Epoch: 16, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.537 Vali Acc: 0.385 Test Loss: 1.537 Test Acc: 0.385
Validation loss decreased (-0.366651 --> -0.385170).  Saving model ...
Epoch: 17 cost time: 0.5043160915374756
Epoch: 17, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.517 Vali Acc: 0.411 Test Loss: 1.517 Test Acc: 0.411
Validation loss decreased (-0.385170 --> -0.411096).  Saving model ...
Epoch: 18 cost time: 0.5181052684783936
Epoch: 18, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.497 Vali Acc: 0.419 Test Loss: 1.497 Test Acc: 0.419
Validation loss decreased (-0.411096 --> -0.418504).  Saving model ...
Epoch: 19 cost time: 0.489485502243042
Epoch: 19, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.477 Vali Acc: 0.430 Test Loss: 1.477 Test Acc: 0.430
Validation loss decreased (-0.418504 --> -0.429615).  Saving model ...
Epoch: 20 cost time: 0.4892117977142334
Epoch: 20, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.457 Vali Acc: 0.452 Test Loss: 1.457 Test Acc: 0.452
Validation loss decreased (-0.429615 --> -0.451837).  Saving model ...
Epoch: 21 cost time: 0.5083911418914795
Epoch: 21, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.436 Vali Acc: 0.470 Test Loss: 1.436 Test Acc: 0.470
Validation loss decreased (-0.451837 --> -0.470356).  Saving model ...
Epoch: 22 cost time: 0.5304908752441406
Epoch: 22, Steps: 2 | Train Loss: 1.350 Vali Loss: 1.416 Vali Acc: 0.489 Test Loss: 1.416 Test Acc: 0.489
Validation loss decreased (-0.470356 --> -0.488875).  Saving model ...
Epoch: 23 cost time: 0.5327684879302979
Epoch: 23, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.395 Vali Acc: 0.504 Test Loss: 1.395 Test Acc: 0.504
Validation loss decreased (-0.488875 --> -0.503690).  Saving model ...
Epoch: 24 cost time: 0.5885717868804932
Epoch: 24, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.374 Vali Acc: 0.541 Test Loss: 1.374 Test Acc: 0.541
Validation loss decreased (-0.503690 --> -0.540727).  Saving model ...
Epoch: 25 cost time: 0.5822584629058838
Epoch: 25, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.354 Vali Acc: 0.563 Test Loss: 1.354 Test Acc: 0.563
Validation loss decreased (-0.540727 --> -0.562949).  Saving model ...
Epoch: 26 cost time: 0.5529711246490479
Epoch: 26, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.333 Vali Acc: 0.589 Test Loss: 1.333 Test Acc: 0.589
Validation loss decreased (-0.562949 --> -0.588876).  Saving model ...
Epoch: 27 cost time: 0.5800507068634033
Epoch: 27, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.313 Vali Acc: 0.615 Test Loss: 1.313 Test Acc: 0.615
Validation loss decreased (-0.588876 --> -0.614802).  Saving model ...
Epoch: 28 cost time: 0.5166094303131104
Epoch: 28, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.292 Vali Acc: 0.633 Test Loss: 1.292 Test Acc: 0.633
Validation loss decreased (-0.614802 --> -0.633320).  Saving model ...
Epoch: 29 cost time: 0.5334892272949219
Epoch: 29, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.272 Vali Acc: 0.641 Test Loss: 1.272 Test Acc: 0.641
Validation loss decreased (-0.633320 --> -0.640728).  Saving model ...
Epoch: 30 cost time: 0.5130705833435059
Epoch: 30, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.252 Vali Acc: 0.641 Test Loss: 1.252 Test Acc: 0.641
Validation loss decreased (-0.640728 --> -0.640728).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6407407407407407
model parameter : 149990
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.104570150375366
Epoch: 1, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.855 Vali Acc: 0.278 Test Loss: 1.855 Test Acc: 0.278
Validation loss decreased (inf --> -0.277759).  Saving model ...
Epoch: 2 cost time: 0.49277424812316895
Epoch: 2, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.837 Vali Acc: 0.281 Test Loss: 1.837 Test Acc: 0.281
Validation loss decreased (-0.277759 --> -0.281463).  Saving model ...
Epoch: 3 cost time: 0.5188045501708984
Epoch: 3, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.826 Vali Acc: 0.296 Test Loss: 1.826 Test Acc: 0.296
Validation loss decreased (-0.281463 --> -0.296278).  Saving model ...
Epoch: 4 cost time: 0.504570722579956
Epoch: 4, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.819 Vali Acc: 0.304 Test Loss: 1.819 Test Acc: 0.304
Validation loss decreased (-0.296278 --> -0.303686).  Saving model ...
Epoch: 5 cost time: 0.5141034126281738
Epoch: 5, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.811 Vali Acc: 0.311 Test Loss: 1.811 Test Acc: 0.311
Validation loss decreased (-0.303686 --> -0.311093).  Saving model ...
Epoch: 6 cost time: 0.506030797958374
Epoch: 6, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.801 Vali Acc: 0.326 Test Loss: 1.801 Test Acc: 0.326
Validation loss decreased (-0.311093 --> -0.325908).  Saving model ...
Epoch: 7 cost time: 0.5769484043121338
Epoch: 7, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.789 Vali Acc: 0.330 Test Loss: 1.789 Test Acc: 0.330
Validation loss decreased (-0.325908 --> -0.329612).  Saving model ...
Epoch: 8 cost time: 0.5088744163513184
Epoch: 8, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.777 Vali Acc: 0.333 Test Loss: 1.777 Test Acc: 0.333
Validation loss decreased (-0.329612 --> -0.333316).  Saving model ...
Epoch: 9 cost time: 0.5311591625213623
Epoch: 9, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.763 Vali Acc: 0.337 Test Loss: 1.763 Test Acc: 0.337
Validation loss decreased (-0.333316 --> -0.337019).  Saving model ...
Epoch: 10 cost time: 0.49544668197631836
Epoch: 10, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.749 Vali Acc: 0.341 Test Loss: 1.749 Test Acc: 0.341
Validation loss decreased (-0.337019 --> -0.340723).  Saving model ...
Epoch: 11 cost time: 0.5325243473052979
Epoch: 11, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.733 Vali Acc: 0.356 Test Loss: 1.733 Test Acc: 0.356
Validation loss decreased (-0.340723 --> -0.355538).  Saving model ...
Epoch: 12 cost time: 0.5844008922576904
Epoch: 12, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.717 Vali Acc: 0.367 Test Loss: 1.717 Test Acc: 0.367
Validation loss decreased (-0.355538 --> -0.366649).  Saving model ...
Epoch: 13 cost time: 0.5594053268432617
Epoch: 13, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.700 Vali Acc: 0.378 Test Loss: 1.700 Test Acc: 0.378
Validation loss decreased (-0.366649 --> -0.377761).  Saving model ...
Epoch: 14 cost time: 0.5555839538574219
Epoch: 14, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.683 Vali Acc: 0.378 Test Loss: 1.683 Test Acc: 0.378
Validation loss decreased (-0.377761 --> -0.377761).  Saving model ...
Epoch: 15 cost time: 0.5263156890869141
Epoch: 15, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.666 Vali Acc: 0.385 Test Loss: 1.666 Test Acc: 0.385
Validation loss decreased (-0.377761 --> -0.385169).  Saving model ...
Epoch: 16 cost time: 0.5237784385681152
Epoch: 16, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.647 Vali Acc: 0.411 Test Loss: 1.647 Test Acc: 0.411
Validation loss decreased (-0.385169 --> -0.411095).  Saving model ...
Epoch: 17 cost time: 0.5653014183044434
Epoch: 17, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.628 Vali Acc: 0.426 Test Loss: 1.628 Test Acc: 0.426
Validation loss decreased (-0.411095 --> -0.425910).  Saving model ...
Epoch: 18 cost time: 0.6598918437957764
Epoch: 18, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.608 Vali Acc: 0.444 Test Loss: 1.608 Test Acc: 0.444
Validation loss decreased (-0.425910 --> -0.444428).  Saving model ...
Epoch: 19 cost time: 0.5187153816223145
Epoch: 19, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.588 Vali Acc: 0.470 Test Loss: 1.588 Test Acc: 0.470
Validation loss decreased (-0.444428 --> -0.470354).  Saving model ...
Epoch: 20 cost time: 0.5640316009521484
Epoch: 20, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.568 Vali Acc: 0.474 Test Loss: 1.568 Test Acc: 0.474
Validation loss decreased (-0.470354 --> -0.474058).  Saving model ...
Epoch: 21 cost time: 0.5384867191314697
Epoch: 21, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.547 Vali Acc: 0.485 Test Loss: 1.547 Test Acc: 0.485
Validation loss decreased (-0.474058 --> -0.485170).  Saving model ...
Epoch: 22 cost time: 0.5050365924835205
Epoch: 22, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.526 Vali Acc: 0.493 Test Loss: 1.526 Test Acc: 0.493
Validation loss decreased (-0.485170 --> -0.492577).  Saving model ...
Epoch: 23 cost time: 0.49315619468688965
Epoch: 23, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.506 Vali Acc: 0.500 Test Loss: 1.506 Test Acc: 0.500
Validation loss decreased (-0.492577 --> -0.499985).  Saving model ...
Epoch: 24 cost time: 0.536217451095581
Epoch: 24, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.484 Vali Acc: 0.511 Test Loss: 1.484 Test Acc: 0.511
Validation loss decreased (-0.499985 --> -0.511096).  Saving model ...
Epoch: 25 cost time: 0.5046412944793701
Epoch: 25, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.463 Vali Acc: 0.511 Test Loss: 1.463 Test Acc: 0.511
Validation loss decreased (-0.511096 --> -0.511096).  Saving model ...
Epoch: 26 cost time: 0.5479958057403564
Epoch: 26, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.441 Vali Acc: 0.533 Test Loss: 1.441 Test Acc: 0.533
Validation loss decreased (-0.511096 --> -0.533319).  Saving model ...
Epoch: 27 cost time: 0.5343139171600342
Epoch: 27, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.420 Vali Acc: 0.559 Test Loss: 1.420 Test Acc: 0.559
Validation loss decreased (-0.533319 --> -0.559245).  Saving model ...
Epoch: 28 cost time: 0.5437405109405518
Epoch: 28, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.398 Vali Acc: 0.574 Test Loss: 1.398 Test Acc: 0.574
Validation loss decreased (-0.559245 --> -0.574060).  Saving model ...
Epoch: 29 cost time: 0.5524539947509766
Epoch: 29, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.376 Vali Acc: 0.607 Test Loss: 1.376 Test Acc: 0.607
Validation loss decreased (-0.574060 --> -0.607394).  Saving model ...
Epoch: 30 cost time: 0.5060775279998779
Epoch: 30, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.354 Vali Acc: 0.630 Test Loss: 1.354 Test Acc: 0.630
Validation loss decreased (-0.607394 --> -0.629616).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_TimesNet_UEA_ftM_sl65_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6296296296296297
model parameter : 46470
model size : 0.34MB
